<!DOCTYPE html><html lang="en"><head><title>Help for package phenology</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phenology}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#phenology-package'><p>Tools to Manage a Parametric Function that Describes Phenology and More</p></a></li>
<li><a href='#adapt_parameters'><p>Extract the parameters from a set of parameters to be used with another dataset.</p></a></li>
<li><a href='#add_phenology'><p>Create a new dataset or add a timeserie to a previous dataset.</p></a></li>
<li><a href='#add_SE'><p>Add standard error for a fixed parameter.</p></a></li>
<li><a href='#AutoFitPhenology'><p>Automatic fit for phenology and tests</p></a></li>
<li><a href='#Bayesian.remigration'><p>Return a posterior remigration interval.</p></a></li>
<li><a href='#BE_to_LBLE'><p>Transform a set of parameters from Begin End to LengthB LengthE.</p></a></li>
<li><a href='#CI.RMU'><p>Calculate the confidence interval of the results of fitRMU()</p></a></li>
<li><a href='#ECFOCF_f'><p>Calculate a table of probabilities of ECF and OCF.</p></a></li>
<li><a href='#ECFOCF_full'><p>Calculate a table of probabilities of ECF and OCF.</p></a></li>
<li><a href='#ExponentialRegression'><p>Non-biased exponential regression</p></a></li>
<li><a href='#extract_result'><p>Extract the set of parameters from a result object.</p></a></li>
<li><a href='#fit_phenology'><p>Fit the phenology parameters to timeseries of counts.</p></a></li>
<li><a href='#fitCF'><p>Fit a model of Clutch Frequency for marine turtles.</p></a></li>
<li><a href='#fitCF_MHmcmc'><p>Run the Metropolis-Hastings algorithm for ECFOCF data</p></a></li>
<li><a href='#fitCF_MHmcmc_p'><p>Generate set of parameters to be used with fitCF_MHmcmc()</p></a></li>
<li><a href='#fitRMU'><p>Adjust incomplete timeseries with various constraints.</p></a></li>
<li><a href='#fitRMU_MHmcmc'><p>Run the Metropolis-Hastings algorithm for RMU.data</p></a></li>
<li><a href='#fitRMU_MHmcmc_p'><p>Generates set of parameters to be used with fitRMU_MHmcmc()</p></a></li>
<li><a href='#fixed.parameters0'><p>Generate a set of fixed parameters for series with only 0 counts</p></a></li>
<li><a href='#generateCF'><p>Generate a set of data to test Clutch Frequency for marine turtles.</p></a></li>
<li><a href='#Gratiot'><p>Leatherback nest counts from Gratiot et al. (2006) Figure 1</p></a></li>
<li><a href='#IPFit'><p>Fit a model of Internesting Period for marine turtles.</p></a></li>
<li><a href='#IPModel'><p>Estimates the pattern of internesting intervals for a set of parameters.</p></a></li>
<li><a href='#IPPredict'><p>Predict the possible clutch number based on observed Internesting Period.</p></a></li>
<li><a href='#L_to_LBLE'><p>Transform a set of parameters from Length format to LengthB LengthE</p></a></li>
<li><a href='#LBLE_to_BE'><p>Transform a set of parameters from LengthB LengthE to Begin End.</p></a></li>
<li><a href='#LBLE_to_L'><p>Transform a set of parameters from LengthB LengthE format to Length</p></a></li>
<li><a href='#likelihood_phenology'><p>Estimate the likelihood of timeseries based on a set of parameters.</p></a></li>
<li><a href='#lnLCF'><p>Calculate the -log likelihood of data within a model.</p></a></li>
<li><a href='#LnRI_norm'><p>Return a remigration interval.</p></a></li>
<li><a href='#logLik.ECFOCF'><p>Return Log Likelihood of a fit done using fitCF</p></a></li>
<li><a href='#logLik.fitRMU'><p>Return Log Likelihood of a fit generated by fitRMU</p></a></li>
<li><a href='#logLik.phenology'><p>Return Log Likelihood of a fit generated by fit_phenology</p></a></li>
<li><a href='#logLik.Tagloss'><p>Return Log Likelihood of a fit generated by Tagloss_fit</p></a></li>
<li><a href='#map_Gratiot'><p>Likelihood map of Leatherback nest counts</p></a></li>
<li><a href='#map_phenology'><p>Generate a likelihood map varying Phi and Delta.</p></a></li>
<li><a href='#MarineTurtles_2002'><p>Database of tagged marine turtles in 2002</p></a></li>
<li><a href='#MinBMinE_to_Min'><p>Transform a set of parameters from MinB and MinE to Min</p></a></li>
<li><a href='#o_4p_p1p2'><p>Model of tagloss based on Rivalan data</p></a></li>
<li><a href='#outLR'><p>Database of leatherback CMR in French Guiana</p></a></li>
<li><a href='#par_init'><p>Calculate initial set of parameters.</p></a></li>
<li><a href='#Parameter_Global_Year'><p>Transform a set of parameters from Year to global effect, or reverse</p></a></li>
<li><a href='#phenology'><p>Run a shiny application for basic functions of phenology package</p></a></li>
<li><a href='#phenology_MHmcmc'><p>Run the Metropolis-Hastings algorithm for data</p></a></li>
<li><a href='#phenology_MHmcmc_p'><p>Generates set of parameters to be used with phenology_MHmcmc()</p></a></li>
<li><a href='#phenology2fitRMU'><p>Create the data to be used with fitRMU() for a summary(phenology).</p></a></li>
<li><a href='#plot_delta'><p>Plot a likelihood lineplot obtained after map_phenology.</p></a></li>
<li><a href='#plot_phi'><p>Plot the best likelihood for fixed Phi value.</p></a></li>
<li><a href='#plot.ECFOCF'><p>Plot a result of clutch frequency fit.</p></a></li>
<li><a href='#plot.fitRMU'><p>Plot the synthesis of RMU fit.</p></a></li>
<li><a href='#plot.IP'><p>Plot a result of Internesting Period fit or data.</p></a></li>
<li><a href='#plot.phenology'><p>Plot the phenology from a result.</p></a></li>
<li><a href='#plot.phenologymap'><p>Plot a likelihood map with Delta and Phi varying.</p></a></li>
<li><a href='#plot.Remigration'><p>Plot the remigration intervals.</p></a></li>
<li><a href='#plot.TableECFOCF'><p>Plot a TableECFOCF dataset.</p></a></li>
<li><a href='#plot.Tagloss'><p>Plot the daily rate of tag loss.</p></a></li>
<li><a href='#plot.TaglossData'><p>Plot data used for tagloss analysis.</p></a></li>
<li><a href='#print.phenology'><p>Print the result information from a result x.</p></a></li>
<li><a href='#print.phenologymap'><p>Print information on a phenologymap object.</p></a></li>
<li><a href='#print.phenologyout'><p>Print the information from a ouput x.</p></a></li>
<li><a href='#remove_site'><p>Removes site information from a set of parameters.</p></a></li>
<li><a href='#result_Gratiot'><p>Result of the fit of Leatherback nest counts</p></a></li>
<li><a href='#result_Gratiot_Flat'><p>Result of the fit of Leatherback nest counts</p></a></li>
<li><a href='#result_Gratiot_mcmc'><p>Result of the mcmc for Leatherback nest counts</p></a></li>
<li><a href='#result_Gratiot1'><p>Result of the fit of Leatherback nest counts</p></a></li>
<li><a href='#result_Gratiot2'><p>Result of the fit of Leatherback nest counts</p></a></li>
<li><a href='#RI'><p>Return an expected remigration interval.</p></a></li>
<li><a href='#shift_sinusoid'><p>Shift sinusoid information.</p></a></li>
<li><a href='#summary.IP'><p>Print the result information from a IP object.</p></a></li>
<li><a href='#summary.phenology'><p>Print the result information from a result object.</p></a></li>
<li><a href='#summary.phenologymap'><p>Print information on a phenologymap object.</p></a></li>
<li><a href='#summary.phenologyout'><p>Print the summary information from a ouput object.</p></a></li>
<li><a href='#TableECFOCF'><p>Format a CMR dataset into a file that fitCF can use.</p></a></li>
<li><a href='#Tagloss_cumul'><p>Return the cumulative rate of tag loss.</p></a></li>
<li><a href='#Tagloss_daymax'><p>Return the maximum number of days an individual has been observed in a dataset.</p></a></li>
<li><a href='#Tagloss_fit'><p>fit a model of tag loss using a CMR database.</p></a></li>
<li><a href='#Tagloss_format'><p>Format a CMR dataset into a file that Tagloss_L can use.</p></a></li>
<li><a href='#Tagloss_L'><p>Return the -log likelihood of a set of individuals under a model of tagloss.</p></a></li>
<li><a href='#Tagloss_LengthObs'><p>Return a list with the number of days for different kinds of individuals are seen.</p></a></li>
<li><a href='#Tagloss_mcmc'><p>Bayesian model of tag loss using a CMR database.</p></a></li>
<li><a href='#Tagloss_mcmc_p'><p>Generates set of parameters to be used with Tagloss_mcmc()</p></a></li>
<li><a href='#Tagloss_model'><p>Return the daily rate of tag loss.</p></a></li>
<li><a href='#Tagloss_simulate'><p>Return a list with the number of days different kinds of individuals are seen.</p></a></li>
<li><a href='#toggle_Min_PMin'><p>Transform a set of parameters from Min, MinB or MinE to PMin, PminB or PminE, or reverse</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Manage a Parametric Function that Describes Phenology
and More</td>
</tr>
<tr>
<td>Version:</td>
<td>10.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-23</td>
</tr>
<tr>
<td>Depends:</td>
<td>numDeriv, parallel, optimx, HelpersMG (&ge; 6.0.1), R (&ge; 4.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>shiny, fields, progress, car, MultiRNG, nlWaldTest, pbapply,
cranlogs</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions used to fit and test the phenology of species based on counts. Based on Girondot, M. (2010) &lt;<a href="https://doi.org/10.3354%2Fesr00292">doi:10.3354/esr00292</a>&gt; for the phenology function, Girondot, M. (2017) &lt;<a href="https://doi.org/10.1016%2Fj.ecolind.2017.05.063">doi:10.1016/j.ecolind.2017.05.063</a>&gt; for the convolution of negative binomial, Girondot, M. and Rizzo, A. (2015) &lt;<a href="https://doi.org/10.2993%2Fetbi-35-02-337-353.1">doi:10.2993/etbi-35-02-337-353.1</a>&gt; for Bayesian estimate, Pfaller JB, ..., Girondot M (2019) &lt;<a href="https://doi.org/10.1007%2Fs00227-019-3545-x">doi:10.1007/s00227-019-3545-x</a>&gt; for tag-loss estimate, Hancock J, ..., Girondot M (2019) &lt;<a href="https://doi.org/10.1016%2Fj.ecolmodel.2019.04.013">doi:10.1016/j.ecolmodel.2019.04.013</a>&gt; for nesting history, Laloe J-O, ..., Girondot M, Hays GC (2020) &lt;<a href="https://doi.org/10.1007%2Fs00227-020-03686-x">doi:10.1007/s00227-020-03686-x</a>&gt; for aggregating several seasons.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-23 06:57:28 UTC; marcgirondot</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Girondot <a href="https://orcid.org/0000-0001-6645-8530"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marc Girondot &lt;marc.girondot@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-23 07:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='phenology-package'>Tools to Manage a Parametric Function that Describes Phenology and More</h2><span id='topic+phenology-package'></span>

<h3>Description</h3>

<p>Functions used to fit and test the phenology of species based on counts.<br />
Note that only the most significant changes are reported in the NEWS.<br />
The latest version of this package can always been installed using:<br />
install.packages(&quot;https://hebergement.universite-paris-saclay.fr/marcgirondot/CRAN/HelpersMG.tar.gz&quot;, repos=NULL, type=&quot;source&quot;)<br />
install.packages(&quot;https://hebergement.universite-paris-saclay.fr/marcgirondot/CRAN/phenology.tar.gz&quot;, repos=NULL, type=&quot;source&quot;)<br />
<img src="../help/figures/imgfile.png" alt="phenology logo" />

</p>


<h3>Details</h3>

<p>Fit a parametric function that describes phenology
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> phenology</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 10.1 build 1603</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-08-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>References</h3>

<p>Girondot, M. 2010. Estimating density of animals during
migratory waves: application to marine turtles at nesting site.
Endangered Species Research, 12, 85-105.
</p>
<p>Girondot M. and Rizzo A. 2015. Bayesian framework to integrate
traditional ecological knowledge into ecological modeling: A case
study. Journal of Ethnobiology, 35, 339-355. <a href="doi:10.2993/etbi-35-02-337-353.1">doi:10.2993/etbi-35-02-337-353.1</a>
</p>
<p>Girondot, M. 2010. Editorial: The zero counts. Marine
Turtle Newsletter, 129, 5-6.
</p>
<p>Girondot, M., 2017. Optimizing sampling design to infer marine turtles
seasonal nest number for low-and high-density nesting beach using convolution
of negative binomial distribution. Ecological Indicators 81, 83–89.
</p>
<p>Rivalan, P., Godfrey, M.H., Prévot-Julliard, A.-C., Girondot, M., 2005.
Maximum likelihood estimates of tag loss in leatherback sea turtles. Journal
of Wildlife Management 69, 540-548.
</p>


<h3>See Also</h3>

<p>Girondot, M., Rivalan, P., Wongsopawiro, R., Briane, J.-P., Hulin, V.,
Caut, S., Guirlet, E. &amp; Godfrey, M. H. 2006. Phenology of marine turtle
nesting revealed by a statistical model of the nesting season. BMC Ecology,
6, 11.
</p>
<p>Delcroix, E., Bédel, S., Santelli, G., Girondot, M., 2013. Monitoring
design for quantification of marine turtle nesting with limited human
effort: a test case in the Guadeloupe Archipelago. Oryx 48, 95-105.
</p>
<p>Briane J-P, Rivalan P, Girondot M (2007) The inverse problem applied
to the Observed Clutch Frequency of Leatherbacks from Yalimapo beach,
French Guiana. Chelonian Conservation and Biology 6:63-69
</p>
<p>Fossette S, Kelle L, Girondot M, Goverse E, Hilterman ML, Verhage B,
Thoisy B, de, Georges J-Y (2008) The world's largest leatherback
rookeries: A review of conservation-oriented research in French
Guiana/Suriname and Gabon. Journal of Experimental Marine Biology
and Ecology 356:69-82
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Plot the phenology and get some stats
output &lt;- plot(result_Gratiot)

# How many times this package has been download
library(cranlogs)
phenology &lt;- cran_downloads("phenology", from = "2012-10-06", 
                            to = Sys.Date() - 1) 
sum(phenology$count)
plot(phenology$date, phenology$count, type="l", bty="n")

## End(Not run)
</code></pre>

<hr>
<h2 id='adapt_parameters'>Extract the parameters from a set of parameters to be used with another dataset.</h2><span id='topic+adapt_parameters'></span>

<h3>Description</h3>

<p>The function &quot;adapt_parameters&quot; extracts the set of parameters to be used with a subset of data. All the uncessary parameters are removed. It can be used when a set of beaches are fitted first and after only one of these beaches is fitted again.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adapt_parameters(
  data = stop("Datasets is mandatory for this function"),
  parameters = stop("Set of parameters is mandatory for this function")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adapt_parameters_+3A_data">data</code></td>
<td>
<p>A dataset of counts</p>
</td></tr>
<tr><td><code id="adapt_parameters_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>adapt_parameters get the fitted parameters from a result object.
</p>


<h3>Value</h3>

<p>Return the set of parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
refdate &lt;- as.Date("2001-01-01")
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=refdate, format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Add unnecessary parameters to parg
parg &lt;- c(parg, Max_dummybeach=2, Peak_dummybeach=123)
# Extract the fitted parameters
parg1&lt;-adapt_parameters(data=data_Gratiot, parameters=parg)
</code></pre>

<hr>
<h2 id='add_phenology'>Create a new dataset or add a timeserie to a previous dataset.</h2><span id='topic+add_phenology'></span>

<h3>Description</h3>

<p>To create a new dataset, the syntaxe is :<br />
data &lt;- add_phenology(add=newdata, name=&quot;Site&quot;, reference=as.Date('2001-12-31'),
format='\
To add a dataset to a previous one, the syntax is :<br />
data &lt;- add_phenology(previous=previousdata, add=newdata, name='Site', <br />
reference=as.Date('2001-01-01'), format=&quot;\
The dataset to be added must include 2 or 3 columns.<br />
The colname.Date included the dates in the format specified by
the parameter format. If the number of nests is known
for an exact date, then only one date must be indicated.<br />
If the number of nests is known for a range of date, the
first and last dates must be separated by a sep.dates character.<br />
For example: 1/2/2000-10/2/2000<br />
Note that date in the colname.Date column can be already formated and in this case
the parameter format is ignored.<br /><br />
The colname.Number includes the number of nests observed for
this date or this range of dates.<br />
The colname.Rookery is optional and includes the name of the rookeries.<br /><br />
If only two columns are indicated, the name can be indicated as
a parameter of the function with the parameter name. If no name is indicated,
the default name Site will be used, but take care, only one
rookery of this name can be used.<br /><br />
Several rookeries can be included in the same file but in this case
the rookery name is obligatory at the colname.Rookery column.<br /><br />
The model cannot be fitted if a timeseries has no observation because the trivial
solution is of course with max=0. The solution is to include a fake false observation at the closest
position of the peak, and then the estimated number of nests/tracks will be the estimated number - 1.<br />
If include0 is TRUE, then the series with no observation are included and one observation is added
at the monitored date the closest of datepeakfor0.<br />
The normal way to manage such a situation is as followed:<br />
1- Format data with include0 being FALSE<br />
2- Fit parameters using fdf &lt;- fit_phenology()<br />
3- Format data with include0 being TRUE and datepeakfor0=fdf$par[&quot;Peak&quot;]<br />
4- Fix previsouly fitted parameters using pfixed &lt;- fdf$par<br />
5- Generate new set of parameters with par_init(data, fixed.parameters=pfixed)<br />
6- Run again fit_phenology()<br /><br />
Some problems that can occur:<br />
If a name is defined as a third column of a data.frame and a name is
defined also with name parameter, the third column has priority.<br />
Two different timeseries MUST have different name and characters _ and
space are forbiden in timeseries names. They are automatically changed if they are present.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_phenology(
  add = stop("New data must be given."),
  name = "Site",
  reference = NULL,
  month_ref = NULL,
  sep.dates = "-",
  end.season.date = NULL,
  colname.Date = 1,
  colname.Number = 2,
  colname.Rookery = "Site",
  colname.CountTypes = NULL,
  CountTypes.default = "exact",
  colname.A = NULL,
  A.default = NA,
  colname.S = NULL,
  S.default = NA,
  colname.ZeroCounts = NULL,
  ZeroCounts.default = TRUE,
  format = "%d/%m/%Y",
  previous = NULL,
  include0 = FALSE,
  datepeakfor0 = NULL,
  expandRange0Observation = TRUE,
  check.overlapping.dates = TRUE,
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_phenology_+3A_add">add</code></td>
<td>
<p>The data to be added. It can be a set of several entities that uses the same reference and date format.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_name">name</code></td>
<td>
<p>The name of the monitored site.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_reference">reference</code></td>
<td>
<p>as.Date('2001-12-31') The date used as day 0 in the ordinal date model.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_month_ref">month_ref</code></td>
<td>
<p>If no reference date is given, use this month as a reference.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_sep.dates">sep.dates</code></td>
<td>
<p>Separator used to separate dates when incertitude is included.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_end.season.date">end.season.date</code></td>
<td>
<p>The date corresponding to the end of nesting season.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_colname.date">colname.Date</code></td>
<td>
<p>Name or number of column with dates.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_colname.number">colname.Number</code></td>
<td>
<p>Name or number of column with numbers.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_colname.rookery">colname.Rookery</code></td>
<td>
<p>Name or number of column with rookery names.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_colname.counttypes">colname.CountTypes</code></td>
<td>
<p>Model of count type. It can be &quot;exact&quot; (default), &quot;minimum&quot; or a number to indicate the maximum possible.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_counttypes.default">CountTypes.default</code></td>
<td>
<p>The default of CountTypes if colname.CountTypes is not provided.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_colname.a">colname.A</code></td>
<td>
<p>The A parameter of the detection model</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_a.default">A.default</code></td>
<td>
<p>Default A value.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_colname.s">colname.S</code></td>
<td>
<p>The S parameter of the detection model</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_s.default">S.default</code></td>
<td>
<p>Default S value.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_colname.zerocounts">colname.ZeroCounts</code></td>
<td>
<p>The name of the column to indicate whether zero counts are included (TRUE is default).</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_zerocounts.default">ZeroCounts.default</code></td>
<td>
<p>The default for ZeroCounts.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_format">format</code></td>
<td>
<p>The format of the dates.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_previous">previous</code></td>
<td>
<p>Previous data formated with add_phenology or NULL [default] if no previous data exist.</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_include0">include0</code></td>
<td>
<p>Does timeseries with only 0 should be included?</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_datepeakfor0">datepeakfor0</code></td>
<td>
<p>If series with no observation are included, where add a 1 value in ordinal date (see description)</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_expandrange0observation">expandRange0Observation</code></td>
<td>
<p>If TRUE, the range of date with 0 observations are expanded into individual dates</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_check.overlapping.dates">check.overlapping.dates</code></td>
<td>
<p>If TRUE, will check for date overlapping</p>
</td></tr>
<tr><td><code id="add_phenology_+3A_silent">silent</code></td>
<td>
<p>Does information about added timeseries is shown</p>
</td></tr>
</table>


<h3>Details</h3>

<p>add_phenology creates a new dataset.
</p>


<h3>Value</h3>

<p>Return a list of formated data that can be used ith fit_phenology()
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
refdate &lt;- as.Date("2001-01-01")
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
	reference=refdate, format="%d/%m/%Y")
	
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, fitted.parameters=parg, 
	fixed.parameters=NULL)
data(result_Gratiot)
# Plot the phenology and get some stats
output &lt;- plot(result_Gratiot)

#############################################
# Example of use of include0 and datepeakfor0
#############################################
# Let create a times series with only 0
data0 &lt;- data.frame(Date=c("11/3/2015", "12/3/2015", "13/3/2015-18/3/2015", "25/3/2015"), 
                    Number=c(0, 0, 0, 0), 
                    Beach=rep("Site", 4), stringsAsFactors=FALSE)
# Here I don't include beach with no observation: error message
try1 &lt;- add_phenology(data0, format="%d/%m/%Y", month_ref=1, include0=FALSE)
# Here I include timeseries with no observation
try1 &lt;- add_phenology(data0, format="%d/%m/%Y", month_ref=1, include0=TRUE, datepeakfor0=100)
try1 &lt;- add_phenology(data0, format="%d/%m/%Y", month_ref=1, include0=TRUE, datepeakfor0=73)
try1 &lt;- add_phenology(data0, format="%d/%m/%Y", month_ref=1, include0=TRUE, datepeakfor0=70)
# It can be done in two steps
try1 &lt;- add_phenology(data0, format="%d/%m/%Y", month_ref=1, include0=TRUE)
try2 &lt;- add_phenology(previous=try1, include0=TRUE, datepeakfor0=100)
# Here I include the series without observation
try1 &lt;- add_phenology(add=data0, format="%d/%m/%Y", month_ref=1, 
                      include0=TRUE, expandRange0Observation=TRUE)
                      
##############################################################################
# Example of A and S parameters to say that only half of a beach was monitored
##############################################################################

refdate &lt;- as.Date("2001-01-01")
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete1", 
                             	reference=refdate, format="%d/%m/%Y")
	      S.default = 10
	      # Let Complete1 be of length 2 and Complete0.5 be of length 1
	      length.Complete1 &lt;- 2
	      length.Complete0.5 &lt;- 1
	      A.default = log(1/(length.Complete0.5/length.Complete1)-1)/(-S.default*4)
	      # For day 0, the detection probability is
	      1/(1+exp(-(4*S.default)*(A.default-0)))
	data_Gratiot &lt;- add_phenology(previous=data_Gratiot, 
	      add=Gratiot, 
	      name="Complete0.5", 
	      A.default = A.default,
	      S.default = S.default, 
	      reference=refdate, 
	      format="%d/%m/%Y")
	parg &lt;- c(par_init(data_Gratiot, fixed.parameters=c(Min=0, Flat=0)), PMin=0.1)
	result_Gratiot &lt;- fit_phenology(data=data_Gratiot, fitted.parameters=parg, 
	                                fixed.parameters=c(Flat=0))
	result_Gratiot$par
	# it shows that Max_Complete1 is half of Max_Complete0.5; all is ok
	summary(result_Gratiot)$synthesis
	

## End(Not run)
</code></pre>

<hr>
<h2 id='add_SE'>Add standard error for a fixed parameter.</h2><span id='topic+add_SE'></span>

<h3>Description</h3>

<p>This function is used to add standard error for a fixed parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_SE(fixed.parameters = NULL, parameters = NULL, SE = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_SE_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="add_SE_+3A_parameters">parameters</code></td>
<td>
<p>Set of current parameters</p>
</td></tr>
<tr><td><code id="add_SE_+3A_se">SE</code></td>
<td>
<p>Standard error value to be added</p>
</td></tr>
</table>


<h3>Details</h3>

<p>add_SE adds standard error for a fixed parameter.
</p>


<h3>Value</h3>

<p>The parameters set with the new SE value
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Generate a set of fixed parameter: Flat and Min
pfixed&lt;-c(Flat=0, Min=0)
# Add SE for the Flat parameter
pfixed&lt;-add_SE(fixed.parameters=pfixed, parameters="Flat", SE=5)
</code></pre>

<hr>
<h2 id='AutoFitPhenology'>Automatic fit for phenology and tests</h2><span id='topic+AutoFitPhenology'></span>

<h3>Description</h3>

<p>This function is used to test several combinations of fit at a time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AutoFitPhenology(
  data = stop("A dataset must be provided"),
  progressbar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AutoFitPhenology_+3A_data">data</code></td>
<td>
<p>Dataset generated with add_phenology()</p>
</td></tr>
<tr><td><code id="AutoFitPhenology_+3A_progressbar">progressbar</code></td>
<td>
<p>If FALSE, do not show the progress bar</p>
</td></tr>
<tr><td><code id="AutoFitPhenology_+3A_...">...</code></td>
<td>
<p>Parameters for fit_phenology()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>AutoFitPhenology runs fit for phenology and tests several combinations
</p>


<h3>Value</h3>

<p>A list with 12 elements corresponding to the 12 tested models
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Run the optimisation
result_Gratiot_Auto &lt;- AutoFitPhenology(data=data_Gratiot)
result_Gratiot_Auto &lt;- AutoFitPhenology(data=data_Gratiot, 
          control=list(trace=0, REPORT=100, maxit=500))

## End(Not run)
</code></pre>

<hr>
<h2 id='Bayesian.remigration'>Return a posterior remigration interval.</h2><span id='topic+Bayesian.remigration'></span>

<h3>Description</h3>

<p>Model of remigration interval<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bayesian.remigration(
  parameters = stop("Priors must be supplied"),
  data = stop("data must be supplied"),
  kl = NULL,
  n.iter = 1e+05,
  n.chains = 1,
  n.adapt = 10000,
  thin = 1,
  trace = 10,
  adaptive = TRUE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Bayesian.remigration_+3A_parameters">parameters</code></td>
<td>
<p>Priors for Bayesian MCMC</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_data">data</code></td>
<td>
<p>Data to be fitted</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_kl">kl</code></td>
<td>
<p>Maximum number of years for remigration intervals.</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for MCMC</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_thin">thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_trace">trace</code></td>
<td>
<p>Or FALSE or period to show progress</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive context</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_intermediate">intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_filename">filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td></tr>
<tr><td><code id="Bayesian.remigration_+3A_previous">previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bayesian.remigration fits a remigration interval using Bayesian MCMC
</p>


<h3>Value</h3>

<p>Return a posterior remigration interval.<br />
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Remigration Interval: 
<code><a href="#topic+LnRI_norm">LnRI_norm</a>()</code>,
<code><a href="#topic+RI">RI</a>()</code>,
<code><a href="#topic+plot.Remigration">plot.Remigration</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example

# Each year a fraction of 0.9 is surviving
s &lt;- c(s=0.9)
# Probability of tag retention; 0.8
t &lt;- c(t=0.8)
# Time-conditional return probability - This is the true remigration rate
r &lt;- c(r1=0.1, r2=0.8, r3=0.7, r4=0.7, r5=1)
# Capture probability
p &lt;- c(p1=0.6, p2=0.6, p3=0.6, p4=0.6, p5=0.6)
# Number of observations for 400 tagged females after 1, 2, 3, 4, and 5 years
OBS &lt;- c(400, 10, 120, 40, 20, 10)

kl_s &lt;- length(s)
kl_t &lt;- length(t)
kl_r &lt;- length(r)
kl_p &lt;- length(p)

pMCMC &lt;- data.frame(Density=c("newdbeta", "newdbeta", rep("dunif", kl_r), 
                              rep("newdbeta", kl_p), "dunif"), 
                    Prior1=c(s, t, rep(0, kl_r), rep(0.2, kl_p), 0), 
                    Prior2=c(0.02, 0.02, rep(1, kl_r), rep(0.08, kl_p), 10), 
                    SDProp=c(0.05, 0.05, rep(0.05, kl_r), rep(0.05, kl_p), 0.05), 
                 Min=c(0, 0, rep(0, kl_r), rep(0, kl_p), 0),  
                 Max=c(1, 1, rep(1, kl_r), rep(1, kl_p), 10),  
                 Init=c(s, t, r, p, 1), stringsAsFactors = FALSE, 
                 row.names=c("s", 
                                "t", 
                                names(r), 
                                names(p), "sd")
)
rMCMC &lt;- Bayesian.remigration(parameters = pMCMC, 
n.iter = 1000000, 
n.adapt = 300000,
trace=10000, 
data=OBS)

plot(rMCMC)


## End(Not run)
</code></pre>

<hr>
<h2 id='BE_to_LBLE'>Transform a set of parameters from Begin End to LengthB LengthE.</h2><span id='topic+BE_to_LBLE'></span>

<h3>Description</h3>

<p>This function is used to transform a set of parameters
that uses Begin, Peak and End to a set of parameters
that uses LengthB, Peak and LengthE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BE_to_LBLE(parameters = NULL, help = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BE_to_LBLE_+3A_parameters">parameters</code></td>
<td>
<p>Set of current parameters</p>
</td></tr>
<tr><td><code id="BE_to_LBLE_+3A_help">help</code></td>
<td>
<p>If TRUE, an help is displayed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BE_to_LBLE transforms a set of parameters from Begin End format to LengthB LengthE.
</p>


<h3>Value</h3>

<p>Return the set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
refdate &lt;- as.Date("2001-01-01")
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=refdate, format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Change the parameters to Begin End format
parg1&lt;-LBLE_to_BE(parameters=parg)
# And change back to LengthB LengthE.
parg2&lt;-BE_to_LBLE(parameters=parg1)

## End(Not run)
</code></pre>

<hr>
<h2 id='CI.RMU'>Calculate the confidence interval of the results of fitRMU()</h2><span id='topic+CI.RMU'></span>

<h3>Description</h3>

<p>The data must be a data.frame with the first column being years <br />
and two columns for each beach: the average and the se for the estimate.<br />
The correspondence between mean, se and density for each rookery are given in the RMU.names data.frame.<br />
This data.frame must have a column named mean, another named se and a third named density. If
no sd column exists, no sd will be considered for the series and is no density column exists, it
will be considered as being &quot;dnorm&quot;.<br />
In the result list, the mean proportions for each rookeries are in $proportions.<br />
The names of beach columns must not begin by T_, SD_, a0_, a1_ or a2_ and cannot be r.<br />
A RMU is the acronyme for Regional Managment Unit. See:<br />
Wallace, B.P., DiMatteo, A.D., Hurley, B.J., Finkbeiner, E.M., Bolten, A.B.,
Chaloupka, M.Y., Hutchinson, B.J., Abreu-Grobois, F.A., Amorocho, D., Bjorndal, K.A.,
Bourjea, J., Bowen, B.W., Dueñas, R.B., Casale, P., Choudhury, B.C., Costa, A.,
Dutton, P.H., Fallabrino, A., Girard, A., Girondot, M., Godfrey, M.H., Hamann, M.,
López-Mendilaharsu, M., Marcovaldi, M.A., Mortimer, J.A., Musick, J.A., Nel, R.,
Seminoff, J.A., Troëng, S., Witherington, B., Mast, R.B., 2010. Regional
management units for marine turtles: a novel framework for prioritizing
conservation and research across multiple scales. PLoS One 5, e15465.<br />
Variance for each value is additive based on both the observed SE (in the RMU.data
object) and a constant value dependent on the rookery when model.SD is equal to
&quot;Rookery-constant&quot;. The value is a global constant when model.SD is &quot;global-constant&quot;.
The value is proportional to the observed number of nests when model.SD is
&quot;global-proportional&quot; with aSD_*observed+SD_ with aSD_ and SD_ being fitted
values. This value is fixed to zero when model.SD is &quot;Zero&quot;.<br />
If replicate.CI is 0, no CI is estimated, and only point estimation is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CI.RMU(
  result = stop("A result obtained from fitRMU is necessary"),
  resultMCMC = NULL,
  chain = 1,
  replicate.CI = 10000,
  regularThin = TRUE,
  probs = c(0.025, 0.5, 0.975),
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CI.RMU_+3A_result">result</code></td>
<td>
<p>A result of fitRMu()</p>
</td></tr>
<tr><td><code id="CI.RMU_+3A_resultmcmc">resultMCMC</code></td>
<td>
<p>A resuts of fitRMU_MHmcmc()</p>
</td></tr>
<tr><td><code id="CI.RMU_+3A_chain">chain</code></td>
<td>
<p>Number of MCMC chain to be used</p>
</td></tr>
<tr><td><code id="CI.RMU_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="CI.RMU_+3A_regularthin">regularThin</code></td>
<td>
<p>If TRUE, use regular thin for MCMC</p>
</td></tr>
<tr><td><code id="CI.RMU_+3A_probs">probs</code></td>
<td>
<p>The probabilities to return for quantiles</p>
</td></tr>
<tr><td><code id="CI.RMU_+3A_silent">silent</code></td>
<td>
<p>If TRUE does not display anything</p>
</td></tr>
</table>


<h3>Details</h3>

<p>CI.RMU calculates the confidence interval of the results of fitRMU()
</p>


<h3>Value</h3>

<p>Return a list with Total, Proportions, and Numbers
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Fill gaps in RMU: 
<code><a href="#topic+fitRMU">fitRMU</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc">fitRMU_MHmcmc</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc_p">fitRMU_MHmcmc_p</a>()</code>,
<code><a href="#topic+logLik.fitRMU">logLik.fitRMU</a>()</code>,
<code><a href="#topic+plot.fitRMU">plot.fitRMU</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
RMU.names.AtlanticW &lt;- data.frame(mean=c("Yalimapo.French.Guiana", 
                                         "Galibi.Suriname", 
                                         "Irakumpapy.French.Guiana"), 
                                 se=c("se_Yalimapo.French.Guiana", 
                                      "se_Galibi.Suriname", 
                                      "se_Irakumpapy.French.Guiana"), 
                                 density=c("density_Yalimapo.French.Guiana", 
                                           "density_Galibi.Suriname", 
                                           "density_Irakumpapy.French.Guiana"), 
                                           stringsAsFactors = FALSE)
data.AtlanticW &lt;- data.frame(Year=c(1990:2000), 
      Yalimapo.French.Guiana=c(2076, 2765, 2890, 2678, NA, 
                               6542, 5678, 1243, NA, 1566, 1566),
      se_Yalimapo.French.Guiana=c(123.2, 27.7, 62.5, 126, NA, 
                                 230, 129, 167, NA, 145, 20),
      density_Yalimapo.French.Guiana=rep("dnorm", 11), 
      Galibi.Suriname=c(276, 275, 290, NA, 267, 
                       542, 678, NA, 243, 156, 123),
      se_Galibi.Suriname=c(22.3, 34.2, 23.2, NA, 23.2, 
                           4.3, 2.3, NA, 10.3, 10.1, 8.9),
      density_Galibi.Suriname=rep("dnorm", 11), 
      Irakumpapy.French.Guiana=c(1076, 1765, 1390, 1678, NA, 
                               3542, 2678, 243, NA, 566, 566),
      se_Irakumpapy.French.Guiana=c(23.2, 29.7, 22.5, 226, NA, 
                                 130, 29, 67, NA, 15, 20), 
      density_Irakumpapy.French.Guiana=rep("dnorm", 11), stringsAsFactors = FALSE
      )
                           
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero")
               
out.CI.Cst &lt;- CI.RMU(result=cst)



cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero", 
               control=list(trace=1, REPORT=100, maxit=500, parscale = c(3000, -0.2, 0.6)))
               
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero", method=c("Nelder-Mead","BFGS"), 
               control = list(trace = 0, REPORT = 100, maxit = 500, 
               parscale = c(3000, -0.2, 0.6)))
expo &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Exponential", 
               model.SD="Zero", method=c("Nelder-Mead","BFGS"), 
               control = list(trace = 0, REPORT = 100, maxit = 500, 
               parscale = c(6000, -0.05, -0.25, 0.6)))
YS &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", method=c("Nelder-Mead","BFGS"), 
             model.SD="Zero")
YS1 &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", method=c("Nelder-Mead","BFGS"), 
             model.SD="Zero", model.rookeries="First-order")
YS1_cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", 
             model.SD="Constant", model.rookeries="First-order", 
             parameters=YS1$par, method=c("Nelder-Mead","BFGS"))
YS2 &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific",
             model.SD="Zero", model.rookeries="Second-order", 
             parameters=YS1$par, method=c("Nelder-Mead","BFGS"))
YS2_cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific",
             model.SD="Constant", model.rookeries="Second-order", 
             parameters=YS1_cst$par, method=c("Nelder-Mead","BFGS"))
               
compare_AIC(Constant=cst, 
            Exponential=expo, 
            YearSpecific=YS)

compare_AIC(YearSpecific_ProportionsFirstOrder_Zero=YS1,
YearSpecific_ProportionsFirstOrder_Constant=YS1_cst)

compare_AIC(YearSpecific_ProportionsConstant=YS,
           YearSpecific_ProportionsFirstOrder=YS1,
           YearSpecific_ProportionsSecondOrder=YS2)
           
compare_AIC(YearSpecific_ProportionsFirstOrder=YS1_cst,
           YearSpecific_ProportionsSecondOrder=YS2_cst)

plot(cst, main="Use of different beaches along the time", what="total")
plot(expo, main="Use of different beaches along the time", what="total")
plot(YS2_cst, main="Use of different beaches along the time", what="total")

plot(YS1, main="Use of different beaches along the time")
plot(YS1_cst, main="Use of different beaches along the time")
plot(YS1_cst, main="Use of different beaches along the time", what="numbers")

# Gamma distribution should be used for MCMC outputs

RMU.names.AtlanticW &lt;- data.frame(mean=c("Yalimapo.French.Guiana", 
                                         "Galibi.Suriname", 
                                         "Irakumpapy.French.Guiana"), 
                                 se=c("se_Yalimapo.French.Guiana", 
                                      "se_Galibi.Suriname", 
                                      "se_Irakumpapy.French.Guiana"), 
                                 density=c("density_Yalimapo.French.Guiana", 
                                           "density_Galibi.Suriname", 
                                           "density_Irakumpapy.French.Guiana"))
                                           
data.AtlanticW &lt;- data.frame(Year=c(1990:2000), 
      Yalimapo.French.Guiana=c(2076, 2765, 2890, 2678, NA, 
                               6542, 5678, 1243, NA, 1566, 1566),
      se_Yalimapo.French.Guiana=c(123.2, 27.7, 62.5, 126, NA, 
                                 230, 129, 167, NA, 145, 20),
      density_Yalimapo.French.Guiana=rep("dgamma", 11), 
      Galibi.Suriname=c(276, 275, 290, NA, 267, 
                       542, 678, NA, 243, 156, 123),
      se_Galibi.Suriname=c(22.3, 34.2, 23.2, NA, 23.2, 
                           4.3, 2.3, NA, 10.3, 10.1, 8.9),
      density_Galibi.Suriname=rep("dgamma", 11), 
      Irakumpapy.French.Guiana=c(1076, 1765, 1390, 1678, NA, 
                               3542, 2678, 243, NA, 566, 566),
      se_Irakumpapy.French.Guiana=c(23.2, 29.7, 22.5, 226, NA, 
                                 130, 29, 67, NA, 15, 20), 
      density_Irakumpapy.French.Guiana=rep("dgamma", 11)
      )
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero")

## End(Not run)
</code></pre>

<hr>
<h2 id='ECFOCF_f'>Calculate a table of probabilities of ECF and OCF.</h2><span id='topic+ECFOCF_f'></span>

<h3>Description</h3>

<p>This function calculates a table of probabilities of ECF and OCF.<br />
If p is lower or higher than 1E-100 or 1-1E-100, it is changed to 1E-100 and 1-(1E-100) respectively.<br />
Names for p vector elements should be p, or px (with x=1:categories), or px.period.<br />
If mu_season and sd_season are equal to NA, the model is not temporalized.<br />
If mu_season and sd_season are not NA, the model returns a 3D-table OCFECF.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ECFOCF_f(
  mu,
  sd = NA,
  p,
  MaxNests = 15,
  mu_season = NA,
  sd_season = NA,
  MeanDaysBetween2Nests = 9.8,
  length_season = floor(365/MeanDaysBetween2Nests) + 1,
  parallel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ECFOCF_f_+3A_mu">mu</code></td>
<td>
<p>The average of lognormal for clutch frequency.</p>
</td></tr>
<tr><td><code id="ECFOCF_f_+3A_sd">sd</code></td>
<td>
<p>The sd parameter of lognormal for clutch frequency.</p>
</td></tr>
<tr><td><code id="ECFOCF_f_+3A_p">p</code></td>
<td>
<p>The capture probability for an individual nesting event. As a probability.</p>
</td></tr>
<tr><td><code id="ECFOCF_f_+3A_maxnests">MaxNests</code></td>
<td>
<p>Maximum number of nests by a female.</p>
</td></tr>
<tr><td><code id="ECFOCF_f_+3A_mu_season">mu_season</code></td>
<td>
<p>The average of ordinal day for beginning of nesting season.</p>
</td></tr>
<tr><td><code id="ECFOCF_f_+3A_sd_season">sd_season</code></td>
<td>
<p>The sd parameter of lognormal for ordinal day for beginning of nesting season.</p>
</td></tr>
<tr><td><code id="ECFOCF_f_+3A_meandaysbetween2nests">MeanDaysBetween2Nests</code></td>
<td>
<p>Average number of days between two nests.</p>
</td></tr>
<tr><td><code id="ECFOCF_f_+3A_length_season">length_season</code></td>
<td>
<p>The total length of season based on groups of interclutch intervals.</p>
</td></tr>
<tr><td><code id="ECFOCF_f_+3A_parallel">parallel</code></td>
<td>
<p>If TRUE parallel computing is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ECFOCF_f calculate a table of probabilities of ECF and OCF.
</p>


<h3>Value</h3>

<p>Return a matrix of class TableECFOCF.<br />
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
modelECFOCF &lt;- ECFOCF_f(mu=5.58013243236187, 
                    sd=1.225581130238, 
                    p=invlogit(1.3578137414575), 
                    MaxNests=15)
plot(modelECFOCF)
modelECFOCF &lt;- ECFOCF_f(mu=5.58013243236187, 
                    sd=1.225581130238, 
                    mu_season=12, 
                    sd_season=2, 
                    p=c(p1=invlogit(1.3578137414575)), 
                    MaxNests=15, 
                    MeanDaysBetween2Nests=9.8, 
                    length_season=floor(365/9.8)+1)
plot(modelECFOCF, period=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='ECFOCF_full'>Calculate a table of probabilities of ECF and OCF.</h2><span id='topic+ECFOCF_full'></span>

<h3>Description</h3>

<p>This function calculates a table of probabilities of ECF and OCF.<br />
If p is lower or higher than 1E-100 or 1-1E-100, it is changed to 1E-100 and 1-(1E-100) respectively.<br />
Names for p vector elements should be p, or px (with x=1:categories), or px.period.<br />
If mu_season and sd_season are equal to NA, the model is not temporalized.<br />
If mu_season and sd_season are not NA, the model returns a 3D-table OCFECF.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ECFOCF_full(
  mu,
  sd = NA,
  p,
  a = NULL,
  MaxNests = 15,
  mu_season = NA,
  sd_season = NA,
  OTN = c(OTN1 = 1),
  MeanDaysBetween2Nests = 9.8,
  length_season = NA,
  parallel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ECFOCF_full_+3A_mu">mu</code></td>
<td>
<p>The average of lognormal for clutch frequency.</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_sd">sd</code></td>
<td>
<p>The sd parameter of lognormal for clutch frequency.</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_p">p</code></td>
<td>
<p>The capture probability for an individual nesting event. As a logit</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_a">a</code></td>
<td>
<p>The common capture probability. As a probability</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_maxnests">MaxNests</code></td>
<td>
<p>Maximum number of nests by a female.</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_mu_season">mu_season</code></td>
<td>
<p>The average of ordinal day for beginning of nesting season.</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_sd_season">sd_season</code></td>
<td>
<p>The sd parameter of lognormal for ordinal day for beginning of nesting season.</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_otn">OTN</code></td>
<td>
<p>The relative probability of categories</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_meandaysbetween2nests">MeanDaysBetween2Nests</code></td>
<td>
<p>Average number of days between two nests.</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_length_season">length_season</code></td>
<td>
<p>The total length of season based on groups of interclutch intervals.</p>
</td></tr>
<tr><td><code id="ECFOCF_full_+3A_parallel">parallel</code></td>
<td>
<p>If TRUE parallel computing is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ECFOCF_full calculate a table of probabilities of ECF and OCF.
</p>


<h3>Value</h3>

<p>Return a matrix of class TableECFOCF.<br />
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example

modelECFOCF &lt;- ECFOCF_full(mu=c(mu1=5.58013243236187), 
                    sd=c(sd1=1.225581130238), 
                    mu_season=c(mu_season1=12), 
                    sd_season=c(sd_season1=2), 
                    p=c(p1=logit(0.7954041)), 
                    a=c(a1=1), 
                    MaxNests=15, 
                    MeanDaysBetween2Nests=9.8, 
                    length_season=floor(365/9.8)+1)
plot(modelECFOCF, period=12, max.scale=0.02)
modelECFOCF &lt;- ECFOCF_full(mu=c(mu1=5.58013243236187), 
                    sd=c(sd1=1.225581130238), 
                    a=c(a1=1), 
                    p=c(p1=invlogit(1.3578137414575)), 
                    MaxNests=15)
plot(modelECFOCF)

## End(Not run)
</code></pre>

<hr>
<h2 id='ExponentialRegression'>Non-biased exponential regression</h2><span id='topic+ExponentialRegression'></span>

<h3>Description</h3>

<p>The idea of this function is to fit a regression exponential model using MCMC
because regression model using glm can produce biased outputs.<br />
prior.default.distribution can be &quot;dnorm&quot;, &quot;dunif&quot;, or &quot;dgamma&quot;. Note that if you propose
dgamma prior, it will use uniform prior for r because r can be negative.<br />
The SD model is asd*Nt+bsd. The asd parameter represents multiplicative model and the
bsd parameter represents additive model. Both can be used simultaneously.<br />
density can be dnorm or dnbinom_new (from HelpersMG package). dnbinom_new() is a
negative binomial with mean and sd parametrization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExponentialRegression(
  data = stop("A data.frame with values"),
  colname.time = "time",
  colname.number = "numbers",
  weights = NULL,
  fitted.parameters = c(N0 = NA, r = NA, asd = NA),
  fixed.parameters = NULL,
  n.iter = c(1e+05, 1e+05),
  prior.default.distribution = "dnorm",
  density = dnorm
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExponentialRegression_+3A_data">data</code></td>
<td>
<p>A data.frame with a column time and a column number.</p>
</td></tr>
<tr><td><code id="ExponentialRegression_+3A_colname.time">colname.time</code></td>
<td>
<p>Name of the column to be used as time index.</p>
</td></tr>
<tr><td><code id="ExponentialRegression_+3A_colname.number">colname.number</code></td>
<td>
<p>Name of the column to be used as number index.</p>
</td></tr>
<tr><td><code id="ExponentialRegression_+3A_weights">weights</code></td>
<td>
<p>an optional vector of ‘prior weights’ to be used in the fitting process. Should be NULL or a numeric vector.</p>
</td></tr>
<tr><td><code id="ExponentialRegression_+3A_fitted.parameters">fitted.parameters</code></td>
<td>
<p>A named vector with the parameters to be fitted</p>
</td></tr>
<tr><td><code id="ExponentialRegression_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A named vector with the parameters to be fixed</p>
</td></tr>
<tr><td><code id="ExponentialRegression_+3A_n.iter">n.iter</code></td>
<td>
<p>The number of MCMC iterations.</p>
</td></tr>
<tr><td><code id="ExponentialRegression_+3A_prior.default.distribution">prior.default.distribution</code></td>
<td>
<p>The default prior distribution; see description.</p>
</td></tr>
<tr><td><code id="ExponentialRegression_+3A_density">density</code></td>
<td>
<p>by default is dnorm but can be dnbinom_new</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ExponentialRegression is used to fit additive, multiplicative or mixte exponential regression
</p>


<h3>Value</h3>

<p>Return a list with the results of exponential regression
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
t &lt;- 1:100
N0 &lt;- 100
r &lt;- 0.05
y &lt;- N0*exp(t*r)

# Multiplicative model
Nt &lt;- rnorm(100, mean=y, sd=0.2*y)
df &lt;- data.frame(time=t, numbers=Nt)
g &lt;- ExponentialRegression(data=df, fitted.parameters=c(N0=NA, r=NA, asd=NA))
plot(g, parameters="r")
as.parameters(g, index="median")
# Note that if you propose gamma prior, it will use uniform prior for r
# because r can be negative
g &lt;- ExponentialRegression(data=df, 
                           fitted.parameters=c(N0=NA, r=NA, asd=NA), 
                           prior.default.distribution="dgamma")
plot(g, parameters="r")
as.parameters(g, index="median")

# Additive model
Nt &lt;- rnorm(100, mean=y, sd=5)
df &lt;- data.frame(time=t, numbers=Nt)
g &lt;- ExponentialRegression(data=df, fitted.parameters=c(N0=NA, r=NA, bsd=NA))
plot(g, parameters="r")
as.parameters(g, index="median")

# Mixt model
Nt &lt;- rnorm(100, mean=y, sd=0.2*y+5)
df &lt;- data.frame(time=t, numbers=Nt)
g &lt;- ExponentialRegression(data=df, fitted.parameters=c(N0=NA, r=NA, asd=NA, bsd=NA))
plot(g, parameters="r")
as.parameters(g, index="median")

# Example with 3 common ways to perform the regression
t &lt;- 1:100
N0 &lt;- 100
r &lt;- 0.05
y &lt;- N0*exp(t*r)
out_glm &lt;- NULL
out_mcmc &lt;- NULL
out_nls &lt;- NULL
for (i in 1:500) {
        print(i)
        set.seed(i)
        Nt &lt;- rnorm(100, mean=y, sd=0.2*y)
        df &lt;- data.frame(time=t, numbers=Nt)
        g0 &lt;- glm(log(numbers) ~ time, data = df)
        out_glm &lt;- c(out_glm, c(exp(coef(g0)[1]), coef(g0)[2]))
        g1 &lt;- ExponentialRegression(data=df, n.iter=c(10000, 20000))
        out_mcmc &lt;- c(out_mcmc, as.parameters(g1, index="median")[1:2])
        g2 &lt;- nls(numbers ~ N0*exp(r*time), start = list(N0 = 100, r = 0.05), data = df)
        out_nls &lt;- c(out_nls, coef(g2))
}
# In conclusion the method proposed here has no biais as compare to glm and nls fits
out_glm &lt;- matrix(out_glm, ncol=2, byrow=TRUE)
out_mcmc &lt;- matrix(out_mcmc, ncol=2, byrow=TRUE)
out_nls &lt;- matrix(out_nls, ncol=2, byrow=TRUE)
mean(out_glm[, 1]); mean(out_mcmc[, 1]); mean(out_nls[, 1])
sd(out_glm[, 1])/sqrt(nrow(out_glm)); sd(out_mcmc[, 1])/sqrt(nrow(out_mcmc)); 
sd(out_nls[, 1])/sqrt(nrow(out_nls))
mean(out_glm[, 2]); mean(out_mcmc[, 2]); mean(out_nls[, 2])
sd(out_glm[, 2])/sqrt(nrow(out_glm)); sd(out_mcmc[, 2])/sqrt(nrow(out_mcmc)); 
sd(out_nls[, 2])/sqrt(nrow(out_nls))

## End(Not run)
</code></pre>

<hr>
<h2 id='extract_result'>Extract the set of parameters from a result object.</h2><span id='topic+extract_result'></span>

<h3>Description</h3>

<p>The function &quot;extract_result&quot; permits to extract the set of parameters from a result object obtained after fit_phenology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_result(result = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_result_+3A_result">result</code></td>
<td>
<p>A result file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>extract_result get the fitted parameters from a result object.
</p>


<h3>Value</h3>

<p>Return the set of fitted parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
## Not run: 
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
# result_Gratiot&lt;-fit_phenology(data=data_Gratiot, fitted.parameters=parg, 
		fixed.parameters=NULL)
data(result_Gratiot)
# Extract the fitted parameters
parg1&lt;-extract_result(result_Gratiot)

## End(Not run)
</code></pre>

<hr>
<h2 id='fit_phenology'>Fit the phenology parameters to timeseries of counts.</h2><span id='topic+fit_phenology'></span>

<h3>Description</h3>

<p>Function of the package phenology to fit parameters to timeseries.<br />
To fit data, the syntax is :<br />
Result &lt;- fit_phenology(data=dataset, fitted.parameters=par, fixed.parameters=pfixed, trace=1, hessian=TRUE)<br />
or if no parameter is fixed :<br />
Result &lt;- fit_phenology(data=dataset, fitted.parameters=par)<br />
Add trace=1 [default] to have information on the fit progression or trace=0 to hide information on the fit progression.<br />
hessian = FALSE does not estimate Hessian matrix and SE of parameters.<br />
If the parameter Theta is fixed to +Inf, a Poissonian model of daily nest distribution is implemented.<br />
Special section about cofactors:<br />
cofactors must be a data.frame with a column Date and a column for each cofactor<br />
add.cofactors are the names of the column of parameter cofactors to use as a cofactor;<br />
The model is then: parameter[add.cofactors] * cofactor[, add.cofactors]<br />
If the name of the parameter is paste0(add.cofactors, &quot;multi&quot;), then the model is:<br />
parameter[paste0(add.cofactors, &quot;multi&quot;)] * cofactor[, add.cofactors] *
(number of nests without cofactor)<br />
About parallel computing:<br />
Set options mc.cores and forking to tell what sort of parallel computing<br />
Example:<br />
options(mc.cores = detectCores())<br />
options(forking = FALSE)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_phenology(
  data = file.choose(),
  fitted.parameters = NULL,
  fixed.parameters = NULL,
  model_before = NULL,
  store.intermediate = FALSE,
  file.intermediate = "Intermediate.rda",
  hessian = FALSE,
  silent = FALSE,
  cofactors = NULL,
  add.cofactors = NULL,
  zero = 1e-09,
  lower = 0,
  upper = Inf,
  stop.fit = FALSE,
  method_Snbinom = "saddlepoint",
  control = list(trace = 1, REPORT = 1, maxit = 1000),
  method = c("Nelder-Mead", "L-BFGS-B")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_phenology_+3A_data">data</code></td>
<td>
<p>A dataset generated by add_format</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_fitted.parameters">fitted.parameters</code></td>
<td>
<p>Set of parameters to be fitted</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_model_before">model_before</code></td>
<td>
<p>The change of parameters before to estimate daily counts.</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_store.intermediate">store.intermediate</code></td>
<td>
<p>TRUE or FALSE to save the intermediates</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_file.intermediate">file.intermediate</code></td>
<td>
<p>Name of the file where to save the intermediates as a list</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_hessian">hessian</code></td>
<td>
<p>If FALSE does not estimate se of parameters</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_silent">silent</code></td>
<td>
<p>If TRUE does not show any message</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_cofactors">cofactors</code></td>
<td>
<p>data.frame with a column Date and a column for each cofactor</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_add.cofactors">add.cofactors</code></td>
<td>
<p>Names of the column of parameter cofactors to use as a cofactor</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_zero">zero</code></td>
<td>
<p>If the theoretical nest number is under this value, this value will be used</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_lower">lower</code></td>
<td>
<p>Lower bound for each parameter</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_upper">upper</code></td>
<td>
<p>Upper bound for each parameter</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_stop.fit">stop.fit</code></td>
<td>
<p>If TRUE, will stop search for parameters even if not ML</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_method_snbinom">method_Snbinom</code></td>
<td>
<p>Can be Furman, exact, or saddlepoint.</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_control">control</code></td>
<td>
<p>List for control parameters for optim</p>
</td></tr>
<tr><td><code id="fit_phenology_+3A_method">method</code></td>
<td>
<p>Method used by optim. Several can be setup.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fit_phenology fits parameters to timeseries.
</p>


<h3>Value</h3>

<p>Return a list of with data and result
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Plot the phenology and get some stats
output &lt;- plot(result_Gratiot)
# or
output &lt;- summary(result_Gratiot)

# With one sinusoid
parg &lt;- c('LengthB' = 95.187648986054285, 
           'Peak' = 173.86111755419921, 
           'LengthE' = 63.183281230994481, 
           'Max_Complete' = 33.052091519419136, 
           'MinB_Complete' = 0.21716081973776738, 
           'MinE_Complete' = 0.42444245288475702, 
           'Theta' = 3.9554976911657187, 
           'Alpha' = 0, 
           'Beta' = 0.21019683898423902, 
           'Delta' = 3.6798422076201724,
result_Gratiot1 &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
plot(result_Gratiot1)
		
# With two sinusoids
parg &lt;- c('LengthB' = 95.821859173220659, 
          'Peak' = 174.89756503758881, 
          'LengthE' = 60.954167489825352, 
          'Max_Complete' = 33.497846416498774, 
          'MinB_Complete' = 0.21331670808871037, 
          'MinE_Complete' = 0.43730327416828613, 
          'Theta' = 4.2569203480842814, 
          'Alpha1' = 0.15305562092653918, 
          'Beta1' = 0, 
          'Delta1' = 9.435730952200263, 
          'Phi1' = 15.7944494669335, 
          'Alpha' = 0, 
          'Beta' = 0.28212926001402688, 
          'Delta' = 18.651087311957518, 
          'Phi' = 9.7549929595313056)
result_Gratiot2 &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
plot(result_Gratiot2)

compare_AICc(no=result_Gratiot, 
             one=result_Gratiot1, 
             two=result_Gratiot2)

# With parametrization based on Girondot 2010
parg &lt;- c('Peak' = 173.52272236775076, 
          'Flat' = 0, 
          'LengthB' = 94.433284359804205, 
          'LengthE' = 64.288485646867329, 
          'Max_Complete' = 32.841568389778033, 
          'PMin' = 1.0368261725650889, 
          'Theta' = 3.5534818927979592)
result_Gratiot_par1 &lt;- fit_phenology(data=data_Gratiot, 
		                    fitted.parameters=parg, fixed.parameters=NULL)
# With new parametrization based on Omeyer et al. (2022):
# Omeyer, L. C. M., McKinley, T. J., Bréheret, N., Bal, G., Balchin, G. P., 
# Bitsindou, A., Chauvet, E., Collins, T., Curran, B. K., Formia, A., Girard, A., 
# Girondot, M., Godley, B. J., Mavoungou, J.-G., Poli, L., Tilley, D., 
# VanLeeuwe, H. &amp; Metcalfe, K. 2022. Missing data in sea turtle population 
# monitoring: a Bayesian statistical framework accounting for incomplete 
# sampling Front. Mar. Sci. (IF 3.661), 9, 817014.

parg &lt;- result_Gratiot_par1$par
parg &lt;- c(tp=unname(parg["Peak"]), tf=unname(parg["Flat"]), 
          s1=unname(parg["LengthB"])/4.8, s2=unname(parg["LengthE"])/4.8, 
          alpha=unname(parg["Max_Complete"]), Theta=0.66)
result_Gratiot_par2 &lt;- fit_phenology(data=data_Gratiot, 
		                             fitted.parameters=parg, 
		                             fixed.parameters=NULL)
compare_AICc(GirondotModel=result_Gratiot_par1, 
             OmeyerModel=result_Gratiot_par2)
plot(result_Gratiot_par1)
plot(result_Gratiot_par2)

# Use fit with co-factor

# First extract tide information for that place
td &lt;- tide.info(year=2001, latitude=4.9167, longitude=-52.3333)
# I keep only High tide level
td2 &lt;- td[td$Phase=="High Tide", ]
# I get the date
td3 &lt;- cbind(td2, Date=as.Date(td2$DateTime.local))
td5 &lt;- aggregate(x=td3[, c("Date", "DateTime.local", "Tide.meter")], 
                 by=list(Date=td3[, "Date"]), FUN=max)[, 2:4]
with(td5, plot(DateTime.local, Tide.meter, type="l"))
td6 &lt;- td5[, c("Date", "Tide.meter")]
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL, 
                 add.cofactors="Tide.meter")

likelihood_phenology(data=data_Gratiot, fitted.parameters = parg, 
                     cofactors=td6, add.cofactors="Tide.meter")

result_Gratiot_CF &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL, cofactors=td6, 
		add.cofactors="Tide.meter")
		
compare_AIC(WithoutCF=result_Gratiot, WithCF=result_Gratiot_CF)
plot(result_Gratiot_CF)

# Example with two series fitted with different peaks but same Length of season

Gratiot2 &lt;- Gratiot
Gratiot2[, 2] &lt;- floor(Gratiot2[, 2]*runif(n=nrow(Gratiot2)))
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete1",
                              reference=as.Date("2001-01-01"), format="%d/%m/%Y")
data_Gratiot &lt;- add_phenology(Gratiot2, name="Complete2",
                              reference=as.Date("2001-01-01"), 
                              format="%d/%m/%Y", previous=data_Gratiot)
pfixed=c(Min=0)
p &lt;- par_init(data_Gratiot, fixed.parameters = pfixed)
p &lt;- c(p, Peak_Complete1=175, Peak_Complete2=175)
p &lt;- p[-4]
p &lt;- c(p, Length=90)
p &lt;- p[-(3:4)]
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, fitted.parameters=p, 
fixed.parameters=pfixed)

# An example with bimodality

g &lt;- Gratiot
g[30:60, 2] &lt;- sample(10:20, 31, replace = TRUE)
data_g &lt;- add_phenology(g, name="Complete", reference=as.Date("2001-01-01"), 
                        format="%d/%m/%Y")
parg &lt;- c('Max.1_Complete' = 5.6344636692341856, 
          'MinB.1_Complete' = 0.15488810581002324, 
          'MinE.1_Complete' = 0.2, 
          'LengthB.1' = 22.366647176407636, 
          'Peak.1' = 47.902473939250036, 
          'LengthE.1' = 17.828495918533015, 
          'Max.2_Complete' = 33.053364083447434, 
          'MinE.2_Complete' = 0.42438173496989717, 
          'LengthB.2' = 96.651564706802702, 
          'Peak.2' = 175.3451874571835, 
          'LengthE.2' = 62.481968743789835, 
          'Theta' = 3.6423908093342572)
pfixed &lt;- c('MinB.2_Complete' = 0, 
          'Flat.1' = 0, 
          'Flat.2' = 0)
result_g &lt;- fit_phenology(data=data_g, fitted.parameters=parg, fixed.parameters=pfixed)
plot(result_g)

# Exemple with some minimum counts

nb &lt;- Gratiot[, 2]
nbs &lt;-  sample(0:1, length(nb), replace=TRUE)
nb &lt;- ifelse(nb != 0, ifelse(nbs == 1, 1, nb), 0)
nbc &lt;- ifelse(nb != 0, ifelse(nbs == 1, "minimum", "exact"), "exact")

Gratiot_minimal &lt;- cbind(Gratiot, CountTypes=nbc)
Gratiot_minimal[, 2] &lt;- nb

data_Gratiot_minimal &lt;- add_phenology(add=Gratiot_minimal, 
                                      colname.CountTypes = "CountTypes", 
                                      month_ref=1)
parg &lt;- par_init(data_Gratiot_minimal, fixed.parameters=NULL)

result_Gratiot_minimal &lt;- fit_phenology(data=data_Gratiot_minimal, 
		fitted.parameters=parg, fixed.parameters=NULL)
plot(result_Gratiot_minimal)

summary(result_Gratiot_minimal)

# Exemple with all zero counts being not recorded

Gratiot_NoZeroCounts &lt;- cbind(Gratiot[Gratiot[, 2] != 0, ], ZeroCounts=FALSE)
data_Gratiot_NoZeroCounts &lt;- add_phenology(add=Gratiot_NoZeroCounts, 
                                         colname.ZeroCounts = "ZeroCounts", 
                                         ZeroCounts.defaul=FALSE, 
                                         month_ref=1)
# or
data_Gratiot_NoZeroCounts &lt;- add_phenology(add=Gratiot[Gratiot[, 2] != 0, ], 
                                         ZeroCounts.default=FALSE, 
                                         month_ref=1)
                                         
parg &lt;- par_init(data_Gratiot_NoZeroCounts, fixed.parameters=NULL)

result_Gratiot_NoZeroCounts &lt;- fit_phenology(data=data_Gratiot_NoZeroCounts, 
		fitted.parameters=parg, fixed.parameters=NULL)
plot(result_Gratiot_NoZeroCounts)

summary(result_Gratiot_NoZeroCounts)

# Exemple with data in range of date
Gratiot_rangedate &lt;- Gratiot
Gratiot_rangedate[, 1] &lt;- as.character(Gratiot_rangedate[, 1])
Gratiot_rangedate[148, 1] &lt;- paste0(Gratiot_rangedate[148, 1], "-", Gratiot_rangedate[157, 1])
Gratiot_rangedate[148, 2] &lt;- sum(Gratiot_rangedate[148:157, 2])
Gratiot_rangedate &lt;- Gratiot_rangedate[-(149:157), ]

data_Gratiot_rangedate &lt;- add_phenology(add=Gratiot_rangedate, 
                                         month_ref=1)
parg &lt;- par_init(data_Gratiot_rangedate, fixed.parameters=NULL)

likelihood_phenology(data=data_Gratiot_rangedate, 
                     fitted.parameters=parg)

result_Gratiot_rangedate &lt;- fit_phenology(data=data_Gratiot_rangedate, 
		                                       fitted.parameters=parg, 
		                                       fixed.parameters=NULL)
		                                       
plot(result_Gratiot_rangedate)
		
		likelihood_phenology(result=result_Gratiot_rangedate)
		
# Exemple with data in range of date and CountTypes being minimum
Gratiot_rangedate &lt;- Gratiot
Gratiot_rangedate[, 1] &lt;- as.character(Gratiot_rangedate[, 1])
Gratiot_rangedate[148, 1] &lt;- paste0(Gratiot_rangedate[148, 1], "-", Gratiot_rangedate[157, 1])
Gratiot_rangedate[148, 2] &lt;- sum(Gratiot_rangedate[148:157, 2])
Gratiot_rangedate &lt;- Gratiot_rangedate[-(149:157), ]
Gratiot_rangedate &lt;- cbind(Gratiot_rangedate, CountTypes="exact")
Gratiot_rangedate[148, 2] &lt;- 100
Gratiot_rangedate[148, "CountTypes"] &lt;- "minimum"
Gratiot_rangedate[28, "CountTypes"] &lt;- "minimum"


data_Gratiot_rangedate &lt;- add_phenology(add=Gratiot_rangedate, 
                                        colname.CountTypes="CountTypes", 
                                         month_ref=1)
parg &lt;- par_init(data_Gratiot_rangedate, fixed.parameters=NULL)

result_Gratiot_rangedate &lt;- fit_phenology(data=data_Gratiot_rangedate, 
		fitted.parameters=parg, fixed.parameters=NULL)
		
	likelihood_phenology(result=result_Gratiot_rangedate)
	
	plot(result_Gratiot_rangedate)
		

## End(Not run)
</code></pre>

<hr>
<h2 id='fitCF'>Fit a model of Clutch Frequency for marine turtles.</h2><span id='topic+fitCF'></span>

<h3>Description</h3>

<p>This function fits a model of clutch frequency.<br />
This model is an enhanced version of the one published by Briane et al. (2007).<br />
Parameters are <code>mu</code> and <code>sd</code> being the parameters of a
distribution used to model the clutch frequency.<br />
This distribution is used only as a guide but has not statistical meaning.<br />
The parameter <code>p</code> is the -logit probability that a female is seen
on the beach for a particular nesting event. It includes both the probability
that it is captured but also the probability that it uses that specific beach.<br />
Several categories of females can be included in the model using index after
the name of the parameter, for example <code>mu1</code>, <code>sd1</code> and <code>mu2</code>,
<code>sd2</code> indicates that two categories of females with different clutch
frequencies distribution are present. Similarly <code>p1</code> and <code>p2</code> indicates
that two categories of females with different capture probabilities are present.<br />
If more than one category is used, then it is necessary to include the
parameter <code>OTN</code> to indicate the relative frequencies of each category.
If two categories are used, one <code>OTN</code> parameter named <code>ONT1</code> must
be included. The <code>OTN2</code> is forced to be 1. Then the relative frequency
for category 1 is <code>OTN1/(OTN1+1)</code> and for category 2 is <code>1/(OTN1+1)</code>.
Same logic must be applied for 3 and more categories with always the last one
being fixed to 1.<br />
</p>
<p>if p or a (logit of the capture probability) are equal to -Inf,
the probability of capture is 0 and if they are equal to
+Inf, the probability is 1.<br />
</p>
<p>The value of p out of the period
of nesting must be set to +Inf (capture probability=1)
to indicate that no turtle is nesting in this period.<br />
</p>
<p>p must be set to -Inf (capture probability=0) to indicate that no
monitoring has been done during a specific period of the nesting season.<br />
</p>
<p>The best way to indicate capture probability for 3D model (OCF, ECF, Period)
is to indicate p.period common for all categories and a1, a2, etc for each category.
The capture probability for category 1 will be p.period * a1, and for category 2
will be p.period * a2, etc. <br />
</p>
<p>In this case, the parameters p.period should be indicated in fitted parameters
as well as a1, but a2 must be fixed to +Inf in fixed.parameters. Then the capture
probability for category 2 will be p.period and for category 1 a1 * p.period.<br />
</p>
<p>If itnmax is equal to 0, it will return the model using the parameters without fitting them.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitCF(
  x = c(mu = 4, sd = 100, p = 0),
  fixed.parameters = NULL,
  data = stop("Data formated with TableECFOCF() must be provided"),
  method = c("Nelder-Mead", "BFGS"),
  control = list(trace = 1, REPORT = 100, maxit = 500),
  itnmax = c(500, 100),
  hessian = TRUE,
  parallel = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitCF_+3A_x">x</code></td>
<td>
<p>Initial parameters to be fitted</p>
</td></tr>
<tr><td><code id="fitCF_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Parameters that are fixed.</p>
</td></tr>
<tr><td><code id="fitCF_+3A_data">data</code></td>
<td>
<p>CMR data formated using TableECFOCF()</p>
</td></tr>
<tr><td><code id="fitCF_+3A_method">method</code></td>
<td>
<p>Method to be used by optimx()</p>
</td></tr>
<tr><td><code id="fitCF_+3A_control">control</code></td>
<td>
<p>List of controls for optimx()</p>
</td></tr>
<tr><td><code id="fitCF_+3A_itnmax">itnmax</code></td>
<td>
<p>A vector with maximum iterations for each method.</p>
</td></tr>
<tr><td><code id="fitCF_+3A_hessian">hessian</code></td>
<td>
<p>Logical to estimate SE of parameters</p>
</td></tr>
<tr><td><code id="fitCF_+3A_parallel">parallel</code></td>
<td>
<p>If TRUE, will use parallel computing for ECFOCF_f()</p>
</td></tr>
<tr><td><code id="fitCF_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, print the parameters at each step</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fitCF fit a model of Clutch Frequency for marine turtles.
</p>


<h3>Value</h3>

<p>Return a list of class ECFOCF with the fit information.<br />
The list has the following items:<br />
</p>

<ul>
<li> <p><code>data</code>: The observations to be fitted
</p>
</li>
<li> <p><code>par</code>: The fitted parameters
</p>
</li>
<li> <p><code>SE</code>: The standard error of parameters if hessian is TRUE
</p>
</li>
<li> <p><code>value</code>: The -log likelihood of observations within the fitted model
</p>
</li>
<li> <p><code>AIC</code>: The AIC of fitted model
</p>
</li>
<li> <p><code>mu</code>: The vector of fitted mu values
</p>
</li>
<li> <p><code>sd</code>: The vector of fitted sd values
</p>
</li>
<li> <p><code>prob</code>: The vector of fitted capture probabilities
</p>
</li>
<li> <p><code>a</code>: The vector of fitted capture probabilities multiplier
</p>
</li>
<li> <p><code>OTN</code>: The vector of fitted relative probabilities of contribution
</p>
</li>
<li> <p><code>period_categories</code>: A list with the different period probabilities as named vectors for each category
</p>
</li>
<li> <p><code>period</code>: The combined period probabilities using OTN as named vector
</p>
</li>
<li> <p><code>CF_categories</code>: A list with the different CF probabilities as named vectors for each category
</p>
</li>
<li> <p><code>CF</code>: The combined CF probabilities  using OTN as named vector
</p>
</li>
<li> <p><code>ECFOCF_categories</code>: A list with the different probability ECFOCF tables for each category
</p>
</li>
<li> <p><code>ECFOCF</code>: The combined table of ECFOCF  using OTN probabilities tables
</p>
</li>
<li> <p><code>ECFOCF_0</code>: The combined table of ECFOCF probabilities tables  using OTN without the OCF=0
</p>
</li>
<li> <p><code>SE_df</code>: A data.frame with SE and 95\
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Briane J-P, Rivalan P, Girondot M (2007) The inverse problem applied
to the Observed Clutch Frequency of Leatherbacks from Yalimapo beach,
French Guiana. Chelonian Conservation and Biology 6:63-69
</p>
<p>Fossette S, Kelle L, Girondot M, Goverse E, Hilterman ML, Verhage B,
Thoisy B, de, Georges J-Y (2008) The world's largest leatherback
rookeries: A review of conservation-oriented research in French
Guiana/Suriname and Gabon. Journal of Experimental Marine Biology
and Ecology 356:69-82
</p>
<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data(MarineTurtles_2002)
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002)

# Parametric model for clutch frequency
o_mu1p1_CFp &lt;- fitCF(x = c(mu = 2.1653229641404539, 
                 sd = 1.1465246643327098, 
                 p = 0.25785366120357966), 
                 fixed.parameters=NULL, 
                 data=ECFOCF_2002, hessian = TRUE)
 
# Non parametric model for clutch frequency
o_mu1p1_CFnp &lt;- fitCF(x = c(mu.1 = 18.246619595610383, 
                       mu.2 = 4.2702163522832892, 
                       mu.3 = 2.6289986859556458, 
                       mu.4 = 3.2496360919228611, 
                       mu.5 = 2.1602522716550943, 
                       mu.6 = 0.68617023351032846, 
                       mu.7 = 4.2623607001877026, 
                       mu.8 = 1.1805600042630455, 
                       mu.9 = 2.2786176350939731, 
                       mu.10 = 0.47676265496204945, 
                       mu.11 = 5.8988238539197062e-08, 
                       mu.12 = 1.4003187851424953e-07, 
                       mu.13 = 2.4128444894899776e-07, 
                       mu.14 = 2.4223748020049825e-07, 
                       p = 0.32094401970037578), 
                 fixed.parameters=c(mu.15 = 1E-10), 
                 data=ECFOCF_2002, hessian = TRUE)
                 
o_mu2p1 &lt;- fitCF(x = c(mu1 = 1.2190766766978423, 
                     sd1 = 0.80646454821956925, 
                     mu2 = 7.1886819592223246, 
                     sd2 = 0.18152887523015518, 
                     p = 0.29347220802963259, 
                     OTN = 2.9137627675219533), 
                  fixed.parameters=NULL,
                  data=ECFOCF_2002, hessian = TRUE)

o_mu1p2 &lt;- fitCF(x = c(mu = 5.3628701816871462, 
                     sd = 0.39390555498088764, 
                     p1 = 0.61159637544418755, 
                     p2 = -2.4212753004659189, 
                     OTN = 0.31898004668901009),
                 data=ECFOCF_2002, hessian = TRUE)
                 
o_mu2p2 &lt;- fitCF(x = c(mu1 = 0.043692606004492131, 
                   sd1 = 1.9446036983033428, 
                   mu2 = 7.3007868915644751, 
                   sd2 = 0.16109296152913491, 
                   p1 = 1.6860260469536992, 
                   p2 = -0.096816113083788985, 
                   OTN = 2.2604431232973501), 
                  data=ECFOCF_2002, hessian = TRUE)

compare_AIC(mu1p1=o_mu1p1_CFp, 
            mu2p1=o_mu2p1, 
            mu1p2=o_mu1p2, 
            mu2p2=o_mu2p2)
                 
o_mu3p3 &lt;- fitCF(x = c(mu1 = 0.24286312214288761, 
                            sd1 = 0.34542255091729313, 
                            mu2 = 5.0817174343025551, 
                            sd2 = 1.87435099405695, 
                            mu3 = 5.2009265101740683, 
                            sd3 = 1.79700447678357, 
                            p1 = 8.8961708614726156, 
                            p2 = 0.94790116453886453, 
                            p3 = -0.76572930634505421, 
                            OTN1 = 1.2936848663276974, 
                            OTN2 = 0.81164278235645926),
                 data=ECFOCF_2002, hessian = TRUE)
                 

o_mu3p1 &lt;- fitCF(x = structure(c(0.24387978183477, 
                                   1.2639261745506, 
                                   4.94288464711349, 
                                   1.945082889758, 
                                   4.9431672350811, 
                                   1.287663104591, 
                                   0.323636536050397, 
                                   1.37072039291397, 
                                   9.28055412564559e-06), 
                                  .Names = c("mu1", "sd1", "mu2", 
                                             "sd2", "mu3", "sd3", 
                                             "p", "OTN1", "OTN2")),
                 data=ECFOCF_2002, hessian = TRUE)
                 

o_mu1p3 &lt;- fitCF(x = structure(c(4.65792402108387, 
                                   1.58445909785, 
                                   -2.35414198317177, 
                                   0.623757854800649, 
                                   -3.62623634029326, 
                                   11.6950204755787, 
                                   4.05273728846523), 
                                   .Names = c("mu", "sd", 
                                              "p1", "p2", "p3", 
                                              "OTN1", "OTN2")),
                 data=ECFOCF_2002, hessian = TRUE)
                 
compare_AIC(mu1p1=o_mu1p1, 
            mu2p1=o_mu2p1, 
            mu1p2=o_mu1p2, 
            mu2p2=o_mu2p2, 
            mu3p3=o_mu3p3, 
            mu1p3=o_mu1p3, 
            mu3p1=o_mu3p1)
            
 # 3D model for (ECF, OCF, period)           
            
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002, 
                           date0=as.Date("2002-01-01"))

fp &lt;- rep(0, dim(ECFOCF_2002)[3])
names(fp) &lt;- paste0("p.", formatC(1:(dim(ECFOCF_2002)[3]), width=2, flag="0"))
par &lt;- c(mu = 2.6404831115214353, 
        sd = 0.69362774786433479, 
        mu_season = 12.6404831115214353, 
        sd_season = 1.69362774786433479)
par &lt;- c(par, fp[attributes(ECFOCF_2002)$table["begin"]:
                 attributes(ECFOCF_2002)$table["final"]])
                 
# The value of p (logit of the capture probability) out of the period 
# of nesting must be set to +Inf (capture probability=1)
# to indicate that no turtle is nesting in this period

# p must be set to -Inf (capture probability=0) to indicate that no
# monitoring has been done during a specific period of the nesting season.

fixed.parameters &lt;- c(p=+Inf)
# The fitted values are:
par &lt;- c(mu = 2.4911638591178051, 
         sd = 0.96855483039640977, 
         mu_season = 13.836059118657793, 
         sd_season = 0.17440085345943984, 
         p.10 = 1.3348233607728222, 
         p.11 = 1.1960387774393837, 
         p.12 = 0.63025680979544774, 
         p.13 = 0.38648155002707452, 
         p.14 = 0.31547864054366048, 
         p.15 = 0.19720001827017075, 
         p.16 = 0.083199496372073328, 
         p.17 = 0.32969130595897905, 
         p.18 = 0.36582777525265819, 
         p.19 = 0.30301248314170637, 
         p.20 = 0.69993987591518514, 
         p.21 = 0.13642423871641118, 
         p.22 = -1.3949268190534629)

o_mu1p1season1 &lt;- fitCF(x=par, data=ECFOCF_2002, 
                        fixed.parameters=fixed.parameters)

# Same model but with two different models of capture probabilities
                        
fp &lt;- rep(0, dim(ECFOCF_2002)[3])
names(fp) &lt;- paste0("p1.", formatC(1:(dim(ECFOCF_2002)[3]), width=2, flag="0"))
par &lt;- c(mu = 2.6404831115214353, 
        sd = 0.69362774786433479, 
        mu_season = 12.6404831115214353, 
        sd_season = 1.69362774786433479)
par &lt;- c(par, fp[attributes(ECFOCF_2002)$table["begin"]:
                 attributes(ECFOCF_2002)$table["final"]])
names(fp) &lt;- paste0("p2.", formatC(1:(dim(ECFOCF_2002)[3]), width=2, flag="0"))
par &lt;- c(par, fp[attributes(ECFOCF_2002)$table["begin"]:
                 attributes(ECFOCF_2002)$table["final"]])
fixed.parameters &lt;- c(p1=+Inf, p2=+Inf)

o_mu1p2season1 &lt;- fitCF(x=par, data=ECFOCF_2002, 
                        fixed.parameters=fixed.parameters)

# Here the two different capture probabilities are different 
# by a constant:
# p1=invlogit(-p)     [Note that invlogit(-a1) = 1]
# p2=invlogit(-p)*invlogit(-a2)

fp &lt;- rep(0, dim(ECFOCF_2002)[3])
names(fp) &lt;- paste0("p.", formatC(1:(dim(ECFOCF_2002)[3]), width=2, flag="0"))
par &lt;- c(mu = 2.6404831115214353, 
        sd = 0.69362774786433479, 
        mu_season = 12.6404831115214353, 
        sd_season = 1.69362774786433479,  
        a2=0)
par &lt;- c(par, fp[attributes(ECFOCF_2002)$table["begin"]:
                 attributes(ECFOCF_2002)$table["final"]])
fixed.parameters &lt;- c(a1=+Inf, p=+Inf)

o_mu1p1aseason1 &lt;- fitCF(x=par, data=ECFOCF_2002, 
                        fixed.parameters=fixed.parameters)
                        data=ECFOCF_2002)
 

## End(Not run)
</code></pre>

<hr>
<h2 id='fitCF_MHmcmc'>Run the Metropolis-Hastings algorithm for ECFOCF data</h2><span id='topic+fitCF_MHmcmc'></span>

<h3>Description</h3>

<p>Run the Metropolis-Hastings algorithm for RMU.data.<br />
The number of iterations is n.iter+n.adapt+1 because the initial likelihood is also displayed.<br />
I recommend thin=1 because the method to estimate SE uses resampling.<br />
As initial point is maximum likelihood, n.adapt = 0 is a good solution.<br />
The parameters intermediate and filename are used to save intermediate results every 'intermediate' iterations (for example 1000). Results are saved in a file of name filename.<br />
The parameter previous is used to indicate the list that has been save using the parameters intermediate and filename. It permits to continue a mcmc search.<br />
These options are used to prevent the consequences of computer crash or if the run is very very long and computer processes at time limited.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitCF_MHmcmc(
  result = stop("An output from fitCF() must be provided"),
  n.iter = 10000,
  parametersMCMC = stop("A parameter set from fitCF_MHmcmc_p() must be provided"),
  n.chains = 1,
  n.adapt = 0,
  thin = 1,
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  trace = FALSE,
  traceML = FALSE,
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitCF_MHmcmc_+3A_result">result</code></td>
<td>
<p>An object obtained after a SearchR fit</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for each step</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_parametersmcmc">parametersMCMC</code></td>
<td>
<p>A set of parameters used as initial point for searching with information on priors</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_thin">thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive content</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_trace">trace</code></td>
<td>
<p>TRUE or FALSE or period, shows progress</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_traceml">traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_intermediate">intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_filename">filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_+3A_previous">previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fitCF_MHmcmc runs the Metropolis-Hastings algorithm for ECFOCF (Bayesian MCMC)
</p>


<h3>Value</h3>

<p>A list with resultMCMC being mcmc.list object, resultLnL being likelihoods and parametersMCMC being the parameters used
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
data(MarineTurtles_2002)
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002)

# Paraetric model for clutch frequency
o_mu1p1_CFp &lt;- fitCF(x = c(mu = 2.1653229641404539, 
                 sd = 1.1465246643327098, 
                 p = 0.25785366120357966), 
                 fixed.parameters=NULL, 
                 data=ECFOCF_2002, hessian = TRUE)
                           
pMCMC &lt;- fitCF_MHmcmc_p(result=o_mu1p1_CFp, accept=TRUE)
fitCF_MCMC &lt;- fitCF_MHmcmc(result = o_mu1p1_CFp, n.iter = 1000, 
                           parametersMCMC = pMCMC, n.chains = 1, n.adapt = 0, 
                           adaptive=TRUE, 
                           thin = 1, trace = TRUE)
                           
plot(fitCF_MCMC, parameters="mu")
plot(fitCF_MCMC, parameters="sd")
plot(fitCF_MCMC, parameters="p", xlim=c(0, 0.5), breaks=seq(from=0, to=0.5, by=0.05))
plot(fitCF_MCMC, parameters="p", transform = invlogit, xlim=c(0, 1), 
     breaks=c(seq(from=0, to=1, by=0.05)))


## End(Not run)
</code></pre>

<hr>
<h2 id='fitCF_MHmcmc_p'>Generate set of parameters to be used with fitCF_MHmcmc()</h2><span id='topic+fitCF_MHmcmc_p'></span>

<h3>Description</h3>

<p>Interactive script used to generate set of parameters to be used with fitCF_MHmcmc().<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitCF_MHmcmc_p(
  result = stop("An output from fitCF() must be provided"),
  density = "dunif",
  accept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitCF_MHmcmc_p_+3A_result">result</code></td>
<td>
<p>An object obtained after a fitCF() fit</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_p_+3A_density">density</code></td>
<td>
<p>Preset of density; can be dnorm or dunif</p>
</td></tr>
<tr><td><code id="fitCF_MHmcmc_p_+3A_accept">accept</code></td>
<td>
<p>If TRUE, does not wait for user interaction</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fitCF_MHmcmc_p generates set of parameters to be used with fitCF_MHmcmc()
</p>


<h3>Value</h3>

<p>A matrix with the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
data(MarineTurtles_2002)
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002)

# Paraetric model for clutch frequency
o_mu1p1_CFp &lt;- fitCF(x = c(mu = 2.1653229641404539, 
                 sd = 1.1465246643327098, 
                 p = 0.25785366120357966), 
                 fixed.parameters=NULL, 
                 data=ECFOCF_2002, hessian = TRUE)
                           
pMCMC &lt;- fitCF_MHmcmc_p(result=o_mu1p1_CFp, accept=TRUE)
fitCF_MCMC &lt;- fitCF_MHmcmc(result = o_mu1p1_CFp, n.iter = 10000, 
                           parametersMCMC = pMCMC, n.chains = 1, n.adapt = 0, 
                           thin = 1, trace = FALSE)
plot(fitCF_MCMC, parameters="mu")
plot(fitCF_MCMC, parameters="sd")
plot(fitCF_MCMC, parameters="p", xlim=c(0, 0.5), breaks=seq(from=0, to=0.5, by=0.05))
plot(fitCF_MCMC, parameters="p", transform = invlogit, xlim=c(0, 1), 
     breaks=c(seq(from=0, to=1, by=0.05)))

## End(Not run)
</code></pre>

<hr>
<h2 id='fitRMU'>Adjust incomplete timeseries with various constraints.</h2><span id='topic+fitRMU'></span>

<h3>Description</h3>

<p>The data must be a data.frame with the first column being years
and two columns for each beach: the average and the se for the estimate.<br />
The correspondence between mean, se and density for each rookery are given in the RMU.names data.frame.<br />
This data.frame must have a column named mean, another named se and a third named density. If
no sd column exists, no sd will be considered for the series and if no density column exists, it
will be considered as being &quot;dnorm&quot; (Gaussian distribution).<br />
The aggregated number of nests and its confidence interval can be obtained using CI.RMU().<br />
The names of beach columns must not begin by T_, SD_, a0_, a1_ or a2_ and cannot be r.<br />
A RMU is the acronyme for Regional Managment Unit. See:<br />
Wallace, B.P., DiMatteo, A.D., Hurley, B.J., Finkbeiner, E.M., Bolten, A.B.,
Chaloupka, M.Y., Hutchinson, B.J., Abreu-Grobois, F.A., Amorocho, D., Bjorndal, K.A.,
Bourjea, J., Bowen, B.W., Dueñas, R.B., Casale, P., Choudhury, B.C., Costa, A.,
Dutton, P.H., Fallabrino, A., Girard, A., Girondot, M., Godfrey, M.H., Hamann, M.,
López-Mendilaharsu, M., Marcovaldi, M.A., Mortimer, J.A., Musick, J.A., Nel, R.,
Seminoff, J.A., Troëng, S., Witherington, B., Mast, R.B., 2010. Regional
management units for marine turtles: a novel framework for prioritizing
conservation and research across multiple scales. PLoS One 5, e15465.<br />
Variance for each value is additive based on both the observed SE (in the RMU.data
object) and a value.<br />
The value is a global constant when model.SD is &quot;global-constant&quot;. <br />
The value is proportional to the observed number of nests when model.SD is
&quot;global-proportional&quot; with aSD_*observed+SD_ with aSD_ and SD_ being fitted
values. This value is fixed to zero when model.SD is &quot;Zero&quot;.<br />
The value is dependent on the rookery when model.SD is equal to
&quot;Rookery-constant&quot; or &quot;Rookery-proportional&quot; with a similar formula as previously
described for &quot;global&quot;.<br />
if method is NULL, it will simply return the names of required parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitRMU(
  RMU.data = stop("data parameter must be provided"),
  years.byrow = TRUE,
  RMU.names = NULL,
  model.trend = "Constant",
  model.rookeries = "Constant",
  model.SD = "Global-constant",
  parameters = NULL,
  fixed.parameters = NULL,
  SE = NULL,
  method = c("Nelder-Mead", "BFGS"),
  control = list(trace = 1),
  itnmax = c(1500, 1500),
  cptmax.optim = 100,
  limit.cpt.optim = 1e-05,
  hessian = TRUE,
  replicate.CI = 1000,
  colname.year = "Year",
  maxL = 1e+09
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitRMU_+3A_rmu.data">RMU.data</code></td>
<td>
<p>A data.frame with a column Year (the name is defined in colname.year) and one to three columns per rookery defined in RMU.names</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_years.byrow">years.byrow</code></td>
<td>
<p>If TRUE, the RMU.data data.frame is organized with years in rows</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_rmu.names">RMU.names</code></td>
<td>
<p>A dataframe with one to three columns indicating name of columns for mean, standard deviation, and distribution for roockeris</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_model.trend">model.trend</code></td>
<td>
<p>Can be Constant, Exponential or Year-specific</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_model.rookeries">model.rookeries</code></td>
<td>
<p>Description temporal change in rookeries proportion. It be Constant, First-order or Second-order</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_model.sd">model.SD</code></td>
<td>
<p>Can be Zero, Global-constant, Global-proportional or Rookery-constant. See description.</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_parameters">parameters</code></td>
<td>
<p>Parameters to fit</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Parameters that are fixed</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_se">SE</code></td>
<td>
<p>Parameters SE for example from fitRMU_MHmcmc()</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_method">method</code></td>
<td>
<p>Methods to be used by optim()</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_control">control</code></td>
<td>
<p>List of controls for optim()</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_itnmax">itnmax</code></td>
<td>
<p>A vector with maximum iterations for each method.</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_cptmax.optim">cptmax.optim</code></td>
<td>
<p>How many times optim can be ran when likelihood is better.</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_limit.cpt.optim">limit.cpt.optim</code></td>
<td>
<p>Limit to consider that likelihood is better.</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_hessian">hessian</code></td>
<td>
<p>If TRUE, the hessian matrix is calculated and then the standard error of parameters.</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates to estimate CI of proportion for each rookery</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_colname.year">colname.year</code></td>
<td>
<p>Name of the column to be used as time index</p>
</td></tr>
<tr><td><code id="fitRMU_+3A_maxl">maxL</code></td>
<td>
<p>If an error is produced during the estimation of likelihood, replace -Ln L by this value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fitRMU is used to estimate missing information when several linked values are observed along a timeseries
</p>


<h3>Value</h3>

<p>Return a list with the results from optim and synthesis for proportions and numbers
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Fill gaps in RMU: 
<code><a href="#topic+CI.RMU">CI.RMU</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc">fitRMU_MHmcmc</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc_p">fitRMU_MHmcmc_p</a>()</code>,
<code><a href="#topic+logLik.fitRMU">logLik.fitRMU</a>()</code>,
<code><a href="#topic+plot.fitRMU">plot.fitRMU</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
RMU.names.AtlanticW &lt;- data.frame(mean=c("Yalimapo.French.Guiana", 
                                         "Galibi.Suriname", 
                                         "Irakumpapy.French.Guiana"), 
                                 se=c("se_Yalimapo.French.Guiana", 
                                      "se_Galibi.Suriname", 
                                      "se_Irakumpapy.French.Guiana"), 
                                 density=c("density_Yalimapo.French.Guiana", 
                                           "density_Galibi.Suriname", 
                                           "density_Irakumpapy.French.Guiana"))
data.AtlanticW &lt;- data.frame(Year=c(1990:2000), 
      Yalimapo.French.Guiana=c(2076, 2765, 2890, 2678, NA, 
                               6542, 5678, 1243, NA, 1566, 1566),
      se_Yalimapo.French.Guiana=c(123.2, 27.7, 62.5, 126, NA, 
                                 230, 129, 167, NA, 145, 20),
      density_Yalimapo.French.Guiana=rep("dnorm", 11), 
      Galibi.Suriname=c(276, 275, 290, NA, 267, 
                       542, 678, NA, 243, 156, 123),
      se_Galibi.Suriname=c(22.3, 34.2, 23.2, NA, 23.2, 
                           4.3, 2.3, NA, 10.3, 10.1, 8.9),
      density_Galibi.Suriname=rep("dnorm", 11), 
      Irakumpapy.French.Guiana=c(1076, 1765, 1390, 1678, NA, 
                               3542, 2678, 243, NA, 566, 566),
      se_Irakumpapy.French.Guiana=c(23.2, 29.7, 22.5, 226, NA, 
                                 130, 29, 67, NA, 15, 20), 
      density_Irakumpapy.French.Guiana=rep("dnorm", 11)
      )
                           
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero")
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero", 
               control=list(trace=1, REPORT=100, maxit=500, parscale = c(3000, -0.2, 0.6)))
               
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero", method=c("Nelder-Mead","BFGS"), 
               control = list(trace = 0, REPORT = 100, maxit = 500, 
               parscale = c(3000, -0.2, 0.6)))
expo &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Exponential", 
               model.SD="Zero", method=c("Nelder-Mead","BFGS"), 
               control = list(trace = 0, REPORT = 100, maxit = 500, 
               parscale = c(6000, -0.05, -0.25, 0.6)))
YS &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", method=c("Nelder-Mead","BFGS"), 
             model.SD="Zero")
YS1 &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", method=c("Nelder-Mead","BFGS"), 
             model.SD="Zero", model.rookeries="First-order")
YS1_cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", 
             model.SD="Constant", model.rookeries="First-order", 
             parameters=YS1$par, method=c("Nelder-Mead","BFGS"))
YS2 &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific",
             model.SD="Zero", model.rookeries="Second-order", 
             parameters=YS1$par, method=c("Nelder-Mead","BFGS"))
YS2_cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific",
             model.SD="Constant", model.rookeries="Second-order", 
             parameters=YS1_cst$par, method=c("Nelder-Mead","BFGS"))
               
compare_AIC(Constant=cst, Exponential=expo, 
YearSpecific=YS)

compare_AIC(YearSpecific_ProportionsFirstOrder_Zero=YS1,
YearSpecific_ProportionsFirstOrder_Constant=YS1_cst)

compare_AIC(YearSpecific_ProportionsConstant=YS,
           YearSpecific_ProportionsFirstOrder=YS1,
           YearSpecific_ProportionsSecondOrder=YS2)
           
compare_AIC(YearSpecific_ProportionsFirstOrder=YS1_cst,
           YearSpecific_ProportionsSecondOrder=YS2_cst)

# Example of different types of plots
plot(cst, main="Use of different beaches along the time", what="total", 
     ylim=c(0, 4000))
plot(cst, main="Use of different beaches along the time", what = "proportions", 
     replicate.CI=0)
plot(cst, main="Use of different beaches along the time", what = "numbers", 
     aggregate="model", ylim=c(0, 4000), replicate.CI=0)
plot(cst, main="Use of different beaches along the time", what = "numbers", 
     aggregate="both", ylim=c(0, 11000), replicate.CI=0)
     
plot(expo, main="Use of different beaches along the time", what="total")
plot(YS2_cst, main="Use of different beaches along the time", what="total")

plot(YS1, main="Use of different beaches along the time")
plot(YS1_cst, main="Use of different beaches along the time")
plot(YS1_cst, main="Use of different beaches along the time", what="numbers")

# Gamma distribution should be used for MCMC outputs

RMU.names.AtlanticW &lt;- data.frame(mean=c("Yalimapo.French.Guiana", 
                                         "Galibi.Suriname", 
                                         "Irakumpapy.French.Guiana"), 
                                 se=c("se_Yalimapo.French.Guiana", 
                                      "se_Galibi.Suriname", 
                                      "se_Irakumpapy.French.Guiana"), 
                                 density=c("density_Yalimapo.French.Guiana", 
                                           "density_Galibi.Suriname", 
                                           "density_Irakumpapy.French.Guiana"), 
                                           stringsAsFactors = FALSE)
                                           
data.AtlanticW &lt;- data.frame(Year=c(1990:2000), 
      Yalimapo.French.Guiana=c(2076, 2765, 2890, 2678, NA, 
                               6542, 5678, 1243, NA, 1566, 1566),
      se_Yalimapo.French.Guiana=c(123.2, 27.7, 62.5, 126, NA, 
                                 230, 129, 167, NA, 145, 20),
      density_Yalimapo.French.Guiana=rep("dgamma", 11), 
      Galibi.Suriname=c(276, 275, 290, NA, 267, 
                       542, 678, NA, 243, 156, 123),
      se_Galibi.Suriname=c(22.3, 34.2, 23.2, NA, 23.2, 
                           4.3, 2.3, NA, 10.3, 10.1, 8.9),
      density_Galibi.Suriname=rep("dgamma", 11), 
      Irakumpapy.French.Guiana=c(1076, 1765, 1390, 1678, NA, 
                               3542, 2678, 243, NA, 566, 566),
      se_Irakumpapy.French.Guiana=c(23.2, 29.7, 22.5, 226, NA, 
                                 130, 29, 67, NA, 15, 20), 
      density_Irakumpapy.French.Guiana=rep("dgamma", 11), stringsAsFactors = FALSE
      )
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero")

## End(Not run)
</code></pre>

<hr>
<h2 id='fitRMU_MHmcmc'>Run the Metropolis-Hastings algorithm for RMU.data</h2><span id='topic+fitRMU_MHmcmc'></span>

<h3>Description</h3>

<p>Run the Metropolis-Hastings algorithm for RMU.data.<br />
The number of iterations is n.iter+n.adapt+1 because the initial likelihood is also displayed.<br />
I recommend thin=1 because the method to estimate SE uses resampling.<br />
As initial point is maximum likelihood, n.adapt = 0 is a good solution.<br />
The parameters intermediate and filename are used to save intermediate results every 'intermediate' iterations (for example 1000). Results are saved in a file of name filename.<br />
The parameter previous is used to indicate the list that has been save using the parameters intermediate and filename. It permits to continue a mcmc search.<br />
These options are used to prevent the consequences of computer crash or if the run is very very long and computer processes at time limited.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitRMU_MHmcmc(
  result = stop("An output from fitRMU() must be provided"),
  n.iter = 10000,
  parametersMCMC = stop("A parameter set from fitRMU_MHmcmc_p() must be provided"),
  n.chains = 1,
  n.adapt = 0,
  thin = 1,
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  trace = FALSE,
  traceML = FALSE,
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitRMU_MHmcmc_+3A_result">result</code></td>
<td>
<p>An object obtained after a SearchR fit</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for each step</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_parametersmcmc">parametersMCMC</code></td>
<td>
<p>A set of parameters used as initial point for searching with information on priors</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_thin">thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive content</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_trace">trace</code></td>
<td>
<p>TRUE or FALSE or period, shows progress</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_traceml">traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_intermediate">intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_filename">filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_+3A_previous">previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fitRMU_MHmcmc runs the Metropolis-Hastings algorithm for RMU.data (Bayesian MCMC)
</p>


<h3>Value</h3>

<p>A list with resultMCMC being mcmc.list object, resultLnL being likelihoods and parametersMCMC being the parameters used
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Fill gaps in RMU: 
<code><a href="#topic+CI.RMU">CI.RMU</a>()</code>,
<code><a href="#topic+fitRMU">fitRMU</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc_p">fitRMU_MHmcmc_p</a>()</code>,
<code><a href="#topic+logLik.fitRMU">logLik.fitRMU</a>()</code>,
<code><a href="#topic+plot.fitRMU">plot.fitRMU</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
RMU.names.AtlanticW &lt;- data.frame(mean=c("Yalimapo.French.Guiana", 
                                         "Galibi.Suriname", 
                                         "Irakumpapy.French.Guiana"), 
                                 se=c("se_Yalimapo.French.Guiana", 
                                      "se_Galibi.Suriname", 
                                      "se_Irakumpapy.French.Guiana"))
data.AtlanticW &lt;- data.frame(Year=c(1990:2000), 
      Yalimapo.French.Guiana=c(2076, 2765, 2890, 2678, NA, 
                               6542, 5678, 1243, NA, 1566, 1566),
      se_Yalimapo.French.Guiana=c(123.2, 27.7, 62.5, 126, NA, 
                                 230, 129, 167, NA, 145, 20),
      Galibi.Suriname=c(276, 275, 290, NA, 267, 
                       542, 678, NA, 243, 156, 123),
      se_Galibi.Suriname=c(22.3, 34.2, 23.2, NA, 23.2, 
                           4.3, 2.3, NA, 10.3, 10.1, 8.9),
      Irakumpapy.French.Guiana=c(1076, 1765, 1390, 1678, NA, 
                               3542, 2678, 243, NA, 566, 566),
      se_Irakumpapy.French.Guiana=c(23.2, 29.7, 22.5, 226, NA, 
                                 130, 29, 67, NA, 15, 20))
                           
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero")
pMCMC &lt;- fitRMU_MHmcmc_p(result=cst, accept=TRUE)
fitRMU_MCMC &lt;- fitRMU_MHmcmc(result = cst, n.iter = 10000, 
parametersMCMC = pMCMC, n.chains = 1, n.adapt = 0, thin = 1, trace = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='fitRMU_MHmcmc_p'>Generates set of parameters to be used with fitRMU_MHmcmc()</h2><span id='topic+fitRMU_MHmcmc_p'></span>

<h3>Description</h3>

<p>Interactive or automatic script used to generate set of parameters to be
used with fitRMU_MHmcmc().<br />
If density=&quot;dgamma&quot; is used, a uniform distribution is used for r, as
r can be negative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitRMU_MHmcmc_p(
  result = stop("An output from fitRMU() must be provided"),
  density = "dunif",
  accept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitRMU_MHmcmc_p_+3A_result">result</code></td>
<td>
<p>An object obtained after a fitRMU() fit</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_p_+3A_density">density</code></td>
<td>
<p>Preset of density; can be dnorm, dunif, or dgamma</p>
</td></tr>
<tr><td><code id="fitRMU_MHmcmc_p_+3A_accept">accept</code></td>
<td>
<p>If TRUE, does not wait for user interaction</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fitRMU_MHmcmc_p generates set of parameters to be used with fitRMU_MHmcmc()
</p>


<h3>Value</h3>

<p>A matrix with the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Fill gaps in RMU: 
<code><a href="#topic+CI.RMU">CI.RMU</a>()</code>,
<code><a href="#topic+fitRMU">fitRMU</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc">fitRMU_MHmcmc</a>()</code>,
<code><a href="#topic+logLik.fitRMU">logLik.fitRMU</a>()</code>,
<code><a href="#topic+plot.fitRMU">plot.fitRMU</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
RMU.name.AtlanticW &lt;- data.frame(mean=c("Yalimapo.French.Guiana", 
                                         "Galibi.Suriname", 
                                         "Irakumpapy.French.Guiana"), 
                                 se=c("se_Yalimapo.French.Guiana", 
                                      "se_Galibi.Suriname", 
                                      "se_Irakumpapy.French.Guiana"))
data.AtlanticW &lt;- data.frame(Year=c(1990:2000), 
      Yalimapo.French.Guiana=c(2076, 2765, 2890, 2678, NA, 
                               6542, 5678, 1243, NA, 1566, 1566),
      se_Yalimapo.French.Guiana=c(123.2, 27.7, 62.5, 126, NA, 
                                 230, 129, 167, NA, 145, 20),
      Galibi.Suriname=c(276, 275, 290, NA, 267, 
                       542, 678, NA, 243, 156, 123),
      se_Galibi.Suriname=c(22.3, 34.2, 23.2, NA, 23.2, 
                           4.3, 2.3, NA, 10.3, 10.1, 8.9),
      Irakumpapy.French.Guiana=c(1076, 1765, 1390, 1678, NA, 
                               3542, 2678, 243, NA, 566, 566),
      se_Irakumpapy.French.Guiana=c(23.2, 29.7, 22.5, 226, NA, 
                                 130, 29, 67, NA, 15, 20))
                           
cst &lt;- fitRMU(data=data.AtlanticW, RMU.name=RMU.name.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero")
pMCMC &lt;- fitRMU_MHmcmc_p(result=cst, accept=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='fixed.parameters0'>Generate a set of fixed parameters for series with only 0 counts</h2><span id='topic+fixed.parameters0'></span>

<h3>Description</h3>

<p>This function generates a set of fixed parameters for series with only 0 counts.<br />
The parameter series must be a result from add_phenology().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixed.parameters0(
  series = stop("A result from add_phenology() must be provided.")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fixed.parameters0_+3A_series">series</code></td>
<td>
<p>Set of series generated with add_phenology()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fixed.parameters0 generates a set of fixed parameters for series with only 0 counts
</p>


<h3>Value</h3>

<p>Return a set of parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
refdate &lt;- as.Date("2001-01-01")
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
	reference=refdate, format="%d/%m/%Y")
pfixed &lt;- fixed.parameters0(data_Gratiot)

## End(Not run)
</code></pre>

<hr>
<h2 id='generateCF'>Generate a set of data to test Clutch Frequency for marine turtles.</h2><span id='topic+generateCF'></span>

<h3>Description</h3>

<p>This function generates a dataframe to test <code>fitCF()</code>.<br />
This model is an enhanced version of the one published by Briane et al. (2007).<br />
Parameters are <code>mu</code> and <code>sd</code> being the parameters of a
distribution used to model the clutch frequency.<br />
This distribution is used only as a guide but has not statistical meaning.<br />
The parameter <code>p</code> is the -logit probability that a female is seen
on the beach for a particular nesting event. It includes both the probability
that it is captured but also the probability that it uses that specific beach.<br />
Several categories of females can be included in the model using index after
the name of the parameter, for example <code>mu1</code>, <code>sd1</code> and <code>mu2</code>,
<code>sd2</code> indicates that two categories of females with different clutch
frequencies distribution are present. Similarly <code>p1</code> and <code>p2</code> indicates
that two categories of females with different capture probabilities are present.<br />
If more than one category is used, then it is necessary to include the
parameter <code>OTN</code> to indicate the relative frequencies of each category.
If two categories are used, one <code>OTN</code> parameter named <code>ONT1</code> must
be included. The <code>OTN2</code> is forced to be 1. Then the relative frequency
for category 1 is <code>OTN1/(OTN1+1)</code> and for category 2 is <code>1/(OTN1+1)</code>.
Same logic must be applied for 3 and more categories with always the last one
being fixed to 1.<br />
</p>
<p>if p or a (logit of the capture probability) are equal to -Inf,
the probability of capture is 0 and if they are equal to
+Inf, the probability is 1.<br />
</p>
<p>The value of p out of the period
of nesting must be set to +Inf (capture probability=1)
to indicate that no turtle is nesting in this period.<br />
</p>
<p>p must be set to -Inf (capture probability=0) to indicate that no
monitoring has been done during a specific period of the nesting season.<br />
</p>
<p>The best way to indicate capture probability for 3D model (OCF, ECF, Period)
is to indicate p.period common for all categories and a1, a2, etc for each category.
The capture probability for category 1 will be p.period * a1, and for category 2
will be p.period * a2, etc. <br />
</p>
<p>In this case, the parameters p.period should be indicated in fitted parameters
as well as a1, but a2 must be fixed to +Inf in fixed.parameters. Then the capture
probability for category 2 will be p.period and for category 1 a1 * p.period.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateCF(
  x = c(mu = 4, sd = 1, p = +Inf, mu_season = 13.8360591186578, sd_season =
    0.17440085345944),
  MeanDaysBetween2Nests = 9.8,
  date0 = as.Date("2020-01-01"),
  n = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generateCF_+3A_x">x</code></td>
<td>
<p>Initial parameters to be used</p>
</td></tr>
<tr><td><code id="generateCF_+3A_meandaysbetween2nests">MeanDaysBetween2Nests</code></td>
<td>
<p>Number of days in average between two nests</p>
</td></tr>
<tr><td><code id="generateCF_+3A_date0">date0</code></td>
<td>
<p>Initial date to generate data</p>
</td></tr>
<tr><td><code id="generateCF_+3A_n">n</code></td>
<td>
<p>Number of individuals to model</p>
</td></tr>
<tr><td><code id="generateCF_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, give information about each animal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>generateCF generates set of data to test fitCF.
</p>


<h3>Value</h3>

<p>Return a list with 4 elements: Category, CF, Beginning and Observations being a
dataframe of individuals.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Briane J-P, Rivalan P, Girondot M (2007) The inverse problem applied
to the Observed Clutch Frequency of Leatherbacks from Yalimapo beach,
French Guiana. Chelonian Conservation and Biology 6:63-69
</p>
<p>Fossette S, Kelle L, Girondot M, Goverse E, Hilterman ML, Verhage B,
Thoisy B, de, Georges J-Y (2008) The world's largest leatherback
rookeries: A review of conservation-oriented research in French
Guiana/Suriname and Gabon. Journal of Experimental Marine Biology
and Ecology 356:69-82
</p>
<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example

par &lt;- c(mu = 2.4911638591178051, 
         sd = 0.96855483039640977, 
         mu_season = 13.836059118657793, 
         sd_season = 0.17440085345943984, 
         p.10 = 1.3348233607728222, 
         p.11 = 1.1960387774393837, 
         p.12 = 0.63025680979544774, 
         p.13 = 0.38648155002707452, 
         p.14 = 0.31547864054366048, 
         p.15 = 0.19720001827017075, 
         p.16 = 0.083199496372073328, 
         p.17 = 0.32969130595897905, 
         p.18 = 0.36582777525265819, 
         p.19 = 0.30301248314170637, 
         p.20 = 0.69993987591518514, 
         p.21 = 0.13642423871641118, 
         p.22 = -1.3949268190534629, 
         p=+Inf)

o_mu1p1season1 &lt;- generateCF(x=par, n=1, verbose=TRUE)
o_mu1p1season1 &lt;- generateCF(x=par, n=1000)
plot(o_mu1p1season1$CF)
hist(o_mu1p1season1$Beginning)

## End(Not run)
</code></pre>

<hr>
<h2 id='Gratiot'>Leatherback nest counts from Gratiot et al. (2006) Figure 1</h2><span id='topic+Gratiot'></span>

<h3>Description</h3>

<p>Leatherback nest counts from Gratiot et al. (2006) Figure 1. These
data have been collected by the ONG Kwata in French Guiana.<br />
The data have been obtained from the graph of the publication (see reference).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gratiot
</code></pre>


<h3>Format</h3>

<p>data.frame with the morning date in the first column and the nest counts on the second one.
</p>


<h3>Details</h3>

<p>Leatherback nest counts from Gratiot et al. (2006) Figure 1
</p>


<h3>Author(s)</h3>

<p>KWATA ONG
</p>


<h3>References</h3>

<p>Gratiot, N., Gratiot, J., de Thoisy, B. &amp; Kelle, L. 2006.
Estimation of marine turtles nesting season from incomplete
data ; statistical adjustment of a sinusoidal function. Animal
Conservation, 9, 95-102.
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Read a file with data
data(Gratiot)
</code></pre>

<hr>
<h2 id='IPFit'>Fit a model of Internesting Period for marine turtles.</h2><span id='topic+IPFit'></span>

<h3>Description</h3>

<p>This function fits a model of internesting period using maximum
likelihood or using Metropolis-Hastings algorithm with Bayesian model.<br />
The fit using maximum likelihood is not the best strategy because the objective
function is based on a stochastic model (and then a single set of parameters
does not produce exactly the same output each time).
The use of Metropolis-Hastings algorithm (a Markov chain Monte Carlo method)
should be prefered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPFit(
  x = NULL,
  fixed.parameters = NULL,
  data = stop("Formated data must be provided"),
  method = c("Nelder-Mead", "BFGS"),
  control = list(trace = 1, REPORT = 100, maxit = 500),
  itnmax = c(500, 100),
  hessian = TRUE,
  verbose = TRUE,
  parallel = TRUE,
  model = c("MH", "ML"),
  parametersMH,
  n.iter = 10000,
  n.chains = 1,
  n.adapt = 100,
  thin = 30,
  trace = TRUE,
  adaptive = TRUE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  intermediate = NULL,
  filename = "intermediate.Rdata"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPFit_+3A_x">x</code></td>
<td>
<p>Initial parameters to be fitted</p>
</td></tr>
<tr><td><code id="IPFit_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Parameters that are fixed.</p>
</td></tr>
<tr><td><code id="IPFit_+3A_data">data</code></td>
<td>
<p>Data as a vector</p>
</td></tr>
<tr><td><code id="IPFit_+3A_method">method</code></td>
<td>
<p>Method to be used by optimx()</p>
</td></tr>
<tr><td><code id="IPFit_+3A_control">control</code></td>
<td>
<p>List of controls for optimx()</p>
</td></tr>
<tr><td><code id="IPFit_+3A_itnmax">itnmax</code></td>
<td>
<p>A vector with maximum iterations for each method.</p>
</td></tr>
<tr><td><code id="IPFit_+3A_hessian">hessian</code></td>
<td>
<p>Logical to estimate SE of parameters</p>
</td></tr>
<tr><td><code id="IPFit_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, show the parameters for each tested model</p>
</td></tr>
<tr><td><code id="IPFit_+3A_parallel">parallel</code></td>
<td>
<p>If TRUE, will use parallel computing</p>
</td></tr>
<tr><td><code id="IPFit_+3A_model">model</code></td>
<td>
<p>Can be ML for Maximum likelihood or MH for Metropolis Hastings</p>
</td></tr>
<tr><td><code id="IPFit_+3A_parametersmh">parametersMH</code></td>
<td>
<p>The priors. See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_n.iter">n.iter</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_n.chains">n.chains</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_n.adapt">n.adapt</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_thin">thin</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_trace">trace</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_adaptive">adaptive</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_intermediate">intermediate</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
<tr><td><code id="IPFit_+3A_filename">filename</code></td>
<td>
<p>See MHalgoGen</p>
</td></tr>
</table>


<h3>Details</h3>

<p>IPFit fit a model of Internesting Period for marine turtles.
</p>


<h3>Value</h3>

<p>Return a list of class IP with the fit informations and the fitted model.<br />
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Internesting Period: 
<code><a href="#topic+IPModel">IPModel</a>()</code>,
<code><a href="#topic+IPPredict">IPPredict</a>()</code>,
<code><a href="#topic+plot.IP">plot.IP</a>()</code>,
<code><a href="#topic+summary.IP">summary.IP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data &lt;- structure(c(`0` = 0, `1` = 47, `2` = 15, `3` = 6, `4` = 5, `5` = 4, 
                    `6` = 2, `7` = 5, `8` = 57, `9` = 203, `10` = 205, `11` = 103, 
                    `12` = 35, `13` = 24, `14` = 12, `15` = 10, `16` = 13, `17` = 49, 
                    `18` = 86, `19` = 107, `20` = 111, `21` = 73, `22` = 47, `23` = 30, 
                    `24` = 19, `25` = 17, `26` = 33, `27` = 48, `28` = 77, `29` = 83, 
                    `30` = 65, `31` = 37, `32` = 27, `33` = 23, `34` = 24, `35` = 22, 
                    `36` = 41, `37` = 42, `38` = 44, `39` = 33, `40` = 39, `41` = 24, 
                    `42` = 18, `43` = 18, `44` = 22, `45` = 22, `46` = 19, `47` = 24, 
                    `48` = 28, `49` = 17, `50` = 18, `51` = 19, `52` = 17, `53` = 4, 
                    `54` = 12, `55` = 9, `56` = 6, `57` = 11, `58` = 7, `59` = 11, 
                    `60` = 12, `61` = 5, `62` = 4, `63` = 6, `64` = 11, `65` = 5, 
                    `66` = 6, `67` = 7, `68` = 3, `69` = 2, `70` = 1, `71` = 3, `72` = 2, 
                    `73` = 1, `74` = 2, `75` = 0, `76` = 0, `77` = 3, `78` = 1, `79` = 0, 
                    `80` = 2, `81` = 0, `82` = 0, `83` = 1), Year = "1994", 
                    Species = "Dermochelys coriacea", 
                    location = "Yalimapo beach, French Guiana", 
                    totalnumber = 2526L, class = "IP")
  par(mar=c(4, 4, 1, 1)+0.4)
  plot(data, xlim=c(0,100))
  text(100, 190, labels=bquote(italic(.(attributes(data)$Species))), pos=2)
  text(100, 150, labels=attributes(data)$location, pos=2, cex=0.8)
  text(100, 110, labels=paste0(as.character(attributes(data)$totalnumber), " females"), pos=2)
  
######### Fit using Maximum-Likelihood

par &lt;- c(meanIP = 9.8229005713237623, 
         sdIP = 0.079176011861863474, 
         minIP = 6.8128364577569309, 
         pAbort = 1.5441529841959203, 
         meanAbort = 2.7958742380756121, 
         sdAbort = 0.99370406770777175, 
         pCapture = -0.80294884905867658, 
         meanECF = 4.5253772889275758, 
         sdECF = 0.20334743335612529)

fML &lt;- IPFit(x=par, 
             fixed.parameters=c(N=20000),
             data=data, 
             verbose=FALSE, 
             model="ML")

# Plot the fitted ECF
plot(fML, result="ECF")

# Plot the Internesting Period distribution
plot(fML, result="IP")

# Plot the distribution of days between tentatives
plot(fML, result="Abort", xlim=c(0, 15))
#' 
######### Fit using ML and non parametric ECF

par &lt;- c(ECF.2 = 0.044151921569961131, 
         ECF.3 = 2.0020778325280748, 
         ECF.4 = 2.6128345101617083, 
         ECF.5 = 2.6450582416622375, 
         ECF.6 = 2.715198206774927, 
         ECF.7 = 2.0288031327239904, 
         ECF.8 = 1.0028041546528881, 
         ECF.9 = 0.70977432157689235, 
         ECF.10 = 0.086052204035003091, 
         ECF.11 = 0.011400419961702518, 
         ECF.12 = 0.001825219438794076, 
         ECF.13 = 0.00029398731859899116, 
         ECF.14 = 0.002784886479846703, 
         meanIP = 9.9887100433529721, 
         sdIP = 0.10580250625108811, 
         minIP = 6.5159124624132048, 
         pAbort = 2.5702251748938956, 
         meanAbort = 2.2721679285648841, 
         sdAbort = 0.52006431730489933, 
         pCapture = 0.079471782729506113)
         
fML_NP &lt;- IPFit(x=par, 
             fixed.parameters=c(N=20000),
             data=data, 
             verbose=FALSE, 
             model="ML")
             
par &lt;- fML_NP$ML$par

fML_NP &lt;- IPFit(x=par, 
             fixed.parameters=c(N=1000000),
             data=data, 
             verbose=FALSE, 
             model="ML")
             
par &lt;- c(ECF.2 = 0.016195025683080871, 
         ECF.3 = 2.0858089267994315, 
         ECF.4 = 3.1307578727979348, 
         ECF.5 = 2.7495760827322622, 
         ECF.6 = 2.8770821670450939, 
         ECF.7 = 2.1592708144943145, 
         ECF.8 = 1.0016227335391867, 
         ECF.9 = 0.80990178270345259, 
         ECF.10 = 0.081051214954249967, 
         ECF.11 = 0.039757901443389344, 
         ECF.12 = 6.3324056808464527e-05, 
         ECF.13 = 0.00037500864146146936, 
         ECF.14 = 0.0010383506745475582, 
         meanIP = 10.004121090603523, 
         sdIP = 0.10229422354470977, 
         minIP = 6.5051758088487883, 
         pAbort = 2.5335985958484839, 
         meanAbort = 2.3145895392189173, 
         sdAbort = 0.51192514362374153, 
         pCapture = 0.055440514236842105, 
         DeltameanIP = -0.046478049165483697)

fML_NP_Delta &lt;- IPFit(x=par, 
             fixed.parameters=c(N=20000),
             data=data, 
             verbose=FALSE, 
             model="ML")
             
par &lt;- fML_NP_Delta$ML$par
             
fML_NP_Delta &lt;- IPFit(x=par, 
             fixed.parameters=c(N=1000000),
             data=data, 
             verbose=FALSE, 
             model="ML")
             
# Test for stability of -Ln L value according to N
grandL.mean &lt;- NULL
grandL.sd &lt;- NULL
N &lt;- c(10000, 20000, 30000, 40000, 50000,
            60000, 70000, 80000, 90000,  
            100000, 200000, 300000, 400000, 500000, 
            600000, 700000, 800000, 900000,  
            1000000)
for (Ni in N) {
    print(Ni)
    smallL &lt;- NULL
    for (replicate in 1:100) {
         smallL &lt;- c(smallL, 
         getFromNamespace(".IPlnL", ns="phenology")
                 (x=par, fixed.parameters=c(N=Ni), data=data))
    }
    grandL.mean &lt;- c(grandL.mean, mean(smallL))
    grandL.sd &lt;- c(grandL.sd, sd(smallL))
}

grandL.mean &lt;- c(242.619750064524, 239.596145944548, 238.640010536147, 237.965573853263, 
237.727506424543, 237.240740566494, 237.527948232993, 237.297225856515, 
237.17073080938, 237.103397800143, 236.855939567838, 
236.704861853456, 236.82264801458, 236.606065021519, 236.685930841831, 
236.697562908131, 236.568003663293, 236.58097471402, 236.594282543024
)
grandL.sd &lt;- c(6.54334049298099, 3.04916614991682, 2.57932397492509, 2.15990307710982, 
1.59826856034413, 1.54505295915354, 1.59734964880484, 1.41845032728396, 
1.43096821211286, 1.20048923027244, 0.912467350448495, 
0.75814052890774, 0.668841336554019, 0.539505594152166, 0.554662419326559, 
0.501551009304687, 0.415199780254872, 0.472274287714195, 0.386237047201706
)

plot_errbar(x=N, y=grandL.mean, errbar.y = 2*grandL.sd, 
            xlab="N", ylab="-Ln L (2 SD)", bty="n", las=1)
             
# Plot the fitted ECF
plot(fML_NP_Delta, result="ECF")

# Plot the Internesting Period distribution
plot(fML_NP_Delta, result="IP")

# Plot the distribution of days between tentatives
plot(fML_NP_Delta, result="Abort", xlim=c(0, 15))

print(paste("Probability of capture", invlogit(-fML_NP_Delta$ML$par["pCapture"])))
# Confidence interval at 95%
print(paste(invlogit(-fML_NP_Delta$ML$par["pCapture"]-1.96*fML_NP_Delta$ML$SE["pCapture"]), "-", 
invlogit(-fML_NP_Delta$ML$par["pCapture"]+1.96*fML_NP_Delta$ML$SE["pCapture"])))

print(paste("Probability of abort", invlogit(-fML_NP_Delta$ML$par["pAbort"])))
# Confidence interval at 95%
print(paste(invlogit(-fML_NP_Delta$ML$par["pAbort"]-1.96*fML_NP_Delta$ML$SE["pAbort"]), "-", 
invlogit(-fML_NP_Delta$ML$par["pAbort"]+1.96*fML_NP_Delta$ML$SE["pAbort"])))
             
compare_AIC(parametric=fML$ML, 
            nonparameteric=fML_NP$ML, 
            nonparametricDelta=fML_NP_Delta$ML)

######### Fit using Metropolis-Hastings algorithm
# ECF.1 = 1 is fixed
par &lt;- c(ECF.2 = 0.044151921569961131, 
         ECF.3 = 2.0020778325280748, 
         ECF.4 = 2.6128345101617083, 
         ECF.5 = 2.6450582416622375, 
         ECF.6 = 2.715198206774927, 
         ECF.7 = 2.0288031327239904, 
         ECF.8 = 1.0028041546528881, 
         ECF.9 = 0.70977432157689235, 
         ECF.10 = 0.086052204035003091, 
         ECF.11 = 0.011400419961702518, 
         ECF.12 = 0.001825219438794076, 
         ECF.13 = 0.00029398731859899116, 
         ECF.14 = 0.002784886479846703, 
         meanIP = 9.9887100433529721, 
         sdIP = 0.10580250625108811, 
         minIP = 6.5159124624132048, 
         pAbort = 2.5702251748938956, 
         meanAbort = 2.2721679285648841, 
         sdAbort = 0.52006431730489933, 
         pCapture = 0.079471782729506113)

df &lt;- data.frame(Density=rep("dunif", length(par)), 
Prior1=c(rep(0, 13), 8, 0.001, 0, -8, 0, 0.001, -8), 
Prior2=c(rep(10, 13), 12, 1, 10, 8, 2, 1, 8), 
SDProp=unname(c(ECF.2 = 6.366805760909012e-05, 
                ECF.3 = 6.366805760909012e-05, 
                ECF.4 = 6.366805760909012e-05, 
                ECF.5 = 6.366805760909012e-05, 
                ECF.6 = 6.366805760909012e-05, 
                ECF.7 = 6.366805760909012e-05, 
                ECF.8 = 6.366805760909012e-05, 
                ECF.9 = 6.366805760909012e-05, 
                ECF.10 = 6.366805760909012e-05, 
                ECF.11 = 6.366805760909012e-05, 
                ECF.12 = 6.366805760909012e-05, 
                ECF.13 = 6.366805760909012e-05, 
                ECF.14 = 6.366805760909012e-05, 
                meanIP = 6.366805760909012e-05, 
                sdIP = 6.366805760909012e-05, 
                minIP = 6.366805760909012e-05, 
                pAbort = 6.366805760909012e-05, 
                meanAbort = 6.366805760909012e-05, 
                sdAbort = 6.366805760909012e-05, 
                pCapture = 6.366805760909012e-05)),               
Min=c(rep(0, 13), 8, 0.001, 0, -8, 0, 0.001, -8), 
Max=c(rep(10, 13), 12, 1, 10, 8, 2, 1, 8),
Init=par, stringsAsFactors = FALSE)
rownames(df)&lt;- names(par)

fMH &lt;- IPFit(parametersMH=df, 
fixed.parameters=c(N=10000),
data=data, 
verbose=FALSE, 
n.iter = 10000,
n.chains = 1, n.adapt = 100, thin = 1, trace = TRUE,
adaptive = TRUE, 
model="MH")

# Plot the fitted ECF
plot(fMH, result="ECF")


## End(Not run)
</code></pre>

<hr>
<h2 id='IPModel'>Estimates the pattern of internesting intervals for a set of parameters.</h2><span id='topic+IPModel'></span>

<h3>Description</h3>

<p>This function fits a model of internesting period.<br />
The parameters are:<br />
</p>

<ul>
<li> <p><code>meanIP</code> : The average number of days between two nesting processes
</p>
</li>
<li> <p><code>DeltameanIP</code> : The shift in days for IP at each new clutch.
</p>
</li>
<li> <p><code>sdIP</code> : The standard deviation of number of days between two nesting processes
</p>
</li>
<li> <p><code>minIP</code> : The minimum number of days between two nesting processes
</p>
</li>
<li> <p><code>pAbort</code> : The -logit of the probability to abort a nesting process
</p>
</li>
<li> <p><code>meanAbort</code> : The average of the number of days after the abortion of a nesting process
</p>
</li>
<li> <p><code>sdAbort</code> : The standard deviation of the number of days after the abortion of a nesting process
</p>
</li>
<li> <p><code>pCapture</code> : The -logit of the probability to capture a female on the beach
</p>
</li>
<li> <p><code>meanECF</code> : The average number of clutch a female will try to do being reprensented as ECF
</p>
</li>
<li> <p><code>sdECF</code> : The standard deviation of number of clutch a female will try to do
</p>
</li>
<li> <p><code>N</code> : The number of replicates to generate the distribution (default is 10000 if not indicated)
</p>
</li>
<li> <p><code>ECF.x</code> : The relative proportion of females nesting with ECF = x (ECF.1 being fixed to 1)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>IPModel(
  par,
  parallel = TRUE,
  limits = list(meanIP = 40, meanECF = 4, minIP = 15, sdAbort = 1, sdIP = 1, sdECF = 1,
    DeltameanIP = 0.5, maxDays = 365)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPModel_+3A_par">par</code></td>
<td>
<p>Set of parameters</p>
</td></tr>
<tr><td><code id="IPModel_+3A_parallel">parallel</code></td>
<td>
<p>If TRUE, will use parallel computing</p>
</td></tr>
<tr><td><code id="IPModel_+3A_limits">limits</code></td>
<td>
<p>A list of limits for various parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>IPModel estimates the pattern of internesting intervals for a set of parameters.
</p>


<h3>Value</h3>

<p>Return a list with two elements.<br />
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Internesting Period: 
<code><a href="#topic+IPFit">IPFit</a>()</code>,
<code><a href="#topic+IPPredict">IPPredict</a>()</code>,
<code><a href="#topic+plot.IP">plot.IP</a>()</code>,
<code><a href="#topic+summary.IP">summary.IP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
par &lt;- c(meanIP = 9.8, 
sdIP = 0.1, 
minIP = 7, 

pAbort = -logit(0.1), 
meanAbort = 2, 
sdAbort = 0.05, 

pCapture = -logit(0.8), 

meanECF = 4, 
sdECF = 0.1)

model &lt;- IPModel(c(par, N=10000))

plot(model)


## End(Not run)
</code></pre>

<hr>
<h2 id='IPPredict'>Predict the possible clutch number based on observed Internesting Period.</h2><span id='topic+IPPredict'></span>

<h3>Description</h3>

<p>This function predicts the possible clutch number
based on observed Internesting Period.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPPredict(x = NULL, par = NULL, N = NULL, IP = 0:100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPPredict_+3A_x">x</code></td>
<td>
<p>A result of IPFit().</p>
</td></tr>
<tr><td><code id="IPPredict_+3A_par">par</code></td>
<td>
<p>A set of parameters.</p>
</td></tr>
<tr><td><code id="IPPredict_+3A_n">N</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="IPPredict_+3A_ip">IP</code></td>
<td>
<p>A vector of Internesting Period</p>
</td></tr>
</table>


<h3>Details</h3>

<p>IPPredict calculates the possible clutch number based on observed Internesting Period.
</p>


<h3>Value</h3>

<p>A data.frame
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Internesting Period: 
<code><a href="#topic+IPFit">IPFit</a>()</code>,
<code><a href="#topic+IPModel">IPModel</a>()</code>,
<code><a href="#topic+plot.IP">plot.IP</a>()</code>,
<code><a href="#topic+summary.IP">summary.IP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
######### Fit using Maximum-Likelihood

par &lt;- c(meanIP = 9.9959691992722917, 
         sdIP = 0.10066664270893474, 
         minIP = 7.5684588178888754, 
         pAbort = 2.2510012544630911, 
         meanAbort = 2.8969185085603386, 
         sdAbort = 0.92688983853803242, 
         pCapture = -1.0393803705929086, 
         meanECF = 3.9551519427394255, 
         sdECF = 0.31657679943365019)

IPPredict(par=par, IP=c(10, 80))


## End(Not run)
</code></pre>

<hr>
<h2 id='L_to_LBLE'>Transform a set of parameters from Length format to LengthB LengthE</h2><span id='topic+L_to_LBLE'></span>

<h3>Description</h3>

<p>This function is used to transform a set of parameters
that uses Length to a set of parameters uses LengthB and LengthE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L_to_LBLE(parameters = stop("Set of parameters must be given"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="L_to_LBLE_+3A_parameters">parameters</code></td>
<td>
<p>Set of current parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>L_to_LBLE transforms a set of parameters from Length format to LengthB LengthE.
</p>


<h3>Value</h3>

<p>Return the set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
refdate &lt;- as.Date("2001-01-01")
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=refdate, format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Change the parameters to Begin End format
parg1&lt;-LBLE_to_L(parameters=parg)
# And change back to LengthB LengthE.
parg2&lt;-L_to_LBLE(parameters=parg1)
</code></pre>

<hr>
<h2 id='LBLE_to_BE'>Transform a set of parameters from LengthB LengthE to Begin End.</h2><span id='topic+LBLE_to_BE'></span>

<h3>Description</h3>

<p>This function is used to transform a set of parameters
that uses LengthB, Peak and LengthE to a set of parameters
that uses Begin, Peak and End.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LBLE_to_BE(parameters = NULL, help = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LBLE_to_BE_+3A_parameters">parameters</code></td>
<td>
<p>Set of current parameters</p>
</td></tr>
<tr><td><code id="LBLE_to_BE_+3A_help">help</code></td>
<td>
<p>If TRUE, an help is displayed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>LBLE_to_BE transforms a set of parameters from LengthB LengthE to Begin End.
</p>


<h3>Value</h3>

<p>Return a set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot
refdate &lt;- as.Date("2001-01-01")
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", reference=refdate, format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Change the parameters to Begin End format
parg1&lt;-LBLE_to_BE(parameters=parg)
# And change back to LengthB LengthE
parg2&lt;-BE_to_LBLE(parameters=parg1)
</code></pre>

<hr>
<h2 id='LBLE_to_L'>Transform a set of parameters from LengthB LengthE format to Length</h2><span id='topic+LBLE_to_L'></span>

<h3>Description</h3>

<p>This function is used to transform a set of parameters
that uses LengthB and LengthE to a set of parameters uses Length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LBLE_to_L(parameters = stop("Set of parameters must be given"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LBLE_to_L_+3A_parameters">parameters</code></td>
<td>
<p>Set of current parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>LBLE_to_L transforms a set of parameters from LengthB LengthE format to Length.
</p>


<h3>Value</h3>

<p>Return the set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
refdate &lt;- as.Date("2001-01-01")
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", reference=refdate, format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Change the parameters to Begin End format
parg1&lt;-LBLE_to_L(parameters=parg)
# And change back to LengthB LengthE.
parg2&lt;-L_to_LBLE(parameters=parg1)
</code></pre>

<hr>
<h2 id='likelihood_phenology'>Estimate the likelihood of timeseries based on a set of parameters.</h2><span id='topic+likelihood_phenology'></span>

<h3>Description</h3>

<p>This function is used to estimate the likelihood based on a set of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likelihood_phenology(
  data = NULL,
  fitted.parameters = NULL,
  fixed.parameters = NULL,
  parallel = TRUE,
  result = NULL,
  model_before = NULL,
  cofactors = NULL,
  add.cofactors = NULL,
  zero = 1e-09,
  out = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="likelihood_phenology_+3A_data">data</code></td>
<td>
<p>Dataset generated with add_format</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_fitted.parameters">fitted.parameters</code></td>
<td>
<p>Set of parameters to be fitted</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_parallel">parallel</code></td>
<td>
<p>If TRUE, parallel computing is used.</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_result">result</code></td>
<td>
<p>An object obtained after fit_phenology()</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_model_before">model_before</code></td>
<td>
<p>The change of parameters before to estimate daily counts.</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_cofactors">cofactors</code></td>
<td>
<p>data.frame with a column Date and a column for each cofactor</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_add.cofactors">add.cofactors</code></td>
<td>
<p>Names of the column of parameter cofactors to use as a cofactor</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_zero">zero</code></td>
<td>
<p>If the theoretical nest number is under this value, this value wll be used</p>
</td></tr>
<tr><td><code id="likelihood_phenology_+3A_out">out</code></td>
<td>
<p>If TRUE, return the global likelihood; if FALSE, the likelihood for each series</p>
</td></tr>
</table>


<h3>Details</h3>

<p>likelihood_phenology estimate likelihood for a set of parameters.
</p>


<h3>Value</h3>

<p>The likelihood of the data with the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Read a file with data
data(Gratiot)
# Generate a formated list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Estimate likelihood with this initial set of parameters
likelihood_phenology(data=data_Gratiot, fitted.parameters=parg, fixed.parameters=NULL)
# Or directly from a result object
likelihood_phenology(result=result_Gratiot)
# With new parametrization based on Omeyer et al. (2022)
# Omeyer, L. C. M., McKinley, T. J., Bréheret, N., Bal, G., Balchin, G. P., Bitsindou, A., 
# Chauvet, E., Collins, T., Curran, B. K., Formia, A., Girard, A., Girondot, M., Godley, B. J., 
# Mavoungou, J.-G., Poli, L., Tilley, D., VanLeeuwe, H. &amp; Metcalfe, K. 2022. Missing data in 
# sea turtle population monitoring: a Bayesian statistical framework accounting for incomplete 
# sampling Front. Mar. Sci. (IF 3.661), 9, 817014.

parg &lt;- c(tp=unname(parg["Peak"]), tf=unname(parg["Flat"]), 
          s1=unname(parg["LengthB"])/4.8, s2=unname(parg["LengthE"])/4.8, 
          alpha=unname(parg["Max_Complete"]), Theta=unname(parg["Theta"]))
likelihood_phenology(data=data_Gratiot, fitted.parameters=parg, fixed.parameters=NULL)

## End(Not run)
</code></pre>

<hr>
<h2 id='lnLCF'>Calculate the -log likelihood of data within a model.</h2><span id='topic+lnLCF'></span>

<h3>Description</h3>

<p>Calculate the -log likelihood of data within a model.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lnLCF(x, data, fixed.parameters = NULL, parallel = TRUE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lnLCF_+3A_x">x</code></td>
<td>
<p>A named vector of parameters (mu, sd, mu_season, sd_season, a, p and OTN).</p>
</td></tr>
<tr><td><code id="lnLCF_+3A_data">data</code></td>
<td>
<p>CMR database formated using TableECFOCF().</p>
</td></tr>
<tr><td><code id="lnLCF_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Parameters that are fixed.</p>
</td></tr>
<tr><td><code id="lnLCF_+3A_parallel">parallel</code></td>
<td>
<p>If TRUE, parallel computing in ECFOCF_f is used.</p>
</td></tr>
<tr><td><code id="lnLCF_+3A_verbose">verbose</code></td>
<td>
<p>if TRUE, show the parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>lnLCF calculate the -log likelihood of data within a model.
</p>


<h3>Value</h3>

<p>Return the -log likelihood of data within a model.<br />
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002)
lnLCF(x=c(mu=4.71768454279272, 
                         sd=1.075711951667, 
                         p=-1.79746277312909), 
                 data=ECFOCF_2002)


ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002, date0=as.Date("2002-01-01"))
fp &lt;- rep(0, dim(ECFOCF_2002)[3])
names(fp) &lt;- paste0("p.", formatC(1:(dim(ECFOCF_2002)[3]), width=2, flag="0"))
par &lt;- c(mu1 = 0.6404831115214353, 
         sd1 = 0.69362774786433479, 
         mu2 = 5.6404831115214353, 
         sd2 = 5.69362774786433479, 
         mu_season = 12.6404831115214353, 
         sd_season = 1.69362774786433479, 
         OTN=1)
par &lt;- c(par, fp[attributes(ECFOCF_2002)$table["begin"]:attributes(ECFOCF_2002)$table["final"]])
fixed.parameters &lt;- c(p=-Inf)

lnLCF(x=par, data=ECFOCF_2002, fixed.parameters=fixed.parameters)

## End(Not run)

</code></pre>

<hr>
<h2 id='LnRI_norm'>Return a remigration interval.</h2><span id='topic+LnRI_norm'></span>

<h3>Description</h3>

<p>Model of remigration interval<br />
The vector of parameters must include:<br />
sx, survival for year x<br />
if s is included, all years have the same survival<br />
tx, Tag retention for year x<br />
rx, probability of return for year x<br />
cx, probability of return for year x<br />
px, probability of observation for year x<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LnRI_norm(data, x, kl = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LnRI_norm_+3A_data">data</code></td>
<td>
<p>Data with remigration intervals</p>
</td></tr>
<tr><td><code id="LnRI_norm_+3A_x">x</code></td>
<td>
<p>Vector of parameters</p>
</td></tr>
<tr><td><code id="LnRI_norm_+3A_kl">kl</code></td>
<td>
<p>Maximum number of years for remigration intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>lnRI_norm returns a ln L
</p>


<h3>Value</h3>

<p>Return a remigration interval.<br />
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Remigration Interval: 
<code><a href="#topic+Bayesian.remigration">Bayesian.remigration</a>()</code>,
<code><a href="#topic+RI">RI</a>()</code>,
<code><a href="#topic+plot.Remigration">plot.Remigration</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
# Each year a fraction of 0.9 is surviving
s &lt;- c(s1=0.9, s2=0.9, s3=0.9, s4=0.9, s5=0.9)
# Probability of tag retention; 0.95 the first year then after no loss
t &lt;- c(t1=0.95, t2=1, t3=1, t4=1, t5=1)
# Time-conditional return probability - This is the true remigration rate
r &lt;- c(r1=0.1, r2=0.8, r3=0.7, r4=0.7, r5=1)
# Capture probability
p &lt;- c(p1=0.6, p2=0.6, p3=0.6, p4=0.6, p5=0.6)
# Number of observations for 400 tagged females after 1, 2, 3, 4, and 5 years
OBS &lt;- c(400, 10, 120, 40, 20, 10)
# Likelihood of the observed number based on the model
LnRI_norm(data=OBS, x = c(s, t, r, p, sd=2) )
LnRI_norm(data=OBS, x = c(s=0.97, t, r, p, sd=2) )


## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.ECFOCF'>Return Log Likelihood of a fit done using fitCF</h2><span id='topic+logLik.ECFOCF'></span>

<h3>Description</h3>

<p>Return Log Likelihood of a fit generated by fitCF.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ECFOCF'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.ECFOCF_+3A_object">object</code></td>
<td>
<p>A result file generated by fitCF</p>
</td></tr>
<tr><td><code id="logLik.ECFOCF_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>logLik.ECFOCF return Log Likelihood of a fit done using fitCF
</p>


<h3>Value</h3>

<p>The Log Likelihood value for the fitted model with data
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002, date0=as.Date("2002-01-01"))
par &lt;- c(mu = 2.6404831115214353, 
        size = 0.69362774786433479, 
        mu_season = 12.6404831115214353, 
        size_season = 1.69362774786433479, 
        a2=0)
fp &lt;- rep(0, dim(ECFOCF_2002)[3])
names(fp) &lt;- paste0("p.", formatC(1:(dim(ECFOCF_2002)[3]), width=2, flag="0"))
par &lt;- c(par, fp[attributes(ECFOCF_2002)$table["begin"]:attributes(ECFOCF_2002)$table["final"]])
fixed.parameters &lt;- c(a1=Inf, p=-Inf)

 lnLCF(x=par, data=ECFOCF_2002, fixed.parameters=fixed.parameters)
 
 o_mu1season1a2p &lt;- fitCF(x=par, fixed.parameters=fixed.parameters, 
                          data=ECFOCF_2002)
 
logLik(o_mu1season1a2p)
AIC(o_mu1season1a2p)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.fitRMU'>Return Log Likelihood of a fit generated by fitRMU</h2><span id='topic+logLik.fitRMU'></span>

<h3>Description</h3>

<p>Return Log Likelihood of a fit generated by fitRMU
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitRMU'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.fitRMU_+3A_object">object</code></td>
<td>
<p>A result file generated by fitRMU</p>
</td></tr>
<tr><td><code id="logLik.fitRMU_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>logLik.fitRMU Return Log Likelihood of a fit for fitRMU
</p>


<h3>Value</h3>

<p>The Log Likelihood value for the fitted model with data
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Fill gaps in RMU: 
<code><a href="#topic+CI.RMU">CI.RMU</a>()</code>,
<code><a href="#topic+fitRMU">fitRMU</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc">fitRMU_MHmcmc</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc_p">fitRMU_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.fitRMU">plot.fitRMU</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
RMU.name.AtlanticW &lt;- data.frame(mean=c("Yalimapo.French.Guiana", 
                                         "Galibi.Suriname", 
                                         "Irakumpapy.French.Guiana"), 
                                 se=c("se_Yalimapo.French.Guiana", 
                                      "se_Galibi.Suriname", 
                                      "se_Irakumpapy.French.Guiana"))
data.AtlanticW &lt;- data.frame(Year=c(1990:2000), 
      Yalimapo.French.Guiana=c(2076, 2765, 2890, 2678, NA, 
                               6542, 5678, 1243, NA, 1566, 1566),
      se_Yalimapo.French.Guiana=c(123.2, 27.7, 62.5, 126, NA, 
                                 230, 129, 167, NA, 145, 20),
      Galibi.Suriname=c(276, 275, 290, NA, 267, 
                       542, 678, NA, 243, 156, 123),
      se_Galibi.Suriname=c(22.3, 34.2, 23.2, NA, 23.2, 
                           4.3, 2.3, NA, 10.3, 10.1, 8.9),
      Irakumpapy.French.Guiana=c(1076, 1765, 1390, 1678, NA, 
                               3542, 2678, 243, NA, 566, 566),
      se_Irakumpapy.French.Guiana=c(23.2, 29.7, 22.5, 226, NA, 
                                 130, 29, 67, NA, 15, 20))
                           
cst &lt;- fitRMU(data=data.AtlanticW, RMU.name=RMU.name.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero")
logLik(cst)
AIC(cst)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.phenology'>Return Log Likelihood of a fit generated by fit_phenology</h2><span id='topic+logLik.phenology'></span>

<h3>Description</h3>

<p>Return Log Likelihood of a fit generated by fit_phenology
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenology'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.phenology_+3A_object">object</code></td>
<td>
<p>A result file generated by fit_phenology</p>
</td></tr>
<tr><td><code id="logLik.phenology_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>logLik.phenology Return Log Likelihood of a fit
</p>


<h3>Value</h3>

<p>The Log Likelihood value of the fitted model and data
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
data(result_Gratiot)
logLik(result_Gratiot)
AIC(result_Gratiot)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.Tagloss'>Return Log Likelihood of a fit generated by Tagloss_fit</h2><span id='topic+logLik.Tagloss'></span>

<h3>Description</h3>

<p>Return Log Likelihood of a fit generated by Tagloss_fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Tagloss'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.Tagloss_+3A_object">object</code></td>
<td>
<p>A result file generated by Tagloss_fit</p>
</td></tr>
<tr><td><code id="logLik.Tagloss_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>logLik.Tagloss returns Log Likelihood of a fit for tag loss
</p>


<h3>Value</h3>

<p>The Log Likelihood value for the fitted model with data
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")
# Without the N20 the computing is much faster
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
par &lt;- structure(c(48.8292784204825, 1039.02842229274, -89.3162940697861, 
5.21817463244988, 8.00575451188548, 8.32971268127933, 161.265553603601, 
602.935748681661, 2643.57415102633, 16.752815732218, 10.181616195839, 
7.14279063312016), .Names = c("D1_2", "D2D1_2", "D3D2_2", "A_2", 
"B_2", "C_2", "D1_1", "D2D1_1", "D3D2_1", "A_1", "B_1", "C_1"))
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par)
logLik(o)
AIC(o)

## End(Not run)
</code></pre>

<hr>
<h2 id='map_Gratiot'>Likelihood map of Leatherback nest counts</h2><span id='topic+map_Gratiot'></span>

<h3>Description</h3>

<p>Likelihood map of Leatherback nest counts from Gratiot et al. (2006) Figure 1.
A intraseasonal periodic pattern was searched for varying Phi and Delta parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_Gratiot
</code></pre>


<h3>Format</h3>

<p>A list with Gratiot data and the result of the fit.
</p>


<h3>Details</h3>

<p>Likelihood map of Leatherback nest counts from Gratiot et al. (2006) Figure 1
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@u-psud.fr">marc.girondot@u-psud.fr</a>
</p>


<h3>References</h3>

<p>Gratiot, N., Gratiot, J., de Thoisy, B. &amp; Kelle, L. 2006.
Estimation of marine turtles nesting season from incomplete
data ; statistical adjustment of a sinusoidal function. Animal
Conservation, 9, 95-102.
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Read a file with likelihood map
data(map_Gratiot)
</code></pre>

<hr>
<h2 id='map_phenology'>Generate a likelihood map varying Phi and Delta.</h2><span id='topic+map_phenology'></span>

<h3>Description</h3>

<p>This function generates a map of likelihood varying Phi and Delta.<br />
Parameters are the same than for the fit_phenology() function except for trace that is disabled.<br />
If Alpha, Beta or Tau are not indicated, Alpha and Tau are set to 0 and 1 and Beta is fitted.<br />
Only one set of Alpha, Beta, Tau, Phi and Delta are used for all timeseries present in data.<br />
Note that it is possible to fit or fixed Alpha[n], Beta[n], Tau[n], Phi[n] and Delta[n] with [n]=1 or 2
and then it is possible to use this function to establish the likelihood map for a
second or third sinusoids added to the global pattern.<br />
If Delta is not specified, it is estimated from Phi and the same precision as Phi is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_phenology(
  data = NULL,
  fitted.parameters = NULL,
  fixed.parameters = NA,
  Phi = seq(from = 0.2, to = 20, length.out = 100),
  Delta = NULL,
  progressbar = any(installed.packages()[, "Package"] == "pbapply"),
  cofactors = NULL,
  add.cofactors = NULL,
  zero = 1e-09
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map_phenology_+3A_data">data</code></td>
<td>
<p>dataset generated with add_format</p>
</td></tr>
<tr><td><code id="map_phenology_+3A_fitted.parameters">fitted.parameters</code></td>
<td>
<p>Set of parameters to be fitted</p>
</td></tr>
<tr><td><code id="map_phenology_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="map_phenology_+3A_phi">Phi</code></td>
<td>
<p>Phi values to be analyzed</p>
</td></tr>
<tr><td><code id="map_phenology_+3A_delta">Delta</code></td>
<td>
<p>Delta value to be analyzed</p>
</td></tr>
<tr><td><code id="map_phenology_+3A_progressbar">progressbar</code></td>
<td>
<p>If FALSE, do not show the progress bar</p>
</td></tr>
<tr><td><code id="map_phenology_+3A_cofactors">cofactors</code></td>
<td>
<p>data.frame with a column Date and a column for each cofactor</p>
</td></tr>
<tr><td><code id="map_phenology_+3A_add.cofactors">add.cofactors</code></td>
<td>
<p>Names of the column of parameter cofactors to use as a cofactor</p>
</td></tr>
<tr><td><code id="map_phenology_+3A_zero">zero</code></td>
<td>
<p>If the theoretical nest number is under this value, this value wll be used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>map_phenology generates a likelihood map.
</p>


<h3>Value</h3>

<p>Display a likelihood map
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("phenology")
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name = "Complete", 
		reference = as.Date("2001-01-01"), format = "%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters = NULL)
# Run the optimisation
## Not run: 
result_Gratiot &lt;- fit_phenology(data = data_Gratiot, 
		fitted.parameters = parg, fixed.parameters = NULL)

## End(Not run)
data(result_Gratiot)
# Extract the fitted parameters
parg1 &lt;- extract_result(result_Gratiot)
# Add constant Alpha and Tau values 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
pfixed &lt;- c(parg1, Alpha=0, Tau=1)
pfixed &lt;- pfixed[-which(names(pfixed)=="Theta")]
# The only fitted parameter will be Beta
parg2 &lt;- c(Beta=0.5, parg1["Theta"])
# Generate a likelihood map 
# [default Phi=seq(from=0.1, to=20, length.out=100) but it is very long]
# Take care, it takes 20 hours ! The data map_Gratiot has the result
## Not run: 
library(phenology)
map_Gratiot &lt;- map_phenology(data = data_Gratiot, 
                             Phi = seq(from=0.1, to=30, length.out=100), 
		                          fitted.parameters = parg2, 
		                          fixed.parameters = pfixed)

## End(Not run)
data(map_Gratiot)
# Plot the map
plot(map_Gratiot, col = heat.colors(128))
# Plot the min(-Ln L) for Phi varying at any delta value
plot_phi(map = map_Gratiot)
# Plot the min(-Ln L) for Delta varying with Phi equal to the value for maximum likelihood
plot_delta(map = map_Gratiot)
# Plot the min(-Ln L) for Delta varying with Phi the nearest to 15
plot_delta(map = map_Gratiot, Phi = 15)
</code></pre>

<hr>
<h2 id='MarineTurtles_2002'>Database of tagged marine turtles in 2002</h2><span id='topic+MarineTurtles_2002'></span>

<h3>Description</h3>

<p>Extraction of 2002 PIT tagged marine turtles database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MarineTurtles_2002
</code></pre>


<h3>Format</h3>

<p>data.frame with 2 columns:
</p>

<ul>
<li> <p><code>Date</code>: The date the female has been seen on the beach (morning date of the night)
</p>
</li>
<li> <p><code>ID</code>: The unique identifier of the female
</p>
</li></ul>



<h3>Details</h3>

<p>Database of tagged marine turtles in 2002
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
data(MarineTurtles_2002)
</code></pre>

<hr>
<h2 id='MinBMinE_to_Min'>Transform a set of parameters from MinB and MinE to Min</h2><span id='topic+MinBMinE_to_Min'></span>

<h3>Description</h3>

<p>This function is used to transform a set of parameters
that uses MinB and MinE to a set of parameters
that uses Min.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MinBMinE_to_Min(parameters = stop("A set of parameters must be indicated"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MinBMinE_to_Min_+3A_parameters">parameters</code></td>
<td>
<p>Set of current parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MinBMinE_to_Min transforms a set of parameters from MinB and MinE to Min
</p>


<h3>Value</h3>

<p>Return a set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot
refdate &lt;- as.Date("2001-01-01")
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", reference=refdate, format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot)
# Change the parameters to PMinB and PMinE
parg1&lt;-MinBMinE_to_Min(parameters=parg)
</code></pre>

<hr>
<h2 id='o_4p_p1p2'>Model of tagloss based on Rivalan data</h2><span id='topic+o_4p_p1p2'></span>

<h3>Description</h3>

<p>Model of tagloss based on Rivalan data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>o_4p_p1p2
</code></pre>


<h3>Details</h3>

<p>Model of tagloss based on Rivalan data
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>References</h3>

<p>Rivalan, P., Godfrey, M.H., Prévot-Julliard, A.-C., Girondot, M., 2005. Maximum likelihood estimates of tag loss in leatherback sea turtles. Journal of Wildlife Management 69, 540-548.
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")

# Same data fitted with new model
par &lt;- c(D1_1 = 100.15324837975547, A_1 = 5.9576927964120188, 
         B_1 = 8.769924225871069, B_2 = 8.2353860179664125)
pfixed &lt;- c(D2D1_1 = 2568, D3D2_1 = 2568, D2D1_2 = 2568, D3D2_2 = 2568)
o_4p_p1p2 &lt;- Tagloss_fit(data=data_f_21, fitted.parameters = par, 
                         fixed.parameters = pfixed, 
                         model_before = "par['C_1']=par['B_1'];
                         par['A_2']=par['A_1'];
                         par['C_2']=par['B_2'];
                         par['D1_2']=par['D1_1']", hessian=TRUE)
data(o_4p_p1p2)
plot(o_4p_p1p2, model="1", col="red")
plot(o_4p_p1p2, model="2", col="blue", add=TRUE)
legend("topright", legend=c("2-&gt;1", "1-&gt;0"), lty=1, col=c("blue", "red"))
plot(o_4p_p1p2, model="Cumul")

## End(Not run)
</code></pre>

<hr>
<h2 id='outLR'>Database of leatherback CMR in French Guiana</h2><span id='topic+outLR'></span>

<h3>Description</h3>

<p>Database of leatherback CMR in French Guiana
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outLR
</code></pre>


<h3>Format</h3>

<p>A dataframe with database of leatherback CMR in French Guiana
</p>


<h3>Details</h3>

<p>Database of leatherback CMR in French Guiana
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@u-psud.fr">marc.girondot@u-psud.fr</a>
</p>


<h3>References</h3>

<p>Rivalan, P., Godfrey, M.H., Prévot-Julliard, A.-C.,
Girondot, M., 2005. Maximum likelihood estimates of tag loss in
leatherback sea turtles. Journal of Wildlife Management 69, 540-548.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with result
data(outLR)
data_f_21 &lt;- Tagloss_format(outLR, model="21")

## End(Not run)
</code></pre>

<hr>
<h2 id='par_init'>Calculate initial set of parameters.</h2><span id='topic+par_init'></span>

<h3>Description</h3>

<p>This function is used to generate an initial set of parameters for fitting
that is expected to be not to far from the final.<br />
The parameters can be:<br />
</p>

<ul>
<li> <p><code>Min</code>, <code>MinE</code>, <code>MinB</code>, <code>PMin</code>, <code>PMinB</code>, <code>PMinE</code>;
</p>
</li>
<li> <p><code>Max</code>;
</p>
</li>
<li> <p><code>Begin</code>, <code>Peak</code>, <code>Flat</code>, <code>End</code>;
</p>
</li>
<li> <p><code>Length</code>, <code>LengthB</code>, <code>LengthE</code>;
</p>
</li>
<li> <p><code>Theta</code>;
</p>
</li>
<li> <p><code>Alpha</code>, <code>Beta</code>, <code>Tau</code>, <code>Phi</code>, <code>Delta</code>;
</p>
</li>
<li> <p><code>Alpha1</code>, <code>Beta1</code>, <code>Tau1</code>, <code>Phi1</code>, <code>Delta1</code>;
</p>
</li>
<li> <p><code>Alpha2</code>, <code>Beta2</code>, <code>Tau2</code>, <code>Phi2</code>, <code>Delta2</code>;
</p>
</li>
<li> <p><code>Alpha3</code>, <code>Beta3</code>, <code>Tau3</code>, <code>Phi3</code>, <code>Delta3</code>;
</p>
</li></ul>

<p>And the name of level if a cofactor is used.<br />
The parameters <code>Max</code>, <code>Min</code>, <code>MinE</code>, <code>MinB</code>, <code>Length</code>,
<code>LengthB</code>, <code>LengthE</code>, and <code>Peak</code> can be followed with _ and part of the
name of the rookery.<br />
The model for scale effect of sinusoid is: Alpha + Beta * n(t) ^ Tau where
n(t) is the expected number for the day t without the sinusoid effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par_init(
  data = stop("A dataset must be provided"),
  fixed.parameters = NULL,
  add.cofactors = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="par_init_+3A_data">data</code></td>
<td>
<p>Dataset generated with add_phenology()</p>
</td></tr>
<tr><td><code id="par_init_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="par_init_+3A_add.cofactors">add.cofactors</code></td>
<td>
<p>Names of cofactors that will be used (see fit_phenology)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>par_init calculates initial set of parameters.
</p>


<h3>Value</h3>

<p>The initial set of parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Plot the phenology and get some stats
output&lt;-plot(result_Gratiot)

## When a series has only 0, it should be used in two steps
## Let see an example

# Let create a times series with only 0
data0 &lt;- data.frame(Date=c("11/3/2015", "12/3/2015", "13/3/2015-18/3/2015", "25/3/2015"), 
                    Number=c(0, 0, 0, 0), 
                    Beach=rep("Site0", 4), stringsAsFactors=FALSE)
data1 &lt;- data.frame(Date=c("15/3/2015", "16/3/2015", "20/3/2015-22/3/2015", "25/3/2015"), 
                    Number=c(1, 0, 3, 0), 
                    Beach=rep("Site1", 4), stringsAsFactors=FALSE)
data &lt;- rbind(data0, data1)

# Here I include timeseries with no observation
try1 &lt;- add_phenology(data, format="%d/%m/%Y", month_ref=1, include0=TRUE)
pfixed &lt;- c(Min=0, Flat=0)
parg &lt;- par_init(try1, fixed.parameters=pfixed)
# The Max value for the series without observations should not be fitted. The ML is for Max being 0
pfixed &lt;- c(pfixed, parg[(substr(names(parg), 1, 4)=="Max_") &amp; (parg == 0)])
parg &lt;- parg[!(names(parg) %in% names(pfixed))]


## End(Not run)
</code></pre>

<hr>
<h2 id='Parameter_Global_Year'>Transform a set of parameters from Year to global effect, or reverse</h2><span id='topic+Parameter_Global_Year'></span>

<h3>Description</h3>

<p>This function is used to transform a set of parameters
that uses Peak, LengthB, LengthE, B, E, or Length to the same parameter
with Year effect, or reverse.<br />
The parameter series can be or a result from add_phenology() or from
fit_phenology() or simply a vector of names.<br />
If this is a vector of names, it is checked to remove _ characters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Parameter_Global_Year(
  parameters = stop("A set of parameters must be indicated"),
  parname = c("Peak", "LengthB", "LengthE", "B", "E", "Length"),
  series = NULL,
  sep_year = "-",
  perYear = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Parameter_Global_Year_+3A_parameters">parameters</code></td>
<td>
<p>Set of current parameters</p>
</td></tr>
<tr><td><code id="Parameter_Global_Year_+3A_parname">parname</code></td>
<td>
<p>Name of parameter to transform</p>
</td></tr>
<tr><td><code id="Parameter_Global_Year_+3A_series">series</code></td>
<td>
<p>Set of series (see description)</p>
</td></tr>
<tr><td><code id="Parameter_Global_Year_+3A_sep_year">sep_year</code></td>
<td>
<p>Character used to separate the year</p>
</td></tr>
<tr><td><code id="Parameter_Global_Year_+3A_peryear">perYear</code></td>
<td>
<p>TRUE if year-specific values must be setup</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameter_Global_Year transforms a set of parameters from Year to global effect, or reverse
</p>


<h3>Value</h3>

<p>Return a set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
Parameter_Global_Year(parameters=c("Peak_Beach1-2018"=151, "Peak_Beach1-2019"=161), 
                     parname="Peak", perYear=FALSE)
Parameter_Global_Year(parameters=c("Peak"=151), 
                      series = c("beach1", "beach2"), 
                     parname="Peak", perYear=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='phenology'>Run a shiny application for basic functions of phenology package</h2><span id='topic+phenology'></span>

<h3>Description</h3>

<p>Run a shiny application for basic functions of phenology package.
Thanks to Adriana Cortés Gomés and Joana Hancock for their help with translation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phenology()
</code></pre>


<h3>Details</h3>

<p>phenology runs a shiny application for basic functions of phenology package
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
phenology()

## End(Not run)
</code></pre>

<hr>
<h2 id='phenology_MHmcmc'>Run the Metropolis-Hastings algorithm for data</h2><span id='topic+phenology_MHmcmc'></span>

<h3>Description</h3>

<p>Run the Metropolis-Hastings algorithm for data.<br />
The number of iterations is n.iter+n.adapt+1 because the initial likelihood is also displayed.<br />
I recommend thin=10.<br />
If initial point is maximum likelihood, n.adapt = 0 is a good solution.<br />
The parameters intermediate and filename are used to save intermediate results every 'intermediate' iterations (for example 1000). Results are saved in a file of name filename.<br />
The parameter previous is used to indicate the list that has been save using the parameters intermediate and filename. It permits to continue a mcmc search.<br />
These options are used to prevent the consequences of computer crash or if the run is very very long and computer processes are time limited.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phenology_MHmcmc(
  result = stop("An output from fit_phenology() must be provided"),
  n.iter = 10000,
  parametersMCMC = stop("A model generated with phenology_MHmcmc_p() must be provided"),
  n.chains = 1,
  n.adapt = 1000,
  thin = 1,
  trace = FALSE,
  traceML = FALSE,
  adaptive = TRUE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phenology_MHmcmc_+3A_result">result</code></td>
<td>
<p>An object obtained after a SearchR fit</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for each step</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_parametersmcmc">parametersMCMC</code></td>
<td>
<p>A set of parameters used as initial point for searching with information on priors</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_thin">thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_trace">trace</code></td>
<td>
<p>TRUE or FALSE or period, shows progress</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_traceml">traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive content</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_intermediate">intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_filename">filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_+3A_previous">previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>phenology_MHmcmc runs the Metropolis-Hastings algorithm for data (Bayesian MCMC)
</p>


<h3>Value</h3>

<p>A list with resultMCMC being mcmc.list object, resultLnL being likelihoods and parametersMCMC being the parameters used
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
data(Gratiot)
# Generate a formatted list named data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
    reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
# Generate set of priors for Bayesian analysis
pmcmc &lt;- phenology_MHmcmc_p(result_Gratiot, accept = TRUE)
result_Gratiot_mcmc &lt;- phenology_MHmcmc(result = result_Gratiot, n.iter = 10000, 
parametersMCMC = pmcmc, n.chains = 1, n.adapt = 0, thin = 1, trace = FALSE)
# Get standard error of parameters
summary(result_Gratiot_mcmc)
# Make diagnostics of the mcmc results using coda package
mcmc &lt;- as.mcmc(result_Gratiot_mcmc)
require(coda)
heidel.diag(mcmc)
raftery.diag(mcmc)
autocorr.diag(mcmc)
acf(mcmc[[1]][,"LengthB"], lag.max=200, bty="n", las=1)
acf(mcmc[[1]][,"Max_Gratiot"], lag.max=50, bty="n", las=1)
batchSE(mcmc, batchSize=100)
# The batch standard error procedure is usually thought to 
# be not as accurate as the time series methods used in summary
summary(mcmc)$statistics[,"Time-series SE"]
plot(result_Gratiot_mcmc, parameters=3, las=1, xlim=c(-10, 300))

## End(Not run)
</code></pre>

<hr>
<h2 id='phenology_MHmcmc_p'>Generates set of parameters to be used with phenology_MHmcmc()</h2><span id='topic+phenology_MHmcmc_p'></span>

<h3>Description</h3>

<p>Interactive script used to generate set of parameters to be used with phenology_MHmcmc().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phenology_MHmcmc_p(
  result = stop("An output from fit_phenology() must be provided"),
  default.density = "dunif",
  accept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phenology_MHmcmc_p_+3A_result">result</code></td>
<td>
<p>An object obtained after a fit_phenology() fit</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_p_+3A_default.density">default.density</code></td>
<td>
<p>The default density, &quot;dnorm&quot; or &quot;dunif'</p>
</td></tr>
<tr><td><code id="phenology_MHmcmc_p_+3A_accept">accept</code></td>
<td>
<p>If TRUE, does not wait for use interaction</p>
</td></tr>
</table>


<h3>Details</h3>

<p>phenology_MHmcmc_p generates set of parameters to be used with phenology_MHmcmc()
</p>


<h3>Value</h3>

<p>A matrix with the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
data(Gratiot)
# Generate a formatted list named data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
  	reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
# Generate set of priors for Bayesian analysis
pmcmc &lt;- phenology_MHmcmc_p(result_Gratiot, accept = TRUE)
result_Gratiot_mcmc &lt;- phenology_MHmcmc(result = result_Gratiot, n.iter = 10000, 
parametersMCMC = pmcmc, n.chains = 1, n.adapt = 0, thin = 1, trace = FALSE)
# Get standard error of parameters
summary(result_Gratiot_mcmc)
# Make diagnostics of the mcmc results using coda package
mcmc &lt;- as.mcmc(result_Gratiot_mcmc)
require(coda)
heidel.diag(mcmc)
raftery.diag(mcmc)
autocorr.diag(mcmc)
acf(mcmc[[1]][,"LengthB"], lag.max=200, bty="n", las=1)
acf(mcmc[[1]][,"Max_Gratiot"], lag.max=50, bty="n", las=1)
batchSE(mcmc, batchSize=100)
# The batch standard error procedure is usually thought to 
# be not as accurate as the time series methods used in summary
summary(mcmc)$statistics[,"Time-series SE"]
plot(result_Gratiot_mcmc, parameters=3, las=1, xlim=c(-10, 300))

## End(Not run)
</code></pre>

<hr>
<h2 id='phenology2fitRMU'>Create the data to be used with fitRMU() for a summary(phenology).</h2><span id='topic+phenology2fitRMU'></span>

<h3>Description</h3>

<p>This function takes the result of plot.phenology() and generates the information
to be used with fitRMU().<br />
The value of density can be dnorm or dgamma. dnorm is better if ML results are used and
dgamma is for MCMC.<br />
Here are some example of regular expressions (regex) in grep:<br />
If format of timeseries is beachname-2005: <br />
rookeries.names.grep=&quot;(.+)-.+&quot;<br />
years.grep=&quot;.+-(.+)$&quot;<br />
Examples:<br />
gsub(&quot;(.+)-.+&quot;, &quot;\\1&quot;, &quot;beachname-2005&quot;); gsub(&quot;.+-(.+)$&quot;, &quot;\\1&quot;, &quot;beachname-2005&quot;)<br />
If format of timeseries is beachname-2005-2006: <br />
rookeries.names.grep=&quot;(.+)-.+-.+&quot;<br />
years.grep=&quot;.+-([0-9][0-9][0-9][0-9])-.+$&quot;<br />
Examples:<br />
gsub(&quot;(.+)-.+-.+&quot;, &quot;\\1&quot;, &quot;beachname-2005-2006&quot;);
gsub(&quot;.+-([0-9][0-9][0-9][0-9])-.+$&quot;, &quot;\\1&quot;, &quot;beachname-2005-2006&quot;)<br />
If format of timeseries is beachname-20052006:<br />
rookeries.names.grep=&quot;(.+)-.+&quot;<br />
years.grep=&quot;.+-([0-9][0-9][0-9][0-9])([0-9][0-9][0-9][0-9])$&quot;<br />
Examples:<br />
gsub(&quot;(.+)-.+&quot;, &quot;\\1&quot;, &quot;beachname-20052006&quot;);
gsub(&quot;.+-([0-9][0-9][0-9][0-9])([0-9][0-9][0-9][0-9])$&quot;, &quot;\\1&quot;, &quot;beachname-20052006&quot;)<br />
The return is a list with these elements:<br />
RMU.data, years.byrow, colname.year, and RMU.names.<br />
If density is a vector, the density used is linked to the rank of the timeseries in phenologyout.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phenology2fitRMU(
  phenologyout = stop("A result obtained from summary(phenology)"),
  col.mean = "with_obs_Mean_ML",
  col.var = "with_obs_Var_ML",
  rookeries.names.grep = "(.+)-.+",
  years.grep = ".+-(.+)$",
  limit.cv = +Inf,
  limit.sd = +Inf,
  density = "dgamma"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phenology2fitRMU_+3A_phenologyout">phenologyout</code></td>
<td>
<p>A result of plot.phenology() or summary()</p>
</td></tr>
<tr><td><code id="phenology2fitRMU_+3A_col.mean">col.mean</code></td>
<td>
<p>Name of the column to be used as mean value. Can be a vector.</p>
</td></tr>
<tr><td><code id="phenology2fitRMU_+3A_col.var">col.var</code></td>
<td>
<p>Name of the column to be used as variance value. Can be a vector.</p>
</td></tr>
<tr><td><code id="phenology2fitRMU_+3A_rookeries.names.grep">rookeries.names.grep</code></td>
<td>
<p>The pattern to return the rookery name from names of timeseries.</p>
</td></tr>
<tr><td><code id="phenology2fitRMU_+3A_years.grep">years.grep</code></td>
<td>
<p>The pattern to return the year from names of timeseries.</p>
</td></tr>
<tr><td><code id="phenology2fitRMU_+3A_limit.cv">limit.cv</code></td>
<td>
<p>Remove data with higher coefficient of variation than the limit.</p>
</td></tr>
<tr><td><code id="phenology2fitRMU_+3A_limit.sd">limit.sd</code></td>
<td>
<p>Remove data with higher standard deviation than the limit.</p>
</td></tr>
<tr><td><code id="phenology2fitRMU_+3A_density">density</code></td>
<td>
<p>What density should be used. Can be dnorm or dgamma. Can be a vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>phenology2fitRMU is used to prepare output of phenology to be used by fitRMU()
</p>


<h3>Value</h3>

<p>Return a list with elements ready to be used with fitRMU().
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_delta'>Plot a likelihood lineplot obtained after map_phenology.</h2><span id='topic+plot_delta'></span>

<h3>Description</h3>

<p>This function plots a likelihood lineplot obtained after map_phenology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_delta(map = NULL, Phi = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_delta_+3A_map">map</code></td>
<td>
<p>A map generated with map_phenology</p>
</td></tr>
<tr><td><code id="plot_delta_+3A_phi">Phi</code></td>
<td>
<p>Phi value or NULL</p>
</td></tr>
<tr><td><code id="plot_delta_+3A_...">...</code></td>
<td>
<p>Parameters for plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot_delta plots the likelihood delta for fixed Phi value.
</p>


<h3>Value</h3>

<p>Return None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Extract the fitted parameters
parg1&lt;-extract_result(result_Gratiot)
# Add constant Alpha and Tau values 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
pfixed&lt;-c(parg1, Alpha=0, Tau=1)
pfixed&lt;-pfixed[-which(names(pfixed)=="Theta")]
# The only fitted parameter will be Beta
parg2&lt;-c(Beta=0.5, parg1["Theta"])
# Generate a likelihood map 
# [default Phi=seq(from=0.1, to=20, length.out=100) but it is very long]
# Take care, it takes 20 hours ! The data map_Gratiot has the result
map_Gratiot&lt;-map_phenology(data=data_Gratiot, 
		Phi=seq(from=0.1, to=20, length.out=100), 
		fitted.parameters=parg2, fixed.parameters=pfixed)
data(map_Gratiot)
# Plot the min(-Ln L) for Delta varying with Phi equal to the value for maximum likelihood
plot_delta(map=map_Gratiot)
# Plot the min(-Ln L) for Delta varying with Phi the nearest to 15
plot_delta(map=map_Gratiot, Phi=15)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_phi'>Plot the best likelihood for fixed Phi value.</h2><span id='topic+plot_phi'></span>

<h3>Description</h3>

<p>The function &quot;plot_phi&quot; plots the best likelihood for each Phi value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_phi(map = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_phi_+3A_map">map</code></td>
<td>
<p>A map generated with map_phenology</p>
</td></tr>
<tr><td><code id="plot_phi_+3A_...">...</code></td>
<td>
<p>Parameters for plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot_phi plots the best likelihood for fixed Phi value.
</p>


<h3>Value</h3>

<p>Return None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("phenology")
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
## Not run: 
result_Gratiot&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)

## End(Not run)
data(result_Gratiot)
# Extract the fitted parameters
parg1&lt;-extract_result(result_Gratiot)
# Add constant Alpha and Tau values 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
pfixed&lt;-c(parg1, Alpha=0, Tau=1)
pfixed&lt;-pfixed[-which(names(pfixed)=="Theta")]
# The only fitted parameter will be Beta
parg2&lt;-c(Beta=0.5, parg1["Theta"])
# Generate a likelihood map [default Phi=seq(from=0.1, to=20, length.out=100) but it is very long]
# Take care, it takes 20 hours ! The data map_Gratiot has the result
## Not run: 
map_Gratiot&lt;-map_phenology(data=data_Gratiot, 
		Phi=seq(from=0.1, to=20, length.out=100), 
		fitted.parameters=parg2, fixed.parameters=pfixed)

## End(Not run)
data(map_Gratiot)
# Plot the min(-Ln L) for Phi varying at any delta value
plot_phi(map=map_Gratiot)
</code></pre>

<hr>
<h2 id='plot.ECFOCF'>Plot a result of clutch frequency fit.</h2><span id='topic+plot.ECFOCF'></span>

<h3>Description</h3>

<p>This function plots the result of fitCF().<br />
The result <code>data</code> plots the observed ECF-OCF table.<br />
The result <code>dataOCF</code> plots the observed OCF table.<br />
The result <code>dataECF</code> plots the observed ECF table.<br />
The result <code>CF</code> plots the true clutch frequency.<br />
The result <code>OCF</code> plots the observed clutch frequency.<br />
The result <code>ECF</code> plots the estimated clutch frequency.<br />
The result <code>ECFOCF</code> plots the bivariate observed vs. estimated clutch frequency.<br />
The result <code>ECFOCF0</code> plots the bivariate observed vs. estimated clutch frequency without the 0 OCF.<br />
The result <code>prob</code> plots the probabilities of capture.<br />
The result <code>period</code> plots the probabilities of nesting according to period.<br />
If category is left to NA, the compound value for all the population is plotted.<br />
When result=&quot;data&quot; is used, this is a parser for plot.TableECFOCF().<br />
See this function for the parameters.<br />
The parameter y.axis is the shift of the x legends for result=&quot;prob&quot;.<br />
When a <code>resultMCMC</code> is indicated, if replicates is &quot;all&quot;, all values are used;
if a value lower than number of iterations is indicated, a regular thinning is used and
if a value larger then number if iteration is indicated, a sampling with replacement is used.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ECFOCF'
plot(
  x,
  ...,
  result = "CF",
  category = NA,
  period = 1,
  resultMCMC = NULL,
  chain = 1,
  replicates = "all"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ECFOCF_+3A_x">x</code></td>
<td>
<p>A result for fitCF().</p>
</td></tr>
<tr><td><code id="plot.ECFOCF_+3A_...">...</code></td>
<td>
<p>Graphic parameters, see plot.TableECFOCF() or par.</p>
</td></tr>
<tr><td><code id="plot.ECFOCF_+3A_result">result</code></td>
<td>
<p>What result will be plotted: data, dataOCF, dataECF, ECF, OCF, ECFOCF, ECFOCF0, CF, Prob, period</p>
</td></tr>
<tr><td><code id="plot.ECFOCF_+3A_category">category</code></td>
<td>
<p>What category will be plotted, numeric or NA for all.</p>
</td></tr>
<tr><td><code id="plot.ECFOCF_+3A_period">period</code></td>
<td>
<p>The period that will be plotted.</p>
</td></tr>
<tr><td><code id="plot.ECFOCF_+3A_resultmcmc">resultMCMC</code></td>
<td>
<p>A result from fitRMU_MHmcmc.</p>
</td></tr>
<tr><td><code id="plot.ECFOCF_+3A_chain">chain</code></td>
<td>
<p>Which chain to be used in resultMCMC.</p>
</td></tr>
<tr><td><code id="plot.ECFOCF_+3A_replicates">replicates</code></td>
<td>
<p>How many replicates fron resultMCMC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.ECFOCF plots a result of clutch frequency fit.
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data(MarineTurtles_2002)
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002)
o_mu1p2_NB &lt;- fitCF(x = c(mu = 4.6426989650675701, 
                         sd = 75.828239144717074, 
                         p1 = 0.62036295627161053,
                         p2 = -2.3923021862881511, 
                         OTN = 0.33107456308054345),
                 data=ECFOCF_2002)
                 
par(mar=c(4, 4, 1, 1)+0.4)
plot(o_mu1p2_NB, result="data", category=NA, 
     bty="n", las=1, cex.points=3, cex.axis = 0.8)
plot(o_mu1p2_NB,result="data", category=NA, 
     bty="n", las=1, cex.points=3, pch=NA, 
     col.labels = "red", show.labels=TRUE, cex.0=0.2, 
     show.0 = TRUE, col.0="blue", pch.0=4)
plot(o_mu1p2_NB, result="dataOCF", category=NA, 
     bty="n", las=1)
plot(o_mu1p2_NB, result="dataECF", category=NA, 
     bty="n", las=1)
     
plot(o_mu1p2_NB, result="CF", bty="n", las=1)

plot(o_mu1p2_NB, result="OCF", category=1, bty="n", las=1)
plot(o_mu1p2_NB, result="OCF", category=2, bty="n", las=1)

plot(o_mu1p2_NB, result="ECFOCF", bty="n", las=1)

plot(o_mu1p2_NB, result="ECFOCF0", bty="n", las=1)
plot(o_mu1p2_NB, result="ECFOCF0", category=1, bty="n", las=1)
plot(o_mu1p2_NB, result="ECFOCF0", category=2, bty="n", las=1)

plot(o_mu1p2_NB, result="Prob", category=c(1, 2), bty="n", las=1)
plot(o_mu1p2_NB, result="Prob", category=c(2, 1), bty="n", las=1)


## End(Not run)
</code></pre>

<hr>
<h2 id='plot.fitRMU'>Plot the synthesis of RMU fit.</h2><span id='topic+plot.fitRMU'></span>

<h3>Description</h3>

<p>The function plot.fitRMU plots the results of fitRMU().<br />
In most of the cases, replicate.CI can be set to 0 for what=&quot;proportions&quot; or &quot;numbers&quot;.<br />
The parameter CI.RMU can be used when this function is used several times with the same data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitRMU'
plot(
  x,
  ...,
  resultMCMC = NULL,
  chain = 1,
  replicate.CI = 10000,
  CI.RMU = NULL,
  what = "proportions",
  criteria = "50%",
  aggregate = "both",
  order = NULL,
  control.legend = list(),
  show.legend = TRUE,
  col = rainbow,
  border = NA,
  names.legend = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.fitRMU_+3A_x">x</code></td>
<td>
<p>A result file generated by fitRMU</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_...">...</code></td>
<td>
<p>Parameters used by plot</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_resultmcmc">resultMCMC</code></td>
<td>
<p>MCMC result for fitRUM</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_chain">chain</code></td>
<td>
<p>Chain to be plotted for MCMC</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates to estimate CI</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_ci.rmu">CI.RMU</code></td>
<td>
<p>A result of CI.RMU()</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_what">what</code></td>
<td>
<p>Can be proportions, numbers or total</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_criteria">criteria</code></td>
<td>
<p>What criteria will be used for proportions or numbers: mean or 50%</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_aggregate">aggregate</code></td>
<td>
<p>Can be model or both</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_order">order</code></td>
<td>
<p>Give the order of series in plot, from bottom to top. Can be used to not show series.</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_control.legend">control.legend</code></td>
<td>
<p>Parameters send to legend</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_show.legend">show.legend</code></td>
<td>
<p>If FALSE, does not show legend</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_col">col</code></td>
<td>
<p>The function used to generate colors.</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_border">border</code></td>
<td>
<p>The border of polygons used to represent the proportions.</p>
</td></tr>
<tr><td><code id="plot.fitRMU_+3A_names.legend">names.legend</code></td>
<td>
<p>Names to show in legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.fitRMU plots the results of a fit RMU.
</p>


<h3>Value</h3>

<p>Return A list with result of CI.RMU()
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Fill gaps in RMU: 
<code><a href="#topic+CI.RMU">CI.RMU</a>()</code>,
<code><a href="#topic+fitRMU">fitRMU</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc">fitRMU_MHmcmc</a>()</code>,
<code><a href="#topic+fitRMU_MHmcmc_p">fitRMU_MHmcmc_p</a>()</code>,
<code><a href="#topic+logLik.fitRMU">logLik.fitRMU</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
RMU.names.AtlanticW &lt;- data.frame(mean=c("Yalimapo.French.Guiana", 
                                         "Galibi.Suriname", 
                                         "Irakumpapy.French.Guiana"), 
                                 se=c("se_Yalimapo.French.Guiana", 
                                      "se_Galibi.Suriname", 
                                      "se_Irakumpapy.French.Guiana"), stringsAsFactors = FALSE)
data.AtlanticW &lt;- data.frame(Year=c(1990:2000), 
      Yalimapo.French.Guiana=c(2076, 2765, 2890, 2678, NA, 
                               6542, 5678, 1243, NA, 1566, 1566),
      se_Yalimapo.French.Guiana=c(123.2, 27.7, 62.5, 126, NA, 
                                 230, 129, 167, NA, 145, 20),
      Galibi.Suriname=c(276, 275, 290, NA, 267, 
                       542, 678, NA, 243, 156, 123),
      se_Galibi.Suriname=c(22.3, 34.2, 23.2, NA, 23.2, 
                           4.3, 2.3, NA, 10.3, 10.1, 8.9),
      Irakumpapy.French.Guiana=c(1076, 1765, 1390, 1678, NA, 
                               3542, 2678, 243, NA, 566, 566),
      se_Irakumpapy.French.Guiana=c(23.2, 29.7, 22.5, 226, NA, 
                                 130, 29, 67, NA, 15, 20), stringsAsFactors = FALSE)
                           
cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Constant", 
               model.SD="Zero")
expo &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
               colname.year="Year", model.trend="Exponential", 
               model.SD="Zero")
YS &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", 
             model.SD="Zero")
YS1 &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", 
             model.SD="Zero", model.rookeries="First-order")
YS1_cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific", 
             model.SD="Constant", model.rookeries="First-order", 
             parameters=YS1$par)
YS2 &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific",
             model.SD="Zero", model.rookeries="Second-order", 
             parameters=YS1$par)
YS2_cst &lt;- fitRMU(RMU.data=data.AtlanticW, RMU.names=RMU.names.AtlanticW, 
             colname.year="Year", model.trend="Year-specific",
             model.SD="Constant", model.rookeries="Second-order", 
             parameters=YS1_cst$par)
               
compare_AIC(Constant=cst, Exponential=expo, 
YearSpecific=YS)

compare_AIC(YearSpecific_ProportionsFirstOrder_Zero=YS1,
YearSpecific_ProportionsFirstOrder_Constant=YS1_cst)

compare_AIC(YearSpecific_ProportionsConstant=YS,
           YearSpecific_ProportionsFirstOrder=YS1,
           YearSpecific_ProportionsSecondOrder=YS2)
           
compare_AIC(YearSpecific_ProportionsFirstOrder=YS1_cst,
           YearSpecific_ProportionsSecondOrder=YS2_cst)

barplot_errbar(YS1_cst$proportions[1, ], y.plus = YS1_cst$proportions.CI.0.95[1, ], 
               y.minus = YS1_cst$proportions.CI.0.05[1, ], las=1, ylim=c(0, 0.7), 
               main="Proportion of the different rookeries in the region")

plot(cst, main="Use of different beaches along the time", what="total")
plot(expo, main="Use of different beaches along the time", what="total")
plot(YS2_cst, main="Use of different beaches along the time", what="total")

plot(YS1, main="Use of different beaches along the time")
plot(YS1_cst, main="Use of different beaches along the time")
plot(YS1_cst, main="Use of different beaches along the time", what="numbers")

parpre &lt;- par(mar=c(4, 4, 2, 5)+0.4)
par(xpd=TRUE)
plot(YS, main="Use of different beaches along the time", 
     control.legend=list(x=2000, y=0.4, legend=c("Yalimapo", "Galibi", "Irakumpapy")))
par(mar=parpre)

# Example to modify order of series
plot(cst, order=c("Galibi.Suriname", "Irakumpapy.French.Guiana"))
plot(cst, order=c("Galibi.Suriname", "Irakumpapy.French.Guiana", "Yalimapo.French.Guiana"))

# Example to change the color
plot(cst, order=c("Galibi.Suriname", "Irakumpapy.French.Guiana", "Yalimapo.French.Guiana"), 
     col=function(n) rep(c("gray", "lightgrey"), floor(n/2)), border="black", 
     names.legend=c("Yalimapo", "Galibi", "Irakumpapy"))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.IP'>Plot a result of Internesting Period fit or data.</h2><span id='topic+plot.IP'></span>

<h3>Description</h3>

<p>This function plots the result of IPFit() or IPModel().<br />
If col is defined with a number of colors, only these colors and shown in legend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'IP'
plot(x, ..., N = NULL, clutch = 1, result = "data")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.IP_+3A_x">x</code></td>
<td>
<p>A result for IPFit() or IPModel().</p>
</td></tr>
<tr><td><code id="plot.IP_+3A_...">...</code></td>
<td>
<p>Graphic parameters, see par().</p>
</td></tr>
<tr><td><code id="plot.IP_+3A_n">N</code></td>
<td>
<p>Number of replicates for IPModel().</p>
</td></tr>
<tr><td><code id="plot.IP_+3A_clutch">clutch</code></td>
<td>
<p>The rank of clutch when DeltameanIP is used.</p>
</td></tr>
<tr><td><code id="plot.IP_+3A_result">result</code></td>
<td>
<p>What result will be plotted: data, model, data&amp;model, IP, Abort, ECF, reverseECF</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.IP plots a result of Internesting Period fit or data
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Internesting Period: 
<code><a href="#topic+IPFit">IPFit</a>()</code>,
<code><a href="#topic+IPModel">IPModel</a>()</code>,
<code><a href="#topic+IPPredict">IPPredict</a>()</code>,
<code><a href="#topic+summary.IP">summary.IP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data &lt;- c(0, 47, 15, 6, 5, 4, 2, 5, 57, 203, 205, 103, 35, 24, 12, 10, 
  13, 49, 86, 107, 111, 73, 47, 30, 19, 17, 33, 48, 77, 83, 65, 
  37, 27, 23, 24, 22, 41, 42, 44, 33, 39, 24, 18, 18, 22, 22, 19, 
  24, 28, 17, 18, 19, 17, 4, 12, 9, 6, 11, 7, 11, 12, 5, 4, 6, 
  11, 5, 6, 7, 3, 2, 1, 3, 2, 1, 2, 0, 0, 3, 1, 0, 2, 0, 0, 1)
  class(data) &lt;- unique(append("IP", class(data)))
  plot(data)
  
######### Fit parametric ECF using Maximum-Likelihood

par &lt;- c(meanIP = 9.9959691992722917, 
         sdIP = 0.10066664270893474, 
         minIP = 7.5684588178888754, 
         pAbort = 2.2510012544630911, 
         meanAbort = 2.8969185085603386, 
         sdAbort = 0.92688983853803242, 
         pCapture = -1.0393803705929086, 
         meanECF = 3.9551519427394255, 
         sdECF = 0.31657679943365019)

fML &lt;- IPFit(x=par, 
fixed.parameters=c(N=1000000),
data=data, 
verbose=FALSE, 
model="ML")

# Plot the fitted ECF
plot(fML, result="ECF")

# Plot the Internesting Period distribution
plot(fML, result="IP")

# Plot the distribution of days between tentatives
plot(fML, result="Abort")
plot(fML, result="Abort", xlim=c(0, 10))

# Plot the data
plot(fML, result="data")

# Plot the data and the model
plot(fML, result="data&amp;model")

# Plot the cumulative proportion of ECF according to date of observation
plot(fML, result="reverseECF")
plot(fML_NP_Delta, result="reverseECF", col=grey.colors(128))

######### Fit using Metropolis-Hastings
# ECF.1 = 1 is fixed
par &lt;- c(ECF.2 = 0.044151921569961131, 
         ECF.3 = 2.0020778325280748, 
         ECF.4 = 2.6128345101617083, 
         ECF.5 = 2.6450582416622375, 
         ECF.6 = 2.715198206774927, 
         ECF.7 = 2.0288031327239904, 
         ECF.8 = 1.0028041546528881, 
         ECF.9 = 0.70977432157689235, 
         ECF.10 = 0.086052204035003091, 
         ECF.11 = 0.011400419961702518, 
         ECF.12 = 0.001825219438794076, 
         ECF.13 = 0.00029398731859899116, 
         ECF.14 = 0.002784886479846703, 
         meanIP = 9.9887100433529721, 
         sdIP = 0.10580250625108811, 
         minIP = 6.5159124624132048, 
         pAbort = 2.5702251748938956, 
         meanAbort = 2.2721679285648841, 
         sdAbort = 0.52006431730489933, 
         pCapture = 0.079471782729506113)
         
df &lt;- data.frame(Density=rep("dunif", length(par)), 
Prior1=c(rep(0, 13), 8, 0.001, 0, -8, 0, 0.001, -8), 
Prior2=c(rep(10, 13), 12, 1, 10, 8, 2, 1, 8), 
SDProp=unname(c(ECF.2 = 6.366805760909012e-05, 
                ECF.3 = 6.366805760909012e-05, 
                ECF.4 = 6.366805760909012e-05, 
                ECF.5 = 6.366805760909012e-05, 
                ECF.6 = 6.366805760909012e-05, 
                ECF.7 = 6.366805760909012e-05, 
                ECF.8 = 6.366805760909012e-05, 
                ECF.9 = 6.366805760909012e-05, 
                ECF.10 = 6.366805760909012e-05, 
                ECF.11 = 6.366805760909012e-05, 
                ECF.12 = 6.366805760909012e-05, 
                ECF.13 = 6.366805760909012e-05, 
                ECF.14 = 6.366805760909012e-05, 
                meanIP = 6.366805760909012e-05, 
                sdIP = 6.366805760909012e-05, 
                minIP = 6.366805760909012e-05, 
                pAbort = 6.366805760909012e-05, 
                meanAbort = 6.366805760909012e-05, 
                sdAbort = 6.366805760909012e-05, 
                pCapture = 6.366805760909012e-05)),               
Min=c(rep(0, 13), 8, 0.001, 0, -8, 0, 0.001, -8), 
Max=c(rep(10, 13), 12, 1, 10, 8, 2, 1, 8),
Init=par, stringsAsFactors = FALSE)
rownames(df)&lt;- names(par)

fMH &lt;- IPFit(parametersMH=df, 
fixed.parameters=c(N=10000),
data=data, 
verbose=FALSE, 
n.iter = 10000,
n.chains = 1, n.adapt = 100, thin = 1, trace = TRUE,
adaptive = TRUE, 
model="MH")

# Plot the fitted ECF
plot(fMH, result="ECF")

# Plot the posteriors and priors
plot(fMH$MH, parameters="meanIP", xlim=c(6, 14))

plot(x=1:length(fMH$MH$resultLnL[[1]]), y=fMH$MH$resultLnL[[1]], 
type="l", xlab="Iterations", ylab="Ln L", bty="n", las=1)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.phenology'>Plot the phenology from a result.</h2><span id='topic+plot.phenology'></span>

<h3>Description</h3>

<p>The function plot.phenology plots the phenology graph from a result object.<br />
If cofactors have been added, the plot does not show their effects.<br />
plot.objects can be &quot;observations&quot;, &quot;ML&quot; for maximum likelihood, &quot;ML.SD&quot; for dispersion of
observations, &quot;ML.quantiles&quot; or &quot;MCMC.quantiles&quot; if a mcmc object is given
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenology'
plot(
  x,
  ...,
  series = "all",
  moon = FALSE,
  replicate.CI = 10000,
  resultmcmc = NULL,
  season = NULL,
  chain = 1,
  replicate.CI.mcmc = "all",
  level = 0.95,
  plot.objects = c("observations", "ML", "ML.SD", "ML.quantiles", "MCMC.quantiles"),
  col.ML = "black",
  col.SD = "red",
  col.SD.polygon = rgb(red = 1, green = 0, blue = 0, alpha = 0.2),
  col.MCMC.quantiles = "purple",
  col.MCMC.quantiles.polygon = rgb(red = 160/255, green = 32/255, blue = 240/255, alpha =
    0.2),
  col.ML.quantiles = "black",
  col.ML.quantiles.polygon = rgb(red = 0, green = 0, blue = 0, alpha = 0.2),
  col.observations = "black",
  col.minimum.observations = "blue",
  col.grouped.observations = "green"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.phenology_+3A_x">x</code></td>
<td>
<p>A result file generated by fit_phenology</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_...">...</code></td>
<td>
<p>Parameters used by plot</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_series">series</code></td>
<td>
<p>Name or number of series to be plotted or 'all'</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_moon">moon</code></td>
<td>
<p>If TRUE, the moon phase is ploted. Default is FALSE</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates for estimation of confidence interval</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A mcmc object</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_season">season</code></td>
<td>
<p>Which season to plot</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_chain">chain</code></td>
<td>
<p>The number of chain to be used in resultmcmc</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_replicate.ci.mcmc">replicate.CI.mcmc</code></td>
<td>
<p>Number of iterations to be used or &quot;all&quot;</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_level">level</code></td>
<td>
<p>Level to estimate confidence interval or credibility interval</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_plot.objects">plot.objects</code></td>
<td>
<p>What to plot?</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.ml">col.ML</code></td>
<td>
<p>Color of the ML mean curve</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.sd">col.SD</code></td>
<td>
<p>Color of the SD curve (distribution of observations)</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.sd.polygon">col.SD.polygon</code></td>
<td>
<p>Color of the polygon of the SD curve. If FALSE not shown.</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.mcmc.quantiles">col.MCMC.quantiles</code></td>
<td>
<p>Color of the quantiles curve based on mcmc</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.mcmc.quantiles.polygon">col.MCMC.quantiles.polygon</code></td>
<td>
<p>Color of the credibility interval polygon based on MCMC. If FALSE not shown.</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.ml.quantiles">col.ML.quantiles</code></td>
<td>
<p>Color of the SE curve based on ML</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.ml.quantiles.polygon">col.ML.quantiles.polygon</code></td>
<td>
<p>Color of the confidence interval polygon based on ML. If FALSE not shown.</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.observations">col.observations</code></td>
<td>
<p>Color of the points</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.minimum.observations">col.minimum.observations</code></td>
<td>
<p>Color of the points indicating minimum counts</p>
</td></tr>
<tr><td><code id="plot.phenology_+3A_col.grouped.observations">col.grouped.observations</code></td>
<td>
<p>Color of the lines indicating grouped observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.phenology plots the phenology.
</p>


<h3>Value</h3>

<p>A list with four objects: synthesis is a data.frame with global estimate of nesting.<br />
details_MCMC, details_ML and details_mean are lists with day by day information for each series.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name = "Complete", 
		reference = as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
parg &lt;- c('Max_Complete' = 33.076044848500167, 25, 
          'MinB_Complete' = 0.21758630798131923, 
          'MinE_Complete' = 0.42493953463205936, 
          'LengthB' = 96.158007568020523, 
          'Peak' = 174.62435300274245, 
          'LengthE' = 62.084876419654634, 
          'Flat' = 0, 
          'Theta' = 3.5864650991821954)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		                             fitted.parameters=parg, 
		                             fixed.parameters=NULL)
data(result_Gratiot)
# Plot the phenology and get some stats
output &lt;- plot(result_Gratiot)
# Plot only part of the nesting season
ptoutput &lt;- plot(result_Gratiot, xlim=c(as.Date("2001-03-01"),as.Date("2001-08-31")))
# Use month names in English
Sys.setlocale(category = "LC_TIME", locale = "en_GB.UTF-8")
output &lt;- plot(result_Gratiot)
# set back the month name in local R language
Sys.setlocale(category = "LC_TIME", locale = "")
# plot based on quantiles of mcmc object
plot(result_Gratiot, resultmcmc=result_Gratiot_mcmc, 
            plot.objects=c("observations", "MCMC.quantiles"))
plot(result_Gratiot, resultmcmc=result_Gratiot_mcmc, 
            plot.objects=c("observations", "ML.SD", "ML.quantiles"))
plot(result_Gratiot, resultmcmc=result_Gratiot_mcmc, 
            plot.objects=c("observations", "ML.SD", "MCMC.quantiles"))
plot(result_Gratiot, resultmcmc=result_Gratiot_mcmc, 
            plot.objects=c("observations", "ML.quantiles", "MCMC.quantiles"))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.phenologymap'>Plot a likelihood map with Delta and Phi varying.</h2><span id='topic+plot.phenologymap'></span>

<h3>Description</h3>

<p>This function plots a likelihood map obtained after map_phenology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenologymap'
plot(x, ..., col = heat.colors(128), xlab = "Phi", ylab = "Delta")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.phenologymap_+3A_x">x</code></td>
<td>
<p>A map generated with map_phenology.</p>
</td></tr>
<tr><td><code id="plot.phenologymap_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="plot.phenologymap_+3A_col">col</code></td>
<td>
<p>Colors could be heat.colors(128) or rainbow(64) or col=gray(c(seq(0, 1, length.out=128)))</p>
</td></tr>
<tr><td><code id="plot.phenologymap_+3A_xlab">xlab</code></td>
<td>
<p>Label for x axis</p>
</td></tr>
<tr><td><code id="plot.phenologymap_+3A_ylab">ylab</code></td>
<td>
<p>Label for y axis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.phenologymap plots a likelihood map with Delta and Phi varying.
</p>


<h3>Value</h3>

<p>Return None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("phenology")
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Extract the fitted parameters
parg1&lt;-extract_result(result_Gratiot)
# Add constant Alpha and Tau values 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
pfixed&lt;-c(parg1, Alpha=0, Tau=1)
pfixed&lt;-pfixed[-which(names(pfixed)=="Theta")]
# The only fitted parameter will be Beta
parg2&lt;-c(Beta=0.5, parg1["Theta"])
# Generate a likelihood map 
# [default Phi=seq(from=0.1, to=20, length.out=100) but it is very long]
# Take care, it takes 20 hours ! The data map_Gratiot has the result
map_Gratiot&lt;-map_phenology(data=data_Gratiot, 
		Phi=seq(from=0.1, to=20, length.out=100), 
		fitted.parameters=parg2, fixed.parameters=pfixed)
data(map_Gratiot)
# Plot the map
plot(map_Gratiot, col=heat.colors(128))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.Remigration'>Plot the remigration intervals.</h2><span id='topic+plot.Remigration'></span>

<h3>Description</h3>

<p>Plot the remigration intervals.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Remigration'
plot(x, legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.Remigration_+3A_x">x</code></td>
<td>
<p>Object obtained from Bayesian.remigration()</p>
</td></tr>
<tr><td><code id="plot.Remigration_+3A_legend">legend</code></td>
<td>
<p>TRUE or FALSE or c(x, y)</p>
</td></tr>
<tr><td><code id="plot.Remigration_+3A_...">...</code></td>
<td>
<p>Parameters transmitted to plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.Remigration plots the remigration intervals.
</p>


<h3>Value</h3>

<p>An invisible dataframe with values used for plotting.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Remigration Interval: 
<code><a href="#topic+Bayesian.remigration">Bayesian.remigration</a>()</code>,
<code><a href="#topic+LnRI_norm">LnRI_norm</a>()</code>,
<code><a href="#topic+RI">RI</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example

# Each year a fraction of 0.9 is surviving
s &lt;- c(s=0.9)
# Probability of tag retention; 0.8
t &lt;- c(t=0.8)
# Time-conditional return probability - This is the true remigration rate
r &lt;- c(r1=0.1, r2=0.8, r3=0.7, r4=0.7, r5=1)
# Capture probability
p &lt;- c(p1=0.6, p2=0.6, p3=0.6, p4=0.6, p5=0.6)
# Number of observations for 400 tagged females after 1, 2, 3, 4, and 5 years
OBS &lt;- c(400, 10, 120, 40, 20, 10)

kl_s &lt;- length(s)
kl_t &lt;- length(t)
kl_r &lt;- length(r)
kl_p &lt;- length(p)

pMCMC &lt;- data.frame(Density=c("newdbeta", "newdbeta", rep("dunif", kl_r), 
                              rep("newdbeta", kl_p), "dunif"), 
                    Prior1=c(s, t, rep(0, kl_r), rep(0.2, kl_p), 0), 
                    Prior2=c(0.02, 0.02, rep(1, kl_r), rep(0.08, kl_p), 10), 
                    SDProp=c(0.05, 0.05, rep(0.05, kl_r), rep(0.05, kl_p), 0.05), 
                 Min=c(0, 0, rep(0, kl_r), rep(0, kl_p), 0),  
                 Max=c(1, 1, rep(1, kl_r), rep(1, kl_p), 10),  
                 Init=c(s, t, r, p, 1), stringsAsFactors = FALSE, 
                 row.names=c("s", 
                                "t", 
                                names(r), 
                                names(p), "sd")
)
rMCMC &lt;- Bayesian.remigration(parameters = pMCMC, 
n.iter = 1000000, 
n.adapt = 300000,
trace=10000, 
data=OBS)

plot(rMCMC)


## End(Not run)
</code></pre>

<hr>
<h2 id='plot.TableECFOCF'>Plot a TableECFOCF dataset.</h2><span id='topic+plot.TableECFOCF'></span>

<h3>Description</h3>

<p>This function plots a CMR file summarized using TableECFOCF().<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TableECFOCF'
plot(
  x,
  ...,
  result = "ecfocf",
  period = 1,
  cex.points = 4,
  pch = 19,
  col = "black",
  cex.axis = 0.8,
  cex.labels = 0.5,
  col.labels = "red",
  show.labels = FALSE,
  show.0 = FALSE,
  pch.0 = 4,
  cex.0 = 0.5,
  col.0 = "blue",
  show.scale = TRUE,
  max.scale = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.TableECFOCF_+3A_x">x</code></td>
<td>
<p>A CMR file summarized using TableECFOCF()</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_...">...</code></td>
<td>
<p>Graphic parameters</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_result">result</code></td>
<td>
<p>What should be plotted: ECFOCF or data, ECF, OCF.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_period">period</code></td>
<td>
<p>The period that will be plotted.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_cex.points">cex.points</code></td>
<td>
<p>The maximum magnification to be used for points relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_pch">pch</code></td>
<td>
<p>Character to be used for points.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_col">col</code></td>
<td>
<p>Color to be used for points.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_cex.labels">cex.labels</code></td>
<td>
<p>The magnification to be used for figures.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_col.labels">col.labels</code></td>
<td>
<p>Color of figures.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_show.labels">show.labels</code></td>
<td>
<p>Logical to be used to show figures.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_show.0">show.0</code></td>
<td>
<p>Logical to show 0 counts.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_pch.0">pch.0</code></td>
<td>
<p>Character used for 0 counts.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_cex.0">cex.0</code></td>
<td>
<p>The magnification to be used for character for 0 counts.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_col.0">col.0</code></td>
<td>
<p>Color of characters for 0 counts.</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_show.scale">show.scale</code></td>
<td>
<p>If TRUE, show the scale as a legend</p>
</td></tr>
<tr><td><code id="plot.TableECFOCF_+3A_max.scale">max.scale</code></td>
<td>
<p>Maximum value for scale; if NULL it is maximum of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.TableECFOCF plots a TableECFOCF dataset.
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+TableECFOCF">TableECFOCF</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data(MarineTurtles_2002)
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002)
par(mar=c(4, 4, 1, 1)+0.4)
plot(ECFOCF_2002, bty="n", las=1, cex.points=3, 
     cex.axis = 0.8, main="Year 2002")
plot(ECFOCF_2002, bty="n", las=1, cex.points=5, cex.0=0.2, 
     col="red", show.0 = TRUE, col.0="blue")
plot(ECFOCF_2002, bty="n", las=1, cex.points=3, col="lightgrey",  
     col.labels = "red", show.labels=TRUE)
plot(ECFOCF_2002, bty="n", las=1, cex.points=3, pch=NA, 
     col.labels = "red", show.labels=TRUE)
plot(ECFOCF_2002, bty="n", las=1, cex.points=3, pch=NA, 
     col.labels = "red", show.labels=TRUE, cex.0=0.2, 
     show.0 = TRUE, col.0="blue", pch.0=4)
plot(ECFOCF_2002, bty="n", las=1, result="OCF")
plot(ECFOCF_2002, bty="n", las=1, result="ECF")
plot(ECFOCF_2002, bty="n", las=1, result="ECF", type="l", main="2002 season", 
     xlab="Clutch frequency")
par(new=TRUE)
plot(ECFOCF_2002, bty="n", las=1, result="OCF", type="l", main="", 
     ylim=ScalePreviousPlot()$ylim[c("begin", "end")], 
     xlab="", ylab="", 
     col="red", 
     xaxt="n", yaxt="n", axes=FALSE)
legend("topright", legend=c("OCF", "ECF"), lty=1, col=c("red", "black"))

ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002, date0=as.Date("2002-01-01"))

plot(ECFOCF_2002, period=13)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.Tagloss'>Plot the daily rate of tag loss.</h2><span id='topic+plot.Tagloss'></span>

<h3>Description</h3>

<p>Plot the daily rate of tag loss.<br />
To use this function without a result of Tagloss_fit(), see the hack in examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Tagloss'
plot(
  x,
  t = NULL,
  fitted.parameters = NULL,
  fixed.parameters = NULL,
  scale = 1,
  model_before = NULL,
  model_after = NULL,
  model = c("1", "2", "R1", "R2", "L1", "L2", "cumul", "cumul1", "N2", "N1", "N0", "NLR",
    "N0R", "NL0", "N00"),
  col = rev(grey.colors(4, start = 0.9, end = 0.3)),
  text.col = grey.colors(4, start = 0.9, end = 0.3),
  label.col = "black",
  add = FALSE,
  mcmc = FALSE,
  Hessian = NULL,
  replicates = NULL,
  method = NULL,
  probs = c(0.025, 0.975),
  progressbar = FALSE,
  decoration = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.Tagloss_+3A_x">x</code></td>
<td>
<p>Object obteined from Tagloss_fit()</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_t">t</code></td>
<td>
<p>Time for which values of model must be ploted</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_fitted.parameters">fitted.parameters</code></td>
<td>
<p>Set of parameters</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Another set of parameters without standard error associated</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_scale">scale</code></td>
<td>
<p>Scale value. When Cumul is used, scale is always 1.</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_model_before">model_before</code></td>
<td>
<p>Transformation of parameters before to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_model_after">model_after</code></td>
<td>
<p>Transformation of parameters after to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_model">model</code></td>
<td>
<p>Can be 1, 2, R1, R2, L1, L2 or Cumul (2 tags) or Cumul1 (1 tag)</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_col">col</code></td>
<td>
<p>The colors of shading areas of cumul or the color of line</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_text.col">text.col</code></td>
<td>
<p>The text color for cumul model</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_label.col">label.col</code></td>
<td>
<p>The text color used for labels when decoration is true</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_add">add</code></td>
<td>
<p>Should the data be added to a previous plot?</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_mcmc">mcmc</code></td>
<td>
<p>The mcmc result</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_hessian">Hessian</code></td>
<td>
<p>Hessian matrix of parameters</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates for confidence interval</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_method">method</code></td>
<td>
<p>Which method to use to estimate confidence interval</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_probs">probs</code></td>
<td>
<p>Quantiles to show for confidence interval</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_progressbar">progressbar</code></td>
<td>
<p>Is shown a progressbar?</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_decoration">decoration</code></td>
<td>
<p>Try to add name of parameters on the graph</p>
</td></tr>
<tr><td><code id="plot.Tagloss_+3A_...">...</code></td>
<td>
<p>Parameters transmitted to plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.tagloss plots the daily rate of tag loss.
</p>


<h3>Value</h3>

<p>An invisible dataframe with values used for plotting.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
t &lt;- 1:1000

par &lt;- c(D1_1=200, D2D1_1=100, D3D2_1=200, 
         A_1=-logit(0.02), B_1=-logit(0.05), C_1=-logit(0.07))
phenology:::plot.Tagloss(x=list(), t=t, fitted.parameters=par, model="1")
phenology:::plot.Tagloss(x=list(), t=t, fitted.parameters=par, model="1", 
                         scale=1000, decoration = TRUE)

par &lt;- c(D1_2=200, D2D1_2=100, D3D2_2=200, 
         A_2=-logit(0.05), B_2=-logit(0.03), C_2=-logit(0.03))
phenology:::plot.Tagloss(x=list(), t=t, fitted.parameters=par, ylim=c(0, 1), 
                         scale = 10, model="2", decoration = TRUE)

par &lt;- c(D1_L2=200, D2D1_L2=100, D3D2_L2=200, 
         A_L2=-logit(0.05), B_L2=-logit(0.07), C_L2=-logit(0.07))
phenology:::plot.Tagloss(x=list(), t=t, fitted.parameters=par, model="L2")

par &lt;- c(D1_R2=200, D2D1_R2=0, D3D2_R2=700, 
         A_R2=-logit(0.02), B_R2=-logit(0.05), C_R2=-logit(0.07))
phenology:::plot.Tagloss(x=list(), t=t, fitted.parameters=par, model="R2", 
                         col="red", add=TRUE)

par &lt;- c(D1_L1=200, D2D1_L1=2000, D3D2_L1=2000, 
        A_L1=-logit(0.05), B_L1=-logit(0.02), C_L1=-logit(0.1))
phenology:::plot.Tagloss(x=list(), t=t, fitted.parameters=par, model="L1")

# To plot the history of individuals
par &lt;- c(D1_1=200, D2D1_1=100, D3D2_1=200, 
         A_1=-logit(5E-4), B_1=-logit(4E-4), C_1=-logit(5E-4), 
         D1_2=200, D2D1_2=100, D3D2_2=200, 
         A_2=-logit(6E-4), B_2=-logit(5E-4), C_2=-logit(6E-4))
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE, col=c("red", "green", "blue"))
                         
# To plot the history of individuals
par &lt;- c(D1_R1=200, D2D1_R1=300, D3D2_R1=200, 
         A_R1=-logit(5E-4), B_R1=-logit(4E-4), C_R1=-logit(5E-4), 
         D1_R2=200, D2D1_R2=200, D3D2_R2=200, 
         A_R2=-logit(6E-4), B_R2=-logit(5E-4), C_R2=-logit(6E-4), 
         D1_L1=200, D2D1_L1=400, D3D2_L1=200, 
         A_L1=-logit(5E-4), B_L1=-logit(4E-4), C_L1=-logit(5E-4), 
         D1_L2=200, D2D1_L2=100, D3D2_L2=200, 
         A_L2=-logit(6E-4), B_L2=-logit(5E-4), C_L2=-logit(6E-4))
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, model="Cumul", 
                         decoration = TRUE)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, model="R1", 
                         decoration = TRUE)                         
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, model="R2", 
                         decoration = TRUE)
# Example of fit

data_f_21 &lt;- Tagloss_format(outLR, model="21")
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
par &lt;- c('D1_2' = 49.78891736351531, 
         'D2D1_2' = 1059.3635769732305, 
         'D3D2_2' = 12.434313273804602, 
         'A_2' = 5.2238379144659683, 
         'B_2' = 8.0050044071275543, 
         'C_2' = 8.4317863609499675, 
         'D1_1' = 701.80273287212935, 
         'D2D1_1' = 0.010951749100596819, 
         'D3D2_1' = 3773.6290607434876, 
         'A_1' = 205.42435592344776, 
         'B_1' = 9.9598342503239863, 
         'C_1' = 6.7234868237164722)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, model="1", 
                         decoration = TRUE)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, model="2", 
                         decoration = TRUE)
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par, hessian = TRUE)
plot(x=o, model="1", replicates=0, 
     method=NULL, decoration = TRUE)
plot(x=o, model="1", replicates=1000, 
     method="Hessian", decoration = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.TaglossData'>Plot data used for tagloss analysis.</h2><span id='topic+plot.TaglossData'></span>

<h3>Description</h3>

<p>This function plots the result of Tagloss_format().<br />
The default ramp of colors is a grey ramp.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TaglossData'
plot(
  x,
  ...,
  categories = c("N22", "N21", "N11", "N10", "N20"),
  col = grey(seq(from = 0.9, to = 0, length.out = length(categories))),
  title.legend = "Tag history",
  categories.legend = categories,
  show.legend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.TaglossData_+3A_x">x</code></td>
<td>
<p>A result for Tagloss_format.</p>
</td></tr>
<tr><td><code id="plot.TaglossData_+3A_...">...</code></td>
<td>
<p>Graphic parameters, see par().</p>
</td></tr>
<tr><td><code id="plot.TaglossData_+3A_categories">categories</code></td>
<td>
<p>Categories to display.</p>
</td></tr>
<tr><td><code id="plot.TaglossData_+3A_col">col</code></td>
<td>
<p>The ramp of colors used for the categories.</p>
</td></tr>
<tr><td><code id="plot.TaglossData_+3A_title.legend">title.legend</code></td>
<td>
<p>Title for legend box.</p>
</td></tr>
<tr><td><code id="plot.TaglossData_+3A_categories.legend">categories.legend</code></td>
<td>
<p>Name of categories to show in legend box.</p>
</td></tr>
<tr><td><code id="plot.TaglossData_+3A_show.legend">show.legend</code></td>
<td>
<p>Should the legend box be shown ?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.TaglossData plots formated data used for tagloss analysis
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")
plot(data_f_21)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.phenology'>Print the result information from a result x.</h2><span id='topic+print.phenology'></span>

<h3>Description</h3>

<p>The function print displays a phenology result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenology'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.phenology_+3A_x">x</code></td>
<td>
<p>A result file generated by fit_phenology</p>
</td></tr>
<tr><td><code id="print.phenology_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.phenology prints the information from a result x.
</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
## Not run: 
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		                             fitted.parameters=parg, 
		                             fixed.parameters=NULL)

## End(Not run)
data(result_Gratiot)
# Show the result
result_Gratiot
</code></pre>

<hr>
<h2 id='print.phenologymap'>Print information on a phenologymap object.</h2><span id='topic+print.phenologymap'></span>

<h3>Description</h3>

<p>print.phenologymap print information on a phenologymap object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenologymap'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.phenologymap_+3A_x">x</code></td>
<td>
<p>A map generated with map_phenology.</p>
</td></tr>
<tr><td><code id="print.phenologymap_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("phenology")
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
## Not run: 
result_Gratiot&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)

## End(Not run)
data(result_Gratiot)
# Extract the fitted parameters
parg1&lt;-extract_result(result_Gratiot)
# Add constant Alpha and Tau values 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
pfixed&lt;-c(parg1, Alpha=0, Tau=1)
pfixed&lt;-pfixed[-which(names(pfixed)=="Theta")]
# The only fitted parameter will be Beta
parg2&lt;-c(Beta=0.5, parg1["Theta"])
# Generate a likelihood map 
# [default Phi=seq(from=0.1, to=20, length.out=100) but it is very long]
# Take care, it takes 20 hours ! The data map_Gratiot has the result
## Not run: 
map_Gratiot&lt;-map_phenology(data=data_Gratiot, 
		Phi=seq(from=0.1, to=20, length.out=100), fitted.parameters=parg2, 
		fixed.parameters=pfixed)

## End(Not run)
data(map_Gratiot)
# Print the information on a map
map_Gratiot
</code></pre>

<hr>
<h2 id='print.phenologyout'>Print the information from a ouput x.</h2><span id='topic+print.phenologyout'></span>

<h3>Description</h3>

<p>The function print.phenologyout displays the output of a summary(phenology).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenologyout'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.phenologyout_+3A_x">x</code></td>
<td>
<p>An output generated by plot_phenology</p>
</td></tr>
<tr><td><code id="print.phenologyout_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.phenologyout prints the information from a result x.
</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Plot the phenology and get some stats
output &lt;- plot(result_Gratiot)
# Show the output
output

## End(Not run)
</code></pre>

<hr>
<h2 id='remove_site'>Removes site information from a set of parameters.</h2><span id='topic+remove_site'></span>

<h3>Description</h3>

<p>This function is used to remove the information of the site
from a set of parameters. It can be used to other timeseries after.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_site(parameters = NULL, help = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remove_site_+3A_parameters">parameters</code></td>
<td>
<p>Set of parameters</p>
</td></tr>
<tr><td><code id="remove_site_+3A_help">help</code></td>
<td>
<p>If TRUE, an help is displayed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>remove_site removes beach information from a set of parameters.
</p>


<h3>Value</h3>

<p>Return a set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
## Not run: 
result_Gratiot&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)

## End(Not run)
data(result_Gratiot)
# Extract parameters form result
parg&lt;-extract_result(result_Gratiot)
# Remove site information
parg1&lt;-remove_site(parg)
</code></pre>

<hr>
<h2 id='result_Gratiot'>Result of the fit of Leatherback nest counts</h2><span id='topic+result_Gratiot'></span>

<h3>Description</h3>

<p>Result of the fit of Leatherback nest counts from Gratiot et al. (2006) Figure 1
The phenology has been fitted with MinE, MinB, Max, Flat, LengthB, LengthE, Peak, Theta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>result_Gratiot
</code></pre>


<h3>Format</h3>

<p>A list with Gratiot data and the result of the fit.
</p>


<h3>Details</h3>

<p>Result of the fit of Leatherback nest counts from Gratiot et al. (2006) Figure 1
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@u-psud.fr">marc.girondot@u-psud.fr</a>
</p>


<h3>References</h3>

<p>Gratiot, N., Gratiot, J., de Thoisy, B. &amp; Kelle, L. 2006.
Estimation of marine turtles nesting season from incomplete
data ; statistical adjustment of a sinusoidal function. Animal
Conservation, 9, 95-102.
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
# Read a file with result
data(result_Gratiot)

## End(Not run)
</code></pre>

<hr>
<h2 id='result_Gratiot_Flat'>Result of the fit of Leatherback nest counts</h2><span id='topic+result_Gratiot_Flat'></span>

<h3>Description</h3>

<p>Result of the fit of Leatherback nest counts from Gratiot et al. (2006) Figure 1.
The phenology has been fitted with MinE, MinB, Max, LengthB, LengthE, Peak, Theta.
The Flat parameter is set to 0 and is not fitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>result_Gratiot_Flat
</code></pre>


<h3>Format</h3>

<p>A list with Gratiot data and the result of the fit.
</p>


<h3>Details</h3>

<p>Result of the fit of Leatherback nest counts from Gratiot et al. (2006) Figure 1
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@u-psud.fr">marc.girondot@u-psud.fr</a>
</p>


<h3>References</h3>

<p>Gratiot, N., Gratiot, J., de Thoisy, B. &amp; Kelle, L. 2006.
Estimation of marine turtles nesting season from incomplete
data ; statistical adjustment of a sinusoidal function. Animal
Conservation, 9, 95-102.
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Read a file with result
data(result_Gratiot_Flat)
</code></pre>

<hr>
<h2 id='result_Gratiot_mcmc'>Result of the mcmc for Leatherback nest counts</h2><span id='topic+result_Gratiot_mcmc'></span>

<h3>Description</h3>

<p>Result of the mcmc for Leatherback nest counts from Gratiot et al. (2006) Figure 1
The phenology has been fitted with MinE, MinB, Max, Flat, LengthB, LengthE, Peak, Theta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>result_Gratiot_mcmc
</code></pre>


<h3>Format</h3>

<p>A mcmcComposite object with mcmc result.
</p>


<h3>Details</h3>

<p>Result of the mcmc for Leatherback nest counts from Gratiot et al. (2006) Figure 1
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@u-psud.fr">marc.girondot@u-psud.fr</a>
</p>


<h3>References</h3>

<p>Gratiot, N., Gratiot, J., de Thoisy, B. &amp; Kelle, L. 2006.
Estimation of marine turtles nesting season from incomplete
data ; statistical adjustment of a sinusoidal function. Animal
Conservation, 9, 95-102.
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
data(result_Gratiot)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
# generate data for mcmc run
pmcmc &lt;- phenology_MHmcmc_p(result_Gratiot, accept = TRUE)
result_Gratiot_mcmc &lt;- phenology_MHmcmc(result = result_Gratiot, 
     n.iter = 10000, 
     adaptive=TRUE,
     parametersMCMC = pmcmc, 
     n.chains = 1, n.adapt = 0, thin = 1, trace = FALSE)
# Read a file with result
data(result_Gratiot_mcmc)
1-rejectionRate(as.mcmc(result_Gratiot_mcmc))

summary(result_Gratiot, resultmcmc=result_Gratiot_mcmc)

## End(Not run)
</code></pre>

<hr>
<h2 id='result_Gratiot1'>Result of the fit of Leatherback nest counts</h2><span id='topic+result_Gratiot1'></span>

<h3>Description</h3>

<p>Result of the fit of Leatherback nest counts from Gratiot et al. (2006) Figure 1
The phenology has been fitted with MinE, MinB, Max, Flat, LengthB, LengthE, Peak, Theta,
Alpha, Beta, Tau, Phi, Delta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>result_Gratiot1
</code></pre>


<h3>Format</h3>

<p>A list with Gratiot data and the result of the fit.
</p>


<h3>Details</h3>

<p>Result of the fit of Leatherback nest counts from Gratiot et al. (2006) Figure 1
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@u-psud.fr">marc.girondot@u-psud.fr</a>
</p>


<h3>References</h3>

<p>Gratiot, N., Gratiot, J., de Thoisy, B. &amp; Kelle, L. 2006.
Estimation of marine turtles nesting season from incomplete
data ; statistical adjustment of a sinusoidal function. Animal
Conservation, 9, 95-102.
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Read a file with result
data(result_Gratiot1)
</code></pre>

<hr>
<h2 id='result_Gratiot2'>Result of the fit of Leatherback nest counts</h2><span id='topic+result_Gratiot2'></span>

<h3>Description</h3>

<p>Result of the fit of Leatherback nest counts from Gratiot et al. (2006) Figure 1
The phenology has been fitted with MinE, MinB, Max, Flat, LengthB, LengthE, Peak, Theta,
Alpha, Beta, Tau, Phi, Delta, Alpha1, Beta1, Tau1, Phi1, Delta1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>result_Gratiot2
</code></pre>


<h3>Format</h3>

<p>A list with Gratiot data and the result of the fit.
</p>


<h3>Details</h3>

<p>Result of the fit of Leatherback nest counts from Gratiot et al. (2006) Figure 1
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@u-psud.fr">marc.girondot@u-psud.fr</a>
</p>


<h3>References</h3>

<p>Gratiot, N., Gratiot, J., de Thoisy, B. &amp; Kelle, L. 2006.
Estimation of marine turtles nesting season from incomplete
data ; statistical adjustment of a sinusoidal function. Animal
Conservation, 9, 95-102.
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
# Read a file with result
data(result_Gratiot2)
</code></pre>

<hr>
<h2 id='RI'>Return an expected remigration interval.</h2><span id='topic+RI'></span>

<h3>Description</h3>

<p>Model of remigration interval<br />
Note that r, s and t are conditional probabilities. If c is null, then return probabilities are
estimated from r. r can be named vector. For example:<br />
r &lt;- c(r1=0.5, r2=0.60, r3=1) is equivalent to c &lt;- c(c1=0.5, c2=0.3, c3=0.2)<br />
The vector of r described the probability that a female returned after
1, 2, 3 years among those who have not nested before.
The vector of r is the same but defining the return probability for an initial female.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RI(s, t, r = NULL, c = NULL, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RI_+3A_s">s</code></td>
<td>
<p>Time-conditional probability of survival</p>
</td></tr>
<tr><td><code id="RI_+3A_t">t</code></td>
<td>
<p>Time-conditional probability of tag retention</p>
</td></tr>
<tr><td><code id="RI_+3A_r">r</code></td>
<td>
<p>Time-conditional probability of return</p>
</td></tr>
<tr><td><code id="RI_+3A_c">c</code></td>
<td>
<p>Probability of return</p>
</td></tr>
<tr><td><code id="RI_+3A_p">p</code></td>
<td>
<p>Annual probability of observation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RI returns an expected remigration interval
</p>


<h3>Value</h3>

<p>Return a remigration interval.<br />
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Remigration Interval: 
<code><a href="#topic+Bayesian.remigration">Bayesian.remigration</a>()</code>,
<code><a href="#topic+LnRI_norm">LnRI_norm</a>()</code>,
<code><a href="#topic+plot.Remigration">plot.Remigration</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
s &lt;- c(s1=1, s2=1, s3=1, s4=1, s5=1)
t &lt;- c(t1=0.95, t2=1, t3=1, t4=1, t5=1) 
r &lt;- c(r1=0.1, r2=0.8, r3=0.7, r4=0.7, r5=1)
p &lt;- c(p1=0.6, p2=0.6, p3=0.6, p4=0.6, p5=0.6)

# r is equivalent to 
c &lt;- c(c1=0.1, c2=0.72, c3=0.126, c4=0.0378, c5=0.0162)
# Then the true remigration interval is:
ri_true &lt;- sum(1:5*c[1:5])

s_ri  &lt;- NULL
for (sx in seq(from=0.01, to=1, by=0.01)) {
  s[] &lt;- sx
  ri1 &lt;- RI(s=s, t=t, r=r, p=p)
  s_ri  &lt;- c(s_ri,sum(1:5*ri1)/sum(ri1))
}

par(mar=c(4, 4, 1, 1)+0.4)

plot(x=seq(from=0.01, to=1, by=0.01), y=s_ri, type="l", 
     las=1, bty="n", ylim=c(0, 4), 
     xlab="Annuual survival probabilities", ylab="Naive Remigration Interval", 
    main="")
segments(x0=0.01, x1=1, y0=ri_true, y1=ri_true, lty=2, col="red")
legend("topright", legend="True remigration interval", lty=2, col="red")


## End(Not run)
</code></pre>

<hr>
<h2 id='shift_sinusoid'>Shift sinusoid information.</h2><span id='topic+shift_sinusoid'></span>

<h3>Description</h3>

<p>This function is used to shift sinusoid parameters from &rdquo;, '1' or '2'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shift_sinusoid(parameters = NULL, from = "", to = "1")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shift_sinusoid_+3A_parameters">parameters</code></td>
<td>
<p>set of parameters</p>
</td></tr>
<tr><td><code id="shift_sinusoid_+3A_from">from</code></td>
<td>
<p>The number of series to change</p>
</td></tr>
<tr><td><code id="shift_sinusoid_+3A_to">to</code></td>
<td>
<p>The number of series to change</p>
</td></tr>
</table>


<h3>Details</h3>

<p>shift_sinusoid shift sinusoid information.
</p>


<h3>Value</h3>

<p>Return a set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read a file with data
library("phenology")
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Fix parameter FLat to 0
pfixed=c(Flat=0)
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=pfixed)
# Fit is done
## Not run: 
result_Gratiot_Flat&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=pfixed)

## End(Not run)
data(result_Gratiot_Flat)
parg&lt;-extract_result(result_Gratiot_Flat)
# Add data for one sinusoid superimposed 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
parg&lt;-c(parg, Alpha=0.5, Beta=0.8, Delta=3, Phi=15)
# Tau is fixed to 1
pfixed=c(Flat=0, Tau=1)
# Run the optimisation
## Not run: 
result_Gratiot1&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=pfixed)
# Plot the phenology
output1&lt;-plot(result_Gratiot1, moon=TRUE)
#' 
## End(Not run)
data(result_Gratiot1)
# Extract the fitted parameters
parg1&lt;-extract_result(result_Gratiot1)
# Shift sunusoid information to the '1'
parg2&lt;-shift_sinusoid(parameters=parg1, from="", to="1")
# Tau is fixed to 1
pfixed=c(Flat=0, Tau1=1, Tau=1)
# Add data for another sinusoid superimposed 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
parg&lt;-c(parg2, Alpha=0.5, Beta=0.8, Delta=3, Phi=10)
# Run the optimisation
## Not run: 
result_Gratiot2&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=pfixed)
# Plot the phenology
output2&lt;-plot(result_Gratiot2, moon=TRUE)

## End(Not run)
data(result_Gratiot2)
</code></pre>

<hr>
<h2 id='summary.IP'>Print the result information from a IP object.</h2><span id='topic+summary.IP'></span>

<h3>Description</h3>

<p>The function summary.IP shows result and estimates confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'IP'
summary(object, ..., N = NULL, probs = c(0.025, 0.975))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.IP_+3A_object">object</code></td>
<td>
<p>A file of class IP</p>
</td></tr>
<tr><td><code id="summary.IP_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
<tr><td><code id="summary.IP_+3A_n">N</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="summary.IP_+3A_probs">probs</code></td>
<td>
<p>Probability of confidence interval</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.IP prints the information from a IP object.
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Internesting Period: 
<code><a href="#topic+IPFit">IPFit</a>()</code>,
<code><a href="#topic+IPModel">IPModel</a>()</code>,
<code><a href="#topic+IPPredict">IPPredict</a>()</code>,
<code><a href="#topic+plot.IP">plot.IP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.phenology'>Print the result information from a result object.</h2><span id='topic+summary.phenology'></span>

<h3>Description</h3>

<p>The function summary.phenology shows result and estimates confidence interval.<br />
If several years are analyzed, the sum_synthesis result can be obtained only if there is
not a mix of bisextile and non-bisextile years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenology'
summary(
  object,
  resultmcmc = NULL,
  season = NULL,
  chain = 1,
  series = "all",
  replicate.CI.mcmc = "all",
  replicate.CI = 10000,
  level = 0.95,
  print = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.phenology_+3A_object">object</code></td>
<td>
<p>A result file generated by fit_phenology</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A mcmc object</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_season">season</code></td>
<td>
<p>The number of season to analyze</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_chain">chain</code></td>
<td>
<p>The number of chain to be used in resultmcmc</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_series">series</code></td>
<td>
<p>Names of the series to be analyzed or &quot;all&quot;</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_replicate.ci.mcmc">replicate.CI.mcmc</code></td>
<td>
<p>Number of iterations to be used or &quot;all&quot;</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates for ML resampling</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_level">level</code></td>
<td>
<p>Level to estimate confidence interval or credibility interval</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_print">print</code></td>
<td>
<p>Should information be shown</p>
</td></tr>
<tr><td><code id="summary.phenology_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.phenology prints the information from a result object.
</p>


<h3>Value</h3>

<p>A list with five objects: synthesis is a data.frame with global estimate of nesting.<br />
details_MCMC, details_ML, details_mean are lists with day by day information for each series, and
sum_synthesis is the synthesis of the sum of all analyzed time-series.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Display information from the result
s &lt;- summary(result_Gratiot)
# Using mcmc
s &lt;- summary(object=result_Gratiot, resultmcmc=result_Gratiot_mcmc)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.phenologymap'>Print information on a phenologymap object.</h2><span id='topic+summary.phenologymap'></span>

<h3>Description</h3>

<p>summary.phenologymap print information on a phenologymap object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenologymap'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.phenologymap_+3A_object">object</code></td>
<td>
<p>A map generated with map_phenology.</p>
</td></tr>
<tr><td><code id="summary.phenologymap_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologyout">summary.phenologyout</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("phenology")
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
## Not run: 
result_Gratiot&lt;-fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)

## End(Not run)
data(result_Gratiot)
# Extract the fitted parameters
parg1&lt;-extract_result(result_Gratiot)
# Add constant Alpha and Tau values 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
pfixed&lt;-c(parg1, Alpha=0, Tau=1)
pfixed&lt;-pfixed[-which(names(pfixed)=="Theta")]
# The only fitted parameter will be Beta
parg2&lt;-c(Beta=0.5, parg1["Theta"])
# Generate a likelihood map 
# [default Phi=seq(from=0.1, to=20, length.out=100) but it is very long]
# Take care, it takes 20 hours ! The data map_Gratiot has the result
## Not run: 
map_Gratiot&lt;-map_phenology(data=data_Gratiot, 
		Phi=seq(from=0.1, to=20, length.out=100), 
		fitted.parameters=parg2, fixed.parameters=pfixed)

## End(Not run)
data(map_Gratiot)
# Print the information on a map
summary(map_Gratiot)
</code></pre>

<hr>
<h2 id='summary.phenologyout'>Print the summary information from a ouput object.</h2><span id='topic+summary.phenologyout'></span>

<h3>Description</h3>

<p>The function summary.phenologyout displays the output from a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phenologyout'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.phenologyout_+3A_object">object</code></td>
<td>
<p>An output generated by plot.phenology() ou summary.phenology()</p>
</td></tr>
<tr><td><code id="summary.phenologyout_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.phenologyout prints the information from a result object.
</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code><a href="#topic+AutoFitPhenology">AutoFitPhenology</a>()</code>,
<code><a href="#topic+BE_to_LBLE">BE_to_LBLE</a>()</code>,
<code><a href="#topic+Gratiot">Gratiot</a></code>,
<code><a href="#topic+LBLE_to_BE">LBLE_to_BE</a>()</code>,
<code><a href="#topic+LBLE_to_L">LBLE_to_L</a>()</code>,
<code><a href="#topic+L_to_LBLE">L_to_LBLE</a>()</code>,
<code><a href="#topic+MarineTurtles_2002">MarineTurtles_2002</a></code>,
<code><a href="#topic+MinBMinE_to_Min">MinBMinE_to_Min</a>()</code>,
<code><a href="#topic+adapt_parameters">adapt_parameters</a>()</code>,
<code><a href="#topic+add_SE">add_SE</a>()</code>,
<code><a href="#topic+add_phenology">add_phenology</a>()</code>,
<code><a href="#topic+extract_result">extract_result</a>()</code>,
<code><a href="#topic+fit_phenology">fit_phenology</a>()</code>,
<code><a href="#topic+likelihood_phenology">likelihood_phenology</a>()</code>,
<code><a href="#topic+logLik.phenology">logLik.phenology</a>()</code>,
<code><a href="#topic+map_Gratiot">map_Gratiot</a></code>,
<code><a href="#topic+map_phenology">map_phenology</a>()</code>,
<code><a href="#topic+par_init">par_init</a>()</code>,
<code><a href="#topic+phenology">phenology</a>()</code>,
<code><a href="#topic+phenology2fitRMU">phenology2fitRMU</a>()</code>,
<code><a href="#topic+phenology_MHmcmc">phenology_MHmcmc</a>()</code>,
<code><a href="#topic+phenology_MHmcmc_p">phenology_MHmcmc_p</a>()</code>,
<code><a href="#topic+plot.phenology">plot.phenology</a>()</code>,
<code><a href="#topic+plot.phenologymap">plot.phenologymap</a>()</code>,
<code><a href="#topic+plot_delta">plot_delta</a>()</code>,
<code><a href="#topic+plot_phi">plot_phi</a>()</code>,
<code><a href="#topic+print.phenology">print.phenology</a>()</code>,
<code><a href="#topic+print.phenologymap">print.phenologymap</a>()</code>,
<code><a href="#topic+print.phenologyout">print.phenologyout</a>()</code>,
<code><a href="#topic+remove_site">remove_site</a>()</code>,
<code><a href="#topic+result_Gratiot">result_Gratiot</a></code>,
<code><a href="#topic+result_Gratiot1">result_Gratiot1</a></code>,
<code><a href="#topic+result_Gratiot2">result_Gratiot2</a></code>,
<code><a href="#topic+result_Gratiot_Flat">result_Gratiot_Flat</a></code>,
<code><a href="#topic+result_Gratiot_mcmc">result_Gratiot_mcmc</a></code>,
<code><a href="#topic+summary.phenology">summary.phenology</a>()</code>,
<code><a href="#topic+summary.phenologymap">summary.phenologymap</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Plot the phenology and get some stats
output &lt;- plot(result_Gratiot)
# Show the output
summary(output)

## End(Not run)
</code></pre>

<hr>
<h2 id='TableECFOCF'>Format a CMR dataset into a file that fitCF can use.</h2><span id='topic+TableECFOCF'></span>

<h3>Description</h3>

<p>This function formats a CMR dataset to a file that fitCF can use.<br />
If date0 is not null, a 3D TableECFOCF is generated.<br />
3D table (ECF, OCF, period) has two attributes:<br />
</p>

<ul>
<li><p> table with 5 elements:<br />
begin, end are the first and last elements with counts<br />
final is the last period with information<br />
min and max are the first and last period where a nest could have been laid based on MaxNests value<br />
</p>
</li>
<li><p> characteristics with 5 elements:<br />
MinimumDaysBetween2Nest, MeanDaysBetween2Nest MaxNests, date0, length_season<br />
p parameter can be setup to +Inf until begin and after end
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>TableECFOCF(
  data = stop("A dataframe with a column 'ID' and a column 'Date'"),
  columnID = "ID",
  columnDate = "Date",
  MinimumDaysBetween2Nest = 7,
  MeanDaysBetween2Nest = 9.8,
  MaxNests = 15,
  date0 = NULL,
  length_season = floor(365/MeanDaysBetween2Nest) + 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TableECFOCF_+3A_data">data</code></td>
<td>
<p>CMR file.</p>
</td></tr>
<tr><td><code id="TableECFOCF_+3A_columnid">columnID</code></td>
<td>
<p>Name of the column in data for unique identifier of females.</p>
</td></tr>
<tr><td><code id="TableECFOCF_+3A_columndate">columnDate</code></td>
<td>
<p>Name of the column in data for morning date when female has been seen on the beach.</p>
</td></tr>
<tr><td><code id="TableECFOCF_+3A_minimumdaysbetween2nest">MinimumDaysBetween2Nest</code></td>
<td>
<p>Number of minimum days between two nests.</p>
</td></tr>
<tr><td><code id="TableECFOCF_+3A_meandaysbetween2nest">MeanDaysBetween2Nest</code></td>
<td>
<p>Average number of days between two nests.</p>
</td></tr>
<tr><td><code id="TableECFOCF_+3A_maxnests">MaxNests</code></td>
<td>
<p>Maximum number of nests by a female.</p>
</td></tr>
<tr><td><code id="TableECFOCF_+3A_date0">date0</code></td>
<td>
<p>Date for the ordinal day 0.</p>
</td></tr>
<tr><td><code id="TableECFOCF_+3A_length_season">length_season</code></td>
<td>
<p>The total length of season based on groups of interclutch intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TableECFOCF formats a CMR dataset into a file that fitCF can use.
</p>


<h3>Value</h3>

<p>Return a matrix with counts for all OCF and ECF combinations.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code><a href="#topic+ECFOCF_f">ECFOCF_f</a>()</code>,
<code><a href="#topic+ECFOCF_full">ECFOCF_full</a>()</code>,
<code><a href="#topic+fitCF">fitCF</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc">fitCF_MHmcmc</a>()</code>,
<code><a href="#topic+fitCF_MHmcmc_p">fitCF_MHmcmc_p</a>()</code>,
<code><a href="#topic+generateCF">generateCF</a>()</code>,
<code><a href="#topic+lnLCF">lnLCF</a>()</code>,
<code><a href="#topic+logLik.ECFOCF">logLik.ECFOCF</a>()</code>,
<code><a href="#topic+plot.ECFOCF">plot.ECFOCF</a>()</code>,
<code><a href="#topic+plot.TableECFOCF">plot.TableECFOCF</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data(MarineTurtles_2002)
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002)
plot(ECFOCF_2002)
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002, date0=as.Date("2002-01-01"))
plot(ECFOCF_2002, period=11)

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_cumul'>Return the cumulative rate of tag loss.</h2><span id='topic+Tagloss_cumul'></span>

<h3>Description</h3>

<p>This function compute a model of cumulative tag loss rate for days t
based on a set of parameters, par.<br />
If hessian is not null, it will estimate standard error of the output using numerical delta method is replicates
is null or using resampling if replicates is not null.<br />
Parameters are described in <code><a href="#topic+Tagloss_fit">Tagloss_fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_cumul(
  t,
  par = NULL,
  Hessian = NULL,
  mcmc = NULL,
  method = NULL,
  model_before = NULL,
  model_after = NULL,
  model = NULL,
  replicates = NULL,
  x = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_cumul_+3A_t">t</code></td>
<td>
<p>Time for which values of model must be estimated</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_par">par</code></td>
<td>
<p>Parameters</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_hessian">Hessian</code></td>
<td>
<p>Hessian matrix of parameters</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_mcmc">mcmc</code></td>
<td>
<p>A mcmc result</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_method">method</code></td>
<td>
<p>Can be NULL, &quot;delta&quot;, &quot;SE&quot;, &quot;Hessian&quot;, &quot;MCMC&quot;, or &quot;PseudoHessianFromMCMC&quot;</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_model_before">model_before</code></td>
<td>
<p>Function to be used before estimation of daily tagloss rate</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_model_after">model_after</code></td>
<td>
<p>Function to be used after estimation of daily tagloss rate</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_model">model</code></td>
<td>
<p>The model of parameter to use, can be N2, N1 or N0; or NLR, NL0, N0R, or N00 or NULL if hessian is NULL.</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates to estimate se of output for resampling method</p>
</td></tr>
<tr><td><code id="Tagloss_cumul_+3A_x">x</code></td>
<td>
<p>A Tagloss fitted model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_cumul returns the cumulative rate of tag loss.
</p>


<h3>Value</h3>

<p>Return the cumulative rate of tag loss if hessian is null or a data.frame with distribution of cumulative rate of tag loss if hessian is not null.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example
library(phenology)

# Data from Rivalan et al. 2005 - Table 2, line 1 - Fig 1D
par &lt;- c(a0_2=-5.43E-2, a1_2=-103.52, a2_2=0, a3_2=0, a4_2=5.62E-4)
(y &lt;- Tagloss_cumul(t=(1:6)*365, par=par))
plot(y[, "time"], y[, "N2"], type="l", bty="n", 
     xlab="Days after tagging", ylab="N2 proportion")

# Data from Rivalan et al. 2005 - Table 2, line 2 - Fig 1E
par &lt;- c(a0_2=-6.80E-2, a1_2=-81.15, a2_2=-2.20E-4, a3_2=6348.01, a4_2=1.65E-3)
(y &lt;- Tagloss_cumul(t=(1:6)*365, par=par))
plot(y[, "time"], y[, "N2"], type="l", 
     xlab="Days after tagging", ylab="N2 proportion")

# Data from Rivalan et al. 2005 - Table 2, line 3 - Fig 1F
par &lt;- c(a0_2=-6.93E-2, a1_2=-78.92, a2_2=8.45E-4, a3_2=-16272.76, a4_2=2.87E-4)
(y &lt;- Tagloss_cumul(t=(1:6)*365, par=par))
plot(y[, "time"], y[, "N2"], type="l", 
     xlab="Days after tagging", ylab="N2 proportion")

# Data from Rivalan et al. 2005 - Table 2, line 4 - Fig 1C
par &lt;- c(a0_2=-1.68E-3, a1_2=-4141.68, a2_2=0, a3_2=0, a4_2=0)
(y &lt;- Tagloss_cumul(t=(1:6)*365, par=par))
plot(y[, "time"], y[, "N2"], type="l", 
     xlab="Days after tagging", ylab="N2 proportion")

# Data from Rivalan et al. 2005 - Table 2, line 5 - Fig 1B
par &lt;- c(a0_2=-3.77E-4, a1_2=-2000, a2_2=-0.001, a3_2=0, a4_2=5.00E-8)
(y &lt;- Tagloss_cumul(t=(1:6)*365, par=par))
plot(y[, "time"], y[, "N2"], type="l", 
     xlab="Days after tagging", ylab="N2 proportion")

# Data from Rivalan et al. 2005 - Table 2, line 6 - Fig 1A
par &lt;- c(a0_2=-1E5, a1_2=-2000, a2_2=0, a3_2=4000, a4_2=8.34E-4)
(y &lt;- Tagloss_cumul(t=(1:6)*365, par=par))
plot(y[, "time"], y[, "N2"], type="l", 
     xlab="Days after tagging", ylab="N2 proportion")
     
# Data from Rivalan et al. 2005 - Table 2, line 1 - Fig 1D
# With tagloss rate dependency on tage number
par &lt;- c(a0_2=-5.43E-2, a1_2=-103.52, a2_2=0, a3_2=0, a4_2=5.62E-4, 
         a0_1=-5.43E-2, a1_1=-103.52, a2_1=0, a3_1=0, a4_1=5.62E-4, delta_1=3.2E-4)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE)

p2 &lt;- Tagloss_model(t=1:(6*365), par=par, model="2")
p1 &lt;- Tagloss_model(t=1:(6*365), par=par, model="1")
par(mar=c(4, 5, 2, 1))
plot(x=1:(6*365), y=p2, bty="n", type="l", las=1, ylim=c(0,0.003), ylab="")
mtext("Daily tag loss", side=2, line=4)
lines(x=1:(6*365), y=p1, col="red")
legend("topright", legend=c("2&gt;1", "1&gt;0"), lty=1, col=c("black", "red"))

Tagloss_cumul(t=(1:6)*365, par=par)

# Without tagloss rate dependency on tag number
par &lt;- c(a0_2=-5.43E-2, a1_2=-103.52, a2_2=0, a3_2=0, a4_2=5.62E-4, 
         a0_1=-5.43E-2, a1_1=-103.52, a2_1=0, a3_1=0, a4_1=5.62E-4)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE)
Tagloss_cumul(t=(1:6)*365, par=par)

#### Data from Casale et al. 2017
# Table 1 - Model II
par &lt;- c(CasaleModelIIa0_2=-0.0511, CasaleModelIIa1_2=-100, CasaleModelIIa4_2=0.00014)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE)
Tagloss_cumul(t=(1:6)*365, par=par)

# Table 1 - Model IV
par &lt;- c(CasaleModelIVa0_2=-0.0132, CasaleModelIVa1_2=-100, 
         CasaleModelIVa2_2=0.0327, CasaleModelIVa3_2=109.98, 
         CasaleModelIVa4_2=0.00011)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE)
Tagloss_cumul(t=(1:6)*365, par=par)

# Table 1 - Model I
par &lt;- c(CasaleModelIc_2=0.00027)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE)
Tagloss_cumul(t=(1:6)*365, par=par)

# Table 1 - Model III
par &lt;- c(CasaleModelIIIa0_2=1.14E-10, CasaleModelIIIa1_2=-110.04, 
         CasaleModelIIIa4_2=0.00055)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE)
Tagloss_cumul(t=(1:6)*365, par=par)

# Table 1 - Model V
par &lt;- c(CasaleModelVa0_2=4.04E-10, CasaleModelVa1_2=-90, 
         CasaleModelVa2_2=-0.0326, CasaleModelVa3_2=100.31, 
         CasaleModelVa4_2=0.00006)
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, 
                         model="Cumul", 
                         decoration = TRUE)
Tagloss_cumul(t=(1:6)*365, par=par)


## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_daymax'>Return the maximum number of days an individual has been observed in a dataset.</h2><span id='topic+Tagloss_daymax'></span>

<h3>Description</h3>

<p>This function must be used to get the value of mx in Tagloss_L.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_daymax(individuals, what = "max")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_daymax_+3A_individuals">individuals</code></td>
<td>
<p>Set of indivuals</p>
</td></tr>
<tr><td><code id="Tagloss_daymax_+3A_what">what</code></td>
<td>
<p>By default is max, but can be min, mean or all</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_daymax returns the maximum number of days an individual has been observed in a dataset.
</p>


<h3>Value</h3>

<p>Return the maximum number of days an individual has been observed in a dataset.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")
daymax(data_f_21)

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_fit'>fit a model of tag loss using a CMR database.</h2><span id='topic+Tagloss_fit'></span>

<h3>Description</h3>

<p>This function fits a model of tag loss using a CMR database.<br />
The names of parameters can be:<br />
Model Pfaller et al. (2019):<br />
</p>

<dl>
<dt>Left tag lost when 2 are present</dt><dd><p><code>D1_L2</code>, <code>D2D1_L2</code>, <code>D3D2_L2</code>, <code>A_L2</code>, <code>B_L2</code>, <code>C_L2</code>, <code>delta_L2</code></p>
</dd>
<dt>Right tag lost when 2 are present</dt><dd><p><code>D1_R2</code>, <code>D2D1_R2</code>, <code>D3D2_R2</code>, <code>A_R2</code>, <code>B_R2</code>, <code>C_R2</code>, <code>delta_R2</code></p>
</dd>
<dt>Left tag lost when 1 is present</dt><dd><p><code>D1_L1</code>, <code>D2D1_L1</code>, <code>D3D2_L1</code>, <code>A_L1</code>, <code>B_L1</code>, <code>C_L1</code>, <code>delta_L1</code></p>
</dd>
<dt>Right tag lost when 1 is present</dt><dd><p><code>D1_R1</code>, <code>D2D1_R1</code>, <code>D3D2_R1</code>, <code>A_R1</code>, <code>B_R1</code>, <code>C_R1</code>, <code>delta_R1</code></p>
</dd>
<dt>One tag lost when 2 are present</dt><dd><p><code>D1_2</code>, <code>D2D1_2</code>, <code>D3D2_2</code>, <code>A_2</code>, <code>B_2</code>, <code>C_2</code>, <code>delta_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt><dd><p><code>D1_1</code>, <code>D2D1_1</code>, <code>D3D2_1</code>, <code>A_1</code>, <code>B_1</code>, <code>C_1</code>, <code>delta_1</code></p>
</dd>
</dl>

<p><code>pA</code>, <code>pB</code> and <code>pC</code> are the daily probabilities of tag loss with
<code>pA=-logit(A)</code>, <code>pB=-logit(B)</code> and <code>pC=-logit(C)</code> .<br />
<code>delta</code> is used as: <code>p = p + delta</code>. Nothe that <code>delta</code> can be negative<br />
Tag loss rate is <code>pA</code> at day 1<br />
Tag loss rate changes gradually from <code>pA</code> to <code>pB</code> that is reached at day <code>D1</code><br />
Tag loss rate is <code>pB</code> from day <code>D1</code> to day <code>D2=D1+D2D1</code><br />
Tag loss rate changes gradually from <code>pB</code> to <code>pC</code> that is reached at day <code>D3=D2+D3D2</code><br />
</p>
<p>When parameters from Rivalan et al. (2005) are used:<br />
</p>

<dl>
<dt>One tag lost when 2 are present</dt><dd><p><code>a0_2</code>, <code>a1_2</code>, <code>a2_2</code>, <code>a3_2</code>, <code>a4_2</code>, <code>delta_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt><dd><p><code>a0_1</code>, <code>a1_1</code>, <code>a2_1</code>, <code>a3_1</code>, <code>a4_1</code>, <code>delta_1</code></p>
</dd>
</dl>

<p>When parameters from Casale et al. (2017) are used:<br />
Model I<br />
</p>

<dl>
<dt>One tag lost when 2 are present</dt><dd><p><code>CasaleModelIc_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt><dd><p><code>CasaleModelIc_1</code></p>
</dd>
</dl>

<p>Model II<br />
</p>

<dl>
<dt>One tag lost when 2 are present</dt><dd><p><code>CasaleModelIIa0_2</code>, <code>CasaleModelIIa1_2</code>, <code>CasaleModelIIa4_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt><dd><p><code>CasaleModelIIa0_1</code>, <code>CasaleModelIIa1_1</code>, <code>CasaleModelIIa4_1</code></p>
</dd>
</dl>

<p>Model III<br />
</p>

<dl>
<dt>One tag lost when 2 are present</dt><dd><p><code>CasaleModelIIIa0_2</code>, <code>CasaleModelIIIa1_2</code>, <code>CasaleModelIIIa4_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt><dd><p><code>CasaleModelIIIa0_1</code>, <code>CasaleModelIIIa1_1</code>, <code>CasaleModelIIIa4_1</code></p>
</dd>
</dl>

<p>Model IV<br />
</p>

<dl>
<dt>One tag lost when 2 are present</dt><dd><p><code>CasaleModelIVa0_2</code>, <code>CasaleModelIVa1_2</code>, <code>CasaleModelIVa2_2</code>, <code>CasaleModelIVa3_2</code>, <code>CasaleModelIVa4_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt><dd><p><code>CasaleModelIVa0_1</code>, <code>CasaleModelIVa1_1</code>, <code>CasaleModelIVa2_1</code>, <code>CasaleModelIVa3_1</code>, <code>CasaleModelIVa4_1</code></p>
</dd>
</dl>

<p>Model V<br />
</p>

<dl>
<dt>One tag lost when 2 are present</dt><dd><p><code>CasaleModelVa0_2</code>, <code>CasaleModelVa1_2</code>, <code>CasaleModelVa2_2</code>, <code>CasaleModelVa3_2</code>, <code>CasaleModelVa4_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt><dd><p><code>CasaleModelVa0_1</code>, <code>CasaleModelVa1_1</code>, <code>CasaleModelVa2_1</code>, <code>CasaleModelVa3_1</code>, <code>CasaleModelVa4_1</code></p>
</dd>
</dl>

<p>If only one parameter is fitted, method must be &quot;Brent&quot; and <code>upper</code> and <code>lower</code>
parameters must be set up with finite values.
</p>
<p>model_before can be &quot;&quot;par['a0_1']=par['a0_2'];par['a1_1']=par['a1_2']&quot;.
model_after can be &quot;p1=p2&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_fit(
  data = stop("A database formated using Tagloss_format() must be used"),
  fitted.parameters = NULL,
  fixed.parameters = NULL,
  model_before = NULL,
  model_after = NULL,
  control = list(trace = 1, maxit = 10000),
  method = "Nelder-Mead",
  lower = -Inf,
  upper = Inf,
  hessian = FALSE,
  mc.cores = detectCores(all.tests = FALSE, logical = TRUE),
  groups = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_fit_+3A_data">data</code></td>
<td>
<p>An object formated using Tagloss_format</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_fitted.parameters">fitted.parameters</code></td>
<td>
<p>Set of parameters to be fitted</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_model_before">model_before</code></td>
<td>
<p>Transformation of parameters before to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_model_after">model_after</code></td>
<td>
<p>Transformation of parameters after to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_control">control</code></td>
<td>
<p>Control parameters to be send to optim()</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_method">method</code></td>
<td>
<p>optim() method</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_lower">lower</code></td>
<td>
<p>Lower value for parameter when Brent method is used</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_upper">upper</code></td>
<td>
<p>Upper value for parameter when Brent method is used</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_hessian">hessian</code></td>
<td>
<p>Does the hessian matrix should be estimated</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cores to use for parallel computing</p>
</td></tr>
<tr><td><code id="Tagloss_fit_+3A_groups">groups</code></td>
<td>
<p>Number of groups for parallel computing</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_fit fits a model of tag loss using a CMR database.
</p>


<h3>Value</h3>

<p>Return a list object with the model describing tag loss.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>References</h3>

<p>Rivalan, P., Godfrey, M.H., Prévot-Julliard, A.-C., Girondot, M., 2005. Maximum likelihood estimates of tag loss in leatherback sea turtles. Journal of Wildlife Management 69, 540-548.
</p>
<p>Casale, P., Freggi, D., Salvemini, P., 2017. Tag loss is a minor limiting factor in sea turtle tagging programs relying on distant tag returns: the case of Mediterranean loggerhead sea turtles. European Journal of Wildlife Research 63.
</p>
<p>Pfaller JB, Williams KL, Frick MG, Shamblin BM, Nairn CJ, Girondot M (2019) Genetic determination of tag loss dynamics in nesting loggerhead turtles: A new chapter in “the tag loss problem”. Marine Biology 166: 97 doi 10.1007/s00227-019-3545-x
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")

# model fitted by Rivalan et al. 2005
par &lt;- c(a0_2=-5.43E-2, a1_2=-103.52, a4_2=5.62E-4, 
         delta_1=3.2E-4)
pfixed &lt;- c(a2_2=0, a3_2=0, a2_1=0, a3_1=0)
model_before &lt;- "par['a0_1']=par['a0_2'];par['a1_1']=par['a1_2'];par['a4_1']=par['a4_2']"
o &lt;- Tagloss_fit(data=data_f_21, fitted.parameters=par, fixed.parameters=pfixed, 
                 model_before=model_before)
plot(o, t=1:1000, model="cumul")
plot(o, t=1:1000, model="1")
plot(o, t=1:1000, model="2", add=TRUE, col="red")

# Same data fitted with new model
par &lt;- c(D1_1 = 100.15324837975547, A_1 = 5.9576927964120188, 
         B_1 = 8.769924225871069, B_2 = 8.2353860179664125)
pfixed &lt;- c(D2D1_1 = 2568, D3D2_1 = 2568, D2D1_2 = 2568, D3D2_2 = 2568)
o_4p_p1p2 &lt;- Tagloss_fit(data=data_f_21, fitted.parameters = par, 
                         fixed.parameters = pfixed, 
                         model_before = "par['C_1']=par['B_1'];
                         par['A_2']=par['A_1'];
                         par['C_2']=par['B_2'];
                         par['D1_2']=par['D1_1']", hessian=TRUE)
                         
# Without the N20 the computing is much faster
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
par &lt;- c('D1_2' = 49.78891736351531, 
         'D2D1_2' = 1059.3635769732305, 
         'D3D2_2' = 12.434313273804602, 
         'A_2' = 5.2238379144659683, 
         'B_2' = 8.0050044071275543, 
         'C_2' = 8.4317863609499675, 
         'D1_1' = 701.80273287212935, 
         'D2D1_1' = 0.010951749100596819, 
         'D3D2_1' = 3773.6290607434876, 
         'A_1' = 205.42435592344776, 
         'B_1' = 9.9598342503239863, 
         'C_1' = 6.7234868237164722)
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par, hessian = TRUE)
plot(o, model="1", col="red")
plot(o, model="2", col="blue", add=TRUE)
legend("topright", legend=c("2-&gt;1", "1-&gt;0"), lty=1, col=c("blue", "red"))

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_format'>Format a CMR dataset into a file that Tagloss_L can use.</h2><span id='topic+Tagloss_format'></span>

<h3>Description</h3>

<p>This function formats a CMR dataset to a file that Tagloss_L can use.<br />
The format of data is a data.frame with 4 columns:<br />
ID is the column with the permanent identification code<br />
L is the column with the non-permanent code located at left<br />
R is the column with the non-permanent code located at right<br />
Date is the column with the date of observation<br />
Note that R and L columns can be exchanged if 21 model is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_format(
  data,
  model = "21",
  progressbar = TRUE,
  column.Date = "Date",
  column.ID = "ID",
  column.left = "L",
  column.right = "R",
  keeponly2 = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_format_+3A_data">data</code></td>
<td>
<p>CMR file</p>
</td></tr>
<tr><td><code id="Tagloss_format_+3A_model">model</code></td>
<td>
<p>Can be &quot;21&quot; or &quot;LR&quot;</p>
</td></tr>
<tr><td><code id="Tagloss_format_+3A_progressbar">progressbar</code></td>
<td>
<p>Is a progressbar been shown?</p>
</td></tr>
<tr><td><code id="Tagloss_format_+3A_column.date">column.Date</code></td>
<td>
<p>Name of the column with Date</p>
</td></tr>
<tr><td><code id="Tagloss_format_+3A_column.id">column.ID</code></td>
<td>
<p>Name of the column with ID</p>
</td></tr>
<tr><td><code id="Tagloss_format_+3A_column.left">column.left</code></td>
<td>
<p>Name of the column with left tag</p>
</td></tr>
<tr><td><code id="Tagloss_format_+3A_column.right">column.right</code></td>
<td>
<p>Name of the column with right tag</p>
</td></tr>
<tr><td><code id="Tagloss_format_+3A_keeponly2">keeponly2</code></td>
<td>
<p>If TRUE, keep only individuals tagged with 2 tags</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_format formats a CMR dataset into a file that Tagloss_L can use.
</p>


<h3>Value</h3>

<p>Return the maximum number of days an individual has been observed in a dataset.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
head(outLR)
data_f_21 &lt;- Tagloss_format(outLR, model="21")
data_f_LR &lt;- Tagloss_format(outLR, model="LR")

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_L'>Return the -log likelihood of a set of individuals under a model of tagloss.</h2><span id='topic+Tagloss_L'></span>

<h3>Description</h3>

<p>This function must be used within optim().<br />
model_before is applied to the par parameter.<br />
model_after is applied after par is separated in p1, p2, pL1, pL2, pR1 and pR2 parameters.<br />
progressbar is set to FALSE if mc.cores is different from 1.<br />
If days.maximum is not indicated, it is estimated using Tagloss_daymax().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_L(
  individuals,
  par,
  days.maximum = NULL,
  fixed.parameters = NULL,
  model_before = NULL,
  model_after = NULL,
  names.par = NULL,
  groups = NULL,
  mc.cores = detectCores(all.tests = FALSE, logical = TRUE),
  progressbar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_L_+3A_individuals">individuals</code></td>
<td>
<p>Set of individuals</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_par">par</code></td>
<td>
<p>Set of parameters</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_days.maximum">days.maximum</code></td>
<td>
<p>Maximum number of days. Can be determined using Tagloss_daymax()</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_model_before">model_before</code></td>
<td>
<p>Transformation of parameters before to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_model_after">model_after</code></td>
<td>
<p>Transformation of parameters after to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_names.par">names.par</code></td>
<td>
<p>Name of parameters. Normally unused.</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_groups">groups</code></td>
<td>
<p>Number of groups for parallel computing</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cores to use for parallel computing</p>
</td></tr>
<tr><td><code id="Tagloss_L_+3A_progressbar">progressbar</code></td>
<td>
<p>Is shown a progressbar?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_L returns the -log likelihood of a set of individuals under a model of tagloss.
</p>


<h3>Value</h3>

<p>Return the -log likelihood of a set of individuals
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)

# Example with 21 format of data

data_f_21 &lt;- Tagloss_format(outLR, model="21")
par &lt;- structure(c(49.5658922243074, 808.136085362158, 106.283783786853, 
5.22150592456511, 8.00608716525864, 8.32718202233396, 150.612916258503, 
715.865805125223, 2242.06574225966, 119.212383120678, 10.1860735529433, 
7.14231725937626), .Names = c("D1_2", "D2D1_2", "D3D2_2", "A_2", 
"B_2", "C_2", "D1_1", "D2D1_1", "D3D2_1", "A_1", "B_1", "C_1"))
pfixed &lt;- NULL
# All the data are analyzed; the N20 are very long to compute
Tagloss_L(individuals=data_f_21, par=par, days.maximum=Tagloss_daymax(data_f_21), 
          fixed.parameters=pfixed, mc.cores=1, progressbar=TRUE)
# Without the N20 the computing is much faster
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
Tagloss_L(individuals=data_f_21_fast, par=par, days.maximum=Tagloss_daymax(data_f_21_fast), 
          fixed.par=pfixed, mc.cores=1, progressbar=TRUE)
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par)
# Here it is the result of the previous function
o &lt;- structure(list(par = structure(c(49.5658922243074, 808.136085362158, 
106.283783786853, 5.22150592456511, 8.00608716525864, 8.32718202233396, 
150.612916258503, 715.865805125223, 2242.06574225966, 119.212383120678, 
10.1860735529433, 7.14231725937626), .Names = c("D1_2", "D2D1_2", 
"D3D2_2", "A_2", "B_2", "C_2", "D1_1", "D2D1_1", "D3D2_1", "A_1", 
"B_1", "C_1")), value = 5841.93084262461, counts = structure(c(1093L, 
NA), .Names = c("function", "gradient")), convergence = 0L, message = NULL, 
    hessian = structure(c(0.0469808583147824, 0.000133240973809734, 
    6.68478605803102e-05, -2.53581288234273, -1.25931342154217, 
    -0.124650568977813, -2.46700437855907e-05, -1.11413100967184e-05, 
    -3.18323145620525e-06, 0, -0.0182945996130002, -0.00510601694259094, 
    0.000133240973809734, 1.45519152283669e-05, 7.50333128962666e-06, 
    -0.00452587300969753, -0.0191316757991444, -0.0255117811320815, 
    -1.13686837721616e-06, -1.36424205265939e-06, -2.27373675443232e-07, 
    0, 0.000335830918629654, -0.000448608261649497, 6.68478605803102e-05, 
    7.50333128962666e-06, 4.32009983342141e-06, -0.00226373231271282, 
    -0.00954059942159802, -0.0127809016703395, -4.54747350886464e-07, 
    -4.54747350886464e-07, -2.27373675443232e-07, 0, 0.000176896719494835, 
    -0.000224190443987027, -2.53581288234273, -0.00452587300969753, 
    -0.00226373231271282, 223.422489398217, 41.4073996353181, 
    3.77875949197914, 0.000986460690910462, 0.000398813426727429, 
    0.000117665877041873, 0, 0.727547330825473, 0.194675862985605, 
    -1.25931342154217, -0.0191316757991444, -0.00954059942159802, 
    41.4073996353181, 189.534394394286, 28.3386068531399, 0.00216437001654413, 
    0.00241834641201422, 0.000652562448522076, 0, 0.841939595375152, 
    1.0472297162778, -0.124650568977813, -0.0255117811320815, 
    -0.0127809016703395, 3.77875949197914, 28.3386068531399, 
    70.250493081403, -0.00022441781766247, -0.000161662683240138, 
    0.000257614374277182, 0, -0.578908839088399, 1.08917492980254, 
    -2.46700437855907e-05, -1.13686837721616e-06, -4.54747350886464e-07, 
    0.000986460690910462, 0.00216437001654413, -0.00022441781766247, 
    0.000148247636388987, 0.000145519152283669, 3.97903932025656e-05, 
    0, 0.0156976511789253, 0.0678746800986119, -1.11413100967184e-05, 
    -1.36424205265939e-06, -4.54747350886464e-07, 0.000398813426727429, 
    0.00241834641201422, -0.000161662683240138, 0.000145519152283669, 
    0.000145519152283669, 3.9676706364844e-05, 0, 0.0138438736030366, 
    0.0678776359563926, -3.18323145620525e-06, -2.27373675443232e-07, 
    -2.27373675443232e-07, 0.000117665877041873, 0.000652562448522076, 
    0.000257614374277182, 3.97903932025656e-05, 3.9676706364844e-05, 
    1.77351466845721e-05, 0, 0.00317095327773131, 0.0316927071253303, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.0182945996130002, 
    0.000335830918629654, 0.000176896719494835, 0.727547330825473, 
    0.841939595375152, -0.578908839088399, 0.0156976511789253, 
    0.0138438736030366, 0.00317095327773131, 0, 8.85630879565724, 
    4.44044781033881, -0.00510601694259094, -0.000448608261649497, 
    -0.000224190443987027, 0.194675862985605, 1.0472297162778, 
    1.08917492980254, 0.0678746800986119, 0.0678776359563926, 
    0.0316927071253303, 0, 4.44044781033881, 88.8524673428037
    ), .Dim = c(12L, 12L), .Dimnames = list(c("D1_2", "D2D1_2", 
    "D3D2_2", "A_2", "B_2", "C_2", "D1_1", "D2D1_1", "D3D2_1", 
    "A_1", "B_1", "C_1"), c("D1_2", "D2D1_2", "D3D2_2", "A_2", 
    "B_2", "C_2", "D1_1", "D2D1_1", "D3D2_1", "A_1", "B_1", "C_1"
    )))), .Names = c("par", "value", "counts", "convergence", 
"message", "hessian"), class = c("list", "Tagloss"))
par(mar=c(4, 4, 1, 1))
plot(o, t=1:3000, model="2", scale=1000, ylim=c(0, 3), 
            col="red")
plot(o, t=1500:3000, model="1", scale=1000, 
            add=TRUE)
legend("topright", legend=c("2 -&gt; 1", "1 -&gt; 0"), col=c("red", "black"), lty=1)

plot(o, t=1:300, model="2", scale=1000, ylim=c(0, 3), 
            col="red", hessian=o$hessian)
plot(o, t=1:300, model="1", scale=1000, 
            add=TRUE, hessian=o$hessian)
legend("topright", legend=c("2 -&gt; 1", "1 -&gt; 0"), col=c("red", "black"), lty=1)

###### Example with fixed.parameters

data_f_21 &lt;- Tagloss_format(outLR, model="21")
# Without the N20 the computing is much faster
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
par &lt;- structure(c(49.5658922243074, 5.22150592456511, 8.00608716525864, 
                   50.612916258503, 6, 9), 
                .Names = c("D1_2",  "A_2", "B_2", 
                           "D1_1",  "A_1", "B_1"))
pfixed &lt;- c(D2D1_2=10000, D3D2_2=10000, C_2=0, D2D1_1=10000, D3D2_1=10000, C_1=0)
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par, fixed.parameters=pfixed)
# Here it is the result of the previous function
o &lt;- structure(list(par = structure(c(55.2184044121564, 5.2630294044259, 
8.13359029885985, 14269.9757684677, 21.8702023948044, 6.46586480967269
), .Names = c("D1_2", "A_2", "B_2", "D1_1", "A_1", "B_1")), value = 5853.64634357369, 
    counts = structure(c(757L, NA), .Names = c("function", "gradient"
    )), convergence = 0L, message = NULL, hessian = structure(c(0.036636720324168, 
    -2.26385645873961, -1.2330608569755, -2.95585778076202e-06, 
    -2.27373675443232e-07, -0.0399197688238928, -2.26385645873961, 
    232.345637869003, 47.1904784262733, 0.000118689058581367, 
    7.50333128962666e-06, 1.69928603099834, -1.2330608569755, 
    47.1904784262733, 304.432723851278, 0.000196678229258396, 
    1.36424205265939e-06, 2.8553522497532, -2.95585778076202e-06, 
    0.000118689058581367, 0.000196678229258396, 4.54747350886464e-07, 
    0, 0.00741636085876962, -2.27373675443232e-07, 7.50333128962666e-06, 
    1.36424205265939e-06, 0, 4.00177668780088e-05, 8.79936123965308e-05, 
    -0.0399197688238928, 1.69928603099834, 2.8553522497532, 0.00741636085876962, 
    8.79936123965308e-05, 107.941018768543), .Dim = c(6L, 6L), .Dimnames = list(
        c("D1_2", "A_2", "B_2", "D1_1", "A_1", "B_1"), c("D1_2", 
        "A_2", "B_2", "D1_1", "A_1", "B_1")))), .Names = c("par", 
"value", "counts", "convergence", "message", "hessian"), class = c("list", "Tagloss"))
par(mar=c(4, 4, 1, 1))
plot(o, t=1:3000, model="2", scale=1000, ylim=c(0, 3), 
            col="red")
plot(o, t=1500:3000, model="1", scale=1000, 
            add=TRUE)
legend("topright", legend=c("2 -&gt; 1", "1 -&gt; 0"), col=c("red", "black"), lty=1)

plot(o, t=1:300, model="2", scale=1000, ylim=c(0, 3), 
            col="red", hessian=o$hessian)
plot(o, t=1:300, model="1", scale=1000, 
            add=TRUE, hessian=o$hessian)
legend("topright", legend=c("2 -&gt; 1", "1 -&gt; 0"), col=c("red", "black"), lty=1)

###### Example with delta

data_f_21 &lt;- Tagloss_format(outLR, model="21")
# Without the N20 the computing is much faster
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
par &lt;- structure(c(45.8764973711504, 5.22489974562498, 8.07602162728874, 
-0.865444694177429), .Names = c("D1_2", "A_2", "B_2", "delta"
))
pfixed &lt;- c(D2D1_2=10000, D3D2_2=10000, C_2=0)
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par, fixed.parameters=pfixed)
# Here it is the result of the previous function
o &lt;- structure(list(par = structure(c(45.9035484983855, 5.22576211343279, 
8.07585745169786, -0.865706100004634), .Names = c("D1_2", "A_2", 
"B_2", "delta")), value = 5913.716964613, counts = structure(c(91L, 
NA), .Names = c("function", "gradient")), convergence = 0L, message = NULL, 
    hessian = structure(c(0.0644593001197791, -2.88983483187621, 
    -1.49161280660337, -0.0875163550517755, -2.88983483187621, 
    221.02317802819, 45.3729608125286, 3.73816044429987, -1.49161280660337, 
    45.3729608125286, 440.129730122862, 30.4781699469459, -0.0875163550517755, 
    3.73816044429987, 30.4781699469459, 9.47964940678503), .Dim = c(4L, 
    4L), .Dimnames = list(c("D1_2", "A_2", "B_2", "delta"), c("D1_2", 
    "A_2", "B_2", "delta")))), .Names = c("par", "value", "counts", 
"convergence", "message", "hessian"), class = c("list", "Tagloss"))
par(mar=c(4, 4, 1, 1))
plot(o, t=1:3000, model="2", scale=1000, ylim=c(0, 3), 
            col="red")
plot(o, t=1:3000, model="1", scale=1000, col="blue", 
            add=TRUE, hessian=o$hessian)
legend("topright", legend=c("2 -&gt; 1", "1 -&gt; 0"), col=c("red", "black"), lty=1)

###### Example with model_after
data_f_LR &lt;- Tagloss_format(outLR, model="LR")
par &lt;- structure(c(72.0399239978454, 58.1034231071992, 645.068735669251, 
                   5.10791337470247, 3538.47220045768, 7.83358940767931), 
                .Names = c("D1_L2", "D2D1_L2", "D3D2_L2", "A_L2", "B_L2", "C_L2"))
pfixed &lt;- NULL
# A progress bar can be shown when one core is used
system.time(
print(Tagloss_L(individuals=data_f_LR, par=par, days.maximum=Tagloss_daymax(data_f_LR), 
          fixed.parameters=pfixed, mc.cores=1, model_after="pR2=pL2;pR1=pL2;pL1=pL2", 
          progressbar = TRUE))
)
# When parallel computing is done, no progress bar can be shown
system.time(
print(Tagloss_L(individuals=data_f_LR, par=par, days.maximum=Tagloss_daymax(data_f_LR), 
          fixed.parameters=pfixed, model_after="pR2=pL2;pR1=pL2;pL1=pL2"))
)
# The NLR_00 are very long to calculate
data_f_LR_fast &lt;- subset(data_f_LR, subset=(is.na(data_f_LR$NLR_00)))
system.time(
print(Tagloss_L(individuals=data_f_LR_fast, par=par, days.maximum=Tagloss_daymax(data_f_LR_fast), 
          fixed.parameters=pfixed, model_after="pR2=pL2;pR1=pL2;pL1=pL2"))
)
o &lt;- Tagloss_fit(data=data_f_LR_fast, 
                 fitted.parameters=par, fixed.parameters=pfixed, 
                  model_after="pR2=pL2;pR1=pL2;pL1=pL2")

par(mar=c(4, 4, 1, 1))
plot(o, t=1:3000, model="2", scale=1000, ylim=c(0, 3), 
            col="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_LengthObs'>Return a list with the number of days for different kinds of individuals are seen.</h2><span id='topic+Tagloss_LengthObs'></span>

<h3>Description</h3>

<p>Usefull to summarize data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_LengthObs(data, progressbar = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_LengthObs_+3A_data">data</code></td>
<td>
<p>Set of indivuals</p>
</td></tr>
<tr><td><code id="Tagloss_LengthObs_+3A_progressbar">progressbar</code></td>
<td>
<p>Is shown a progressbar?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_LengthObs returns a list with the number of days for different kinds of individuals are seen.
</p>


<h3>Value</h3>

<p>Return a list with the number of days for different kinds of individuals are seen.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")
Tagloss_LengthObs(data_f_21)

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_mcmc'>Bayesian model of tag loss using a CMR database.</h2><span id='topic+Tagloss_mcmc'></span>

<h3>Description</h3>

<p>This function fits a model of tag loss using a CMR database using Bayesian mcmc.<br />
The parameters must be stored in a data.frame with named rows for each parameter with the following columns:<br />
</p>

<ul>
<li><p> Density. The density function name, example <code>dnorm</code>, <code>dlnorm</code>, <code>dunif</code>
</p>
</li>
<li><p> Prior1. The first parameter to send to the <code>Density</code> function
</p>
</li>
<li><p> Prior2. The second parameter to send to the <code>Density</code> function
</p>
</li>
<li><p> SDProp. The standard error from new proposition value of this parameter
</p>
</li>
<li><p> Min. The minimum value for this parameter
</p>
</li>
<li><p> Max. The maximum value for this parameter
</p>
</li>
<li><p> Init. The initial value for this parameter
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_mcmc(
  data = stop("A database formated using Tagloss_format() must be used"),
  parameters = stop("Priors must be supplied"),
  fixed.parameters = NULL,
  model_before = NULL,
  model_after = NULL,
  mc.cores = detectCores(all.tests = FALSE, logical = TRUE),
  groups = detectCores(all.tests = FALSE, logical = TRUE),
  n.iter = 10000,
  n.chains = 1,
  n.adapt = 100,
  thin = 30,
  trace = FALSE,
  traceML = FALSE,
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_mcmc_+3A_data">data</code></td>
<td>
<p>An object formated using Tagloss_format</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_parameters">parameters</code></td>
<td>
<p>A data.frame with priors; see description and examples</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_model_before">model_before</code></td>
<td>
<p>Transformation of parameters before to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_model_after">model_after</code></td>
<td>
<p>Transformation of parameters after to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cores to use for parallel computing</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_groups">groups</code></td>
<td>
<p>Number of groups for parallel computing</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for each chain</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of chains</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iteration to stabilize likelihood</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_thin">thin</code></td>
<td>
<p>Interval for thinning Markov chain</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_trace">trace</code></td>
<td>
<p>Or FALSE or period to show progress</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_traceml">traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive context</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_intermediate">intermediate</code></td>
<td>
<p>Or NULL of period to save intermediate result</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_filename">filename</code></td>
<td>
<p>Name of file in which intermediate results are saved</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_+3A_previous">previous</code></td>
<td>
<p>The content of the file in which intermediate results are saved</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_mcmc Bayesian model of tag loss using a CMR database.
</p>


<h3>Value</h3>

<p>Return a list object with the Bayesian model describing tag loss.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")

# model fitted by Rivalan et al. 2005
par &lt;- c(a0_2=-5.43E-2, a1_2=-103.52, a4_2=5.62E-4, 
         delta_1=3.2E-4)
pfixed &lt;- c(a2_2=0, a3_2=0, a2_1=0, a3_1=0)
model_before &lt;- "par['a0_1']=par['a0_2'];par['a1_1']=par['a1_2'];par['a4_1']=par['a4_2']"
o &lt;- Tagloss_fit(data=data_f_21, fitted.parameters=par, fixed.parameters=pfixed, 
                 model_before=model_before)
pMCMC &lt;- Tagloss_mcmc_p(o, accept=TRUE)
o_MCMC &lt;- Tagloss_mcmc(data=data_f_21, parameters=pMCMC, fixed.parameters=pfixed, 
                 model_before=model_before, 
                 n.iter=10000, n.chains = 1, n.adapt = 100, thin=30)

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_mcmc_p'>Generates set of parameters to be used with Tagloss_mcmc()</h2><span id='topic+Tagloss_mcmc_p'></span>

<h3>Description</h3>

<p>Interactive (or not!) script used to generate set of parameters to be used with Tagloss_mcmc().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_mcmc_p(
  result = stop("An output from Tagloss_fit() must be provided"),
  default.density = "dunif",
  accept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_mcmc_p_+3A_result">result</code></td>
<td>
<p>An object obtained after a Tagloss_fit() fit</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_p_+3A_default.density">default.density</code></td>
<td>
<p>The default density, &quot;dnorm&quot; or &quot;dunif'</p>
</td></tr>
<tr><td><code id="Tagloss_mcmc_p_+3A_accept">accept</code></td>
<td>
<p>If TRUE, does not wait for use interaction</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_mcmc_p generates set of parameters to be used with Tagloss_mcmc()
</p>


<h3>Value</h3>

<p>A matrix with the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")

# model fitted by Rivalan et al. 2005
par &lt;- c(a0_2=-5.43E-2, a1_2=-103.52, a4_2=5.62E-4, 
         delta_1=3.2E-4)
pfixed &lt;- c(a2_2=0, a3_2=0, a2_1=0, a3_1=0)
model_before &lt;- "par['a0_1']=par['a0_2'];par['a1_1']=par['a1_2'];par['a4_1']=par['a4_2']"
o &lt;- Tagloss_fit(data=data_f_21, fitted.parameters=par, fixed.parameters=pfixed, 
                 model_before=model_before)
pMCMC &lt;- Tagloss_mcmc_p(o, accept=TRUE)
o_MCMC &lt;- Tagloss_mcmc(data=data_f_21, parameters=pMCMC, fixed.parameters=pfixed, 
                 model_before=model_before, 
                 n.iter=10000, n.chains = 1, n.adapt = 100, thin=30)

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_model'>Return the daily rate of tag loss.</h2><span id='topic+Tagloss_model'></span>

<h3>Description</h3>

<p>This function compute a model of daily tag loss rate for days t
based on a set of parameters, par or a fitted tag loss model in x.<br />
Parameters are described in <code><a href="#topic+Tagloss_fit">Tagloss_fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_model(
  t = NULL,
  par = NULL,
  Hessian = NULL,
  mcmc = NULL,
  model_before = NULL,
  model_after = NULL,
  model = stop("You must specify which tag loss rate you want."),
  method = NULL,
  replicates = NULL,
  x = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_model_+3A_t">t</code></td>
<td>
<p>Time for which values of model must be estimated</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_par">par</code></td>
<td>
<p>Parameters</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_hessian">Hessian</code></td>
<td>
<p>Hessian matrix of parameters</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_mcmc">mcmc</code></td>
<td>
<p>A mcmc result</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_model_before">model_before</code></td>
<td>
<p>Function to be used before estimation of daily tagloss rate</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_model_after">model_after</code></td>
<td>
<p>Function to be used after estimation of daily tagloss rate</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_model">model</code></td>
<td>
<p>The model of parameter to be used, can be 1, 2, L1, L2, R1 or R2</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_method">method</code></td>
<td>
<p>Can be NULL, &quot;delta&quot;, &quot;SE&quot;, &quot;Hessian&quot;, &quot;MCMC&quot;, or &quot;PseudoHessianFromMCMC&quot;</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates to estimate se of output</p>
</td></tr>
<tr><td><code id="Tagloss_model_+3A_x">x</code></td>
<td>
<p>A Tagloss fitted model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_model returns the daily rate of tag loss.
</p>


<h3>Value</h3>

<p>Return the daily rate of tag loss if hessian is null or a data.frame with distribution of daily rate of tag loss if hessian is not null.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_simulate">Tagloss_simulate</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(phenology)

# Example
t &lt;- 1:1000
par &lt;- c(D1=200, D2D1=100, D3D2=200, 
         A=-logit(0.02), B=-logit(0.05), C=-logit(0.07))
y &lt;- Tagloss_model(t, par, model="1")
plot(x=t, y, type="l")
par &lt;- c(D1_1=200, D2D1_1=100, D3D2_1=200, 
         A_1=-logit(0.02), B_1=-logit(0.05), C_1=-logit(0.07))
y &lt;- Tagloss_model(t, par, model="1")
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, model="1")

# Fig1A in Rivalan et al. 2005 (note an error for a0; a0 must be negative)
par &lt;- c(a0=-1E5, a1=-2000, a2=0, a3=2*max(t), a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1B in Rivalan et al. 2005
par &lt;- c(a0=-0.5, a1=-2000, a2=-0.001, a3=0, a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1C in Rivalan et al. 2005
par &lt;- c(a0=-1, a1=-6, a2=0, a3=0, a4=0)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1D in Rivalan et al. 2005
par &lt;- c(a0=-1, a1=-6, a2=0, a3=0, a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1E in Rivalan et al. 2005
par &lt;- c(a0=-0.1, a1=-10, a2=-0.2, a3=60, a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1F in Rivalan et al. 2005
par &lt;- c(a0=-0.1, a1=-10, a2=0.2, a3=60, a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Example with fitted data
data_f_21 &lt;- Tagloss_format(outLR, model="21")
# Without the N20 the computing is much faster
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
par &lt;- c('D1_2' = 49.086835072129126, 
         'D2D1_2' = 1065.0992647723231, 
         'D3D2_2' = 6.15531475922079, 
         'A_2' = 5.2179675647973758, 
         'B_2' = 8.0045560376751386, 
         'C_2' = 8.4082505219581876, 
         'D1_1' = 177.23337287498103, 
         'D2D1_1' = 615.42690323741033, 
         'D3D2_1' = 2829.0806609455867, 
         'A_1' = 28.500118091731551, 
         'B_1' = 10.175426055942701, 
         'C_1' = 6.9616630417169398)
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par)
t &lt;- 1:10
y &lt;- Tagloss_model(t, o$par, model="1")
y &lt;- Tagloss_model(t, x=o, method=NULL, model="1")
y &lt;- Tagloss_model(t, x=o, method="Hessian", model="1", replicates=1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='Tagloss_simulate'>Return a list with the number of days different kinds of individuals are seen.</h2><span id='topic+Tagloss_simulate'></span>

<h3>Description</h3>

<p>Generate data with known features.<br />
model_before is applied to par parameter.<br />
model_after is applied after par is separated in p1, p2, pL1, pL2, pR1 and pR2 parameters.<br />
pobservation can be a vector of daily probabilities to be captured. The last value is repeated
if necessary.<br />
The maximum number of days of observation is exp(LengthObservation[&quot;max&quot;]).<br />
If model=&quot;12&quot; then par must have _1 and _2 parameters.<br />
if model=&quot;LR&quot; then par must have _L2, _L1, _R2, R1 parameters.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tagloss_simulate(
  n = 500,
  par,
  pobservation = c(rep(0.05, 70), 0.01),
  LengthObservation = c(min = 0, max = 9),
  dailysurvival = 0.999,
  model = "12",
  model_before = NULL,
  model_after = NULL,
  progressbar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tagloss_simulate_+3A_n">n</code></td>
<td>
<p>Number of individuals to simulate</p>
</td></tr>
<tr><td><code id="Tagloss_simulate_+3A_par">par</code></td>
<td>
<p>Set of parameters</p>
</td></tr>
<tr><td><code id="Tagloss_simulate_+3A_pobservation">pobservation</code></td>
<td>
<p>Probability of daily observation</p>
</td></tr>
<tr><td><code id="Tagloss_simulate_+3A_lengthobservation">LengthObservation</code></td>
<td>
<p>The log of number of days of observations is a random number between min and max</p>
</td></tr>
<tr><td><code id="Tagloss_simulate_+3A_dailysurvival">dailysurvival</code></td>
<td>
<p>Daily probability of survival</p>
</td></tr>
<tr><td><code id="Tagloss_simulate_+3A_model">model</code></td>
<td>
<p>Must be &quot;12&quot; or &quot;LR&quot;</p>
</td></tr>
<tr><td><code id="Tagloss_simulate_+3A_model_before">model_before</code></td>
<td>
<p>Transformation of parameters before to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="Tagloss_simulate_+3A_model_after">model_after</code></td>
<td>
<p>Transformation of parameters after to use Tagloss_model()</p>
</td></tr>
<tr><td><code id="Tagloss_simulate_+3A_progressbar">progressbar</code></td>
<td>
<p>Is a progressbar should be shown?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tagloss_simulate returns a list with the number of days different kinds of individuals are seen.
</p>


<h3>Value</h3>

<p>Return a list with the number of days different kinds of individuals are seen.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code><a href="#topic+Tagloss_L">Tagloss_L</a>()</code>,
<code><a href="#topic+Tagloss_LengthObs">Tagloss_LengthObs</a>()</code>,
<code><a href="#topic+Tagloss_cumul">Tagloss_cumul</a>()</code>,
<code><a href="#topic+Tagloss_daymax">Tagloss_daymax</a>()</code>,
<code><a href="#topic+Tagloss_fit">Tagloss_fit</a>()</code>,
<code><a href="#topic+Tagloss_format">Tagloss_format</a>()</code>,
<code><a href="#topic+Tagloss_mcmc">Tagloss_mcmc</a>()</code>,
<code><a href="#topic+Tagloss_mcmc_p">Tagloss_mcmc_p</a>()</code>,
<code><a href="#topic+Tagloss_model">Tagloss_model</a>()</code>,
<code><a href="#topic+logLik.Tagloss">logLik.Tagloss</a>()</code>,
<code><a href="#topic+o_4p_p1p2">o_4p_p1p2</a></code>,
<code><a href="#topic+plot.Tagloss">plot.Tagloss</a>()</code>,
<code><a href="#topic+plot.TaglossData">plot.TaglossData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phenology)
## Not run: 
# Example
par &lt;- structure(c(49.5658922243074, 808.136085362158, 106.283783786853, 
5.22150592456511, 8.00608716525864, 8.32718202233396, 150.612916258503, 
715.865805125223, 2242.06574225966, 119.212383120678, 10.1860735529433, 
7.14231725937626), .Names = c("D1_2", "D2D1_2", "D3D2_2", "A_2", 
"B_2", "C_2", "D1_1", "D2D1_1", "D3D2_1", "A_1", "B_1", "C_1"))
cmr &lt;- Tagloss_simulate(n=500, 
                        par=par, model="12")
cmr_f &lt;- Tagloss_format(cmr, model="12")

## End(Not run)
</code></pre>

<hr>
<h2 id='toggle_Min_PMin'>Transform a set of parameters from Min, MinB or MinE to PMin, PminB or PminE, or reverse</h2><span id='topic+toggle_Min_PMin'></span>

<h3>Description</h3>

<p>This function is used to transform a set of parameters
that uses Min, MinB or MinE to a set of parameters
that uses PMin, PminB or PminE, or reverse.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toggle_Min_PMin(parameters = stop("A set of parameters must be indicated"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="toggle_Min_PMin_+3A_parameters">parameters</code></td>
<td>
<p>Set of current parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>toggle_Min_PMin transforms a set of parameters from Min, MinB or MinE to PMin, PminB or PminE, or reverse
</p>


<h3>Value</h3>

<p>Return a set of modified parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot
refdate &lt;- as.Date("2001-01-01")
data_Gratiot&lt;-add_phenology(Gratiot, name="Complete", reference=refdate, format="%d/%m/%Y")
# Generate initial points for the optimisation
parg&lt;-par_init(data_Gratiot)
# Change the parameters to PMinB and PMinE
parg1&lt;-toggle_Min_PMin(parameters=parg)
# And change back to MinB and MinE
parg2&lt;-toggle_Min_PMin(parameters=parg1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
