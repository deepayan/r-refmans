<!DOCTYPE html><html><head><title>Help for package mstherm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mstherm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mstherm'><p>Model and analyze MS/MS-based protein melting data.</p></a></li>
<li><a href='#abs_to_ratio'><p>Convert absolute quantitation to relative ratios.</p></a></li>
<li><a href='#as.data.frame.MSThermResultSet'><p>MSResultSet to data frame.</p></a></li>
<li><a href='#gen_profile'><p>Generate protein ratio profile from spectrum quantification matrix.</p></a></li>
<li><a href='#model_experiment'><p>Model MSThermExperiment.</p></a></li>
<li><a href='#model_protein'><p>Model single protein.</p></a></li>
<li><a href='#MSThermExperiment'><p>Create a new MSThermExperiment.</p></a></li>
<li><a href='#normalize_to_profile'><p>Normalize to a profile.</p></a></li>
<li><a href='#normalize_to_std'><p>Normalize to a spike-in standard.</p></a></li>
<li><a href='#normalize_to_tm'><p>Re-normalize based on Tm.</p></a></li>
<li><a href='#plot.MSThermResult'><p>Plot MSThermResult object.</p></a></li>
<li><a href='#plot.MSThermResultSet'><p>Plot MSThermResultSet object.</p></a></li>
<li><a href='#summary.MSThermResult'><p>Summarize MSThermResult object.</p></a></li>
<li><a href='#summary.MSThermResultSet'><p>Summarize MSThermResultSet object.</p></a></li>
<li><a href='#write.sqlite'><p>Export MSThermResultSet to an SQLite database.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyze MS/MS Protein Melting Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-04-21</td>
</tr>
<tr>
<td>Description:</td>
<td>Software to aid in modeling and analyzing mass-spectrometry-based
    proteome melting data. Quantitative data is imported and normalized and
    thermal behavior is modeled at the protein level. Methods exist for
    normalization, modeling, visualization, and export of results. For a
    general introduction to MS-based thermal profiling, see Savitski et al.
    (2014) &lt;<a href="https://doi.org/10.1126%2Fscience.1255784">doi:10.1126/science.1255784</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>foreach, parallel, doParallel, nls2, RColorBrewer, plotrix</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RSQLite, testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>Collate:</td>
<td>mstherm.R classes.R normalization.R modeling.R plot.R
analysis.R export.R</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-04-27 17:00:18 UTC; jeremy</td>
</tr>
<tr>
<td>Author:</td>
<td>Jeremy Volkening [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jeremy Volkening &lt;jdv@base2bio.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-04-27 17:22:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='mstherm'>Model and analyze MS/MS-based protein melting data.</h2><span id='topic+mstherm'></span><span id='topic+mstherm-package'></span>

<h3>Description</h3>

<p><code>mstherm</code> is a package for modeling and analysis of
MS/MS-based thermal proteome profiling (TPP) experiments.
</p>


<h3>Author(s)</h3>

<p>Jeremy Volkening <a href="mailto:jdv@base2bio.com">jdv@base2bio.com</a>
</p>

<hr>
<h2 id='abs_to_ratio'>Convert absolute quantitation to relative ratios.</h2><span id='topic+abs_to_ratio'></span>

<h3>Description</h3>

<p><code>abs_to_ratio</code> takes a vector of absolute values and
returns a vector of ratios relative to some starting point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abs_to_ratio(x, method = "first")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abs_to_ratio_+3A_x">x</code></td>
<td>
<p>vector of numeric absolute quantitation values</p>
</td></tr>
<tr><td><code id="abs_to_ratio_+3A_method">method</code></td>
<td>
<p>method to use to determine starting value (denominator)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The denominator used to calculate relative protein concentrations
can affect the ability to model noisy data. In the theoretically ideal
scenario, everything would be relative to the lowest temperature point.
However, other methods can be used to help alleviate problems related to
noise. Available methods include:
</p>

<dl>
<dt>&quot;first&quot;</dt><dd><p>Use the first value (lowest temperature point)
(default)</p>
</dd>
<dt>&quot;max&quot;</dt><dd><p>Use the maximum value</p>
</dd>
<dt>&quot;top3&quot;</dt><dd><p>Use the mean of the three highest values</p>
</dd>
<dt>&quot;near&quot;</dt><dd><p>Use the median of all values greater than 80
the first value</p>
</dd>
</dl>



<h3>Value</h3>

<p>A numeric vector of the same length as input
</p>

<hr>
<h2 id='as.data.frame.MSThermResultSet'>MSResultSet to data frame.</h2><span id='topic+as.data.frame.MSThermResultSet'></span>

<h3>Description</h3>

<p>Populates a data frame with information from an MSResultSet,
one row per protein/group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MSThermResultSet'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.MSThermResultSet_+3A_x">x</code></td>
<td>
<p>an MSResultSet object</p>
</td></tr>
<tr><td><code id="as.data.frame.MSThermResultSet_+3A_...">...</code></td>
<td>
<p>additional arguments passed to or from other functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame populated with relevant information per result
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)
expt    &lt;- normalize_to_std(expt, "cRAP_ALBU_BOVIN", plot=FALSE)
res     &lt;- model_experiment(expt, bootstrap=FALSE, np=2)

df &lt;- as.data.frame(res)

</code></pre>

<hr>
<h2 id='gen_profile'>Generate protein ratio profile from spectrum quantification matrix.</h2><span id='topic+gen_profile'></span>

<h3>Description</h3>

<p><code>gen_profile</code> takes a matrix of spectrum channel
quantification values belonging to a protein and &quot;rolls them up&quot; into a
vector of protein-level relative quantification values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_profile(x, method = "sum", method.denom = "first")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_profile_+3A_x">x</code></td>
<td>
<p>matrix of spectrum quantification values, one row per spectrum and
one column per channel</p>
</td></tr>
<tr><td><code id="gen_profile_+3A_method">method</code></td>
<td>
<p>method to use to &quot;roll up&quot; spectrum values to protein level</p>
</td></tr>
<tr><td><code id="gen_profile_+3A_method.denom">method.denom</code></td>
<td>
<p>method used to determine ratio denominator, passed as
the &quot;method&quot; argument to <code>abs_to_ratio</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following methods for spectrum-to-protein conversion are
supported:
</p>

<dl>
<dt>&quot;sum&quot;</dt><dd><p>use the sum of the Spectrum values for each channel</p>
</dd>
<dt>&quot;median&quot;</dt><dd><p>use the median of the spectrum values for each
channel</p>
</dd>
<dt>&quot;ratio.median&quot;</dt><dd><p>Like &quot;median&quot;, but values for each spectrum
are first converted to ratios according to &quot;method.denom&quot;
channel</p>
</dd>
<dt>&quot;ratio.mean&quot;</dt><dd><p>Like &quot;ratio.median&quot; but using mean of ratios</p>
</dd>
</dl>



<h3>Value</h3>

<p>A numeric vector of the same length as the number of matrix columns
</p>

<hr>
<h2 id='model_experiment'>Model MSThermExperiment.</h2><span id='topic+model_experiment'></span>

<h3>Description</h3>

<p>Model multiple proteins from an MSThermExperiment object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_experiment(expt, proteins, np, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_experiment_+3A_expt">expt</code></td>
<td>
<p>An MSThermExperiment object</p>
</td></tr>
<tr><td><code id="model_experiment_+3A_proteins">proteins</code></td>
<td>
<p>A vector of protein IDs to model (default is all
proteins).</p>
</td></tr>
<tr><td><code id="model_experiment_+3A_np">np</code></td>
<td>
<p>Number of parallel jobs to start (default = number of available
processors)</p>
</td></tr>
<tr><td><code id="model_experiment_+3A_...">...</code></td>
<td>
<p>Parameters passed to model_protein()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MSThermResultSet object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)
expt    &lt;- normalize_to_std(expt, "cRAP_ALBU_BOVIN", plot=FALSE)

res     &lt;- model_experiment(expt, bootstrap=FALSE, np=2)
summary(res)

</code></pre>

<hr>
<h2 id='model_protein'>Model single protein.</h2><span id='topic+model_protein'></span>

<h3>Description</h3>

<p>Model a single protein from an MSThermExperiment object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_protein(expt, protein, min_rep_psm = 0, min_smp_psm = 0,
  min_tot_psm = 0, max_inf = 1, min_score, max_score, smooth = 0,
  method = "sum", method.denom = "near", trim = 0, bootstrap = 0,
  min_bs_psms = 8, annot_sep = "|", max_slope = 0, min_r2 = 0,
  min_reps = 0, only_modeled = 0, check_missing = 0,
  missing_cutoff = 0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_protein_+3A_expt">expt</code></td>
<td>
<p>An MSThermExperiment object</p>
</td></tr>
<tr><td><code id="model_protein_+3A_protein">protein</code></td>
<td>
<p>ID of the protein to model</p>
</td></tr>
<tr><td><code id="model_protein_+3A_min_rep_psm">min_rep_psm</code></td>
<td>
<p>Minimum number of spectral matches required for each
replicate to model protein</p>
</td></tr>
<tr><td><code id="model_protein_+3A_min_smp_psm">min_smp_psm</code></td>
<td>
<p>Minimum number of spectral matches required for each
sample to model protein</p>
</td></tr>
<tr><td><code id="model_protein_+3A_min_tot_psm">min_tot_psm</code></td>
<td>
<p>Minimum number of spectral matches required across all
replicates to model protein</p>
</td></tr>
<tr><td><code id="model_protein_+3A_max_inf">max_inf</code></td>
<td>
<p>Maximum co-isolation interference level allowed to include a
spectrum in protein-level quantification</p>
</td></tr>
<tr><td><code id="model_protein_+3A_min_score">min_score</code></td>
<td>
<p>minimum score allowed to include a
spectrum in protein-level quantification</p>
</td></tr>
<tr><td><code id="model_protein_+3A_max_score">max_score</code></td>
<td>
<p>maximum score allowed to include a
spectrum in protein-level quantification</p>
</td></tr>
<tr><td><code id="model_protein_+3A_smooth">smooth</code></td>
<td>
<p>(t/F) Perform loess smoothing on the data prior to modeling</p>
</td></tr>
<tr><td><code id="model_protein_+3A_method">method</code></td>
<td>
<p>Protein quantification method to use (see Details)</p>
</td></tr>
<tr><td><code id="model_protein_+3A_method.denom">method.denom</code></td>
<td>
<p>Method used to calculate denominator of abundance
(see Details)</p>
</td></tr>
<tr><td><code id="model_protein_+3A_trim">trim</code></td>
<td>
<p>(t/F) Trim all lower data points less than the abundance maximum</p>
</td></tr>
<tr><td><code id="model_protein_+3A_bootstrap">bootstrap</code></td>
<td>
<p>(T/F) Perform bootstrap analysis to determine confidence
intervals (slow)</p>
</td></tr>
<tr><td><code id="model_protein_+3A_min_bs_psms">min_bs_psms</code></td>
<td>
<p>Minimum number of spectral matches required to perform
bootstrapping</p>
</td></tr>
<tr><td><code id="model_protein_+3A_annot_sep">annot_sep</code></td>
<td>
<p>Symbol used to separate protein group IDs (used for
retrieval of annotations) (default: '|')</p>
</td></tr>
<tr><td><code id="model_protein_+3A_max_slope">max_slope</code></td>
<td>
<p>Maximum slope to consider model (implies &quot;only_modeled&quot;)</p>
</td></tr>
<tr><td><code id="model_protein_+3A_min_r2">min_r2</code></td>
<td>
<p>Minimum R2 value to consider model (implies &quot;only_modeled&quot;)</p>
</td></tr>
<tr><td><code id="model_protein_+3A_min_reps">min_reps</code></td>
<td>
<p>Minimum number of modeled replicates for each sample to
return protein</p>
</td></tr>
<tr><td><code id="model_protein_+3A_only_modeled">only_modeled</code></td>
<td>
<p>(t/F) Only consider modeled proteins</p>
</td></tr>
<tr><td><code id="model_protein_+3A_check_missing">check_missing</code></td>
<td>
<p>(t/F) Run simple test to filter out PSMs with missing
quantification channels where values are expected</p>
</td></tr>
<tr><td><code id="model_protein_+3A_missing_cutoff">missing_cutoff</code></td>
<td>
<p>Minimum fraction relative to surrounding data points
used in the check for missing channels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Valid quantification methods include:
</p>

<dl>
<dt>&quot;sum&quot;</dt><dd><p>use the sum of the spectrum values for each channel</p>
</dd>
<dt>&quot;median&quot;</dt><dd><p>use the median of the spectrum values for each
channel</p>
</dd>
<dt>&quot;ratio.median&quot;</dt><dd><p>Like &quot;median&quot;, but values for each spectrum
are first converted to ratios according to &quot;method.denom&quot;
channel</p>
</dd>
<dt>&quot;ratio.mean&quot;</dt><dd><p>Like &quot;ratio.median&quot; but using mean of ratios</p>
</dd>
</dl>

<p>Valid denominator methods include:
</p>

<dl>
<dt>&quot;first&quot;</dt><dd><p>Use the first value (lowest temperature point)
(default)</p>
</dd>
<dt>&quot;max&quot;</dt><dd><p>Use the maximum value</p>
</dd>
<dt>&quot;top3&quot;</dt><dd><p>Use the mean of the three highest values</p>
</dd>
<dt>&quot;near&quot;</dt><dd><p>Use the median of all values greater than 80
the first value</p>
</dd>
</dl>



<h3>Value</h3>

<p>MSThermResult object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)
expt    &lt;- normalize_to_std(expt, "cRAP_ALBU_BOVIN", plot=FALSE)

model   &lt;- model_protein(expt, "P38707", smooth=TRUE, bootstrap=FALSE)
summary(model)

</code></pre>

<hr>
<h2 id='MSThermExperiment'>Create a new MSThermExperiment.</h2><span id='topic+MSThermExperiment'></span>

<h3>Description</h3>

<p><code>MSThermExperiment</code> creates a new experiment object from
a set of filenames or data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MSThermExperiment(control, annotations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MSThermExperiment_+3A_control">control</code></td>
<td>
<p>data frame or filename of tab-delimited table describing the
experimental setup and locations of data on disk (see Details)</p>
</td></tr>
<tr><td><code id="MSThermExperiment_+3A_annotations">annotations</code></td>
<td>
<p>data frame or filename to tab-delimited table containing
protein names and annotations (usually functional descriptions but can be
any text</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can take either a data frame or a tab-delimited
filename on disk (which will be read into a data frame). &quot;control&quot; should
contain columns with the following headers (in any order):
</p>

<dl>
<dt>&quot;name&quot;</dt><dd><p>Unique identifier of a single replicate</p>
</dd>
<dt>&quot;sample&quot;</dt><dd><p>Sample name that a replicate belongs to</p>
</dd>
<dt>&quot;data_file&quot;</dt><dd><p>Path to file on disk containing the quantification
data</p>
</dd>
<dt>&quot;meta_file&quot;</dt><dd><p>Path to file on disk containing the labeling
metadata</p>
</dd>
</dl>

<p>The &quot;meta_file&quot; should be tab-delimited text and contain two columns
labeled &quot;channel&quot; and &quot;temp&quot;.
The &quot;data_file&quot; should be tab-delimited text and contain, at a minimum,
the following columns:
</p>

<dl>
<dt>&quot;peptide&quot;</dt><dd><p>Sequence of the matched peptide in single-letter IUPAC</p>
</dd>
<dt>&quot;protein&quot;</dt><dd><p>Protein or protein group to which the peptide belongs</p>
</dd>
<dt>&quot;...&quot;</dt><dd><p>One column per isobaric channel, containing absolute
quantification values. Column names must match those in the
&quot;channel&quot; column of the meta file, with the exception that R will
automatically convert any name not compatible with its syntax
rules. To be safe, use only letters, digits, underscores, and
periods in channel names and never start with a digit (e.g. use &quot;TMT.126&quot;
rather than &quot;126&quot;)</p>
</dd>
</dl>

<p>The following columns can also be utilized for filtering if included (all
others will simply be ignored):
</p>

<dl>
<dt>&quot;coelute_inf&quot;</dt><dd><p>Calculated precursor co-isolation interference
(0.0-1.0)</p>
</dd>
<dt>&quot;score&quot;</dt><dd><p>Score assigned by the processing software to the PSM</p>
</dd>
</dl>

<p>&quot;annotations&quot; should contain two columns with the headers &quot;name&quot; and
&quot;annotation&quot;. &quot;name&quot; should match the protein names in the data files,
and &quot;annotation&quot; can contain any text (generally a functional description)
</p>


<h3>Value</h3>

<p>An MSThermExperiment object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)

</code></pre>

<hr>
<h2 id='normalize_to_profile'>Normalize to a profile.</h2><span id='topic+normalize_to_profile'></span>

<h3>Description</h3>

<p>Normalizes an MSThermReplicate based on a pre-determined
vector of relative abundances
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_to_profile(replicate, profile, model = T, plot = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_to_profile_+3A_replicate">replicate</code></td>
<td>
<p>an MSThermReplicate object</p>
</td></tr>
<tr><td><code id="normalize_to_profile_+3A_profile">profile</code></td>
<td>
<p>a vector of relative values</p>
</td></tr>
<tr><td><code id="normalize_to_profile_+3A_model">model</code></td>
<td>
<p>whether to fit scale factors to model</p>
</td></tr>
<tr><td><code id="normalize_to_profile_+3A_plot">plot</code></td>
<td>
<p>(T/f) whether to display a summary plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An MsThermReplicate object with normalized data slots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)

profile &lt;- c(50.0, 50.5, 47.5, 42.0, 37.0, 25.0, 16.0, 11.5, 10.5, 10.0)
expt$samples$Control$replicates$C1 &lt;- normalize_to_profile(
   expt$samples$Control$replicates$C1, profile, plot=FALSE
)

</code></pre>

<hr>
<h2 id='normalize_to_std'>Normalize to a spike-in standard.</h2><span id='topic+normalize_to_std'></span>

<h3>Description</h3>

<p>Normalizes each replicate of an experiment based on a given
spike-in protein standard (assumed to be present in equimolar amounts in
each channel).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_to_std(expt, protein, model = T, plot = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_to_std_+3A_expt">expt</code></td>
<td>
<p>an MSThermExperiment object</p>
</td></tr>
<tr><td><code id="normalize_to_std_+3A_protein">protein</code></td>
<td>
<p>ID of a protein to normalize against</p>
</td></tr>
<tr><td><code id="normalize_to_std_+3A_model">model</code></td>
<td>
<p>whether to fit scale factors to model</p>
</td></tr>
<tr><td><code id="normalize_to_std_+3A_plot">plot</code></td>
<td>
<p>(T/f) whether to display a summary plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An MsThermExperiment object with normalized data slots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)

expt    &lt;- normalize_to_std(expt, "cRAP_ALBU_BOVIN", plot=FALSE)

</code></pre>

<hr>
<h2 id='normalize_to_tm'>Re-normalize based on Tm.</h2><span id='topic+normalize_to_tm'></span>

<h3>Description</h3>

<p>Normalizes each replicate of an experiment based on linear
regression of calculated Tm (corrects for remaining systematic error).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_to_tm(expt, res)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_to_tm_+3A_expt">expt</code></td>
<td>
<p>An MSThermExperiment object</p>
</td></tr>
<tr><td><code id="normalize_to_tm_+3A_res">res</code></td>
<td>
<p>An MSThermResultSet object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An assumption can be made in most TPP experiments using a single
organism that the Tm of most proteins should not be changing. However,
global shifts have been observed between replicates, presumably due to
technical variance, which complicate data interpretation. This method
attempts to remove this source of error by doing a bootstrap
renormalization of the quantification values based on pairwise linear
regression between calculated Tms of each replicate. A reference set of Tms
is calculated based on all replicates, and each replicate is normalized to
this based on the calculated slope and intercept of the input data.
</p>


<h3>Value</h3>

<p>An MsThermExperiment object with re-normalized data slots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)
expt    &lt;- normalize_to_std(expt, "cRAP_ALBU_BOVIN", plot=FALSE)
res     &lt;- model_experiment(expt, smooth=TRUE, bootstrap=FALSE, np=2)

expt    &lt;- normalize_to_tm(expt, res)

</code></pre>

<hr>
<h2 id='plot.MSThermResult'>Plot MSThermResult object.</h2><span id='topic+plot.MSThermResult'></span>

<h3>Description</h3>

<p>Generate a denaturation plot for an modeled protein/group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MSThermResult'
plot(x, table = T, col, CI.points = T, CI.Tm = T,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.MSThermResult_+3A_x">x</code></td>
<td>
<p>An MSThermResult object</p>
</td></tr>
<tr><td><code id="plot.MSThermResult_+3A_table">table</code></td>
<td>
<p>(T/f) include table of per-replicate parameters</p>
</td></tr>
<tr><td><code id="plot.MSThermResult_+3A_col">col</code></td>
<td>
<p>array of colors used to plot samples</p>
</td></tr>
<tr><td><code id="plot.MSThermResult_+3A_ci.points">CI.points</code></td>
<td>
<p>(T/F) plot temperature point confidence intervals</p>
</td></tr>
<tr><td><code id="plot.MSThermResult_+3A_ci.tm">CI.Tm</code></td>
<td>
<p>(T/F) plot Tm confidence intervals</p>
</td></tr>
<tr><td><code id="plot.MSThermResult_+3A_...">...</code></td>
<td>
<p>other parameters passed through to plot()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)
expt    &lt;- normalize_to_std(expt, "cRAP_ALBU_BOVIN", plot=FALSE)
res     &lt;- model_experiment(expt, bootstrap=FALSE, np=2)

# plot single MSThermResult
plot(res$P38707)

# plot all proteins (e.g. to pdf device, one-per-page)
plot(res)

</code></pre>

<hr>
<h2 id='plot.MSThermResultSet'>Plot MSThermResultSet object.</h2><span id='topic+plot.MSThermResultSet'></span>

<h3>Description</h3>

<p>Generate a series of denaturation plots for all results in an
MSThermResultSet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MSThermResultSet'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.MSThermResultSet_+3A_x">x</code></td>
<td>
<p>an MSThermResultSet object</p>
</td></tr>
<tr><td><code id="plot.MSThermResultSet_+3A_...">...</code></td>
<td>
<p>other parameters are passed through to plot.MSThermResult</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since this function makes multiple sequential calls to
plot.MSThermResult, it is usually used in conjunction with a multipage
graphics device such as <code>"pdf()"</code>. Otherwise each subsequent call
will only overwrite the previous output.
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see plot.MSThermResult for an example

</code></pre>

<hr>
<h2 id='summary.MSThermResult'>Summarize MSThermResult object.</h2><span id='topic+summary.MSThermResult'></span>

<h3>Description</h3>

<p>Print a summary of an MSThermResult, including samples and
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MSThermResult'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.MSThermResult_+3A_object">object</code></td>
<td>
<p>an MSThermResult object</p>
</td></tr>
<tr><td><code id="summary.MSThermResult_+3A_...">...</code></td>
<td>
<p>additional arguments passed to or from other functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see model_protein() for an example

</code></pre>

<hr>
<h2 id='summary.MSThermResultSet'>Summarize MSThermResultSet object.</h2><span id='topic+summary.MSThermResultSet'></span>

<h3>Description</h3>

<p>Print a summary of an MSThermResultSet, including samples and
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MSThermResultSet'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.MSThermResultSet_+3A_object">object</code></td>
<td>
<p>an MSThermResultSet object</p>
</td></tr>
<tr><td><code id="summary.MSThermResultSet_+3A_...">...</code></td>
<td>
<p>additional arguments passed to or from other functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see model_experiment() for an example

</code></pre>

<hr>
<h2 id='write.sqlite'>Export MSThermResultSet to an SQLite database.</h2><span id='topic+write.sqlite'></span>

<h3>Description</h3>

<p>Exports and MSThermResultSet object to a new SQLite database file.
Each model (specific to a given replicate and protein) is exported as an
individual record. The schema used for the 'data' table can be seen in the
code below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.sqlite(res, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.sqlite_+3A_res">res</code></td>
<td>
<p>An MSThermResultSet object</p>
</td></tr>
<tr><td><code id="write.sqlite_+3A_file">file</code></td>
<td>
<p>Path to the output sqlite database to be created</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>control &lt;- system.file("extdata", "demo_project/control.tsv", package="mstherm")
annots  &lt;- system.file("extdata", "demo_project/annots.tsv",  package="mstherm")
expt    &lt;- MSThermExperiment(control, annotations=annots)
expt    &lt;- normalize_to_std(expt, "cRAP_ALBU_BOVIN", plot=FALSE)
res     &lt;- model_experiment(expt, bootstrap=FALSE, np=2)

fn &lt;- tempfile(fileext = ".sqlite")
write.sqlite(res, fn)
unlink(fn) # for example only

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
