<!DOCTYPE html><html lang="en"><head><title>Help for package PhenoSpectra</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PhenoSpectra}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PhenoSpectra-package'><p>PhenoSpectra: Multispectral Data Analysis and Visualization</p></a></li>
<li><a href='#.onLoad'><p>.onLoad Function</p></a></li>
<li><a href='#feature_selection'><p>Feature Selection for Spectral Data</p></a></li>
<li><a href='#predict_SDS'><p>Predict Spectral Disease Severity (SDS)</p></a></li>
<li><a href='#qaqcs'><p>Perform QA/QC on spectral data while preserving original column names</p></a></li>
<li><a href='#reads'><p>Read and merge spectral data using data.table exclusively</p></a></li>
<li><a href='#setup_environment'><p>Setup Environment for PhenoSpectra</p></a></li>
<li><a href='#zzz'><p>PhenoSpectra Internal Setup</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Multispectral Data Analysis and Visualization</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for processing, analyzing, and visualizing spectral data 
    collected from 3D laser-based scanning systems. Supports applications in agriculture, 
    forestry, environmental monitoring, industrial quality control, and biomedical research. 
    Enables evaluation of plant growth, productivity, resource efficiency, disease 
    management, and pest monitoring. Includes statistical methods for extracting insights 
    from multispectral and hyperspectral data and generating publication-ready visualizations. 
    See Zieschank &amp; Junker (2023) &lt;<a href="https://doi.org/10.3389%2Ffpls.2023.1141554">doi:10.3389/fpls.2023.1141554</a>&gt; and 
    Saric et al. (2022) &lt;<a href="https://doi.org/10.1016%2FJ.TPLANTS.2021.12.003">doi:10.1016/J.TPLANTS.2021.12.003</a>&gt; for related work.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>readxl, writexl, dplyr, tidyr, data.table, lubridate,
openxlsx, broom, magrittr, rlang, utils, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-03 08:17:30 UTC; gmpnw</td>
</tr>
<tr>
<td>Author:</td>
<td>Medhat Mahmoud [aut, cre],
  Arianna Del Papa [ctb],
  Melina Rampelmann [ctb],
  Patrick Dohle [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Medhat Mahmoud &lt;medhat.mahmoud@bayer.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-05 13:00:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='PhenoSpectra-package'>PhenoSpectra: Multispectral Data Analysis and Visualization</h2><span id='topic+PhenoSpectra'></span><span id='topic+PhenoSpectra-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Provides tools for processing, analyzing, and visualizing spectral data collected from 3D laser-based scanning systems. Supports applications in agriculture, forestry, environmental monitoring, industrial quality control, and biomedical research. Enables evaluation of plant growth, productivity, resource efficiency, disease management, and pest monitoring. Includes statistical methods for extracting insights from multispectral and hyperspectral data and generating publication-ready visualizations. See Zieschank &amp; Junker (2023) <a href="https://doi.org/10.3389/fpls.2023.1141554">doi:10.3389/fpls.2023.1141554</a> and Saric et al. (2022) <a href="https://doi.org/10.1016/J.TPLANTS.2021.12.003">doi:10.1016/J.TPLANTS.2021.12.003</a> for related work.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Medhat Mahmoud <a href="mailto:medhat.mahmoud@bayer.com">medhat.mahmoud@bayer.com</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Arianna Del Papa <a href="mailto:arianna.delpapa@bayer.com">arianna.delpapa@bayer.com</a> [contributor]
</p>
</li>
<li><p> Melina Rampelmann <a href="mailto:melina.rampelmann@bayer.com">melina.rampelmann@bayer.com</a> [contributor]
</p>
</li>
<li><p> Patrick Dohle <a href="mailto:patrick.dohle@bayer.com">patrick.dohle@bayer.com</a> [contributor]
</p>
</li></ul>


<hr>
<h2 id='.onLoad'>.onLoad Function</h2><span id='topic+.onLoad'></span>

<h3>Description</h3>

<p>Automatically runs when the package is loaded and sets up the environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.onLoad(libname, pkgname)
</code></pre>

<hr>
<h2 id='feature_selection'>Feature Selection for Spectral Data</h2><span id='topic+feature_selection'></span>

<h3>Description</h3>

<p>This function filters healthy vs diseased samples, selects the most discriminative spectral variables,
applies FDR correction, and exports the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feature_selection(
  file_path,
  output_path = "selected_features.xlsx",
  fdr_threshold = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="feature_selection_+3A_file_path">file_path</code></td>
<td>
<p>Path to the cleaned dataset (output of qaqcs function).</p>
</td></tr>
<tr><td><code id="feature_selection_+3A_output_path">output_path</code></td>
<td>
<p>Path to save the selected features table.</p>
</td></tr>
<tr><td><code id="feature_selection_+3A_fdr_threshold">fdr_threshold</code></td>
<td>
<p>Threshold for filtering significant features (default: 0.01).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table containing selected spectral variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create mock spectral data
library(openxlsx)
mock_data &lt;- data.frame(
  treatment = sample(0:1, 100, replace = TRUE),
  var1 = rnorm(100),
  var2 = rnorm(100),
  var3 = rnorm(100)
)
temp_file &lt;- tempfile(fileext = ".xlsx")
write.xlsx(mock_data, temp_file)

# Perform feature selection
output_path &lt;- tempfile(fileext = ".xlsx")
selected_features &lt;- feature_selection(temp_file, output_path, fdr_threshold = 0.01)
head(selected_features)
</code></pre>

<hr>
<h2 id='predict_SDS'>Predict Spectral Disease Severity (SDS)</h2><span id='topic+predict_SDS'></span>

<h3>Description</h3>

<p>This function predicts Spectral Disease Severity (SDS) using a standard linear regression model (<code>lm()</code>).
It automatically handles column names with special characters by using backticks and constrains predictions to the range <code style="white-space: pre;">&#8288;[0, 100]&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_SDS(cleaned_data, sf_test, fixed_effects = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_SDS_+3A_cleaned_data">cleaned_data</code></td>
<td>
<p>A dataframe containing spectral measurements and treatment labels.</p>
</td></tr>
<tr><td><code id="predict_SDS_+3A_sf_test">sf_test</code></td>
<td>
<p>A dataframe containing selected important features (from statistical tests).</p>
</td></tr>
<tr><td><code id="predict_SDS_+3A_fixed_effects">fixed_effects</code></td>
<td>
<p>A character vector of fixed effects to include (default: NULL).
Example: c(&quot;Scan.date&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with predicted SDS values for all treatments, constrained between <code>0</code> and <code>100</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create mock spectral data
library(openxlsx)
cleaned_data &lt;- data.frame(
  treatment = sample(0:1, 100, replace = TRUE),
  var1 = rnorm(100),
  var2 = rnorm(100),
  var3 = rnorm(100),
  Scan.date = sample(
    seq.Date(
      from = as.Date('2023-01-01'),
      to = as.Date('2023-12-31'),
      by = 'day'
    ),
    100
  ),
  Scan.time = format(Sys.time(), "%H:%M:%S")
)
</code></pre>

<hr>
<h2 id='qaqcs'>Perform QA/QC on spectral data while preserving original column names</h2><span id='topic+qaqcs'></span>

<h3>Description</h3>

<p>Perform QA/QC on spectral data while preserving original column names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qaqcs(
  file_path,
  output_path,
  handle_missing = "NA",
  handle_outliers = "NA",
  group_by_col = "treatment"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qaqcs_+3A_file_path">file_path</code></td>
<td>
<p>Path to the input file</p>
</td></tr>
<tr><td><code id="qaqcs_+3A_output_path">output_path</code></td>
<td>
<p>Path to save the cleaned data</p>
</td></tr>
<tr><td><code id="qaqcs_+3A_handle_missing">handle_missing</code></td>
<td>
<p>Method to handle missing values ('impute', 'remove', or 'NA')</p>
</td></tr>
<tr><td><code id="qaqcs_+3A_handle_outliers">handle_outliers</code></td>
<td>
<p>Method to handle outliers ('impute', 'remove', or 'NA')</p>
</td></tr>
<tr><td><code id="qaqcs_+3A_group_by_col">group_by_col</code></td>
<td>
<p>Column name for grouping</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with cleaned data and a summary table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(openxlsx)
# Create mock raw data
raw_data &lt;- data.frame(
  treatment = sample(0:1, 100, replace = TRUE),
  var1 = rnorm(100),
  var2 = rnorm(100),
  var3 = rnorm(100)
)

# Save mock data to a temporary file
raw_data_file &lt;- tempfile(fileext = ".xlsx")
output_file &lt;- tempfile(fileext = ".xlsx")

write.xlsx(raw_data, raw_data_file)

# Run QA/QC with missing values imputed and outliers removed
cleaned_result &lt;- qaqcs(
  file_path = raw_data_file,
  output_path = output_file,
  handle_missing = "impute",
  handle_outliers = "remove",
  group_by_col = "treatment"
)
head(cleaned_result$cleaned_data)
</code></pre>

<hr>
<h2 id='reads'>Read and merge spectral data using data.table exclusively</h2><span id='topic+reads'></span>

<h3>Description</h3>

<p>Read and merge spectral data using data.table exclusively
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reads(directory, pattern, output_path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reads_+3A_directory">directory</code></td>
<td>
<p>Path to the directory containing files</p>
</td></tr>
<tr><td><code id="reads_+3A_pattern">pattern</code></td>
<td>
<p>File pattern to search for (e.g., 'input')</p>
</td></tr>
<tr><td><code id="reads_+3A_output_path">output_path</code></td>
<td>
<p>Path to save the processed output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A merged data.table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(data.table)
# Create mock data files with all required columns
mock_data1 &lt;- data.frame(
  treatment = sample(0:1, 50, replace = TRUE),
  var1 = rnorm(50),
  var2 = rnorm(50),
  Scan.date = sample(
    seq.Date(
      from = as.Date('2023-01-01'),
      to = as.Date('2023-12-31'),
      by = 'day'
    ),
    50,
    replace = TRUE
  ),
  Scan.time = format(Sys.time(), "%H:%M:%S"),
  timestamp = Sys.time()  # Add timestamp column
)

mock_data2 &lt;- data.frame(
  treatment = sample(0:1, 50, replace = TRUE),
  var1 = rnorm(50),
  var2 = rnorm(50),
  Scan.date = sample(
    seq.Date(
      from = as.Date('2023-01-01'),
      to = as.Date('2023-12-31'),
      by = 'day'
    ),
    50,
    replace = TRUE
  ),
  Scan.time = format(Sys.time(), "%H:%M:%S"),
  timestamp = Sys.time()  # Add timestamp column
)

# Save mock data to temporary CSV files
temp_dir &lt;- tempdir()
file1 &lt;- file.path(temp_dir, "input_file1.csv")
file2 &lt;- file.path(temp_dir, "input_file2.csv")
fwrite(mock_data1, file1)
fwrite(mock_data2, file2)

# Run the reads() function on mock CSV data
merged_data &lt;- reads(
  directory = temp_dir,
  pattern = "input",
  output_path = tempfile(fileext = ".csv")
)
head(merged_data)
</code></pre>

<hr>
<h2 id='setup_environment'>Setup Environment for PhenoSpectra</h2><span id='topic+setup_environment'></span>

<h3>Description</h3>

<p>Automatically installs and loads all required packages.
</p>
<p>This function installs missing packages required by the PhenoSpectra package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_environment()

setup_environment()
</code></pre>


<h3>Value</h3>

<p>NULL. This function installs required packages if missing and loads them.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage:
setup_environment()  # Automatically installs and loads required packages
# Run to manually install missing packages
setup_environment()
</code></pre>

<hr>
<h2 id='zzz'>PhenoSpectra Internal Setup</h2><span id='topic+zzz'></span>

<h3>Description</h3>

<p>Handles automatic environment setup and global variable registration when the package is loaded.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage:
# Automatically run when the package is loaded, but can be manually called if needed
setup_environment()
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
