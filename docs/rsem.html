<!DOCTYPE html><html><head><title>Help for package rsem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rsem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rsem-package'><p>Robust Structural Equation Modeling with Missing Data and Auxiliary Variables</p></a></li>
<li><a href='#mardiamv25'><p>Simulated data</p></a></li>
<li><a href='#rsem'>
<p>The main function for robust SEM analysis</p></a></li>
<li><a href='#rsem.Ascov'>
<p>Sandwich-type covariance matrix</p></a></li>
<li><a href='#rsem.DP'>
<p>Generate a duplication matrix</p></a></li>
<li><a href='#rsem.emmusig'>
<p>Robust mean and covariance matrix using Huber-type weight</p></a></li>
<li><a href='#rsem.fit'>
<p>Calculate robust test statistics</p></a></li>
<li><a href='#rsem.gname'>
<p>Internal function</p></a></li>
<li><a href='#rsem.index'>
<p>rsem.index function</p></a></li>
<li><a href='#rsem.indexv'>
<p>rsem.indexv function</p></a></li>
<li><a href='#rsem.indexvc'>
<p>rsem.indexvc function</p></a></li>
<li><a href='#rsem.lavaan'>
<p>Conduct robust SEM analysis using lavaan</p></a></li>
<li><a href='#rsem.pattern'>
<p>Obtaining missing data patterns</p></a></li>
<li><a href='#rsem.print'>
<p>Organize the output for Lavaan with robust s.e. and test statistics</p></a></li>
<li><a href='#rsem.se'>
<p>Calculate robust standard errors</p></a></li>
<li><a href='#rsem.ssq'>
<p>Calculate the squared sum of a matrix</p></a></li>
<li><a href='#rsem.switch'>
<p>swith function</p></a></li>
<li><a href='#rsem.switch.gamma'>
<p>Internal function</p></a></li>
<li><a href='#rsem.vec'>
<p>Stacking a matrix to a vector</p></a></li>
<li><a href='#rsem.vech'>
<p>Stacking lower triange of a matrix to a vector</p></a></li>
<li><a href='#rsem.weight'>
<p>Calculate weight for each subject</p></a></li>
<li><a href='#semdiag.combinations'><p>Enumerate the Combinations of the Elements of a Vector</p></a></li>
<li><a href='#semdiag.read.eqs'><p>Import of EQS outputs into R</p></a></li>
<li><a href='#semdiag.run.eqs'><p>Run EQS from R</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Structural Equation Modeling with Missing Data and
Auxiliary Variables</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Ke-Hai Yuan and Zhiyong Zhang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhiyong Zhang &lt;zhiyongzhang@nd.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.7), MASS, lavaan</td>
</tr>
<tr>
<td>Description:</td>
<td>A robust procedure is implemented to estimate means and covariance matrix of multiple variables with missing data using Huber weight and then to estimate a structural equation model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://bigdatalab.nd.edu">https://bigdatalab.nd.edu</a></td>
</tr>
<tr>
<td>ZipData:</td>
<td>no</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-26 20:08:52 UTC; zzhang4</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-26 20:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rsem-package'>Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</h2><span id='topic+rsem-package'></span>

<h3>Description</h3>

<p>A robust procedure is implemented to estimate means and covariance matrix of multiple variables with missing data using Huber weight and then to estimate a structural equation model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> rsem</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
Maintainer: Zhiyong Zhang &lt;zhiyongzhang@nd.edu&gt;
</p>


<h3>References</h3>

<p>Yuan, K.-H., &amp; Zhang, Z. (2012). Robust structural equation modeling with missing data and auxiliary variables. Psychometrika, 77(4), 803-826. https://doi.org/10.1007/s11336-012-9282-4
</p>

<hr>
<h2 id='mardiamv25'>Simulated data</h2><span id='topic+mardiamv25'></span><span id='topic+mardiamv25_contaminated'></span>

<h3>Description</h3>

<p>mardiamv25: Original data
</p>
<p>mardiamv25_contaminated: Contaminated data with outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mardiamv25)
data(mardiamv25_contaminated)
</code></pre>

<hr>
<h2 id='rsem'>
The main function for robust SEM analysis
</h2><span id='topic+rsem'></span>

<h3>Description</h3>

<p>This is the function to carry out all analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem(dset, select, EQSmodel, moment=TRUE, varphi=.1, st='i', max.it=1000, 
eqsdata='data.txt', eqsweight='weight.txt', EQSpgm="C:/Progra~1/EQS61/WINEQS.EXE", 
serial="1234")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem_+3A_dset">dset</code></td>
<td>

<p>A data matrix or a data frame
</p>
</td></tr>
<tr><td><code id="rsem_+3A_select">select</code></td>
<td>

<p>Variables to be seleted for SEM analysis. If omitted, all variables in the data set will be used.
</p>
</td></tr>
<tr><td><code id="rsem_+3A_moment">moment</code></td>
<td>
<p>With mean structure. For covariance only, set moment=FALSE.</p>
</td></tr>
<tr><td><code id="rsem_+3A_eqsmodel">EQSmodel</code></td>
<td>

<p>The input file  for EQS. If omitted, only the first-stage analysis will be conducted.
</p>
</td></tr>
<tr><td><code id="rsem_+3A_varphi">varphi</code></td>
<td>

<p>Proportion of data to be down-weighted. Default is 0.1.
</p>
</td></tr>
<tr><td><code id="rsem_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations for EM. Default is 1000</p>
</td></tr>
<tr><td><code id="rsem_+3A_st">st</code></td>
<td>
<p>Starting values for EM algorithm. The default is 0 for mean and I for covariance. Alternative, the starting values can be estimated according to MCD.</p>
</td></tr>
<tr><td><code id="rsem_+3A_eqsdata">eqsdata</code></td>
<td>
<p>Data file name used in EQS</p>
</td></tr>
<tr><td><code id="rsem_+3A_eqsweight">eqsweight</code></td>
<td>
<p>File name for weight matrix</p>
</td></tr>
<tr><td><code id="rsem_+3A_eqspgm">EQSpgm</code></td>
<td>
<p>The path to the installed EQS program</p>
</td></tr>
<tr><td><code id="rsem_+3A_serial">serial</code></td>
<td>
<p>The serial no of EQS</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will run the robust analysis and output results.
</p>


<h3>Value</h3>

<p>If <code>EQSmodel</code> is not supplied
</p>
<table>
<tr><td><code>sem</code></td>
<td>
<p>Information for SEM analysis including estimated means, covariance matrix and their sandwich type covariance matrix in the order of mean first and then covariance matrix.</p>
</td></tr>
<tr><td><code>misinfo</code></td>
<td>
<p>Information related to missing data pattern</p>
</td></tr>
<tr><td><code>em</code></td>
<td>
<p>Results from expectation robust algorithm</p>
</td></tr>
<tr><td><code>ascov</code></td>
<td>
<p>Covariance matrix</p>
</td></tr>
</table>
<p>If <code>EQSmodel</code> is supplied,   
</p>
<table>
<tr><td><code>sem</code></td>
<td>
<p>Information for SEM analysis including estimated means, covariance matrix and their sandwich type covariance matrix according to the requirement of EQS.</p>
</td></tr>
</table>
<p>In addition, the following model parameters are from EQS  
</p>
<table>
<tr><td><code>fit.stat</code></td>
<td>
<p>Fit indices and associated p-values</p>
</td></tr>
<tr><td><code>para</code></td>
<td>
<p>Parameter estimates</p>
</td></tr>
<tr><td><code>eqs</code></td>
<td>
<p>All information from REQS</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsem.pattern">rsem.pattern</a></code>, <code><a href="#topic+rsem.emmusig">rsem.emmusig</a></code>, <code><a href="#topic+rsem.Ascov">rsem.Ascov</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## an example
 ## to use eqs, first load the package semdiag
 library(semdiag)
 data(mardiamv25)
 analysis&lt;-rsem(mardiamv25, c(1,2,4,5), 'eqsinput.eqs')
 
## End(Not run)
</code></pre>

<hr>
<h2 id='rsem.Ascov'>
Sandwich-type covariance matrix 
</h2><span id='topic+rsem.Ascov'></span>

<h3>Description</h3>

<p>Returns the sandwich type covariance matrix. This function is not intended to use seperately from the <code>rsem.emmusig</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.Ascov(xpattern, musig, varphi=.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.Ascov_+3A_xpattern">xpattern</code></td>
<td>

<p>Missing data pattern output from <code>rsem.pattern</code>. 
</p>
</td></tr>
<tr><td><code id="rsem.Ascov_+3A_musig">musig</code></td>
<td>

<p>Robust mean and covariance matrix from <code>rsem.emmusig</code>
</p>
</td></tr>
<tr><td><code id="rsem.Ascov_+3A_varphi">varphi</code></td>
<td>

<p>Proportion of data to be down-weighted. Default is 0.1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data should be a matrix. To change a data frame to a matrix, using data.matrix(x).
</p>


<h3>Value</h3>

<table>
<tr><td><code>Abeta</code></td>
<td>
<p>A matrix</p>
</td></tr>
<tr><td><code>Bbeta</code></td>
<td>
<p>B matrix</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>Sandwich type covariance matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsem.emmusig">rsem.emmusig</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#dset&lt;-read.table('MardiaMV25.dat.txt', na.string='-99')  
#dset&lt;-data.matrix(dset)                                  
#n&lt;-dim(dset)[1]
#p&lt;-dim(dset)[2]
#miss_pattern&lt;-rsem.pattern(n,p,dset)
#misinfo&lt;-miss_pattern$misinfo
#V_forana&lt;-c(1,2,4,5)
#em_results&lt;-rsem.emmusig(dset,misinfo)
#hmu1&lt;-em_results$mu                           
#hsigma1&lt;-em_results$sigma
#rsem.Ascov(x, hmu1, hsigma1)
</code></pre>

<hr>
<h2 id='rsem.DP'>
Generate a duplication matrix
</h2><span id='topic+rsem.DP'></span>

<h3>Description</h3>

<p>Generate a duplication matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.DP(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.DP_+3A_x">x</code></td>
<td>

<p>A matrix
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-array(1:6, c(2,3))
rsem.DP(x)
</code></pre>

<hr>
<h2 id='rsem.emmusig'>
Robust mean and covariance matrix using Huber-type weight
</h2><span id='topic+rsem.emmusig'></span>

<h3>Description</h3>

<p>Robust mean and covariance matrix using Huber-type weight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.emmusig(xpattern, varphi=.1, max.it=1000, st='i')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.emmusig_+3A_xpattern">xpattern</code></td>
<td>

<p>Missing data pattern output from <code>rsem.pattern</code>. 
</p>
</td></tr>
<tr><td><code id="rsem.emmusig_+3A_varphi">varphi</code></td>
<td>

<p>Proportion of data to be down-weighted. Default is 0.1.
</p>
</td></tr>
<tr><td><code id="rsem.emmusig_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations for EM. Default is 1000</p>
</td></tr>
<tr><td><code id="rsem.emmusig_+3A_st">st</code></td>
<td>
<p>Starting values for EM algorithm. The default is 0 for mean and I for covariance. Alternative, the starting values can be estimated according to MCD.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimate mean and covariance matrix using the expectation robust (ER) algorithm.
</p>


<h3>Value</h3>

<table>
<tr><td><code>err</code></td>
<td>
<p>Error code. 0: good. 1: maximum iterations are exceeded.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Mean vector</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Covariance matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsem.emmusig">rsem.emmusig</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#dset&lt;-read.table('MardiaMV25.dat.txt', na.string='-99')  
#dset&lt;-data.matrix(dset)                                  
#n&lt;-dim(dset)[1]
#p&lt;-dim(dset)[2]
#miss_pattern&lt;-rsem.pattern(n,p,dset)
#misinfo&lt;-miss_pattern$misinfo
#V_forana&lt;-c(1,2,4,5)
#em_results&lt;-rsem.emmusig(dset,misinfo)
#em_results
</code></pre>

<hr>
<h2 id='rsem.fit'>
Calculate robust test statistics
</h2><span id='topic+rsem.fit'></span>

<h3>Description</h3>

<p>Calculate robust test statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.fit(object, gamma, musig)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.fit_+3A_object">object</code></td>
<td>

<p>Output from lavaan analysis, such as growth, factor, sem functions.
</p>
</td></tr>
<tr><td><code id="rsem.fit_+3A_gamma">gamma</code></td>
<td>

<p>Robust covariance matrix for saturated mean and covariances
</p>
</td></tr>
<tr><td><code id="rsem.fit_+3A_musig">musig</code></td>
<td>

<p>Robust saturated mean and covariances
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-array(1:6, c(2,3))
rsem.vec(x)
</code></pre>

<hr>
<h2 id='rsem.gname'>
Internal function
</h2><span id='topic+rsem.gname'></span>

<h3>Description</h3>

<p>Internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.gname(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.gname_+3A_name">name</code></td>
<td>

<p>Variable names.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>

<hr>
<h2 id='rsem.index'>
rsem.index function
</h2><span id='topic+rsem.index'></span>

<h3>Description</h3>

<p>To be added
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.index(p, oj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.index_+3A_p">p</code></td>
<td>
<p>number of variables</p>
</td></tr>
<tr><td><code id="rsem.index_+3A_oj">oj</code></td>
<td>
<p>observed variables</p>
</td></tr>
</table>

<hr>
<h2 id='rsem.indexv'>
rsem.indexv function
</h2><span id='topic+rsem.indexv'></span>

<h3>Description</h3>

<p>Internal function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.indexv(p, select)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.indexv_+3A_p">p</code></td>
<td>
<p>number of variables</p>
</td></tr>
<tr><td><code id="rsem.indexv_+3A_select">select</code></td>
<td>
<p>variables to be used</p>
</td></tr>
</table>

<hr>
<h2 id='rsem.indexvc'>
rsem.indexvc function
</h2><span id='topic+rsem.indexvc'></span>

<h3>Description</h3>

<p>Internal function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.indexvc(p, select)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.indexvc_+3A_p">p</code></td>
<td>
<p>number of variables</p>
</td></tr>
<tr><td><code id="rsem.indexvc_+3A_select">select</code></td>
<td>
<p>variables to be used</p>
</td></tr>
</table>

<hr>
<h2 id='rsem.lavaan'>
Conduct robust SEM analysis using lavaan
</h2><span id='topic+rsem.lavaan'></span>

<h3>Description</h3>

<p>Conduct robust SEM analysis using lavaan
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.lavaan(dset, model, select,  varphi=.1, max.it=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.lavaan_+3A_dset">dset</code></td>
<td>

<p>A data matrix or a data frame
</p>
</td></tr>
<tr><td><code id="rsem.lavaan_+3A_select">select</code></td>
<td>

<p>Variables to be seleted for SEM analysis. If omitted, all variables in the data set will be used.
</p>
</td></tr>
<tr><td><code id="rsem.lavaan_+3A_model">model</code></td>
<td>

<p>The model using lavaan syntax
</p>
</td></tr>
<tr><td><code id="rsem.lavaan_+3A_varphi">varphi</code></td>
<td>

<p>Proportion of data to be down-weighted. Default is 0.1.
</p>
</td></tr>
<tr><td><code id="rsem.lavaan_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations for EM. Default is 1000</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will run the robust analysis and output results.
</p>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Yuan, K.-H., &amp; Zhang, Z. (2012). Robust Structural Equation Modeling with Missing Data and Auxiliary Variables. Psychometrika, 77(4), 803-826.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsem.pattern">rsem.pattern</a></code>, <code><a href="#topic+rsem.emmusig">rsem.emmusig</a></code>, <code><a href="#topic+rsem.Ascov">rsem.Ascov</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 data(mardiamv25)
 names(mardiamv25)&lt;-paste('V', 1:5, sep='')
 
 fa.model&lt;-'f1 =~ V1 + V2
f2 =~ V4 + V5 
f1 ~ 1
f2 ~ 1
V1 ~0*1
V2 ~0*1
V4 ~0*1
V5 ~0*1'

 analysis&lt;-rsem.lavaan(mardiamv25, fa.model, c(1,2,4,5))
</code></pre>

<hr>
<h2 id='rsem.pattern'>
Obtaining missing data patterns
</h2><span id='topic+rsem.pattern'></span>

<h3>Description</h3>

<p>This function obtains the missing data patterns and the number of cases in each patterns. It also tells the number of observed variables and their indices for each pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.pattern(x, print=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.pattern_+3A_x">x</code></td>
<td>

<p>A matrix as data
</p>
</td></tr>
<tr><td><code id="rsem.pattern_+3A_print">print</code></td>
<td>

<p>Whether to print the missing data pattern. The default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The missing data pattern matrix has 2+p columns. The first column is the number cases in that pattern. The second column is the number of observed variables. The last p columns are a matrix with 1 denoting observed data and 0 denoting missing data. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>Data ordered according to missing data pattern</p>
</td></tr>
<tr><td><code>misinfo</code></td>
<td>
<p>Missing data pattern matrix</p>
</td></tr>
<tr><td><code>mispat</code></td>
<td>
<p>Missing data pattern in better readable form.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#dset&lt;-read.table('MardiaMV25.dat.txt', na.string='-99')  
#dset&lt;-data.matrix(dset)                                  
#n&lt;-dim(dset)[1]
#p&lt;-dim(dset)[2]
#miss_pattern&lt;-rsem.pattern(n,p,dset)
#miss_pattern
</code></pre>

<hr>
<h2 id='rsem.print'>
Organize the output for Lavaan with robust s.e. and test statistics
</h2><span id='topic+rsem.print'></span>

<h3>Description</h3>

<p>Organize the output for Lavaan with robust s.e. and test statistics. Modified from the print function of Lavaan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.print(object, robust.se, robust.fit, estimates=TRUE, fit.measures=FALSE, 
standardized=FALSE, rsquare=FALSE, std.nox=FALSE, modindices=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.print_+3A_object">object</code></td>
<td>

<p>Output from lavaan analysis, such as growth, factor, sem functions.
</p>
</td></tr>
<tr><td><code id="rsem.print_+3A_robust.se">robust.se</code></td>
<td>

<p>Robust standard error from the function rsem.se
</p>
</td></tr>
<tr><td><code id="rsem.print_+3A_robust.fit">robust.fit</code></td>
<td>
<p>Robust fit statistics from the function rsem.fit</p>
</td></tr>
<tr><td><code id="rsem.print_+3A_estimates">estimates</code></td>
<td>

<p>Show parameter estimates
</p>
</td></tr>
<tr><td><code id="rsem.print_+3A_fit.measures">fit.measures</code></td>
<td>

<p>Show fit statistics of lavaan (no need for it)
</p>
</td></tr>
<tr><td><code id="rsem.print_+3A_standardized">standardized</code></td>
<td>
<p>standardized coefficients</p>
</td></tr>
<tr><td><code id="rsem.print_+3A_rsquare">rsquare</code></td>
<td>
<p>R square for dependent variables.</p>
</td></tr>
<tr><td><code id="rsem.print_+3A_std.nox">std.nox</code></td>
<td>
<p>to add</p>
</td></tr>
<tr><td><code id="rsem.print_+3A_modindices">modindices</code></td>
<td>
<p>Modification indices</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will run the robust analysis and output results.
</p>


<h3>Value</h3>

<p>If <code>EQSmodel</code> is not supplied
</p>
<table>
<tr><td><code>sem</code></td>
<td>
<p>Information for SEM analysis including estimated means, covariance matrix and their sandwich type covariance matrix in the order of mean first and then covariance matrix.</p>
</td></tr>
<tr><td><code>misinfo</code></td>
<td>
<p>Information related to missing data pattern</p>
</td></tr>
<tr><td><code>em</code></td>
<td>
<p>Results from expectation robust algorithm</p>
</td></tr>
<tr><td><code>ascov</code></td>
<td>
<p>Covariance matrix</p>
</td></tr>
</table>
<p>If <code>EQSmodel</code> is supplied,   
</p>
<table>
<tr><td><code>sem</code></td>
<td>
<p>Information for SEM analysis including estimated means, covariance matrix and their sandwich type covariance matrix according to the requirement of EQS.</p>
</td></tr>
</table>
<p>In addition, the following model parameters are from EQS  
</p>
<table>
<tr><td><code>fit.stat</code></td>
<td>
<p>Fit indices and associated p-values</p>
</td></tr>
<tr><td><code>para</code></td>
<td>
<p>Parameter estimates</p>
</td></tr>
<tr><td><code>eqs</code></td>
<td>
<p>All information from REQS</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsem.pattern">rsem.pattern</a></code>, <code><a href="#topic+rsem.emmusig">rsem.emmusig</a></code>, <code><a href="#topic+rsem.Ascov">rsem.Ascov</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##\dontrun{
## an example
 data(mardiamv25)
 names(mardiamv25)&lt;-paste('V', 1:5, sep='')
 
 fa.model&lt;-'f1 =~ V1 + V2
f2 =~ V4 + V5 
f1 ~ 1
f2 ~ 1
V1 ~0*1
V2 ~0*1
V4 ~0*1
V5 ~0*1'

pat&lt;-rsem.pattern(mardiamv25)

phi&lt;-0.1
musig&lt;-rsem.emmusig(pat, varphi=phi)

res.lavaan&lt;-sem(fa.model, sample.cov=musig$sigma, sample.mean=musig$mu, sample.nobs=88,mimic='EQS')

ascov&lt;-rsem.Ascov(pat, musig, varphi=phi)

robust.se&lt;-rsem.se(res.lavaan, ascov$Gamma)

robust.fit &lt;- rsem.fit(res.lavaan, ascov$Gamma, musig)

rsem.print(res.lavaan, robust.se, robust.fit)
## }
</code></pre>

<hr>
<h2 id='rsem.se'>
Calculate robust standard errors
</h2><span id='topic+rsem.se'></span>

<h3>Description</h3>

<p>Calculate robust standard errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.se(object, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.se_+3A_object">object</code></td>
<td>

<p>Output from lavaan analysis, such as growth, factor, sem functions.
</p>
</td></tr>
<tr><td><code id="rsem.se_+3A_gamma">gamma</code></td>
<td>

<p>Robust covariance matrix for saturated mean and covariances
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-array(1:6, c(2,3))
rsem.vec(x)
</code></pre>

<hr>
<h2 id='rsem.ssq'>
Calculate the squared sum of a matrix
</h2><span id='topic+rsem.ssq'></span>

<h3>Description</h3>

<p>Calculate the squared sum of a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.ssq(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.ssq_+3A_x">x</code></td>
<td>

<p>A matrix
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-array(1:6, c(2,3))
rsem.ssq(x)
</code></pre>

<hr>
<h2 id='rsem.switch'>
swith function
</h2><span id='topic+rsem.switch'></span>

<h3>Description</h3>

<p>swith function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.switch(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.switch_+3A_p">p</code></td>
<td>
<p>number of variables</p>
</td></tr>
</table>

<hr>
<h2 id='rsem.switch.gamma'>
Internal function
</h2><span id='topic+rsem.switch.gamma'></span>

<h3>Description</h3>

<p>Internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.switch.gamma(gamma, ov.names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.switch.gamma_+3A_gamma">gamma</code></td>
<td>

<p>Robust covariance matrix for saturated mean and covariances
</p>
</td></tr>
<tr><td><code id="rsem.switch.gamma_+3A_ov.names">ov.names</code></td>
<td>

<p>Observed variable names.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>

<hr>
<h2 id='rsem.vec'>
Stacking a matrix to a vector
</h2><span id='topic+rsem.vec'></span>

<h3>Description</h3>

<p>Stacking a matrix to a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.vec(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.vec_+3A_x">x</code></td>
<td>

<p>A matrix
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-array(1:6, c(2,3))
rsem.vec(x)
</code></pre>

<hr>
<h2 id='rsem.vech'>
Stacking lower triange of a matrix to a vector
</h2><span id='topic+rsem.vech'></span>

<h3>Description</h3>

<p>Stacking lower triange of a matrix to a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.vech(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.vech_+3A_x">x</code></td>
<td>

<p>A matrix
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang
</p>


<h3>References</h3>

<p>Ke-Hai Yuan and Zhiyong Zhang (2011) Robust Structural Equation Modeling with Missing Data and Auxiliary Variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-array(1:9, c(3,3))
rsem.vec(x)
</code></pre>

<hr>
<h2 id='rsem.weight'>
Calculate weight for each subject
</h2><span id='topic+rsem.weight'></span>

<h3>Description</h3>

<p>Calculate weight for each subject in estimating the mean and covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsem.weight(x, varphi, mu0, sig0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsem.weight_+3A_x">x</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="rsem.weight_+3A_varphi">varphi</code></td>
<td>

<p>Downweight rate.
</p>
</td></tr>
<tr><td><code id="rsem.weight_+3A_mu0">mu0</code></td>
<td>

<p>Robust mean
</p>
</td></tr>
<tr><td><code id="rsem.weight_+3A_sig0">sig0</code></td>
<td>

<p>Robust covariance matrix.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>w1</code></td>
<td>
<p>Weight for robust mean estimates</p>
</td></tr>
<tr><td><code>w2</code></td>
<td>
<p>Weight for robust covariance estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhiyong Zhang and Ke-Hai Yuan
</p>


<h3>References</h3>

<p>Yuan, K.-H., &amp; Zhang, Z. (2012). Robust Structural Equation Modeling with Missing Data and Auxiliary Variables. Psychometrika, 77(4), 803-826.
</p>

<hr>
<h2 id='semdiag.combinations'>Enumerate the Combinations of the Elements of a Vector</h2><span id='topic+semdiag.combinations'></span>

<h3>Description</h3>

<p>Enumerate the Combinations of the Elements of a Vector</p>


<h3>Usage</h3>

<pre><code class='language-R'>semdiag.combinations(n, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="semdiag.combinations_+3A_n">n</code></td>
<td>
<p> Size of the source vector </p>
</td></tr>
<tr><td><code id="semdiag.combinations_+3A_r">r</code></td>
<td>
<p> Size of the target vectors </p>
</td></tr>  
</table>

<hr>
<h2 id='semdiag.read.eqs'>Import of EQS outputs into R</h2><span id='topic+semdiag.read.eqs'></span>

<h3>Description</h3>

<p>This function reads EQS output files (.ets, .CBK and .ETP) into R and stores the results as objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semdiag.read.eqs(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="semdiag.read.eqs_+3A_file">file</code></td>
<td>
<p>The name (string) of the .ets file or the full path which the data are to be read from. If it does not contain an absolute path, the file name is relative to the current working directory, 'getwd()'. A .CBK and .ETP file have to be of the same name and in the same directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value list below provides objects for the full EQS output. If in EQS some objects are not computed, the corresponding values in R are <code>NA</code>.
</p>


<h3>Value</h3>

<p>Returns a list with the following objects:
</p>
<table>
<tr><td><code>model.info</code></td>
<td>
<p>General model information</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>p-values for various test statistics</p>
</td></tr>
<tr><td><code>fit.indices</code></td>
<td>
<p>Variuos fit indices</p>
</td></tr>
<tr><td><code>model.desc</code></td>
<td>
<p>Descriptive measures</p>
</td></tr>
<tr><td><code>Phi</code></td>
<td>
<p>Phi matrix</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>Gamma matrix</p>
</td></tr>
<tr><td><code>Beta</code></td>
<td>
<p>Beta matrix</p>
</td></tr>
<tr><td><code>par.table</code></td>
<td>
<p>Parameter table (with standard errors)</p>
</td></tr>
<tr><td><code>sample.cov</code></td>
<td>
<p>Sample covariance matrix</p>
</td></tr>
<tr><td><code>sigma.hat</code></td>
<td>
<p>Model covariance matrix</p>
</td></tr>
<tr><td><code>inv.infmat</code></td>
<td>
<p>Inverse information matrix</p>
</td></tr>
<tr><td><code>rinv.infmat</code></td>
<td>
<p>Robust inverse information matrix</p>
</td></tr>
<tr><td><code>cinv.infmat</code></td>
<td>
<p>Corrected inverse information matrix</p>
</td></tr>
<tr><td><code>derivatives</code></td>
<td>
<p>First derivatives</p>
</td></tr>
<tr><td><code>moment4</code></td>
<td>
<p>Matrix with 4th moments</p>
</td></tr>
<tr><td><code>ssolution</code></td>
<td>
<p>Standardized elements</p>
</td></tr>
<tr><td><code>Rsquared</code></td>
<td>
<p>R-squared measures</p>
</td></tr>
<tr><td><code>fac.means</code></td>
<td>
<p>Factor means</p>
</td></tr>
<tr><td><code>var.desc</code></td>
<td>
<p>Descriptive measures for the variables (univariate statistics)</p>
</td></tr>
<tr><td><code>indstd</code></td>
<td>
<p>Independent variable standardization vector</p>
</td></tr>
<tr><td><code>depstd</code></td>
<td>
<p>Dependent variable standardization vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Patrick Mair, Eric Wu</p>


<h3>References</h3>

<p>Bentler, P. M. (2008). EQS Program Manual. Encino, CA: Multivariate Software Inc.</p>


<h3>See Also</h3>

<p><code><a href="#topic+semdiag.call.eqs">semdiag.call.eqs</a></code>, <code><a href="#topic+semdiag.run.eqs">semdiag.run.eqs</a></code>
</p>

<hr>
<h2 id='semdiag.run.eqs'>Run EQS from R</h2><span id='topic+semdiag.run.eqs'></span><span id='topic+semdiag.call.eqs'></span>

<h3>Description</h3>

<p>Calls an EQS script file from R, executes EQS, and imports the results into R. Basically
it is a wrapper function of <code>call.eqs</code> and the subsequent <code>read.eqs</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semdiag.run.eqs(EQSpgm, EQSmodel, serial, Rmatrix = NA, datname = NA, LEN = 2000000)
semdiag.call.eqs(EQSpgm, EQSmodel, serial, Rmatrix = NA, datname = NA, LEN = 2000000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="semdiag.run.eqs_+3A_eqspgm">EQSpgm</code></td>
<td>
<p>String containing path where EQS is located (see details)</p>
</td></tr>
<tr><td><code id="semdiag.run.eqs_+3A_eqsmodel">EQSmodel</code></td>
<td>
<p>String containing path where .eqs script file is located (see details)</p>
</td></tr>
<tr><td><code id="semdiag.run.eqs_+3A_serial">serial</code></td>
<td>
<p>EQS serial number as integer value</p>
</td></tr>
<tr><td><code id="semdiag.run.eqs_+3A_rmatrix">Rmatrix</code></td>
<td>
<p>Optional matrix argument if data or covariances are stored in R</p>
</td></tr>
<tr><td><code id="semdiag.run.eqs_+3A_datname">datname</code></td>
<td>
<p>If <code>data</code> is specified, a filename (string) must be provided for saving the data in text format (blank separated; see details)</p>
</td></tr>
<tr><td><code id="semdiag.run.eqs_+3A_len">LEN</code></td>
<td>
<p>Integer containing number of working array units. By default, it is 2000000 8 bytes units</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the path in <code>EQSpgm</code> and <code>EQSmodel</code> contains a blank, single quotes and double quotes
are required in argument. See <code>EQSpgm</code> argument in examples. The last statement in the <code>EQSpgm</code> argument refers 
to the name of the executable program file. Under Windows it is <code>".../WINEQS"</code> (referring to WINEQS.exe), under Mac <code>".../MACEQS"</code> and 
under Linux <code>".../EQS"</code>. When specifying the path, use slash instead of backslash. 
</p>
<p>The .ETS, .CBK and .ETP files are written in the directory where the .eqs file is located. 
Note that these 3 files must be in the same directory than the .eqs file. 
</p>
<p>The argument <code>datname</code> must match with the input data specified in the corresponding .eqs file. 
This option can be used for simulations: Generate data in R, <code>run.eqs()</code> on with the corresponding
<code>data</code> argument, pick out the relevant return values.
</p>
<p>The value list below provides objects for the full EQS output. If in EQS some objects are not computed, the corresponding values in R are <code>NA</code>.
</p>


<h3>Value</h3>

<p>Returns a list with the following objects:
</p>
<table>
<tr><td><code>success</code></td>
<td>
<p><code>TRUE</code> if estimation was successful, <code>FALSE</code> otherwise</p>
</td></tr>
<tr><td><code>model.info</code></td>
<td>
<p>General model information</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>p-values for various test statistics</p>
</td></tr>
<tr><td><code>fit.indices</code></td>
<td>
<p>Variuos fit indices</p>
</td></tr>
<tr><td><code>model.desc</code></td>
<td>
<p>Descriptive measures</p>
</td></tr>
<tr><td><code>Phi</code></td>
<td>
<p>Phi matrix</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>Gamma matrix</p>
</td></tr>
<tr><td><code>Beta</code></td>
<td>
<p>Beta matrix</p>
</td></tr>
<tr><td><code>par.table</code></td>
<td>
<p>Parameter table (with standard errors)</p>
</td></tr>
<tr><td><code>sample.cov</code></td>
<td>
<p>Sample covariance matrix</p>
</td></tr>
<tr><td><code>sigma.hat</code></td>
<td>
<p>Model covariance matrix</p>
</td></tr>
<tr><td><code>inv.infmat</code></td>
<td>
<p>Inverse information matrix</p>
</td></tr>
<tr><td><code>rinv.infmat</code></td>
<td>
<p>Robust inverse information matrix</p>
</td></tr>
<tr><td><code>cinv.infmat</code></td>
<td>
<p>Corrected inverse information matrix</p>
</td></tr>
<tr><td><code>derivatives</code></td>
<td>
<p>First derivatives</p>
</td></tr>
<tr><td><code>moment4</code></td>
<td>
<p>Matrix with 4th moments</p>
</td></tr>
<tr><td><code>ssolution</code></td>
<td>
<p>Standardized elements</p>
</td></tr>
<tr><td><code>Rsquared</code></td>
<td>
<p>R-squared measures</p>
</td></tr>
<tr><td><code>fac.means</code></td>
<td>
<p>Factor means</p>
</td></tr>
<tr><td><code>var.desc</code></td>
<td>
<p>Descriptive measures for the variables (univariate statistics)</p>
</td></tr>
<tr><td><code>indstd</code></td>
<td>
<p>Independent variable standardization vector</p>
</td></tr>
<tr><td><code>depstd</code></td>
<td>
<p>Dependent variable standardization vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Patrick Mair, Eric Wu</p>


<h3>References</h3>

<p>Bentler, P. M. (1995). EQS Program Manual. Encino, CA: Multivariate Software Inc.</p>


<h3>See Also</h3>

<p><code><a href="#topic+semdiag.read.eqs">semdiag.read.eqs</a></code>, <code><a href="#topic+semdiag.call.eqs">semdiag.call.eqs</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
