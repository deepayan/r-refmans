<!DOCTYPE html><html lang="en"><head><title>Help for package outliers</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {outliers}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chisq.out.test'><p> Chi-squared test for outlier</p></a></li>
<li><a href='#cochran.test'><p> Test for outlying or inlying variance</p></a></li>
<li><a href='#dixon.test'><p> Dixon tests for outlier</p></a></li>
<li><a href='#grubbs.test'><p> Grubbs tests for one or two outliers in data sample</p></a></li>
<li><a href='#outlier'><p> Find value with largest difference from the mean</p></a></li>
<li><a href='#qcochran'><p> Critical values and p-values for Cochran outlying variance test</p></a></li>
<li><a href='#qdixon'><p> critical values and p-values for Dixon tests</p></a></li>
<li><a href='#qgrubbs'><p> Calculate critical values and p-values for Grubbs tests</p></a></li>
<li><a href='#qtable'><p> Interpolate tabularized distribution</p></a></li>
<li><a href='#rm.outlier'><p> Remove the value(s) most differing from the mean</p></a></li>
<li><a href='#scores'><p> Calculate scores of the sample</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.15</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-26</td>
</tr>
<tr>
<td>Title:</td>
<td>Tests for Outliers</td>
</tr>
<tr>
<td>Author:</td>
<td>Lukasz Komsta &lt;lukasz.komsta@umlub.pl&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lukasz Komsta &lt;lukasz.komsta@umlub.pl&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of some tests commonly used for identifying
        outliers.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.R-project.org">https://www.R-project.org</a>, <a href="http://www.komsta.net/">http://www.komsta.net/</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-26 08:10:08 UTC; root</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-26 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='chisq.out.test'> Chi-squared test for outlier </h2><span id='topic+chisq.out.test'></span>

<h3>Description</h3>

<p>Performs a chisquared test for detection of one outlier in a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.out.test(x, variance=var(x), opposite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chisq.out.test_+3A_x">x</code></td>
<td>
<p> a numeric vector for data values. </p>
</td></tr>
<tr><td><code id="chisq.out.test_+3A_variance">variance</code></td>
<td>
<p> known variance of population. if not given, estimator from sample is taken,
but there is not so much sense in such test (it is similar to z-scores) </p>
</td></tr>
<tr><td><code id="chisq.out.test_+3A_opposite">opposite</code></td>
<td>
<p>  a logical indicating whether you want to check not the value with 
largest difference from the mean, but opposite (lowest, if most suspicious is highest etc.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a simple test for one outlier, based on chisquared distribution of squared
differences between data and sample mean. It assumes known variance of population. 
It is rather not recommended today for routine use, because several more powerful 
tests are implemented (see other functions mentioned below). 
It was discussed by Dixon (1950) for the first time, as one of the tests taken into account by him.
</p>


<h3>Value</h3>

<p>A list with class <code>htest</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of chisquared-statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>name of the data argument.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>This test is known to reject only extreme outliers, if no known variance is specified.
</p>


<h3>Author(s)</h3>

<p> Lukasz Komsta </p>


<h3>References</h3>

 
<p>Dixon, W.J. (1950). Analysis of extreme values. Ann. Math. Stat. 21, 4, 488-506.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+dixon.test">dixon.test</a></code>, <code><a href="#topic+grubbs.test">grubbs.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234)
x = rnorm(10)
chisq.out.test(x)
chisq.out.test(x,opposite=TRUE)

</code></pre>

<hr>
<h2 id='cochran.test'> Test for outlying or inlying variance </h2><span id='topic+cochran.test'></span>

<h3>Description</h3>

<p>This test is useful to check if largest variance in several groups of
data is &quot;outlying&quot; and this group should be rejected. Alternatively,
if one group has very small variance, we can test for &quot;inlying&quot; variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cochran.test(object, data, inlying = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cochran.test_+3A_object">object</code></td>
<td>
<p> A vector of variances or formula. </p>
</td></tr>
<tr><td><code id="cochran.test_+3A_data">data</code></td>
<td>
<p> If object is a vector, data should be another vector, giving number of data in
each corresponding group. If object is a formula, data should be a dataframe.</p>
</td></tr>
<tr><td><code id="cochran.test_+3A_inlying">inlying</code></td>
<td>
<p> Test smallest variance instead of largest.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The corresponding p-value is calculated using <code>pcochran</code> function.
</p>


<h3>Value</h3>

<p>A list with class <code>htest</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of Cochran-statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>name of the data argument.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>vector of variance estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Lukasz Komsta </p>


<h3>References</h3>

<p>Snedecor, G.W., Cochran, W.G. (1980). Statistical Methods (seventh edition).
Iowa State University Press, Ames, Iowa.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+qcochran">qcochran</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x=rnorm(100)
d=data.frame(x=x,group=rep(1:10,10))
cochran.test(x~group,d)
cochran.test(x~group,d,inlying=TRUE)
x=runif(5)
cochran.test(x,rep(5,5))
cochran.test(x,rep(100,5))
</code></pre>

<hr>
<h2 id='dixon.test'> Dixon tests for outlier </h2><span id='topic+dixon.test'></span>

<h3>Description</h3>

<p>Performs several variants of Dixon test for detecting outlier in data sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dixon.test(x, type = 0, opposite = FALSE, two.sided = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dixon.test_+3A_x">x</code></td>
<td>
<p> a numeric vector for data values. </p>
</td></tr>
<tr><td><code id="dixon.test_+3A_opposite">opposite</code></td>
<td>
<p>  a logical indicating whether you want to check not the value with 
largest difference from the mean, but opposite (lowest, if most suspicious is highest etc.)</p>
</td></tr>
<tr><td><code id="dixon.test_+3A_type">type</code></td>
<td>
<p> an integer specyfying the variant of test to be performed. Possible values are
compliant with these given by Dixon (1950): 10, 11, 12, 20, 21. If this value is set to zero,
a variant of the test is chosen according to sample size (10 for 3-7, 11 for 8-10, 21 for 11-13, 
22 for 14 and more). The lowest or highest value is selected automatically, and can be reversed
used <code>opposite</code> parameter.
</p>
</td></tr>
<tr><td><code id="dixon.test_+3A_two.sided">two.sided</code></td>
<td>
<p> treat test as two-sided (default). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The p-value is calculating by interpolation using <code><a href="#topic+qdixon">qdixon</a></code> and <code><a href="#topic+qtable">qtable</a></code>.
According to Dixon (1951) conclusions, the critical values can be obtained numerically only for n=3.
Other critical values are obtained by simulations, taken from original Dixon's paper, and
regarding corrections given by Rorabacher (1991).
</p>


<h3>Value</h3>

<p>A list with class <code>htest</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of Dixon Q-statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>name of the data argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Lukasz Komsta </p>


<h3>References</h3>

 
<p>Dixon, W.J. (1950). Analysis of extreme values. Ann. Math. Stat. 21, 4, 488-506.
</p>
<p>Dixon, W.J. (1951). Ratios involving extreme values. Ann. Math. Stat. 22, 1, 68-78.
</p>
<p>Rorabacher, D.B. (1991). Statistical Treatment for Rejection of Deviant Values: Critical Values of Dixon Q Parameter and Related Subrange Ratios at the 95 percent Confidence Level. Anal. Chem. 83, 2, 139-146.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+chisq.out.test">chisq.out.test</a></code>, <code><a href="#topic+grubbs.test">grubbs.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234)
x = rnorm(10)
dixon.test(x)
dixon.test(x,opposite=TRUE)
dixon.test(x,type=10)

</code></pre>

<hr>
<h2 id='grubbs.test'> Grubbs tests for one or two outliers in data sample</h2><span id='topic+grubbs.test'></span>

<h3>Description</h3>

<p>Performs Grubbs' test for one outlier, two outliers on one tail,
or two outliers on opposite tails, in small sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grubbs.test(x, type = 10, opposite = FALSE, two.sided = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="grubbs.test_+3A_x">x</code></td>
<td>
<p> a numeric vector for data values. </p>
</td></tr>
<tr><td><code id="grubbs.test_+3A_opposite">opposite</code></td>
<td>
<p>  a logical indicating whether you want to check not the value with 
largest difference from the mean, but opposite (lowest, if most suspicious is highest etc.)</p>
</td></tr>
<tr><td><code id="grubbs.test_+3A_type">type</code></td>
<td>
<p> Integer value indicating test variant. 10 is a test for one outlier (side is
detected automatically and can be reversed by <code>opposite</code> parameter). 11 is a test
for two outliers on opposite tails, 20 is test for two outliers in one tail.  </p>
</td></tr>
<tr><td><code id="grubbs.test_+3A_two.sided">two.sided</code></td>
<td>
<p> Logical value indicating if there is a need to treat this test as two-sided. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can perform three tests given and discussed by Grubbs (1950).
</p>
<p>First test (10) is used to detect if the sample dataset contains one outlier, statistically different than the other values.
Test is based by calculating score of this outlier G (outlier minus mean and divided by sd) and
comparing it to appropriate critical values. Alternative method is calculating ratio of variances
of two datasets - full dataset and dataset without outlier. The obtained value called U is bound
with G by simple formula.
</p>
<p>Second test (11) is used to check if lowest and highest value are two outliers on opposite tails
of sample. It is based on calculation of ratio of range to standard deviation of the sample. 
</p>
<p>Third test (20) calculates ratio of variance of full sample and sample without two extreme observations.
It is used to detect if dataset contains two outliers on the same tail.
</p>
<p>The p-values are calculated using <code><a href="#topic+qgrubbs">qgrubbs</a></code> function.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value statistic. For type 10 it is difference between outlier and
the mean divided by standard deviation, and for type 20 it is sample range divided
by standard deviation. Additional value U is ratio of sample variances with and withour suspicious outlier.
According to Grubbs (1950) these values for type 10 are bound by simple formula and only one of them
can be used, but function gives both. For type 20 the G is the same as U.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>name of the data argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Lukasz Komsta </p>


<h3>References</h3>

 
<p>Grubbs, F.E. (1950). Sample Criteria for testing outlying observations. Ann. Math. Stat. 21, 1, 27-58.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+dixon.test">dixon.test</a></code>, <code><a href="#topic+chisq.out.test">chisq.out.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234)
x = rnorm(10)
grubbs.test(x)
grubbs.test(x,type=20)
grubbs.test(x,type=11)

</code></pre>

<hr>
<h2 id='outlier'> Find value with largest difference from the mean </h2><span id='topic+outlier'></span>

<h3>Description</h3>

<p>Finds value with largest difference between it and sample mean, which can be an outlier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outlier(x, opposite = FALSE, logical = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="outlier_+3A_x">x</code></td>
<td>
<p> a data sample, vector in most cases. If argument is a dataframe, then outlier is calculated for
each column by <code>sapply</code>. The same behavior is applied by <code>apply</code> when the matrix is given.
</p>
</td></tr>
<tr><td><code id="outlier_+3A_opposite">opposite</code></td>
<td>
<p> if set to TRUE, gives opposite value (if largest value has maximum difference
from the mean, it gives smallest and vice versa)</p>
</td></tr>
<tr><td><code id="outlier_+3A_logical">logical</code></td>
<td>
<p> if set to TRUE, gives vector of logical values, and possible outlier position
is marked by TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of value(s) with largest difference from the mean.
</p>


<h3>Author(s)</h3>

<p> Lukasz Komsta, corrections by Markus Graube </p>


<h3>See Also</h3>

 <p><code><a href="#topic+rm.outlier">rm.outlier</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
y=rnorm(100)
outlier(y)
outlier(y,opposite=TRUE)
dim(y) &lt;- c(20,5)
outlier(y)
outlier(y,opposite=TRUE)
</code></pre>

<hr>
<h2 id='qcochran'> Critical values and p-values for Cochran outlying variance test </h2><span id='topic+qcochran'></span><span id='topic+pcochran'></span>

<h3>Description</h3>

<p>This functions calculates quantiles (critical values) and reversively p-values
for Cochran test for outlying variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcochran(p, n, k)
pcochran(q, n, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qcochran_+3A_p">p</code></td>
<td>
<p> vector of probabilities. </p>
</td></tr>
<tr><td><code id="qcochran_+3A_q">q</code></td>
<td>
<p> vector of quantiles. </p>
</td></tr>
<tr><td><code id="qcochran_+3A_n">n</code></td>
<td>
<p> number of values in each group (if not equal, use arithmetic mean). </p>
</td></tr>
<tr><td><code id="qcochran_+3A_k">k</code></td>
<td>
<p> number of groups.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of p-values or critical values.
</p>


<h3>Author(s)</h3>

<p> Lukasz Komsta </p>


<h3>References</h3>

<p>Snedecor, G.W., Cochran, W.G. (1980). Statistical Methods (seventh edition).
Iowa State University Press, Ames, Iowa.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+cochran.test">cochran.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>qcochran(0.05,5,5)
pcochran(0.293,5,5)
</code></pre>

<hr>
<h2 id='qdixon'> critical values and p-values for Dixon tests</h2><span id='topic+qdixon'></span><span id='topic+pdixon'></span>

<h3>Description</h3>

<p>Approximated quantiles (critical values) and distribution function (giving p-values)
for Dixon tests for outliers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qdixon(p, n, type = 10, rev = FALSE)
pdixon(q, n, type = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qdixon_+3A_p">p</code></td>
<td>
<p> vector of probabilities. </p>
</td></tr>
<tr><td><code id="qdixon_+3A_q">q</code></td>
<td>
<p> vector of quantiles. </p>
</td></tr>
<tr><td><code id="qdixon_+3A_n">n</code></td>
<td>
<p> length of sample. </p>
</td></tr>
<tr><td><code id="qdixon_+3A_type">type</code></td>
<td>
<p> integer value: 10, 11, 12, 20, or 21. For description see <code>dixon.test</code>. </p>
</td></tr>
<tr><td><code id="qdixon_+3A_rev">rev</code></td>
<td>
<p> function <code>qdixon</code> with this parameter set to TRUE acts as <code>pdixon</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is based on tabularized Dixon distribution, given by Dixon (1950) and corrected
by Rorabacher (1991). Continuity is reached due to smart interpolation using <code><a href="#topic+qtable">qtable</a></code> function.
By now, numerical procedure to obtain these values for n&gt;3 is not known.
</p>


<h3>Value</h3>

<p>Critical value or p-value (vector).
</p>


<h3>Author(s)</h3>

<p> Lukasz Komsta </p>


<h3>References</h3>

 
<p>Dixon, W.J. (1950). Analysis of extreme values. Ann. Math. Stat. 21, 4, 488-506.
</p>
<p>Dixon, W.J. (1951). Ratios involving extreme values. Ann. Math. Stat. 22, 1, 68-78.
</p>
<p>Rorabacher, D.B. (1991). Statistical Treatment for Rejection of Deviant Values: Critical Values of Dixon Q Parameter and Related Subrange Ratios at the 95 percent Confidence Level. Anal. Chem. 83, 2, 139-146.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+qtable">qtable</a></code>, <code><a href="#topic+dixon.test">dixon.test</a></code></p>

<hr>
<h2 id='qgrubbs'> Calculate critical values and p-values for Grubbs tests </h2><span id='topic+qgrubbs'></span><span id='topic+pgrubbs'></span>

<h3>Description</h3>

<p>This function is designed to calculate critical values for Grubbs tests
for outliers detecting and to approximate p-values reversively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qgrubbs(p, n, type = 10, rev = FALSE)
pgrubbs(q, n, type = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qgrubbs_+3A_p">p</code></td>
<td>
<p> vector of probabilities. </p>
</td></tr>
<tr><td><code id="qgrubbs_+3A_q">q</code></td>
<td>
<p> vector of quantiles. </p>
</td></tr>
<tr><td><code id="qgrubbs_+3A_n">n</code></td>
<td>
<p> sample size. </p>
</td></tr>
<tr><td><code id="qgrubbs_+3A_type">type</code></td>
<td>
<p> Integer value indicating test variant. 10 is a test for one outlier (side is
detected automatically and can be reversed by <code>opposite</code> parameter). 11 is a test
for two outliers on opposite tails, 20 is test for two outliers in one tail. </p>
</td></tr>
<tr><td><code id="qgrubbs_+3A_rev">rev</code></td>
<td>
<p> if set to TRUE, function <code>qgrubbs</code> acts as <code>pgrubbs</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The critical values for test for one outlier is calculated according to approximations given by
Pearson and Sekar (1936). The formula is simply reversed to obtain p-value.
</p>
<p>The values for two outliers test (on opposite sides) are calculated according to David, Hartley,
and Pearson (1954). Their formula cannot be rearranged to obtain p-value, thus such values are
obtained by <code><a href="stats.html#topic+uniroot">uniroot</a></code>.
</p>
<p>For test checking presence of two outliers at one tail, the tabularized distribution (Grubbs, 1950)
is used, and approximations of p-values are interpolated using <code><a href="#topic+qtable">qtable</a></code>.
</p>


<h3>Value</h3>

<p>A vector of quantiles or p-values.
</p>


<h3>Author(s)</h3>

<p> Lukasz Komsta </p>


<h3>References</h3>

 
<p>Grubbs, F.E. (1950). Sample Criteria for testing outlying observations. Ann. Math. Stat. 21, 1, 27-58.
</p>
<p>Pearson, E.S., Sekar, C.C. (1936). The efficiency of statistical tools and a criterion for the rejection of outlying observations. Biometrika, 28, 3, 308-320.
</p>
<p>David, H.A, Hartley, H.O., Pearson, E.S. (1954). The distribution of the ratio, in a single normal sample, of range to standard deviation. Biometrika, 41, 3, 482-493.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+grubbs.test">grubbs.test</a></code></p>

<hr>
<h2 id='qtable'> Interpolate tabularized distribution </h2><span id='topic+qtable'></span>

<h3>Description</h3>

<p>This function calculates critical values or p-values which cannot
be obtained numerically, and only tabularized version is available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qtable(p, probs, quants)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qtable_+3A_p">p</code></td>
<td>
<p> vector of probabilities. </p>
</td></tr>
<tr><td><code id="qtable_+3A_probs">probs</code></td>
<td>
<p> vector of given probabilities. </p>
</td></tr>
<tr><td><code id="qtable_+3A_quants">quants</code></td>
<td>
<p> vector of given corresponding quantiles. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal routine used to obtain Grubbs and Dixon critical values.
It fits linear or cubical regression to closests values of its argument, then uses
obtained function to obtain quantile by interpolation.
</p>


<h3>Value</h3>

<p>A vector of interpolated values
</p>


<h3>Note</h3>

 
<p>You can simply do &quot;reverse&quot; interpolation (p-value calculating) by reversing probabilities
and quantiles (2 and 3 argument).
</p>


<h3>Author(s)</h3>

<p> Lukasz Komsta </p>

<hr>
<h2 id='rm.outlier'> Remove the value(s) most differing from the mean </h2><span id='topic+rm.outlier'></span>

<h3>Description</h3>

<p>If the outlier is detected and confirmed by statistical tests, this function
can remove it or replace by sample mean or median.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rm.outlier(x, fill = FALSE, median = FALSE, opposite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rm.outlier_+3A_x">x</code></td>
<td>
<p> a dataset, most frequently a vector. If argument is a dataframe, then outlier is removed 
from each column by <code>sapply</code>. The same behavior is applied by <code>apply</code> when the matrix 
is given.
</p>
</td></tr>
<tr><td><code id="rm.outlier_+3A_fill">fill</code></td>
<td>
<p> If set to TRUE, the median or mean is placed instead of outlier. Otherwise, 
the outlier(s) is/are simply removed. </p>
</td></tr>
<tr><td><code id="rm.outlier_+3A_median">median</code></td>
<td>
<p> If set to TRUE, median is used instead of mean in outlier replacement. </p>
</td></tr>
<tr><td><code id="rm.outlier_+3A_opposite">opposite</code></td>
<td>
<p> if set to TRUE, gives opposite value (if largest value has maximum difference
from the mean, it gives smallest and vice versa)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataset of the same type as argument, with outlier(s) removed or replacement by appropriate means
or medians.
</p>


<h3>Author(s)</h3>

<p> Lukasz Komsta</p>


<h3>See Also</h3>

 <p><code><a href="#topic+outlier">outlier</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
y=rnorm(100)
outlier(y)
outlier(y,opposite=TRUE)
rm.outlier(y)
rm.outlier(y,opposite=TRUE)
dim(y) &lt;- c(20,5)
outlier(y)
outlier(y,logical=TRUE)
outlier(y,logical=TRUE,opposite=TRUE)
rm.outlier(y)
rm.outlier(y,opposite=TRUE)
</code></pre>

<hr>
<h2 id='scores'> Calculate scores of the sample </h2><span id='topic+scores'></span>

<h3>Description</h3>

<p>This function calculates normal, t, chi-squared, IQR and MAD scores
of given data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scores(x, type = c("z", "t", "chisq", "iqr", "mad"), prob = NA, lim = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scores_+3A_x">x</code></td>
<td>
<p> a vector of data. </p>
</td></tr>
<tr><td><code id="scores_+3A_type">type</code></td>
<td>
<p> &quot;z&quot; calculates normal scores (differences between each value and the mean
divided by sd), &quot;t&quot; calculates t-Student scores (transformed by <code>(z*sqrt(n-2))/sqrt(z-1-t^2)</code>
formula, &quot;chisq&quot; gives chi-squared scores (squares of differences between values and mean
divided by variance. For the &quot;iqr&quot; type, all values lower than first and greater than third
quartile is considered, and difference between them and nearest quartile divided by IQR are
calculated. For the values between these quartiles, scores are always equal to zero.
&quot;mad&quot; gives differences between each value and median, divided by median absolute deviation.</p>
</td></tr>
<tr><td><code id="scores_+3A_prob">prob</code></td>
<td>
<p> If set, the corresponding p-values instead of scores are given. If value is set
to 1, p-value are returned. Otherwise, a logical vector is formed, indicating which values are
exceeding specified probability. In &quot;z&quot; and &quot;mad&quot; types, there is also possibility to set this
value to zero, and then scores are confirmed to (n-1)/sqrt(n) value, according to 
Shiffler (1998). The &quot;iqr&quot; type does not support probabilities, but &quot;lim&quot; value can be specified.</p>
</td></tr>
<tr><td><code id="scores_+3A_lim">lim</code></td>
<td>
<p> This value can be set for &quot;iqr&quot; type of scores, to form logical vector, which values
has this limit exceeded. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of scores, probabilities, or logical vector.
</p>


<h3>Author(s)</h3>

<p> Lukasz Komsta, corrections by Alan Richter </p>


<h3>References</h3>

 
<p>Schiffler, R.E (1998). Maximum Z scores and outliers. Am. Stat. 42, 1, 79-80.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+mad">mad</a></code>, <code><a href="stats.html#topic+IQR">IQR</a></code>, <code><a href="#topic+grubbs.test">grubbs.test</a></code>, </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x = rnorm(10)
scores(x)
scores(x,prob=1)
scores(x,prob=0.5)
scores(x,prob=0.1)
scores(x,prob=0.93)
scores(x,type="iqr")
scores(x,type="mad")
scores(x,prob=0)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
