<!DOCTYPE html><html lang="en"><head><title>Help for package rddapp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rddapp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rddapp-package'><p>Regression Discontinuity Design Application</p></a></li>
<li><a href='#attr_check'><p>Attrition Checks</p></a></li>
<li><a href='#bw_ik09'><p>Imbens-Kalyanaraman 2009 Optimal Bandwidth Calculation</p></a></li>
<li><a href='#bw_ik12'><p>Imbens-Kalyanaraman 2012 Optimal Bandwidth Calculation</p></a></li>
<li><a href='#CARE'><p>Carolina Abecedarian Project and the Carolina Approach to Responsive Education (CARE), 1972-1992</p></a></li>
<li><a href='#dc_test'><p>McCrary Sorting Test</p></a></li>
<li><a href='#mfrd_est'><p>Multivariate Frontier Regression Discontinuity Estimation</p></a></li>
<li><a href='#mrd_est'><p>Multivariate Regression Discontinuity Estimation</p></a></li>
<li><a href='#mrd_impute'><p>Multiple Imputation of Multivariate Regression Discontinuity Estimation</p></a></li>
<li><a href='#mrd_power'><p>Power Analysis of Multivariate Regression Discontinuity</p></a></li>
<li><a href='#mrd_sens_bw'><p>Bandwidth Sensitivity Simulation for Multivariate Regression Discontinuity</p></a></li>
<li><a href='#mrd_sens_cutoff'><p>Cutoff Sensitivity Simulation for Multivariate Regression Discontinuity</p></a></li>
<li><a href='#plot.mfrd'><p>Plot the Multivariate Frontier Regression Discontinuity</p></a></li>
<li><a href='#plot.rd'><p>Plot the Regression Discontinuity</p></a></li>
<li><a href='#predict.rd'><p>Predict the Regression Discontinuity</p></a></li>
<li><a href='#print.mfrd'><p>Print the Multivariate Frontier Regression Discontinuity</p></a></li>
<li><a href='#print.rd'><p>Print the Regression Discontinuity</p></a></li>
<li><a href='#rd_est'><p>Regression Discontinuity Estimation</p></a></li>
<li><a href='#rd_impute'><p>Multiple Imputation of Regression Discontinuity Estimation</p></a></li>
<li><a href='#rd_power'><p>Power Analysis of Regression Discontinuity</p></a></li>
<li><a href='#rd_sens_bw'><p>Bandwidth Sensitivity Simulation for Regression Discontinuity</p></a></li>
<li><a href='#rd_sens_cutoff'><p>Cutoff Sensitivity Simulation for Regression Discontinuity</p></a></li>
<li><a href='#rd_type'><p>Determine Type of Regression Discontinuity Design</p></a></li>
<li><a href='#sens_plot'><p>Plot the Simulated Estimates for Sensitivity Analyses</p></a></li>
<li><a href='#shiny_run'><p>Launch the R Shiny App for &quot;rddapp&quot;</p></a></li>
<li><a href='#summary.mfrd'><p>Summarize the Multivariate Frontier Regression Discontinuity</p></a></li>
<li><a href='#summary.mrd'><p>Summarize the Multivariate Regression Discontinuity</p></a></li>
<li><a href='#summary.mrdi'><p>Summarize the Multiple Imputation of Multivariate Regression Discontinuity</p></a></li>
<li><a href='#summary.mrdp'><p>Summarize the Power Analysis of Regression Discontinuity</p></a></li>
<li><a href='#summary.rd'><p>Summarize the Regression Discontinuity</p></a></li>
<li><a href='#summary.rdp'><p>Summarize the Power Analysis of Regression Discontinuity</p></a></li>
<li><a href='#treat_assign'><p>Treatment Assignment for Regression Discontinuity</p></a></li>
<li><a href='#var_center'><p>Assignment Centering for Multivariate Frontier Regression Discontinuity</p></a></li>
<li><a href='#wt_kern'><p>Kernel Weight Calculation</p></a></li>
<li><a href='#wt_kern_bivariate'><p>Bivariate Kernel Weight Calculation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Regression Discontinuity Design Application</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Ze Jin [aut],
  Wang Liao [aut],
  Irena Papst [aut],
  Wenyu Zhang [aut],
  Kimberly Hochstedler [aut],
  Felix Thoemmes [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felix Thoemmes &lt;fjt36@cornell.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of both single- and multiple-assignment Regression Discontinuity Designs 
    (RDDs). Provides both parametric (global) and non-parametric (local) estimation choices for
    both sharp and fuzzy designs, along with power analysis and assumption checks. 
    Introductions to the underlying logic and analysis of RDDs are in 
    Thistlethwaite, D. L., Campbell, D. T. (1960) &lt;<a href="https://doi.org/10.1037%2Fh0044319">doi:10.1037/h0044319</a>&gt; and
    Lee, D. S., Lemieux, T. (2010) &lt;<a href="https://doi.org/10.1257%2Fjel.48.2.281">doi:10.1257/jel.48.2.281</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>AER (&ge; 1.2-5), sandwich (&ge; 2.3-4), lmtest (&ge; 0.9-35),
Formula (&ge; 1.2-1), shiny (&ge; 0.14), R.utils (&ge; 2.6.0), plot3D
(&ge; 1.1.1), sp (&ge; 1.3.1), DT (&ge; 0.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>foreign (&ge; 0.8-67), devtools (&ge; 1.12.0), testthat (&ge;
1.0.2), roxygen2 (&ge; 5.0.1), knitr (&ge; 1.14), rmarkdown (&ge;
1.1.9012)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'attr_check.R' 'bw_ik09.R' 'bw_ik12.R' 'data.R' 'wt_kern.R'
'dc_test.R' 'treat_assign.R' 'wt_kern_bivariate.R' 'mfrd_est.R'
'var_center.R' 'rd_est.R' 'mrd_est.R' 'mrd_impute.R'
'mrd_power.R' 'mrd_sens_bw.R' 'mrd_sens_cutoff.R' 'plot.mfrd.R'
'predict.rd.R' 'plot.rd.R' 'print.mfrd.R' 'print.rd.R'
'rd_impute.R' 'rd_power.R' 'rd_sens_bw.R' 'rd_sens_cutoff.R'
'rd_type.R' 'rddapp-package.R' 'sens_plot.R' 'shiny_run.R'
'summary.mfrd.R' 'summary.mrd.R' 'summary.mrdi.R'
'summary.mrdp.R' 'summary.rd.R' 'summary.rdp.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-05 19:14:26 UTC; fjt36-admin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-05 20:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rddapp-package'>Regression Discontinuity Design Application</h2><span id='topic+rddapp-package'></span><span id='topic+rddapp'></span>

<h3>Description</h3>

<p>rddapp: A package for regression discontinuity designs (RDDs).
</p>


<h3>Details</h3>

<p>The rddapp package provides a set of functions for the analysis 
of the regression-discontinuity design (RDD). The three main parts are:
estimation of effects of interest, power analysis, and assumption checks.
</p>


<h3>Estimation</h3>

<p>A variety of designs can be estimated in various ways. 
The single-assignment RDD (both sharp and fuzzy) can be analyzed using
both a parametric (global) or non-parametric (local) approach. 
The multiple-assignment RDD (both sharp and fuzzy) can be analyzed using both parametric and 
non-parametric estimation. The analysis choices are further to use estimate effects based on
univariate scaling, the centering approach, or the frontier approach. The frontier approach
can currently only be estimated using parametric regression with bootstrapped standard errors.
</p>


<h3>Power analysis</h3>

<p>Statistical power can be be estimated for both the single- and multiple-assignment RDD,
(both sharp and fuzzy), including all parametric and non-parametric estimators mentioned in 
the estimation section. All power analyses are based on a simulation approach, which means that 
the user has to provide all necessary parameters for a data-generating model.
</p>


<h3>Assumption checks</h3>

<p>An important part of any RDD are checks of underlying assumptions. The package provides users 
with the option to estimate McCrary's sorting test (to identify violations of assignment rules), 
checks of discontinuities of other baseline covariates, along with sensitivity checks of the 
chosen bandwidth parameter for non-parametric models, and so-called placebo tests, that examine
the treatment effect at other cut-points along the assignment variable.
</p>


<h3>Author(s)</h3>

<p>Ze Jin <a href="mailto:zj58@cornell.edu">zj58@cornell.edu</a>, 
Wang Liao <a href="mailto:wl483@cornell.edu">wl483@cornell.edu</a>,
Irena Papst <a href="mailto:ip98@cornell.edu">ip98@cornell.edu</a>,
Wenyu Zhang <a href="mailto:wz258@cornell.edu">wz258@cornell.edu</a>,
Kimberly Hochstedler <a href="mailto:kah343@cornell.edu">kah343@cornell.edu</a>,
Felix Thoemmes, <a href="mailto:fjt36@cornell.edu">fjt36@cornell.edu</a>
</p>

<hr>
<h2 id='attr_check'>Attrition Checks</h2><span id='topic+attr_check'></span>

<h3>Description</h3>

<p><code>attr_check</code> reports missing data on treatment variable, assignment variable, and outcome.
This is an internal function and is typically not directly invoked by the user. 
It can be accessed using the triple colon, as in rddapp:::attr_check().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attr_check(x1, y, t, x2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="attr_check_+3A_x1">x1</code></td>
<td>
<p>A numeric object containing the assignment variable.</p>
</td></tr>
<tr><td><code id="attr_check_+3A_y">y</code></td>
<td>
<p>A numeric object containing the outcome variable, with the same dimensionality 
as <code>x1</code>.</p>
</td></tr>
<tr><td><code id="attr_check_+3A_t">t</code></td>
<td>
<p>A numeric object containing the treatment variable (coded as 0 for untreated and 1 for treated), with the same dimensionality 
as <code>x1</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="attr_check_+3A_x2">x2</code></td>
<td>
<p>A numeric object containing the secondary assignment variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>attr_check</code> returns a list containing the amount and percentage of missing data for all variables and subgroups, by treatment.
</p>

<hr>
<h2 id='bw_ik09'>Imbens-Kalyanaraman 2009 Optimal Bandwidth Calculation</h2><span id='topic+bw_ik09'></span>

<h3>Description</h3>

<p><code>bw_ik09</code> calculates the Imbens-Kalyanaraman (2009) optimal bandwidth
for local linear regression in regression discontinuity designs.
It is based on the <code>IKbandwidth</code> function in the &quot;rdd&quot; package. 
This is an internal function and is typically not directly invoked by the user. 
It can be accessed using the triple colon, as in rddapp:::bw_ik09().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw_ik09(X, Y, cutpoint = NULL, verbose = FALSE, kernel = "triangular")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bw_ik09_+3A_x">X</code></td>
<td>
<p>A numeric vector containing the running variable.</p>
</td></tr>
<tr><td><code id="bw_ik09_+3A_y">Y</code></td>
<td>
<p>A numeric vector containing the outcome variable.</p>
</td></tr>
<tr><td><code id="bw_ik09_+3A_cutpoint">cutpoint</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined. The default is 0.</p>
</td></tr>
<tr><td><code id="bw_ik09_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print more information to the terminal. 
The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bw_ik09_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ik_bw09</code> returns a numeric value specifying the optimal bandwidth.
</p>


<h3>References</h3>

<p>Imbens, G., Kalyanaraman, K. (2009). 
Optimal bandwidth choice for the regression discontinuity estimator 
(Working Paper No. 14726). National Bureau of Economic Research.
<a href="https://www.nber.org/papers/w14726">https://www.nber.org/papers/w14726</a>.
</p>
<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='bw_ik12'>Imbens-Kalyanaraman 2012 Optimal Bandwidth Calculation</h2><span id='topic+bw_ik12'></span>

<h3>Description</h3>

<p><code>bw_ik12</code> calculates the Imbens-Kalyanaraman (2012) optimal bandwidth
for local linear regression in regression discontinuity designs.
It is based on a function in the &quot;rddtools&quot; package. 
This is an internal function and is typically not directly invoked by the user. 
It can be accessed using the triple colon, as in rddapp:::bw_ik12().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw_ik12(X, Y, cutpoint = NULL, verbose = FALSE, kernel = "triangular")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bw_ik12_+3A_x">X</code></td>
<td>
<p>A numeric vector containing the running variable.</p>
</td></tr>
<tr><td><code id="bw_ik12_+3A_y">Y</code></td>
<td>
<p>A numeric vector containing the outcome variable.</p>
</td></tr>
<tr><td><code id="bw_ik12_+3A_cutpoint">cutpoint</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined. The default is 0.</p>
</td></tr>
<tr><td><code id="bw_ik12_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print more information to the terminal.
The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bw_ik12_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ik_bw12</code> returns a numeric value specifying the optimal bandwidth.
</p>


<h3>References</h3>

<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>
<p>Stigler, M. and B. Quast, B (2016). rddtools: A toolbox for regression discontinuity in R.
</p>

<hr>
<h2 id='CARE'>Carolina Abecedarian Project and the Carolina Approach to Responsive Education (CARE), 1972-1992</h2><span id='topic+CARE'></span>

<h3>Description</h3>

<p>A dataset containing a subset of children from the CARE trial on early childhood intervention. 
The randomized controlled trial was subsetted to mimic a regression-discontinuity design in which 
treatment was assigned only to mothers whose IQ was smaller than 85.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CARE
</code></pre>


<h3>Format</h3>

<p>A data frame with 81 rows and 5 variables:
</p>

<dl>
<dt>SUBJECT</dt><dd><p>Unique ID variable</p>
</dd>
<dt>DC_TRT</dt><dd><p>Day Care (Preschool) Treatment Group, 1 = Treatment, 0 = Control</p>
</dd>
<dt>APGAR5</dt><dd><p>APGAR (&quot;Appearance, Pulse, Grimace, Activity, and Respiration&quot;) score at 5 minutes after birth</p>
</dd>
<dt>MOMWAIS0</dt><dd><p>Biological mother's WAIS (Wechsler Adult Intelligence Scale) 
full-scale score at subject's birth</p>
</dd>
<dt>SBIQ48</dt><dd><p>Subject's Stanford Binet IQ score at 48 months</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www.icpsr.umich.edu/icpsrweb/ICPSR/studies/4091">http://www.icpsr.umich.edu/icpsrweb/ICPSR/studies/4091</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CARE")
head(CARE)

</code></pre>

<hr>
<h2 id='dc_test'>McCrary Sorting Test</h2><span id='topic+dc_test'></span>

<h3>Description</h3>

<p><code>dc_test</code> implements the McCrary (2008) sorting test to identify violations of assignment rules.
It is based on the <code>DCdensity</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dc_test(
  runvar,
  cutpoint,
  bin = NULL,
  bw = NULL,
  verbose = TRUE,
  plot = TRUE,
  ext.out = FALSE,
  htest = FALSE,
  level = 0.95,
  digits = max(3, getOption("digits") - 3),
  timeout = 30
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dc_test_+3A_runvar">runvar</code></td>
<td>
<p>A numeric vector containing the running variable.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_cutpoint">cutpoint</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined. The default is 0.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_bin">bin</code></td>
<td>
<p>A numeric value containing the binwidth. The default is <code>2*sd(runvar)*length(runvar)^(-.5)</code>.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_bw">bw</code></td>
<td>
<p>A numeric value containing bandwidth to use. If no bandwidth is supplied, the default uses bandwidth selection calculation 
from McCrary (2008).</p>
</td></tr>
<tr><td><code id="dc_test_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print diagnostic information to 
the terminal. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether to plot the histogram and density estimations 
The default is <code>TRUE</code>. The user may wrap this function in additional graphical options 
to modify the plot.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_ext.out">ext.out</code></td>
<td>
<p>A logical value indicating whether to return extended output. 
The default is <code>FALSE</code>. When <code>FALSE</code> <code>dc_test</code> will return only the p-value of the test, but will print more information. 
When <code>TRUE</code>, <code>dc_test</code> will return and print the additional information documented below.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_htest">htest</code></td>
<td>
<p>A logical value indicating whether to return an <code>"htest"</code> object 
compatible with base R's hypothesis test output. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_level">level</code></td>
<td>
<p>A numerical value between 0 and 1 specifying the confidence level for confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to display in all output.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="dc_test_+3A_timeout">timeout</code></td>
<td>
<p>A non-negative numerical value specifying the maximum number of seconds that 
expressions in the function are allowed to run. The default is 30. Specify <code>Inf</code> to run all expressions
to completion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>ext.out</code> is <code>FALSE</code>, <code>dc_test</code> returns a numeric value specifying the p-value of the McCrary (2008) sorting test. 
Additional output is enabled when <code>ext.out</code> is <code>TRUE</code>. 
In this case, <code>dc_test</code> returns a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>theta</code></td>
<td>
<p>The estimated log difference in heights of the density curve at the cutpoint.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>The standard error of <code>theta</code>.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>The z statistic of the test.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The p-value of the test. A p-value below the significance threshold indicates 
that the user can reject the null hypothesis of no sorting.</p>
</td></tr>
<tr><td><code>binsize</code></td>
<td>
<p>The calculated size of bins for the test.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>The calculated bandwidth for the test.</p>
</td></tr>
<tr><td><code>cutpoint</code></td>
<td>
<p>The cutpoint used.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>A dataframe for the binning of the histogram. Columns are <code>cellmp</code> 
(the midpoints of each cell) and <code>cellval</code> (the normalized height of each cell).</p>
</td></tr>
</table>


<h3>References</h3>

<p>McCrary, J. (2008).
Manipulation of the running variable in the regression discontinuity design: A density test. 
Journal of Econometrics, 142(2), 698-714. 
<a href="https://doi.org/10.1016/j.jeconom.2007.05.005">doi:10.1016/j.jeconom.2007.05.005</a>.
</p>
<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package version 0.57. https://CRAN.R-project.org/package=rdd
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
# No discontinuity
x &lt;- runif(1000, -1, 1)
dc_test(x, 0)

# Discontinuity
x &lt;- runif(1000, -1, 1)
x &lt;- x + 2 * (runif(1000, -1, 1) &gt; 0 &amp; x &lt; 0)
dc_test(x, 0)
</code></pre>

<hr>
<h2 id='mfrd_est'>Multivariate Frontier Regression Discontinuity Estimation</h2><span id='topic+mfrd_est'></span>

<h3>Description</h3>

<p><code>mfrd_est</code> implements the frontier approach for multivariate regression discontinuity estimation in Wong, Steiner and Cook (2013). 
It is based on the MFRDD code in Stata from Wong, Steiner, and Cook (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mfrd_est(
  y,
  x1,
  x2,
  c1,
  c2,
  t.design = NULL,
  local = 0.15,
  front.bw = NA,
  m = 10,
  k = 5,
  kernel = "triangular",
  ngrid = 250,
  margin = 0.03,
  boot = NULL,
  cluster = NULL,
  stop.on.error = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mfrd_est_+3A_y">y</code></td>
<td>
<p>A numeric object containing outcome variable.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_x1">x1</code></td>
<td>
<p>A numeric object containing the first assignment variable.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_x2">x2</code></td>
<td>
<p>A numeric object containing the second assignment variable.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_c1">c1</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined for <code>x1</code>.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_c2">c2</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined for <code>x2</code>.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_t.design">t.design</code></td>
<td>
<p>A character vector of length 2 specifying the treatment option according to design.
The first entry is for <code>x1</code> and the second entry is for <code>x2</code>. Options are  
<code>"g"</code> (treatment is assigned if <code>x1</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x1</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x1</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x1</code> is less than or equal to its cutoff).
The same options are available for <code>x2</code>.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_local">local</code></td>
<td>
<p>A non-negative numeric value specifying the range of neighboring points around the cutoff on the 
standardized scale, for each assignment variable. The default is 0.15.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_front.bw">front.bw</code></td>
<td>
<p>A non-negative numeric vector of length 3 specifying the bandwidths at which to estimate the RD for each
of three effects models (complete model, heterogeneous treatment model, and treatment only model) 
detailed in Wong, Steiner, and Cook (2013).
If <code>NA</code>, <code>front.bw</code> will be determined by cross-validation. The default is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_m">m</code></td>
<td>
<p>A non-negative integer specifying the number of uniformly-at-random samples to draw as search candidates for <code>front.bw</code>,
if <code>front.bw</code> is <code>NA</code>. The default is 10.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_k">k</code></td>
<td>
<p>A non-negative integer specifying the number of folds for cross-validation to determine <code>front.bw</code>,
if <code>front.bw</code> is <code>NA</code>. The default is 5.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_ngrid">ngrid</code></td>
<td>
<p>A non-negative integer specifying the number of non-zero grid points on each assignment variable,
which is also the number of zero grid points on each assignment variable. The default is 250. The value used in 
Wong, Steiner and Cook (2013) is 2500, which may cause long computational time.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_margin">margin</code></td>
<td>
<p>A non-negative numeric value specifying the range of grid points beyond the minimum and maximum
of sample points on each assignment variable. This grid is used to impute potential outcomes along the frontier,
as in Wong, Steiner, and Cook (2013). The default is 0.03.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_boot">boot</code></td>
<td>
<p>An optional non-negative integer specifying the number of bootstrap samples to obtain standard error of estimates.</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_cluster">cluster</code></td>
<td>
<p>An optional vector of length n specifying clusters within which the errors are assumed
to be correlated. This will result in reporting cluster robust SEs. It is suggested that data with a discrete running 
variable be clustered by each unique value of the running variable (Lee and Card, 2008).</p>
</td></tr>
<tr><td><code id="mfrd_est_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>A logical value indicating whether to remove bootstraps which cause error in the <code>integrate</code> function. If <code>TRUE</code>, bootstraps which cause error are removed
and resampled until the specified number of 
bootstrap samples are acquired. If <code>FALSE</code>, bootstraps which cause error are not removed. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mfrd_est</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>mfrd</code>&quot;.
The functions <code>summary</code> and <code>plot</code> are used to obtain and print a summary and 
plot of the estimated regression discontinuity. The object of class <code>mfrd</code> is a list 
containing the following components:
</p>
<table role = "presentation">
<tr><td><code>w</code></td>
<td>
<p>Numeric vector specifying the weight of frontier 1 and frontier 2, respectively.</p>
</td></tr>   
<tr><td><code>est</code></td>
<td>
<p>Numeric matrix of the estimate of the discontinuity in the outcome under 
a complete model (no prefix), heterogeneous treatment (ht) effects model, and treatment (t) only model,
for the parametric case and for each corresponding bandwidth.
Estimates with suffix &quot;ev1&quot; and &quot;ev2&quot; correspond to expected values for each frontier, under a given model.
Estimates with suffix &quot;ate&quot; correspond to average treatment effects across both frontiers, 
under a given model.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Numeric matrix of the effect size (Cohen's d) for estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Numeric matrix of the standard error for each corresponding bandwidth, if applicable.</p>
</td></tr>
<tr><td><code>m_s</code></td>
<td>
<p>A list containing estimates for the complete model, under parametric
and non-parametric (optimal, half, and double bandwidth) cases. A list of 
coefficient estimates, residuals, effects, weights (in the non-parametric case),
<code>lm</code> output (rank of the fitted linear model, fitted values, assignments for the design matrix,
qr for linear fit, residual degrees of freedom, levels of the x value, function call, and terms),
and output data frame are returned for each model.</p>
</td></tr>
<tr><td><code>m_h</code></td>
<td>
<p>A list containing estimates for the heterogeneous treatments model, under parametric
and non-parametric (optimal, half, and double bandwidth) cases. A list of 
coefficient estimates, residuals, effects, weights (in the non-parametric case),
<code>lm</code> output (rank of the fitted linear model, fitted values, assignments for the design matrix,
qr for linear fit, residual degrees of freedom, levels of the x value, function call, and terms),
and output data frame are returned for each model.</p>
</td></tr>
<tr><td><code>m_t</code></td>
<td>
<p>A list containing estimates for the treatment only model, under parametric
and non-parametric (optimal, half, and double bandwidth) cases. A list of 
coefficient estimates, residuals, effects, weights (in the non-parametric case),
<code>lm</code> output (rank of the fitted linear model, fitted values, assignments for the design matrix,
qr for linear fit, residual degrees of freedom, levels of the x value, function call, and terms),
and output data frame are returned for each model.</p>
</td></tr>
<tr><td><code>dat_h</code></td>
<td>
<p>A list containing four data frames, one for each case:
parametric or non-parametric (optimal, half, and double bandwidth).
Each data frame contains functions and densities for each frontier
and treatment model.</p>
</td></tr>
<tr><td><code>dat</code></td>
<td>
<p>A data frame containing the outcome (<code>y</code>) and each input
(<code>x1</code>, <code>x2</code>) for each observation. The data frame also contains
indicators of being within the <code>local</code> boundary of the <code>cutpoint</code>
for x1 and x2 (<code>x1res</code>, <code>x2res</code>),
scaled (<code>zx1</code>, <code>zx2</code>) and
centered x1 and x2 values (<code>zcx1</code>, <code>zcx2</code>), and 
treatment indicators for overall treatment (<code>tr</code>) based on treatment assignment
from x1 (<code>tr1</code>), x2 (<code>tr2</code>), and both assignment variables (<code>trb</code>).</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>List of the number of observations used in each model.</p>
</td></tr>
<tr><td><code>impute</code></td>
<td>
<p>A logical value indicating whether multiple imputation is used or not.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>front.bw</code></td>
<td>
<p>Numeric vector of each bandwidth used to estimate the density
at the frontier for the three effects models (complete model,
heterogeneous treatment model, and treatment only model) 
detailed in Wong, Steiner, and Cook (2013).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wong, V., Steiner, P, and Cook, T. (2013).
Analyzing regression discontinuity designs with multiple assignment variables: A comparative study of four estimation methods. 
Journal of Educational and Behavioral Statistics, 38(2), 107-141. 
<a href="https://doi.org/10.3102/1076998611432172">doi:10.3102/1076998611432172</a>.
</p>
<p>Lee, D. and Card, D. (2008).
A Regression discontinuity inference with specification error.
Journal of Econometrics, 142(2), 655-674. 
<a href="https://doi.org/10.1016/j.jeconom.2007.05.003">doi:10.1016/j.jeconom.2007.05.003</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x1 &lt;- runif(1000, -1, 1)
x2 &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * (x1 &gt;= 0) + 3 * cov + 10 * (x2 &gt;= 0) + rnorm(1000)
mfrd_est(y = y, x1 = x1, x2 = x2, c1 = 0, c2 = 0, t.design = c("geq", "geq"))
</code></pre>

<hr>
<h2 id='mrd_est'>Multivariate Regression Discontinuity Estimation</h2><span id='topic+mrd_est'></span>

<h3>Description</h3>

<p><code>mrd_est</code> estimates treatment effects in a multivariate regression discontinuity design (MRDD) with two assignment variables, 
including the frontier average treatment effect (<code>tau_MRD</code>) 
and frontier-specific effects (<code>tau_R</code> and <code>tau_M</code>) simultaneously.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mrd_est(
  formula,
  data,
  subset = NULL,
  cutpoint = NULL,
  bw = NULL,
  front.bw = NA,
  m = 10,
  k = 5,
  kernel = "triangular",
  se.type = "HC1",
  cluster = NULL,
  verbose = FALSE,
  less = FALSE,
  est.cov = FALSE,
  est.itt = FALSE,
  local = 0.15,
  ngrid = 250,
  margin = 0.03,
  boot = NULL,
  method = c("center", "univ", "front"),
  t.design = NULL,
  stop.on.error = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mrd_est_+3A_formula">formula</code></td>
<td>
<p>The formula of the MRDD; a symbolic description of the model to
be fitted. This is supplied in the
format of <code>y ~ x1 + x2</code> for a simple sharp MRDD or <code>y ~ x1 + x2 | c1 + c2</code>
for a sharp MRDD with two covariates. A fuzzy MRDD may be specified as
<code>y ~ x1 + x2 + z</code> where <code>x1</code> is the first running variable,
<code>x2</code> is the second running variable, and 
<code>z</code> is the endogenous treatment variable. Covariates are then included in the 
same manner as in a sharp MRDD.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model. If not found in <code>data</code>,
the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_cutpoint">cutpoint</code></td>
<td>
<p>A numeric vector of length 2 containing the cutpoints at which assignment to the treatment is determined. The default is c(0, 0).</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_bw">bw</code></td>
<td>
<p>A vector specifying the bandwidths at which to estimate the RD for non-parametric models. 
Possible values are <code>"IK09"</code>, <code>"IK12"</code>,
or a user-specified non-negative numeric vector containing the bandwidths
at which to estimate the RD.
The default is <code>"IK12"</code>. If <code>bw</code> is <code>"IK12"</code>, the bandwidth is calculated using the Imbens-Kalyanaraman 
2012 method. If <code>bw</code>  is <code>"IK09"</code>, the bandwidth is calculated using 
the Imbens-Kalyanaraman 2009 method. Then, the RD is estimated
with that bandwidth, half that bandwidth, and twice that bandwidth. 
If only a single value is passed into the function,
the RD will similarly be estimated at that bandwidth, half that bandwidth, 
and twice that bandwidth.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_front.bw">front.bw</code></td>
<td>
<p>A non-negative numeric vector of length 3 specifying the bandwidths at which to estimate the RD for each
of three effects models (complete model, heterogeneous treatment model, and treatment only model) 
detailed in Wong, Steiner, and Cook (2013). If <code>NA</code>, <code>front.bw</code> will be determined by cross-validation. The default is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_m">m</code></td>
<td>
<p>A non-negative integer specifying the number of uniformly-at-random samples to draw as search candidates for <code>front.bw</code>,
if <code>front.bw</code> is <code>NA</code>. The default is 10.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_k">k</code></td>
<td>
<p>A non-negative integer specifying the number of folds for cross-validation to determine <code>front.bw</code>,
if <code>front.bw</code> is <code>NA</code>. The default is 5.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_se.type">se.type</code></td>
<td>
<p>This specifies the robust standard error calculation method to use,
from the &quot;sandwich&quot; package. Options are,
as in <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>, <code>"HC3"</code>, <code>"const"</code>, <code>"HC"</code>, <code>"HC0"</code>, 
<code>"HC1"</code>, <code>"HC2"</code>, <code>"HC4"</code>, <code>"HC4m"</code>, <code>"HC5"</code>.
The default is <code>"HC1"</code>. This option is overridden by <code>cluster</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_cluster">cluster</code></td>
<td>
<p>An optional vector of length n specifying clusters within which the errors are assumed
to be correlated. This will result in reporting cluster robust SEs. This option overrides
anything specified in <code>se.type</code>. It is suggested that data with a discrete running 
variable be clustered by each unique value of the running variable (Lee and Card, 2008).</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print additional information to 
the terminal, including results of instrumental variable regression,
and outputs from background regression models. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_less">less</code></td>
<td>
<p>Logical. If <code>TRUE</code>, return the estimates of parametric linear
and optimal bandwidth non-parametric models only. If <code>FALSE</code> 
return the estimates of linear, quadratic, and cubic parametric models and 
optimal, half and double bandwidths in non-parametric models. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_est.cov">est.cov</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimates of covariates will be included.
If <code>FALSE</code>, the estimates of covariates will not be included. The default is <code>FALSE</code>. This option is not
applicable if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_est.itt">est.itt</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimates of intent-to-treat (ITT) will be returned.
If <code>FALSE</code>, the estimates of ITT will not be returned. The default is <code>FALSE</code>. This option is not
applicable if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_local">local</code></td>
<td>
<p>A non-negative numeric value specifying the range of neighboring points around the cutoff on the 
standardized scale, for each assignment variable. The default is 0.15.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_ngrid">ngrid</code></td>
<td>
<p>A non-negative integer specifying the number of non-zero grid points on each assignment variable,
which is also the number of zero grid points on each assignment variable. The default is 250. The value used in 
Wong, Steiner and Cook (2013) is 2500, which may cause long computational time.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_margin">margin</code></td>
<td>
<p>A non-negative numeric value specifying the range of grid points beyond the minimum and maximum
of sample points on each assignment variable. The default is 0.03.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_boot">boot</code></td>
<td>
<p>An optional non-negative integer specifying the number of bootstrap samples to obtain standard error of estimates.
This argument is not optional if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_method">method</code></td>
<td>
<p>A string specifying the method to estimate the RD effect. Options are <code>"center"</code>, 
<code>"univ"</code>, <code>"front"</code>, based on the centering, univariate, and frontier
approaches (respectively) from Wong, Steiner, and Cook (2013).</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_t.design">t.design</code></td>
<td>
<p>A character vector of length 2 specifying the treatment option according to design.
The first entry is for <code>x1</code> and the second entry is for <code>x2</code>. Options are  
<code>"g"</code> (treatment is assigned if <code>x1</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x1</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x1</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x1</code> is less than or equal to its cutoff).
The same options are available for <code>x2</code>.</p>
</td></tr>
<tr><td><code id="mrd_est_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>A logical value indicating whether to remove bootstraps which cause error in the <code>integrate</code> function. If <code>TRUE</code>, bootstraps which cause error are removed
and resampled until the specified number of 
bootstrap samples are acquired. If <code>FALSE</code>, bootstraps which cause error are not removed. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mrd_est</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>mrd</code>&quot;.
The function <code>summary</code> is used to obtain and print a summary of the 
estimated regression discontinuity. The object of class <code>mrd</code> is a list 
containing the following components for each estimated treatment effect,
<code>tau_MRD</code> or <code>tau_R</code> and <code>tau_M</code>:
</p>
<table role = "presentation">
<tr><td><code>type</code></td>
<td>
<p>A string denoting either <code>"sharp"</code> or <code>"fuzzy"</code> RDD.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>Numeric vector of the estimate of the discontinuity in the outcome under 
a sharp MRDD or the Wald estimator in the fuzzy MRDD, for each corresponding bandwidth, if applicable.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Numeric vector of the standard error for each corresponding bandwidth, if applicable.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>The matrix of the 95
for each corresponding bandwidth, if applicable.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Numeric vector of each bandwidth used in estimation.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Numeric vector of the z statistic for each corresponding bandwidth, if applicable.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Numeric vector of the p-value for each corresponding bandwidth, if applicable.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>Vector of the number of observations within the corresponding bandwidth, if applicable.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>The names of covariates.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>For a sharp design, a list of the <code>lm</code> objects is returned.
For a fuzzy design, a list of lists is returned, each with two elements: 
<code>firststage</code>, the first stage <code>lm</code> object, and <code>iv</code>, the <code>ivreg</code> object. 
A model is returned for each parametric and non-parametric case and corresponding bandwidth.</p>
</td></tr>
<tr><td><code>frame</code></td>
<td>
<p>Returns the model frame used in fitting.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>The observations removed from fitting due to missingness.</p>
</td></tr>
<tr><td><code>impute</code></td>
<td>
<p>A logical value indicating whether multiple imputation is used or not.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Numeric vector of the effect size (Cohen's d) for each estimate.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wong, V. C., Steiner, P. M., Cook, T. D. (2013). 
Analyzing regression-discontinuity designs with multiple assignment variables: 
A comparative study of four estimation methods.
Journal of Educational and Behavioral Statistics, 38(2), 107-141.
<a href="https://journals.sagepub.com/doi/10.3102/1076998611432172">https://journals.sagepub.com/doi/10.3102/1076998611432172</a>.
</p>
<p>Imbens, G., Kalyanaraman, K. (2009). 
Optimal bandwidth choice for the regression discontinuity estimator 
(Working Paper No. 14726). National Bureau of Economic Research.
<a href="https://www.nber.org/papers/w14726">https://www.nber.org/papers/w14726</a>.
</p>
<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>
<p>Lee, D. S., Card, D. (2010).
Regression discontinuity inference with specification error. 
Journal of Econometrics, 142(2), 655-674. 
<a href="https://doi.org/10.1016/j.jeconom.2007.05.003">doi:10.1016/j.jeconom.2007.05.003</a>.
</p>
<p>Lee, D. S., Lemieux, T. (2010).
Regression Discontinuity Designs in Economics.
Journal of Economic Literature, 48(2), 281-355. 
<a href="https://doi.org/10.1257/jel.48.2.281">doi:10.1257/jel.48.2.281</a>.
</p>
<p>Zeileis, A. (2006).
Object-oriented computation of sandwich estimators.
Journal of Statistical Software, 16(9), 1-16.
<a href="https://doi.org/10.18637/jss.v016.i09">doi:10.18637/jss.v016.i09</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x1 &lt;- runif(1000, -1, 1)
x2 &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * (x1 &gt;= 0) + 3 * cov + 10 * (x2 &gt;= 0) + rnorm(1000)
# centering
mrd_est(y ~ x1 + x2 | cov, method = "center", t.design = c("geq", "geq"))
# univariate
mrd_est(y ~ x1 + x2 | cov, method = "univ", t.design = c("geq", "geq"))
# frontier
mrd_est(y ~ x1 + x2 | cov, method = "front", t.design = c("geq", "geq"))
</code></pre>

<hr>
<h2 id='mrd_impute'>Multiple Imputation of Multivariate Regression Discontinuity Estimation</h2><span id='topic+mrd_impute'></span>

<h3>Description</h3>

<p><code>mrd_impute</code> estimates treatment effects in a multivariate regression discontinuity design (MRDD) with imputed missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mrd_impute(
  formula,
  data,
  subset = NULL,
  cutpoint = NULL,
  bw = NULL,
  front.bw = NA,
  m = 10,
  k = 5,
  kernel = "triangular",
  se.type = "HC1",
  cluster = NULL,
  impute = NULL,
  verbose = FALSE,
  less = FALSE,
  est.cov = FALSE,
  est.itt = FALSE,
  local = 0.15,
  ngrid = 250,
  margin = 0.03,
  boot = NULL,
  method = c("center", "univ", "front"),
  t.design = NULL,
  stop.on.error = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mrd_impute_+3A_formula">formula</code></td>
<td>
<p>The formula of the MRDD; a symbolic description of the model to be fitted. This is supplied in the
format of <code>y ~ x1 + x2</code> for a simple sharp MRDD or <code>y ~ x1 + x2 | c1 + c2</code>
for a sharp MRDD with two covariates. A fuzzy MRDD may be specified as
<code>y ~ x1 + x2 + z</code> where <code>x1</code> is the first running variable,
<code>x2</code> is the second running variable, and 
<code>z</code> is the endogenous treatment variable. Covariates are then included in the 
same manner as in a sharp MRDD.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model. If not found in <code>data</code>,
the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_cutpoint">cutpoint</code></td>
<td>
<p>A numeric vector of length 2 containing the cutpoints at which assignment to the treatment is determined.
The default is <code>c(0, 0)</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_bw">bw</code></td>
<td>
<p>A vector specifying the bandwidths at which to estimate the RD. 
Possible values are <code>"IK09"</code>, <code>"IK12"</code>, and a user-specified non-negative numeric vector specifying the bandwidths at which to estimate the RD.
The default is <code>"IK12"</code>. If <code>bw</code> is <code>"IK12"</code>, the bandwidth is calculated using the Imbens-Kalyanaraman 
2012 method. If <code>bw</code>  is <code>"IK09"</code>, the bandwidth is calculated using 
the Imbens-Kalyanaraman 2009 method. Then the RD is estimated
with that bandwidth, half that bandwidth, and twice that bandwidth. 
If only a single value is passed into the function,
the RD will similarly be estimated at that bandwidth, half that bandwidth, 
and twice that bandwidth.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_front.bw">front.bw</code></td>
<td>
<p>A non-negative numeric vector of length 3 specifying the bandwidths at which to estimate the RD for each
of three effects models (complete model, heterogeneous treatment model, and treatment only model) 
detailed in Wong, Steiner, and Cook (2013). If <code>NA</code>, <code>front.bw</code> will be determined by cross-validation. The default is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_m">m</code></td>
<td>
<p>A non-negative integer specifying the number of uniformly-at-random samples to draw as search candidates for <code>front.bw</code>,
if <code>front.bw</code> is <code>NA</code>. The default is 10.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_k">k</code></td>
<td>
<p>A non-negative integer specifying the number of folds for cross-validation to determine <code>front.bw</code>,
if <code>front.bw</code> is <code>NA</code>. The default is 5.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_se.type">se.type</code></td>
<td>
<p>This specifies the robust standard error calculation method to use,
from the &quot;sandwich&quot; package. Options are,
as in <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>, <code>"HC3"</code>, <code>"const"</code>, <code>"HC"</code>, <code>"HC0"</code>, 
<code>"HC1"</code>, <code>"HC2"</code>, <code>"HC4"</code>, <code>"HC4m"</code>, <code>"HC5"</code>.
The default is <code>"HC1"</code>. This option is overridden by <code>cluster</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_cluster">cluster</code></td>
<td>
<p>An optional vector of length n specifying clusters within which the errors are assumed
to be correlated. This will result in reporting cluster robust SEs. This option overrides
anything specified in <code>se.type</code>. It is suggested that data with a discrete running 
variable be clustered by each unique value of the running variable (Lee and Card, 2008).</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_impute">impute</code></td>
<td>
<p>An optional vector of length n containing a grouping variable that 
specifies the imputed variables with missing values.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print additional information to 
the terminal. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_less">less</code></td>
<td>
<p>Logical. If <code>TRUE</code>, return the estimates of parametric linear
and optimal bandwidth non-parametric models only. If <code>FALSE</code> 
return the estimates of linear, quadratic, and cubic parametric models and 
optimal, half and double bandwidths in non-parametric models. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_est.cov">est.cov</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimates of covariates will be included.
If <code>FALSE</code>, the estimates of covariates will not be included. The default is <code>FALSE</code>. This option is not
applicable if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_est.itt">est.itt</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimates of intent-to-treat (ITT) will be returned.
If <code>FALSE</code>, the estimates of ITT will not be returned. The default is <code>FALSE</code>. This option is not
applicable if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_local">local</code></td>
<td>
<p>A non-negative numeric value specifying the range of neighboring points around the cutoff on the 
standardized scale, for each assignment variable. The default is 0.15.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_ngrid">ngrid</code></td>
<td>
<p>A non-negative integer specifying the number of non-zero grid points on each assignment variable,
which is also the number of zero grid points on each assignment variable. The default is 250. The value used in 
Wong, Steiner and Cook (2013) is 2500, which may cause long computational time.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_margin">margin</code></td>
<td>
<p>A non-negative numeric value specifying the range of grid points beyond the minimum and maximum
of sample points on each assignment variable. The default is 0.03.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_boot">boot</code></td>
<td>
<p>An optional non-negative integer specifying the number of bootstrap samples to obtain standard error of estimates.
This argument is not optional if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_method">method</code></td>
<td>
<p>A string specifying the method to estimate the RD effect. Options are <code>"center"</code>, 
<code>"univ"</code>, <code>"front"</code>, based on the centering, univariate, and frontier
approaches (respectively) from Wong, Steiner, and Cook (2013).</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_t.design">t.design</code></td>
<td>
<p>A character vector of length 2 specifying the treatment option according to design.
The first entry is for <code>x1</code> and the second entry is for <code>x2</code>. Options are  
<code>"g"</code> (treatment is assigned if <code>x1</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x1</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x1</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x1</code> is less than or equal to its cutoff).
The same options are available for <code>x2</code>.</p>
</td></tr>
<tr><td><code id="mrd_impute_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>A logical value indicating whether to remove bootstraps which cause error in the <code>integrate</code> function. If <code>TRUE</code>, bootstraps which cause error are removed
and resampled until the specified number of 
bootstrap samples are acquired. If <code>FALSE</code>, bootstraps which cause error are not removed. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mrd_impute</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>mrd</code>&quot; or <code>"mrdi"</code> for <code>"front"</code> method.
The function <code>summary</code> is used to obtain and print a summary of the 
estimated regression discontinuity. The object of class <code>mrd</code> is a list 
containing the following components for each estimated treatment effect,
<code>tau_MRD</code> or <code>tau_R</code> and <code>tau_M</code>:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>A string denoting either <code>"sharp"</code> or <code>"fuzzy"</code> RDD.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>The names of covariates.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Numeric vector of each bandwidth used in estimation.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>Vector of the number of observations within the corresponding bandwidth.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>For a sharp design, a list of the <code>lm</code> objects is returned.
For a fuzzy design, a list of lists is returned, each with two elements: 
<code>firststage</code>, the first stage <code>lm</code> object, and <code>iv</code>, the <code>ivreg</code> object. 
A model is returned for each parametric and non-parametric case and corresponding bandwidth.</p>
</td></tr>
<tr><td><code>frame</code></td>
<td>
<p>Returns the model frame used in fitting.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>The observations removed from fitting due to missingness.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>Numeric vector of the estimate of the discontinuity in the outcome under 
a sharp MRDD or the Wald estimator in the fuzzy MRDD, for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Numeric vector of the effect size (Cohen's d) for each estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Numeric vector of the standard error for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Numeric vector of the z statistic for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Numeric vector of the degrees of freedom computed using Barnard and Rubin (1999)
adjustment for imputation.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Numeric vector of the p-value for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>The matrix of the 95
for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>impute</code></td>
<td>
<p>A logical value indicating whether multiple imputation is used or not.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wong, V. C., Steiner, P. M., Cook, T. D. (2013). 
Analyzing regression-discontinuity designs with multiple assignment variables: 
A comparative study of four estimation methods.
Journal of Educational and Behavioral Statistics, 38(2), 107-141.
<a href="https://journals.sagepub.com/doi/10.3102/1076998611432172">https://journals.sagepub.com/doi/10.3102/1076998611432172</a>.
</p>
<p>Lee, D. S., Lemieux, T. (2010).
Regression Discontinuity Designs in Economics.
Journal of Economic Literature, 48(2), 281-355. 
<a href="https://doi.org/10.1257/jel.48.2.281">doi:10.1257/jel.48.2.281</a>.
</p>
<p>Lee, D. S., Card, D. (2010).
Regression discontinuity inference with specification error. 
Journal of Econometrics, 142(2), 655-674. 
<a href="https://doi.org/10.1016/j.jeconom.2007.05.003">doi:10.1016/j.jeconom.2007.05.003</a>.
</p>
<p>Barnard, J., Rubin, D. (1999).
Small-Sample Degrees of Freedom with Multiple Imputation.
Biometrika, 86(4), 948-55.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x1 &lt;- runif(300, -1, 1)
x2 &lt;- runif(300, -1, 1)
cov &lt;- rnorm(300)
y &lt;- 3 + 2 * (x1 &gt;= 0) + 3 * cov + 10 * (x2 &gt;= 0) + rnorm(300)
imp &lt;- rep(1:3, each = 100)
# all examples below have smaller numbers of m to keep run-time low
# centering
mrd_impute(y ~ x1 + x2 | cov, impute = imp, method = "center", t.design = c("geq", "geq"), m = 3)
# univariate
mrd_impute(y ~ x1 + x2 | cov, impute = imp, method = "univ", t.design = c("geq", "geq"), m = 3)
# frontier - don't run due to computation time
## Not run: mrd_impute(y ~ x1 + x2 | cov, impute = imp, method = "front",
                    boot = 1000, t.design = c("geq", "geq"), m = 3)
## End(Not run)
</code></pre>

<hr>
<h2 id='mrd_power'>Power Analysis of Multivariate Regression Discontinuity</h2><span id='topic+mrd_power'></span>

<h3>Description</h3>

<p><code>mrd_power</code> computes the empirical probability that a resulting parameter
estimate of the MRD is significant,
i.e. the empirical power (1 - beta).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mrd_power(
  num.rep = 100,
  sample.size = 100,
  x1.dist = "normal",
  x1.para = c(0, 1),
  x2.dist = "normal",
  x2.para = c(0, 1),
  x1.cut = 0,
  x2.cut = 0,
  x1.fuzzy = c(0, 0),
  x2.fuzzy = c(0, 0),
  x1.design = NULL,
  x2.design = NULL,
  coeff = c(0.1, 0.5, 0.5, 1, rep(0.1, 9)),
  eta.sq = 0.5,
  alpha.list = c(0.001, 0.01, 0.05)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mrd_power_+3A_num.rep">num.rep</code></td>
<td>
<p>A non-negative integer specifying the number of repetitions used to calculate the empirical power. The default is 100.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_sample.size">sample.size</code></td>
<td>
<p>A non-negative integer specifying the number of observations in each sample. The default is 100.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x1.dist">x1.dist</code></td>
<td>
<p>A string specifying the distribution of the first assignment variable, <code>x1</code>.
Options are <code>"normal"</code> and  <code>"uniform"</code>. The default is the <code>"normal"</code> distribution.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x1.para">x1.para</code></td>
<td>
<p>A numeric vector of length 2 specifying parameters of the distribution of the first assignment variable, <code>x1</code>.
If <code>x1.dist</code> is <code>"normal"</code>, then <code>x1.para</code> includes the
mean and standard deviation of the normal distribution.
If <code>x1.dist</code> is <code>"uniform"</code>, then <code>x1.para</code> includes the 
upper and lower boundaries of the uniform distribution. The default is <code>c(0,1)</code>.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x2.dist">x2.dist</code></td>
<td>
<p>A string specifying the distribution of the second assignment variable, <code>x2</code>.
Options are <code>"normal"</code> and  <code>"uniform"</code>. The default is the <code>"normal"</code> distribution.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x2.para">x2.para</code></td>
<td>
<p>A numeric vector of length 2 specifying parameters of the distribution of the second assignment variable, <code>x2</code>.
If <code>x2.dist</code> is <code>"normal"</code>, then <code>x2.para</code> includes the
mean and standard deviation of the normal distribution.
If <code>x2.dist</code> is <code>"uniform"</code>, then <code>x2.para</code> includes the 
upper and lower boundaries of the uniform distribution. The default is <code>c(0,1)</code>.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x1.cut">x1.cut</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined for the first assignment variable, <code>x1</code>. The default is 0.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x2.cut">x2.cut</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined for the second assignment variable, <code>x2</code>. The default is 0.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x1.fuzzy">x1.fuzzy</code></td>
<td>
<p>A numeric vector of length 2 specifying the probabilities to be
assigned to the control condition, in terms of the first
assignment variable, <code>x1</code>, for individuals in the treatment based on the cutoff, 
and to treatment for individuals in the control condition based on the cutoff.
For a sharp design, both entries are 0. 
For a fuzzy design, the first entry is the probability to be assigned to 
control for individuals above the cutpoint, and the second entry is the 
probability to be assigned to treatment for individuals below the cutpoint.
The default is <code>c(0,0)</code>, indicating a sharp design.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x2.fuzzy">x2.fuzzy</code></td>
<td>
<p>A numeric vector of length 2 specifying the probabilities to be assigned to the control, in terms of the second
assignment variable, <code>x2</code>, for individuals in the treatment based on the cutoff, 
and to treatment for individuals in the control based on the cutoff.
For a sharp design, both entries are 0. 
For a fuzzy design, the first entry is the probability to be assigned to 
control for individuals above the cutpoint, and the second entry is the 
probability to be assigned to treatment for individuals below the cutpoint.
The default is <code>c(0,0)</code>, indicating a sharp design.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x1.design">x1.design</code></td>
<td>
<p>A string specifying the treatment option according to design for <code>x1</code>. Options are
<code>"g"</code> (treatment is assigned if <code>x1</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x1</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x1</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x1</code> is less than or equal to its cutoff).</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_x2.design">x2.design</code></td>
<td>
<p>A string specifying the treatment option according to design for <code>x2</code>. Options are
<code>"g"</code> (treatment is assigned if <code>x2</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x2</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x2</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x2</code> is less than or equal to its cutoff).</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_coeff">coeff</code></td>
<td>
<p>A numeric vector specifying coefficients of variables in the linear model to generate data. Coefficients are in the following order:
</p>

<ul>
<li><p>The 1st entry is the intercept.
</p>
</li>
<li><p>The 2nd entry is the slope of treatment 1, i.e. treatment effect 1.
</p>
</li>
<li><p>The 3rd entry is the slope of treatment 2, i.e. treatment effect 2.
</p>
</li>
<li><p>The 4th entry is the slope of treatment, i.e. treatment effect.
</p>
</li>
<li><p>The 5th entry is the slope of assignment 1.
</p>
</li>
<li><p>The 6th entry is the slope of assignment 2.
</p>
</li>
<li><p>The 7th entry is the slope of interaction between assignment 1 and assignment 2.
</p>
</li>
<li><p>The 8th entry is the slope of interaction between treatment 1 and assignment 1.
</p>
</li>
<li><p>The 9th entry is the slope of interaction between treatment 2 and assignment 1.
</p>
</li>
<li><p>The 10th entry is the slope of interaction between treatment 1 and assignment 2.
</p>
</li>
<li><p>The 11th entry is the slope of interaction between treatment 2 and assignment 2.
</p>
</li>
<li><p>The 12th entry is the slope of interaction between treatment 1, assignment 1 and assignment 2.
</p>
</li>
<li><p>The 13th entry is the slope of interaction between treatment 2, assignment 1 and assignment 2.
</p>
</li></ul>

<p>The default is <code>c(0.1, 0.5, 0.5, 1, rep(0.1, 9))</code>.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_eta.sq">eta.sq</code></td>
<td>
<p>A numeric value specifying the expected partial eta-squared of the linear model with respect to the 
treatment itself. It is used to control the variance of noise in the linear model. The default is 0.50.</p>
</td></tr>
<tr><td><code id="mrd_power_+3A_alpha.list">alpha.list</code></td>
<td>
<p>A numeric vector containing significance levels (between 0 and 1) used to calculate the empirical alpha.
The default is <code>c(0.001, 0.01, anad 0.05)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mrd_power</code> returns an object of <a href="base.html#topic+class">class</a> 
&quot;<code>mrdp</code>&quot; containing the number of successful iterations,
mean, variance, and power (with <code>alpha</code> of 0.001, 0.01, and 0.05)
for six estimators. The function <code>summary</code>
is used to obtain and print a summary of the power analysis.
The six estimators are as follows:
</p>

<ul>
<li><p>The 1st estimator, <code>Linear</code>, provides results of the linear regression estimator 
of combined RD using the centering approach.
</p>
</li>
<li><p>The 2nd estimator, <code>Opt</code>, provides results of the local linear regression estimator
of combined RD using the centering approach, 
with the optimal bandwidth in the Imbens and Kalyanaraman (2012) paper.
</p>
</li>
<li><p>The 3rd estimator, <code>Linear</code>, provides results of the linear regression estimator 
of separate RD in terms of <code>x1</code> using the univariate approach.
</p>
</li>
<li><p>The 4th estimator, <code>Opt</code>, provides results of the local linear regression estimator
of separate RD in terms of <code>x1</code> using the univariate approach, 
with the optimal bandwidth in the Imbens and Kalyanaraman (2012) paper.
</p>
</li>
<li><p>The 5th estimator, <code>Linear</code>, provides results of the linear regression estimator 
of separate RD in terms of <code>x2</code> using the univariate approach.
</p>
</li>
<li><p>The 6th estimator, <code>Opt</code>, provides results of the local linear regression estimator
of separate RD in terms of <code>x2</code> using the univariate approach, 
with the optimal bandwidth in the Imbens and Kalyanaraman (2012) paper.
</p>
</li></ul>



<h3>References</h3>

<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
summary(mrd_power(x1.design = "l", x2.design = "l"))
summary(mrd_power(x1.dist = "uniform", x1.cut = 0.5,
                  x1.design = "l", x2.design = "l"))
summary(mrd_power(x1.fuzzy = c(0.1, 0.1), x1.design = "l", x2.design = "l"))

## End(Not run)
</code></pre>

<hr>
<h2 id='mrd_sens_bw'>Bandwidth Sensitivity Simulation for Multivariate Regression Discontinuity</h2><span id='topic+mrd_sens_bw'></span>

<h3>Description</h3>

<p><code>mrd_sens_bw</code> refits the supplied model with varying bandwidths. 
All other aspects of the model are held constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mrd_sens_bw(object, approach = c("center", "univ1", "univ2"), bws)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mrd_sens_bw_+3A_object">object</code></td>
<td>
<p>An object returned by <code>mrd_est</code> or <code>mrd_impute</code>.</p>
</td></tr>
<tr><td><code id="mrd_sens_bw_+3A_approach">approach</code></td>
<td>
<p>A string of the approaches to be refitted, 
choosing from <code>c("center", "univ1", "univ2")</code>.</p>
</td></tr>
<tr><td><code id="mrd_sens_bw_+3A_bws">bws</code></td>
<td>
<p>A positive numeric vector of the bandwidths for refitting an <code>mrd</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mrd_sens_bw</code> returns a dataframe containing the estimate <code>est</code>
and standard error <code>se</code> 
for each supplied bandwidth and for the Imbens-Kalyanaraman (2012) optimal bandwidth, <code>bw</code>, 
and for each supplied approach, <code>model</code>. Approaches are either user
specified (<code>"usr"</code>) or based on the optimal bandwidth (<code>"origin"</code>).
</p>


<h3>References</h3>

<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x1 &lt;- runif(10000, -1, 1)
x2 &lt;- rnorm(10000, 10, 2)
cov &lt;- rnorm(10000)
y &lt;- 3 + 2 * x1 + 1 * x2 + 3 * cov + 10 * (x1 &gt;= 0) + 5 * (x2 &gt;= 10) + rnorm(10000)
# front.bw arugment was supplied to speed up the example
# users should choose appropriate values for front.bw
mrd &lt;- mrd_est(y ~ x1 + x2 | cov,
               cutpoint = c(0, 10), t.design = c("geq", "geq"), front.bw=c(1,1,1))
mrd_sens_bw(mrd, approach = "univ1", bws = seq(0.1, 1, length.out = 3))
</code></pre>

<hr>
<h2 id='mrd_sens_cutoff'>Cutoff Sensitivity Simulation for Multivariate Regression Discontinuity</h2><span id='topic+mrd_sens_cutoff'></span>

<h3>Description</h3>

<p><code>mrd_sens_cutoff</code> refits the supplied model with varying cutoff(s). 
All other aspects of the model, such as the automatically calculated bandwidth, are held constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mrd_sens_cutoff(object, cutoffs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mrd_sens_cutoff_+3A_object">object</code></td>
<td>
<p>An object returned by <code>mrd_est</code> or <code>mrd_impute</code>.</p>
</td></tr>
<tr><td><code id="mrd_sens_cutoff_+3A_cutoffs">cutoffs</code></td>
<td>
<p>A two-column numeric matrix of paired cutoff values 
to be used for refitting an <code>mrd</code> object. The first column corresponds
to cutoffs for <code>x1</code> and the second column corresponds to cutoffs
for <code>x2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mrd_sens_cutoff</code> returns a dataframe containing the estimate <code>est</code> and standard error <code>se</code> 
for each pair of cutoffs (<code>A1</code> and <code>A2</code>) and for each <code>model</code>. <code>A1</code> contains varying cutoffs 
for assignment 1 and <code>A2</code> contains varying cutoffs for assignment 2.
The <code>model</code> column contains the approach (either centering, univariate 1, or univariate 2)
for determining the cutoff and the parametric model (linear, quadratic, or cubic) or 
non-parametric bandwidth setting (Imbens-Kalyanaraman 2012 optimal, half, or double) used for estimation.
</p>


<h3>References</h3>

<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x1 &lt;- runif(5000, -1, 1)
x2 &lt;- rnorm(5000, 10, 2)
cov &lt;- rnorm(5000)
y &lt;- 3 + 2 * x1 + 1 * x2 + 3 * cov + 10 * (x1 &gt;= 0) + 5 * (x2 &gt;= 10) + rnorm(5000)
# front.bw arugment was supplied to speed up the example
# users should choose appropriate values for front.bw
mrd &lt;- mrd_est(y ~ x1 + x2 | cov,
               cutpoint = c(0, 10), t.design = c("geq", "geq"), front.bw = c(1,1,1))
mrd_sens_cutoff(mrd, expand.grid(A1 = seq(-.5, .5, length.out = 3), A2 = 10))
</code></pre>

<hr>
<h2 id='plot.mfrd'>Plot the Multivariate Frontier Regression Discontinuity</h2><span id='topic+plot.mfrd'></span>

<h3>Description</h3>

<p><code>plot.mfrd</code> plots a 3D illustration of the bivariate frontier regression discontinuity design (RDD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mfrd'
plot(
  x,
  model = c("m_s", "m_h", "m_t"),
  methodname = c("Param", "bw", "Half-bw", "Double-bw"),
  gran = 10,
  raw_data = TRUE,
  color_surface = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mfrd_+3A_x">x</code></td>
<td>
<p>An <code>mfrd</code> object returned by <code>mfrd_est</code> or contained in the object 
returned by <code>mrd_est</code>.</p>
</td></tr>
<tr><td><code id="plot.mfrd_+3A_model">model</code></td>
<td>
<p>A string containing the model specification. Options include one of <code>c("m_s", "m_h", "m_t")</code>,
which denote the complete model, heterogeneous treatment model, and treatment only 
model, respectively.</p>
</td></tr>
<tr><td><code id="plot.mfrd_+3A_methodname">methodname</code></td>
<td>
<p>A string containing the method specification.
Options include one of <code>c("Param", "bw", "Half-bw", "Double-bw")</code>.</p>
</td></tr>
<tr><td><code id="plot.mfrd_+3A_gran">gran</code></td>
<td>
<p>A non-negative integer specifying the granularity of the surface grid (i.e. the desired number of predicted points 
before and after the cutoff, along each assignment variable). The default is 10.</p>
</td></tr>
<tr><td><code id="plot.mfrd_+3A_raw_data">raw_data</code></td>
<td>
<p>A logical value indicating whether the raw data points are plotted. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mfrd_+3A_color_surface">color_surface</code></td>
<td>
<p>A logical value indicating whether the treated surface is colored. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.mfrd_+3A_...">...</code></td>
<td>
<p>Additional graphic arguments passed to <code>persp</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x1 &lt;- runif(1000, -1, 1)
x2 &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * (x1 &gt;= 0) + 3 * cov + 10 * (x2 &gt;= 0) + rnorm(1000)
model &lt;- mrd_est(y ~ x1 + x2, cutpoint = c(0, 0), t.design = c("geq", "geq"))
plot(model$front$tau_MRD, "m_s", "Param")
</code></pre>

<hr>
<h2 id='plot.rd'>Plot the Regression Discontinuity</h2><span id='topic+plot.rd'></span>

<h3>Description</h3>

<p><code>plot.rd</code> plots the relationship between the running variable and the outcome.
It is based on the <code>plot.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rd'
plot(
  x,
  preds = NULL,
  fit_line = c("linear", "quadratic", "cubic", "optimal", "half", "double"),
  fit_ci = c("area", "dot", "hide"),
  fit_ci_level = 0.95,
  bin_n = 20,
  bin_level = 0.95,
  bin_size = c("shade", "size"),
  quant_bin = TRUE,
  xlim = NULL,
  ylim = NULL,
  include_rugs = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.rd_+3A_x">x</code></td>
<td>
<p>An <code>rd</code> object, typically the result of <code><a href="#topic+rd_est">rd_est</a></code>.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_preds">preds</code></td>
<td>
<p>An optional vector of predictions generated by <code><a href="#topic+predict.rd">predict.rd</a></code>.
If not supplied, prediction is completed within the <code>plot.rd</code> function.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_fit_line">fit_line</code></td>
<td>
<p>A character vector specifying models to be shown as fitted lines.
Options are <code>c("linear", "quadratic", "cubic", "optimal", "half", "double")</code>.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_fit_ci">fit_ci</code></td>
<td>
<p>A string specifying whether and how to plot prediction confidence intervals
around the fitted lines. Options are <code>c("area", "dot", "hide")</code>.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_fit_ci_level">fit_ci_level</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence level of prediction CIs. The default is 0.95.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_bin_n">bin_n</code></td>
<td>
<p>An integer specifying the number of bins for binned data points. If <code>bin_n</code> is 0, raw data points are plotted.
If <code>bin_n</code> is &lt; 0, data points are suppressed. The default is 20.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_bin_level">bin_level</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence level for CIs around binned data points. The default is 0.95.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_bin_size">bin_size</code></td>
<td>
<p>A string specifying how to plot the number of observations in each bin, by <code>"size"</code> or <code>"shape"</code>.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_quant_bin">quant_bin</code></td>
<td>
<p>A logical value indicating whether the data are binned by quantiles. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_xlim">xlim</code></td>
<td>
<p>An optional numeric vector containing the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_ylim">ylim</code></td>
<td>
<p>An optional numeric vector containing the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_include_rugs">include_rugs</code></td>
<td>
<p>A logical value indicating whether to include the 1d plot for both axes. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.rd_+3A_...">...</code></td>
<td>
<p>Additional graphic arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345) 
dat &lt;- data.frame(x = runif(1000, -1, 1), cov = rnorm(1000))
dat$tr &lt;- as.integer(dat$x &gt;= 0)
dat$y &lt;- 3 + 2 * dat$x + 3 * dat$cov + 10 * (dat$x &gt;= 0) + rnorm(1000)
rd &lt;- rd_est(y ~ x + tr | cov, data = dat, cutpoint = 0, t.design = "geq") 
plot(rd)
</code></pre>

<hr>
<h2 id='predict.rd'>Predict the Regression Discontinuity</h2><span id='topic+predict.rd'></span>

<h3>Description</h3>

<p><code>predict.rd</code> makes predictions of means and standard deviations of RDs at different cutoffs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rd'
predict(object, gran = 50, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.rd_+3A_object">object</code></td>
<td>
<p>An <code>rd</code> object, typically the result of <code><a href="#topic+rd_est">rd_est</a></code>.</p>
</td></tr>
<tr><td><code id="predict.rd_+3A_gran">gran</code></td>
<td>
<p>A non-negative integer specifying the granularity of the data points (i.e. the desired number of predicted points). The default is 50.</p>
</td></tr>
<tr><td><code id="predict.rd_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>predict</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * x + 3 * cov + 10 * (x &gt;= 0) + rnorm(1000)
tr &lt;- as.integer(x &gt;= 0)
rd &lt;- rd_est(y ~ x + tr | cov, cutpoint = 0, t.design = "geq") 
predict(rd)
</code></pre>

<hr>
<h2 id='print.mfrd'>Print the Multivariate Frontier Regression Discontinuity</h2><span id='topic+print.mfrd'></span>

<h3>Description</h3>

<p><code>print.mfrd</code> prints a very basic summary of the multivariate frontier regression 
discontinuity. It is based on the <code>print.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mfrd'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mfrd_+3A_x">x</code></td>
<td>
<p>An <code>mfrd</code> object, typically the result of <code><a href="#topic+mfrd_est">mfrd_est</a></code>.</p>
</td></tr>
<tr><td><code id="print.mfrd_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to print.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="print.mfrd_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>print</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='print.rd'>Print the Regression Discontinuity</h2><span id='topic+print.rd'></span>

<h3>Description</h3>

<p><code>print.rd</code> prints a basic summary of the regression discontinuity.
<code>print.rd</code> is based on the <code>print.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rd'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.rd_+3A_x">x</code></td>
<td>
<p>An <code>rd</code> object, typically the result of <code><a href="#topic+rd_est">rd_est</a></code>.</p>
</td></tr>
<tr><td><code id="print.rd_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to print.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="print.rd_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>print</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='rd_est'>Regression Discontinuity Estimation</h2><span id='topic+rd_est'></span>

<h3>Description</h3>

<p><code>rd_est</code> estimates both sharp and fuzzy RDDs using parametric and non-parametric 
(local linear) models. 
It is based on the <code>RDestimate</code> function in the &quot;rdd&quot; package.
Sharp RDDs (both parametric and non-parametric) are estimated using <code>lm</code> in the 
<span class="pkg">stats</span> package.
Fuzzy RDDs (both parametric and non-parametric) are estimated using two-stage least-squares 
<code>ivreg</code> in the <span class="pkg">AER</span> package. 
For non-parametric models, Imbens-Kalyanaraman optimal bandwidths can be used,
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd_est(
  formula,
  data,
  subset = NULL,
  cutpoint = NULL,
  bw = NULL,
  kernel = "triangular",
  se.type = "HC1",
  cluster = NULL,
  verbose = FALSE,
  less = FALSE,
  est.cov = FALSE,
  est.itt = FALSE,
  t.design = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rd_est_+3A_formula">formula</code></td>
<td>
<p>The formula of the RDD; a symbolic description of the model to be fitted. This is supplied in the
format of <code>y ~ x</code> for a simple sharp RDD or <code>y ~ x | c1 + c2</code>
for a sharp RDD with two covariates. A fuzzy RDD may be specified as
<code>y ~ x + z</code> where <code>x</code> is the running variable, and 
<code>z</code> is the endogenous treatment variable. Covariates are included in the 
same manner as in a sharp RDD.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model. If not found in <code>data</code>,
the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_cutpoint">cutpoint</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined. The default is 0.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_bw">bw</code></td>
<td>
<p>A vector specifying the bandwidths at which to estimate the RD. 
Possible values are <code>"IK09"</code>, <code>"IK12"</code>, and a user-specified non-negative numeric vector specifying the bandwidths at which to estimate the RD.
The default is <code>"IK12"</code>. If <code>bw</code> is <code>"IK12"</code>, the bandwidth is calculated using the Imbens-Kalyanaraman 
2012 method. If <code>bw</code>  is <code>"IK09"</code>, the bandwidth is calculated using 
the Imbens-Kalyanaraman 2009 method. Then the RD is estimated
with that bandwidth, half that bandwidth, and twice that bandwidth. 
If only a single value is passed into the function,
the RD will similarly be estimated at that bandwidth, half that bandwidth, 
and twice that bandwidth.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_se.type">se.type</code></td>
<td>
<p>This specifies the robust standard error calculation method to use,
from the &quot;sandwich&quot; package. Options are,
as in <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>, <code>"HC3"</code>, <code>"const"</code>, <code>"HC"</code>, <code>"HC0"</code>, 
<code>"HC1"</code>, <code>"HC2"</code>, <code>"HC4"</code>, <code>"HC4m"</code>, <code>"HC5"</code>. 
The default is <code>"HC1"</code>. This option is overridden by <code>cluster</code>.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_cluster">cluster</code></td>
<td>
<p>An optional vector of length n specifying clusters within which the errors are assumed
to be correlated. This will result in reporting cluster robust SEs. This option overrides
anything specified in <code>se.type</code>. It is suggested that data with a discrete running 
variable be clustered by each unique value of the running variable (Lee and Card, 2008).</p>
</td></tr>
<tr><td><code id="rd_est_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print additional information to 
the terminal. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_less">less</code></td>
<td>
<p>Logical. If <code>TRUE</code>, return the estimates of linear and optimal. If <code>FALSE</code> 
return the estimates of linear, quadratic, cubic, optimal, half and double. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_est.cov">est.cov</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimates of covariates will be included.
If <code>FALSE</code>, the estimates of covariates will not be included. The default is <code>FALSE</code>. This option is not
applicable if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_est.itt">est.itt</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimates of ITT will be returned.
The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="rd_est_+3A_t.design">t.design</code></td>
<td>
<p>A string specifying the treatment option according to design.
Options are <code>"g"</code> (treatment is assigned if <code>x</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x</code> is less than or equal to its cutoff).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rd_est</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>rd</code>&quot;.
The functions <code>summary</code> and <code>plot</code> are used to obtain and print a summary and 
plot of the estimated regression discontinuity. The object of class <code>rd</code> is a list 
containing the following components:
</p>
<table role = "presentation">
<tr><td><code>type</code></td>
<td>
<p>A string denoting either <code>"sharp"</code> or <code>"fuzzy"</code> RDD.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>Numeric vector of the estimate of the discontinuity in the outcome under 
a sharp RDD or the Wald estimator in the fuzzy RDD, for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Numeric vector of the standard error for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Numeric vector of the z statistic for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Numeric vector of the p-value for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>The matrix of the 95
for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Numeric vector of the effect size (Cohen's d) for each estimate.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>The names of covariates.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Numeric vector of each bandwidth used in estimation.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>Vector of the number of observations within the corresponding bandwidth.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>The number of observations removed from fitting due to missingness.</p>
</td></tr>
<tr><td><code>impute</code></td>
<td>
<p>A logical value indicating whether multiple imputation is used or not.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>For a sharp design, a list of the <code>lm</code> objects is returned.
For a fuzzy design, a list of lists is returned, each with two elements: 
<code>firststage</code>, the first stage <code>lm</code> object, and <code>iv</code>, the <code>ivreg</code> object. 
A model is returned for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>frame</code></td>
<td>
<p>Returns the dataframe used in fitting the model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Lee, D. S., Lemieux, T. (2010).
Regression Discontinuity Designs in Economics.
Journal of Economic Literature, 48(2), 281-355. 
<a href="https://doi.org/10.1257/jel.48.2.281">doi:10.1257/jel.48.2.281</a>.
</p>
<p>Imbens, G., Lemieux, T. (2008).
Regression discontinuity designs: A guide to practice.
Journal of Econometrics, 142(2), 615-635. 
<a href="https://doi.org/10.1016/j.jeconom.2007.05.001">doi:10.1016/j.jeconom.2007.05.001</a>.
</p>
<p>Lee, D. S., Card, D. (2010).
Regression discontinuity inference with specification error. 
Journal of Econometrics, 142(2), 655-674. 
<a href="https://doi.org/10.1016/j.jeconom.2007.05.003">doi:10.1016/j.jeconom.2007.05.003</a>.
</p>
<p>Angrist, J. D., Pischke, J.-S. (2009). 
Mostly harmless econometrics: An empiricist's companion. 
Princeton, NJ: Princeton University Press.
</p>
<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>
<p>Imbens, G., Kalyanaraman, K. (2009). 
Optimal bandwidth choice for the regression discontinuity estimator 
(Working Paper No. 14726). National Bureau of Economic Research.
<a href="https://www.nber.org/papers/w14726">https://www.nber.org/papers/w14726</a>.
</p>
<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * x + 3 * cov + 10 * (x &gt;= 0) + rnorm(1000)
rd_est(y ~ x, t.design = "geq")
# Efficiency gains can be made by including covariates (review SEs in "summary" output).
rd_est(y ~ x | cov, t.design = "geq")
</code></pre>

<hr>
<h2 id='rd_impute'>Multiple Imputation of Regression Discontinuity Estimation</h2><span id='topic+rd_impute'></span>

<h3>Description</h3>

<p><code>rd_impute</code> estimates treatment effects in an RDD with imputed missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd_impute(
  formula,
  data,
  subset = NULL,
  cutpoint = NULL,
  bw = NULL,
  kernel = "triangular",
  se.type = "HC1",
  cluster = NULL,
  impute = NULL,
  verbose = FALSE,
  less = FALSE,
  est.cov = FALSE,
  est.itt = FALSE,
  t.design = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rd_impute_+3A_formula">formula</code></td>
<td>
<p>The formula of the RDD; a symbolic description of the model to be fitted. This is supplied in the
format of <code>y ~ x</code> for a simple sharp RDD or <code>y ~ x | c1 + c2</code>
for a sharp RDD with two covariates. A fuzzy RDD may be specified as
<code>y ~ x + z</code> where <code>x</code> is the running variable, and 
<code>z</code> is the endogenous treatment variable. Covariates are included in the 
same manner as in a sharp RDD.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model. If not found in <code>data</code>,
the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_cutpoint">cutpoint</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined. The default is 0.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_bw">bw</code></td>
<td>
<p>A vector specifying the bandwidths at which to estimate the RD. 
Possible values are <code>"IK09"</code>, <code>"IK12"</code>, and a user-specified non-negative numeric vector specifying the bandwidths at which to estimate the RD.
The default is <code>"IK12"</code>. If <code>bw</code> is <code>"IK12"</code>, the bandwidth is calculated using the Imbens-Kalyanaraman 
2012 method. If <code>bw</code>  is <code>"IK09"</code>, the bandwidth is calculated using 
the Imbens-Kalyanaraman 2009 method. Then the RD is estimated
with that bandwidth, half that bandwidth, and twice that bandwidth. 
If only a single value is passed into the function,
the RD will similarly be estimated at that bandwidth, half that bandwidth, 
and twice that bandwidth.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_se.type">se.type</code></td>
<td>
<p>This specifies the robust standard error calculation method to use,
from the &quot;sandwich&quot; package. Options are,
as in <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>, <code>"HC3"</code>, <code>"const"</code>, <code>"HC"</code>, <code>"HC0"</code>, 
<code>"HC1"</code>, <code>"HC2"</code>, <code>"HC4"</code>, <code>"HC4m"</code>, <code>"HC5"</code>. This option 
is overridden by <code>cluster</code>.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_cluster">cluster</code></td>
<td>
<p>An optional vector specifying clusters within which the errors are assumed
to be correlated. This will result in reporting cluster robust SEs. This option overrides
anything specified in <code>se.type</code>. It is suggested that data with a discrete running 
variable be clustered by each unique value of the running variable (Lee and Card, 2008).</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_impute">impute</code></td>
<td>
<p>An optional vector of length n, indexing whole imputations.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to print additional information to 
the terminal. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_less">less</code></td>
<td>
<p>Logical. If <code>TRUE</code>, return the estimates of linear and optimal. If <code>FALSE</code> 
return the estimates of linear, quadratic, cubic, optimal, half and double. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_est.cov">est.cov</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimates of covariates will be included.
If <code>FALSE</code>, the estimates of covariates will not be included. The default is <code>FALSE</code>. This option is not
applicable if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_est.itt">est.itt</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimates of ITT will be returned.
If <code>FALSE</code>, the estimates of ITT will not be returned. The default is <code>FALSE</code>. This option is not
applicable if method is <code>"front"</code>.</p>
</td></tr>
<tr><td><code id="rd_impute_+3A_t.design">t.design</code></td>
<td>
<p>A string specifying the treatment option according to design.
Options are <code>"g"</code> (treatment is assigned if <code>x</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x</code> is less than or equal to its cutoff).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rd_impute</code> returns an object of <a href="base.html#topic+class">class</a> &quot;<code>rd</code>&quot;.
The functions <code>summary</code> and <code>plot</code> are used to obtain and print a summary and 
plot of the estimated regression discontinuity. The object of class <code>rd</code> is a list 
containing the following components:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>impute</code></td>
<td>
<p>A logical value indicating whether multiple imputation is used or not.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>A string denoting either <code>"sharp"</code> or <code>"fuzzy"</code> RDD.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>The names of covariates.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Numeric vector of each bandwidth used in estimation.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>Vector of the number of observations within the corresponding bandwidth.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>For a sharp design, a list of the <code>lm</code> objects is returned.
For a fuzzy design, a list of lists is returned, each with two elements: 
<code>firststage</code>, the first stage <code>lm</code> object, and <code>iv</code>, the <code>ivreg</code> object. 
A model is returned for each parametric and non-parametric case and corresponding bandwidth.</p>
</td></tr>
<tr><td><code>frame</code></td>
<td>
<p>Returns the model frame used in fitting.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>The observations removed from fitting due to missingness.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>Numeric vector of the estimate of the discontinuity in the outcome under 
a sharp RDD or the Wald estimator in the fuzzy RDD, for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Numeric vector of the effect size (Cohen's d) for each estimate.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Numeric vector of the standard error for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Numeric vector of the z statistic for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Numeric vector of the degrees of freedom computed using Barnard and Rubin (1999)
adjustment for imputation.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Numeric vector of the p-value for each corresponding bandwidth.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>The matrix of the 95
for each corresponding bandwidth.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Lee, D. S., Card, D. (2010).
Regression discontinuity inference with specification error. 
Journal of Econometrics, 142(2), 655-674. 
<a href="https://doi.org/10.1016/j.jeconom.2007.05.003">doi:10.1016/j.jeconom.2007.05.003</a>.
</p>
<p>Imbens, G., Kalyanaraman, K. (2009). 
Optimal bandwidth choice for the regression discontinuity estimator 
(Working Paper No. 14726). National Bureau of Economic Research.
<a href="https://www.nber.org/papers/w14726">https://www.nber.org/papers/w14726</a>.
</p>
<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>
<p>Barnard, J., Rubin, D. (1999).
Small-Sample Degrees of Freedom with Multiple Imputation.
Biometrika, 86(4), 948-55.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * x + 3 * cov + 10 * (x &lt; 0) + rnorm(1000)
group &lt;- rep(1:10, each = 100)
rd_impute(y ~ x, impute = group, t.design = "l")
# Efficiency gains can be made by including covariates (review SEs in "summary" output).
rd_impute(y ~ x | cov, impute = group, t.design = "l")
</code></pre>

<hr>
<h2 id='rd_power'>Power Analysis of Regression Discontinuity</h2><span id='topic+rd_power'></span>

<h3>Description</h3>

<p><code>rd_power</code> computes the empirical probability that a resulting parameter
estimate of the MRD is significant,
i.e. the empirical power (1 - beta).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd_power(
  num.rep = 100,
  sample.size = 100,
  x.dist = "normal",
  x.para = c(0, 1),
  x.cut = 0,
  x.fuzzy = c(0, 0),
  x.design = NULL,
  coeff = c(0.3, 1, 0.2, 0.3),
  eta.sq = 0.5,
  alpha.list = c(0.001, 0.01, 0.05)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rd_power_+3A_num.rep">num.rep</code></td>
<td>
<p>A non-negative integer specifying the number of repetitions used to calculate the empirical power. The default is 100.</p>
</td></tr>
<tr><td><code id="rd_power_+3A_sample.size">sample.size</code></td>
<td>
<p>A non-negative integer specifying the number of observations in each sample. The default is 100.</p>
</td></tr>
<tr><td><code id="rd_power_+3A_x.dist">x.dist</code></td>
<td>
<p>A string specifying the distribution of the assignment variable, <code>x</code>.
Options are <code>"normal"</code> and  <code>"uniform"</code>. The default is the <code>"normal"</code> distribution.</p>
</td></tr>
<tr><td><code id="rd_power_+3A_x.para">x.para</code></td>
<td>
<p>A numeric vector of length 2 specifying parameters of the distribution of the first assignment variable, <code>x1</code>.
If <code>x.dist</code> is <code>"normal"</code>, then <code>x.para</code> includes the
mean and standard deviation of the normal distribution.
If <code>x.dist</code> is <code>"uniform"</code>, then <code>x.para</code> includes the 
upper and lower boundaries of the uniform distribution. The default is <code>c(0,1)</code>.</p>
</td></tr>
<tr><td><code id="rd_power_+3A_x.cut">x.cut</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined. The default is 0.</p>
</td></tr>
<tr><td><code id="rd_power_+3A_x.fuzzy">x.fuzzy</code></td>
<td>
<p>A numeric vector of length 2 specifying the probabilities to be assigned to the control, in terms of the
assignment variable, <code>x</code>, for individuals in the treatment based on the cutoff, 
and to treatment for individuals in the control based on the cutoff.
For a sharp design, both entries are 0. 
For a fuzzy design, the first entry is the probability to be assigned to 
control for individuals above the cutpoint, and the second entry is the 
probability to be assigned to treatment for individuals below the cutpoint.
The default is c(0,0), indicating a sharp design.</p>
</td></tr>
<tr><td><code id="rd_power_+3A_x.design">x.design</code></td>
<td>
<p>A string specifying the treatment option according to design.
Options are <code>"g"</code> (treatment is assigned if <code>x</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x</code> is less than or equal to its cutoff).</p>
</td></tr>
<tr><td><code id="rd_power_+3A_coeff">coeff</code></td>
<td>
<p>A numeric vector specifying coefficients of variables in the linear model to generate data.
Coefficients are in the following order:
</p>

<ul>
<li><p>The 1st entry is the intercept. 
</p>
</li>
<li><p>The 2nd entry is the slope of treatment, i.e. treatment effect.
</p>
</li>
<li><p>The 3rd entry is the slope of assignment.
</p>
</li>
<li><p>The 4th entry is the slope of interaction between treatment and assignment.
</p>
</li></ul>

<p>The default is <code>c(0.3, 1, 0.2, 0.3)</code>.</p>
</td></tr>
<tr><td><code id="rd_power_+3A_eta.sq">eta.sq</code></td>
<td>
<p>A numeric value specifying the expected partial eta-squared of the linear model with respect to the 
treatment itself. It is used to control the variance of noise in the linear model. The default is 0.50.</p>
</td></tr>
<tr><td><code id="rd_power_+3A_alpha.list">alpha.list</code></td>
<td>
<p>A numeric vector containing significance levels (between 0 and 1) used to calculate the empirical alpha.
The default is <code>c(0.001, 0.01, 0.05)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rd_power</code> returns an object of <a href="base.html#topic+class">class</a> 
&quot;<code>rdp</code>&quot;, including containing the mean, variance, and power (with <code>alpha</code> of 0.001, 0.01, and 0.05)
for two estimators. The function <code>summary</code>
is used to obtain and print a summary of the power analysis. The two estimators are:
</p>

<ul>
<li><p>The 1st estimator, <code>Linear</code>, provides results of the linear regression estimator. 
</p>
</li>
<li><p>The 2nd estimator, <code>Opt</code>, provides results of the local linear regression estimator of RD,
with the optimal bandwidth in the Imbens and Kalyanaraman (2012) paper.
</p>
</li></ul>



<h3>References</h3>

<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
summary(rd_power(x.design = "l"))
summary(rd_power(x.dist = "uniform", x.cut = 0.5, x.design = "l"))
summary(rd_power(x.fuzzy = c(0.1, 0.1), x.design = "l"))

## End(Not run)
</code></pre>

<hr>
<h2 id='rd_sens_bw'>Bandwidth Sensitivity Simulation for Regression Discontinuity</h2><span id='topic+rd_sens_bw'></span>

<h3>Description</h3>

<p><code>rd_sens_bw</code> refits the supplied model with varying bandwidths. 
All other aspects of the model are held constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd_sens_bw(object, bws)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rd_sens_bw_+3A_object">object</code></td>
<td>
<p>An object returned by <code>rd_est</code> or <code>rd_impute</code>.</p>
</td></tr>
<tr><td><code id="rd_sens_bw_+3A_bws">bws</code></td>
<td>
<p>A positive numeric vector of the bandwidths for refitting an <code>rd</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rd_sens_bw</code> returns a dataframe containing the estimate <code>est</code> and standard error <code>se</code> 
for each supplied bandwidth and for the Imbens-Kalyanaraman (2012) optimal bandwidth, <code>bw</code>, 
and for each supplied approach, <code>model</code>.  Approaches are either user
specified (<code>"usr"</code>) or based on the optimal bandwidth (<code>"origin"</code>).
</p>


<h3>References</h3>

<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * x + 3 * cov + 10 * (x &gt;= 0) + rnorm(1000)
rd &lt;- rd_est(y ~ x | cov, t.design = "geq")
rd_sens_bw(rd, bws = seq(.1, 1, length.out = 5))
</code></pre>

<hr>
<h2 id='rd_sens_cutoff'>Cutoff Sensitivity Simulation for Regression Discontinuity</h2><span id='topic+rd_sens_cutoff'></span>

<h3>Description</h3>

<p><code>rd_sens_cutoff</code> refits the supplied model with varying cutoff(s). 
All other aspects of the model, such as the automatically calculated bandwidth, are held constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd_sens_cutoff(object, cutoffs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rd_sens_cutoff_+3A_object">object</code></td>
<td>
<p>An object returned by <code>rd_est</code> or <code>rd_impute</code>.</p>
</td></tr>
<tr><td><code id="rd_sens_cutoff_+3A_cutoffs">cutoffs</code></td>
<td>
<p>A numeric vector of cutoff values to be used for refitting 
an <code>rd</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rd_sens_cutoff</code> returns a dataframe containing the estimate <code>est</code> and standard error <code>se</code> 
for each cutoff value (<code>A1</code>). Column <code>A1</code> contains varying cutoffs 
on the assignment variable. The <code>model</code> column contains the parametric model (linear, quadratic, or cubic) or 
non-parametric bandwidth setting (Imbens-Kalyanaraman 2012 optimal, half, or double) used for estimation.
</p>


<h3>References</h3>

<p>Imbens, G., Kalyanaraman, K. (2012). 
Optimal bandwidth choice for the regression discontinuity estimator. 
The Review of Economic Studies, 79(3), 933-959.
<a href="https://academic.oup.com/restud/article/79/3/933/1533189">https://academic.oup.com/restud/article/79/3/933/1533189</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * x + 3 * cov + 10 * (x &gt;= 0) + rnorm(1000)
rd &lt;- rd_est(y ~ x | cov, t.design = "geq")
rd_sens_cutoff(rd, seq(-.5, .5, length.out = 10))
</code></pre>

<hr>
<h2 id='rd_type'>Determine Type of Regression Discontinuity Design</h2><span id='topic+rd_type'></span>

<h3>Description</h3>

<p><code>rd_type</code> cross-tabulates observations based on (1) a binary treatment and 
(2) one or two assignments and their cutoff values.
This is an internal function and is typically not directly invoked by the user. 
It can be accessed using the triple colon, as in rddapp:::rd_type().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd_type(
  data,
  treat,
  assign_1,
  cutoff_1,
  operator_1 = NULL,
  assign_2 = NULL,
  cutoff_2 = NULL,
  operator_2 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rd_type_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, with each row representing an observation.</p>
</td></tr>
<tr><td><code id="rd_type_+3A_treat">treat</code></td>
<td>
<p>A string specifying the name of the numeric treatment variable (treated = positive values).</p>
</td></tr>
<tr><td><code id="rd_type_+3A_assign_1">assign_1</code></td>
<td>
<p>A string specifying the variable name of the primary assignment.</p>
</td></tr>
<tr><td><code id="rd_type_+3A_cutoff_1">cutoff_1</code></td>
<td>
<p>A numeric value containing the cutpoint at which
assignment to the treatment is determined, for the primary assignment.</p>
</td></tr>
<tr><td><code id="rd_type_+3A_operator_1">operator_1</code></td>
<td>
<p>The operator specifying the treatment option according to design for the primary assignment.
Options are  
<code>"g"</code> (treatment is assigned if <code>x1</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x1</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x1</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x1</code> is less than or equal to its cutoff).</p>
</td></tr>
<tr><td><code id="rd_type_+3A_assign_2">assign_2</code></td>
<td>
<p>An optional string specifying the variable name of the secondary assignment.</p>
</td></tr>
<tr><td><code id="rd_type_+3A_cutoff_2">cutoff_2</code></td>
<td>
<p>An optional numeric value containing the cutpoint at which
assignment to the treatment is determined, for the secondary assignment.</p>
</td></tr>
<tr><td><code id="rd_type_+3A_operator_2">operator_2</code></td>
<td>
<p>The operator specifying the treatment option according to design for the secondary assignment.
Options are  
<code>"g"</code> (treatment is assigned if <code>x2</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x2</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x2</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x2</code> is less than or equal to its cutoff).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rd_type</code> returns a list of two elements:
</p>
<table role = "presentation">
<tr><td><code>crosstab</code></td>
<td>
<p>The cross-table as a data.frame. Columns in the dataframe include
treatment rules, number of observations in the control condition,
number of observations in the treatment condition, and the probability of an
observation being in treatment or control.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>A string specifying the type of design used, either <code>"SHARP"</code> or <code>"FUZZY"</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * x + 3 * cov + 10 * (x &gt;= 0) + rnorm(1000)
df &lt;- data.frame(cbind(y, x, t = x&gt;=0))
rddapp:::rd_type(df, 't', 'x', 0, 'geq')
</code></pre>

<hr>
<h2 id='sens_plot'>Plot the Simulated Estimates for Sensitivity Analyses</h2><span id='topic+sens_plot'></span>

<h3>Description</h3>

<p><code>sens_plot</code> plots the sensitivity analysis for cutpoints or bandwidths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sens_plot(
  sim_results,
  level = 0.95,
  x = c("A1", "A2", "bw"),
  plot_models = unique(sim_results$model),
  yrange = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sens_plot_+3A_sim_results">sim_results</code></td>
<td>
<p>A <code>data.frame</code> returned by <code>rd_sens_cutoff</code>, <code>rd_sens_bw</code>,
<code>mrd_sens_cutoff</code>, or <code>mrd_sens_bw</code>.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_level">level</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence level for CIs (assuming a normal sampling distribution). The default is 0.95.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_x">x</code></td>
<td>
<p>A string of the column name of the varying parameter in <code>sim_results</code>. 
This will be used as the x-axis in the plot. Possible values are <code>c("A1", "A2", "bw")</code>, 
which are column names in <code>sim_results</code>. 
<code>A1</code> specifies that the varying cutoffs are for assignment 1 and <code>A2</code> specifies assignment 2.
<code>bw</code> indicates that the varying parameter is bandwidth.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_plot_models">plot_models</code></td>
<td>
<p>A character vector specifying the models to be plotted (i.e. models estimated with 
different approaches). Possible values are <code>unique(sim_results$model))</code>.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_yrange">yrange</code></td>
<td>
<p>An optional numeric vector specifying the range of the y-axis.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
x &lt;- runif(1000, -1, 1)
cov &lt;- rnorm(1000)
y &lt;- 3 + 2 * x + 3 * cov + 10 * (x &gt;= 0) + rnorm(1000)
m &lt;- rd_est(y ~ x | cov, t.design = "geq")
sim_cutoff &lt;- rd_sens_cutoff(m, seq(-.5, .5, length.out = 10))
sens_plot(sim_cutoff, x = "A1", plot_models = c("linear", "optimal"))
sim_bw &lt;- rd_sens_bw(m, seq(.1, 1, length.out = 10))
sens_plot(sim_bw, x = "bw")
</code></pre>

<hr>
<h2 id='shiny_run'>Launch the R Shiny App for &quot;rddapp&quot;</h2><span id='topic+shiny_run'></span>

<h3>Description</h3>

<p><code>shiny_run</code> launches the R Shiny application for &quot;rddapp&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny_run(app_name = "shinyrdd")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shiny_run_+3A_app_name">app_name</code></td>
<td>
<p>A string specifying the name of the R Shiny app. The default is <code>"shinyrdd"</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
shiny_run()
shiny_run("shinyrdd")

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.mfrd'>Summarize the Multivariate Frontier Regression Discontinuity</h2><span id='topic+summary.mfrd'></span>

<h3>Description</h3>

<p><code>summary.mfrd</code> is a <code>summary</code> method for class <code>"mfrd"</code>.
It is based on the <code>summary.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mfrd'
summary(object, level = 0.95, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mfrd_+3A_object">object</code></td>
<td>
<p>An object of class <code>"mfrd"</code>, usually a result of a call to <code><a href="#topic+mfrd_est">mfrd_est</a></code>.</p>
</td></tr>
<tr><td><code id="summary.mfrd_+3A_level">level</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence level for confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="summary.mfrd_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to display.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="summary.mfrd_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.mfrd</code> returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the complete model.</p>
</td></tr>
<tr><td><code>ht_coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the heterogeneous treatment model.</p>
</td></tr>
<tr><td><code>t_coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the treatment only model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='summary.mrd'>Summarize the Multivariate Regression Discontinuity</h2><span id='topic+summary.mrd'></span>

<h3>Description</h3>

<p><code>summary.mrd</code> is a <code>summary</code> method for class <code>"mrd"</code>.
It is based on <code>summary.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mrd'
summary(object, level = 0.95, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mrd_+3A_object">object</code></td>
<td>
<p>An object of class <code>"mrd"</code>, usually a result of a call to <code><a href="#topic+mrd_est">mrd_est</a></code>.</p>
</td></tr>
<tr><td><code id="summary.mrd_+3A_level">level</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence level for confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="summary.mrd_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to display.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="summary.mrd_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.mrd</code> returns a list which has the following components depending on methods
implemented in the <code>"mrd"</code> object:
</p>
<table role = "presentation">
<tr><td><code>center_coefficients</code></td>
<td>
<p>A matrix containing bandwidths, number of observations, estimates, 
SEs, confidence intervals, z-values and p-values for each estimated bandwidth and/or parametric model.</p>
</td></tr>
<tr><td><code>univR_coefficients</code></td>
<td>
<p>A matrix containing bandwidths, number of observations, estimates, 
SEs, confidence intervals, z-values and p-values for each estimated bandwidth and/or parametric model.</p>
</td></tr>
<tr><td><code>univM_coefficients</code></td>
<td>
<p>A matrix containing bandwidths, number of observations, estimates, 
SEs, confidence intervals, z-values and p-values for each estimated bandwidth and/or parametric model.</p>
</td></tr>
<tr><td><code>front_coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the complete model.</p>
</td></tr>
<tr><td><code>front_ht_coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the heterogeneous treatment model.</p>
</td></tr>
<tr><td><code>front_t_coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the treatment only model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='summary.mrdi'>Summarize the Multiple Imputation of Multivariate Regression Discontinuity</h2><span id='topic+summary.mrdi'></span>

<h3>Description</h3>

<p><code>summary.mrdi</code> is a <code>summary</code> method for class <code>"mrdi"</code>.
It is based on <code>summary.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mrdi'
summary(object, level = 0.95, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mrdi_+3A_object">object</code></td>
<td>
<p>An object of class <code>"mrdi"</code>, usually a result of a call to 
<code><a href="#topic+mrd_impute">mrd_impute</a></code> with <code>"front"</code> method.</p>
</td></tr>
<tr><td><code id="summary.mrdi_+3A_level">level</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence level for confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="summary.mrdi_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to display.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="summary.mrdi_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.mrdi</code> returns a list which has the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the complete model.</p>
</td></tr>
<tr><td><code>ht_coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the heterogeneous treatment model.</p>
</td></tr>
<tr><td><code>t_coefficients</code></td>
<td>
<p>A matrix containing estimates and confidence intervals (if applicable) 
for the treatment only model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='summary.mrdp'>Summarize the Power Analysis of Regression Discontinuity</h2><span id='topic+summary.mrdp'></span>

<h3>Description</h3>

<p><code>summary.mrdp</code> is a <code>summary</code> method for class <code>"mrdp"</code>.
It is based on <code>summary.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mrdp'
summary(object, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mrdp_+3A_object">object</code></td>
<td>
<p>An object of class <code>"mrdp"</code>, usually a result of a call to <code><a href="#topic+mrd_power">mrd_power</a></code>.</p>
</td></tr>
<tr><td><code id="summary.mrdp_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to display.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="summary.mrdp_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.mrdp</code> returns a list which has the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>A matrix containing the mean, variance, and empirical alpha of each estimator.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='summary.rd'>Summarize the Regression Discontinuity</h2><span id='topic+summary.rd'></span>

<h3>Description</h3>

<p><code>summary.rd</code> is a <code>summary</code> method for class <code>"rd"</code>
It is based on <code>summary.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rd'
summary(object, level = 0.95, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.rd_+3A_object">object</code></td>
<td>
<p>An object of class <code>"rd"</code>, usually a result of a call to <code><a href="#topic+rd_est">rd_est</a></code>.</p>
</td></tr>
<tr><td><code id="summary.rd_+3A_level">level</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence level for confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="summary.rd_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to display.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="summary.rd_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary</code>..</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.rd</code> returns a list which has the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>A matrix containing bandwidths, number of observations, estimates, 
SEs, confidence intervals, z-values and p-values for each estimated bandwidth.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='summary.rdp'>Summarize the Power Analysis of Regression Discontinuity</h2><span id='topic+summary.rdp'></span>

<h3>Description</h3>

<p><code>summary.rdp</code> is a <code>summary</code> method for class <code>"rdp"</code>.
It is based on <code>summary.RD</code> function in the &quot;rdd&quot; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rdp'
summary(object, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.rdp_+3A_object">object</code></td>
<td>
<p>An object of class <code>"rdp"</code>, usually a result of a call to <code><a href="#topic+rd_power">rd_power</a></code>.</p>
</td></tr>
<tr><td><code id="summary.rdp_+3A_digits">digits</code></td>
<td>
<p>A non-negative integer specifying the number of digits to display.
The default is <code>max(3, getOption("digits") - 3)</code>.</p>
</td></tr>
<tr><td><code id="summary.rdp_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.rdp</code> returns a list which has the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>A matrix containing the mean, variance, and empirical alpha of each estimator.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='treat_assign'>Treatment Assignment for Regression Discontinuity</h2><span id='topic+treat_assign'></span>

<h3>Description</h3>

<p><code>treat_assign</code> computes the treatment variable, <code>t</code>, based on the cutoff of 
assignment variable, <code>x</code>.
This is an internal function and is typically not directly invoked by the user. 
It can be accessed using the triple colon, as in rddapp:::treat_assign().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treat_assign(x, cut = 0, t.design = "l")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="treat_assign_+3A_x">x</code></td>
<td>
<p>A numeric vector containing the assignment variable, <code>x</code>.</p>
</td></tr>
<tr><td><code id="treat_assign_+3A_cut">cut</code></td>
<td>
<p>A numeric value containing the cutpoint at which assignment to the treatment is determined. The default is 0.</p>
</td></tr>
<tr><td><code id="treat_assign_+3A_t.design">t.design</code></td>
<td>
<p>A string specifying the treatment option according to design.
Options are <code>"g"</code> (treatment is assigned if <code>x</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x</code> is less than or equal to its cutoff).
The default is <code>"l"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>treat_assign</code> returns the treatment variable as a vector according to the design,
where 1 means the treated group and 0 means the control group.
</p>

<hr>
<h2 id='var_center'>Assignment Centering for Multivariate Frontier Regression Discontinuity</h2><span id='topic+var_center'></span>

<h3>Description</h3>

<p><code>var_center</code> computes the univariate assignment variable, <code>x</code> based on the cutoffs of 
two assignment variables: <code>x1</code> and <code>x2</code>.
This is an internal function and is typically not directly invoked by the user. 
It can be accessed using the triple colon, as in rddapp:::var_center().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_center(x, cut = c(0, 0), t.design = NULL, t.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_center_+3A_x">x</code></td>
<td>
<p>Data frame or matrix of two assignment variables,
where the first column is <code>x1</code> and the second column is <code>x2</code>.</p>
</td></tr>
<tr><td><code id="var_center_+3A_cut">cut</code></td>
<td>
<p>A numeric vector of length 2 containing the cutpoints at which assignment to the treatment is determined.
The default is <code>c(0, 0)</code>.</p>
</td></tr>
<tr><td><code id="var_center_+3A_t.design">t.design</code></td>
<td>
<p>A character vector of length 2 specifying the treatment option according to design.
The first entry is for <code>x1</code> and the second entry is for <code>x2</code>. Options are  
<code>"g"</code> (treatment is assigned if <code>x1</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x1</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x1</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x1</code> is less than or equal to its cutoff).
The same options are available for <code>x2</code>.</p>
</td></tr>
<tr><td><code id="var_center_+3A_t.plot">t.plot</code></td>
<td>
<p>A logical value indicating whether to calculate the univariate treatment variable, <code>t</code>, and make a plot. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>var_center</code> returns the univariate assignment variable as a vector 
according to the design.
</p>

<hr>
<h2 id='wt_kern'>Kernel Weight Calculation</h2><span id='topic+wt_kern'></span>

<h3>Description</h3>

<p><code>wt_kern</code> calculates the appropriate kernel weights for a vector. 
This is useful when, for instance, one wishes to perform local regression.
It is based on the <code>kernelwts</code> function in the &quot;rdd&quot; package. 
This is an internal function and is typically not directly invoked by the user. 
It can be accessed using the triple colon, as in rddapp:::wt_kern().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt_kern(X, center, bw, kernel = "triangular")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wt_kern_+3A_x">X</code></td>
<td>
<p>A numeric vector containing the the input <code>X</code> values. This variable represents the axis along which kernel weighting 
should be performed.</p>
</td></tr>
<tr><td><code id="wt_kern_+3A_center">center</code></td>
<td>
<p>A numeric value specifying the point from which distances should be calculated.</p>
</td></tr>
<tr><td><code id="wt_kern_+3A_bw">bw</code></td>
<td>
<p>A numeric value specifying the bandwidth.</p>
</td></tr>
<tr><td><code id="wt_kern_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>wt_kern</code> returns a vector of weights with length equal to that of the <code>X</code> input 
(one weight per element of <code>X</code>).
</p>


<h3>References</h3>

<p>Drew Dimmery (2016). rdd: Regression Discontinuity Estimation. R package
version 0.57. https://CRAN.R-project.org/package=rdd
</p>

<hr>
<h2 id='wt_kern_bivariate'>Bivariate Kernel Weight Calculation</h2><span id='topic+wt_kern_bivariate'></span>

<h3>Description</h3>

<p><code>wt_kern_bivariate</code> calculates the appropriate weights for two variables for
Multivariate Frontier Regression Discontinuity Estimation with nonparametric implementation.
Kernel weights are calculated based on the L1 distance of the two variables from the frontiers.
This is an internal function and is typically not directly invoked by the user.
It can be accessed using the triple colon, as in rddapp:::wt_kern_bivariate().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt_kern_bivariate(
  X1,
  X2,
  center1,
  center2,
  bw,
  kernel = "triangular",
  t.design = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wt_kern_bivariate_+3A_x1">X1</code></td>
<td>
<p>The input x1 values for the first vector. 
This variable represents the axis along which kernel weighting should be performed;
the first assignment variable in an MRDD.</p>
</td></tr>
<tr><td><code id="wt_kern_bivariate_+3A_x2">X2</code></td>
<td>
<p>The input x2 values for the second vector. <code>X2</code> has the same length as <code>X1</code>.
This variable represents the axis along which kernel weighting should be performed.;
the second assignment variable in an MRDD.</p>
</td></tr>
<tr><td><code id="wt_kern_bivariate_+3A_center1">center1</code></td>
<td>
<p>A numeric value specifying the point from which distances should be calculated for the first vector, <code>X1</code>.</p>
</td></tr>
<tr><td><code id="wt_kern_bivariate_+3A_center2">center2</code></td>
<td>
<p>A numeric value specifying the point from which distances should be calculated for the second vector, <code>X2</code>.</p>
</td></tr>
<tr><td><code id="wt_kern_bivariate_+3A_bw">bw</code></td>
<td>
<p>A numeric vector specifying the bandwidths for each of three effects models 
(complete model, heterogeneous treatment model, and treatment only model) 
detailed in Wong, Steiner, and Cook (2013).</p>
</td></tr>
<tr><td><code id="wt_kern_bivariate_+3A_kernel">kernel</code></td>
<td>
<p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p>
</td></tr>
<tr><td><code id="wt_kern_bivariate_+3A_t.design">t.design</code></td>
<td>
<p>A character vector of length 2 specifying the treatment option according to design.
The first entry is for <code>x1</code> and the second entry is for <code>x2</code>. Options are  
<code>"g"</code> (treatment is assigned if <code>x1</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x1</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x1</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x1</code> is less than or equal to its cutoff).
The same options are available for <code>x2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>wt_bivariate_kern</code> returns a matrix of weights and distances with length equal to that of the <code>X1</code> and <code>X2</code> input.
The first and second weights and distances are calculated with respect to all frontiers of different treatments.
The third weight and distance are calculated with respect to the overall frontier of treatment versus
non-treatment.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
