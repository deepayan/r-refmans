<!DOCTYPE html><html><head><title>Help for package GPBayes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GPBayes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GPBayes-package'>
<p>Tools for Gaussian Stochastic Process Modeling in Uncertainty Quantification</p></a></li>
<li><a href='#BesselK'><p>Modified Bessel function of the second kind</p></a></li>
<li><a href='#cauchy'><p>The generalized Cauchy correlation function</p></a></li>
<li><a href='#CH'><p>The Confluent Hypergeometric correlation function proposed by Ma and Bhadra (2019)</p></a></li>
<li><a href='#cor.to.par'><p>Find the correlation parameter given effective range</p></a></li>
<li><a href='#deriv_kernel'><p>A wraper to construct the derivative of correlation matrix with respect to correlation parameters</p></a></li>
<li><a href='#distance'><p>Compute distances for two sets of inputs</p></a></li>
<li><a href='#GaSP'><p>Building, fitting, predicting for a GaSP model</p></a></li>
<li><a href='#gp'><p>Construct the <code>S4</code> object gp</p></a></li>
<li><a href='#gp-class'><p>The <code>gp</code> class</p></a></li>
<li><a href='#gp.fisher'><p>Fisher information matrix</p></a></li>
<li><a href='#gp.get.mcmc'><p>get posterior summary for MCMC samples</p></a></li>
<li><a href='#gp.mcmc'><p>A wraper to fit a Gaussian stochastic process model with MCMC algorithms</p></a></li>
<li><a href='#gp.model.adequacy'><p>Model assessment based on Deviance information criterion (DIC), logarithmic pointwise predictive density (lppd), and</p>
logarithmic joint predictive density (ljpd).</a></li>
<li><a href='#gp.optim'><p>A wraper to fit a Gaussian stochastic process model with optimization methods</p></a></li>
<li><a href='#gp.predict'><p>Prediction at new inputs based on a Gaussian stochastic process model</p></a></li>
<li><a href='#gp.sim'><p>Simulate from a Gaussian stochastic process model</p></a></li>
<li><a href='#HypergU'><p>Confluent hypergeometric function of the second kind</p></a></li>
<li><a href='#ikernel'><p>A wraper to build different kinds of correlation matrices between two sets of inputs</p></a></li>
<li><a href='#kernel'><p>A wraper to build different kinds of correlation matrices with distance as arguments</p></a></li>
<li><a href='#loglik'><p>A wraper to compute the natural logarithm of the integrated likelihood function</p></a></li>
<li><a href='#matern'><p>The Matérn correlation function proposed by Matérn (1960)</p></a></li>
<li><a href='#powexp'><p>The powered-exponential correlation function</p></a></li>
<li><a href='#show,gp-method'><p>Print the information an object of the <code>gp</code> class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Gaussian Process Modeling in Uncertainty
Quantification</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0-5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-31</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pulong Ma &lt;mpulong@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Gaussian processes ('GPs') have been widely used to model spatial data, 'spatio'-temporal data, and computer experiments in diverse areas of statistics including spatial statistics, 'spatio'-temporal statistics, uncertainty quantification, and machine learning. This package creates basic tools for fitting and prediction based on 'GPs' with spatial data, 'spatio'-temporal data, and computer experiments. Key characteristics for this GP tool include: (1) the comprehensive implementation of various covariance functions including the 'Matérn' family and the Confluent 'Hypergeometric' family with isotropic form, tensor form, and automatic relevance determination form, where the isotropic form is widely used in spatial statistics, the tensor form is widely used in design and analysis of computer experiments and uncertainty quantification, and the automatic relevance determination form is widely used in machine learning; (2) implementations via Markov chain Monte Carlo ('MCMC') algorithms and optimization algorithms for GP models with all the implemented covariance functions. The methods for fitting and prediction are mainly implemented in a Bayesian framework; (3) model evaluation via Fisher information and predictive metrics such as predictive scores; (4) built-in functionality for simulating 'GPs' with all the implemented covariance functions; (5) unified implementation to allow easy specification of various 'GPs'. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pulongma/GPBayes/issues">https://github.com/pulongma/GPBayes/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.1), stats, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen, RcppProgress</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU Scientific Library version &gt;= 2.5</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-31 20:03:07 UTC; plma</td>
</tr>
<tr>
<td>Author:</td>
<td>Pulong Ma [aut, cre]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-01 11:20:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='GPBayes-package'>
Tools for Gaussian Stochastic Process Modeling in Uncertainty Quantification
</h2><span id='topic+GPBayes-package'></span><span id='topic+GPBayes-package'></span>

<h3>Description</h3>

<p>Gaussian processes (GPs) have been widely used to model spatial data, spatio-temporal data, and computer experiments in diverse areas of statistics including spatial statistics, spatio-temporal statistics, uncertainty quantification, and machine learning. This package creates basic tools for fitting and prediction based on GPs with spatial data, spatio-temporal data, and computer experiments. Key characteristics for this GP tool include: (1) the comprehensive implementation of various covariance functions including the Matérn family and the Confluent Hypergeometric family with isotropic form, tensor form, and automatic relevance determination form, where the isotropic form is widely used in spatial statistics, the tensor form is widely used in design and analysis of computer experiments and uncertainty quantification, and the automatic relevance determination form is widely used in machine learning; (2) implementations via Markov chain Monte Carlo (MCMC) algorithms and optimization algorithms for GP models with all the implemented covariance functions. The methods for fitting and prediction are mainly implemented in a Bayesian framework; (3) model evaluation via Fisher information and predictive metrics such as predictive scores; (4) built-in functionality for simulating GPs with all the implemented covariance functions; (5) unified implementation to allow easy specification of various GPs.  
</p>


<h3>Details</h3>


<ul>
<li><p>Data types: For many scientific applications, spatial data, spatio-temporal data, and computer experiments arise naturally. This package provides a comprehensive set of basic tools to fit GaSP models for univariate and multivariate spatial data, spatio-temporal data, computer experiments. Various covariance functions have been implemented including the Confluent Hypergeometric covariance functions, the Matérn covariance functions, the Gaussian covariance function, the generalized Cauchy covariance function. These covariance families can be in isotropic form, in tensor form, or in automatic relevance determination form. The routines <code><a href="#topic+kernel">kernel</a></code> and <code><a href="#topic+ikernel">ikernel</a></code> contain the details of implementation.  
</p>
</li>
<li><p>Model simulation: This package can simulate realizations from GaSP for different types of data including spatial data, spatio-temporal data, and computer experiments. This feature is quite useful in part because benchmarks are used to evaluate the performance of GaSP models. This functionality is implemented in the routine <code><a href="#topic+gp.sim">gp.sim</a></code>.
</p>
</li>
<li><p>Model fitting: Both maximum likelihood methods (or its variants) and Bayes estimation methods such as maximum a posterior (MAP) and Markov chain Monte Carlo (MCMC) methods are implemented. In this package, the nugget parameter is included in the model by default for the sake of better prediction performance and stable computation in practice. In addition, the smoothness parameter in covariance functions such as the Matérn class and the Confluent Hypergeometric class can be estimated. The routine <code><a href="#topic+gp.optim">gp.optim</a></code> provides optimization based estimation approaches and the routine <code><a href="#topic+gp.mcmc">gp.mcmc</a></code> provides MCMC algorithms based estimation approaches.
</p>
</li>
<li><p>Model prediction: Prediction is made based on the parameter estimation procedure. If maximum likelihood estimation (MLE) methods are used for parameter estimation, the plug-in approach is used for prediction in the sense that MLEs of parameters are plugged into posterior predictive distributions. If partial Bayes methods (e.g., maximum a posterior) are used, the plug-in approach is used for prediction as well. If fully Bayes methods via MCMC algorithms are used, posterior samples are drawn from posterior predictive distributions. The routine <code><a href="#topic+gp.mcmc">gp.mcmc</a></code> allows prediction to be made within the MCMC algorithms, while the routine <code><a href="#topic+gp.predict">gp.predict</a></code> generates prediction with estimated parameters.
</p>
</li>
<li><p>Model assessment: Tools for assessing model adequacy are included in a Bayesian context. Deviance information criteria (DIC), log pointwise predictive density, and log joint predictive density can be computed via the routine <code><a href="#topic+gp.model.adequacy">gp.model.adequacy</a></code>. 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>References</h3>


<ul>
<li><p>Cressie, N. (1993). &ldquo;Statistics for Spatial Data.&rdquo; John Wiley &amp; Sons, New York, revised edition.
</p>
</li>
<li><p>Ma and Bhadra (2019). &ldquo;Beyond Matérn: On a Class of Interpretable Confluent Hypergeometric Covariance Functions.&rdquo; arXiv: 1911.05865. <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.
</p>
</li>
<li><p>Sacks, Jerome, William J Welch, Toby J Mitchell, and Henry P Wynn. (1989). &ldquo;Design and Analysis of Computer Experiments.&rdquo; <em>Statistical Science</em> <strong>4</strong>(4). Institute of Mathematical Statistics: 409–435.
</p>
</li>
<li><p>Santner, Thomas J., Brian J. Williams, and William I. Notz. (2018). &ldquo;The Design and Analysis of Computer Experiments&rdquo;; 2nd Ed. New York: Springer.
</p>
</li>
<li><p>Stein, Michael L. (1999). &ldquo;Interpolation of Spatial Data.&rdquo; Springer Science &amp; Business Media, New York.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+GaSP">GaSP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#####################################################################
          

#####################################################################
############## Examples for fitting univariate GP models ############

## Set up the Sine example from the tgp package 
 code = function(x){
  y = (sin(pi*x/5) + 0.2*cos(4*pi*x/5))*(x&lt;=9.6) + (x/10-1)*(x&gt;9.6) 
 }
 n=100
 input = seq(0, 20, length=n)
 XX = seq(0, 20, length=99)
 Ztrue = code(input)
 set.seed(1234)
 output = Ztrue + rnorm(length(Ztrue), sd=0.1)
 df.data = data.frame(x=c(input), y=output, y.true=Ztrue)

 ## fitting a GaSP model with the Cauchy prior
 fit = GaSP(formula=~1, output, input, 
           param=list(range=3, nugget=0.1, nu=2.5), 
           smooth.est=FALSE, input.new=XX,
           cov.model=list(family="matern", form="isotropic"),
           proposal=list(range=.35, nugget=.8, nu=0.8),
           dtype="Euclidean", model.fit="Cauchy_prior", nsample=3000, 
           burnin=500, verbose=TRUE)

 ## fitting a GaSP model with the beta prior
 fit = GaSP(formula=~1, output, input, 
           param=list(range=3, nugget=0.1, nu=2.5), 
           smooth.est=FALSE, input.new=XX,
           cov.model=list(family="matern", form="isotropic"),
           prior=list(range=list(a=1,b=1,lb=0,ub=20),
                    nugget=list(a=1,b=1,lb=0,ub=var(output)),
           proposal=list(range=.35, nugget=.8, nu=0.8),
           dtype="Euclidean", model.fit="Beta_prior", nsample=3000, 
           burnin=500, verbose=TRUE))

## fitting a GaSP model with the marginal maximum likelihood approach
 fit = GaSP(formula=~1, output, input, 
           param=list(range=3, nugget=0.1, nu=2.5), 
           smooth.est=FALSE, input.new=XX,
           cov.model=list(family="matern", form="isotropic"),
           dtype="Euclidean", model.fit="MMLE", verbose=TRUE)

## fitting a GaSP model with the profile maximum likelihood approach
 fit = GaSP(formula=~1, output, input, 
           param=list(range=3, nugget=0.1, nu=2.5), 
           smooth.est=FALSE, input.new=XX,
           cov.model=list(family="matern", form="isotropic"),
           dtype="Euclidean", model.fit="MPLE", verbose=TRUE)  
  
</code></pre>

<hr>
<h2 id='BesselK'>Modified Bessel function of the second kind</h2><span id='topic+BesselK'></span>

<h3>Description</h3>

<p>This function calls the GSL scientific library to evaluate 
the modified Bessel function of the second kind.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BesselK(nu, z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BesselK_+3A_nu">nu</code></td>
<td>
<p>a real positive value</p>
</td></tr>
<tr><td><code id="BesselK_+3A_z">z</code></td>
<td>
<p>a real positive value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical value
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matern">matern</a></code>
</p>

<hr>
<h2 id='cauchy'>The generalized Cauchy correlation function</h2><span id='topic+cauchy'></span>

<h3>Description</h3>

<p>This function computes the generalized Cauchy correlation function given
a distance matrix. The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter. 
The case where <code class="reqn">\nu=2</code> corresponds to the Cauchy covariance model, which is infinitely differentiable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cauchy(d, range, tail, nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cauchy_+3A_d">d</code></td>
<td>
<p>a matrix of distances</p>
</td></tr>
<tr><td><code id="cauchy_+3A_range">range</code></td>
<td>
<p>a numerical value containing the range parameter</p>
</td></tr>
<tr><td><code id="cauchy_+3A_tail">tail</code></td>
<td>
<p>a numerical value containing the tail decay parameter</p>
</td></tr>
<tr><td><code id="cauchy_+3A_nu">nu</code></td>
<td>
<p>a numerical value containing the smoothness parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical matrix
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kernel">kernel</a></code>
</p>

<hr>
<h2 id='CH'>The Confluent Hypergeometric correlation function proposed by Ma and Bhadra (2019)</h2><span id='topic+CH'></span>

<h3>Description</h3>

<p>This function computes the Confluent Hypergeometric correlation function given
a distance matrix. The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu,  \biggr(\frac{h}{\beta}\biggr)^2 \right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CH(d, range, tail, nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CH_+3A_d">d</code></td>
<td>
<p>a matrix of distances</p>
</td></tr>
<tr><td><code id="CH_+3A_range">range</code></td>
<td>
<p>a numerical value containing the range parameter</p>
</td></tr>
<tr><td><code id="CH_+3A_tail">tail</code></td>
<td>
<p>a numerical value containing the tail decay parameter</p>
</td></tr>
<tr><td><code id="CH_+3A_nu">nu</code></td>
<td>
<p>a numerical value containing the smoothness parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical matrix
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <a href="#topic+gp-class">gp</a>, <code><a href="#topic+matern">matern</a></code>, <code><a href="#topic+kernel">kernel</a></code>, <code><a href="#topic+ikernel">ikernel</a></code>
</p>

<hr>
<h2 id='cor.to.par'>Find the correlation parameter given effective range</h2><span id='topic+cor.to.par'></span>

<h3>Description</h3>

<p>This function finds the correlation parameter given effective range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.to.par(
  d,
  param,
  family = "CH",
  cor.target = 0.05,
  lower = NULL,
  upper = NULL,
  tol = .Machine$double.eps
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.to.par_+3A_d">d</code></td>
<td>
<p>a numerical value containing the effective range</p>
</td></tr>
<tr><td><code id="cor.to.par_+3A_param">param</code></td>
<td>
<p>a list containing correlation parameters. The specification of 
<strong>param</strong> should depend on the covariance model. If the parameter value is
<code>NULL</code>, this function will find its value given the effective range via
root-finding function <code><a href="stats.html#topic+uniroot">uniroot</a></code>.
</p>

<ul>
<li><p>For the Confluent Hypergeometric class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\beta</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>. 
</p>
</li>
<li><p>For the generalized Cauchy class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the Matérn class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>nu</strong> is used to denote the smoothness parameter <code class="reqn">\nu</code>. When <code class="reqn">\nu=0.5</code>, the 
Matérn class corresponds to the exponential covariance.  
</p>
</li>
<li><p>For the powered-exponential class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>.
<strong>nu</strong> is used to denote the smoothness parameter. When <code class="reqn">\nu=2</code>, the powered-exponential class
corresponds to the Gaussian covariance.
</p>
</li></ul>
</td></tr>
<tr><td><code id="cor.to.par_+3A_family">family</code></td>
<td>
<p>a string indicating the type of covariance structure.
The following correlation functions are implemented:
</p>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left(\frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
<dt>exp</dt><dd><p>The exponential correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp(-h/\phi),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. This is the Matérn correlation with <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=2.5</code>.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="cor.to.par_+3A_cor.target">cor.target</code></td>
<td>
<p>a numerical value. The default value is 0.05, which 
means that correlation parameters are searched such that the correlation
is approximately 0.05.</p>
</td></tr>
<tr><td><code id="cor.to.par_+3A_lower">lower</code></td>
<td>
<p>a numerical value. This sets the lower bound to find the 
correlation parameter via the <code>R</code> function <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
<tr><td><code id="cor.to.par_+3A_upper">upper</code></td>
<td>
<p>a numerical value. This sets the upper bound to find the 
correlation parameter via the <code>R</code> function <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
<tr><td><code id="cor.to.par_+3A_tol">tol</code></td>
<td>
<p>a numerical value. This sets the precision of the solution with default value
specified as the machine precision <code>.Machine$double.eps</code> in <code>R</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical value of correlation parameters
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <code><a href="#topic+kernel">kernel</a></code>, <code><a href="#topic+ikernel">ikernel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
range = cor.to.par(1,param=list(tail=0.5,nu=2.5), family="CH")
tail = cor.to.par(1,param=list(range=0.5,nu=2.5), family="CH")
range = cor.to.par(1,param=list(nu=2.5),family="matern")

</code></pre>

<hr>
<h2 id='deriv_kernel'>A wraper to construct the derivative of correlation matrix with respect to correlation parameters</h2><span id='topic+deriv_kernel'></span>

<h3>Description</h3>

<p>This function wraps existing built-in routines to construct the 
derivative of correlation matrix with respect to correlation parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deriv_kernel(d, range, tail, nu, covmodel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deriv_kernel_+3A_d">d</code></td>
<td>
<p>a matrix or a list of distances returned from <code><a href="#topic+distance">distance</a></code>.</p>
</td></tr>
<tr><td><code id="deriv_kernel_+3A_range">range</code></td>
<td>
<p>a vector of range parameters</p>
</td></tr>
<tr><td><code id="deriv_kernel_+3A_tail">tail</code></td>
<td>
<p>a vector of tail decay parameters</p>
</td></tr>
<tr><td><code id="deriv_kernel_+3A_nu">nu</code></td>
<td>
<p>a vector of smoothness parameters</p>
</td></tr>
<tr><td><code id="deriv_kernel_+3A_covmodel">covmodel</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
</dl>

<dl>
<dt>exp</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=0.5</code>. This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=1.5</code>.
This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=2.5</code>. 
This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=2.5</code>.</p>
</dd>
</dl>

<dl>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of matrices
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CH">CH</a></code>, <code><a href="#topic+matern">matern</a></code>, <code><a href="#topic+kernel">kernel</a></code>, <a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>input = seq(0,1,length=10)
d = distance(input,input,type="isotropic",dtype="Euclidean")
dR = deriv_kernel(d,range=0.5,tail=0.2,nu=2.5,
         covmodel=list(family="CH",form="isotropic"))
</code></pre>

<hr>
<h2 id='distance'>Compute distances for two sets of inputs</h2><span id='topic+distance'></span>

<h3>Description</h3>

<p>This function computes distances for two sets of inputs and returns
a <code>R</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance(input1, input2, type = "isotropic", dtype = "Euclidean")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distance_+3A_input1">input1</code></td>
<td>
<p>a matrix of inputs</p>
</td></tr>
<tr><td><code id="distance_+3A_input2">input2</code></td>
<td>
<p>a matrix of inputs</p>
</td></tr>
<tr><td><code id="distance_+3A_type">type</code></td>
<td>
<p>a string indicating the form of distances with three froms supported currently: <strong>isotropic</strong>, <strong>tensor</strong>, <strong>ARD</strong>.</p>
</td></tr>
<tr><td><code id="distance_+3A_dtype">dtype</code></td>
<td>
<p>a string indicating distance type: <strong>Euclidean</strong>, <strong>GCD</strong>, where the latter indicates great circle distance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a R object holding distances for two sets of inputs. If <strong>type</strong> is <strong>isotropic</strong>, a matrix of distances
is returned; if <strong>type</strong> is <strong>tensor</strong> or <strong>ARD</strong>, a list of distance matrices 
along each input dimension is returned.
</p>
<p>a numeric vector or matrix of distances
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>input = seq(0,1,length=20)
d = distance(input, input, type="isotropic", dtype="Euclidean")

</code></pre>

<hr>
<h2 id='GaSP'>Building, fitting, predicting for a GaSP model</h2><span id='topic+GaSP'></span>

<h3>Description</h3>

<p>This function serves as a wrapper to build, fit, and make prediction 
for a Gaussian process model. It calls on functions <code><a href="#topic+gp">gp</a></code>, <code><a href="#topic+gp.mcmc">gp.mcmc</a></code>,
<code><a href="#topic+gp.optim">gp.optim</a></code>, <code><a href="#topic+gp.predict">gp.predict</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GaSP(
  formula = ~1,
  output,
  input,
  param,
  smooth.est = FALSE,
  input.new = NULL,
  cov.model = list(family = "CH", form = "isotropic"),
  model.fit = "Cauchy_prior",
  prior = list(),
  proposal = list(range = 0.35, tail = 2, nugget = 0.8, nu = 0.8),
  nsample = 5000,
  burnin = 1000,
  opt = NULL,
  bound = NULL,
  dtype = "Euclidean",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GaSP_+3A_formula">formula</code></td>
<td>
<p>an object of <code>formula</code> class that specifies regressors; see <code><a href="stats.html#topic+formula">formula</a></code> for details.</p>
</td></tr>
<tr><td><code id="GaSP_+3A_output">output</code></td>
<td>
<p>a numerical vector including observations or outputs in a GaSP</p>
</td></tr>
<tr><td><code id="GaSP_+3A_input">input</code></td>
<td>
<p>a matrix including inputs in a GaSP</p>
</td></tr>
<tr><td><code id="GaSP_+3A_param">param</code></td>
<td>
<p>a list including values for regression parameters, covariance parameters, 
and nugget variance parameter.
The specification of <strong>param</strong> should depend on the covariance model. 
</p>

<ul>
<li><p>The regression parameters are denoted by <strong>coeff</strong>. Default value is <code class="reqn">\mathbf{0}</code>.
</p>
</li>
<li><p>The marginal variance or partial sill is denoted by <strong>sig2</strong>. Default value is 1.
</p>
</li>
<li><p>The nugget variance parameter is denoted by <strong>nugget</strong> for all covariance models. 
Default value is 0.
</p>
</li>
<li><p>For the Confluent Hypergeometric class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\beta</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the generalized Cauchy class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the Matérn class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>nu</strong> is used to denote the smoothness parameter <code class="reqn">\nu</code>. When <code class="reqn">\nu=0.5</code>, the 
Matérn class corresponds to the exponential covariance.  
</p>
</li>
<li><p>For the powered-exponential class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>.
<strong>nu</strong> is used to denote the smoothness parameter. When <code class="reqn">\nu=2</code>, the powered-exponential class
corresponds to the Gaussian covariance.
</p>
</li></ul>
</td></tr>
<tr><td><code id="GaSP_+3A_smooth.est">smooth.est</code></td>
<td>
<p>a logical value indicating whether smoothness parameter will be estimated.</p>
</td></tr>
<tr><td><code id="GaSP_+3A_input.new">input.new</code></td>
<td>
<p>a matrix of new input locations</p>
</td></tr>
<tr><td><code id="GaSP_+3A_cov.model">cov.model</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
<dt>exp</dt><dd><p>The exponential correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp(-h/\phi),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. This is the Matérn correlation with <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=2.5</code>.</p>
</dd>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="GaSP_+3A_model.fit">model.fit</code></td>
<td>
<p>a string indicating the choice of priors on correlation parameters:
</p>

<dl>
<dt>Cauchy_prior</dt><dd><p>This indicates that a fully Bayesian approach with objective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with half-Cauchy priors (default). 
</p>
</dd>
<dt>Ref_prior</dt><dd><p>This indicates that a fully Bayesian approach with objective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with reference priors. This is only supported for isotropic
covariance functions. For details, see <code><a href="#topic+gp.mcmc">gp.mcmc</a></code>.
</p>
</dd>
<dt>Beta_prior</dt><dd><p>This indicates that a fully Bayesian approach with subjective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with <a href="base.html#topic+beta">beta</a> priors parameterized as <code class="reqn">Beta(a, b, lb, ub)</code>.
In the beta distribution, <strong>lb</strong> and <strong>ub</strong> are the support for correlation parameters, and
they should be determined based on domain knowledge. <strong>a</strong> and <strong>b</strong> are two shape parameters with default values at 1,
corresponding to the uniform prior over the support <code class="reqn">(lb, ub)</code>. 
</p>
</dd>
<dt>MPLE</dt><dd><p>This indicates that the <em>maximum profile likelihood estimation</em> 
(<strong>MPLE</strong>) is used.</p>
</dd>
<dt>MMLE</dt><dd><p>This indicates that the <em>maximum marginal likelihood estimation</em> 
(<strong>MMLE</strong>) is used.</p>
</dd>
<dt>MAP</dt><dd><p>This indicates that the marginal/integrated posterior is maximized.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="GaSP_+3A_prior">prior</code></td>
<td>
<p>a list containing tuning parameters in prior distribution. This is used only if a subjective Bayes estimation method with informative priors is used.</p>
</td></tr>
<tr><td><code id="GaSP_+3A_proposal">proposal</code></td>
<td>
<p>a list containing tuning parameters in proposal distribution. This is used only if a Bayes estimation method is used.</p>
</td></tr>
<tr><td><code id="GaSP_+3A_nsample">nsample</code></td>
<td>
<p>an integer indicating the number of MCMC samples.</p>
</td></tr>
<tr><td><code id="GaSP_+3A_burnin">burnin</code></td>
<td>
<p>an integer indicating the burn-in period.</p>
</td></tr>
<tr><td><code id="GaSP_+3A_opt">opt</code></td>
<td>
<p>a list of arguments to setup the <code><a href="stats.html#topic+optim">optim</a></code> routine. Current implementation uses three arguments: 
</p>

<dl>
<dt>method</dt><dd><p>The optimization method: <code>Nelder-Mead</code> or <code>L-BFGS-B</code>.</p>
</dd>
<dt>lower</dt><dd><p>The lower bound for parameters.</p>
</dd>
<dt>upper</dt><dd><p>The upper bound for parameters.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="GaSP_+3A_bound">bound</code></td>
<td>
<p>Default value is <code>NULL</code>. Otherwise, it should be a list
containing the following elements depending on the covariance class:
</p>

<dl>
<dt><strong>nugget</strong></dt><dd><p>a list of bounds for the nugget parameter.
It is a list containing lower bound <strong>lb</strong> and 
upper bound <strong>ub</strong> with default value 
<code>list(lb=0, ub=Inf)</code>.</p>
</dd>
<dt><strong>range</strong></dt><dd><p>a list of bounds for the range parameter. It has default value
<code>range=list(lb=0, ub=Inf)</code> for the Confluent Hypergeometric covariance, the Matérn covariance, exponential covariance, Gaussian 
covariance, powered-exponential covariance, and Cauchy covariance. The log of range parameterization
is used: <code class="reqn">\log(\phi)</code>.</p>
</dd>
<dt><strong>tail</strong></dt><dd><p>a list of bounds for the tail decay parameter. It has default value
<code>list(lb=0, ub=Inf)</code></p>
</dd></dl>
<p> for the Confluent Hypergeometric covariance and the Cauchy covariance.
</p>
<dl>
<dt><strong>nu</strong></dt><dd><p>a list of bounds for the smoothness parameter. It has default value 
<code>list(lb=0, ub=Inf)</code> for the Confluent Hypergeometric covariance and the Matérn covariance.
when the powered-exponential or Cauchy class 
is used, it has default value <strong>nu</strong>=<code>list(lb=0, ub=2)</code>. 
This can be achieved by specifying the <strong>lower</strong> bound in <code>opt</code>.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="GaSP_+3A_dtype">dtype</code></td>
<td>
<p>a string indicating the type of distance:
</p>

<dl>
<dt>Euclidean</dt><dd><p>Euclidean distance is used. This is the default choice.</p>
</dd>
<dt>GCD</dt><dd><p>Great circle distance is used for data on sphere.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="GaSP_+3A_verbose">verbose</code></td>
<td>
<p>a logical value. If it is <code>TRUE</code>, the MCMC progress bar is shown.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the <code>S4</code> object <a href="#topic+gp-class">gp</a> and prediction results
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPBayes-package">GPBayes-package</a></code>, <code><a href="#topic+gp">gp</a></code>, <code><a href="#topic+gp.mcmc">gp.mcmc</a></code>, <code><a href="#topic+gp.optim">gp.optim</a></code>, <code><a href="#topic+gp.predict">gp.predict</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
code = function(x){
y = (sin(pi*x/5) + 0.2*cos(4*pi*x/5))*(x&lt;=9.6) + (x/10-1)*(x&gt;9.6) 
return(y)
}
n=100
input = seq(0, 20, length=n)
XX = seq(0, 20, length=99)
Ztrue = code(input)
set.seed(1234)
output = Ztrue + rnorm(length(Ztrue), sd=0.1)

# fitting a GaSP model with the objective Bayes approach
fit = GaSP(formula=~1, output, input,  
          param=list(range=3, nugget=0.1, nu=2.5), 
          smooth.est=FALSE, input.new=XX,
          cov.model=list(family="matern", form="isotropic"),
          proposal=list(range=.35, nugget=.8, nu=0.8),
          dtype="Euclidean", model.fit="Cauchy_prior", nsample=50, 
          burnin=10, verbose=TRUE)

</code></pre>

<hr>
<h2 id='gp'>Construct the <code>S4</code> object <a href="#topic+gp-class">gp</a></h2><span id='topic+gp'></span>

<h3>Description</h3>

<p>This function constructs the <code>S4</code> object <a href="#topic+gp-class">gp</a>  that is used for Gaussian process 
model fitting and prediction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp(
  formula = ~1,
  output,
  input,
  param,
  smooth.est = FALSE,
  cov.model = list(family = "CH", form = "isotropic"),
  dtype = "Euclidean"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp_+3A_formula">formula</code></td>
<td>
<p>an object of <code>formula</code> class that specifies regressors; see <code><a href="stats.html#topic+formula">formula</a></code> for details.</p>
</td></tr>
<tr><td><code id="gp_+3A_output">output</code></td>
<td>
<p>a numerical vector including observations or outputs in a GaSP</p>
</td></tr>
<tr><td><code id="gp_+3A_input">input</code></td>
<td>
<p>a matrix including inputs in a GaSP</p>
</td></tr>
<tr><td><code id="gp_+3A_param">param</code></td>
<td>
<p>a list including values for regression parameters, covariance parameters, 
and nugget variance parameter.
The specification of <strong>param</strong> should depend on the covariance model. 
</p>

<ul>
<li><p>The regression parameters are denoted by <strong>coeff</strong>. Default value is <code class="reqn">\mathbf{0}</code>.
</p>
</li>
<li><p>The marginal variance or partial sill is denoted by <strong>sig2</strong>. Default value is 1.
</p>
</li>
<li><p>The nugget variance parameter is denoted by <strong>nugget</strong> for all covariance models. 
Default value is 0.
</p>
</li>
<li><p>For the Confluent Hypergeometric class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\beta</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the generalized Cauchy class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the Matérn class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>nu</strong> is used to denote the smoothness parameter <code class="reqn">\nu</code>. When <code class="reqn">\nu=0.5</code>, the 
Matérn class corresponds to the exponential covariance.  
</p>
</li>
<li><p>For the powered-exponential class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>.
<strong>nu</strong> is used to denote the smoothness parameter. When <code class="reqn">\nu=2</code>, the powered-exponential class
corresponds to the Gaussian covariance.
</p>
</li></ul>
</td></tr>
<tr><td><code id="gp_+3A_smooth.est">smooth.est</code></td>
<td>
<p>a logical value indicating whether smoothness parameter will be estimated.</p>
</td></tr>
<tr><td><code id="gp_+3A_cov.model">cov.model</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
<dt>exp</dt><dd><p>The exponential correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp(-h/\phi),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. This is the Matérn correlation with <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=2.5</code>.</p>
</dd>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="gp_+3A_dtype">dtype</code></td>
<td>
<p>a string indicating the type of distance:
</p>

<dl>
<dt>Euclidean</dt><dd><p>Euclidean distance is used. This is the default choice.</p>
</dd>
<dt>GCD</dt><dd><p>Great circle distance is used for data on sphere.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>S4</code> object of <a href="#topic+gp-class">gp</a> class
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
code = function(x){
y = (sin(pi*x/5) + 0.2*cos(4*pi*x/5))*(x&lt;=9.6) + (x/10-1)*(x&gt;9.6) 
return(y)
}
n=100
input = seq(0, 20, length=n)
XX = seq(0, 20, length=99)
Ztrue = code(input)
set.seed(1234)
output = Ztrue + rnorm(length(Ztrue), sd=0.1)
obj = gp(formula=~1, output, input, 
        param=list(range=4, nugget=0.1,nu=2.5),
        smooth.est=FALSE,
        cov.model=list(family="matern", form="isotropic"))

</code></pre>

<hr>
<h2 id='gp-class'>The <code><a href="#topic+gp">gp</a></code> class</h2><span id='topic+gp-class'></span>

<h3>Description</h3>

<p>This is an S4 class definition for <code><a href="#topic+gp">gp</a></code> in the <code><a href="#topic+GaSP">GaSP</a></code>
package.
</p>


<h3>Slots</h3>


<dl>
<dt><code>formula</code></dt><dd><p>an object of <code>formula</code> class that specifies regressors; see <code><a href="stats.html#topic+formula">formula</a></code> for details.</p>
</dd>
<dt><code>output</code></dt><dd><p>a numerical vector including observations or outputs in a GaSP</p>
</dd>
<dt><code>input</code></dt><dd><p>a matrix including inputs in a GaSP</p>
</dd>
<dt><code>param</code></dt><dd><p>a list including values for regression parameters, correlation parameters, 
and nugget variance parameter.
The specification of <strong>param</strong> should depend on the covariance model. 
</p>

<ul>
<li><p>The regression parameters are denoted by <strong>coeff</strong>. Default value is <code class="reqn">\mathbf{0}</code>.
</p>
</li>
<li><p> The marginal variance or partial sill is denoted by <strong>sig2</strong>. Default value is 1. 
</p>
</li>
<li><p>The nugget variance parameter is denoted by <strong>nugget</strong> for all covariance models. 
Default value is 0.
</p>
</li>
<li><p>For the Confluent Hypergeometric class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\beta</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the generalized Cauchy class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the Matérn class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>nu</strong> is used to denote the smoothness parameter <code class="reqn">\nu</code>. When <code class="reqn">\nu=0.5</code>, the 
Matérn class corresponds to the exponential covariance.  
</p>
</li>
<li><p>For the powered-exponential class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>.
<strong>nu</strong> is used to denote the smoothness parameter. When <code class="reqn">\nu=2</code>, the powered-exponential class
corresponds to the Gaussian covariance.
</p>
</li></ul>
</dd>
<dt><code>cov.model</code></dt><dd><p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
<dt>exp</dt><dd><p>The exponential correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp(-h/\phi),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. This is the Matérn correlation with <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=2.5</code>.</p>
</dd>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</dd>
<dt><code>smooth.est</code></dt><dd><p>a logical value. If it is <code>TRUE</code>, the smoothness parameter 
will be estimated; otherwise the smoothness is not estimated.</p>
</dd>
<dt><code>dtype</code></dt><dd><p>a string indicating the type of distance:
</p>

<dl>
<dt>Euclidean</dt><dd><p>Euclidean distance is used. This is the default choice.</p>
</dd>
<dt>GCD</dt><dd><p>Great circle distance is used for data on sphere.</p>
</dd>
</dl>
</dd>
<dt><code>loglik</code></dt><dd><p>a numerical value containing the log-likelihood with current 
<code><a href="#topic+gp">gp</a></code> object.</p>
</dd>
<dt><code>mcmc</code></dt><dd><p>a list containing MCMC samples if available.</p>
</dd>
<dt><code>prior</code></dt><dd><p>a list containing tuning parameters in prior distribution. This is used only if a Bayes estimation method with informative priors is used.</p>
</dd>
<dt><code>proposal</code></dt><dd><p>a list containing tuning parameters in proposal distribution. This is used only if a Bayes estimation method is used.</p>
</dd>
<dt><code>info</code></dt><dd><p>a list containing the maximum distance in the input space. It should be 
a vector if <strong>isotropic</strong> covariance is used, otherwise it is vector of maximum
distances along each input dimension</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>
</p>

<hr>
<h2 id='gp.fisher'>Fisher information matrix</h2><span id='topic+gp.fisher'></span>

<h3>Description</h3>

<p>This function computes the Fisher information matrix <code class="reqn">I(\sigma^2, \boldsymbol \theta)</code> for a 
Gaussian process model. 
The standard likelihood is defined as 
</p>
<p style="text-align: center;"><code class="reqn"> L(\mathbf{b}, \sigma^2, \boldsymbol \theta; \mathbf{y}) = \mathcal{N}_n(\mathbf{H}\mathbf{b}, \sigma^2 \mathbf{R}),
</code>
</p>

<p>where <code class="reqn">\mathbf{y}:=(y(\mathbf{x}_1), \ldots, y(\mathbf{x}_n))^\top</code> is a vector of <code class="reqn">n</code> observations.
<code class="reqn">\mathbf{H}</code> is a matrix of covariates, <code class="reqn">\mathbf{b}</code> is a vector of regression coefficients, 
<code class="reqn">\sigma^2</code> is the variance parameter, <code class="reqn">\boldsymbol \theta</code> contains correlation
parameters and nugget parameter, <code class="reqn">\mathbf{R}</code> denotes the correlation matrix 
plus nugget variance on the main diagonal.
</p>
<p>The integrated likelihood is defined as
</p>
<p style="text-align: center;"><code class="reqn">
 L^{I}(\sigma^2, \boldsymbol \theta; \mathbf{y}) = \int L(\mathbf{b}, \sigma^2, \boldsymbol \theta; \mathbf{y}) \pi^{R}(\mathbf{b} \mid \sigma^2, \boldsymbol \theta) d \mathbf{b},
</code>
</p>

<p>where <code class="reqn">\pi^{R}(\mathbf{b} \mid \sigma^2, \boldsymbol \theta)=1</code> is the conditional Jeffreys-rule (or reference prior) 
in the model with the above standard likelihood when <code class="reqn">(\sigma^2, \boldsymbol \theta)</code> is assumed to be known.
</p>

<ul>
<li><p>For the Matérn class, current implementation only computes Fisher information matrix 
for variance parameter <code class="reqn">\sigma^2</code>, range parameter <code class="reqn">\phi</code>, and nugget variance 
parameter <code class="reqn">\tau^2</code>. That is, <code class="reqn">I(\sigma^2, \boldsymbol \theta) = I(\sigma^2, \phi, \tau^2)</code>.

</p>
</li>
<li><p>For the Confluent Hypergeometric class, current implementation computes Fisher information matrix
for variance parameter <code class="reqn">\sigma^2</code>, range parameter <code class="reqn">\beta</code>, tail decay parameter <code class="reqn">\alpha</code>, smoothness parameter <code class="reqn">\nu</code> and nugget variance 
parameter <code class="reqn">\tau^2</code>. That is, <code class="reqn">I(\sigma^2, \boldsymbol \theta) = I(\sigma^2, \beta, \alpha, \nu, \tau^2)</code>.

</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>gp.fisher(
  obj = NULL,
  intloglik = FALSE,
  formula = ~1,
  input = NULL,
  param = NULL,
  cov.model = NULL,
  dtype = "Euclidean"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.fisher_+3A_obj">obj</code></td>
<td>
<p>a <code><a href="#topic+gp">gp</a></code> object. It is optional with default value <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gp.fisher_+3A_intloglik">intloglik</code></td>
<td>
<p>a logical value with default value <code>FALSE</code>. If it is <code>FALSE</code>, Fisher information matrix <code class="reqn">I(\sigma^2, \boldsymbol \theta)</code>
is derived based on the standard likelihood; otherwise, Fisher information matrix <code class="reqn">I(\sigma^2, \boldsymbol \theta)</code>
is derived based on the integrated likelihood.</p>
</td></tr>
<tr><td><code id="gp.fisher_+3A_formula">formula</code></td>
<td>
<p>an object of <code>formula</code> class that specifies regressors; see <code><a href="stats.html#topic+formula">formula</a></code> for details.</p>
</td></tr>
<tr><td><code id="gp.fisher_+3A_input">input</code></td>
<td>
<p>a matrix including inputs in a GaSP</p>
</td></tr>
<tr><td><code id="gp.fisher_+3A_param">param</code></td>
<td>
<p>a list including values for regression parameters, covariance parameters, 
and nugget variance parameter.
The specification of <strong>param</strong> should depend on the covariance model. 
</p>

<ul>
<li><p>The regression parameters are denoted by <strong>coeff</strong>. Default value is <code class="reqn">\mathbf{0}</code>.
</p>
</li>
<li><p>The marginal variance or partial sill is denoted by <strong>sig2</strong>. Default value is 1.
</p>
</li>
<li><p>The nugget variance parameter is denoted by <strong>nugget</strong> for all covariance models. 
Default value is 0.
</p>
</li>
<li><p>For the Confluent Hypergeometric class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\beta</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the generalized Cauchy class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the Matérn class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>nu</strong> is used to denote the smoothness parameter <code class="reqn">\nu</code>. When <code class="reqn">\nu=0.5</code>, the 
Matérn class corresponds to the exponential covariance.  
</p>
</li>
<li><p>For the powered-exponential class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>.
<strong>nu</strong> is used to denote the smoothness parameter. When <code class="reqn">\nu=2</code>, the powered-exponential class
corresponds to the Gaussian covariance.
</p>
</li></ul>
</td></tr>
<tr><td><code id="gp.fisher_+3A_cov.model">cov.model</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
<dt>exp</dt><dd><p>The exponential correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp(-h/\phi),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. This is the Matérn correlation with <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=2.5</code>.</p>
</dd>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="gp.fisher_+3A_dtype">dtype</code></td>
<td>
<p>a string indicating the type of distance:
</p>

<dl>
<dt>Euclidean</dt><dd><p>Euclidean distance is used. This is the default choice.</p>
</dd>
<dt>GCD</dt><dd><p>Great circle distance is used for data on sphere.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical matrix of Fisher information
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <code><a href="#topic+gp">gp</a></code>, <code><a href="#topic+kernel">kernel</a></code>, <code><a href="#topic+ikernel">ikernel</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
n=100
input = seq(0, 20, length=n)
range = 1
tail = .5
nu = 1.5
sig2 = 1
nugget = 0.01
coeff = 0
par = list(range=range, tail=tail, nu=nu, sig2=sig2, nugget=nugget, coeff=coeff)
I = gp.fisher(formula=~1, input=input, 
        param=list(range=4, nugget=0.1,nu=2.5),
        cov.model=list(family="CH", form="isotropic"))
</code></pre>

<hr>
<h2 id='gp.get.mcmc'>get posterior summary for MCMC samples</h2><span id='topic+gp.get.mcmc'></span>

<h3>Description</h3>

<p>This function processes posterior samples in the <code><a href="#topic+gp">gp</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp.get.mcmc(obj, burnin = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.get.mcmc_+3A_obj">obj</code></td>
<td>
<p>a <code><a href="#topic+gp">gp</a></code> object</p>
</td></tr>
<tr><td><code id="gp.get.mcmc_+3A_burnin">burnin</code></td>
<td>
<p>a numerical value specifying the burn-in period for calculating posterior summaries.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of posterior summaries
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <code><a href="#topic+gp">gp</a></code>, <code><a href="#topic+gp.mcmc">gp.mcmc</a></code>
</p>

<hr>
<h2 id='gp.mcmc'>A wraper to fit a Gaussian stochastic process model with MCMC algorithms</h2><span id='topic+gp.mcmc'></span>

<h3>Description</h3>

<p>This function is a wraper to estimate parameters via MCMC algorithms in the GaSP model with different
choices of priors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp.mcmc(
  obj,
  input.new = NULL,
  method = "Cauchy_prior",
  prior = list(),
  proposal = list(),
  nsample = 10000,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.mcmc_+3A_obj">obj</code></td>
<td>
<p>an <code>S4</code> object <a href="#topic+gp-class">gp</a></p>
</td></tr>
<tr><td><code id="gp.mcmc_+3A_input.new">input.new</code></td>
<td>
<p>a matrix of prediction locations. Default value is <code>NULL</code>, 
indicating that prediction is not carried out along with parameter estimation in the MCMC algorithm.</p>
</td></tr>
<tr><td><code id="gp.mcmc_+3A_method">method</code></td>
<td>
<p>a string indicating the Bayes estimation approaches with different choices of priors on correlation parameters:
</p>

<dl>
<dt>Cauchy_prior</dt><dd><p>This indicates that a fully Bayesian approach with objective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with half-Cauchy priors (default). 
If the smoothness parameter is estimated for <code>isotropic</code> covariance functions, the smoothness parameter is assigned with a uniform prior on (0, 4), 
indicating that the corresponding GP is at most four times mean-square differentiable. This is a 
reasonable prior belief for modeling spatial processes; If the smoothness parameter is estimated for <code>tensor</code> or <code>ARD</code> covariance functions,
the smoothness parameter is assigned with a uniform prior on (0, 6).</p>
</dd>
<dt>Ref_prior</dt><dd><p>This indicates that a fully Bayesian approach with objective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with reference priors. 
If the smoothness parameter is estimated for <code>isotropic</code> covariance functions, the smoothness parameter is assigned with a uniform prior on (0, 4), 
indicating that the corresponding GP is at most four times mean-square differentiable. This is a 
reasonable prior belief for modeling spatial processes; If the smoothness parameter is estimated for <code>tensor</code> or <code>ARD</code> covariance functions,
the smoothness parameter is assigned with a uniform prior on (0, 6).</p>
</dd>
<dt>Beta_prior</dt><dd><p>This indicates that a fully Bayesian approach with subjective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with <a href="base.html#topic+beta">beta</a> priors parameterized as <code class="reqn">Beta(a, b, lb, ub)</code>.
In the beta distribution, <strong>lb</strong> and <strong>ub</strong> are the support for correlation parameters, and
they should be determined based on domain knowledge. <strong>a</strong> and <strong>b</strong> are two shape parameters with default values at 1,
corresponding to the uniform prior over the support <code class="reqn">(lb, ub)</code>. 
</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="gp.mcmc_+3A_prior">prior</code></td>
<td>
<p>a list containing tuning parameters in prior distributions. This is used only if a Bayes estimation method with subjective priors is used.</p>
</td></tr>
<tr><td><code id="gp.mcmc_+3A_proposal">proposal</code></td>
<td>
<p>a list containing tuning parameters in proposal distributions. This is used only if a Bayes estimation method is used.</p>
</td></tr>
<tr><td><code id="gp.mcmc_+3A_nsample">nsample</code></td>
<td>
<p>an integer indicating the number of MCMC samples.</p>
</td></tr>
<tr><td><code id="gp.mcmc_+3A_verbose">verbose</code></td>
<td>
<p>a logical value. If it is <code>TRUE</code>, the MCMC progress bar is shown.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+gp">gp</a></code> object with prior, proposal, MCMC samples included.
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <a href="#topic+gp-class">gp</a>, <code><a href="#topic+gp.optim">gp.optim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
 
code = function(x){
y = (sin(pi*x/5) + 0.2*cos(4*pi*x/5))*(x&lt;=9.6) + (x/10-1)*(x&gt;9.6) 
return(y)
}
n=100
input = seq(0, 20, length=n)
XX = seq(0, 20, length=99)
Ztrue = code(input)
set.seed(1234)
output = Ztrue + rnorm(length(Ztrue), sd=0.1)
obj = gp(formula=~1, output, input, 
        param=list(range=4, nugget=0.1,nu=2.5),
        smooth.est=FALSE,
        cov.model=list(family="matern", form="isotropic"))
        
fit.mcmc = gp.mcmc(obj, method="Cauchy_prior",
                   proposal=list(range=0.3, nugget=0.8),
                   nsample=100, verbose=TRUE)
                   
</code></pre>

<hr>
<h2 id='gp.model.adequacy'>Model assessment based on Deviance information criterion (DIC), logarithmic pointwise predictive density (lppd), and
logarithmic joint predictive density (ljpd).</h2><span id='topic+gp.model.adequacy'></span>

<h3>Description</h3>

<p>This function computes effective number of parameters (pD), deviance information criterion (DIC), logarithmic pointwise predictive density (lppd), and
logarithmic joint predictive density (ljpd). For detailed introduction of these 
metrics, see Chapter 7 of Gelman et al. (2013).
</p>
<p>The deviance function for a model with a vector of parameters 
<code class="reqn">\boldsymbol \theta</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">
 D(\boldsymbol \theta) = -2\log p(\mathbf{y} \mid \boldsymbol \theta),
</code>
</p>
 
<p>where <code class="reqn">\mathbf{y}:=(y(\mathbf{x}_1), \ldots, y(\mathbf{x}_n))^\top</code> is a vector of <code class="reqn">n</code> observations.
</p>

<ul>
<li><p>The effective number of parameters (see p.172 of Gelman et al. 2013) is defined as
</p>
<p style="text-align: center;"><code class="reqn">
 pD = E_{\boldsymbol \theta| \mathbf{y}}[D(\boldsymbol \theta)] - D(\hat{ \boldsymbol \theta }),
 </code>
</p>

<p>where <code class="reqn">\hat{\boldsymbol \theta} = E_{\boldsymbol \theta | \mathbf{y}}[\boldsymbol \theta]. </code>
The interpretation is that the effective number of parameters is the &ldquo;expected&quot; 
deviance minus the &ldquo;fitted&quot; deviance. Higher <code class="reqn">pD</code> implies more over-fitting with estimate  <code class="reqn">\hat{\boldsymbol \theta}</code>.

</p>
</li>
<li><p>The Deviance information criteria (DIC) (see pp. 172-173 of Gelman et al. 2013) is 
</p>
<p style="text-align: center;"><code class="reqn">DIC = E_{\boldsymbol \theta | \mathbf{y}}[D(\boldsymbol \theta)] + pD.
</code>
</p>

<p>DIC approximates Akaike information criterion (AIC) and is more appropriate for hierarchical models than AIC and BIC.

</p>
</li>
<li><p>The log predictive density (<strong>lpd</strong>) is defined as 
</p>
<p style="text-align: center;"><code class="reqn"> p(y(\mathbf{x}_0) \mid \mathbf{y}) = \int p(y(\mathbf{x}_0) \mid 
\boldsymbol \theta, \mathbf{y}) p(\boldsymbol \theta \mid \mathbf{y}) 
d \boldsymbol \theta,
</code>
</p>

<p>where <code class="reqn">\mathbf{y}:=(y(\mathbf{x}_1), \ldots, y(\mathbf{x}_n))^\top</code> is a vector of <code class="reqn">n</code> observations.
<code class="reqn">\boldsymbol \theta</code> contains correlation
parameters and nugget parameter. This predictive density should be understood as an update of the likelihood since data is treated as prior information now.
With a set of prediction locations <code class="reqn">\mathcal{X}:=\{x_0^i: i=1, \ldots, m\}</code>. 
The log pointwise predictive density (<strong>lppd</strong>) is defined as
</p>
<p style="text-align: center;"><code class="reqn">lppd = \sum_{i=1}^m \log p(y(\mathbf{x}_0^i) 
\mid \mathbf{y}).</code>
</p>
 
<p>The log joint predictive density (<strong>ljpd</strong>) is defined as 
</p>
<p style="text-align: center;"><code class="reqn">ljpd = \log p(y(\mathcal{X})). </code>
</p>

<p>The <code>lppd</code> is connected to cross-validation, while the <code>ljpd</code> measures joint uncertainty across prediction locations.

</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>gp.model.adequacy(
  obj,
  testing.input,
  testing.output,
  pointwise = TRUE,
  joint = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.model.adequacy_+3A_obj">obj</code></td>
<td>
<p>a <code><a href="#topic+gp">gp</a></code> object.</p>
</td></tr>
<tr><td><code id="gp.model.adequacy_+3A_testing.input">testing.input</code></td>
<td>
<p>a matrix of testing inputs</p>
</td></tr>
<tr><td><code id="gp.model.adequacy_+3A_testing.output">testing.output</code></td>
<td>
<p>a vector of testing outputs</p>
</td></tr>
<tr><td><code id="gp.model.adequacy_+3A_pointwise">pointwise</code></td>
<td>
<p>a logical value with default value <code>TRUE</code>. If it is
<code>TRUE</code>, <strong>lppd</strong> is calculated.</p>
</td></tr>
<tr><td><code id="gp.model.adequacy_+3A_joint">joint</code></td>
<td>
<p>a logical value with default value <code>TRUE</code>. If it is
<code>TRUE</code>, <strong>ljpd</strong> is calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containingg <strong>pD</strong>, <strong>DIC</strong>, <strong>lppd</strong>, <strong>ljpd</strong>.
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>References</h3>


<ul>
<li><p>Gelman, Andrew, John B. Carlin, Hal S. Stern, David B. Dunson, 
Aki Vehtari, and Donald B. Rubin (2013). 
Bayesian Data Analysis, Third Edition. CRC Press.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <code><a href="#topic+gp">gp</a></code>,
</p>

<hr>
<h2 id='gp.optim'>A wraper to fit a Gaussian stochastic process model with optimization methods</h2><span id='topic+gp.optim'></span>

<h3>Description</h3>

<p>This function is a wraper to estimate parameters in the GaSP model with different
choices of estimation methods using numerical optimization methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp.optim(obj, method = "MMLE", opt = NULL, bound = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.optim_+3A_obj">obj</code></td>
<td>
<p>an <code>S4</code> object <a href="#topic+gp-class">gp</a></p>
</td></tr>
<tr><td><code id="gp.optim_+3A_method">method</code></td>
<td>
<p>a string indicating the parameter estimation method:
</p>

<dl>
<dt>MPLE</dt><dd><p>This indicates that the <em>maximum profile likelihood estimation</em> 
(<strong>MPLE</strong>) is used.</p>
</dd>
<dt>MMLE</dt><dd><p>This indicates that the <em>maximum marginal likelihood estimation</em> 
(<strong>MMLE</strong>) is used.</p>
</dd>
<dt>MAP</dt><dd><p>This indicates that the marginal/integrated posterior is maximized.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="gp.optim_+3A_opt">opt</code></td>
<td>
<p>a list of arguments to setup the <code><a href="stats.html#topic+optim">optim</a></code> routine. Current implementation uses three arguments: 
</p>

<dl>
<dt>method</dt><dd><p>The optimization method: <code>Nelder-Mead</code> or <code>L-BFGS-B</code>.</p>
</dd>
<dt>lower</dt><dd><p>The lower bound for parameters.</p>
</dd>
<dt>upper</dt><dd><p>The upper bound for parameters.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="gp.optim_+3A_bound">bound</code></td>
<td>
<p>Default value is <code>NULL</code>. Otherwise, it should be a list
containing the following elements depending on the covariance class:
</p>

<dl>
<dt><strong>nugget</strong></dt><dd><p>a list of bounds for the nugget parameter.
It is a list containing lower bound <strong>lb</strong> and 
upper bound <strong>ub</strong> with default value 
<code>list(lb=0, ub=Inf)</code>.</p>
</dd>
<dt><strong>range</strong></dt><dd><p>a list of bounds for the range parameter. Tt has default value
<code>range=list(lb=0, ub=Inf)</code> for the Confluent Hypergeometric covariance, the Matérn covariance, exponential covariance, Gaussian 
covariance, powered-exponential covariance, and Cauchy covariance. The log of range parameterization
is used: <code class="reqn">\log(\phi)</code>.</p>
</dd>
<dt><strong>tail</strong></dt><dd><p>a list of bounds for the tail decay parameter. It has default value
<code>list(lb=0, ub=Inf)</code></p>
</dd></dl>
<p> for the Confluent Hypergeometric covariance and the Cauchy covariance.
</p>
<dl>
<dt><strong>nu</strong></dt><dd><p>a list of bounds for the smoothness parameter. It has default value 
<code>list(lb=0, ub=Inf)</code> for the Confluent Hypergeometric covariance and the Matérn covariance.
when the powered-exponential or Cauchy class 
is used, it has default value <strong>nu</strong>=<code>list(lb=0, ub=2)</code>. 
This can be achived by specifying the <strong>lower</strong> bound in <code>opt</code>.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of updated <code><a href="#topic+gp">gp</a></code> object <strong>obj</strong> and 
fitted information <strong>fit</strong>
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <a href="#topic+gp-class">gp</a>, <code><a href="#topic+gp.mcmc">gp.mcmc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
code = function(x){
y = (sin(pi*x/5) + 0.2*cos(4*pi*x/5))*(x&lt;=9.6) + (x/10-1)*(x&gt;9.6) 
return(y)
}
n=100
input = seq(0, 20, length=n)
XX = seq(0, 20, length=99)
Ztrue = code(input)
set.seed(1234)
output = Ztrue + rnorm(length(Ztrue), sd=0.1)
obj = gp(formula=~1, output, input, 
        param=list(range=4, nugget=0.1,nu=2.5),
        smooth.est=FALSE,
        cov.model=list(family="matern", form="isotropic"))
        
fit.optim = gp.optim(obj, method="MPLE")


</code></pre>

<hr>
<h2 id='gp.predict'>Prediction at new inputs based on a Gaussian stochastic process model</h2><span id='topic+gp.predict'></span>

<h3>Description</h3>

<p>This function provides the capability to make prediction based on a GaSP
when different estimation methods are employed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp.predict(obj, input.new, method = "Bayes")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.predict_+3A_obj">obj</code></td>
<td>
<p>an <code>S4</code> object <a href="#topic+gp-class">gp</a></p>
</td></tr>
<tr><td><code id="gp.predict_+3A_input.new">input.new</code></td>
<td>
<p>a matrix of new input lomessageions</p>
</td></tr>
<tr><td><code id="gp.predict_+3A_method">method</code></td>
<td>
<p>a string indicating the parameter estimation method:
</p>

<dl>
<dt>MPLE</dt><dd><p>This indicates that the <em>maximum profile likelihood estimation</em> 
(<strong>MPLE</strong>) is used. This correponds to simple kriging formulas</p>
</dd>
<dt>MMLE</dt><dd><p>This indicates that the <em>maximum marginal likelihood estimation</em> 
(<strong>MMLE</strong>) is used. This corresponds to universal kriging formulas when the vairance
parameter is not integrated out. If the variance parameter is integrated out, 
the predictive variance differs from the universal kriging variance by the 
factor <code class="reqn">\frac{n-q}{n-q-2}</code>, since the predictive distribution is a 
Student's <code class="reqn">t</code>-distribution with degrees of freedom <code class="reqn">n-q</code>.
</p>
</dd>
<dt>MAP</dt><dd><p>This indicates that the posterior estimates of model parameters are plugged into 
the posterior predictive distribution. Thus this approach does not take account into uncertainty 
in model parameters (<strong>range</strong>, <strong>tail</strong>, <strong>nu</strong>, <strong>nugget</strong>).</p>
</dd>
<dt>Bayes</dt><dd><p>This indicates that a fully Bayesian approach is used
for parameter estimation (and hence prediction). This approach takes into account uncertainty in 
all model parameters.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of predictive mean, predictive standard deviation, 95
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <a href="#topic+gp-class">gp</a>, <code><a href="#topic+gp.mcmc">gp.mcmc</a></code>, <code><a href="#topic+gp.optim">gp.optim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 
code = function(x){
y = (sin(pi*x/5) + 0.2*cos(4*pi*x/5))*(x&lt;=9.6) + (x/10-1)*(x&gt;9.6) 
return(y)
}
n=100
input = seq(0, 20, length=n)
XX = seq(0, 20, length=99)
Ztrue = code(input)
set.seed(1234)
output = Ztrue + rnorm(length(Ztrue), sd=0.1)
obj = gp(formula=~1, output, input, 
        param=list(range=4, nugget=0.1,nu=2.5),
        smooth.est=FALSE,
        cov.model=list(family="matern", form="isotropic"))
 
fit.optim = gp.optim(obj, method="MMLE")
obj = fit.optim$obj
pred = gp.predict(obj, input.new=XX, method="MMLE")
                   
                   
                   
                   

</code></pre>

<hr>
<h2 id='gp.sim'>Simulate from a Gaussian stochastic process model</h2><span id='topic+gp.sim'></span>

<h3>Description</h3>

<p>This function simulates realizations from Gaussian processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp.sim(
  formula = ~1,
  input,
  param,
  cov.model = list(family = "CH", form = "isotropic"),
  dtype = "Euclidean",
  nsample = 1,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.sim_+3A_formula">formula</code></td>
<td>
<p>an object of <code>formula</code> class that specifies regressors; see <code><a href="stats.html#topic+formula">formula</a></code> for details.</p>
</td></tr>
<tr><td><code id="gp.sim_+3A_input">input</code></td>
<td>
<p>a matrix including inputs in a GaSP</p>
</td></tr>
<tr><td><code id="gp.sim_+3A_param">param</code></td>
<td>
<p>a list including values for regression parameters, covariance parameters, 
and nugget variance parameter.
The specification of <strong>param</strong> should depend on the covariance model. 
</p>

<ul>
<li><p>The regression parameters are denoted by <strong>coeff</strong>. Default value is <code class="reqn">\mathbf{0}</code>.
</p>
</li>
<li><p>The marginal variance or partial sill is denoted by <strong>sig2</strong>. Default value is 1.
</p>
</li>
<li><p>The nugget variance parameter is denoted by <strong>nugget</strong> for all covariance models. 
Default value is 0.
</p>
</li>
<li><p>For the Confluent Hypergeometric class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\beta</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the generalized Cauchy class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li><p>For the Matérn class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>nu</strong> is used to denote the smoothness parameter <code class="reqn">\nu</code>. When <code class="reqn">\nu=0.5</code>, the 
Matérn class corresponds to the exponential covariance.  
</p>
</li>
<li><p>For the powered-exponential class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>.
<strong>nu</strong> is used to denote the smoothness parameter. When <code class="reqn">\nu=2</code>, the powered-exponential class
corresponds to the Gaussian covariance.
</p>
</li></ul>
</td></tr>
<tr><td><code id="gp.sim_+3A_cov.model">cov.model</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
<dt>exp</dt><dd><p>The exponential correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp(-h/\phi),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. This is the Matérn correlation with <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>The Matérn correlation with <code class="reqn">\nu=2.5</code>.</p>
</dd>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="gp.sim_+3A_dtype">dtype</code></td>
<td>
<p>a string indicating the type of distance:
</p>

<dl>
<dt>Euclidean</dt><dd><p>Euclidean distance is used. This is the default choice.</p>
</dd>
<dt>GCD</dt><dd><p>Great circle distance is used for data on sphere.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="gp.sim_+3A_nsample">nsample</code></td>
<td>
<p>an integer indicating the number of realizations from a Gaussian process</p>
</td></tr>
<tr><td><code id="gp.sim_+3A_seed">seed</code></td>
<td>
<p>a number specifying random number seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical vector or a matrix
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <a href="#topic+gp-class">gp</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n=50
y.sim = gp.sim(input=seq(0,1,length=n),
               param=list(range=0.5,nugget=0.1,nu=2.5),
               cov.model=list(family="matern",form="isotropic"),
               seed=123)

</code></pre>

<hr>
<h2 id='HypergU'>Confluent hypergeometric function of the second kind</h2><span id='topic+HypergU'></span>

<h3>Description</h3>

<p>This function calls the GSL scientific library to evaluate 
the confluent hypergeometric function of the second kind; see Abramowitz and Stegun 1972, p.505.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HypergU(a, b, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HypergU_+3A_a">a</code></td>
<td>
<p>a real value</p>
</td></tr>
<tr><td><code id="HypergU_+3A_b">b</code></td>
<td>
<p>a real value</p>
</td></tr>
<tr><td><code id="HypergU_+3A_x">x</code></td>
<td>
<p>a real value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical value
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CH">CH</a></code>
</p>

<hr>
<h2 id='ikernel'>A wraper to build different kinds of correlation matrices between two sets of inputs</h2><span id='topic+ikernel'></span>

<h3>Description</h3>

<p>This function wraps existing built-in routines to construct a covariance 
matrix for two input matrices based on data type, covariance type, and distance type. The constructed 
covariance matrix can be directly used for GaSP fitting and and prediction for spatial 
data, spatio-temporal data, and computer experiments. This function explicitly takes inputs as arguments. 
The prefix &ldquo;i&quot; in <code><a href="#topic+ikernel">ikernel</a></code> standards for &ldquo;input&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ikernel(input1, input2, range, tail, nu, covmodel, dtype = "Euclidean")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ikernel_+3A_input1">input1</code></td>
<td>
<p>a matrix of input locations</p>
</td></tr>
<tr><td><code id="ikernel_+3A_input2">input2</code></td>
<td>
<p>a matrix of input locations</p>
</td></tr>
<tr><td><code id="ikernel_+3A_range">range</code></td>
<td>
<p>a vector of range parameters, which could be a scalar.</p>
</td></tr>
<tr><td><code id="ikernel_+3A_tail">tail</code></td>
<td>
<p>a vector of tail decay parameters, which could be a scalar.</p>
</td></tr>
<tr><td><code id="ikernel_+3A_nu">nu</code></td>
<td>
<p>a vector of smoothness parameters, which could be a scalar.</p>
</td></tr>
<tr><td><code id="ikernel_+3A_covmodel">covmodel</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
</dl>

<dl>
<dt>exp</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=0.5</code>. This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=1.5</code>.
This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=2.5</code>. 
This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=2.5</code>.</p>
</dd>
</dl>

<dl>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="ikernel_+3A_dtype">dtype</code></td>
<td>
<p>a string indicating distance type: <strong>Euclidean</strong>, <strong>GCD</strong>, where the latter indicates great circle distance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a correlation matrix
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CH">CH</a></code>, <code><a href="#topic+matern">matern</a></code>, <code><a href="#topic+kernel">kernel</a></code>, <a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>input = seq(0,1,length=10)

cormat = ikernel(input,input,range=0.5,tail=0.2,nu=2.5,
         covmodel=list(family="CH",form="isotropic"))

</code></pre>

<hr>
<h2 id='kernel'>A wraper to build different kinds of correlation matrices with distance as arguments</h2><span id='topic+kernel'></span>

<h3>Description</h3>

<p>This function wraps existing built-in routines to construct a covariance 
matrix based on data type, covariance type, and distance type with distances as inputs. The constructed 
covariance matrix can be directly used for GaSP fitting and and prediction for spatial 
data, spatio-temporal data, and computer experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel(d, range, tail, nu, covmodel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel_+3A_d">d</code></td>
<td>
<p>a matrix or a list of distances</p>
</td></tr>
<tr><td><code id="kernel_+3A_range">range</code></td>
<td>
<p>a vector of range parameters, which could be a scalar.</p>
</td></tr>
<tr><td><code id="kernel_+3A_tail">tail</code></td>
<td>
<p>a vector of tail decay parameters, which could be a scalar.</p>
</td></tr>
<tr><td><code id="kernel_+3A_nu">nu</code></td>
<td>
<p>a vector of smoothness parameters, which could be a scalar.</p>
</td></tr>
<tr><td><code id="kernel_+3A_covmodel">covmodel</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
</dl>

<dl>
<dt>exp</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=0.5</code>. This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=1.5</code>.
This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=2.5</code>. 
This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=2.5</code>.</p>
</dd>
</dl>

<dl>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>a correlation matrix
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CH">CH</a></code>, <code><a href="#topic+matern">matern</a></code>, <code><a href="#topic+ikernel">ikernel</a></code>, <a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>input = seq(0,1,length=10)
d = distance(input,input,type="isotropic",dtype="Euclidean")
cormat = kernel(d,range=0.5,tail=0.2,nu=2.5,
         covmodel=list(family="CH",form="isotropic"))
</code></pre>

<hr>
<h2 id='loglik'>A wraper to compute the natural logarithm of the integrated likelihood function</h2><span id='topic+loglik'></span>

<h3>Description</h3>

<p>This function wraps existing built-in routines to construct  
the natural logarithm of the integrated likelihood function. The constructed 
loglikelihood can be directly used for numerical optimization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik(par, output, H, d, covmodel, smooth, smoothness_est)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_+3A_par">par</code></td>
<td>
<p>a numerical vector, with which numerical optimization routine such as <code><a href="stats.html#topic+optim">optim</a></code> can be
carried out directly. When the confluent Hypergeometric class is used, it is used to hold values 
for <strong>range</strong>, <strong>tail</strong>, <strong>nugget</strong>, and <strong>nu</strong> if the smoothness parameter is estimated.
When the Matérn class or powered-exponential class is used, it is used to hold values
for <strong>range</strong>, <strong>nugget</strong>, and <strong>nu</strong> if the smoothness parameter is estimated.
The order of the parameter values in <code>par</code> cannot be changed. For tensor or ARD form correlation
functions, <strong>range</strong> and <strong>tail</strong> becomes a vector.</p>
</td></tr>
<tr><td><code id="loglik_+3A_output">output</code></td>
<td>
<p>a matrix of outputs</p>
</td></tr>
<tr><td><code id="loglik_+3A_h">H</code></td>
<td>
<p>a matrix of regressors in the mean function of a GaSP model.</p>
</td></tr>
<tr><td><code id="loglik_+3A_d">d</code></td>
<td>
<p>an R object holding the distances. It should be a distance matrix for constructing isotropic correlation matrix,
or a list of distance matrices along each input dimension for constructing tensor or ARD types of correlation matrix.</p>
</td></tr>
<tr><td><code id="loglik_+3A_covmodel">covmodel</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt><dd>

<dl>
<dt>CH</dt><dd><p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2019) at <a href="https://arxiv.org/abs/1911.05865">https://arxiv.org/abs/1911.05865</a>.  
</p>
</dd>
<dt>cauchy</dt><dd><p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt><dd><p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
</dl>

<dl>
<dt>exp</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=0.5</code>. This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=1.5</code>.
This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt><dd><p>This is the Matérn correlation with <code class="reqn">\nu=2.5</code>. 
This covariance should be specified as <strong>matern</strong> with smoothness parameter <code class="reqn">\nu=2.5</code>.</p>
</dd>
</dl>

<dl>
<dt>powexp</dt><dd><p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt><dd><p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>

</dd>
<dt><strong>form</strong></dt><dd>

<dl>
<dt>isotropic</dt><dd><p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt><dd><p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt><dd><p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>

</dd>
</dl>
</td></tr>
<tr><td><code id="loglik_+3A_smooth">smooth</code></td>
<td>
<p>The smoothness parameter <code class="reqn">\nu</code> in a correlation function.</p>
</td></tr>
<tr><td><code id="loglik_+3A_smoothness_est">smoothness_est</code></td>
<td>
<p>a logical value indicating whether the smoothness parameter is estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The natural logarithm of marginal or integrated likelihood
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CH">CH</a></code>, <code><a href="#topic+matern">matern</a></code>, <code><a href="#topic+gp.optim">gp.optim</a></code>, <a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>
</p>

<hr>
<h2 id='matern'>The Matérn correlation function proposed by Matérn (1960)</h2><span id='topic+matern'></span>

<h3>Description</h3>

<p>This function computes the Matérn correlation function given
a distance matrix. The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left(\frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
The form of covariance includes the following special cases by specifying <code class="reqn">\nu</code> to be 0.5, 1.5, 2.5.
</p>

<ul>
<li><p><code class="reqn">\nu=0.5</code> corresponds to the  exponential correlation function (<strong>exp</strong>) 
of the form
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \exp\left\{ - \frac{h}{\phi} \right\} </code>
</p>


</li>
<li><p><code class="reqn">\nu=1.5</code> corresponds to the Matérn correlation function with smoothness parameter 1.5 (<strong>matern_3_2</strong>) 
of the form
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left( 1 + \frac{h}{\phi} \right) \exp\left\{ - \frac{h}{\phi} \right\} </code>
</p>


</li>
<li><p><code class="reqn">\nu=2.5</code> corresponds to the Matérn correlation function with smoothness parameter 2.5 (<strong>matern_5_2</strong>) 
of the form
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \frac{h}{\phi}  + \frac{1}{3}\left(\frac{h}{\phi}\right)^2 \right\} \exp\left\{ - \frac{h}{\phi} \right\} </code>
</p>


</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>matern(d, range, nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matern_+3A_d">d</code></td>
<td>
<p>a matrix of distances</p>
</td></tr>
<tr><td><code id="matern_+3A_range">range</code></td>
<td>
<p>a numerical value containing the range parameter</p>
</td></tr>
<tr><td><code id="matern_+3A_nu">nu</code></td>
<td>
<p>a numerical value containing the smoothness parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical matrix
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+GPBayes-package">GPBayes-package</a>, <code><a href="#topic+GaSP">GaSP</a></code>, <a href="#topic+gp-class">gp</a>, <code><a href="#topic+CH">CH</a></code>, <code><a href="#topic+kernel">kernel</a></code>, <code><a href="#topic+ikernel">ikernel</a></code>
</p>

<hr>
<h2 id='powexp'>The powered-exponential correlation function</h2><span id='topic+powexp'></span>

<h3>Description</h3>

<p>This function computes the powered-exponential correlation function given
a distance matrix. The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
The case <code class="reqn">\nu=2</code> corresponds to the well-known Gaussian correlation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powexp(d, range, nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powexp_+3A_d">d</code></td>
<td>
<p>a matrix of distances</p>
</td></tr>
<tr><td><code id="powexp_+3A_range">range</code></td>
<td>
<p>a numerical value containing the range parameter</p>
</td></tr>
<tr><td><code id="powexp_+3A_nu">nu</code></td>
<td>
<p>a numerical value containing the smoothness parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical matrix
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kernel">kernel</a></code>
</p>

<hr>
<h2 id='show+2Cgp-method'>Print the information an object of the <code><a href="#topic+gp">gp</a></code> class</h2><span id='topic+show+2Cgp-method'></span><span id='topic+show+2Cgp-methods'></span>

<h3>Description</h3>

<p>Print the information an object of the <code><a href="#topic+gp">gp</a></code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'gp'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cgp-method_+3A_object">object</code></td>
<td>
<p>an object of <code><a href="#topic+gp">gp</a></code> class</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
