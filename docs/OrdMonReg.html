<!DOCTYPE html><html><head><title>Help for package OrdMonReg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OrdMonReg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#OrdMonReg-package'><p>Compute least squares estimates of one bounded or two ordered antitonic regression curves</p></a></li>
<li><a href='#astar_1, bstar_n'><p>Computes explicitly known values of the estimates in the two ordered functions antitonic regression problem</p></a></li>
<li><a href='#BoundedAntiMean, BoundedIsoMean'><p>Compute least square estimate of an iso- or antitonic function, bounded below and above by fixed functions</p></a></li>
<li><a href='#BoundedAntiMeanTwo, BoundedIsoMeanTwo'><p>Compute solution to the problem of two ordered isotonic or antitonic curves</p></a></li>
<li><a href='#BoundedIsoMeanTwoDykstra'><p>Compute solution to the problem of two ordered isotonic or antitonic curves</p></a></li>
<li><a href='#disp'><p>Function to display numbers in outputs</p></a></li>
<li><a href='#LSfunctional'><p>Compute least squares criterion for two ordered isotonic regression functions</p></a></li>
<li><a href='#MA'><p>Compute bounded weighted average</p></a></li>
<li><a href='#mechIng'><p>Mechanical engineering dataset used to illustrate ordered isotonic regression</p></a></li>
<li><a href='#minK'><p>Compute projections on restriction cones in Dykstra's algorithm.</p></a></li>
<li><a href='#Subgradient'><p>Computes a subgradient for the projected subgradient algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Compute least squares estimates of one bounded or two ordered
isotonic regression curves</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2011-11-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Fadoua Balabdaoui, Kaspar Rufibach, Filippo Santambrogio</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaspar Rufibach &lt;kaspar.rufibach@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We consider the problem of estimating two isotonic regression curves g1* and g2* under the constraint that they are ordered, i.e. g1* &lt;= g2*. Given two sets of n data points y_1, ..., y_n and z_1, ..., z_n that are observed at (the same) deterministic design points x_1, ..., x_n, the estimates are obtained by minimizing the Least Squares criterion L(a, b) = sum_{i=1}^n (y_i - a_i)^2 w1(x_i) + sum_{i=1}^n (z_i - b_i)^2 w2(x_i) over the class of pairs of vectors (a, b) such that a and b are isotonic and a_i &lt;= b_i for all i = 1, ..., n. We offer two different approaches to compute the estimates: a projected subgradient algorithm where the projection is calculated using a PAVA as well as Dykstra's cyclical projection algorithm.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>,
<a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>,
<a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2011-11-30 18:13:43 UTC; rufibach</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2011-12-01 08:00:09</td>
</tr>
</table>
<hr>
<h2 id='OrdMonReg-package'>Compute least squares estimates of one bounded or two ordered antitonic regression curves</h2><span id='topic+OrdMonReg-package'></span><span id='topic+OrdMonReg'></span>

<h3>Description</h3>

<p>We consider the problem of estimating two isotonic regression curves <code class="reqn">g^\circ_1</code> and <code class="reqn">g^\circ_2</code> under the 
constraint that <code class="reqn">g^\circ_1 \le g^\circ_2</code>. Given two sets of <code class="reqn">n</code> data points <code class="reqn">y_1, \ldots, y_n</code> 
and <code class="reqn">z_1, \ldots, z_n</code> 
that are observed at (the same) deterministic design points <code class="reqn">x_1, \ldots, x_n</code>, the estimates are obtained by 
minimizing the Least Squares criterion 
</p>
<p style="text-align: center;"><code class="reqn">L(a, b) = \sum_{i=1}^n (y_i - a_i)^2 w_1(x_i) + \sum_{i=1}^n (z_i - b_i)^2 w_2(x_i)</code>
</p>

<p>over the class of pairs of vectors <code class="reqn">(a, b)</code> such that <code class="reqn">a</code> and <code class="reqn">b</code> are isotonic and 
<code class="reqn">a_i \le b_i</code> for all <code class="reqn">i = {1, \ldots, n}</code>. We offer two different approaches to compute the estimates: a 
projected subgradient algorithm where the projection is calculated using a pool-adjacent-violaters algorithm (PAVA) 
as well as Dykstra's cyclical projection algorithm..
</p>
<p>Additionally, functions to solve the bounded isotonic regression problem described in Barlow et al. (1972, p. 57)
are provided.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> OrdMonReg</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2011-11-30</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered monotone regression curves.</em>
Preprint.
</p>
<p>Barlow, R. E., Bartholomew, D. J., Bremner, J. M., Brunk, H. D. (1972).
<em>Statistical inference under order restrictions. The theory and application of isotonic regression</em>.
John Wiley and Sons, London - New York - Sydney.
</p>
<p>Dykstra, R.L. (1983).
An Algorithm for Restricted Least Squares Regression.
<em>J. Amer. Statist. Assoc.</em>, <b>78</b>, 837&ndash;842.
</p>


<h3>See Also</h3>

<p>Other versions of bounded regression are implemented in the packages <span class="pkg">cir</span>, 
<span class="pkg">Iso</span>, <span class="pkg">monreg</span>. The function
<code><a href="#topic+BoundedIsoMean">BoundedIsoMean</a></code> is a generalization of the function <code>isoMean</code> in the package
<span class="pkg">logcondens</span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## examples are provided in the help files of the main functions of this package:
?BoundedAntiMean
?BoundedAntiMeanTwo
</code></pre>

<hr>
<h2 id='astar_1+2C+20bstar_n'>Computes explicitly known values of the estimates in the two ordered functions antitonic regression problem</h2><span id='topic+astar_1'></span><span id='topic+bstar_n'></span>

<h3>Description</h3>

<p>These functions compute the values <code class="reqn">a_1^*</code> and <code class="reqn">b_n^*</code>, the value of the estimate of the 
upper function at <code class="reqn">x_1</code> and the value of the lower estimated function at <code class="reqn">x_n</code> in the two ordered
antitonic regression functions problem. These values can be computed via explicit formulas, unlike the values at
<code class="reqn">x \in {x_2, \ldots, x_{n-1}}</code>, which are received via a projected subgradient algorithm. However, 
<code class="reqn">b_n^*</code> enters this algorithm as an auxiliary quantity.</p>


<h3>Usage</h3>

<pre><code class='language-R'>astar_1(g1, w1, g2, w2)
bstar_n(g1, w1, g2, w2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="astar_1+2B2C+2B20bstar_n_+3A_g1">g1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of upper function.</p>
</td></tr>
<tr><td><code id="astar_1+2B2C+2B20bstar_n_+3A_w1">w1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for upper function.</p>
</td></tr>
<tr><td><code id="astar_1+2B2C+2B20bstar_n_+3A_g2">g2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of lower function.</p>
</td></tr>
<tr><td><code id="astar_1+2B2C+2B20bstar_n_+3A_w2">w2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for lower function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Values of <code class="reqn">a_1^*</code> and <code class="reqn">b_n^*</code> are returned.</p>


<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered monotone regression curves.</em>
Preprint.
</p>


<h3>See Also</h3>

<p>This function is used by <code><a href="#topic+BoundedAntiMeanTwo">BoundedAntiMeanTwo</a></code>.</p>

<hr>
<h2 id='BoundedAntiMean+2C+20BoundedIsoMean'>Compute least square estimate of an iso- or antitonic function, bounded below and above by fixed functions</h2><span id='topic+BoundedIsoMean'></span><span id='topic+BoundedAntiMean'></span>

<h3>Description</h3>

<p>This function computes the bounded least squares isotonic regression estimate, where the bounds
are two functions such that the estimate is above the lower and below the upper function. To find the solution, we
use the pool-adjacent-violaters algorithm for a suitable set function M, as discussed in Balabdaoui et al. (2009).
The problem was initially posed in Barlow et al. (1972), including a remark (on p. 57) that the PAVA can be used to solve
it. However, a formal proof is not given in Barlow et al. (1972). A short note detailing this proof
is available from the authors of Balabdaoui et al. (2009) on request.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BoundedIsoMean(y, w, a = NA, b = NA)
BoundedAntiMean(y, w, a = NA, b = NA)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BoundedAntiMean+2B2C+2B20BoundedIsoMean_+3A_y">y</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code> of measurements.</p>
</td></tr>
<tr><td><code id="BoundedAntiMean+2B2C+2B20BoundedIsoMean_+3A_w">w</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code> of weights.</p>
</td></tr>
<tr><td><code id="BoundedAntiMean+2B2C+2B20BoundedIsoMean_+3A_a">a</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code> that gives lower bound.</p>
</td></tr>
<tr><td><code id="BoundedAntiMean+2B2C+2B20BoundedIsoMean_+3A_b">b</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code> that gives upper bound.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>bounded isotonic regression problem</em> is given by: For <code class="reqn">x_1 \le \ldots \le x_n</code> 
let <code class="reqn">y_i, i = 1, \ldots, n</code> be measurements of some quantity at the <code class="reqn">x_i</code>'s, with true mean function 
<code class="reqn">g^\circ(x)</code>.
The goal is to estimate <code class="reqn">g^\circ</code> using least squares, i.e. to minimize
</p>
<p style="text-align: center;"><code class="reqn">L(a) = \sum_{i=1}^n w_i(y_i - a_i)^2</code>
</p>

<p>over the class of vectors <code class="reqn">a</code> that are isotonic and satisfy 
</p>
<p style="text-align: center;"><code class="reqn">a_{L, i} \le a_i \le a_{U, i} \ \ \mathrm{for} \ \ \mathrm{all} \ \ i = 1, \ldots, n</code>
</p>

<p>and two <em>fixed</em> isotonic vectors <code class="reqn">a_L</code> and <code class="reqn">a_U</code>. 
This problem can be solved using a suitable modification of the pool-adjacent-violaters algorithm, see
Barlow et al. (1972, p. 57) and Balabdaoui et al. (2009).
</p>
<p>The function <code>BoundedAntiMean</code> solves the same problem for antitonic curves, by simply invoking <code>BoundedIsoMean</code>
flipping some of the arguments.
</p>


<h3>Value</h3>

<p>The bounded isotonic (antitonic) estimate <code class="reqn">(\hat g^\circ)_{i=1}^n</code>.</p>


<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered monotone regression curves.</em>
Preprint.
</p>
<p>Barlow, R. E., Bartholomew, D. J., Bremner, J. M., Brunk, H. D. (1972).
<em>Statistical inference under order restrictions. The theory and application of isotonic regression</em>.
John Wiley and Sons, London - New York - Sydney.
</p>


<h3>See Also</h3>

<p>The functions <code><a href="#topic+BoundedAntiMeanTwo">BoundedAntiMeanTwo</a></code> and <code><a href="#topic+BoundedIsoMeanTwo">BoundedIsoMeanTwo</a></code> for the problem of 
estimating <em>two</em> ordered antitonic (isotonic) regression
functions. The function <code>BoundedIsoMean</code> depends on the function <code><a href="#topic+MA">MA</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## --------------------------------------------------------
## generate data
## --------------------------------------------------------
set.seed(23041977)
n &lt;- 35
x &lt;- 1:n / n
f0 &lt;- - 3 * x + 5
g0 &lt;- 1 / (x + 0.5) ^ 2 + 1 
g &lt;- g0 + 3 * rnorm(n)

## --------------------------------------------------------
## compute estimate
## --------------------------------------------------------
g_est &lt;- BoundedAntiMean(g, w = rep(1 / n, n), a = -rep(Inf, n), b = f0)

## --------------------------------------------------------
## plot observations and estimate
## --------------------------------------------------------
par(mar = c(4.5, 4, 3, 0.5))
plot(0, 0, type = 'n', main = "Observations, upper bound and estimate 
    for bounded antitonic regression", xlim = c(0, max(x)), ylim = 
    range(c(f0, g)), xlab = expression(x), ylab = "observations and estimate")
points(x, g, col = 1)
lines(x, g0, col = 1, lwd = 2, lty = 2)
lines(x, f0, col = 2, lwd = 2, lty = 2)
lines(x, g_est, col = 3, lwd = 2)
legend("bottomleft", c("truth", "data", "upper bound", "estimate"), 
    lty = c(1, 0, 1, 1), lwd = c(2, 1, 2, 2), pch = c(NA, 1, NA, NA), 
    col = c(1, 1:3), bty = 'n')
    
## Not run: 
## --------------------------------------------------------
## 'BoundedIsoMean' is a generalization of 'isoMean' in the 
## package 'logcondens'
## --------------------------------------------------------
library(logcondens)
n &lt;- 50
y &lt;- sort(runif(n, 0, 1)) ^ 2 + rnorm(n, 0, 0.2)

isoMean(y, w = rep(1 / n, n))
BoundedIsoMean(y, w = rep(1 / n, n), a = -rep(Inf, n), b = rep(Inf, n))

## End(Not run)    
</code></pre>

<hr>
<h2 id='BoundedAntiMeanTwo+2C+20BoundedIsoMeanTwo'>Compute solution to the problem of two ordered isotonic or antitonic curves</h2><span id='topic+BoundedAntiMeanTwo'></span><span id='topic+BoundedIsoMeanTwo'></span>

<h3>Description</h3>

<p>See details below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BoundedIsoMeanTwo(g1, w1, g2, w2, K1 = 1000, K2 = 400, 
    delta = 10^(-4), errorPrec = 10, output = TRUE)
BoundedAntiMeanTwo(g1, w1, g2, w2, K1 = 1000, K2 = 400, 
    delta = 10^(-4), errorPrec = 10, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_g1">g1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of upper function.</p>
</td></tr>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_w1">w1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for upper function.</p>
</td></tr>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_g2">g2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of lower function.</p>
</td></tr>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_w2">w2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for lower function.</p>
</td></tr>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_k1">K1</code></td>
<td>
<p>Upper bound on number of iterations.</p>
</td></tr>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_k2">K2</code></td>
<td>
<p>Number of iterations where step length is changed from the inverse of the norm of the subgradient to 
a <em>diminishing</em> function of the norm of the subgradient.</p>
</td></tr>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_delta">delta</code></td>
<td>
<p>Upper bound on the error, defines stopping criterion.</p>
</td></tr>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_errorprec">errorPrec</code></td>
<td>
<p>Computation of stopping criterion is expensive. Therefore, the stopping criterion is
only evaluated at every <code>errorPrec</code>-th iteration of the algorithm.</p>
</td></tr>
<tr><td><code id="BoundedAntiMeanTwo+2B2C+2B20BoundedIsoMeanTwo_+3A_output">output</code></td>
<td>
<p>Should intermediate results be output?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider the problem of estimating two isotonic (antitonic) regression curves <code class="reqn">g_1^\circ</code> and 
<code class="reqn">g_2^\circ</code> under the 
constraint that <code class="reqn">g_1^\circ \le g_2^\circ</code>. Given two sets of <code class="reqn">n</code> data points <code class="reqn">y_1, \ldots, y_n</code> 
and <code class="reqn">z_1, \ldots, z_n</code> 
that are observed at (the same) deterministic design points <code class="reqn">x_1, \ldots, x_n</code> with weights
<code class="reqn">w_{1,i}</code> and <code class="reqn">w_{2,i}</code>, respectively, the estimates are obtained by 
minimizing the Least Squares criterion 
</p>
<p style="text-align: center;"><code class="reqn">L_2(a, b) = \sum_{i=1}^n (y_i - a_i)^2 w_{1,i} + \sum_{i=1}^n (z_i - b_i)^2 w_{2,i}</code>
</p>

<p>over the class of pairs of vectors <code class="reqn">(a, b)</code> such that <code class="reqn">a</code> and <code class="reqn">b</code> are isotonic (antitonic) and 
<code class="reqn">a_i \le b_i</code> for all <code class="reqn">i = {1, \ldots, n}</code>. The estimates are computed with a projected 
subgradient algorithm where the projection is calculated using a suitable version of the pool-adjacent-violaters 
algorithm (PAVA).
</p>
<p>The algorithm is implemented for antitonic curves in the function <code>BoundedAntiMeanTwo</code>.
The function <code>BoundedIsoMeanTwo</code> solves the same problem for isotonic curves, by simply invoking 
<code>BoundedAntiMeanTwo</code> and suitably flipping some of the arguments.
</p>


<h3>Value</h3>

<table>
<tr><td><code>g1</code></td>
<td>
<p>The estimated function <code class="reqn">\hat g_1^\circ</code>.</p>
</td></tr>
<tr><td><code>g2</code></td>
<td>
<p>The estimated function <code class="reqn">\hat g_2^\circ</code>.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>Value of the least squares criterion at the minimum.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>Value of error.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>Number of iterations performed.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Step length at final iteration.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered monotone regression curves.</em>
Preprint.
</p>


<h3>See Also</h3>

<p>The functions <code><a href="#topic+BoundedAntiMean">BoundedAntiMean</a></code> and <code><a href="#topic+BoundedIsoMean">BoundedIsoMean</a></code> for the problem of 
estimating <em>one</em> antitonic (isotonic) regression
function bounded above and below by <em>fixed</em> functions. The function <code>BoundedAntiMeanTwo</code> depends 
on the functions <code><a href="#topic+BoundedAntiMean">BoundedAntiMean</a></code>, <code><a href="#topic+bstar_n">bstar_n</a></code>, 
<code><a href="#topic+LSfunctional">LSfunctional</a></code>, and <code><a href="#topic+Subgradient">Subgradient</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## ========================================================
## The first example uses simulated data
## For the analysis of the mechIng dataset see below
## ========================================================

## --------------------------------------------------------
## initialization
## --------------------------------------------------------
set.seed(23041977)
n &lt;- 100
x &lt;- 1:n
g1 &lt;- 1 / x^2 + 2
g1 &lt;- g1 + 3 * rnorm(n)
g2 &lt;- 1 / log(x+3) + 2
g2 &lt;- g2 + 4 * rnorm(n)
w1 &lt;- runif(n)
w1 &lt;- w1 / sum(w1)
w2 &lt;- runif(n)
w2 &lt;- w2 / sum(w2)

## --------------------------------------------------------
## compute estimates
## --------------------------------------------------------
shor &lt;- BoundedAntiMeanTwo(g1, w1, g2, w2, errorPrec = 20, 
    delta = 10^(-10))
    
## corresponding isotonic problem
shor2 &lt;- BoundedIsoMeanTwo(-g2, w2, -g1, w1, errorPrec = 20, 
    delta = 10^(-10))
    
## the following vectors are equal
shor$g1 - -shor2$g2    
shor$g2 - -shor2$g1
        
## --------------------------------------------------------
## for comparison, compute estimates via cyclical projection
## algorithm due to Dykstra (1983) (isotonic problem)
## --------------------------------------------------------
dykstra1 &lt;- BoundedIsoMeanTwoDykstra(-g2, w2, -g1, w1, 
    delta = 10^(-10))

## the following vectors are equal
shor2$g1 - dykstra1$g1
shor2$g2 - dykstra1$g2

## --------------------------------------------------------
## Checking of solution
## --------------------------------------------------------
# This compares the first component of shor$g1 with a^*_1:
c(shor$g1[1], astar_1(g1, w1, g2, w2))

## --------------------------------------------------------
## plot original functions and estimates
## --------------------------------------------------------
par(mfrow = c(1, 1), mar = c(4.5, 4, 3, 0.5))
plot(x, g1, col = 2, main = "Original observations and estimates in problem 
two ordered antitonic regression functions", xlim = c(0, max(x)), ylim = 
range(c(shor$g1, shor$g2, g1, g2)), xlab = expression(x), 
ylab = "measurements and estimates")
points(x, g2, col = 3)
lines(x, shor$g1 + 0.01, col = 2, type = 's', lwd = 2)
lines(x, shor$g2 - 0.01, col = 3, type = 's', lwd = 2)
legend("bottomleft", c(expression("upper estimated function g"[1]*"*"), 
    expression("lower estimated function g"[2]*"*")), lty = 1, col = 2:3, 
    lwd = 2, bty = "n")


## ========================================================
## Analysis of the mechIng dataset
## ========================================================

## --------------------------------------------------------
## input data
## --------------------------------------------------------
data(mechIng)
x &lt;- mechIng$x
n &lt;- length(x)
g1 &lt;- mechIng$g1
g2 &lt;- mechIng$g2
w1 &lt;- rep(1, n)
w2 &lt;- w1

## --------------------------------------------------------
## compute unordered estimates
## --------------------------------------------------------
g1_pava &lt;- BoundedIsoMean(y = g1, w = w1, a = NA, b = NA)
g2_pava &lt;- BoundedIsoMean(y = g2, w = w2, a = NA, b = NA)

## --------------------------------------------------------
## compute estimates via cyclical projection algorithm due to
## Dysktra (1983)
## --------------------------------------------------------
dykstra1 &lt;- BoundedIsoMeanTwoDykstra(g1, w1, g2, w2, 
    delta = 10^-10, output = TRUE)
    
## --------------------------------------------------------
## compute smoothed versions
## --------------------------------------------------------
g1_mon &lt;- dykstra1$g1
g2_mon &lt;- dykstra1$g2   

kernel &lt;- function(x, X, h, Y){
    tmp &lt;- dnorm((x - X) / h) 
    res &lt;- sum(Y * tmp) / sum(tmp)
    return(res)
    }
h &lt;- 0.1 * n^(-1/5)

g1_smooth &lt;- rep(NA, n)
g2_smooth &lt;- g1_smooth
for (i in 1:n){
    g1_smooth[i] &lt;- kernel(x[i], X = x, h, g1_mon)
    g2_smooth[i] &lt;- kernel(x[i], X = x, h, g2_mon)
}
            
## --------------------------------------------------------
## plot original functions and estimates
## --------------------------------------------------------
par(mfrow = c(2, 1), oma = c(0, 0, 2, 0), mar = c(4.5, 4, 2, 0.5), 
    cex.main = 0.8, las = 1) 

plot(0, 0, type = 'n', xlim = c(0, max(x)), ylim = 
    range(c(g1, g2, g1_mon, g2_mon)), xlab = "x", ylab = 
    "measurements and estimates", main = "ordered antitonic estimates")
points(x, g1, col = grey(0.3), pch = 20, cex = 0.8)
points(x, g2, col = grey(0.6), pch = 20, cex = 0.8)
lines(x, g1_mon + 0.1, col = 2, type = 's', lwd = 3)
lines(x, g2_mon - 0.1, col = 3, type = 's', lwd = 3)
legend(0.2, 10, c(expression("upper isotonic function g"[1]*"*"), 
    expression("lower isotonic function g"[2]*"*")), lty = 1, col = 2:3, 
    lwd = 3, bty = "n")

plot(0, 0, type = 'n', xlim = c(0, max(x)), ylim = 
    range(c(g1, g2, g1_mon, g2_mon)), xlab = "x", ylab = "measurements and 
    estimates", main = "smoothed ordered antitonic estimates")
points(x, g1, col = grey(0.3), pch = 20, cex = 0.8)
points(x, g2, col = grey(0.6), pch = 20, cex = 0.8)
lines(x, g1_smooth + 0.1, col = 2, type = 's', lwd = 3)
lines(x, g2_smooth - 0.1, col = 3, type = 's', lwd = 3)
legend(0.2, 10, c(expression("upper isotonic smoothed function "*tilde(g)[1]*"*"), 
    expression("lower isotonic smoothed function "*tilde(g)[2]*"*")), 
    lty = 1, col = 2:3, lwd = 3, bty = "n")

par(cex.main = 1)
title("Original observations and estimates in mechanical engineering example", 
    line = 0, outer = TRUE)
</code></pre>

<hr>
<h2 id='BoundedIsoMeanTwoDykstra'>Compute solution to the problem of two ordered isotonic or antitonic curves</h2><span id='topic+BoundedIsoMeanTwoDykstra'></span>

<h3>Description</h3>

<p>See details below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BoundedIsoMeanTwoDykstra(g1, w1, g2, w2, K1 = 1000, 
    delta = 10^(-8), output = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BoundedIsoMeanTwoDykstra_+3A_g1">g1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of upper function.</p>
</td></tr>
<tr><td><code id="BoundedIsoMeanTwoDykstra_+3A_w1">w1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for upper function.</p>
</td></tr>
<tr><td><code id="BoundedIsoMeanTwoDykstra_+3A_g2">g2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of lower function.</p>
</td></tr>
<tr><td><code id="BoundedIsoMeanTwoDykstra_+3A_w2">w2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for lower function.</p>
</td></tr>
<tr><td><code id="BoundedIsoMeanTwoDykstra_+3A_k1">K1</code></td>
<td>
<p>Upper bound on number of iterations.</p>
</td></tr>
<tr><td><code id="BoundedIsoMeanTwoDykstra_+3A_delta">delta</code></td>
<td>
<p>Upper bound on the error, defines stopping criterion.</p>
</td></tr>
<tr><td><code id="BoundedIsoMeanTwoDykstra_+3A_output">output</code></td>
<td>
<p>Should intermediate results be output?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>BoundedIsoMeanTwo</code> for a description of the problem. This function computes the estimates 
via Dykstra's (see Dykstra, 1983) cyclical projection algorithm.
</p>
<p>The algorithm is implemented for isotonic curves.
</p>


<h3>Value</h3>

<table>
<tr><td><code>g1</code></td>
<td>
<p>The estimated function <code class="reqn">\hat g_1^\circ</code>.</p>
</td></tr>
<tr><td><code>g2</code></td>
<td>
<p>The estimated function <code class="reqn">\hat g_2^\circ</code>.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>Value of the least squares criterion at the minimum.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>Value of error (norm of difference two consecutive projections).</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>Number of iterations performed.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Note that we have chosen a very simply stopping criterion here, namely the algorithm stops
if the norm of two consecutive projections is smaller than <code class="reqn">\delta</code>. If <code class="reqn">n</code> is very small, it may happen
that two consecutive projections are equal although <code class="reqn">L</code> is not yet minimal (note that this typically happens
if <code>g1</code> = <code>g2</code>). If that is the case, we suggest to set <code class="reqn">\delta &lt; 0</code> and let the algorithm run
a sufficient number of iterations (specified by <code>K1</code>) to verify that the least squares criterion value
can not be decreased anymore.</p>


<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered monotone regression curves.</em>
Preprint.
</p>
<p>Dykstra, R.L. (1983).
An Algorithm for Restricted Least Squares Regression.
<em>J. Amer. Statist. Assoc.</em>, <b>78</b>, 837&ndash;842.
</p>


<h3>See Also</h3>

<p>The functions <code><a href="#topic+BoundedAntiMean">BoundedAntiMean</a></code> and <code><a href="#topic+BoundedIsoMean">BoundedIsoMean</a></code> for the problem of 
estimating <em>one</em> antitonic (isotonic) regression
function bounded above and below by <em>fixed</em> functions. The function <code>BoundedAntiMeanTwoDykstra</code> depends 
on the functions discussed in <code><a href="#topic+minK">minK</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## examples are provided in the help file of the main function of this package:
?BoundedIsoMeanTwo
</code></pre>

<hr>
<h2 id='disp'>Function to display numbers in outputs</h2><span id='topic+disp'></span>

<h3>Description</h3>

<p>Function that facilitates output of numbers</p>

<hr>
<h2 id='LSfunctional'>Compute least squares criterion for two ordered isotonic regression functions</h2><span id='topic+LSfunctional'></span>

<h3>Description</h3>

<p>Computes the value of the least squares criterion in the problem of two ordered isotonic
regression functions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>LSfunctional(f1, g1, w1, f2, g2, w2)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LSfunctional_+3A_f1">f1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, specifies values of upper function at which criterion should be evaluated.</p>
</td></tr>
<tr><td><code id="LSfunctional_+3A_g1">g1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of upper function.</p>
</td></tr>
<tr><td><code id="LSfunctional_+3A_w1">w1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for upper function.</p>
</td></tr>
<tr><td><code id="LSfunctional_+3A_f2">f2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, specifies values of lower function at which criterion should be evaluated.</p>
</td></tr>
<tr><td><code id="LSfunctional_+3A_g2">g2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of lower function.</p>
</td></tr>
<tr><td><code id="LSfunctional_+3A_w2">w2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for lower function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simply computes for the above vectors
</p>
<p style="text-align: center;"><code class="reqn">L(f1, f2) \ = \ \sum_{i=1}^n w1_i(f1_i - g1_i)^2 + \sum_{i=1}^n w2_i(f2_i - g2_i)^2.</code>
</p>



<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered monotone regression curves.</em>
Preprint.
</p>


<h3>See Also</h3>

<p>This function is used by <code><a href="#topic+BoundedAntiMeanTwo">BoundedAntiMeanTwo</a></code>.</p>

<hr>
<h2 id='MA'>Compute bounded weighted average</h2><span id='topic+MA'></span>

<h3>Description</h3>

<p>This function computes the bounded weighted mean for any subset of indices.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MA(g, w, A = NA, a, b)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MA_+3A_g">g</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code> of measurements.</p>
</td></tr>
<tr><td><code id="MA_+3A_w">w</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code> of weights.</p>
</td></tr>
<tr><td><code id="MA_+3A_a">A</code></td>
<td>
<p>Subset of <code>1:n</code>, denoting the subsets of the above vectors to compute the average with.</p>
</td></tr>
<tr><td><code id="MA_+3A_a">a</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code> that gives lower bound.</p>
</td></tr>
<tr><td><code id="MA_+3A_b">b</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code> that gives upper bound.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the bounded average
</p>
<p style="text-align: center;"><code class="reqn">MA[A] = \max\{\min\{Av[A], \min_{x \in A} b(x)\}, \max_{x \in A} a(x)\},</code>
</p>

<p>see Balabdaoui et al. (2009) for details.
</p>


<h3>Value</h3>

<p>The bounded weighted average is returned.</p>


<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered monotone regression curves.</em>
Preprint.
</p>


<h3>See Also</h3>

<p>This function is used by <code><a href="#topic+BoundedIsoMean">BoundedIsoMean</a></code>.</p>

<hr>
<h2 id='mechIng'>Mechanical engineering dataset used to illustrate ordered isotonic regression</h2><span id='topic+mechIng'></span>

<h3>Description</h3>

<p>Dataset that contains the data analyzed in Balabdaoui et al. (2009).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mechIng)</code></pre>


<h3>Format</h3>

<p>A data frame with 1495 observations on the following 3 variables.
</p>

<dl>
<dt><code>x</code></dt><dd><p>Location of measurements.</p>
</dd>
<dt><code>g1</code></dt><dd><p>Measurements of the upper isotonic curve.</p>
</dd>
<dt><code>g2</code></dt><dd><p>Measurements of the lower isotonic curve.</p>
</dd>
</dl>



<h3>Details</h3>

<p>In Balabdaoui et al. (2009), ordered isotonic regression is illustrated using stress-strain curves from dynamical
material tests.</p>


<h3>Source</h3>

<p>The data was taken from Shim and Mohr (2009).</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered monotone regression curves.</em>
Preprint.
</p>
<p>Shim, J. and Mohr, D. (2009).
Using split Hopkinson pressure bars to perform large strain compression tests on polyurea at low, intermediate and high strain rates.
<em>International Journal of Impact Engineering</em>, <b>36(9)</b>, 1116&ndash;1127. 
</p>


<h3>See Also</h3>

<p>See the examples in <code><a href="#topic+BoundedIsoMeanTwo">BoundedIsoMeanTwo</a></code> for the analysis of this data.</p>

<hr>
<h2 id='minK'>Compute projections on restriction cones in Dykstra's algorithm.</h2><span id='topic+minK'></span><span id='topic+minK1'></span><span id='topic+minK2'></span><span id='topic+minK3'></span>

<h3>Description</h3>

<p>Internal functions for Dykstra's algorithm to compute bounded monotone regression estimates.</p>


<h3>Details</h3>

<p>These functions are not intended to be called by the user. 
</p>

<ul>
<li><p><code><a href="#topic+minK1">minK1</a></code>Compute projection of <code class="reqn">(a, b)</code> on the set <code class="reqn">\{(a, b) \ : \ a</code> is increasing.}.
</p>
</li>
<li><p><code><a href="#topic+minK2">minK2</a></code>Compute projection of <code class="reqn">(a, b)</code> on the set <code class="reqn">\{(a, b) \ : \ b</code> is increasing.}.
</p>
</li>
<li><p><code><a href="#topic+minK3">minK3</a></code>Compute projection of <code class="reqn">(a, b)</code> on the set <code class="reqn">\{(a, b) \ : \ a \le b\}</code>.
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered antitonic regression curves.</em>
Preprint.
</p>
<p>Dykstra, R.L. (1983).
An Algorithm for Restricted Least Squares Regression.
<em>J. Amer. Statist. Assoc.</em>, <b>78</b>, 837&ndash;842.
</p>


<h3>See Also</h3>

<p>This functions are used by <code><a href="#topic+BoundedIsoMeanTwoDykstra">BoundedIsoMeanTwoDykstra</a></code>.</p>

<hr>
<h2 id='Subgradient'>Computes a subgradient for the projected subgradient algorithm</h2><span id='topic+Subgradient'></span>

<h3>Description</h3>

<p>This function computes a subgradient of the function <code class="reqn">\Psi</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Subgradient(b, g1, w1, g2, w2, B, Gsi)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Subgradient_+3A_b">b</code></td>
<td>
<p>Vector in <code class="reqn">R^{n-1}</code> at which subgradient should be computed.</p>
</td></tr>
<tr><td><code id="Subgradient_+3A_g1">g1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of upper function.</p>
</td></tr>
<tr><td><code id="Subgradient_+3A_w1">w1</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for upper function.</p>
</td></tr>
<tr><td><code id="Subgradient_+3A_g2">g2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, measurements of lower function.</p>
</td></tr>
<tr><td><code id="Subgradient_+3A_w2">w2</code></td>
<td>
<p>Vector in <code class="reqn">R^n</code>, weights for lower function.</p>
</td></tr>
<tr><td><code id="Subgradient_+3A_b">B</code></td>
<td>
<p>Value of <code class="reqn">b_n^*</code>.</p>
</td></tr>
<tr><td><code id="Subgradient_+3A_gsi">Gsi</code></td>
<td>
<p>Matrix in <code class="reqn">R^{n \times n}</code> that contains the quantities <code class="reqn">G_{s, i}</code> defined
in Balabdaoui et al. (2009).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The subgradient at <code class="reqn">b</code>.</p>


<h3>Author(s)</h3>

<p>Fadoua Balabdaoui <a href="mailto:fadoua@ceremade.dauphine.fr">fadoua@ceremade.dauphine.fr</a>
<br /> <a href="http://www.ceremade.dauphine.fr/~fadoua">http://www.ceremade.dauphine.fr/~fadoua</a>
</p>
<p>Kaspar Rufibach (maintainer) <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
<br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Filippo Santambrogio <a href="mailto:filippo.santambrogio@math.u-psud.fr">filippo.santambrogio@math.u-psud.fr</a>
<br /> <a href="http://www.math.u-psud.fr/~santambr/">http://www.math.u-psud.fr/~santambr/</a>
</p>


<h3>References</h3>

<p>Balabdaoui, F., Rufibach, K., Santambrogio, F. (2009).
<em>Least squares estimation of two ordered antitonic regression curves.</em>
Preprint.
</p>


<h3>See Also</h3>

<p>This function is used by <code><a href="#topic+BoundedAntiMeanTwo">BoundedAntiMeanTwo</a></code>.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
