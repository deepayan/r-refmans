<!DOCTYPE html><html><head><title>Help for package kfino</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kfino}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#doutlier'><p>doutlier defines an outlier distribution (Surface of a</p>
trapezium) and uses input parameters given in the main function kfino_fit()</a></li>
<li><a href='#kfino'><p>kfino: Kalman Filtering</p></a></li>
<li><a href='#kfino_fit'><p>kfino_fit a function to detect outlier with a Kalman Filtering approach</p></a></li>
<li><a href='#kfino_plot'><p>kfino_plot a graphical function for the result of a kfino run</p></a></li>
<li><a href='#lambs'><p>a dataset containing the WoW weighing for 4 animals of 1296 observations,</p>
https://doi.org/10.1016/j.compag.2018.08.022</a></li>
<li><a href='#merinos1'><p>a dataset containing the WoW weighing for one animal (merinos lamb) of 397</p>
observations. https://doi.org/10.1016/j.compag.2018.08.022</a></li>
<li><a href='#merinos2'><p>a dataset containing the WoW weighing for one animal (merinos lamb) of 345</p>
observations, difficult to model. https://doi.org/10.1016/j.compag.2018.08.022</a></li>
<li><a href='#spring1'><p>a dataset containing the WoW weighing for one animal of 203 observations.</p>
https://doi.org/10.1016/j.compag.2018.08.022</a></li>
<li><a href='#utils_EM'><p>utils_EM a function to estimate the parameters 'm_0' , 'mm', 'pp' through</p>
an Expectation-Maximization (EM) method</a></li>
<li><a href='#utils_fit'><p>utils_fit a fonction running the kfino algorithm to filter data and</p>
detect outliers under the knowledge of all parameters</a></li>
<li><a href='#utils_likelihood'><p>utils_likelihood a function to calculate a likelihood on initial parameters</p>
optimized by a grid search</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Kalman Filter for Impulse Noised Outliers</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Bertrand Cloez [aut],
  Isabelle Sanchez [aut, cre],
  Benedicte Fontez [ctr]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Isabelle Sanchez &lt;isabelle.sanchez@inrae.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A method for detecting outliers with a Kalman filter on impulsed 
  noised outliers and prediction on cleaned data. 'kfino' is a robust 
  sequential algorithm allowing to filter data with a large number of outliers. 
  This algorithm is based on simple latent linear Gaussian processes as in the 
  Kalman Filter method and is devoted to detect impulse-noised outliers. These 
  are data points that differ significantly from other observations. 'ML' 
  (Maximization Likelihood) and 'EM' (Expectation-Maximization algorithm) 
  algorithms were implemented in 'kfino'. The method is described in full 
  details in the following arXiv e-Print: &lt;<a href="https://arxiv.org/abs/2208.00961">arXiv:2208.00961</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://forgemia.inra.fr/isabelle.sanchez/kfino">https://forgemia.inra.fr/isabelle.sanchez/kfino</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://forgemia.inra.fr/isabelle.sanchez/kfino/-/issues">https://forgemia.inra.fr/isabelle.sanchez/kfino/-/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, dplyr,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0), covr, foreach,
doParallel, parallel</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-07 07:10:31 UTC; sanchez</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-03 08:26:44 UTC</td>
</tr>
</table>
<hr>
<h2 id='doutlier'>doutlier defines an outlier distribution (Surface of a
trapezium) and uses input parameters given in the main function kfino_fit()</h2><span id='topic+doutlier'></span>

<h3>Description</h3>

<p>doutlier defines an outlier distribution (Surface of a
trapezium) and uses input parameters given in the main function kfino_fit()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doutlier(y, K, expertMin, expertMax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doutlier_+3A_y">y</code></td>
<td>
<p>numeric, point</p>
</td></tr>
<tr><td><code id="doutlier_+3A_k">K</code></td>
<td>
<p>numeric, constant value</p>
</td></tr>
<tr><td><code id="doutlier_+3A_expertmin">expertMin</code></td>
<td>
<p>numeric, the minimal weight expected by the user</p>
</td></tr>
<tr><td><code id="doutlier_+3A_expertmax">expertMax</code></td>
<td>
<p>numeric, the maximal weight expected by the user</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this function is used to calculate an outlier distribution
following a trapezium shape. 
<code class="reqn">y \mapsto \text{doutlier}(y,K,\text{expertMin},\text{expertMax})</code>
is the probability density function on 
<code class="reqn">[\text{expertMin},\text{expertMax}]</code> which is linear and verifies
<code class="reqn">\text{doutlier}(\text{expertMax},K,\text{expertMin},\text{expertMax}) 
 =K*\text{doutlier}(\text{expertMin},K,\text{expertMin},\text{expertMax}).</code>
In particular, when $K=1$ this corresponds to the uniform distribution.
</p>


<h3>Value</h3>

<p>a numeric value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doutlier(2,5,10,45)
</code></pre>

<hr>
<h2 id='kfino'>kfino: Kalman Filtering</h2><span id='topic+kfino'></span><span id='topic+kfino-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>A method for detecting outliers with a Kalman filter on impulsed noised outliers and prediction on cleaned data. 'kfino' is a robust sequential algorithm allowing to filter data with a large number of outliers. This algorithm is based on simple latent linear Gaussian processes as in the Kalman Filter method and is devoted to detect impulse-noised outliers. These are data points that differ significantly from other observations. 'ML' (Maximization Likelihood) and 'EM' (Expectation-Maximization algorithm) algorithms were implemented in 'kfino'. The method is described in full details in the following arXiv e-Print: <a href="https://arxiv.org/abs/2208.00961">arXiv:2208.00961</a>.
</p>


<h3>Details</h3>

<p>xxxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Isabelle Sanchez <a href="mailto:isabelle.sanchez@inrae.fr">isabelle.sanchez@inrae.fr</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Bertrand Cloez <a href="mailto:bertrand.cloez@inrae.fr">bertrand.cloez@inrae.fr</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Benedicte Fontez <a href="mailto:benedicte.fontez@supagro.fr">benedicte.fontez@supagro.fr</a> [contractor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://forgemia.inra.fr/isabelle.sanchez/kfino">https://forgemia.inra.fr/isabelle.sanchez/kfino</a>
</p>
</li>
<li><p> Report bugs at <a href="https://forgemia.inra.fr/isabelle.sanchez/kfino/-/issues">https://forgemia.inra.fr/isabelle.sanchez/kfino/-/issues</a>
</p>
</li></ul>


<hr>
<h2 id='kfino_fit'>kfino_fit a function to detect outlier with a Kalman Filtering approach</h2><span id='topic+kfino_fit'></span>

<h3>Description</h3>

<p>kfino_fit a function to detect outlier with a Kalman Filtering approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kfino_fit(
  datain,
  Tvar,
  Yvar,
  param = NULL,
  doOptim = TRUE,
  method = "ML",
  threshold = 0.5,
  kappa = 10,
  kappaOpt = 7,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kfino_fit_+3A_datain">datain</code></td>
<td>
<p>an input data.frame of one time course to study (unique IDE)</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_tvar">Tvar</code></td>
<td>
<p>char, time column name in the data.frame datain, a numeric vector
Tvar should be expressed as a proportion of day in seconds</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_yvar">Yvar</code></td>
<td>
<p>char, name of the variable to predict in the data.frame datain</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_param">param</code></td>
<td>
<p>list, a list of initialization parameters</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_dooptim">doOptim</code></td>
<td>
<p>logical, if TRUE optimization of the initial parameters,
default TRUE</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_method">method</code></td>
<td>
<p>character, the method used to optimize the initial parameters:
Expectation-Maximization algorithm '&quot;EM&quot;' (faster) or Maximization
Likelihood '&quot;ML&quot;' (more robust), default '&quot;ML&quot;'</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_threshold">threshold</code></td>
<td>
<p>numeric, threshold to qualify an observation as outlier
according to the label_pred, default 0.5</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_kappa">kappa</code></td>
<td>
<p>numeric, truncation setting for likelihood optimization over 
initial parameters, default 10</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_kappaopt">kappaOpt</code></td>
<td>
<p>numeric, truncation setting for the filtering and outlier 
detection step with optimized parameters, default 7</p>
</td></tr>
<tr><td><code id="kfino_fit_+3A_verbose">verbose</code></td>
<td>
<p>write details if TRUE (optional), default FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The initialization parameter list 'param' contains:
</p>

<dl>
<dt>mm</dt><dd><p>(optional) numeric, target weight, NULL if the user wants to 
optimize it</p>
</dd>
<dt>pp</dt><dd><p>(optional) numeric, probability to be correctly weighed, NULL if 
the user wants to optimize it</p>
</dd>
<dt>m0</dt><dd><p>(optional) numeric, initial weight, NULL if the user wants to 
optimize it</p>
</dd>
<dt>aa</dt><dd><p>numeric, rate of weight change, default 0.001 </p>
</dd>
<dt>expertMin</dt><dd><p>numeric, the minimal weight expected by the user</p>
</dd>
<dt>expertMax</dt><dd><p>numeric, the maximal weight expected by the user</p>
</dd>
<dt>sigma2_m0</dt><dd><p>numeric, variance of m0, default 1</p>
</dd>
<dt>sigma2_mm</dt><dd><p>numeric, variance of mm, related to the unit of Tvar,
default 0.05</p>
</dd>
<dt>sigma2_pp</dt><dd><p>numeric, variance of pp, related to the unit of Yvar,
default 5</p>
</dd>
<dt>K</dt><dd><p>numeric, a constant value in the outlier function (trapezium),
by default K=5</p>
</dd>
<dt>seqp</dt><dd><p>numeric vector, sequence of pp probability to be correctly 
weighted. default seq(0.5,0.7,0.1)</p>
</dd>
</dl>

<p>It should be given by the user based on their knowledge of the animal or the 
data set. All parameters are compulsory except m0, mm and pp that can be
optimized by the algorithm. In the optimization step, those three parameters
are initialized according to the input data (between the expert
range) using quantile of the Y distribution (varying between 0.2 and 0.8 for
m0 and 0.5 for mm). pp is a sequence varying between 0.5 and 0.7. A
sub-sampling is performed to speed the algorithm if the number of possible
observations studied is greater than 500. Optimization is performed using
'&quot;EM&quot;' or '&quot;ML&quot;' method.
</p>


<h3>Value</h3>

<p>a S3 list with two data frames and a list of vectors of
kfino results
</p>
<p>detectOutlier: The whole input data set with the detected outliers 
flagged and the prediction of the analyzed variable. 
the following columns are joined to the columns 
present in the input data set:
</p>

<dl>
<dt>prediction</dt><dd><p>the parameter of interest - Yvar - predicted</p>
</dd>
<dt>label_pred</dt><dd><p>the probability of the value being well predicted</p>
</dd>
<dt>lwr</dt><dd><p>lower bound of the confidence interval of the predicted value</p>
</dd>
<dt>upr</dt><dd><p>upper bound of the confidence interval of the predicted value</p>
</dd>
<dt>flag</dt><dd><p>flag of the value (OK value, KO value (outlier), OOR value
(out of range values defined by the user in 'kfino_fit' with 
'expertMin', 'expertMax' input parameters). If 
flag == OOR the 4 previous columns are set to NA.</p>
</dd>
</dl>

<p>PredictionOK: A subset of 'detectOutlier' data set with the predictions 
of the analyzed variable on possible values (OK and KO values)
</p>
<p>kfino.results: kfino results (a list of vectors containing the 
prediction of the analyzed variable, the probability to be an 
outlier, the likelihood, the confidence interval of 
the prediction and the flag of the data) on input parameters that 
were optimized if the user chose this option
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spring1)
library(dplyr)

# --- With Optimization on initial parameters - ML method
t0 &lt;- Sys.time()
param1&lt;-list(m0=NULL,
             mm=NULL,
             pp=NULL,
             aa=0.001,
             expertMin=30,
             expertMax=75,
             sigma2_m0=1,
             sigma2_mm=0.05,
             sigma2_pp=5,
             K=2,
             seqp=seq(0.5,0.7,0.1))

resu1&lt;-kfino_fit(datain=spring1,
              Tvar="dateNum",Yvar="Poids",
              doOptim=TRUE,method="ML",param=param1,
              verbose=TRUE)
Sys.time() - t0

# --- Without Optimization on initial parameters
t0 &lt;- Sys.time()
param2&lt;-list(m0=41,
             mm=45,
             pp=0.5,
             aa=0.001,
             expertMin=30,
             expertMax=75,
             sigma2_m0=1,
             sigma2_mm=0.05,
             sigma2_pp=5,
             K=2,
             seqp=seq(0.5,0.7,0.1))
resu2&lt;-kfino_fit(datain=spring1,
              Tvar="dateNum",Yvar="Poids",
              param=param2,
              doOptim=FALSE,
              verbose=FALSE)
Sys.time() - t0
</code></pre>

<hr>
<h2 id='kfino_plot'>kfino_plot a graphical function for the result of a kfino run</h2><span id='topic+kfino_plot'></span>

<h3>Description</h3>

<p>kfino_plot a graphical function for the result of a kfino run
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kfino_plot(
  resuin,
  typeG,
  Tvar,
  Yvar,
  Ident,
  title = NULL,
  labelX = NULL,
  labelY = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kfino_plot_+3A_resuin">resuin</code></td>
<td>
<p>a list resulting of the kfino algorithm</p>
</td></tr>
<tr><td><code id="kfino_plot_+3A_typeg">typeG</code></td>
<td>
<p>char, type of graphic, either detection of outliers (with
qualitative or quantitative display) or prediction. must be
&quot;quanti&quot; or &quot;quali&quot; or &quot;prediction&quot;</p>
</td></tr>
<tr><td><code id="kfino_plot_+3A_tvar">Tvar</code></td>
<td>
<p>char, time variable in the data.frame datain</p>
</td></tr>
<tr><td><code id="kfino_plot_+3A_yvar">Yvar</code></td>
<td>
<p>char, variable which was analysed in the data.frame datain</p>
</td></tr>
<tr><td><code id="kfino_plot_+3A_ident">Ident</code></td>
<td>
<p>char, column name of the individual id to be analyzed</p>
</td></tr>
<tr><td><code id="kfino_plot_+3A_title">title</code></td>
<td>
<p>char, a graph title</p>
</td></tr>
<tr><td><code id="kfino_plot_+3A_labelx">labelX</code></td>
<td>
<p>char, a label for x-axis</p>
</td></tr>
<tr><td><code id="kfino_plot_+3A_labely">labelY</code></td>
<td>
<p>char, a label for y-axis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The produced graphic can be, according to typeG:
</p>

<dl>
<dt>quali</dt><dd><p>This plot shows the detection of outliers with a qualitative 
rule: OK values (black), KO values (outliers, purple) and OOR values 
(out of range values defined by the user in 'kfino_fit', red) </p>
</dd>
<dt>quanti</dt><dd><p>This plot shows the detection of outliers with a quantitative 
display using the calculated probability of the kfino algorithm</p>
</dd>
<dt>prediction</dt><dd><p>This plot shows the prediction of the analyzed variable 
plus the OK values. Prediction corresponds to E[X_t | Y_1...t] 
for each time point t. Between 2 time points, we used a simple 
linear interpolation.</p>
</dd>
</dl>



<h3>Value</h3>

<p>a ggplot2 graphic
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spring1)
library(dplyr)

print(colnames(spring1))

# --- Without Optimisation on initial parameters
param2&lt;-list(m0=41,
             mm=45,
             pp=0.5,
             aa=0.001,
             expertMin=30,
             expertMax=75,
             sigma2_m0=1,
             sigma2_mm=0.05,
             sigma2_pp=5,
             K=2,
             seqp=seq(0.5,0.7,0.1))
resu2&lt;-kfino_fit(datain=spring1,
              Tvar="dateNum",Yvar="Poids",
              param=param2,
              doOptim=FALSE)

# flags are qualitative
kfino_plot(resuin=resu2,typeG="quali",
            Tvar="Day",Yvar="Poids",Ident="IDE",
            title="kfino spring1",
            labelX="Time (day)",labelY="Weight (kg)")

# flags are quantitative
kfino_plot(resuin=resu2,typeG="quanti",
            Tvar="Day",Yvar="Poids",Ident="IDE")

# predictions on OK values
kfino_plot(resuin=resu2,typeG="prediction",
            Tvar="Day",Yvar="Poids",Ident="IDE")
</code></pre>

<hr>
<h2 id='lambs'>a dataset containing the WoW weighing for 4 animals of 1296 observations,
https://doi.org/10.1016/j.compag.2018.08.022</h2><span id='topic+lambs'></span>

<h3>Description</h3>

<p>A dataset for kfino algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambs
</code></pre>


<h3>Format</h3>

<p>a data.frame
</p>

<dl>
<dt>Poids</dt><dd><p>weight (in kg)</p>
</dd>
<dt>Date</dt><dd><p>Date of weighing yyyy-mm-dd</p>
</dd>
<dt>IDE</dt><dd><p>id of the animal</p>
</dd>
<dt>Day</dt><dd><p>Date of weighing with day and time yyyy-mm-dd hh:mm:ss</p>
</dd>
<dt>dateNum</dt><dd><p>a rescaled date - fraction of the whole observational time 
for one individual. 
<code class="reqn">dateNum=(Heure - min(Heure))/86400 + (Date - min(Date))/86400</code></p>
</dd>
</dl>


<hr>
<h2 id='merinos1'>a dataset containing the WoW weighing for one animal (merinos lamb) of 397 
observations. https://doi.org/10.1016/j.compag.2018.08.022</h2><span id='topic+merinos1'></span>

<h3>Description</h3>

<p>A dataset for kfino algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merinos1
</code></pre>


<h3>Format</h3>

<p>a data.frame
</p>

<dl>
<dt>Poids</dt><dd><p>weight (in kg)</p>
</dd>
<dt>Date</dt><dd><p>Date of weighing yyyy-mm-dd</p>
</dd>
<dt>IDE</dt><dd><p>id of the animal</p>
</dd>
<dt>Day</dt><dd><p>Date of weighing with day and time yyyy-mm-dd hh:mm:ss</p>
</dd>
<dt>dateNum</dt><dd><p>a rescaled date - fraction of the whole observational time 
for one individual. 
<code class="reqn">dateNum=(Heure - min(Heure))/86400 + (Date - min(Date))/86400</code></p>
</dd>
</dl>


<hr>
<h2 id='merinos2'>a dataset containing the WoW weighing for one animal (merinos lamb) of 345
observations, difficult to model. https://doi.org/10.1016/j.compag.2018.08.022</h2><span id='topic+merinos2'></span>

<h3>Description</h3>

<p>A dataset for kfino algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merinos2
</code></pre>


<h3>Format</h3>

<p>a data.frame
</p>

<dl>
<dt>Poids</dt><dd><p>weight (in kg)</p>
</dd>
<dt>Date</dt><dd><p>Date of weighing yyyy-mm-dd</p>
</dd>
<dt>IDE</dt><dd><p>id of the animal</p>
</dd>
<dt>Day</dt><dd><p>Date of weighing with day and time yyyy-mm-dd hh:mm:ss</p>
</dd>
<dt>dateNum</dt><dd><p>a rescaled date - fraction of the whole observational time 
for one individual. 
<code class="reqn">dateNum=(Heure - min(Heure))/86400 + (Date - min(Date))/86400</code></p>
</dd>
</dl>


<hr>
<h2 id='spring1'>a dataset containing the WoW weighing for one animal of 203 observations.
https://doi.org/10.1016/j.compag.2018.08.022</h2><span id='topic+spring1'></span>

<h3>Description</h3>

<p>A dataset for kfino algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spring1
</code></pre>


<h3>Format</h3>

<p>a data.frame
</p>

<dl>
<dt>Poids</dt><dd><p>weight (in kg)</p>
</dd>
<dt>Date</dt><dd><p>Date of weighing yyyy-mm-dd</p>
</dd>
<dt>IDE</dt><dd><p>id of the animal</p>
</dd>
<dt>Day</dt><dd><p>Date of weighing with day and time yyyy-mm-dd hh:mm:ss</p>
</dd>
<dt>dateNum</dt><dd><p>a rescaled date - fraction of the whole observational time 
for one individual. 
<code class="reqn">dateNum=(Heure - min(Heure))/86400 + (Date - min(Date))/86400</code></p>
</dd>
</dl>


<hr>
<h2 id='utils_EM'>utils_EM a function to estimate the parameters 'm_0' , 'mm', 'pp' through 
an Expectation-Maximization (EM) method</h2><span id='topic+utils_EM'></span>

<h3>Description</h3>

<p>utils_EM a function to estimate the parameters 'm_0' , 'mm', 'pp' through 
an Expectation-Maximization (EM) method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utils_EM(param, kappaOpt, Y, Tps, N, scalingC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="utils_EM_+3A_param">param</code></td>
<td>
<p>list, see initial parameter list in <code>kfino_fit</code></p>
</td></tr>
<tr><td><code id="utils_EM_+3A_kappaopt">kappaOpt</code></td>
<td>
<p>numeric, truncation setting for initial parameters' 
optimization, default 7</p>
</td></tr>
<tr><td><code id="utils_EM_+3A_y">Y</code></td>
<td>
<p>character, name of the numeric variable to predict in the
data.frame datain</p>
</td></tr>
<tr><td><code id="utils_EM_+3A_tps">Tps</code></td>
<td>
<p>character, time column name in the data.frame datain, a 
numeric vector.
Tvar can be expressed as a proportion of day in seconds</p>
</td></tr>
<tr><td><code id="utils_EM_+3A_n">N</code></td>
<td>
<p>numeric, length of the numeric vector of Y values</p>
</td></tr>
<tr><td><code id="utils_EM_+3A_scalingc">scalingC</code></td>
<td>
<p>numeric, scaling constant. To be changed if the function is 
not able to calculate the likelihood because the number of data is large</p>
</td></tr>
</table>


<h3>Details</h3>

<p>utils_EM is a tool function used in the main <code>kfino_fit</code> 
function. It uses the same input parameter list than the main function.
</p>


<h3>Value</h3>

<p>a list:
</p>

<dl>
<dt>m0</dt><dd><p>numeric, optimized m0</p>
</dd>
<dt>mm</dt><dd><p>numeric, optimized mm</p>
</dd>
<dt>pp</dt><dd><p>numeric, optimized pp</p>
</dd>
<dt>likelihood</dt><dd><p>numeric, the calculated likelihood</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
Y&lt;-rnorm(n=10,mean=50,4)
Tps&lt;-seq(1,10)
N=10
param2&lt;-list(m0=41,
             mm=45,
             pp=0.5,
             aa=0.001,
             expertMin=30,
             expertMax=75,
             sigma2_m0=1,
             sigma2_mm=0.05,
             sigma2_pp=5,
             K=2,
             seqp=seq(0.5,0.7,0.1))
print(Y)
utils_EM(param=param2,kappaOpt=7,Y=Y,Tps=Tps,N=N,scalingC=6)
</code></pre>

<hr>
<h2 id='utils_fit'>utils_fit a fonction running the kfino algorithm to filter data and 
detect outliers under the knowledge of all parameters</h2><span id='topic+utils_fit'></span>

<h3>Description</h3>

<p>utils_fit a fonction running the kfino algorithm to filter data and 
detect outliers under the knowledge of all parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utils_fit(param, threshold, kappa = 10, Y, Tps, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="utils_fit_+3A_param">param</code></td>
<td>
<p>list, see initial parameter list in <code>kfino_fit</code></p>
</td></tr>
<tr><td><code id="utils_fit_+3A_threshold">threshold</code></td>
<td>
<p>numeric, threshold for confidence interval, default 0.5</p>
</td></tr>
<tr><td><code id="utils_fit_+3A_kappa">kappa</code></td>
<td>
<p>numeric, truncation setting for likelihood optimization, 
default 10</p>
</td></tr>
<tr><td><code id="utils_fit_+3A_y">Y</code></td>
<td>
<p>character, name of the numeric variable to predict in the
data.frame datain</p>
</td></tr>
<tr><td><code id="utils_fit_+3A_tps">Tps</code></td>
<td>
<p>character, time column name in the data.frame datain, a 
numeric vector.
Tvar can be expressed as a proportion of day in seconds</p>
</td></tr>
<tr><td><code id="utils_fit_+3A_n">N</code></td>
<td>
<p>numeric, length of the numeric vector of Y values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>utils_fit is a tool function used in the main <code>kfino_fit</code> 
function. It uses the same input parameter list than the main function.
</p>


<h3>Value</h3>

<p>a list
</p>

<dl>
<dt>prediction</dt><dd><p>vector, the prediction of weights</p>
</dd>
<dt>label</dt><dd><p>vector, probability to be an outlier</p>
</dd>
<dt>likelihood</dt><dd><p>numeric, the calculated likelihood</p>
</dd>
<dt>lwr</dt><dd><p>vector of lower bound confidence interval of the prediction </p>
</dd>
<dt>upr</dt><dd><p>vector of upper bound confidence interval of the prediction </p>
</dd>
<dt>flag</dt><dd><p>char, is an outlier or not</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
Y&lt;-rnorm(n=10,mean=50,4)
Tps&lt;-seq(1,10)
N=10
param2&lt;-list(m0=41,
             mm=45,
             pp=0.5,
             aa=0.001,
             expertMin=30,
             expertMax=75,
             sigma2_m0=1,
             sigma2_mm=0.05,
             sigma2_pp=5,
             K=2,
            seqp=seq(0.5,0.7,0.1))
print(Y)
utils_fit(param=param2,threshold=0.5,kappa=10,Y=Y,Tps=Tps,N=N)
</code></pre>

<hr>
<h2 id='utils_likelihood'>utils_likelihood a function to calculate a likelihood on initial parameters 
optimized by a grid search</h2><span id='topic+utils_likelihood'></span>

<h3>Description</h3>

<p>utils_likelihood a function to calculate a likelihood on initial parameters 
optimized by a grid search
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utils_likelihood(param, kappaOpt = 7, Y, Tps, N, scalingC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="utils_likelihood_+3A_param">param</code></td>
<td>
<p>list, see initial parameter list in <code>kfino_fit</code></p>
</td></tr>
<tr><td><code id="utils_likelihood_+3A_kappaopt">kappaOpt</code></td>
<td>
<p>numeric, truncation setting for initial parameters' 
optimization, default 7</p>
</td></tr>
<tr><td><code id="utils_likelihood_+3A_y">Y</code></td>
<td>
<p>character, name of the numeric variable to predict in the
data.frame datain</p>
</td></tr>
<tr><td><code id="utils_likelihood_+3A_tps">Tps</code></td>
<td>
<p>character, time column name in the data.frame datain, a 
numeric vector.
Tvar can be expressed as a proportion of day in seconds</p>
</td></tr>
<tr><td><code id="utils_likelihood_+3A_n">N</code></td>
<td>
<p>numeric, length of the numeric vector of Y values</p>
</td></tr>
<tr><td><code id="utils_likelihood_+3A_scalingc">scalingC</code></td>
<td>
<p>numeric, scaling constant. To be changed if the function is 
not able to calculate the likelihood because the number of data is large</p>
</td></tr>
</table>


<h3>Details</h3>

<p>utils_likelihood is a tool function used in the main 
<code>kfino_fit</code> function. It uses the same input parameter list than 
the main function.
</p>


<h3>Value</h3>

<p>a likelihood
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
Y&lt;-rnorm(n=10,mean=50,4)
Tps&lt;-seq(1,10)
N=10
param2&lt;-list(m0=41,
             mm=45,
             pp=0.5,
             aa=0.001,
             expertMin=30,
             expertMax=75,
             sigma2_m0=1,
             sigma2_mm=0.05,
             sigma2_pp=5,
             K=2,
             seqp=seq(0.5,0.7,0.1))
print(Y)
utils_likelihood(param=param2,kappaOpt=7,Y=Y,Tps=Tps,N=N,scalingC=6)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
