<!DOCTYPE html><html><head><title>Help for package gbmt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gbmt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#agrisus'><p>EU agricultural sustainability data</p></a></li>
<li><a href='#agrisus2'><p>EU agricultural sustainability data (after imputation of missing values)</p></a></li>
<li><a href='#gbmt'><p>Estimation of a group-based multivariate trajectory model</p></a></li>
<li><a href='#gbmt-package'><p>Group-Based Multivariate Trajectory Modeling</p></a></li>
<li><a href='#plot.gbmt'><p>Graphics for a group-based multivariate trajectory model</p></a></li>
<li><a href='#posterior'><p>Posterior probabilities based on a group-based multivariate trajectory model</p></a></li>
<li><a href='#predict.gbmt'><p>Prediction based on a group-based multivariate trajectory model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Group-Based Multivariate Trajectory Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Alessandro Magrini</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alessandro Magrini &lt;alessandro.magrini@unifi.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation and analysis of group-based multivariate trajectory models (Nagin, 2018 &lt;<a href="https://doi.org/10.1177%2F0962280216673085">doi:10.1177/0962280216673085</a>&gt;; Magrini, 2022 &lt;<a href="https://doi.org/10.1007%2Fs10182-022-00437-9">doi:10.1007/s10182-022-00437-9</a>&gt;). The package implements an Expectation-Maximization (EM) algorithm allowing unbalanced panel and missing values, and provides several functionalities for prediction and graphical representation.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), Matrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-05 14:09:27 UTC; Alessandro</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-05 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='agrisus'>EU agricultural sustainability data</h2><span id='topic+agrisus'></span>

<h3>Description</h3>

<p>Data on several indicators covering the economic, social and environmental dimensions of agricultural sustainability for 26 EU countries in the period 2004-2018.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(agrisus)</code></pre>


<h3>Format</h3>

<p>A data.frame with a total of 390 observations on the following 16 variables:
</p>

<dl>
<dt><code>Country</code></dt><dd><p>Country name.</p>
</dd>
<dt><code>Country_code</code></dt><dd><p>Country code.</p>
</dd>
<dt><code>Year</code></dt><dd><p>Time of measurement (year).</p>
</dd>
<dt><code>Date</code></dt><dd><p>Time of measurement (date).</p>
</dd>
<dt><code>TFP_2005</code></dt><dd><p>Total Factor Productivity (TFP) index of agriculture (2005=100). Source: CMEF.</p>
</dd>
<dt><code>NetCapital_GVA</code></dt><dd><p>Net capital stocks in agriculture (2015 US dollars) to gross value added of agriculture (2015 US dollars). Source: Faostat.</p>
</dd>
<dt><code>Manager_ratio</code></dt><dd><p>Ratio young/elderly for farm managers (number of managers with less than 35 years by 100 managers with 55 years and over). Source: CMEF.</p>
</dd>
<dt><code>FactorIncome_paid_2010</code></dt><dd><p>Real income of agricultural factors per paid annual work unit (index 2010=100). Source: Eurostat.</p>
</dd>
<dt><code>EntrIncome_unpaid_2010</code></dt><dd><p>Net entrepreneurial income of agriculture per unpaid annual work unit (index 2010=100). Source: Eurostat.</p>
</dd>
<dt><code>Income_rur</code></dt><dd><p>Median equivalised net income in rural areas (power purchasing standard). Source: Eurostat.</p>
</dd>
<dt><code>Unempl_rur</code></dt><dd><p>At-risk-of-poverty rate in rural areas (%). Source: Eurostat.</p>
</dd>
<dt><code>Poverty_rur</code></dt><dd><p>Unemployment rate in rural areas (%). Source: Eurostat.</p>
</dd>
<dt><code>RenewProd</code></dt><dd><p>Production of renewable energy from agriculture (share of total production of renewable energy, %). Source: CMEF.</p>
</dd>
<dt><code>Organic_p</code></dt><dd><p>Area under organic cultivation (share of utilized agricultural area, %). Source: Faostat.</p>
</dd>
<dt><code>GHG_UAA</code></dt><dd><p>Greenhouse gas emissions due to agriculture (million CO2 equivalent grams per hectare of utilized agricultural area). Source: Faostat.</p>
</dd>
<dt><code>GNB_UAA</code></dt><dd><p>Gross nitrogen balance (tonnes of nutrient per hectare of utilized agricultural area). Source: Eurostat.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This is the dataset employed in Magrini (2022).</p>


<h3>References</h3>

<p>European Commission (2022). Eurostat database. https://ec.europa.eu/eurostat/data/database
</p>
<p>European Commission (2020). Common Monitoring and Evaluation Framework (CMEF) for the CAP 2014-2020. https://agridata.ec.europa.eu/extensions/DataPortal/cmef_indicators.html
</p>
<p>Food and Agriculture Organization (2022). FAOSTAT statistical database. https://www.fao.org/faostat/en/#home
</p>
<p>A. Magrini (2022). Assessment of agricultural sustainability in European Union countries: A group-based multivariate trajectory approach. <em>Advances in Statistical Analysis</em>, published online: March 2022. DOI: 10.1007/s10182-022-00437-9
</p>


<h3>See Also</h3>

<p><a href="#topic+agrisus2">agrisus2</a></p>

<hr>
<h2 id='agrisus2'>EU agricultural sustainability data (after imputation of missing values)</h2><span id='topic+agrisus2'></span>

<h3>Description</h3>

<p>Data on several indicators covering the economic, social and environmental dimensions of agricultural sustainability for 26 EU countries in the period 2004-2018. Missing values have been imputed.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(agrisus2)</code></pre>


<h3>Format</h3>

<p>A data.frame with a total of 390 observations on the following 16 variables:
</p>

<dl>
<dt><code>Country</code></dt><dd><p>Country name.</p>
</dd>
<dt><code>Country_code</code></dt><dd><p>Country code.</p>
</dd>
<dt><code>Year</code></dt><dd><p>Time of measurement (year).</p>
</dd>
<dt><code>Date</code></dt><dd><p>Time of measurement (date).</p>
</dd>
<dt><code>TFP_2005</code></dt><dd><p>Total Factor Productivity (TFP) index of agriculture (2005=100). Source: CMEF.</p>
</dd>
<dt><code>NetCapital_GVA</code></dt><dd><p>Net capital stocks in agriculture (2015 US dollars) to gross value added of agriculture (2015 US dollars). Source: Faostat.</p>
</dd>
<dt><code>Manager_ratio</code></dt><dd><p>Ratio young/elderly for farm managers (number of managers with less than 35 years by 100 managers with 55 years and over). Source: CMEF.</p>
</dd>
<dt><code>FactorIncome_paid_2010</code></dt><dd><p>Real income of agricultural factors per paid annual work unit (index 2010=100). Source: Eurostat.</p>
</dd>
<dt><code>EntrIncome_unpaid_2010</code></dt><dd><p>Net entrepreneurial income of agriculture per unpaid annual work unit (index 2010=100). Source: Eurostat.</p>
</dd>
<dt><code>Income_rur</code></dt><dd><p>Median equivalised net income in rural areas (power purchasing standard). Source: Eurostat.</p>
</dd>
<dt><code>Unempl_rur</code></dt><dd><p>At-risk-of-poverty rate in rural areas (%). Source: Eurostat.</p>
</dd>
<dt><code>Poverty_rur</code></dt><dd><p>Unemployment rate in rural areas (%). Source: Eurostat.</p>
</dd>
<dt><code>RenewProd</code></dt><dd><p>Production of renewable energy from agriculture (share of total production of renewable energy, %). Source: CMEF.</p>
</dd>
<dt><code>Organic_p</code></dt><dd><p>Area under organic cultivation (share of utilized agricultural area, %). Source: Faostat.</p>
</dd>
<dt><code>GHG_UAA</code></dt><dd><p>Greenhouse gas emissions due to agriculture (million CO2 equivalent grams per hectare of utilized agricultural area). Source: Faostat.</p>
</dd>
<dt><code>GNB_UAA</code></dt><dd><p>Gross nitrogen balance (tonnes of nutrient per hectare of utilized agricultural area). Source: Eurostat.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This is the dataset employed in Magrini (2022) after imputation of missing values according to a group-based multivariate trajectory model with three groups and three polynomial degrees.</p>


<h3>References</h3>

<p>European Commission (2022). Eurostat database. https://ec.europa.eu/eurostat/data/database
</p>
<p>European Commission (2020). Common Monitoring and Evaluation Framework (CMEF) for the CAP 2014-2020. https://agridata.ec.europa.eu/extensions/DataPortal/cmef_indicators.html
</p>
<p>Food and Agriculture Organization (2022). FAOSTAT statistical database. https://www.fao.org/faostat/en/#home
</p>
<p>A. Magrini (2022). Assessment of agricultural sustainability in European Union countries: A group-based multivariate trajectory approach. <em>Advances in Statistical Analysis</em>, published online: March 2022. DOI: 10.1007/s10182-022-00437-9
</p>


<h3>See Also</h3>

<p><a href="#topic+agrisus">agrisus</a></p>

<hr>
<h2 id='gbmt'>Estimation of a group-based multivariate trajectory model</h2><span id='topic+gbmt'></span>

<h3>Description</h3>

<p>Estimation of a group-based multivariate trajectory model through the Expectation-Maximization (EM) algorithm. Missing values are allowed and the panel may be unbalanced.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbmt(x.names, unit, time, ng=1, d=2, data, scaling=2, pruning=TRUE, nstart=NULL,
  tol=1e-4, maxit=1000, quiet=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gbmt_+3A_x.names">x.names</code></td>
<td>
<p>Character vector including the names of the indicators.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_unit">unit</code></td>
<td>
<p>Character indicating the name of the variable identifying the units.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_time">time</code></td>
<td>
<p>Character indicating the name of the variable identifying the time points.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_ng">ng</code></td>
<td>
<p>Positive integer value indicating the number of groups to create. Default is 1.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_d">d</code></td>
<td>
<p>Positive integer value indicating the polynomial degree of group trajectories. Default is 2.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_data">data</code></td>
<td>
<p>Object of class <code>data.frame</code> containing the variables indicated in arguments <code>x.names</code>, <code>unit</code> and <code>time</code>. The variable indicated in argument <code>unit</code> must be of type 'character' or 'factor' and cannot contain missing values. The variable indicated in argument <code>time</code> must be of type 'numeric' or 'Date' and cannot contain missing values. Variables indicated in argument <code>x.names</code> must be of type 'numeric' and may contain missing values. Variables indicated in argument <code>x.names</code> which are completely missing or not present in <code>data</code> will be ignored. The time points may differ across units (unbalanced panel) but they must be unique within units.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_scaling">scaling</code></td>
<td>
<p>Normalisation method, that should be indicated as: 0 (no normalisation), 1 (centering), 2 (standardization), 3 (ratio to the mean) and 4 (logarithmic ratio to the mean). Default is 2 (standardization). See 'Details'.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_pruning">pruning</code></td>
<td>
<p>Logical value indicating whether non-significant polynomial terms should be dropped. Default is <code>TRUE</code>. See 'Details'.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_nstart">nstart</code></td>
<td>
<p>Positive integer value indicating the number of random restarts of the EM algorithm. If <code>NULL</code> (the default), the EM algorithm is started from the solution of a hierarchical cluster with Ward's linkage.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_tol">tol</code></td>
<td>
<p>Positive value indicating the tolerance of the EM algorithm. Default is 1e-4.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_maxit">maxit</code></td>
<td>
<p>Positive integer value indicating the maximum number of iterations of the EM algorithm. Default is 1000.</p>
</td></tr>
<tr><td><code id="gbmt_+3A_quiet">quiet</code></td>
<td>
<p>Logical value indicating whether prompt messages should be suppressed. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">Y_1,\ldots,Y_k,\ldots,Y_K</code> be the considered indicators and <code class="reqn">\mbox{y}_{i,t}=(y_{i,t,1},\ldots,y_{i,t,k},\ldots,y_{i,t,K})'</code> denote their observation on unit <code class="reqn">i</code> (<code class="reqn">i=1,\ldots,n</code>) at time <code class="reqn">t</code> (<code class="reqn">t=1,\ldots,T</code>).
Also, let <code class="reqn">\bar{y}_{i,k}</code> and <code class="reqn">s_{i,k}</code> be, respectively, sample mean and sample standard deviation of indicator <code class="reqn">Y_k</code> for unit <code class="reqn">i</code> across the whole period of observation.
Each indicator is normalized within units according to one among the following normalisation methods:
</p>
<p>0) no normalisation:
</p>
<p style="text-align: center;"><code class="reqn">y^*_{i,t,k}=y_{i,t,k}</code>
</p>

<p>1) centering:
</p>
<p style="text-align: center;"><code class="reqn">y^*_{i,t,k}=y_{i,t,k}-\bar{y}_{i,k}</code>
</p>

<p>2) standardization:
</p>
<p style="text-align: center;"><code class="reqn">y^*_{i,t,k}=\frac{y_{i,t,k}-\bar{y}_{i,k}}{s_{i,k}}</code>
</p>

<p>3) ratio to the mean:
</p>
<p style="text-align: center;"><code class="reqn">y^*_{i,t,k}=\frac{y_{i,t,k}}{\bar{y}_{i,k}}</code>
</p>

<p>4) logarithmic ratio to the mean:
</p>
<p style="text-align: center;"><code class="reqn">y^*_{i,t,k}=\log\left(\frac{y_{i,t,k}}{\bar{y}_{i,k}}\right)\approx\frac{y_{i,t,k}-\bar{y}_{i,k}}{\bar{y}_{i,k}}</code>
</p>

<p>Normalisation is required if the trajectories have different levels across units. When indicators have different scales of measurement, standardization is needed to compare the measurements of different indicators. Ratio to the mean and logaritmic ratio to the mean allow comparisons among different indicators as well, but they can be applied only in case of strictly positive measurements.
</p>
<p>Denote the hypothesized groups as <code class="reqn">j=1,\ldots,J</code> and let <code class="reqn">G_i</code> be a latent variable taking value <code class="reqn">j</code> if unit <code class="reqn">i</code> belongs to group <code class="reqn">j</code>.
A group-based multivariate trajectory model with polynomial degree <code class="reqn">d</code> is defined as:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{y}^*_{i,t}\mid G_i=j\sim\mbox{MVN}\left(\mu_j,\Sigma_j\right)\hspace{.9cm}j=1,\ldots,J</code>
</p>

<p style="text-align: center;"><code class="reqn">\mu_j=\mbox{B}_j'\left(1,t,t^2,\ldots,t^d\right)'</code>
</p>

<p>where <code class="reqn">\mbox{B}_j</code> is the <code class="reqn">(d+1)\times K</code> matrix of regression coefficients in group <code class="reqn">j</code>, and <code class="reqn">\Sigma_j</code> is the <code class="reqn">K \times K</code> covariance matrix of the indicators in group <code class="reqn">j</code>.
The likelihood of the model is:
</p>
<p style="text-align: center;"><code class="reqn">\mathcal{L}(\mbox{B}_1,\ldots,\mbox{B}_J,\Sigma_1,\ldots,\Sigma_J,\pi_1,\ldots,\pi_J)=\prod_{i=1}^n\left[\sum_{j=1}^J\pi_j \prod_{t=1}^T\phi(\mbox{y}^*_{i,t}\mid \mbox{B}_j,\Sigma_j)\right]</code>
</p>

<p>where <code class="reqn">\phi(\mbox{y}^*_{i,t}\mid \mbox{B}_j,\Sigma_j)</code> is the multivariate Normal density of <code class="reqn">\mbox{y}^*_{i,t}</code> in group <code class="reqn">j</code>, and <code class="reqn">\pi_j</code> is the prior probability of group <code class="reqn">j</code>.
The posterior probability of group <code class="reqn">j</code> for unit <code class="reqn">i</code> is computed as:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{Pr}(G_i=j\mid \mbox{y}^*_i)\equiv\pi_{i,j}=\frac{\widehat{\pi}_j \prod_{t=1}^{T}\phi(\mbox{y}^*_{i,t}\mid \widehat{\mbox{B}}_j,\widehat{\Sigma}_j)}{\sum_{j=1}^J\widehat{\pi}_j \prod_{t=1}^{T}\phi(\mbox{y}^*_{i,t}\mid \widehat{\mbox{B}}_j,\widehat{\Sigma}_j)}</code>
</p>

<p>where the hat symbol above a parameter denotes the estimated value for that parameter.
See the vignette of the package and Magrini (2022) for details on maximum likelihood estimation through the EM algorithm.
</p>
<p>S3 methods available for class <code>gbmt</code> include:
</p>

<ul>
<li><p><code>print</code>: to see the estimated regression coefficients for each group;
</p>
</li>
<li><p><code>summary</code>: to obtain the summary of the linear regressions (a list with one component for each group and each indicator);
</p>
</li>
<li><p><code>plot</code>: to display estimated and predicted trajectories. See <a href="#topic+plot.gbmt">plot.gbmt</a> for details;
</p>
</li>
<li><p><code>coef</code>: to see the estimated coefficients (a list with one component for each group);
</p>
</li>
<li><p><code>fitted</code>: to obtain the fitted values, equating to the estimated group trajectories (a list with one component for each group);
</p>
</li>
<li><p><code>residuals</code>: to obtain the residuals (a list with one component for each group);
</p>
</li>
<li><p><code>predict</code>: to perform prediction on trajectories. See <a href="#topic+predict.gbmt">predict.gbmt</a> for details.
</p>
</li>
<li><p><code>logLik</code>: to get the log likelihood;
</p>
</li>
<li><p><code>AIC</code>, <code>extractAIC</code>: to get the Akaike information criterion;
</p>
</li>
<li><p><code>BIC</code>: to get the Bayesian information criterion.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>gbmt</code>, including the following components:
</p>

<ul>
<li><p><code>call</code>: list including details on the call.
</p>
</li>
<li><p><code>prior</code>: vector including the estimated prior probabilities.
</p>
</li>
<li><p><code>beta</code>: list of matrices, one for each group, including the estimated regression coefficients.
</p>
</li>
<li><p><code>Sigma</code>: list of matrices, one for each group, including the estimated covariance matrix of the indicators.
</p>
</li>
<li><p><code>posterior</code>: matrix including posterior probabilities.
</p>
</li>
<li><p><code>Xmat</code>: the model matrix employed for each indicator in each group.
</p>
</li>
<li><p><code>fitted</code>: list of matrices, one for each group, including the estimated group trajectories.
</p>
</li>
<li><p><code>reg</code>: list of objects of class <code>lm</code>, one for each group and each indicator, including the fitted regressions.
</p>
</li>
<li><p><code>assign</code>: vector indicating the assignement of the units to the groups.
</p>
</li>
<li><p><code>assign.list</code>: list indicating the assignement of the units to the groups.
</p>
</li>
<li><p><code>logLik</code>: log-likelihood of the model.
</p>
</li>
<li><p><code>npar</code>: total number of free parameters in the model.
</p>
</li>
<li><p><code>ic</code>: information criteria for the model (see Magrini, 2022 for details.
</p>
</li>
<li><p><code>appa</code>: average posterior probability of assignments (APPA) for the model.
</p>
</li>
<li><p><code>data.orig</code>: data provided to argument <code>data</code>.
</p>
</li>
<li><p><code>data.scaled</code>: data after normalization.
</p>
</li>
<li><p><code>data.imputed</code>: data after imputation of missing values, equal to <code>data.orig</code> if there are no missing data.
</p>
</li>
<li><p><code>em</code>: matrix with one row for each run of the EM algorithm, including log-likelihood, number of iterations and convergence status (1=yes, 0=no).


</p>
</li></ul>



<h3>References</h3>

<p>A. Magrini (2022). Assessment of agricultural sustainability in European Union countries: A group-based multivariate trajectory approach. <em>Advances in Statistical Analysis</em>, published online: March 2022. DOI: 10.1007/s10182-022-00437-9
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.gbmt">plot.gbmt</a>; <a href="#topic+predict.gbmt">predict.gbmt</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(agrisus2)

# names of indicators (just a subset for illustration)
varNames &lt;- c("TFP_2005", "NetCapital_GVA",
  "Income_rur", "Unempl_rur", "GHG_UAA", "GNB_N_UAA")

# model with 2 degrees and 3 groups using the imputed dataset
# - log ratio to the mean is used as normalisation (scaling=4), thus values
#   represent relative changes with respect to country averages (see Magrini, 2022)
# - by default, standardization (scaling=2) is used.
m3_2 &lt;- gbmt(x.names=varNames, unit="Country", time="Year", d=2, ng=3, data=agrisus2, scaling=4)

## NOT RUN: same model with multiple random restarts
#m3_2r &lt;- gbmt(x.names=varNames, unit="Country", time="Year", d=2, ng=3, data=agrisus2,
#  scaling=4, nstart=10)

# resulting groups
m3_2$assign.list

# estimated group trajectories
m3_2$fitted

# summary of regressions by group
summary(m3_2)

# fit a model with 4 groups
m4_2 &lt;- gbmt(x.names=varNames, unit="Country", time="Year", d=2, ng=4, data=agrisus2,
  scaling=4)
rbind(m3_2$ic, m4_2$ic)  ## comparison
</code></pre>

<hr>
<h2 id='gbmt-package'>Group-Based Multivariate Trajectory Modeling</h2><span id='topic+gbmt-package'></span>

<h3>Description</h3>

<p>Estimation and analysis of group-based multivariate trajectory models.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> gbmt</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 0.1.3</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2022-03-05</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL-2
  </td>
</tr>

</table>

<p>Group-based trajectory modeling is a statistical method to determine groups of units based on the trend of a multivariate time series.
It is a special case of latent class growth curves where the units in the same group have the same trajectory (Nagin, 2005), but it assumes a multivariate polynomial regression on time within each group, instead of a univariate one, to account for multiple indicators (Nagin et al., 2018; Magrini, 2022).
A group-based multivariate trajectory model is estimated through the Expectation-Maximization (EM) algorithm, which allows unbalanced panel and missing values.
The main functions currently implemented in the package are:
</p>

<ul>
<li><p><a href="#topic+gbmt">gbmt</a>: to estimate a group-based multivariate trajectory model;
</p>
</li>
<li><p><a href="#topic+predict.gbmt">predict.gbmt</a>: to perform prediction on trajectories;
</p>
</li>
<li><p><a href="#topic+plot.gbmt">plot.gbmt</a>: to display estimated and predicted trajectories;
</p>
</li>
<li><p><a href="#topic+posterior">posterior</a>: to compute posterior probabilities for new units.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Alessandro Magrini &lt;alessandro.magrini@unifi.it&gt;</p>


<h3>References</h3>

<p>A. Magrini (2022). Assessment of agricultural sustainability in European Union countries: A group-based multivariate trajectory approach. <em>Advances in Statistical Analysis</em>, published online: March 2022. DOI: 10.1007/s10182-022-00437-9
</p>
<p>D. S. Nagin, B. L. Jones, V. L. Passos and R. E. Tremblay (2018). Group-based multi-trajectory modeling. <em>Statistical Methods in Medical Research</em>, 27(7): 2015-2023. DOI: 10.1177/0962280216673085
</p>
<p>D. S. Nagin (2005). Group-based modeling of development. Harvard University Press, Cambridge, US-MA.
</p>

<hr>
<h2 id='plot.gbmt'>Graphics for a group-based multivariate trajectory model</h2><span id='topic+plot.gbmt'></span>

<h3>Description</h3>

<p>Visualization of estimated and predicted trajectories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gbmt'
plot(x, group=NULL, unit=NULL, x.names=NULL, n.ahead=0, bands=TRUE, conf=0.95,
  observed=TRUE, equal.scale=FALSE, trim=0, ylim=NULL, xlab="", ylab="", titles=NULL,
  add.grid=TRUE, col=NULL, transparency=-1, add.legend=TRUE, pos.legend=c(0,0),
  cex.legend=0.6, mar=c(5.1,4.1,4.1,2.1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gbmt_+3A_x">x</code></td>
<td>
<p>Object of class <code>gbmt</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_group">group</code></td>
<td>
<p>Numerical value indicating the group for which the estimated trajectories should be displayed. If <code>NULL</code> (the default), the estimated trajectories for each group will be overlapped. Ignored if <code>unit</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_unit">unit</code></td>
<td>
<p>Character indicating the name of the unit for which estimated trajectories should be displayed. If <code>NULL</code> (the default), estimated group trajectories are displayed.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_x.names">x.names</code></td>
<td>
<p>Character including the names of the indicators for which the estimated trajectory should be displayed. If <code>NULL</code> (the default), estimated trajectories of all indicators are displayed.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_n.ahead">n.ahead</code></td>
<td>
<p>Non-negative integer value indicating the number of steps ahead to perform prediction. Default is 0, meaning no prediction.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_bands">bands</code></td>
<td>
<p>Logical value indicating whether the prediction bands for should be drawn. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_conf">conf</code></td>
<td>
<p>Numerical value indicating the confidence level for the prediction bands. Default is 0.05. Ignored if <code>bands</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_observed">observed</code></td>
<td>
<p>Logical indicating whether observed trajectories should be drawn. Default is <code>TRUE</code>. Ignored if both <code>group</code> and <code>unit</code> are <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_equal.scale">equal.scale</code></td>
<td>
<p>Logical indicating whether indicators should have the same scale across all groups. Default is <code>FALSE</code>. Ignored if <code>ylim</code> is not <code>NULL</code> or if <code>unit</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_trim">trim</code></td>
<td>
<p>Numerical value indicating the proportion of extreme values to trim when either <code>equal.scale</code> is <code>TRUE</code>. Ignored if <code>observed</code> is <code>FALSE</code> or both <code>group</code> and <code>unit</code> are <code>NULL</code>. Default is 0, meaning no trim.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_ylim">ylim</code></td>
<td>
<p>vector of length 2 indicating the limits of the y-axis, which will be applied to all indicators. If <code>NULL</code> (the default), it will be determined independently for each indicator based on data, unless <code>equal.scale</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_xlab">xlab</code></td>
<td>
<p>label for the x-axis, which will be applied to all indicators. Default is empty string.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_ylab">ylab</code></td>
<td>
<p>label for the y-axis, which will be applied to all indicators. Default is empty strings.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_titles">titles</code></td>
<td>
<p>vector of titles for the indicators. If <code>NULL</code>, the name of the indicators is used as title.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_add.grid">add.grid</code></td>
<td>
<p>Logical value indicating whether the grid should be added. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_col">col</code></td>
<td>
<p>Character or numerical vector indicating the color of group trajectories. If <code>group</code> is not <code>NULL</code>, only the first valid color is considered. If <code>group</code> is <code>NULL</code> and there are more than <code>ng</code> valid colors, only the first <code>ng</code> valid colors are considered, otherwise valid colors are recycled to achieve a total number equal to <code>ng</code>. If <code>NULL</code> (the default), colors of group trajectories will be determined automatically.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_transparency">transparency</code></td>
<td>
<p>Numerical value between 0 and 100 indicating the trasparency of prediction regions. Value 75 is suggested. If negative, only prediction bands are displayed. Default is -1. Ignored if <code>group</code> is not <code>NULL</code> or <code>bands</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_add.legend">add.legend</code></td>
<td>
<p>Logical value indicating whether the legend for groups should be added. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_pos.legend">pos.legend</code></td>
<td>
<p>Numerical vector of length 2 indicating the horizontal-vertical shift of the legend for groups with respect to the position 'topleft'. Default is <code>c(0,0)</code>. Ignored if <code>group</code> is not <code>NULL</code> or <code>add.legend</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_cex.legend">cex.legend</code></td>
<td>
<p>Expansion factor relative to the legend for groups. Default is 0.6. Ignored if <code>group</code> is not <code>NULL</code> or <code>add.legend</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_mar">mar</code></td>
<td>
<p>Numerical vector of length 4 indicating the margin size in the order: bottom, left, top, right, which will be applied to all indicators. Default is <code>c(5.1,4.1,4.1,2.1)</code>.</p>
</td></tr>
<tr><td><code id="plot.gbmt_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.</p>


<h3>Note</h3>

<p>If <code>unit</code> is not <code>NULL</code>, values are back transformed to the original scales of indicators.</p>


<h3>See Also</h3>

<p><a href="#topic+gbmt">gbmt</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(agrisus2)

# names of indicators (just a subset for illustration)
varNames &lt;- c("TFP_2005", "NetCapital_GVA",
  "Income_rur", "Unempl_rur", "GHG_UAA", "GNB_N_UAA")

# model with 2 polynomial degrees and 3 groups
m3_2 &lt;- gbmt(x.names=varNames, unit="Country", time="Year", d=2, ng=3, data=agrisus2, scaling=4)

# group trajectories including 3 steps ahead prediction
mar0 &lt;- c(3.1,2.55,3.1,1.2)
plot(m3_2, n.ahead=3, mar=mar0)  ## overlapped groups
plot(m3_2, group=1, n.ahead=3, mar=mar0)  ## group 1
plot(m3_2, group=2, n.ahead=3, mar=mar0)  ## group 2
plot(m3_2, group=3, n.ahead=3, mar=mar0)  ## group 3

# same scale to ease comparisons
plot(m3_2, n.ahead=3, mar=mar0, equal.scale=TRUE)
plot(m3_2, group=1, n.ahead=3, mar=mar0, equal.scale=TRUE, trim=0.05)
plot(m3_2, group=2, n.ahead=3, mar=mar0, equal.scale=TRUE, trim=0.05)
plot(m3_2, group=3, n.ahead=3, mar=mar0, equal.scale=TRUE, trim=0.05)

# overlapped groups with transparency
plot(m3_2, group=1, n.ahead=3, mar=mar0, equal.scale=TRUE, trim=0.05,
  transparency=80)

# trajectories including 3 steps ahead prediction for unit 'Italy'
plot(m3_2, unit="Italy", n.ahead=3, transparency=80)
</code></pre>

<hr>
<h2 id='posterior'>Posterior probabilities based on a group-based multivariate trajectory model</h2><span id='topic+posterior'></span>

<h3>Description</h3>

<p>Computation of posterior probabilities for new units.</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior(x, newdata=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_+3A_x">x</code></td>
<td>
<p>Object of class <code>gbmt</code>.</p>
</td></tr>
<tr><td><code id="posterior_+3A_newdata">newdata</code></td>
<td>
<p>Object of class <code>data.frame</code> containing the multivariate time series of the indicators for the new units. If <code>NULL</code> (the default), posterior probabilities of the sample units are returned. If <code>newdata</code> is not <code>NULL</code>, it must include the variable identifying the time points. If <code>newdata</code> does not include the variable identifying the units, it is assumed that all observations refer to the same unit.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>data.frame</code> with one entry for each unit, containing the posterior probability of each group for that unit.</p>


<h3>Note</h3>

<p>Data in <code>newdata</code> must be expressed on the original scale of the indicators. Normalisation is applied internally.</p>


<h3>See Also</h3>

<p><a href="#topic+gbmt">gbmt</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(agrisus2)

# names of indicators (just a subset for illustration)
varNames &lt;- c("TFP_2005", "NetCapital_GVA",
  "Income_rur", "Unempl_rur", "GHG_UAA", "GNB_N_UAA")

# model with 2 polynomial degrees and 3 groups
m3_2 &lt;- gbmt(x.names=varNames, unit="Country", time="Year", d=2, ng=3, data=agrisus2, scaling=4)

# pretend that 'Italy' is a new unit
posterior(m3_2, newdata=agrisus2[which(agrisus2$Country=="Italy"),])

# consider only the last 3 years
posterior(m3_2, newdata=
  agrisus2[which(agrisus2$Country=="Italy"&amp;agrisus2$Year&gt;=2016),]
  )

# provide more than one new unit
posterior(m3_2, newdata=
  agrisus2[which(agrisus2$Country%in%c("Italy","Austria","Greece")),]
  )
</code></pre>

<hr>
<h2 id='predict.gbmt'>Prediction based on a group-based multivariate trajectory model</h2><span id='topic+predict.gbmt'></span>

<h3>Description</h3>

<p>Computation of in-sample and/or out-of-sample prediction of trajectories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gbmt'
predict(object, unit=NULL, n.ahead=0, bands=TRUE, conf=0.95, in.sample=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.gbmt_+3A_object">object</code></td>
<td>
<p>Object of class <code>gbmt</code>.</p>
</td></tr>
<tr><td><code id="predict.gbmt_+3A_unit">unit</code></td>
<td>
<p>Character indicating the name of the unit for which prediction should be performed. If <code>NULL</code> (the default), group trajectories are predicted.</p>
</td></tr>
<tr><td><code id="predict.gbmt_+3A_n.ahead">n.ahead</code></td>
<td>
<p>Non-negative integer value indicating the number of steps ahead for prediction. If a numerical vector is provided, only the maximum value is considered. If 0 (the default), in-sample prediction is returned.</p>
</td></tr>
<tr><td><code id="predict.gbmt_+3A_bands">bands</code></td>
<td>
<p>Logical value indicating whether the prediction bands should be computed.</p>
</td></tr>
<tr><td><code id="predict.gbmt_+3A_conf">conf</code></td>
<td>
<p>Numerical value indicating the confidence level for the prediction bands. Default is 0.05. Ignored if <code>bands</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predict.gbmt_+3A_in.sample">in.sample</code></td>
<td>
<p>Logical value indicating whether in-sample prediction should be returned along with out-of-sample one. If <code>FALSE</code> (the default) and <code>n.ahead</code> is greater than 0, out-of-sample prediction is returned. Ignored if <code>n.ahead</code> is 0.</p>
</td></tr>
<tr><td><code id="predict.gbmt_+3A_...">...</code></td>
<td>
<p>Further arguments for the generic <code>predict</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>unit</code> is <code>NULL</code>, a list with one component for each group, including a list with one object of class <code>data.frame</code> for each indicator. Otherwise, a list with one object of class <code>data.frame</code> for each indicator. Each of these dataframes has one column containing point predictions if <code>bands</code>=<code>FALSE</code>, otherwise three columns containing point predictions and their respective predictive bands.</p>


<h3>Note</h3>

<p>If <code>unit</code> is not <code>NULL</code>, values are back transformed to the original scales of indicators.</p>


<h3>See Also</h3>

<p><a href="#topic+gbmt">gbmt</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(agrisus2)

# names of indicators (just a subset for illustration)
varNames &lt;- c("TFP_2005", "NetCapital_GVA",
  "Income_rur", "Unempl_rur", "GHG_UAA", "GNB_N_UAA")

# model with 2 polynomial degrees and 3 groups
m3_2 &lt;- gbmt(x.names=varNames, unit="Country", time="Year", d=2, ng=3, data=agrisus2, scaling=4)

# 3 steps ahead prediction of group trajectories
predict(m3_2, n.ahead=3)
predict(m3_2, n.ahead=3, in.sample=TRUE)  ## include in-sample prediction

# 3 steps ahead prediction for unit 'Italy'
predict(m3_2, unit="Italy", n.ahead=3)
predict(m3_2, unit="Italy", n.ahead=3, in.sample=TRUE)  ## include in-sample prediction
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
