<!DOCTYPE html><html lang="en-US"><head><title>Help for package pkgcache</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pkgcache}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pkgcache-package'><p>Cache for package data and metadata</p></a></li>
<li><a href='#bioc_version'><p>Query Bioconductor version information</p></a></li>
<li><a href='#call_with_callback'><p>Call <code>func</code> and then call <code>callback</code> with the result</p></a></li>
<li><a href='#cmc__async_ensure_cache'><p>Load the cache, asynchronously, with as little work as possible</p></a></li>
<li><a href='#cmc__load_primary_pkgs'><p>Load metadata from the primary cache's PACKAGES files</p></a></li>
<li><a href='#cmc__load_primary_rds'><p>Load the metadata from the primary cache's RDS file</p></a></li>
<li><a href='#cmc__load_replica_rds'><p>Try to load the package metadata asynchronously, from the replica RDS</p></a></li>
<li><a href='#cmc__update_primary'><p>Update the primary cache from the replica cache</p></a></li>
<li><a href='#cmc__update_replica_pkgs'><p>Update the PACKAGES files in the replica cache</p></a></li>
<li><a href='#cmc__update_replica_rds'><p>Update the replica RDS from the PACKAGES files</p></a></li>
<li><a href='#cran_archive_cache'><p>Cache for CRAN archive data</p></a></li>
<li><a href='#cran_archive_list'><p>Data about older versions of CRAN packages</p></a></li>
<li><a href='#cranlike_metadata_cache'><p>Metadata cache for a CRAN-like repository</p></a></li>
<li><a href='#current_r_platform'><p>R platforms</p></a></li>
<li><a href='#def__make_error_object'><p>Create an error object for a rejected deferred computation</p></a></li>
<li><a href='#default_cran_mirror'><p>Query the default CRAN repository for this session</p></a></li>
<li><a href='#get_cranlike_metadata_cache'><p>The R6 object that implements the global metadata cache</p></a></li>
<li><a href='#get_graphics_api_version'><p>Query the version of the graphics API</p></a></li>
<li><a href='#get_internals_id'><p>Query UUID identifying the version of the R API</p></a></li>
<li><a href='#meta_cache_deps'><p>Query CRAN(like) package data</p></a></li>
<li><a href='#package_cache'><p>A simple package cache</p></a></li>
<li><a href='#parse_installed'><p>List metadata of installed packages</p></a></li>
<li><a href='#parse_packages'><p>Parse a repository metadata <code style="white-space: pre;">&#8288;PACAKGES*&#8288;</code> file</p></a></li>
<li><a href='#pkg_cache_summary'><p>Functions to query and manipulate the package cache</p></a></li>
<li><a href='#ppm_has_binaries'><p>Does PPM build binary packages for the current platform?</p></a></li>
<li><a href='#ppm_platforms'><p>List all platforms supported by Posit Package Manager (PPM)</p></a></li>
<li><a href='#ppm_r_versions'><p>List all R versions supported by Posit Package Manager (PPM)</p></a></li>
<li><a href='#ppm_repo_url'><p>Returns the current Posit Package Manager (PPM) repository URL</p></a></li>
<li><a href='#ppm_snapshots'><p>List all available Posit Package Manager (PPM) snapshots</p></a></li>
<li><a href='#repo_get'><p>Query and set the list of CRAN-like repositories</p></a></li>
<li><a href='#repo_status'><p>Show the status of CRAN-like repositories</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Cache 'CRAN'-Like Metadata and R Packages</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Metadata and package cache for CRAN-like repositories.  This
    is a utility package to be used by package management tools that want
    to take advantage of caching.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-lib.github.io/pkgcache/">https://r-lib.github.io/pkgcache/</a>,
<a href="https://github.com/r-lib/pkgcache">https://github.com/r-lib/pkgcache</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-lib/pkgcache/issues">https://github.com/r-lib/pkgcache/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>callr (&ge; 2.0.4.9000), cli (&ge; 3.2.0), curl (&ge; 3.2),
filelock, jsonlite, processx (&ge; 3.3.0.9001), R6, tools, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, debugme, desc, fs, mockery, pillar, pingr, rprojroot,
sessioninfo, spelling, testthat (&ge; 3.2.0), webfakes (&ge;
1.1.5), withr, zip</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-12 08:44:31 UTC; gaborcsardi</td>
</tr>
<tr>
<td>Author:</td>
<td>Gábor Csárdi [aut, cre],
  Posit Software, PBC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gábor Csárdi &lt;csardi.gabor@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-12 17:40:23 UTC</td>
</tr>
</table>
<hr>
<h2 id='pkgcache-package'>Cache for package data and metadata</h2><span id='topic+pkgcache'></span><span id='topic+pkgcache-package'></span>

<h3>Description</h3>

<p>Metadata and package cache for CRAN-like repositories. This is a utility package to be used by package management tools that want to take advantage of caching.
</p>


<h3>Details</h3>

<p>Metadata and package cache for CRAN-like repositories. This is a utility
package to be used by package management tools that want to take
advantage of caching.
</p>


<h4>Installation</h4>

<p>You can install the released version of pkgcache from
<a href="https://CRAN.R-project.org">CRAN</a> with:
</p>
<div class="sourceCode r"><pre>install.packages("pkgcache")
</pre></div>
<p>If you need the development version, you can install it from
<a href="https://github.com">GitHub</a> with:
</p>
<div class="sourceCode r"><pre>pak::pak("r-lib/pkgcache")
</pre></div>



<h4>Metadata cache</h4>

<p><code>meta_cache_list()</code> lists all packages in the metadata cache. It
includes Bioconductor package, and all versions (i.e. both binary and
source) of the packages for the current platform and R version.
</p>
<p>(We load the pillar package, because it makes the pkgcache data frames
print nicer, similarly to tibbles.)
</p>
<div class="sourceCode r"><pre>library(pkgcache)
library(pillar)
meta_cache_list()
#&gt; # A data frame: 48,094 x 32
#&gt;    package     version depends suggests license imports linkingto archs enhances
#&gt;    &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   
#&gt;  1 A3          1.0.0   R (&gt;= ~ randomF~ GPL (&gt;~ &lt;NA&gt;    &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  2 AATtools    0.0.2   R (&gt;= ~ &lt;NA&gt;     GPL-3   magrit~ &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  3 ABACUS      1.0.0   R (&gt;= ~ rmarkdo~ GPL-3   ggplot~ &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  4 ABC.RAP     0.9.0   R (&gt;= ~ knitr, ~ GPL-3   graphi~ &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  5 ABCanalysis 1.2.1   R (&gt;= ~ &lt;NA&gt;     GPL-3   plotrix &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  6 ABCoptim    0.15.0  &lt;NA&gt;    testtha~ MIT + ~ Rcpp, ~ Rcpp      ABCo~ &lt;NA&gt;    
#&gt;  7 ABCp2       1.2     MASS    &lt;NA&gt;     GPL-2   &lt;NA&gt;    &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  8 ABHgenotyp~ 1.0.1   &lt;NA&gt;    knitr, ~ GPL-3   ggplot~ &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  9 ABM         0.4.1   &lt;NA&gt;    &lt;NA&gt;     GPL (&gt;~ R6, Rc~ Rcpp      ABM.~ &lt;NA&gt;    
#&gt; 10 ABPS        0.3     &lt;NA&gt;    testthat GPL (&gt;~ kernlab &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt; # i 48,084 more rows
#&gt; # i 23 more variables: license_restricts_use &lt;chr&gt;, priority &lt;chr&gt;,
#&gt; #   license_is_foss &lt;chr&gt;, os_type &lt;chr&gt;, repodir &lt;chr&gt;, rversion &lt;chr&gt;,
#&gt; #   platform &lt;chr&gt;, needscompilation &lt;chr&gt;, ref &lt;chr&gt;, type &lt;chr&gt;,
#&gt; #   direct &lt;lgl&gt;, status &lt;chr&gt;, target &lt;chr&gt;, mirror &lt;chr&gt;, sources &lt;list&gt;,
#&gt; #   filesize &lt;int&gt;, sha256 &lt;chr&gt;, sysreqs &lt;chr&gt;, built &lt;chr&gt;, published &lt;dttm&gt;,
#&gt; #   deps &lt;list&gt;, md5sum &lt;chr&gt;, path &lt;chr&gt;
</pre></div>
<p><code>meta_cache_deps()</code> and <code>meta_cache_revdeps()</code> can be used to look up
dependencies and reverse dependencies.
</p>
<p>The metadata is updated automatically if it is older than seven days,
and it can also be updated manually with <code>meta_cache_update()</code>.
</p>
<p>See the <code>cranlike_metadata_cache</code> R6 class for a lower level API, and
more control.
</p>



<h4>Package cache</h4>

<p>Package management tools may use the <code style="white-space: pre;">&#8288;pkg_cache_*&#8288;</code> functions and in
particular the <code>package_cache</code> class, to make use of local caching of
package files.
</p>
<p>The <code style="white-space: pre;">&#8288;pkg_cache_*&#8288;</code> API is high level, and uses a user level cache:
</p>
<div class="sourceCode r"><pre>pkg_cache_summary()
#&gt; $cachepath
#&gt; [1] "/Users/gaborcsardi/Library/Caches/org.R-project.R/R/pkgcache/pkg"
#&gt; 
#&gt; $files
#&gt; [1] 40
#&gt; 
#&gt; $size
#&gt; [1] 61300737
</pre></div>
<div class="sourceCode r"><pre>pkg_cache_list()
#&gt; # A data frame: 40 x 11
#&gt;    fullpath    path  package url   etag  sha256 version platform built vignettes
#&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt;     &lt;int&gt;
#&gt;  1 /Users/gab~ arch~ &lt;NA&gt;    http~ "\"1~ 9da51~ &lt;NA&gt;    &lt;NA&gt;        NA        NA
#&gt;  2 /Users/gab~ bin/~ cli     http~ "\"1~ b24b4~ 3.6.2   x86_64-~    NA        NA
#&gt;  3 /Users/gab~ bin/~ jose    http~ "\"7~ b1bac~ 1.2.0   aarch64~    NA        NA
#&gt;  4 /Users/gab~ src/~ gh      &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;   1.4.0.~ source       1         0
#&gt;  5 /Users/gab~ src/~ gh      &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;   1.4.0.~ aarch64~     1         0
#&gt;  6 /Users/gab~ bin/~ gh      http~ "\"1~ f5daf~ 1.4.0   aarch64~    NA        NA
#&gt;  7 /Users/gab~ src/~ tic     &lt;NA&gt;   &lt;NA&gt; 11103~ &lt;NA&gt;    &lt;NA&gt;         0        NA
#&gt;  8 /Users/gab~ src/~ tic     &lt;NA&gt;   &lt;NA&gt; 11103~ 0.14.0  source       1         0
#&gt;  9 /Users/gab~ src/~ tic     &lt;NA&gt;   &lt;NA&gt; 11103~ 0.14.0  aarch64~     1         0
#&gt; 10 /Users/gab~ bin/~ rhub    http~ "\"f~ af2d6~ 1.1.2   aarch64~    NA        NA
#&gt; # i 30 more rows
#&gt; # i 1 more variable: rversion &lt;chr&gt;
</pre></div>
<div class="sourceCode r"><pre>pkg_cache_find(package = "dplyr")
#&gt; # A data frame: 0 x 11
#&gt; # i 11 variables: fullpath &lt;chr&gt;, path &lt;chr&gt;, package &lt;chr&gt;, url &lt;chr&gt;,
#&gt; #   etag &lt;chr&gt;, sha256 &lt;chr&gt;, version &lt;chr&gt;, platform &lt;chr&gt;, built &lt;int&gt;,
#&gt; #   vignettes &lt;int&gt;, rversion &lt;chr&gt;
</pre></div>
<p><code>pkg_cache_add_file()</code> can be used to add a file,
<code>pkg_cache_delete_files()</code> to remove files, <code>pkg_cache_get_files()</code> to
copy files out of the cache.
</p>
<p>The <code>package_cache</code> class provides a finer API.
</p>



<h4>Installed packages</h4>

<p>pkgcache contains a very fast DCF parser to parse <code style="white-space: pre;">&#8288;PACKAGES*&#8288;</code> files, or
the <code>DESCRIPTION</code> files in installed packages. <code>parse_packages()</code> parses
all fields from <code>PACKAGES</code>, <code>PACKAGES.gz</code> or <code>PACKAGES.rds</code> files.
<code>parse_installed()</code> reads <em>all</em> metadata from packages installed into a
library:
</p>
<div class="sourceCode r"><pre>parse_installed()
#&gt; # A data frame: 888 x 128
#&gt;    Package  Type  Title Version Date  `Authors@R` Maintainer Description Imports
#&gt;    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  
#&gt;  1 AdaptGa~ Pack~ Gaus~ 1.6     2024~ "c(person(~ Michael T~ "Multimoda~ "Rcpp,~
#&gt;  2 Annotat~ &lt;NA&gt;  Mani~ 1.64.1  &lt;NA&gt;   &lt;NA&gt;       Bioconduc~ "Implement~ "DBI, ~
#&gt;  3 Annotat~ &lt;NA&gt;  Tool~ 1.42.2  &lt;NA&gt;   &lt;NA&gt;       Bioconduc~ "Provides ~ "DBI, ~
#&gt;  4 AsioHea~ Pack~ 'Asi~ 1.22.1~ 2022~  &lt;NA&gt;       Dirk Edde~ "'Asio' is~  &lt;NA&gt;  
#&gt;  5 AutoQua~ &lt;NA&gt;  Auto~ 1.0.1   2023~ "\n    c(p~ Adrian An~ "R package~ "bit64~
#&gt;  6 BH       Pack~ Boos~ 1.81.0~ 2023~  &lt;NA&gt;       Dirk Edde~ "Boost pro~  &lt;NA&gt;  
#&gt;  7 BayesFa~ Pack~ Comp~ 0.9.12~ 2022~ "c(person(~ Richard D~ "A suite o~ "pbapp~
#&gt;  8 Biobase  &lt;NA&gt;  Biob~ 2.62.0  &lt;NA&gt;  "c(\n    p~ Bioconduc~ "Functions~ "metho~
#&gt;  9 BiocBas~ &lt;NA&gt;  Gene~ 1.4.0   &lt;NA&gt;  "c(\n  per~ Marcel Ra~ "The packa~ "metho~
#&gt; 10 BiocFil~ &lt;NA&gt;  Mana~ 2.10.1  &lt;NA&gt;  "c(person(~ Lori Shep~ "This pack~ "metho~
#&gt; # i 878 more rows
#&gt; # i 119 more variables: Suggests &lt;chr&gt;, LinkingTo &lt;chr&gt;, Depends &lt;chr&gt;,
#&gt; #   License &lt;chr&gt;, LazyLoad &lt;chr&gt;, URL &lt;chr&gt;, Encoding &lt;chr&gt;,
#&gt; #   NeedsCompilation &lt;chr&gt;, VignetteBuilder &lt;chr&gt;, BugReports &lt;chr&gt;,
#&gt; #   Packaged &lt;chr&gt;, Author &lt;chr&gt;, Repository &lt;chr&gt;, `Date/Publication` &lt;chr&gt;,
#&gt; #   Built &lt;chr&gt;, Archs &lt;chr&gt;, RemoteType &lt;chr&gt;, RemotePkgRef &lt;chr&gt;,
#&gt; #   RemoteRef &lt;chr&gt;, RemoteRepos &lt;chr&gt;, RemotePkgPlatform &lt;chr&gt;, ...
</pre></div>



<h4>Bioconductor support</h4>

<p>Both the metadata cache and the package cache support Bioconductor by
default, automatically. See the <code>BioC_mirror</code> option and the
<code>R_BIOC_MIRROR</code> and <code>R_BIOC_VERSION</code> environment variables below to
configure Bioconductor support.
</p>



<h4>Package Options</h4>


<ul>
<li><p> The <code>BioC_mirror</code> option can be used to select a Bioconductor mirror.
This takes priority over the <code>R_BIOC_MIRROR</code> environment variable.
</p>
</li>
<li><p> You can use the <code>pkg.current_platform</code> option to set the platform
string for the current platform for the <code>current_r_platform()</code>
function. This is useful if pkgcache didn’t detect the platform
correctly. Alternatively, you can use the <code>PKG_CURRENT_PLATFORM</code>
environment variable. The option takes priority.
</p>
</li>
<li> <p><code>pkgcache_timeout</code> is the HTTP timeout for all downloads. It is in
seconds, and the limit for downloading the whole file. Defaults to
3600, one hour. It corresponds to the <a href="https://curl.se/libcurl/c/CURLOPT_TIMEOUT.html"><code>TIMEOUT</code> libcurl option</a>.
</p>
</li>
<li> <p><code>pkgcache_connecttimeout</code> is the HTTP timeout for the connection
phase. It is in seconds and defaults to 30 seconds. It corresponds to
the <a href="https://curl.se/libcurl/c/CURLOPT_CONNECTTIMEOUT.html"><code>CONNECTTIMEOUT</code> libcurl option</a>.
</p>
</li>
<li> <p><code>pkgcache_low_speed_limit</code> and <code>pkgcache_low_speed_time</code> are used for
a more sensible HTTP timeout. If the download speed is less than
<code>pkgcache_low_speed_limit</code> bytes per second for at least
<code>pkgcache_low_speed_time</code> seconds, the download errors. They
correspond to the
<a href="https://curl.se/libcurl/c/CURLOPT_LOW_SPEED_LIMIT.html"><code>LOW_SPEED_LIMIT</code></a>
and
<a href="https://curl.se/libcurl/c/CURLOPT_LOW_SPEED_TIME.html"><code>LOW_SPEED_TIME</code></a>
curl options.
</p>
</li></ul>




<h4>Package environment variables</h4>


<ul>
<li><p> The <code>R_BIOC_VERSION</code> environment variable can be used to override the
default Bioconductor version detection and force a given version. E.g.
this can be used to force the development version of Bioconductor.
</p>
</li>
<li><p> The <code>R_BIOC_MIRROR</code> environment variable can be used to select a
Bioconductor mirror. The <code>BioC_mirror</code> option takes priority over
this, if set.
</p>
</li>
<li><p> You can use the <code>PKG_CURRENT_PLATFORM</code> environment variable to set the
platform string for the current platform for the
<code>current_r_platform()</code> function. This is useful if pkgcache didn’t
detect the platform correctly. Alternatively, you can use the
<code>pkg.current_platofrm</code> option, which takes. priority over the
environment variable.
</p>
</li>
<li> <p><code>PKGCACHE_PPM_REPO</code> is the name of the Posit Package Manager
repository to use. Defaults to <code>"cran"</code>.
</p>
</li>
<li> <p><code>PKGCACHE_PPM_URL</code> is the base URL of the Posit Package Manager
instance to use. It defaults to the URL of the Posit Public Package
Manager instance at <a href="https://packagemanager.posit.co/client/#/">https://packagemanager.posit.co/client/#/</a>.
</p>
</li>
<li> <p><code>PKGCACHE_TIMEOUT</code> is the HTTP timeout for all downloads. It is in
seconds, and the limit for downloading the whole file. Defaults to
3600, one hour. It corresponds to the <a href="https://curl.se/libcurl/c/CURLOPT_TIMEOUT.html"><code>TIMEOUT</code> libcurl option</a>. The
<code>pkgcache_timeout</code> option has priority over this, if set.
</p>
</li>
<li> <p><code>PKGCACHE_CONNECTTIMEOUT</code> is the HTTP timeout for the connection
phase. It is in seconds and defaults to 30 seconds. It corresponds to
the <a href="https://curl.se/libcurl/c/CURLOPT_CONNECTTIMEOUT.html"><code>CONNECTTIMEOUT</code> libcurl option</a>. The
<code>pkgcache_connecttimeout</code> option takes precedence over this, if set.
</p>
</li>
<li> <p><code>PKGCACHE_LOW_SPEED_LIMIT</code> and <code>PKGCACHE_LOW_SPEED_TIME</code> are used for
a more sensible HTTP timeout. If the download speed is less than
<code>PKGCACHE_LOW_SPEED_LIMIT</code> bytes per second for at least
<code>PKGCACHE_LOW_SPEED_TIME</code> seconds, the download errors. They
correspond to the
<a href="https://curl.se/libcurl/c/CURLOPT_LOW_SPEED_LIMIT.html"><code>LOW_SPEED_LIMIT</code></a>
and
<a href="https://curl.se/libcurl/c/CURLOPT_LOW_SPEED_TIME.html"><code>LOW_SPEED_TIME</code></a>
curl options. The <code>pkgcache_low_speed_time</code> and
<code>pkgcache_low_speed_limit</code> options have priority over these
environment variables, if they are set.
</p>
</li>
<li> <p><code>R_PKG_CACHE_DIR</code> is used for the cache directory, if set. (Otherwise
<code>tools::R_user_dir("pkgcache", "cache")</code> is used, see also
<code>meta_cache_summary()</code> and <code>pkg_cache_summary()</code>).
</p>
</li></ul>




<h4>Using pkgcache in CRAN packages</h4>

<p>If you use pkgcache in your CRAN package, please make sure that
</p>

<ul>
<li><p> you don’t use pkgcache in your examples, and
</p>
</li>
<li><p> you set the <code>R_USER_CACHE_DIR</code> environment variable to a temporary
directory (e.g. via <code>tempfile()</code>) during test cases. See the
<code>tests/testthat/setup.R</code> file in pkgcache for an example.
</p>
</li></ul>

<p>This is to make sure that pkgcache does not modify the user’s files
while running <code style="white-space: pre;">&#8288;R CMD check&#8288;</code>.
</p>



<h4>Code of Conduct</h4>

<p>Please note that the pkgcache project is released with a <a href="https://r-lib.github.io/pkgcache/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>.
By contributing to this project, you agree to abide by its terms.
</p>



<h4>License</h4>

<p>MIT (c) <a href="https://posit.co">Posit Software, PBC</a>
</p>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Gábor Csárdi <a href="mailto:csardi.gabor@gmail.com">csardi.gabor@gmail.com</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Posit Software, PBC [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://r-lib.github.io/pkgcache/">https://r-lib.github.io/pkgcache/</a>
</p>
</li>
<li> <p><a href="https://github.com/r-lib/pkgcache">https://github.com/r-lib/pkgcache</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/r-lib/pkgcache/issues">https://github.com/r-lib/pkgcache/issues</a>
</p>
</li></ul>


<hr>
<h2 id='bioc_version'>Query Bioconductor version information</h2><span id='topic+bioc_version'></span><span id='topic+bioc_version_map'></span><span id='topic+bioc_devel_version'></span><span id='topic+bioc_release_version'></span><span id='topic+bioc_repos'></span>

<h3>Description</h3>

<p>Various helper functions to deal with Bioconductor repositories.
See <a href="https://www.bioconductor.org/">https://www.bioconductor.org/</a> for more information on
Bioconductor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bioc_version(r_version = getRversion(), forget = FALSE)

bioc_version_map(forget = FALSE)

bioc_devel_version(forget = FALSE)

bioc_release_version(forget = FALSE)

bioc_repos(bioc_version = "auto", forget = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bioc_version_+3A_r_version">r_version</code></td>
<td>
<p>The R version number to match.</p>
</td></tr>
<tr><td><code id="bioc_version_+3A_forget">forget</code></td>
<td>
<p>Use <code>TRUE</code> to avoid caching the Bioconductor mapping.</p>
</td></tr>
<tr><td><code id="bioc_version_+3A_bioc_version">bioc_version</code></td>
<td>
<p>Bioconductor version string or <code>package_version</code>
object, or the string <code>"auto"</code> to use the one matching the current R
version.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bioc_version()</code> queries the matching Bioconductor version for
an R version, defaulting to the current R version
</p>
<p><code>bioc_version_map()</code> returns the current mapping between R versions
and Bioconductor versions.
</p>
<p><code>bioc_devel_version()</code> returns the version number of the current
Bioconductor devel version.
</p>
<p><code>bioc_release_version()</code> returns the version number of the current
Bioconductor release.
</p>
<p><code>bioc_repos()</code> returns the Bioconductor repository URLs.
</p>
<p>See the <code>BioC_mirror</code> option and the <code>R_BIOC_MIRROR</code> and
<code>R_BIOC_VERSION</code> environment variables in the <a href="#topic+pkgcache">pkgcache</a> manual page.
They can be used to customize the desired Bioconductor version.
</p>


<h3>Value</h3>

<p><code>bioc_version()</code> returns a <a href="base.html#topic+package_version">package_version</a> object.
</p>
<p><code>bioc_version_map()</code> returns a data frame with columns:
</p>

<ul>
<li> <p><code>bioc_version</code>: <a href="base.html#topic+package_version">package_version</a> object, Bioconductor versions.
</p>
</li>
<li> <p><code>r_version</code>: <a href="base.html#topic+package_version">package_version</a> object, the matching R versions.
</p>
</li>
<li> <p><code>bioc_status</code>: factor, with levels: <code>out-of-date</code>, <code>release</code>,
<code>devel</code>, <code>future</code>.
</p>
</li></ul>

<p><code>bioc_devel_version()</code> returns a <a href="base.html#topic+package_version">package_version</a> object.
</p>
<p><code>bioc_release_version()</code> returns a <a href="base.html#topic+package_version">package_version</a> object.
</p>
<p><code>bioc_repos()</code> returns a named character vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
bioc_version()
bioc_version("4.0")
bioc_version("4.1")


bioc_version_map()


bioc_devel_version()


bioc_release_version()


bioc_repos()

</code></pre>

<hr>
<h2 id='call_with_callback'>Call <code>func</code> and then call <code>callback</code> with the result</h2><span id='topic+call_with_callback'></span>

<h3>Description</h3>

<p><code>callback</code> will be called with two arguments, the first one will the
error object if <code>func()</code> threw an error, or <code>NULL</code> otherwise. The second
argument is <code>NULL</code> on error, and the result of <code>func()</code> otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call_with_callback(func, callback, info = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="call_with_callback_+3A_func">func</code></td>
<td>
<p>Function to call.</p>
</td></tr>
<tr><td><code id="call_with_callback_+3A_callback">callback</code></td>
<td>
<p>Callback to call with the result of <code>func()</code>,
or the error thrown.</p>
</td></tr>
<tr><td><code id="call_with_callback_+3A_info">info</code></td>
<td>
<p>Extra info to add to the error object. Must be a named list.</p>
</td></tr>
</table>

<hr>
<h2 id='cmc__async_ensure_cache'>Load the cache, asynchronously, with as little work as possible</h2><span id='topic+cmc__async_ensure_cache'></span>

<h3>Description</h3>


<ol>
<li><p> If it is already loaded, and fresh return it.
</p>
</li>
<li><p> Otherwise try the replica RDS.
</p>
</li>
<li><p> Otherwise try the primary RDS.
</p>
</li>
<li><p> Otherwise try the primary PACKAGES files.
</p>
</li>
<li><p> Otherwise update the replica PACKAGES files,
the replica RDS, and then also the primary PACKAGES and RDS.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>cmc__async_ensure_cache(self, private, max_age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmc__async_ensure_cache_+3A_self">self</code></td>
<td>
<p>self</p>
</td></tr>
<tr><td><code id="cmc__async_ensure_cache_+3A_private">private</code></td>
<td>
<p>private self</p>
</td></tr>
<tr><td><code id="cmc__async_ensure_cache_+3A_max_age">max_age</code></td>
<td>
<p>Maximum age allowed to consider the data current.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Metadata.
</p>

<hr>
<h2 id='cmc__load_primary_pkgs'>Load metadata from the primary cache's PACKAGES files</h2><span id='topic+cmc__load_primary_pkgs'></span>

<h3>Description</h3>

<p>If they are not available, or outdated, it throws an error.
Otherwise they are copied to the replica cache, and then used
to create the RDS file. The RDS file is then written back to the
primary cache and also loaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmc__load_primary_pkgs(self, private, max_age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmc__load_primary_pkgs_+3A_self">self</code></td>
<td>
<p>self</p>
</td></tr>
<tr><td><code id="cmc__load_primary_pkgs_+3A_private">private</code></td>
<td>
<p>private self</p>
</td></tr>
<tr><td><code id="cmc__load_primary_pkgs_+3A_max_age">max_age</code></td>
<td>
<p>Max age to consider the files current.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Metadata.
</p>

<hr>
<h2 id='cmc__load_primary_rds'>Load the metadata from the primary cache's RDS file</h2><span id='topic+cmc__load_primary_rds'></span>

<h3>Description</h3>

<p>If it exists and current, then the replica RDS is updated to it as well,
and the data is returned. Otherwise throws an error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmc__load_primary_rds(self, private, max_age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmc__load_primary_rds_+3A_self">self</code></td>
<td>
<p>Self.</p>
</td></tr>
<tr><td><code id="cmc__load_primary_rds_+3A_private">private</code></td>
<td>
<p>Private self.</p>
</td></tr>
<tr><td><code id="cmc__load_primary_rds_+3A_max_age">max_age</code></td>
<td>
<p>Maximum age allowed for the RDS file to be considered
as current.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Metadata.
</p>

<hr>
<h2 id='cmc__load_replica_rds'>Try to load the package metadata asynchronously, from the replica RDS</h2><span id='topic+cmc__load_replica_rds'></span>

<h3>Description</h3>

<p>If the replica has the RDS data, it is loaded and returned.
Otherwise throws an error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmc__load_replica_rds(self, private, max_age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmc__load_replica_rds_+3A_self">self</code></td>
<td>
<p>Self.</p>
</td></tr>
<tr><td><code id="cmc__load_replica_rds_+3A_private">private</code></td>
<td>
<p>Private self.</p>
</td></tr>
<tr><td><code id="cmc__load_replica_rds_+3A_max_age">max_age</code></td>
<td>
<p>Maximum age allowed for the RDS file to be considered
as current.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The metadata.
</p>

<hr>
<h2 id='cmc__update_primary'>Update the primary cache from the replica cache</h2><span id='topic+cmc__update_primary'></span>

<h3>Description</h3>

<p>Update the primary cache from the replica cache
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmc__update_primary(self, private, rds, packages, lock)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmc__update_primary_+3A_self">self</code></td>
<td>
<p>self</p>
</td></tr>
<tr><td><code id="cmc__update_primary_+3A_private">private</code></td>
<td>
<p>private self</p>
</td></tr>
<tr><td><code id="cmc__update_primary_+3A_rds">rds</code></td>
<td>
<p>Whether to update the RDS file.</p>
</td></tr>
<tr><td><code id="cmc__update_primary_+3A_packages">packages</code></td>
<td>
<p>Whether to update the PACKAGES files (+ ETag files).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing.
</p>

<hr>
<h2 id='cmc__update_replica_pkgs'>Update the PACKAGES files in the replica cache</h2><span id='topic+cmc__update_replica_pkgs'></span>

<h3>Description</h3>

<p>I.e. download them, if they have changed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmc__update_replica_pkgs(self, private)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmc__update_replica_pkgs_+3A_self">self</code></td>
<td>
<p>self</p>
</td></tr>
<tr><td><code id="cmc__update_replica_pkgs_+3A_private">private</code></td>
<td>
<p>private self</p>
</td></tr>
</table>

<hr>
<h2 id='cmc__update_replica_rds'>Update the replica RDS from the PACKAGES files</h2><span id='topic+cmc__update_replica_rds'></span>

<h3>Description</h3>

<p>Also loads it afterwards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmc__update_replica_rds(self, private, alert)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmc__update_replica_rds_+3A_self">self</code></td>
<td>
<p>self</p>
</td></tr>
<tr><td><code id="cmc__update_replica_rds_+3A_private">private</code></td>
<td>
<p>private self</p>
</td></tr>
<tr><td><code id="cmc__update_replica_rds_+3A_alert">alert</code></td>
<td>
<p>whether to show message about the update</p>
</td></tr>
</table>

<hr>
<h2 id='cran_archive_cache'>Cache for CRAN archive data</h2><span id='topic+cran_archive_cache'></span>

<h3>Description</h3>

<p>This is an R6 class that implements a cache from older CRAN package
versions. For a higher level interface see the functions documented
with <code><a href="#topic+cran_archive_list">cran_archive_list()</a></code>.
</p>


<h3>Details</h3>

<p>The cache is similar to <a href="#topic+cranlike_metadata_cache">cranlike_metadata_cache</a> and has the following
layers:
</p>

<ul>
<li><p> The data inside the <code>cran_archive_cache</code> object.
</p>
</li>
<li><p> Cached data in the current R session.
</p>
</li>
<li><p> An RDS file in the current session's temporary directory.
</p>
</li>
<li><p> An RDS file in the user's cache directory.
</p>
</li></ul>

<p>It has a synchronous and an asynchronous API.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>cac &lt;- cran_archive_cache$new(
  primary_path = NULL,
  replica_path = tempfile(),
  cran_mirror = default_cran_mirror(),
  update_after = as.difftime(7, units = "days"),
)

cac$list(packages = NULL, update_after = NULL)
cac$async_list(packages = NULL, update_after = NULL)

cac$update()
cac$async_update()

cac$check_update()
cac$async_check_update()

cac$summary()

cac$cleanup(force = FALSE)
</pre></div>


<h3>Arguments</h3>


<ul>
<li> <p><code>primary_path</code>: Path of the primary, user level cache. Defaults to
the user level cache directory of the machine.
</p>
</li>
<li> <p><code>replica_path</code>: Path of the replica. Defaults to a temporary directory
within the session temporary directory.
</p>
</li>
<li> <p><code>cran_mirror</code>: CRAN mirror to use, this takes precedence over <code>repos</code>.
</p>
</li>
<li> <p><code>update_after</code>: <code>difftime</code> object. Automatically update the cache if
it gets older than this. Set it to <code>Inf</code> to avoid updates. Defaults
to seven days.
</p>
</li>
<li> <p><code>packages</code>: Packages to query, character vector.
</p>
</li>
<li> <p><code>force</code>: Whether to force cleanup without asking the user.
</p>
</li></ul>



<h3>Details</h3>

<p>Create a new archive cache with <code>cran_archive_cache$new()</code>. Multiple
caches are independent, so e.g. if you update one of them, the other
existing caches are not affected.
</p>
<p><code>cac$list()</code> lists the versions of the specified packages, or all
packages, if none were specified. <code>cac$async_list()</code> is the same, but
asynchronous.
</p>
<p><code>cac$update()</code> updates the cache. It always downloads the new metadata.
<code>cac$async_update()</code> is the same, but asynchronous.
</p>
<p><code>cac$check_update()</code> updates the cache if there is a newer version
available. <code>cac$async_check_update()</code> is the same, but asynchronous.
</p>
<p><code>cac$summary()</code> returns a summary of the archive cache, a list with
entries:
</p>

<ul>
<li> <p><code>cachepath</code>: path to the directory of the main archive cache,
</p>
</li>
<li> <p><code>current_rds</code>: the RDS file that stores the cache. (This file might
not exist, if the cache is not downloaded yet.)
</p>
</li>
<li> <p><code>lockfile</code>: the file used for locking the cache.
</p>
</li>
<li><p> 'timestamp: time stamp for the last update of the cache.
</p>
</li>
<li> <p><code>size</code>: size of the cache file in bytes.
</p>
</li></ul>

<p><code>cac$cleanup()</code> cleans up the cache files.
</p>


<h3>Columns</h3>

<p><code>cac$list()</code> returns a data frame with columns:
</p>

<ul>
<li> <p><code>package</code>: package name,
</p>
</li>
<li> <p><code>version</code>: package version. This is a character vector, and not
a <code><a href="base.html#topic+package_version">package_version()</a></code> object. Some older package versions are not
supported by <code><a href="base.html#topic+package_version">package_version()</a></code>.
</p>
</li>
<li> <p><code>raw</code>: the raw row names from the CRAN metadata.
</p>
</li>
<li> <p><code>mtime</code>: <code>mtime</code> column from the CRAN metadata. This is usually
pretty close to the release date and time of the package.
</p>
</li>
<li> <p><code>url</code>: package download URL.
</p>
</li>
<li> <p><code>mirror</code>: CRAN mirror that was used to get this data.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
arch &lt;- cran_archive_cache$new()
arch$update()
arch$list()

</code></pre>

<hr>
<h2 id='cran_archive_list'>Data about older versions of CRAN packages</h2><span id='topic+cran_archive_list'></span><span id='topic+cran_archive_update'></span><span id='topic+cran_archive_cleanup'></span><span id='topic+cran_archive_summary'></span>

<h3>Description</h3>

<p>CRAN mirrors store older versions of packages in <code style="white-space: pre;">&#8288;/src/contrib/Archive&#8288;</code>,
and they also store some metadata about them in
<code style="white-space: pre;">&#8288;/src/contrib/Meta/archive.rds&#8288;</code>. pkgcache can download and cache this
metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cran_archive_list(
  cran_mirror = default_cran_mirror(),
  update_after = as.difftime(7, units = "days"),
  packages = NULL
)

cran_archive_update(cran_mirror = default_cran_mirror())

cran_archive_cleanup(cran_mirror = default_cran_mirror(), force = FALSE)

cran_archive_summary(cran_mirror = default_cran_mirror())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cran_archive_list_+3A_cran_mirror">cran_mirror</code></td>
<td>
<p>CRAN mirror to use, see <code><a href="#topic+default_cran_mirror">default_cran_mirror()</a></code>.</p>
</td></tr>
<tr><td><code id="cran_archive_list_+3A_update_after">update_after</code></td>
<td>
<p><code>difftime</code> object. Automatically update the cache if
it gets older than this. Set it to <code>Inf</code> to avoid updates. Defaults
to seven days.</p>
</td></tr>
<tr><td><code id="cran_archive_list_+3A_packages">packages</code></td>
<td>
<p>Character vector. Only report these packages.</p>
</td></tr>
<tr><td><code id="cran_archive_list_+3A_force">force</code></td>
<td>
<p>Force cleanup in non-interactive mode.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cran_archive_list()</code> lists all versions of all (or some) packages.
It updates the cached data first, if it is older than the specified
limit.
</p>
<p><code>cran_archive_update()</code> updates the archive cache.
</p>
<p><code>cran_archive_cleanup()</code> cleans up the archive cache for
<code>cran_mirror</code>.
</p>
<p><code>cran_archive_summary()</code> prints a summary about the archive
cache.
</p>


<h3>Value</h3>

<p><code>cran_archive_list()</code> returns a data frame with columns:
</p>

<ul>
<li> <p><code>package</code>: package name,
</p>
</li>
<li> <p><code>version</code>: package version. This is a character vector, and not
a <code><a href="base.html#topic+package_version">package_version()</a></code> object. Some older package versions are not
supported by <code><a href="base.html#topic+package_version">package_version()</a></code>.
</p>
</li>
<li> <p><code>raw</code>: the raw row names from the CRAN metadata.
</p>
</li>
<li> <p><code>mtime</code>: <code>mtime</code> column from the CRAN metadata. This is usually
pretty close to the release date and time of the package.
</p>
</li>
<li> <p><code>url</code>: package download URL.
</p>
</li>
<li> <p><code>mirror</code>: CRAN mirror that was used to get this data.
The output is ordered according to package names (case insensitive) and
release dates.
</p>
</li></ul>

<p><code>cran_archive_update()</code> returns all archive data in a data frame,
in the same format as <code>cran_archive_list()</code>, invisibly.
</p>
<p><code>cran_archive_cleanup()</code> returns nothing.
</p>
<p><code>cran_archive_summary()</code> returns a named list with elements:
</p>

<ul>
<li> <p><code>cachepath</code>: Path to the directory that contains all archive cache.
</p>
</li>
<li> <p><code>current_rds</code>: Path to the RDS file that contains the data for
the specified <code>cran_mirror</code>.
</p>
</li>
<li> <p><code>lockfile</code>: Path to the lock file for <code>current_rds</code>.
</p>
</li>
<li> <p><code>timestamp</code>: Path to the time stamp for <code>current_rds</code>. <code>NA</code> if the
cache is empty.
</p>
</li>
<li> <p><code>size</code>: Size of <code>current_rds</code>. Zero if the cache is empty.
</p>
</li></ul>



<h3>See Also</h3>

<p>The <code>cran_archive_cache</code> class for more flexibility.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cran_archive_list(packages = "readr")

</code></pre>

<hr>
<h2 id='cranlike_metadata_cache'>Metadata cache for a CRAN-like repository</h2><span id='topic+cranlike_metadata_cache'></span>

<h3>Description</h3>

<p>This is an R6 class that implements the metadata cache of a CRAN-like
repository. For a higher level interface, see the <code><a href="#topic+meta_cache_list">meta_cache_list()</a></code>,
<code><a href="#topic+meta_cache_deps">meta_cache_deps()</a></code>, <code><a href="#topic+meta_cache_revdeps">meta_cache_revdeps()</a></code> and <code><a href="#topic+meta_cache_update">meta_cache_update()</a></code>
functions.
</p>


<h3>Details</h3>

<p>The cache has several layers:
</p>

<ul>
<li><p> The data is stored inside the <code>cranlike_metadata_cache</code> object.
</p>
</li>
<li><p> It is also stored as an RDS file, in the session temporary directory.
This ensures that the same data is used for all queries of a
<code>cranlike_metadata_cache</code> object.
</p>
</li>
<li><p> It is stored in an RDS file in the user's cache directory.
</p>
</li>
<li><p> The downloaded raw <code style="white-space: pre;">&#8288;PACKAGES*&#8288;</code> files are cached, together with HTTP
ETags, to minimize downloads.
</p>
</li></ul>

<p>It has a synchronous and an asynchronous API.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>cmc &lt;- cranlike_metadata_cache$new(
  primary_path = NULL, replica_path = tempfile(),
  platforms = default_platforms(), r_version = getRversion(),
  bioc = TRUE, cran_mirror = default_cran_mirror(),
  repos = getOption("repos"),
  update_after = as.difftime(7, units = "days"))

cmc$list(packages = NULL)
cmc$async_list(packages = NULL)

cmc$deps(packages, dependencies = NA, recursive = TRUE)
cmc$async_deps(packages, dependencies = NA, recursive = TRUE)

cmc$revdeps(packages, dependencies = NA, recursive = TRUE)
cmc$async_revdeps(packages, dependencies = NA, recursive = TRUE)

cmc$update()
cmc$async_update()
cmc$check_update()
cmc$asnyc_check_update()

cmc$summary()

cmc$cleanup(force = FALSE)
</pre></div>


<h3>Arguments</h3>


<ul>
<li> <p><code>primary_path</code>: Path of the primary, user level cache. Defaults to
the user level cache directory of the machine.
</p>
</li>
<li> <p><code>replica_path</code>: Path of the replica. Defaults to a temporary directory
within the session temporary directory.
</p>
</li>
<li> <p><code>platforms</code>: see <code><a href="#topic+default_platforms">default_platforms()</a></code> for possible values.
</p>
</li>
<li> <p><code>r_version</code>: R version to create the cache for.
</p>
</li>
<li> <p><code>bioc</code>: Whether to include BioConductor packages.
</p>
</li>
<li> <p><code>cran_mirror</code>: CRAN mirror to use, this takes precedence over <code>repos</code>.
</p>
</li>
<li> <p><code>repos</code>: Repositories to use.
</p>
</li>
<li> <p><code>update_after</code>: <code>difftime</code> object. Automatically update the cache if
it gets older than this. Set it to <code>Inf</code> to avoid updates. Defaults
to seven days.
</p>
</li>
<li> <p><code>packages</code>: Packages to query, character vector.
</p>
</li>
<li> <p><code>dependencies</code>: Which kind of dependencies to include. Works the same
way as the <code>dependencies</code> argument of <code><a href="utils.html#topic+install.packages">utils::install.packages()</a></code>.
</p>
</li>
<li> <p><code>recursive</code>: Whether to include recursive dependencies.
</p>
</li>
<li> <p><code>force</code>: Whether to force cleanup without asking the user.
</p>
</li></ul>



<h3>Details</h3>

<p><code>cranlike_metadata_cache$new()</code> creates a new cache object. Creation
does not trigger the population of the cache. It is only populated on
demand, when queries are executed against it. In your package, you may
want to create a cache instance in the <code>.onLoad()</code> function of the
package, and store it in the package namespace. As this is a cheap
operation, the package will still load fast, and then the package code
can refer to the common cache object.
</p>
<p><code>cmc$list()</code> lists all (or the specified) packages in the cache.
It returns a data frame, see the list of columns below.
</p>
<p><code>cmc$async_list()</code> is similar, but it is asynchronous, it returns a
<code>deferred</code> object.
</p>
<p><code>cmc$deps()</code> returns a data frame, with the (potentially recursive)
dependencies of <code>packages</code>.
</p>
<p><code>cmc$async_deps()</code> is the same, but it is asynchronous, it
returns a <code>deferred</code> object.
</p>
<p><code>cmc$revdeps()</code> returns a data frame, with the (potentially recursive)
reverse dependencies of <code>packages</code>.
</p>
<p><code>cmc$async_revdeps()</code> does the same, asynchronously, it returns an
<code>deferred</code> object.
</p>
<p><code>cmc$update()</code> updates the the metadata (as needed) in the cache,
and then returns a data frame with all packages, invisibly.
</p>
<p><code>cmc$async_update()</code> is similar, but it is asynchronous.
</p>
<p><code>cmc$check_update()</code> checks if the metadata is current, and if it is
not, it updates it.
</p>
<p><code>cmc$async_check_update()</code> is similar, but it is asynchronous.
</p>
<p><code>cmc$summary()</code> lists metadata about the cache, including its
location and size.
</p>
<p><code>cmc$cleanup()</code> deletes the cache files from the disk, and also from
memory.
</p>


<h3>Columns</h3>

<p>The metadata data frame contains all available versions (i.e. sources and
binaries) for all packages. It usually has the following columns,
some might be missing on some platforms.
</p>

<ul>
<li> <p><code>package</code>: Package name.
</p>
</li>
<li> <p><code>title</code>: Package title.
</p>
</li>
<li> <p><code>version</code>: Package version.
</p>
</li>
<li> <p><code>depends</code>: <code>Depends</code> field from <code>DESCRIPTION</code>, or <code>NA_character_</code>.
</p>
</li>
<li> <p><code>suggests</code>: <code>Suggests</code> field from <code>DESCRIPTION</code>, or <code>NA_character_</code>.
</p>
</li>
<li> <p><code>built</code>:  <code>Built</code> field from <code>DESCIPTION</code>, if a binary package,
or <code>NA_character_</code>.
</p>
</li>
<li> <p><code>imports</code>: <code>Imports</code> field from <code>DESCRIPTION</code>, or <code>NA_character_</code>.
</p>
</li>
<li> <p><code>archs</code>: <code>Archs</code> entries from <code>PACKAGES</code> files. Might be missing.
</p>
</li>
<li> <p><code>repodir</code>: The directory of the file, inside the repository.
</p>
</li>
<li> <p><code>platform</code>: This is a character vector. See <code><a href="#topic+default_platforms">default_platforms()</a></code> for
more about platform names. In practice each value of the <code>platform</code>
column is either
</p>

<ul>
<li> <p><code>"source"</code> for source packages,
</p>
</li>
<li><p> a platform string, e.g. <code>x86_64-apple-darwin17.0</code> for macOS
packages compatible with macOS High Sierra or newer.
</p>
</li></ul>

</li>
<li> <p><code>needscompilation</code>: Whether the package needs compilation.
</p>
</li>
<li> <p><code>type</code>: <code>bioc</code> or <code>cran</code>  currently.
</p>
</li>
<li> <p><code>target</code>: The path of the package file inside the repository.
</p>
</li>
<li> <p><code>mirror</code>: URL of the CRAN/BioC mirror.
</p>
</li>
<li> <p><code>sources</code>: List column with URLs to one or more possible locations
of the package file. For source CRAN packages, it contains URLs to
the <code>Archive</code> directory as well, in case the package has been
archived since the metadata was cached.
</p>
</li>
<li> <p><code>filesize</code>: Size of the file, if known, in bytes, or <code>NA_integer_</code>.
</p>
</li>
<li> <p><code>sha256</code>: The SHA256 hash of the file, if known, or <code>NA_character_</code>.
</p>
</li>
<li> <p><code>deps</code>: All package dependencies, in a data frame.
</p>
</li>
<li> <p><code>license</code>: Package license, might be <code>NA</code> for binary packages.
</p>
</li>
<li> <p><code>linkingto</code>: <code>LinkingTo</code> field from <code>DESCRIPTION</code>, or <code>NA_character_</code>.
</p>
</li>
<li> <p><code>enhances</code>: <code>Enhances</code> field from <code>DESCRIPTION</code>, or <code>NA_character_</code>.
</p>
</li>
<li> <p><code>os_type</code>: <code>unix</code> or <code>windows</code> for OS specific packages. Usually <code>NA</code>.
</p>
</li>
<li> <p><code>priority</code>: &quot;optional&quot;, &quot;recommended&quot; or <code>NA</code>. (Base packages are
normally not included in the list, so &quot;base&quot; should not appear here.)
</p>
</li>
<li> <p><code>md5sum</code>: MD5 sum, if available, may be <code>NA</code>.
</p>
</li>
<li> <p><code>sysreqs</code>: The <code>SystemRequirements</code> field, if available. This lists the
required system libraries or other software for the package. This is
usually available for CRAN and Bioconductor package and when it is
explicitly available in the repository metadata.
</p>
</li>
<li> <p><code>published</code>: The time the package was published at, in GMT,
<code>POSIXct</code> class.
</p>
</li></ul>

<p>The data frame contains some extra columns as well, these are for internal
use only.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dir.create(cache_path &lt;- tempfile())
cmc &lt;- cranlike_metadata_cache$new(cache_path, bioc = FALSE)
cmc$list()
cmc$list("pkgconfig")
cmc$deps("pkgconfig")
cmc$revdeps("pkgconfig", recursive = FALSE)

</code></pre>

<hr>
<h2 id='current_r_platform'>R platforms</h2><span id='topic+current_r_platform'></span><span id='topic+current_r_platform_data'></span><span id='topic+default_platforms'></span>

<h3>Description</h3>

<p>R platforms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>current_r_platform()

current_r_platform_data()

default_platforms()
</code></pre>


<h3>Details</h3>

<p><code>current_r_platform()</code> detects the platform of the current R version.
<code>current_r_platform_data()</code> is similar, but returns the raw data instead
of a character scalar.
</p>
<p>By default pkgcache works with source packages and binary packages for
the current platform. You can change this, by providing different
platform names as arguments to
<code><a href="#topic+cranlike_metadata_cache">cranlike_metadata_cache$new()</a></code>,
<code><a href="#topic+repo_status">repo_status()</a></code>, etc.
</p>
<p>These functions accept the following platform names:
</p>

<ul>
<li> <p><code>"source"</code> for source packages,
</p>
</li>
<li> <p><code>"macos"</code> for macOS binaries that are appropriate for the R versions
pkgcache is working with. Packages for incompatible CPU architectures are
dropped (defaulting to the CPU of the current macOS machine and x86_64 on
non-macOS systems). The macOS Darwin version is selected based on the
CRAN macOS binaries. E.g. on R 3.5.0 macOS binaries
are built for macOS El Capitan.
</p>
</li>
<li> <p><code>"windows"</code> for Windows binaries for the default CRAN architecture.
This is currently Windows Vista for all supported R versions, but it
might change in the future. The actual binary packages in the
repository might support both 32 bit and 64 builds, or only one of
them. In practice 32-bit only packages are very rare. CRAN builds
before and including R 4.1 have both architectures, from R 4.2 they
are 64 bit only. <code>"windows"</code> is an alias to <code>i386+x86_64-w64-mingw32</code>
currently.
</p>
</li>
<li><p> A platform string like <code>R.version$platform</code>, but on Linux the name
and version of the distribution are also included. Examples:
</p>

<ul>
<li> <p><code>x86_64-apple-darwin17.0</code>: macOS High Sierra.
</p>
</li>
<li> <p><code>aarch64-apple-darwin20</code>: macOS Big Sur on arm64.
</p>
</li>
<li> <p><code>x86_64-w64-mingw32</code>: 64 bit Windows.
</p>
</li>
<li> <p><code>i386-w64-mingw32</code>: 32 bit Windows.
</p>
</li>
<li> <p><code>i386+x86_64-w64-mingw32</code>: 64 bit + 32 bit Windows.
</p>
</li>
<li> <p><code>i386-pc-solaris2.10</code>: 32 bit Solaris. (Some broken 64 Solaris
builds might have the same platform string, unfortunately.)
</p>
</li>
<li> <p><code>x86_64-pc-linux-gnu-debian-10</code>: Debian Linux 10 on x86_64.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;x86_64-pc-linux-musl-alpine-3.14.1&#8288;</code>: Alpine Linux.
</p>
</li>
<li> <p><code>x86_64-pc-linux-gnu-unknown</code>: Unknown Linux Distribution on x86_64.
</p>
</li>
<li> <p><code>s390x-ibm-linux-gnu-ubuntu-20.04</code>: Ubuntu Linux 20.04 on S390x.
</p>
</li>
<li> <p><code>amd64-portbld-freebsd12.1</code>: FreeBSD 12.1 on x86_64.
</p>
</li></ul>

</li></ul>

<p><code>default_platfoms()</code> returns the default platforms for the current R
session. These typically consist of the detected platform of the current
R session, and <code>"source"</code>, for source packages.
</p>


<h3>Value</h3>

<p><code>current_r_platform()</code> returns a character scalar.
</p>
<p><code>current_r_platform_data()</code> returns a data frame with character
scalar columns:
</p>

<ul>
<li> <p><code>cpu</code>,
</p>
</li>
<li> <p><code>vendor</code>,
</p>
</li>
<li> <p><code>os</code>,
</p>
</li>
<li> <p><code>distribution</code> (only on Linux),
</p>
</li>
<li> <p><code>release</code> (only on Linux),
</p>
</li>
<li> <p><code>platform</code>: the concatenation of the other columns, separated by
a dash.
</p>
</li></ul>

<p><code>default_platforms()</code> returns a character vector of the
default platforms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>current_r_platform()
default_platforms()
</code></pre>

<hr>
<h2 id='def__make_error_object'>Create an error object for a rejected deferred computation</h2><span id='topic+def__make_error_object'></span>

<h3>Description</h3>


<ul>
<li><p> Make sure that the error is an error object.
</p>
</li>
<li><p> Make sure that the error has the correct classes.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>def__make_error_object(self, private, err)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="def__make_error_object_+3A_self">self</code></td>
<td>
<p>self</p>
</td></tr>
<tr><td><code id="def__make_error_object_+3A_private">private</code></td>
<td>
<p>private self</p>
</td></tr>
</table>


<h3>Value</h3>

<p>error object
</p>

<hr>
<h2 id='default_cran_mirror'>Query the default CRAN repository for this session</h2><span id='topic+default_cran_mirror'></span>

<h3>Description</h3>

<p>If <code>options("repos")</code> (see <code><a href="base.html#topic+options">options()</a></code>) contains an entry called
<code>"CRAN"</code>, then that is returned. If it is a list, it is converted
to a character vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_cran_mirror()
</code></pre>


<h3>Details</h3>

<p>Otherwise the RStudio CRAN mirror is used.
</p>


<h3>Value</h3>

<p>A named character vector of length one, where the
name is <code>"CRAN"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>default_cran_mirror()
</code></pre>

<hr>
<h2 id='get_cranlike_metadata_cache'>The R6 object that implements the global metadata cache</h2><span id='topic+get_cranlike_metadata_cache'></span>

<h3>Description</h3>

<p>This is used by the <code><a href="#topic+meta_cache_deps">meta_cache_deps()</a></code>, <code><a href="#topic+meta_cache_list">meta_cache_list()</a></code>, etc.
functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cranlike_metadata_cache()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>
get_cranlike_metadata_cache()
get_cranlike_metadata_cache()$list("cli")

</code></pre>

<hr>
<h2 id='get_graphics_api_version'>Query the version of the graphics API</h2><span id='topic+get_graphics_api_version'></span>

<h3>Description</h3>

<p>A package compiled with a certain version of the graphics API
will not work with R installations that use a different version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_graphics_api_version()
</code></pre>


<h3>Value</h3>

<p>An integer scalar, the version of the graphics API of this
R version.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_graphics_api_version()
</code></pre>

<hr>
<h2 id='get_internals_id'>Query UUID identifying the version of the R API</h2><span id='topic+get_internals_id'></span>

<h3>Description</h3>

<p>Packages need to be recompiled if this id changes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_internals_id()
</code></pre>


<h3>Value</h3>

<p>String, a UUID.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_internals_id()
</code></pre>

<hr>
<h2 id='meta_cache_deps'>Query CRAN(like) package data</h2><span id='topic+meta_cache_deps'></span><span id='topic+meta_cache_revdeps'></span><span id='topic+meta_cache_update'></span><span id='topic+meta_cache_list'></span><span id='topic+meta_cache_cleanup'></span><span id='topic+meta_cache_summary'></span>

<h3>Description</h3>

<p>It uses CRAN and BioConductor packages, for the current platform and
R version, from the default repositories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta_cache_deps(packages, dependencies = NA, recursive = TRUE)

meta_cache_revdeps(packages, dependencies = NA, recursive = TRUE)

meta_cache_update()

meta_cache_list(packages = NULL)

meta_cache_cleanup(force = FALSE)

meta_cache_summary()
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meta_cache_deps_+3A_packages">packages</code></td>
<td>
<p>Packages to query.</p>
</td></tr>
<tr><td><code id="meta_cache_deps_+3A_dependencies">dependencies</code></td>
<td>
<p>Dependency types to query. See the <code>dependencies</code>
parameter of <code><a href="utils.html#topic+install.packages">utils::install.packages()</a></code>.</p>
</td></tr>
<tr><td><code id="meta_cache_deps_+3A_recursive">recursive</code></td>
<td>
<p>Whether to query recursive dependencies.</p>
</td></tr>
<tr><td><code id="meta_cache_deps_+3A_force">force</code></td>
<td>
<p>Whether to force cleanup without asking the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>meta_cache_list()</code> lists all packages.
</p>
<p><code>meta_cache_update()</code> updates all metadata. Note that metadata is
automatically updated if it is older than seven days.
</p>
<p><code>meta_cache_deps()</code> queries packages dependencies.
</p>
<p><code>meta_cache_revdeps()</code> queries reverse package dependencies.
</p>
<p><code>meta_cache_summary()</code> lists data about the cache, including its location
and size.
</p>
<p><code>meta_cache_cleanup()</code> deletes the cache files from the disk.
</p>


<h3>Value</h3>

<p>A data frame of the dependencies. For
<code>meta_cache_deps()</code> and <code>meta_cache_revdeps()</code> it includes the
queried <code>packages</code> as well.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
meta_cache_list("pkgdown")
meta_cache_deps("pkgdown", recursive = FALSE)
meta_cache_revdeps("pkgdown", recursive = FALSE)

</code></pre>

<hr>
<h2 id='package_cache'>A simple package cache</h2><span id='topic+package_cache'></span>

<h3>Description</h3>

<p>This is an R6 class that implements a concurrency safe package cache.
</p>


<h3>Details</h3>

<p>By default these fields are included for every package:
</p>

<ul>
<li> <p><code>fullpath</code> Full package path.
</p>
</li>
<li> <p><code>path</code> Package path, within the repository.
</p>
</li>
<li> <p><code>package</code> Package name.
</p>
</li>
<li> <p><code>url</code> URL it was downloaded from.
</p>
</li>
<li> <p><code>etag</code> ETag for the last download, from the given URL.
</p>
</li>
<li> <p><code>sha256</code> SHA256 hash of the file.
</p>
</li></ul>

<p>Additional fields can be added as needed.
</p>
<p>For a simple API to a session-wide instance of this class, see
<code><a href="#topic+pkg_cache_summary">pkg_cache_summary()</a></code> and the other functions listed there.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>pc &lt;- package_cache$new(path = NULL)

pc$list()
pc$find(..., .list = NULL)
pc$copy_to(..., .list = NULL)
pc$add(file, path, sha256 = shasum256(file), ..., .list = NULL)
pc$add_url(url, path, ..., .list = NULL, on_progress = NULL,
  http_headers = NULL)
pc$async_add_url(url, path, ..., .list = NULL, on_progress = NULL,
  http_headers = NULL)
pc$copy_or_add(target, urls, path, sha256 = NULL, ..., .list = NULL,
               on_progress = NULL, http_headers = NULL)
pc$async_copy_or_add(target, urls, path, ..., sha256 = NULL, ...,
               .list = NULL, on_progress = NULL, http_headers = NULL)
pc$update_or_add(target, urls, path, ..., .list = NULL,
               on_progress = NULL, http_headers = NULL)
pc$async_update_or_add(target, urls, path, ..., .list = NULL,
               on_progress = NULL, http_headers = NULL)
pc$delete(..., .list = NULL)
</pre></div>


<h3>Arguments</h3>


<ul>
<li> <p><code>path</code>: For <code>package_cache$new()</code> the location of the cache. For other
functions the location of the file inside the cache.
</p>
</li>
<li> <p><code>...</code>: Extra attributes to search for. They have to be named.
</p>
</li>
<li> <p><code>.list</code>: Extra attributes to search for, they have to in a named list.
</p>
</li>
<li> <p><code>file</code>:  Path to the file to add.
</p>
</li>
<li> <p><code>url</code>: URL attribute. This is used to update the file, if requested.
</p>
</li>
<li> <p><code>sha256</code>: SHA256 hash of the file.
</p>
</li>
<li> <p><code>on_progress</code>: Callback to create progress bar. Passed to internal
function <code>http_get()</code>.
</p>
</li>
<li> <p><code>target</code>: Path to copy the (first) to hit to.
</p>
</li>
<li> <p><code>urls</code>: Character vector or URLs to try to download the file from.
</p>
</li>
<li> <p><code>http_headers</code>: HTTP headers to add to all HTTP queries.
</p>
</li></ul>



<h3>Details</h3>

<p><code>package_cache$new()</code> attaches to the cache at <code>path</code>. (By default
a platform dependent user level cache directory.) If the cache does
not exists, it creates it.
</p>
<p><code>pc$list()</code> lists all files in the cache, returns a data frame with all the
default columns, and potentially extra columns as well.
</p>
<p><code>pc$find()</code> list all files that match the specified criteria (<code>fullpath</code>,
<code>path</code>, <code>package</code>, etc.). Custom columns can be searched for as well.
</p>
<p><code>pc$copy_to()</code> will copy the first matching file from the cache to
<code>target</code>. It returns the data frame of <em>all</em> matching records, invisibly.
If no file matches, it returns an empty (zero-row) data frame.
</p>
<p><code>pc$add()</code> adds a file to the cache.
</p>
<p><code>pc$add_url()</code> downloads a file and adds it to the cache.
</p>
<p><code>pc$async_add_url()</code> is the same, but it is asynchronous.
</p>
<p><code>pc$copy_or_add()</code> works like <code>pc$copy_to()</code>, but if the file is not in
the cache, it tries to download it from one of the specified URLs first.
</p>
<p><code>pc$async_copy_or_add()</code> is the same, but asynchronous.
</p>
<p><code>pc$update_or_add()</code> is like <code>pc$copy_to_add()</code>, but if the file is in
the cache it tries to update it from the urls, using the stored ETag to
avoid unnecessary downloads.
</p>
<p><code>pc$async_update_or_add()</code> is the same, but it is asynchronous.
</p>
<p><code>pc$delete()</code> deletes the file(s) from the cache.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Although package_cache usually stores packages, it may store
## arbitrary files, that can be search by metadata
pc &lt;- package_cache$new(path = tempfile())
pc$list()

cat("foo\n", file = f1 &lt;- tempfile())
cat("bar\n", file = f2 &lt;- tempfile())
pc$add(f1, "/f1")
pc$add(f2, "/f2")
pc$list()
pc$find(path = "/f1")
pc$copy_to(target = f3 &lt;- tempfile(), path = "/f1")
readLines(f3)
</code></pre>

<hr>
<h2 id='parse_installed'>List metadata of installed packages</h2><span id='topic+parse_installed'></span>

<h3>Description</h3>

<p>This function is similar to <code><a href="utils.html#topic+installed.packages">utils::installed.packages()</a></code>.
See the differences below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_installed(
  library = .libPaths(),
  priority = NULL,
  lowercase = FALSE,
  reencode = TRUE,
  packages = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parse_installed_+3A_library">library</code></td>
<td>
<p>Character vector of library paths.</p>
</td></tr>
<tr><td><code id="parse_installed_+3A_priority">priority</code></td>
<td>
<p>If not <code>NULL</code> then it may be a <code>"base"</code> <code>"recommended"</code>
<code>NA</code> or a vector of these to select <em>base</em> packages, <em>recommended</em>
packages or <em>other</em> packages. (These are the official, CRAN supported
package priorities, but you may introduce others in non-CRAN packages.)</p>
</td></tr>
<tr><td><code id="parse_installed_+3A_lowercase">lowercase</code></td>
<td>
<p>Whether to convert keys in <code>DESCRIPTION</code> to lowercase.</p>
</td></tr>
<tr><td><code id="parse_installed_+3A_reencode">reencode</code></td>
<td>
<p>Whether to re-encode strings in UTF-8, from the
encodings specified in the <code>DESCRIPTION</code> files. Re-encoding is
somewhat costly, and sometimes it is not important (e.g. when you only
want to extract the dependencies of the installed packages).</p>
</td></tr>
<tr><td><code id="parse_installed_+3A_packages">packages</code></td>
<td>
<p>If not <code>NULL</code>, then it must be a character vector,
and only these packages will be listed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Differences with <code><a href="utils.html#topic+installed.packages">utils::installed.packages()</a></code>:
</p>

<ul>
<li> <p><code>parse_installed()</code> cannot subset the extracted fields. (But you can
subset the result.)
</p>
</li>
<li> <p><code>parse_installed()</code> does not cache the results.
</p>
</li>
<li> <p><code>parse_installed()</code> handles errors better. See Section 'Errors' below.
#' * <code>parse_installed()</code> uses the <code>DESCRIPTION</code> files in the installed packages
instead of the <code>Meta/package.rds</code> files. This should not matter,
but because of a bug <code>Meta/package.rds</code> might contain the wrong
<code>Archs</code> field on multi-arch platforms.
</p>
</li>
<li> <p><code>parse_installed()</code> reads <em>all</em> fields from the <code>DESCRIPTION</code> files.
<code><a href="utils.html#topic+installed.packages">utils::installed.packages()</a></code> only reads the specified fields.
</p>
</li>
<li> <p><code>parse_installed()</code> converts its output to UTF-8 encoding, from the
encodings declared in the <code>DESCRIPTION</code> files.
</p>
</li>
<li> <p><code>parse_installed()</code> is considerably faster.
</p>
</li></ul>



<h4>Encodings</h4>

<p><code>parse_installed()</code> always returns its result in UTF-8 encoding.
It uses the <code>Encoding</code> fields in the <code>DESCRIPTION</code> files to learn their
encodings. <code>parse_installed()</code> does not check that an UTF-8 file has a
valid encoding. If it fails to convert a string to UTF-8 from another
declared encoding, then it leaves it as <code>"bytes"</code> encoded, without a
warning.
</p>



<h4>Errors</h4>

<p>pkgcache silently ignores files and directories inside the library
directory.
</p>
<p>The result also omits broken package installations. These include
</p>

<ul>
<li><p> packages with invalid <code>DESCRIPTION</code> files, and
</p>
</li>
<li><p> packages the current user have no access to.
</p>
</li></ul>

<p>These errors are reported via a condition with class
<code>pkgcache_broken_install</code>. The condition has an <code>errors</code> entry, which
is a data frame with columns
</p>

<ul>
<li> <p><code>file</code>: path to the <code>DESCRIPTION</code> file of the broken package,
</p>
</li>
<li> <p><code>error</code>: error message for this particular failure.
</p>
</li></ul>

<p>If you intend to handle broken package installation, you need to catch
this condition with <code>withCallingHandlers()</code>.
</p>


<hr>
<h2 id='parse_packages'>Parse a repository metadata <code style="white-space: pre;">&#8288;PACAKGES*&#8288;</code> file</h2><span id='topic+parse_packages'></span>

<h3>Description</h3>

<p>Parse a repository metadata <code style="white-space: pre;">&#8288;PACAKGES*&#8288;</code> file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_packages(path, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parse_packages_+3A_path">path</code></td>
<td>
<p>Path to the <code style="white-space: pre;">&#8288;PACKAGES*&#8288;</code> file.</p>
</td></tr>
<tr><td><code id="parse_packages_+3A_type">type</code></td>
<td>
<p>Type of the file. By default it is determined automatically.
Types:
</p>

<ul>
<li> <p><code>uncompressed</code>,
</p>
</li>
<li> <p><code>gzip</code> compressed,
</p>
</li>
<li> <p><code>bzip2</code> compressed,
</p>
</li>
<li> <p><code>xz</code> compressed.
</p>
</li>
<li> <p><code>rds</code>, an RDS file, which will be read using <code><a href="base.html#topic+readRDS">base::readRDS()</a></code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>Non-existent, unreadable or corrupt <code>PACKAGES</code> files with trigger an
error.
</p>
<p><code style="white-space: pre;">&#8288;PACKAGES*&#8288;</code> files do not usually declare an encoding, but nevertheless
<code>parse_packages()</code> works correctly if they do.
</p>


<h3>Value</h3>

<p>A data frame, with all columns from the file at <code>path</code>.
</p>


<h3>Note</h3>

<p><code>parse_packages()</code> cannot currently read files that have very many
different fields (many columns in the result data frame). The current
limit is 1000. Typical <code>PACKAGES</code> files contain less than 20 field
types.
</p>

<hr>
<h2 id='pkg_cache_summary'>Functions to query and manipulate the package cache</h2><span id='topic+pkg_cache_summary'></span><span id='topic+pkg_cache_list'></span><span id='topic+pkg_cache_find'></span><span id='topic+pkg_cache_get_file'></span><span id='topic+pkg_cache_delete_files'></span><span id='topic+pkg_cache_add_file'></span>

<h3>Description</h3>

<p><code>pkg_cache_summary()</code> returns a short summary of the state of the cache,
e.g. the number of files and their total size. It returns a named list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkg_cache_summary(cachepath = NULL)

pkg_cache_list(cachepath = NULL)

pkg_cache_find(cachepath = NULL, ...)

pkg_cache_get_file(cachepath = NULL, target, ...)

pkg_cache_delete_files(cachepath = NULL, ...)

pkg_cache_add_file(cachepath = NULL, file, relpath = dirname(file), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pkg_cache_summary_+3A_cachepath">cachepath</code></td>
<td>
<p>Path of the cache. By default the cache directory is in
<code>pkgcache</code>, within the user's cache directory.
See <code>tools::R_user_dir()</code>.</p>
</td></tr>
<tr><td><code id="pkg_cache_summary_+3A_...">...</code></td>
<td>
<p>Extra named arguments to select the package file.</p>
</td></tr>
<tr><td><code id="pkg_cache_summary_+3A_target">target</code></td>
<td>
<p>Path where the selected file is copied.</p>
</td></tr>
<tr><td><code id="pkg_cache_summary_+3A_file">file</code></td>
<td>
<p>File to add.</p>
</td></tr>
<tr><td><code id="pkg_cache_summary_+3A_relpath">relpath</code></td>
<td>
<p>The relative path of the file within the cache.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The <a href="#topic+package_cache">package_cache</a> R6 class for a more flexible API.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pkg_cache_summary()
pkg_cache_list()
pkg_cache_find(package = "forecast")
tmp &lt;- tempfile()
pkg_cache_get_file(target = tmp, package = "forecast", version = "8.10")
pkg_cache_delete_files(package = "forecast")

</code></pre>

<hr>
<h2 id='ppm_has_binaries'>Does PPM build binary packages for the current platform?</h2><span id='topic+ppm_has_binaries'></span>

<h3>Description</h3>

<p>Does PPM build binary packages for the current platform?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppm_has_binaries()
</code></pre>


<h3>Value</h3>

<p><code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p>The 'pkgcache and Posit Package Manager on Linux'
article at <a href="https://r-lib.github.io/pkgcache/dev/">https://r-lib.github.io/pkgcache/dev/</a>.
</p>
<p>Other PPM functions: 
<code><a href="#topic+ppm_platforms">ppm_platforms</a>()</code>,
<code><a href="#topic+ppm_r_versions">ppm_r_versions</a>()</code>,
<code><a href="#topic+ppm_repo_url">ppm_repo_url</a>()</code>,
<code><a href="#topic+ppm_snapshots">ppm_snapshots</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
current_r_platform()
ppm_has_binaries()

</code></pre>

<hr>
<h2 id='ppm_platforms'>List all platforms supported by Posit Package Manager (PPM)</h2><span id='topic+ppm_platforms'></span>

<h3>Description</h3>

<p>List all platforms supported by Posit Package Manager (PPM)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppm_platforms()
</code></pre>


<h3>Value</h3>

<p>Data frame with columns:
</p>

<ul>
<li> <p><code>name</code>: platform name, this is essentially an identifier,
</p>
</li>
<li> <p><code>os</code>: operating system, <code>linux</code>, <code>windows</code> or <code>macOS</code> currently,
</p>
</li>
<li> <p><code>binary_url</code>: the URL segment of the binary repository URL of this
platform, see <code><a href="#topic+ppm_snapshots">ppm_snapshots()</a></code>.
</p>
</li>
<li> <p><code>distribution</code>: for Linux platforms the name of the distribution,
</p>
</li>
<li> <p><code>release</code>: for Linux platforms, the name of the release,
</p>
</li>
<li> <p><code>binaries</code>: whether PPM builds binaries for this platform.
</p>
</li></ul>



<h3>See Also</h3>

<p>The 'pkgcache and Posit Package Manager on Linux'
article at <a href="https://r-lib.github.io/pkgcache/dev/">https://r-lib.github.io/pkgcache/dev/</a>.
</p>
<p>Other PPM functions: 
<code><a href="#topic+ppm_has_binaries">ppm_has_binaries</a>()</code>,
<code><a href="#topic+ppm_r_versions">ppm_r_versions</a>()</code>,
<code><a href="#topic+ppm_repo_url">ppm_repo_url</a>()</code>,
<code><a href="#topic+ppm_snapshots">ppm_snapshots</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ppm_platforms()

</code></pre>

<hr>
<h2 id='ppm_r_versions'>List all R versions supported by Posit Package Manager (PPM)</h2><span id='topic+ppm_r_versions'></span>

<h3>Description</h3>

<p>List all R versions supported by Posit Package Manager (PPM)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppm_r_versions()
</code></pre>


<h3>Value</h3>

<p>Data frame with columns:
</p>

<ul>
<li> <p><code>r_version</code>: minor R versions, i.e. version numbers containing the
first two components of R versions supported by this PPM instance.
</p>
</li></ul>



<h3>See Also</h3>

<p>The 'pkgcache and Posit Package Manager on Linux'
article at <a href="https://r-lib.github.io/pkgcache/dev/">https://r-lib.github.io/pkgcache/dev/</a>.
</p>
<p>Other PPM functions: 
<code><a href="#topic+ppm_has_binaries">ppm_has_binaries</a>()</code>,
<code><a href="#topic+ppm_platforms">ppm_platforms</a>()</code>,
<code><a href="#topic+ppm_repo_url">ppm_repo_url</a>()</code>,
<code><a href="#topic+ppm_snapshots">ppm_snapshots</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ppm_r_versions()

</code></pre>

<hr>
<h2 id='ppm_repo_url'>Returns the current Posit Package Manager (PPM) repository URL</h2><span id='topic+ppm_repo_url'></span>

<h3>Description</h3>

<p>Returns the current Posit Package Manager (PPM) repository URL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppm_repo_url()
</code></pre>


<h3>Details</h3>

<p>This URL has the form <code>{base}/{repo}</code>, e.g.
<code style="white-space: pre;">&#8288;https://packagemanager.posit.co/all&#8288;</code>.
</p>
<p>To configure a hosted PPM instance, set the <code>PKGCACHE_PPM_URL</code>
environment variable to the base URL (e.g.
<code style="white-space: pre;">&#8288;https://packagemanager.posit.co&#8288;</code>).
</p>
<p>To use <code><a href="#topic+repo_add">repo_add()</a></code> with PPM snapshots, you may also set the
<code>PKGCACHE_PPM_REPO</code> environment variable to the name of the default
repository.
</p>
<p>On Linux, instead of setting these environment variables, you can also
add a PPM repository to the <code>repos</code> option, see <code><a href="base.html#topic+options">base::options()</a></code>.
If the environment variables are not set, then <code>ppm_repo_url()</code> will
try to extract the PPM base URL and repository name from this option.
</p>
<p>If the <code>PKGCACHE_PPM_URL</code> environment variable is not set, and the
<code>repos</code> option does not contain a PPM URL (on Linux), then pkgcache
uses the public PPM instance at <code style="white-space: pre;">&#8288;https://packagemanager.posit.co&#8288;</code>, with
the <code>cran</code> repository.
</p>


<h3>Value</h3>

<p>String scalar, the repository URL of the configured PPM
instance. If no PPM instance is configured, then the URL of the Posit
Public Package Manager instance. It includes the repository name, e.g.
<code style="white-space: pre;">&#8288;https://packagemanager.posit.co/all&#8288;</code>.
</p>


<h3>See Also</h3>

<p>The 'pkgcache and Posit Package Manager on Linux'
article at <a href="https://r-lib.github.io/pkgcache/dev/">https://r-lib.github.io/pkgcache/dev/</a>.
</p>
<p><code><a href="#topic+repo_resolve">repo_resolve()</a></code> and <code><a href="#topic+repo_add">repo_add()</a></code> to find and configure PPM
snapshots.
</p>
<p>Other PPM functions: 
<code><a href="#topic+ppm_has_binaries">ppm_has_binaries</a>()</code>,
<code><a href="#topic+ppm_platforms">ppm_platforms</a>()</code>,
<code><a href="#topic+ppm_r_versions">ppm_r_versions</a>()</code>,
<code><a href="#topic+ppm_snapshots">ppm_snapshots</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ppm_repo_url()
</code></pre>

<hr>
<h2 id='ppm_snapshots'>List all available Posit Package Manager (PPM) snapshots</h2><span id='topic+ppm_snapshots'></span>

<h3>Description</h3>

<p>List all available Posit Package Manager (PPM) snapshots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppm_snapshots()
</code></pre>


<h3>Details</h3>

<p>The repository URL of a snapshot has the following form on Windows:
</p>
<div class="sourceCode"><pre>{base}/{repo}/{id}
</pre></div>
<p>where <code>{base}</code> is the base URL for PPM (see <code><a href="#topic+ppm_repo_url">ppm_repo_url()</a></code>) and
<code>{id}</code> is either the date or id of the snapshot, or <code>latest</code> for
the latest snapshot. E.g. these are equivalent:
</p>
<div class="sourceCode"><pre>https://packagemanager.posit.co/cran/5
https://packagemanager.posit.co/cran/2017-10-10
</pre></div>
<p>On a Linux distribution that has PPM support, the repository URL that
contains the binary packages looks like this:
</p>
<div class="sourceCode"><pre>{base}/{repo}/__linux__/{binary_url}/{id}
</pre></div>
<p>where <code>{id}</code> is as before, and <code>{binary_url}</code> is a code name for a release
of a supported Linux distribution. See the <code>binary_url</code> column of the
result of <code><a href="#topic+ppm_platforms">ppm_platforms()</a></code> for these code names.
</p>


<h3>Value</h3>

<p>Data frame with two columns:
</p>

<ul>
<li> <p><code>date</code>: the time the snapshot was taken, a <code>POSIXct</code> vector,
</p>
</li>
<li> <p><code>id</code>:  integer id of the snapshot, this can be used in the repository
URL.
</p>
</li></ul>



<h3>See Also</h3>

<p>The 'pkgcache and Posit Package Manager on Linux'
article at <a href="https://r-lib.github.io/pkgcache/dev/">https://r-lib.github.io/pkgcache/dev/</a>.
</p>
<p>Other PPM functions: 
<code><a href="#topic+ppm_has_binaries">ppm_has_binaries</a>()</code>,
<code><a href="#topic+ppm_platforms">ppm_platforms</a>()</code>,
<code><a href="#topic+ppm_r_versions">ppm_r_versions</a>()</code>,
<code><a href="#topic+ppm_repo_url">ppm_repo_url</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ppm_snapshots()

</code></pre>

<hr>
<h2 id='repo_get'>Query and set the list of CRAN-like repositories</h2><span id='topic+repo_get'></span><span id='topic+repo_resolve'></span><span id='topic+repo_add'></span><span id='topic+with_repo'></span>

<h3>Description</h3>

<p>pkgcache uses the <code>repos</code> option, see <code><a href="base.html#topic+options">options()</a></code>. It also automatically
uses the current Bioconductor repositories, see <code><a href="#topic+bioc_version">bioc_version()</a></code>.
These functions help to query and manipulate the <code>repos</code> option.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>repo_get(
  r_version = getRversion(),
  bioc = TRUE,
  cran_mirror = default_cran_mirror()
)

repo_resolve(spec)

repo_add(..., .list = NULL)

with_repo(repos, expr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="repo_get_+3A_r_version">r_version</code></td>
<td>
<p>R version(s) to use for the Bioconductor repositories,
if <code>bioc</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="repo_get_+3A_bioc">bioc</code></td>
<td>
<p>Whether to add Bioconductor repositories, even if they
are not configured in the <code>repos</code> option.</p>
</td></tr>
<tr><td><code id="repo_get_+3A_cran_mirror">cran_mirror</code></td>
<td>
<p>The CRAN mirror to use, see
<code><a href="#topic+default_cran_mirror">default_cran_mirror()</a></code>.</p>
</td></tr>
<tr><td><code id="repo_get_+3A_spec">spec</code></td>
<td>
<p>A single repository specification, a possibly named
character scalar. See details below.</p>
</td></tr>
<tr><td><code id="repo_get_+3A_...">...</code></td>
<td>
<p>Repository specifications. See details below.</p>
</td></tr>
<tr><td><code id="repo_get_+3A_.list">.list</code></td>
<td>
<p>List or character vector of repository specifications,
see details below.</p>
</td></tr>
<tr><td><code id="repo_get_+3A_repos">repos</code></td>
<td>
<p>A list or character vector of repository specifications.</p>
</td></tr>
<tr><td><code id="repo_get_+3A_expr">expr</code></td>
<td>
<p>R expression to evaluate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>repo_get()</code> queries the repositories pkgcache uses. It uses the
<code>repos</code> option (see <a href="base.html#topic+options">options</a>), and also the default Bioconductor
repository.
</p>
<p><code>repo_resolve()</code> resolves a single repository specification to a
repository URL.
</p>
<p><code>repo_add()</code> adds a new repository to the <code>repos</code> option. (To remove
a repository, call <code>option()</code> directly, with the subset that you want
to keep.)
</p>
<p><code>with_repo()</code> temporarily adds the repositories in <code>repos</code>,
evaluates <code>expr</code>, and then resets the configured repositories.
</p>


<h3>Value</h3>

<p><code>repo_get()</code> returns a data frame with columns:
</p>

<ul>
<li> <p><code>name</code>: repository name. Names are informational only.
</p>
</li>
<li> <p><code>url</code>: repository URL.
</p>
</li>
<li> <p><code>type</code>: repository type. This is also informational, currently it
can be <code>cran</code> for CRAN, <code>bioc</code> for a Bioconductor repository, and
<code>cranlike</code>: for other repositories.
</p>
</li>
<li> <p><code>r_version</code>: R version that is supposed to be used with this
repository. This is only set for Bioconductor repositories. It is <code>*</code>
for others. This is also informational, and not used when retrieving
the package metadata.
</p>
</li>
<li> <p><code>bioc_version</code>: Bioconductor version. Only set for Bioconductor
repositories, and it is <code>NA</code> for others.
</p>
</li></ul>

<p><code>repo_resolve()</code> returns a named character vector, with the URL(s) of
the repository.
</p>
<p><code>repo_add()</code> returns the same data frame as <code>repo_get()</code>, invisibly.
</p>
<p><code>with_repo()</code> returns the value of <code>expr</code>.
</p>


<h3>Repository specifications</h3>

<p>The format of a repository specification is a named or unnamed
character scalar. If the name is missing, pkgcache adds a name
automatically. The repository named <code>CRAN</code> is the main CRAN repository,
but otherwise names are informational.
</p>
<p>Currently supported repository specifications:
</p>

<ul>
<li><p> URL pointing to the root of the CRAN-like repository. Example:
</p>
<div class="sourceCode"><pre>https://cloud.r-project.org
</pre></div>
</li>
<li> <p><code>PPM@latest</code>, PPM (Posit Package Manager, formerly RStudio Package
Manager), the latest snapshot.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;PPM@&lt;date&gt;&#8288;</code>, PPM (Posit Package Manager, formerly RStudio Package
Manager) snapshot, at the specified date.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;PPM@&lt;package&gt;-&lt;version&gt;&#8288;</code> PPM snapshot, for the day after the
release of <code style="white-space: pre;">&#8288;&lt;version&gt;&#8288;</code> of <code style="white-space: pre;">&#8288;&lt;package&gt;&#8288;</code>.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;PPM@R-&lt;version&gt;&#8288;</code> PPM snapshot, for the day after R <code style="white-space: pre;">&#8288;&lt;version&gt;&#8288;</code>
was released.
</p>
</li></ul>

<p>Still works for dates starting from 2017-10-10, but now deprecated,
because MRAN is discontinued:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;MRAN@&lt;date&gt;&#8288;</code>, MRAN (Microsoft R Application Network) snapshot, at
the specified date.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;MRAN@&lt;package&gt;-&lt;version&gt;&#8288;</code> MRAN snapshot, for the
day after the release of <code style="white-space: pre;">&#8288;&lt;version&gt;&#8288;</code> of <code style="white-space: pre;">&#8288;&lt;package&gt;&#8288;</code>.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;MRAN@R-&lt;version&gt;&#8288;</code> MRAN snapshot, for the day
after R <code style="white-space: pre;">&#8288;&lt;version&gt;&#8288;</code> was released.
</p>
</li></ul>

<p>Notes:
</p>

<ul>
<li><p> See more about PPM at <a href="https://packagemanager.posit.co/client/#/">https://packagemanager.posit.co/client/#/</a>.
</p>
</li>
<li><p> The <code style="white-space: pre;">&#8288;RSPM@&#8288;</code> prefix is still supported and treated the same way as
<code style="white-space: pre;">&#8288;PPM@&#8288;</code>.
</p>
</li>
<li><p> The MRAN service is now retired, see
<a href="https://techcommunity.microsoft.com/t5/azure-sql-blog/microsoft-r-application-network-retirement/ba-p/3707161">https://techcommunity.microsoft.com/t5/azure-sql-blog/microsoft-r-application-network-retirement/ba-p/3707161</a>
for details.
</p>
</li>
<li> <p><code>MRAN@...</code> repository specifications now resolve to PPM, but note that
PPM snapshots are only available from 2017-10-10. See more about this
at <a href="https://posit.co/blog/migrating-from-mran-to-posit-package-manager/">https://posit.co/blog/migrating-from-mran-to-posit-package-manager/</a>.
</p>
</li>
<li><p> All dates (or times) can be specified in the ISO 8601 format.
</p>
</li>
<li><p> If PPM does not have a snapshot available for a date, the next
available date is used.
</p>
</li>
<li><p> Dates that are before the first, or after the last PPM snapshot
will trigger an error.
</p>
</li>
<li><p> Unknown R or package versions will trigger an error.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other repository functions: 
<code><a href="#topic+repo_status">repo_status</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>repo_get()

repo_resolve("PPM@2021-01-21")
#' repo_resolve("PPM@dplyr-1.0.0")
#' repo_resolve("PPM@R-4.0.0")


with_repo(c(CRAN = "PPM@dplyr-1.0.0"), repo_get())
with_repo(c(CRAN = "PPM@dplyr-1.0.0"), meta_cache_list(package = "dplyr"))

with_repo(c(CRAN = "MRAN@2018-06-30"), summary(repo_status()))

</code></pre>

<hr>
<h2 id='repo_status'>Show the status of CRAN-like repositories</h2><span id='topic+repo_status'></span>

<h3>Description</h3>

<p>It checks the status of the configured or supplied repositories,
for the specified platforms and R versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>repo_status(
  platforms = default_platforms(),
  r_version = getRversion(),
  bioc = TRUE,
  cran_mirror = default_cran_mirror()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="repo_status_+3A_platforms">platforms</code></td>
<td>
<p>Platforms to use, default is <code><a href="#topic+default_platforms">default_platforms()</a></code>.</p>
</td></tr>
<tr><td><code id="repo_status_+3A_r_version">r_version</code></td>
<td>
<p>R version(s) to use, the default is the current
R version, via <code><a href="base.html#topic+getRversion">getRversion()</a></code>.</p>
</td></tr>
<tr><td><code id="repo_status_+3A_bioc">bioc</code></td>
<td>
<p>Whether to add the Bioconductor repositories. If you
already configured them via <code>options(repos)</code>, then you can
set this to <code>FALSE</code>. See <code><a href="#topic+bioc_version">bioc_version()</a></code> for the details about
how pkgcache handles Bioconductor repositories.</p>
</td></tr>
<tr><td><code id="repo_status_+3A_cran_mirror">cran_mirror</code></td>
<td>
<p>The CRAN mirror to use, see
<code><a href="#topic+default_cran_mirror">default_cran_mirror()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The returned data frame has a <code>summary()</code> method, which shows
the same information is a concise table. See examples below.
</p>


<h3>Value</h3>

<p>A data frame that has a row for every repository, on every
queried platform and R version. It has these columns:
</p>

<ul>
<li> <p><code>name</code>: the name of the repository. This comes from the names
of the configured repositories in <code>options("repos")</code>, or
added by pkgcache. It is typically <code>CRAN</code> for CRAN, and the
current Bioconductor repositories are <code>BioCsoft</code>, <code>BioCann</code>,
<code>BioCexp</code>, <code>BioCworkflows</code>, <code>BioCbooks</code>.
</p>
</li>
<li> <p><code>url</code>: base URL of the repository.
</p>
</li>
<li> <p><code>bioc_version</code>: Bioconductor version, or <code>NA</code> for
non-Bioconductor repositories.
</p>
</li>
<li> <p><code>platform</code>: platform, see <code><a href="#topic+default_platforms">default_platforms()</a></code> for possible values.
</p>
</li>
<li> <p><code>path</code>: the path to the packages within the base URL, for a
given platform and R version.
</p>
</li>
<li> <p><code>r_version</code>: R version, one of the specified R versions.
</p>
</li>
<li> <p><code>ok</code>: Logical flag, whether the repository contains a metadata
file for the given platform and R version.
</p>
</li>
<li> <p><code>ping</code>: HTTP response time of the repository in seconds. If
the <code>ok</code> column is <code>FALSE</code>, then this columns in <code>NA</code>.
</p>
</li>
<li> <p><code>error</code>: the error object if the HTTP query failed for this
repository, platform and R version.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other repository functions: 
<code><a href="#topic+repo_get">repo_get</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
repo_status()
rst &lt;- repo_status(
  platforms = c("windows", "macos"),
  r_version = c("4.0", "4.1")
)
summary(rst)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
