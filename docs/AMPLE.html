<!DOCTYPE html><html lang="en"><head><title>Help for package AMPLE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AMPLE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AMPLE'><p>AMPLE: A package of Shiny apps that introduce Harvest Control Rules (HCR) for fisheries management.</p></a></li>
<li><a href='#assessment'><p>assessment</p></a></li>
<li><a href='#comparing_performance'><p>'Comparing HCR Performance' app launcher</p></a></li>
<li><a href='#constant'><p>Evaluates a constant harvest control rule</p></a></li>
<li><a href='#estimation_error'><p>estimation_error</p></a></li>
<li><a href='#get_hcr_ip'><p>Get the input to the HCR</p></a></li>
<li><a href='#get_hcr_op'><p>Evaluates the harvest control rule.</p></a></li>
<li><a href='#intro_hcr'><p>Introduction to HCRs app launcher</p></a></li>
<li><a href='#measuring_performance'><p>Measuring performance app launcher</p></a></li>
<li><a href='#MP+20modules'><p>mpParamsSetterUI</p></a></li>
<li><a href='#Stochasticity+20module'><p>stochParamsSetterUI</p></a></li>
<li><a href='#Stock'><p>R6 Class representing a stock</p></a></li>
<li><a href='#Stock+20module'><p>stockParamsSetterUI</p></a></li>
<li><a href='#threshold'><p>Evaluates a threshold harvest control rule</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Shiny Apps to Support Capacity Building on Harvest Control Rules</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Finlay Scott <a href="https://orcid.org/0000-0001-9950-9023"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Pacific Community (SPC) [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Finlay Scott &lt;finlays@spc.int&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Three Shiny apps are provided that introduce Harvest Control Rules (HCR) for fisheries management.
    'Introduction to HCRs' provides a simple overview to how HCRs work. Users are able to select their own HCR and
    step through its performance, year by year. Biological variability and estimation uncertainty are introduced.
    'Measuring performance' builds on the previous app and introduces the idea of using performance indicators
    to measure HCR performance.
    'Comparing performance' allows multiple HCRs to be created and tested, and their performance compared so that the
    preferred HCR can be selected.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/PacificCommunity/ofp-sam-ample">https://github.com/PacificCommunity/ofp-sam-ample</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, bookdown, testthat (&ge; 3.1.5)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>shiny (&ge; 1.7.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>markdown, graphics, grDevices, RColorBrewer, stats, R6 (&ge;
2.5.1), scales (&ge; 1.2.1), shinyjs (&ge; 2.1.0), ggplot2 (&ge;
3.4.0), shinyscreenshot (&ge; 0.2.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-28 21:46:33 UTC; Finlays</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-29 07:40:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='AMPLE'>AMPLE: A package of Shiny apps that introduce Harvest Control Rules (HCR) for fisheries management.</h2><span id='topic+AMPLE'></span><span id='topic+AMPLE-package'></span>

<h3>Description</h3>

<p>AMPLE provides three Shiny apps that introduce Harvest Control Rules (HCR) for fisheries management.
'Introduction to HCRs' provides a simple overview to how HCRs work. Users are able to select their own HCR and
step through its performance, year by year. Biological variability and estimation uncertainty are introduced.
'Introduction to indicators' builds on the previous app and introduces the idea of using performance indicators
to evaluate HCR performance.
'Comparing performance' allows multiple HCRs to be created and tested, and their performance compared so that the
preferred HCR can be selected.
</p>
<p>Harvest Control Rules are used as part of a fishery harvest strategy.
This package was put together as part of capacity building efforts by the Pacific Community (SPC) to develop fishery harvest strategies for tuna stocks in the western and central Pacific Ocean (WCPO), working with the Western and Central Pacific Fisheries Commission (WCPFC).
For more information on tuna harvest strategies in the WCPO please see LINKs.
</p>


<h3>AMPLE functions</h3>

<p>Too launch the apps use the functions: <code>intro_hcr()</code>, <code>measuring_performance()</code> and <code>comparing_performance()</code>.
</p>


<h3>Acknowledgement</h3>

<p>With thanks to Andre Punt.
Also thanks to Winston Chang for help with the R6 class / Shiny reactivity.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Finlay Scott <a href="mailto:finlays@spc.int">finlays@spc.int</a> (<a href="https://orcid.org/0000-0001-9950-9023">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Pacific Community (SPC) [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/PacificCommunity/ofp-sam-ample">https://github.com/PacificCommunity/ofp-sam-ample</a>
</p>
</li></ul>


<hr>
<h2 id='assessment'>assessment</h2><span id='topic+assessment'></span>

<h3>Description</h3>

<p>Function used by <code>get_hcr_ip()</code> to generate input data for an assessment based HCR.
The input to the HCR is depletion (i.e. Biomass / K).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assessment(stock, mp_params, yr, iters = 1:dim(stock$biomass)[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assessment_+3A_stock">stock</code></td>
<td>
<p>The stock object</p>
</td></tr>
<tr><td><code id="assessment_+3A_mp_params">mp_params</code></td>
<td>
<p>A named list of MP parameters (with est_sigma and est_bias elements)</p>
</td></tr>
<tr><td><code id="assessment_+3A_yr">yr</code></td>
<td>
<p>The timestep that the biomass is taken from.</p>
</td></tr>
<tr><td><code id="assessment_+3A_iters">iters</code></td>
<td>
<p>Numeric vector of iters. Default is all of them.</p>
</td></tr>
</table>

<hr>
<h2 id='comparing_performance'>'Comparing HCR Performance' app launcher</h2><span id='topic+comparing_performance'></span>

<h3>Description</h3>

<p>Launches the Comparing Performance Shiny app.
See the 'Information' tab in the app for more information.
Also see the package vignette (<code>vignette("comparing_performance", package="AMPLE")</code>) for a tutorial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparing_performance(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comparing_performance_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: comparing_performance()
</code></pre>

<hr>
<h2 id='constant'>Evaluates a constant harvest control rule</h2><span id='topic+constant'></span>

<h3>Description</h3>

<p>Evaluates a constant harvest control rule, i.e. one that ignores the stock status and just returns the constant level (catch or effort).
Used by the <code>hcr_op</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constant(mp_params, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="constant_+3A_mp_params">mp_params</code></td>
<td>
<p>The HCR / management procedure parameters used to evaluate the HCR (as a list).</p>
</td></tr>
<tr><td><code id="constant_+3A_...">...</code></td>
<td>
<p>Unused</p>
</td></tr>
</table>

<hr>
<h2 id='estimation_error'>estimation_error</h2><span id='topic+estimation_error'></span>

<h3>Description</h3>

<p>Estimation error applied to the 'true' stock status to generate an 'observed' stock status used in the HCR.
The error is a combination of bias and lognormally distributed noise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimation_error(input, sigma, bias)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimation_error_+3A_input">input</code></td>
<td>
<p>A vector of the 'true' stock status</p>
</td></tr>
<tr><td><code id="estimation_error_+3A_sigma">sigma</code></td>
<td>
<p>Observation error standard deviation</p>
</td></tr>
<tr><td><code id="estimation_error_+3A_bias">bias</code></td>
<td>
<p>Observation error bias</p>
</td></tr>
</table>

<hr>
<h2 id='get_hcr_ip'>Get the input to the HCR</h2><span id='topic+get_hcr_ip'></span>

<h3>Description</h3>

<p>Run the MP analyses function to generate the input to the HCR i.e. observed stock status.
For example, estimated biomass from an assessment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_hcr_ip(stock, mp_params, yr, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_hcr_ip_+3A_stock">stock</code></td>
<td>
<p>The stock object</p>
</td></tr>
<tr><td><code id="get_hcr_ip_+3A_mp_params">mp_params</code></td>
<td>
<p>The HCR / management procedure parameters used to evaluate the HCR (as a list).</p>
</td></tr>
<tr><td><code id="get_hcr_ip_+3A_yr">yr</code></td>
<td>
<p>The time step of the true stock status used to generate the HCR IP .</p>
</td></tr>
<tr><td><code id="get_hcr_ip_+3A_...">...</code></td>
<td>
<p>Other arguments, including iters</p>
</td></tr>
</table>

<hr>
<h2 id='get_hcr_op'>Evaluates the harvest control rule.</h2><span id='topic+get_hcr_op'></span>

<h3>Description</h3>

<p>Evaluates the harvest control rule in a single year (timestep).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_hcr_op(stock, mp_params, yr, iters = 1:dim(stock$biomass)[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_hcr_op_+3A_stock">stock</code></td>
<td>
<p>The stock object</p>
</td></tr>
<tr><td><code id="get_hcr_op_+3A_mp_params">mp_params</code></td>
<td>
<p>The HCR / management procedure parameters used to evaluate the HCR (as a list).</p>
</td></tr>
<tr><td><code id="get_hcr_op_+3A_yr">yr</code></td>
<td>
<p>The timestep.</p>
</td></tr>
<tr><td><code id="get_hcr_op_+3A_iters">iters</code></td>
<td>
<p>A numeric vector of iters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of outputs from the HCR.
</p>

<hr>
<h2 id='intro_hcr'>Introduction to HCRs app launcher</h2><span id='topic+intro_hcr'></span>

<h3>Description</h3>

<p>Launches the introduction to HCRs Shiny app.
See the 'Information' tab in the app for more information.
Also see the package vignette (<code>vignette("intro_hcr", package="AMPLE")</code>) for a tutorial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intro_hcr(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="intro_hcr_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: intro_hcr()
</code></pre>

<hr>
<h2 id='measuring_performance'>Measuring performance app launcher</h2><span id='topic+measuring_performance'></span>

<h3>Description</h3>

<p>Launches the 'Measuring Performance' Shiny app.
See the 'Information' tab in the app for more information.
Also see the package vignette (<code>vignette("measuring_performance", package="AMPLE")</code>) for a tutorial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>measuring_performance(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="measuring_performance_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: measuring_performance()
</code></pre>

<hr>
<h2 id='MP+20modules'>mpParamsSetterUI</h2><span id='topic+MP+20modules'></span><span id='topic+mpParamsSetterUI'></span><span id='topic+mpParamsSetterServer'></span><span id='topic+mp_params_switcheroo'></span>

<h3>Description</h3>

<p>The interface for the HCR options.
The parameter selection inputs shown in the app are conditional on the selected type of HCR.
Some of the inputs have initial values that can be set using the function arguments.
</p>
<p>Does the setting part of the MP params module.
Returns a list of MP params based on the MP inputs.
</p>
<p>Creates the MP params list based on the MP selection from the Shiny UI.
Defined outside of a reactive environment above so we can use it non-reactively (helpful for testing).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpParamsSetterUI(
  id,
  mp_visible = NULL,
  title = "Select the type of HCR you want to test.",
  init_thresh_max_catch = 140,
  init_thresh_belbow = 0.5,
  init_constant_catch = 50,
  init_constant_effort = 1
)

mpParamsSetterServer(id, get_stoch_params = NULL)

mp_params_switcheroo(input, est_sigma = 0, est_bias = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MP+2B20modules_+3A_id">id</code></td>
<td>
<p>The id (shiny magic)</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_mp_visible">mp_visible</code></td>
<td>
<p>Which HCR types to show.</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_title">title</code></td>
<td>
<p>The title.</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_init_thresh_max_catch">init_thresh_max_catch</code></td>
<td>
<p>Initial value of the maximum catch for the catch threshold HCR.</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_init_thresh_belbow">init_thresh_belbow</code></td>
<td>
<p>Initial value of the belbow for the catch threshold HCR.</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_init_constant_catch">init_constant_catch</code></td>
<td>
<p>Initial value of constant catch for the constant catch HCR.</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_init_constant_effort">init_constant_effort</code></td>
<td>
<p>Initial value of constant effort for the constant effort HCR.</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_get_stoch_params">get_stoch_params</code></td>
<td>
<p>Reactive expression that gets the parameters from the stochasticity setter. Otherwise est_sigma and est_bias are set to 0.</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_input">input</code></td>
<td>
<p>List of information taken from the Shiny UI (mpParamsSetterUI)</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_est_sigma">est_sigma</code></td>
<td>
<p>Standard deviation of the estimation variability (default = 0).</p>
</td></tr>
<tr><td><code id="MP+2B20modules_+3A_est_bias">est_bias</code></td>
<td>
<p>Estimation bias as a proportion. Can be negative (default = 0).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A taglist
</p>
<p>A list of HCR options.
</p>

<hr>
<h2 id='Stochasticity+20module'>stochParamsSetterUI</h2><span id='topic+Stochasticity+20module'></span><span id='topic+stochParamsSetterUI'></span><span id='topic+stochParamsSetterServer'></span><span id='topic+set_stoch_params'></span>

<h3>Description</h3>

<p>stochParamsSetterUI() is the UI part for the stochasticity options.
Stochasticity is included in the projections in two areas: biological variability (e.g. recruitment)
and estimation error (to represent the difference between the 'true' status of the stock and the estimated status that is used by the HCR).
Estimation error includes bias and variability.
The arguments to this function allow only some of these elements to be shown.
</p>
<p>stochParamSetterServer() does the server side stuff for the stochasticity options.
</p>
<p>set_stoch_params() sets up default values for the stochasticity parameters.
Defined as a separate function so it can be used for testing outside of a reactive environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochParamsSetterUI(
  id,
  show_var = FALSE,
  show_biol_sigma = TRUE,
  show_est_sigma = TRUE,
  show_est_bias = TRUE,
  init_biol_sigma = 0,
  init_est_sigma = 0,
  init_est_bias = 0
)

stochParamsSetterServer(id)

set_stoch_params(input)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Stochasticity+2B20module_+3A_id">id</code></td>
<td>
<p>The id (shiny magic)</p>
</td></tr>
<tr><td><code id="Stochasticity+2B20module_+3A_show_var">show_var</code></td>
<td>
<p>Show the variability options when app opens (default is FALSE).</p>
</td></tr>
<tr><td><code id="Stochasticity+2B20module_+3A_show_biol_sigma">show_biol_sigma</code></td>
<td>
<p>Show the biological productivity variability option (default is TRUE).</p>
</td></tr>
<tr><td><code id="Stochasticity+2B20module_+3A_show_est_sigma">show_est_sigma</code></td>
<td>
<p>Show the estimation variability option (default is TRUE).</p>
</td></tr>
<tr><td><code id="Stochasticity+2B20module_+3A_show_est_bias">show_est_bias</code></td>
<td>
<p>Show the estimation bias option (default is TRUE).</p>
</td></tr>
<tr><td><code id="Stochasticity+2B20module_+3A_init_biol_sigma">init_biol_sigma</code></td>
<td>
<p>Default value for biological productivity variability (ignored if not shown).</p>
</td></tr>
<tr><td><code id="Stochasticity+2B20module_+3A_init_est_sigma">init_est_sigma</code></td>
<td>
<p>Default value for estimation variability (ignored if not shown).</p>
</td></tr>
<tr><td><code id="Stochasticity+2B20module_+3A_init_est_bias">init_est_bias</code></td>
<td>
<p>Default value for estimation bias (ignored if not shown).</p>
</td></tr>
<tr><td><code id="Stochasticity+2B20module_+3A_input">input</code></td>
<td>
<p>A list of stochasticity parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A taglist
</p>
<p>A list of stochasticity options.
</p>

<hr>
<h2 id='Stock'>R6 Class representing a stock</h2><span id='topic+Stock'></span>

<h3>Description</h3>

<p>A stock object has life history parameters, fields and methods for a biomass dynamic model.
</p>


<h3>Details</h3>

<p>A stock has biomass, effort, catch and hcr_ip and hcr_op fields as well as the life history parameters.
The population dynamics are a simple biomass dynamic model.
The Stock class is used for the Shiny apps in the AMPLE package.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>biomass</code></dt><dd><p>Array of biomass</p>
</dd>
<dt><code>catch</code></dt><dd><p>Array of catches</p>
</dd>
<dt><code>effort</code></dt><dd><p>Array of fishing effort</p>
</dd>
<dt><code>hcr_ip</code></dt><dd><p>Array of HCR input signals</p>
</dd>
<dt><code>hcr_op</code></dt><dd><p>Array of HCR output signals</p>
</dd>
<dt><code>msy</code></dt><dd><p>MSY (default = 100).</p>
</dd>
<dt><code>r</code></dt><dd><p>Growth rate (default = 0.6). Set by the user in the app.</p>
</dd>
<dt><code>k</code></dt><dd><p>Carrying capacity (default = NULL - set by msy and r when object is initialised).</p>
</dd>
<dt><code>p</code></dt><dd><p>Shape of the production curve (default = 1).</p>
</dd>
<dt><code>q</code></dt><dd><p>Catchability (default = 1).</p>
</dd>
<dt><code>lrp</code></dt><dd><p>Limit reference point, expressed as depletion (default = 0.2).</p>
</dd>
<dt><code>trp</code></dt><dd><p>Target reference point, expressed as depletion (default = 0.5).</p>
</dd>
<dt><code>b0</code></dt><dd><p>Virgin biomass (default = NULL - set by msy and r when object is initialised).</p>
</dd>
<dt><code>current_corrnoise</code></dt><dd><p>Stores the current values of the correlated noise (by iteration).</p>
</dd>
<dt><code>biol_sigma</code></dt><dd><p>Standard deviation of biological variability (default = 0).</p>
</dd>
<dt><code>last_historical_timestep</code></dt><dd><p>The last historical timestep of catch and effort data.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Stock-new"><code>Stock$new()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-reset"><code>Stock$reset()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-reactive"><code>Stock$reactive()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-fill_history"><code>Stock$fill_history()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-fill_catch_history"><code>Stock$fill_catch_history()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-fill_biomass"><code>Stock$fill_biomass()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-as_data_frame"><code>Stock$as_data_frame()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-project"><code>Stock$project()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-relative_cpue"><code>Stock$relative_cpue()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-relative_effort"><code>Stock$relative_effort()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-replicate_table"><code>Stock$replicate_table()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-time_periods"><code>Stock$time_periods()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-performance_indicators"><code>Stock$performance_indicators()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-pi_table"><code>Stock$pi_table()</code></a>
</p>
</li>
<li> <p><a href="#method-Stock-clone"><code>Stock$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-Stock-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create a new stock object, with fields of the right dimension and NA values (by calling the <code>reset()</code> method.
See the <code>reset()</code> method for more details.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$new(stock_params, mp_params, niters = 1)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>stock_params</code></dt><dd><p>A list of stock parameters with essential elements: r (growth rate, numeric), stock_history (string: &quot;fully&quot;, &quot;over&quot;, &quot;under&quot;) initial_year (integer), last_historical_timestep (integer), nyears (integer), biol_sigma (numeric).</p>
</dd>
<dt><code>mp_params</code></dt><dd><p>A list of the MP parameters. Used to fill HCR ip and op.</p>
</dd>
<dt><code>niters</code></dt><dd><p>The number of iters in the stock (default = 1).</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A new Stock object.
</p>


<hr>
<a id="method-Stock-reset"></a>



<h4>Method <code>reset()</code></h4>

<p>Resets an existing stock object, by remaking all fields (possibly with different dimensions for the array fields) .
Fills up the catch, effort and biomass fields in the historical period based on the stock history and
life history parameters in the <code>stock_params</code> argument.
This is a reactive method which invalidates a reactive instance of this class after it is called.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$reset(stock_params, mp_params, niters)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>stock_params</code></dt><dd><p>A list with essential elements: r (growth rate, numeric, default=6), stock_history (string: &quot;fully&quot;, &quot;over&quot;, &quot;under&quot;, default=&quot;fully&quot;) initial_year (integer, default=2000), last_historical_timestep (integer, default=10), nyears (integer, default=30), biol_sigma (numeric, default = 0).</p>
</dd>
<dt><code>mp_params</code></dt><dd><p>A list of the MP parameters. Used to fill HCR ip and op.</p>
</dd>
<dt><code>niters</code></dt><dd><p>The number of iters in the stock (default = 1).</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A new Stock object.
</p>


<hr>
<a id="method-Stock-reactive"></a>



<h4>Method <code>reactive()</code></h4>

<p>Method to create a reactive instance of a Stock.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$reactive()</pre></div>



<h5>Returns</h5>

<p>a reactiveExpr.
</p>


<hr>
<a id="method-Stock-fill_history"></a>



<h4>Method <code>fill_history()</code></h4>

<p>Fills the historical period of the stock
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$fill_history(stock_params, mp_params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>stock_params</code></dt><dd><p>Named list with last_historical_timestep and stock_history elements.</p>
</dd>
<dt><code>mp_params</code></dt><dd><p>A list of the MP parameters. Used to fill HCR ip and op.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-Stock-fill_catch_history"></a>



<h4>Method <code>fill_catch_history()</code></h4>

<p>Fill up the historical period of catches with random values to simulate a catch history
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$fill_catch_history(stock_params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>stock_params</code></dt><dd><p>A list with essential elements: r (growth rate, numeric), stock_history (string: &quot;fully&quot;, &quot;over&quot;, &quot;under&quot;) initial_year (integer), last_historical_timestep (integer), nyears (integer).</p>
</dd>
<dt><code>stock_history</code></dt><dd><p>Character string of the exploitation history (default = &quot;fully&quot;, alternatives are &quot;under&quot; or &quot;over&quot;).</p>
</dd>
</dl>

</div>


<hr>
<a id="method-Stock-fill_biomass"></a>



<h4>Method <code>fill_biomass()</code></h4>

<p>Fills the biomass in the next timestep based on current biomass and catches
The surplus production model has the general form:
<code>Bt+1 = Bt + f(Bt) - Ct</code>
Where the production function f() is a Pella &amp; Tomlinson model with shape
<code>f(Bt) = r/p Bt * (1 - (Bt/k)^p)</code>
Here p is fixed at 1 to give a Schaefer model
<code>cpue = Ct / Et = qBt</code>
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$fill_biomass(ts, iters = 1:dim(self$biomass)[1])</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>ts</code></dt><dd><p>The biomass time step to be filled (required catch etc in ts - 1).</p>
</dd>
<dt><code>iters</code></dt><dd><p>The iterations to calculate the biomass for (optional - default is all of them).</p>
</dd>
</dl>

</div>


<hr>
<a id="method-Stock-as_data_frame"></a>



<h4>Method <code>as_data_frame()</code></h4>

<p>Produces a data.frame of some of the array-based fields, like biomass.
Just used for testing purposes.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$as_data_frame()</pre></div>


<hr>
<a id="method-Stock-project"></a>



<h4>Method <code>project()</code></h4>

<p>Projects the stock over the time steps given and updates the biomass, HCR ip / op and catches
It uses a simple biomass dynamic model where the catches or fishing effort are set every time step by the harvest control rule.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$project(timesteps, mp_params, iters = 1:dim(self$biomass)[1])</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>timesteps</code></dt><dd><p>The timesteps to project over. A vector of length 2 (start and end).</p>
</dd>
<dt><code>mp_params</code></dt><dd><p>A vector of management procedure parameters.</p>
</dd>
<dt><code>iters</code></dt><dd><p>A vector of iterations to be projected. Default is all the iterations in the stock</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A stock object (a reactiveValues object with bits for the stock)
</p>


<hr>
<a id="method-Stock-relative_cpue"></a>



<h4>Method <code>relative_cpue()</code></h4>

<p>The catch per unit effort (CPUE, or catch rate) relative to the CPUE in the last historical period.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$relative_cpue()</pre></div>



<h5>Returns</h5>

<p>An array of same dims as the catch and effort fields.
</p>


<hr>
<a id="method-Stock-relative_effort"></a>



<h4>Method <code>relative_effort()</code></h4>

<p>The effort relative to the effort in the last historical period.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$relative_effort()</pre></div>



<h5>Returns</h5>

<p>An array of same dims as the effort field.
</p>


<hr>
<a id="method-Stock-replicate_table"></a>



<h4>Method <code>replicate_table()</code></h4>

<p>Summarises the final year of each iteration. Only used for the Measuring Performance app.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$replicate_table(iters = 1, quantiles = c(0.05, 0.95))</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>iters</code></dt><dd><p>The iterations to calculate the table values for (default is iteration 1).</p>
</dd>
<dt><code>quantiles</code></dt><dd><p>Numeric vector of the quantile range. Default values are 0.05 and 0.95.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-Stock-time_periods"></a>



<h4>Method <code>time_periods()</code></h4>

<p>Calculates the short, medium and long term periods to calculate the performance indicators over,
based on the last historic year of data and the number of years in the projection.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$time_periods()</pre></div>


<hr>
<a id="method-Stock-performance_indicators"></a>



<h4>Method <code>performance_indicators()</code></h4>

<p>Gets the performance indicators across all indicators, for three time periods.
Used in the Measuring Performance and Comparing Performance apps.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$performance_indicators(
  iters = 1:dim(self$biomass)[1],
  quantiles = c(0.05, 0.95)
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>iters</code></dt><dd><p>The iterations to calculate the table values for (default is all of them).</p>
</dd>
<dt><code>quantiles</code></dt><dd><p>Numeric vector of the quantile range. Default values are 0.05 and 0.95.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A data.frame
</p>


<hr>
<a id="method-Stock-pi_table"></a>



<h4>Method <code>pi_table()</code></h4>

<p>Makes a table of the performance indicators.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$pi_table(iters = 1:dim(self$biomass)[1], quantiles = c(0.05, 0.95))</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>iters</code></dt><dd><p>The iterations to calculate the table values for (default is all of them).</p>
</dd>
<dt><code>quantiles</code></dt><dd><p>Numeric vector, length 2, of the low and high quantiles.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-Stock-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Stock$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>



<hr>
<h2 id='Stock+20module'>stockParamsSetterUI</h2><span id='topic+Stock+20module'></span><span id='topic+stockParamsSetterUI'></span><span id='topic+stockParamsSetterServer'></span><span id='topic+get_stock_params'></span>

<h3>Description</h3>

<p>stockParamsSetterUI() is the interface for the stock options (e.g. life history and exploitation status).
</p>
<p>stockParamsSetterServer() does the setting of the stock parameters in the server.
</p>
<p>get_stock_params() Sets up default values for the stock, including year range.
It's a separate function so it can be used and tested outside of a reactive environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stockParamsSetterUI(id)

stockParamsSetterServer(id, get_stoch_params = NULL)

get_stock_params(input, biol_sigma = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Stock+2B20module_+3A_id">id</code></td>
<td>
<p>Shiny magic</p>
</td></tr>
<tr><td><code id="Stock+2B20module_+3A_get_stoch_params">get_stoch_params</code></td>
<td>
<p>Reactive expression that accesses the stochasticity module server.</p>
</td></tr>
<tr><td><code id="Stock+2B20module_+3A_input">input</code></td>
<td>
<p>List of stock parameters taken from the shiny UI (stockParamsSetterUI()).</p>
</td></tr>
<tr><td><code id="Stock+2B20module_+3A_biol_sigma">biol_sigma</code></td>
<td>
<p>Standard deviation of the biological variability (default = 0).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A taglist
</p>
<p>A list of stock options.
</p>

<hr>
<h2 id='threshold'>Evaluates a threshold harvest control rule</h2><span id='topic+threshold'></span>

<h3>Description</h3>

<p>Evaluates a threshold (i.e. hockey stick) harvest control rule.
Used by the <code>hcr_op</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold(input, mp_params, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold_+3A_input">input</code></td>
<td>
<p>A vector of the 'true' stock status</p>
</td></tr>
<tr><td><code id="threshold_+3A_mp_params">mp_params</code></td>
<td>
<p>The HCR / management procedure parameters used to evaluate the HCR (as a list).</p>
</td></tr>
<tr><td><code id="threshold_+3A_...">...</code></td>
<td>
<p>Unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same dimension as the input.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
