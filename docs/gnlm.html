<!DOCTYPE html><html><head><title>Help for package gnlm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gnlm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bnlr'><p>Binomial Nonlinear Regression Models</p></a></li>
<li><a href='#fit.dist'><p>Fit Probability Distributions to Frequency Data</p></a></li>
<li><a href='#fmr'><p>Generalized Nonlinear Regression Models with Two or Three Point Mixtures</p></a></li>
<li><a href='#gnlr'><p>Generalized Nonlinear Regression Models for One and Two Parameter</p>
Distributions</a></li>
<li><a href='#gnlr3'><p>Generalized Nonlinear Regression Models for Three Parameter Distributions</p></a></li>
<li><a href='#nlr'><p>Nonlinear Normal, Gamma, and Inverse Gaussian Regression Models</p></a></li>
<li><a href='#nordr'><p>Nonlinear Ordinal Regression Models</p></a></li>
<li><a href='#ordglm'><p>Generalized Linear Ordinal Regression Models</p></a></li>
<li><a href='#rs2'><p>Two-factor Box-Tidwell Nonlinear Response Surface Models</p></a></li>
<li><a href='#rs3'><p>Three-factor Box-Tidwell Nonlinear Response Surface Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Nonlinear Regression Models</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.4), rmutil</td>
</tr>
<tr>
<td>Description:</td>
<td>A variety of functions to fit linear and nonlinear
    regression with a large selection of distributions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.commanster.eu/rcode.html">http://www.commanster.eu/rcode.html</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/swihart/gnlm/issues">https://github.com/swihart/gnlm/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-02-03 02:53:44 UTC; swihartbj</td>
</tr>
<tr>
<td>Author:</td>
<td>Bruce Swihart [cre, aut],
  Jim Lindsey [aut] (Jim created this package, Bruce is maintaining the
    CRAN version)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bruce Swihart &lt;bruce.swihart@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-02-03 05:13:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='bnlr'>Binomial Nonlinear Regression Models</h2><span id='topic+bnlr'></span>

<h3>Description</h3>

<p><code>bnlr</code> fits user-specified nonlinear regression equations to binomial
data with various link functions (<code>logit</code>, <code>probit</code>, <code>comp
log log</code>, <code>log log</code>, <code>Cauchy</code>, <code>Student t</code>, <code>stable</code>, or
<code>mixture</code>). The mixture link is a logistic link with extra probability
mass for <code>y=0</code> and <code>y=n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bnlr(y = NULL, link = "logit", mu = NULL, linear = NULL,
  pmu = NULL, pshape = NULL, wt = 1, envir = parent.frame(),
  print.level = 0, typsize = abs(p), ndigit = 10, gradtol = 1e-05,
  stepmax = 10 * sqrt(p %*% p), steptol = 1e-05, iterlim = 100,
  fscale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bnlr_+3A_y">y</code></td>
<td>
<p>A two column matrix of binomial data or censored data or an object
of class, <code>response</code> (created by <code><a href="rmutil.html#topic+restovec">restovec</a></code>) or
<code>repeated</code> (created by <code><a href="rmutil.html#topic+rmna">rmna</a></code> or
<code><a href="rmutil.html#topic+lvna">lvna</a></code>). If the <code>repeated</code> data object contains
more than one response variable, give that object in <code>envir</code> and give
the name of the response variable to be used here.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_link">link</code></td>
<td>
<p>A character string containing the name of the link function. The
<code>Student t</code>, <code>stable</code>, and <code>mixture</code> links contain an unknown
parameter to be estimated, respectively the logarithm of the degrees of
freedom, the tail parameter transformed by log(tail/(2-tail)), and logit of
the mixture probability, so that they lie on the whole real line.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_mu">mu</code></td>
<td>
<p>A user-specified function of <code>pmu</code>, and possibly
<code>linear</code>, giving the regression equation for the location. This may
contain a linear part as the second argument to the function. It may also be
a formula beginning with ~, specifying either a linear regression function
for the location parameter in the Wilkinson and Rogers notation or a general
function with named unknown parameters. If it contains unknown parameters,
the keyword <code>linear</code> may be used to specify a linear part. If nothing
is supplied, the location is taken to be constant unless the linear argument
is given.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_linear">linear</code></td>
<td>
<p>A formula beginning with ~ in W&amp;R notation, specifying the
linear part of the regression function for the location parameter or list of
two such expressions for the location and/or shape parameters.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_pmu">pmu</code></td>
<td>
<p>Vector of initial estimates for the location parameters. If
<code>mu</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_pshape">pshape</code></td>
<td>
<p>If the <code>link</code> is <code>Student t</code>, an initial estimate of
the degrees of freedom; if it is <code>stable</code>, an estimate of the tail
parameter; if it is <code>mixture</code>, an estimate of the mixture probability.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_wt">wt</code></td>
<td>
<p>Weight vector.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_envir">envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_print.level">print.level</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_typsize">typsize</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_ndigit">ndigit</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_gradtol">gradtol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_stepmax">stepmax</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_steptol">steptol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_iterlim">iterlim</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="bnlr_+3A_fscale">fscale</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nonlinear regression models can be supplied as formulae where parameters are
unknowns in which case factor variables cannot be used and parameters must
be scalars. (See <code><a href="rmutil.html#topic+finterp">finterp</a></code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the maximum likelihood estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class <code>gnlm</code> is returned that contains all of the
relevant information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code><a href="rmutil.html#topic+finterp">finterp</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>,
<code><a href="#topic+gnlr">gnlr</a></code>, <code><a href="#topic+gnlr3">gnlr3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# assay to estimate LD50
y &lt;- c(9,9,10,4,1,0,0)
y &lt;- cbind(y,10-y)
dose &lt;- log10(100/c(2.686,2.020,1.520,1.143,0.860,0.647,0.486))

summary(glm(y~dose, family=binomial))
bnlr(y, mu=~dose, pmu=c(1,1))
summary(glm(y~dose, family=binomial(link=probit)))
bnlr(y, link="probit", mu=~dose, pmu=c(1,1))
## Not run: 
bnlr(y, link="log log", mu=~dose, pmu=c(1,1))
bnlr(y, link="comp log log", mu=~dose, pmu=c(1,1))
bnlr(y, link="Cauchy", mu=~dose, pmu=c(60,-30))
bnlr(y, link="Student", mu=~dose, pmu=c(60,-30), pshape=0.1)
bnlr(y, link="stable", mu=~dose, pmu=c(20,-15), pshape=0, stepmax=1)
bnlr(y, link="mixture", mu=~dose, pmu=c(60,-30), pshape=-2.5)
#
mu &lt;- function(p) -p[1]*(log10(p[2])-dose)
bnlr(y, mu=mu, pmu=c(1,100))
bnlr(y, link="probit", mu=mu, pmu=c(1,100))

## End(Not run)
</code></pre>

<hr>
<h2 id='fit.dist'>Fit Probability Distributions to Frequency Data</h2><span id='topic+fit.dist'></span>

<h3>Description</h3>

<p><code>fit.dist</code> fits the distributions in Chapter 4 of Lindsey (1995, 2003
2nd edn): binomial, beta-binomial, Poisson, negative binomial, geometric,
zeta, normal, log normal, inverse Gauss, logistic, Laplace, Cauchy, Student
t, exponential, Pareto, gamma, and Weibull to frequency (histogram) data,
possibly plotting the frequency polygon of fitted values with the histogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.dist(y, ni, distribution = "normal", breaks = FALSE, delta = 1,
  censor = FALSE, exact = TRUE, plot = FALSE, add = FALSE,
  xlab = deparse(substitute(y)), ylab = "Probability",
  xlim = range(y), main = paste("Histogram of",
  deparse(substitute(y))), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.dist_+3A_y">y</code></td>
<td>
<p>Vector of observations.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_ni">ni</code></td>
<td>
<p>Corresponding vector of frequencies.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_distribution">distribution</code></td>
<td>
<p>Character string specifying the distribution.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_breaks">breaks</code></td>
<td>
<p>If TRUE, <code>y</code> contains breaks between categories instead
of mid-points.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_delta">delta</code></td>
<td>
<p>Scalar or vector giving the unit of measurement (always one for
discrete data) for each response value, set to unity by default. For
example, if a response is measured to two decimals, delta=0.01.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_censor">censor</code></td>
<td>
<p>If TRUE, the last category is right censored.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_exact">exact</code></td>
<td>
<p>If FALSE, uses the approximations for certain distributions in
Lindsey (1995).</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_plot">plot</code></td>
<td>
<p>If TRUE, plots the histogram of observed frequencies and the
frequency polygon of fitted values.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_add">add</code></td>
<td>
<p>If TRUE, adds a new frequency polygon of fitted values without
replotting the histogram.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_xlab">xlab</code></td>
<td>
<p>Plotting control options.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_ylab">ylab</code></td>
<td>
<p>Plotting control options.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_xlim">xlim</code></td>
<td>
<p>Plotting control options.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_main">main</code></td>
<td>
<p>Plotting control options.</p>
</td></tr>
<tr><td><code id="fit.dist_+3A_...">...</code></td>
<td>
<p>Plotting control options.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>References</h3>

<p>Lindsey, J.K. (1995) Introductory Statistics: A Modelling
Approach. Oxford: Oxford University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
f &lt;- c(215, 1485, 5331, 10649, 14959, 11929, 6678, 2092, 342)
y &lt;- seq(0,8)
fit.dist(y, f, "binomial", plot=TRUE, xlab="Number of males",
	main="Distribution of males in families of 8 children")
#
f &lt;- c(1,1,6,3,4,3,9,6,5,16,4,11,6,11,3,4,5,6,4,4,5,1,1,4,1,2,
	0,2,0,0,1)
y &lt;- seq(1100,4100,by=100)
fit.dist(y, f, "normal", delta=100, plot=TRUE,
	xlab="Monthly salary (dollars)",
	main="Distribution of women mathematicians' salaries")
fit.dist(y, f, "log normal", delta=100, plot=TRUE, add=TRUE, lty=3)
fit.dist(y, f, "logistic", delta=100, exact=FALSE, plot=TRUE, add=TRUE, lty=2)

</code></pre>

<hr>
<h2 id='fmr'>Generalized Nonlinear Regression Models with Two or Three Point Mixtures</h2><span id='topic+fmr'></span>

<h3>Description</h3>

<p><code>fmr</code> fits user specified nonlinear regression equations to the
location parameter of the common one and two parameter distributions. (The
log of the scale parameter is estimated to ensure positivity.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmr(y = NULL, distribution = "normal", mu = NULL, mix = NULL,
  linear = NULL, pmu = NULL, pmix = NULL, pshape = NULL,
  censor = "right", exact = FALSE, wt = 1, delta = 1,
  common = FALSE, envir = parent.frame(), print.level = 0,
  typsize = abs(p), ndigit = 10, gradtol = 1e-05, stepmax = 10 *
  sqrt(p %*% p), steptol = 1e-05, iterlim = 100, fscale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fmr_+3A_y">y</code></td>
<td>
<p>A response vector for uncensored data, a two column matrix for
binomial data or censored data, with the second column being the censoring
indicator (1: uncensored, 0: right censored, -1: left censored), or an
object of class, <code>response</code> (created by <code><a href="rmutil.html#topic+restovec">restovec</a></code>)
or <code>repeated</code> (created by <code><a href="rmutil.html#topic+rmna">rmna</a></code> or
<code><a href="rmutil.html#topic+lvna">lvna</a></code>). If the <code>repeated</code> data object contains
more than one response variable, give that object in <code>envir</code> and give
the name of the response variable to be used here.</p>
</td></tr>
<tr><td><code id="fmr_+3A_distribution">distribution</code></td>
<td>
<p>Either a character string containing the name of the
distribution or a function giving the -log likelihood and calling the
location and mixture functions. Distributions are binomial, beta binomial,
double binomial, multiplicative binomial, Poisson, negative binomial, double
Poisson, multiplicative Poisson, gamma count, Consul, geometric, normal,
inverse Gauss, logistic, exponential, gamma, Weibull, extreme value, Pareto,
Cauchy, Student t, Laplace, and Levy. (For definitions of distributions, see
the corresponding [dpqr]distribution help.)</p>
</td></tr>
<tr><td><code id="fmr_+3A_mu">mu</code></td>
<td>
<p>A user-specified function of <code>pmu</code>, and possibly
<code>linear</code>, giving the regression equation for the location. This may
contain a linear part as the second argument to the function. It may also be
a formula beginning with ~, specifying either a linear regression function
for the location parameter in the Wilkinson and Rogers notation or a general
function with named unknown parameters. If it contains unknown parameters,
the keyword <code>linear</code> may be used to specify a linear part. If nothing
is supplied, the location is taken to be constant unless the linear argument
is given.</p>
</td></tr>
<tr><td><code id="fmr_+3A_mix">mix</code></td>
<td>
<p>A user-specified function of <code>pmix</code>, and possibly
<code>linear</code>, giving the regression equation for the mixture parameter.
This may contain a linear part as the second argument to the function. It
may also be a formula beginning with ~, specifying either a linear
regression function for the mixture parameter in the Wilkinson and Rogers
notation or a general function with named unknown parameters. If it contains
unknown parameters, the keyword <code>linear</code> may be used to specify a
linear part. If nothing is supplied, this parameter is taken to be constant.
This parameter is the logit of the mixture probability.</p>
</td></tr>
<tr><td><code id="fmr_+3A_linear">linear</code></td>
<td>
<p>A formula beginning with ~ in W&amp;R notation, or list of two
such expressions, specifying the linear part of the regression function for
the location or location and mixture parameters.</p>
</td></tr>
<tr><td><code id="fmr_+3A_pmu">pmu</code></td>
<td>
<p>Vector of initial estimates for the location parameters. If
<code>mu</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td></tr>
<tr><td><code id="fmr_+3A_pmix">pmix</code></td>
<td>
<p>Vector of initial estimates for the mixture parameters. If
<code>mix</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td></tr>
<tr><td><code id="fmr_+3A_pshape">pshape</code></td>
<td>
<p>An initial estimate for the shape parameter.</p>
</td></tr>
<tr><td><code id="fmr_+3A_censor">censor</code></td>
<td>
<p><code>right</code>, <code>left</code>, or <code>both</code> indicating where the
mixing distribution is placed. <code>both</code> is only possible for binomial
data.</p>
</td></tr>
<tr><td><code id="fmr_+3A_exact">exact</code></td>
<td>
<p>If TRUE, fits the exact likelihood function for continuous data
by integration over intervals of observation given in <code>delta</code>, i.e.
interval censoring.</p>
</td></tr>
<tr><td><code id="fmr_+3A_wt">wt</code></td>
<td>
<p>Weight vector.</p>
</td></tr>
<tr><td><code id="fmr_+3A_delta">delta</code></td>
<td>
<p>Scalar or vector giving the unit of measurement (always one for
discrete data) for each response value, set to unity by default - for
example, if a response is measured to two decimals, <code>delta=0.01</code>. If
the response is transformed, this must be multiplied by the Jacobian. The
transformation cannot contain unknown parameters. For example, with a log
transformation, <code>delta=1/y</code>.</p>
</td></tr>
<tr><td><code id="fmr_+3A_common">common</code></td>
<td>
<p>If TRUE, <code>mu</code> and <code>mix</code> must both be either
functions with, as argument, a vector of parameters having some or all
elements in common between them so that indexing is in common between them
or formulae with unknowns. All parameter estimates must be supplied in
<code>pmu</code>. If FALSE, parameters are distinct between the two functions and
indexing starts at one in each function.</p>
</td></tr>
<tr><td><code id="fmr_+3A_envir">envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td></tr>
<tr><td><code id="fmr_+3A_print.level">print.level</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="fmr_+3A_typsize">typsize</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="fmr_+3A_ndigit">ndigit</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="fmr_+3A_gradtol">gradtol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="fmr_+3A_stepmax">stepmax</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="fmr_+3A_steptol">steptol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="fmr_+3A_iterlim">iterlim</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="fmr_+3A_fscale">fscale</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the Poisson and related distributions, the mixture involves the zero
category. For the binomial and related distributions, it involves the two
extreme categories. For all other distributions, it involves either left or
right censored individuals. A user-specified -log likelihood can also be
supplied for the distribution.
</p>
<p>Nonlinear regression models can be supplied as formulae where parameters are
unknowns in which case factor variables cannot be used and parameters must
be scalars. (See <code><a href="rmutil.html#topic+finterp">finterp</a></code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the maximum likelihood estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class <code>gnlm</code> is returned that contains all of the
relevant information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code><a href="rmutil.html#topic+finterp">finterp</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>,
<code><a href="#topic+gnlr">gnlr</a></code>, <code><a href="#topic+gnlr3">gnlr3</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sex &lt;- c(rep(0,10),rep(1,10))
sexf &lt;- gl(2,10)
age &lt;- c(8,10,12,12,8,7,16,7,9,11,8,9,14,12,12,11,7,7,7,12)
y &lt;- cbind(c(9.2, 7.3,13.0, 6.9, 3.9,14.9,17.8, 4.8, 6.4, 3.3,17.2,
	14.4,17.0, 5.0,17.3, 3.8,19.4, 5.0, 2.0,19.0),
	c(0,1,0,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1))
# y &lt;- cbind(rweibull(20,2,2+2*sex+age),rbinom(20,1,0.7))
# log linear regression with Weibull distribution with a point mass
#   for right censored individuals
mu &lt;- function(p) exp(p[1]+p[2]*sex+p[3]*age)
fmr(y, dist="Weibull", mu=mu, pmu=c(4,0,0), pmix=0.5, pshape=1)
# or equivalently
fmr(y, dist="Weibull", mu=function(p,linear) exp(linear),
	linear=~sexf+age, pmu=c(4,0,0), pmix=0.5, pshape=1)
# or
fmr(y, dist="Weibull", mu=~exp(b0+b1*sex+b2*age), pmu=list(b0=4,b1=0,b2=0),
	pmix=0.5, pshape=1)
#
# include logistic regression for the mixture parameter
mix &lt;- function(p) p[1]+p[2]*sex
fmr(y, dist="Weibull", mu=~exp(a+b*age), mix=mix, pmu=c(4,0),
	pmix=c(10,0), pshape=0.5)
# or equivalently
fmr(y, dist="Weibull", mu=function(p,linear) exp(linear),
	linear=list(~age,~sexf), pmu=c(4,0), pmix=c(10,0), pshape=0.5)
# or
fmr(y, dist="Weibull", mu=~exp(b0+b1*age), mix=~c0+c1*sex,
	pmu=list(b0=4,b1=0), pmix=list(c0=10,c1=0), pshape=0.5)
#
# generate zero-inflated negative binomial data
x1 &lt;- rpois(50,4)
x2 &lt;- rpois(50,4)
ind &lt;- rbinom(50,1,1/(1+exp(-1-0.1*x1)))
y &lt;- ifelse(ind,rnbinom(50,3,mu=exp(1+0.2*x2)),0)
# standard Poisson models
gnlr(y, dist="Poisson", mu=~exp(a), pmu=1)
gnlr(y, dist="Poisson", mu=~exp(linear), linear=~x2, pmu=c(1,0.2))
# zero-inflated Poisson ZIP
fmr(y, dist="Poisson", mu=~exp(a), pmu=1, pmix=0)
fmr(y, dist="Poisson", mu=~exp(linear), linear=~x2, pmu=c(1,0.2), pmix=0)
fmr(y, dist="Poisson", mu=~exp(a), mix=~x1, pmu=1, pmix=c(1,0))
fmr(y, dist="Poisson", mu=~exp(linear), linear=~x2, mix=~x1, pmu=c(1,0.2),
	pmix=c(1,0))
# zero-inflated negative binomial
fmr(y, dist="negative binomial", mu=~exp(a), pmu=1, pshape=0, pmix=0)
fmr(y, dist="negative binomial", mu=~exp(linear), linear=~x2, pmu=c(1,0.2),
	pshape=0, pmix=0)
fmr(y, dist="negative binomial", mu=~exp(a), mix=~x1, pmu=1, pshape=0,
       pmix=c(1,0))
fmr(y, dist="negative binomial", mu=~exp(linear), linear=~x2, mix=~x1,
	pmu=c(1,0.2), pshape=0, pmix=c(1,0))

</code></pre>

<hr>
<h2 id='gnlr'>Generalized Nonlinear Regression Models for One and Two Parameter
Distributions</h2><span id='topic+gnlr'></span>

<h3>Description</h3>

<p><code>gnlr</code> fits user-specified nonlinear regression equations to one or
both parameters of the common one and two parameter distributions. A
user-specified -log likelihood can also be supplied for the distribution.
Most distributions allow data to be left, right, and/or interval censored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gnlr(y = NULL, distribution = "normal", pmu = NULL, pshape = NULL,
  mu = NULL, shape = NULL, linear = NULL, exact = FALSE, wt = 1,
  delta = 1, shfn = FALSE, common = FALSE, envir = parent.frame(),
  print.level = 0, typsize = abs(p), ndigit = 10, gradtol = 1e-05,
  stepmax = 10 * sqrt(p %*% p), steptol = 1e-05, iterlim = 100,
  fscale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gnlr_+3A_y">y</code></td>
<td>
<p>A response vector for uncensored data, a two column matrix for
binomial data or censored data, with the second column being the censoring
indicator (1: uncensored, 0: right censored, -1: left censored), or an
object of class, <code>response</code> (created by <code><a href="rmutil.html#topic+restovec">restovec</a></code>)
or <code>repeated</code> (created by <code><a href="rmutil.html#topic+rmna">rmna</a></code> or
<code><a href="rmutil.html#topic+lvna">lvna</a></code>). If the <code>repeated</code> data object contains
more than one response variable, give that object in <code>envir</code> and give
the name of the response variable to be used here. The beta, simplex, and
two-sided power distributions for proportions do not allow left or right
censoring (only interval censoring).</p>
</td></tr>
<tr><td><code id="gnlr_+3A_distribution">distribution</code></td>
<td>
<p>Either a character string containing the name of the
distribution or a function giving the -log likelihood. (In the latter case,
all initial parameter estimates are supplied in <code>pmu</code>.)
</p>
<p>Distributions are binomial, beta binomial, double binomial, mult(iplicative)
binomial, Poisson, negative binomial, double Poisson, mult(iplicative)
Poisson, gamma count, Consul generalized Poisson, logarithmic series,
geometric, normal, inverse Gauss, logistic, exponential, gamma, Weibull,
extreme value, Cauchy, Pareto, Laplace, Levy, beta, simplex, and two-sided
power. All but the binomial-based distributions and the beta, simplex, and
two-sided power distributions may be right and/or left censored. (For
definitions of distributions, see the corresponding [dpqr]distribution
help.)</p>
</td></tr>
<tr><td><code id="gnlr_+3A_pmu">pmu</code></td>
<td>
<p>Vector of initial estimates for the location parameters. If
<code>mu</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list. If <code>distribution</code> is a user-supplied -log likelihood function,
all initial estimates must be supplied here.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_pshape">pshape</code></td>
<td>
<p>Vector of initial estimates for the shape parameters. If
<code>shape</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_mu">mu</code></td>
<td>
<p>A user-specified function of <code>pmu</code>, and possibly
<code>linear</code>, giving the regression equation for the location. This may
contain a linear part as the second argument to the function. It may also be
a formula beginning with ~, specifying either a linear regression function
for the location parameter in the Wilkinson and Rogers notation or a general
function with named unknown parameters. If it contains unknown parameters,
the keyword <code>linear</code> may be used to specify a linear part. If nothing
is supplied, the location is taken to be constant unless the linear argument
is given.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_shape">shape</code></td>
<td>
<p>A user-specified function of <code>pshape</code>, and possibly
<code>linear</code> and/or <code>mu</code>, giving the regression equation for the
dispersion or shape parameter. This may contain a linear part as the second
argument to the function and the location function as last argument (in
which case <code>shfn</code> must be set to TRUE). It may also be a formula
beginning with ~, specifying either a linear regression function for the
shape parameter in the Wilkinson and Rogers notation or a general function
with named unknown parameters. If it contains unknown parameters, the
keyword <code>linear</code> may be used to specify a linear part and the keyword
<code>mu</code> to specify a function of the location parameter. If nothing is
supplied, this parameter is taken to be constant unless the linear argument
is given. This parameter is the logarithm of the usual one.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_linear">linear</code></td>
<td>
<p>A formula beginning with ~ in W&amp;R notation, specifying the
linear part of the regression function for the location parameter or list of
two such expressions for the location and/or shape parameters.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_exact">exact</code></td>
<td>
<p>If TRUE, fits the exact likelihood function for continuous data
by integration over intervals of observation given in <code>delta</code>, i.e.
interval censoring.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_wt">wt</code></td>
<td>
<p>Weight vector.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_delta">delta</code></td>
<td>
<p>Scalar or vector giving the unit of measurement (always one for
discrete data) for each response value, set to unity by default. For
example, if a response is measured to two decimals, <code>delta=0.01</code>. If
the response is transformed, this must be multiplied by the Jacobian. The
transformation cannot contain unknown parameters. For example, with a log
transformation, <code>delta=1/y</code>. (The delta values for the censored
response are ignored.)</p>
</td></tr>
<tr><td><code id="gnlr_+3A_shfn">shfn</code></td>
<td>
<p>If true, the supplied shape function depends on the location
(function). The name of this location function must be the last argument of
the shape function.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_common">common</code></td>
<td>
<p>If TRUE, <code>mu</code> and <code>shape</code> must both be either
functions with, as argument, a vector of parameters having some or all
elements in common between them so that indexing is in common between them
or formulae with unknowns. All parameter estimates must be supplied in
<code>pmu</code>. If FALSE, parameters are distinct between the two functions and
indexing starts at one in each function.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_envir">envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_print.level">print.level</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_typsize">typsize</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_ndigit">ndigit</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_gradtol">gradtol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_stepmax">stepmax</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_steptol">steptol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_iterlim">iterlim</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr_+3A_fscale">fscale</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nonlinear regression models can be supplied as formulae where parameters are
unknowns in which case factor variables cannot be used and parameters must
be scalars. (See <code><a href="rmutil.html#topic+finterp">finterp</a></code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the maximum likelihood estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class <code>gnlm</code> is returned that contains all of the
relevant information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code><a href="rmutil.html#topic+finterp">finterp</a></code>, <code><a href="#topic+fmr">fmr</a></code>,
<code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="repeated.html#topic+gnlmix">gnlmix</a></code>,
<code><a href="repeated.html#topic+glmm">glmm</a></code>, <code><a href="repeated.html#topic+gnlmm">gnlmm</a></code>,
<code><a href="#topic+gnlr3">gnlr3</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="#topic+nlr">nlr</a></code>,
<code><a href="stats.html#topic+nls">nls</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sex &lt;- c(rep(0,10),rep(1,10))
sexf &lt;- gl(2,10)
age &lt;- c(8,10,12,12,8,7,16,7,9,11,8,9,14,12,12,11,7,7,7,12)
y &lt;- cbind(c(9.2, 7.3,13.0, 6.9, 3.9,14.9,17.8, 4.8, 6.4, 3.3,17.2,
	14.4,17.0, 5.0,17.3, 3.8,19.4, 5.0, 2.0,19.0),
	c(0,1,0,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1))
# y &lt;- cbind(rweibull(20,2,2+2*sex+age),rbinom(20,1,0.7))
# linear regression with inverse Gauss distribution
mu &lt;- function(p) p[1]+p[2]*sex+p[3]*age
gnlr(y, dist="inverse Gauss", mu=mu, pmu=c(3,0,0), pshape=1)
# or equivalently
gnlr(y, dist="inverse Gauss", mu=~sexf+age, pmu=c(3,0,0), pshape=1)
# or
gnlr(y, dist="inverse Gauss", linear=~sexf+age, pmu=c(3,0,0), pshape=1)
# or
gnlr(y, dist="inverse Gauss", mu=~b0+b1*sex+b2*age,
	pmu=list(b0=3,b1=0,b2=0), pshape=1)
#
# nonlinear regression with inverse Gauss distribution
mu &lt;- function(p, linear) exp(linear)
gnlr(y, dist="inverse Gauss", mu=mu, linear=~sexf+age, pmu=c(3,0,0),
	pshape=-1)
# or equivalently
gnlr(y, dist="inverse Gauss", mu=~exp(b0+b1*sex+b2*age),
	pmu=list(b0=3,b1=0,b2=0), pshape=-1)
# or
gnlr(y, dist="inverse Gauss", mu=~exp(linear), linear=~sexf+age,
	pmu=c(3,0,0), pshape=-1)
#
# include regression for the shape parameter with same mu function
shape &lt;- function(p) p[1]+p[2]*sex+p[3]*age
gnlr(y, dist="inverse Gauss", mu=mu, linear=~sexf+age, shape=shape,
	pmu=c(3,0,0), pshape=c(3,0,0))
# or equivalently
gnlr(y, dist="inverse Gauss", mu=mu, linear=~sexf+age,
	shape=~sexf+age, pmu=c(3,0,0), pshape=c(3,0,0))
# or
gnlr(y, dist="inverse Gauss", mu=mu, linear=list(~sex+age,~sex+age),
	pmu=c(3,0,0),pshape=c(3,0,0))
# or
gnlr(y, dist="inverse Gauss", mu=mu, linear=~sex+age,
	shape=~c0+c1*sex+c2*age, pmu=c(3,0,0),
	pshape=list(c0=3,c1=0,c2=0))
#
# shape as a function of the location
shape &lt;- function(p, mu) p[1]+p[2]*sex+p[3]*mu
gnlr(y, dist="inverse Gauss", mu=~age, shape=shape, pmu=c(3,0),
	pshape=c(3,0,0), shfn=TRUE)
# or
gnlr(y, dist="inverse Gauss", mu=~age, shape=~a+b*sex+c*mu, pmu=c(3,0),
	pshape=c(3,0,0), shfn=TRUE)
#
# common parameter in location and shape functions for age
mu &lt;- function(p) exp(p[1]+p[2]*age)
shape &lt;- function(p, mu) p[3]+p[4]*sex+p[2]*age
gnlr(y, dist="inverse Gauss", mu=mu, shape=shape, pmu=c(3,0,1,0),
	common=TRUE)
# or
gnlr(y, dist="inverse Gauss", mu=~exp(a+b*age), shape=~c+d*sex+b*age,
	pmu=c(3,0,1,0), common=TRUE)
#
# user-supplied -log likelihood function
y &lt;- rnorm(20,2+3*sex,2)
dist &lt;- function(p)-sum(dnorm(y,p[1]+p[2]*sex,p[3],log=TRUE))
gnlr(y, dist=dist,pmu=1:3)
dist &lt;- ~-sum(dnorm(y,a+b*sex,v,log=TRUE))
gnlr(y, dist=dist,pmu=1:3)

</code></pre>

<hr>
<h2 id='gnlr3'>Generalized Nonlinear Regression Models for Three Parameter Distributions</h2><span id='topic+gnlr3'></span>

<h3>Description</h3>

<p><code>gnlr3</code> fits user specified nonlinear regression equations to one, two,
or all three parameters of three parameter distributions. Continuous data
may be left, right, and/or interval censored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gnlr3(y = NULL, distribution = "normal", mu = NULL, shape = NULL,
  family = NULL, linear = NULL, pmu = NULL, pshape = NULL,
  pfamily = NULL, exact = FALSE, wt = 1, common = FALSE,
  delta = 1, envir = parent.frame(), print.level = 0,
  typsize = abs(p), ndigit = 10, gradtol = 1e-05, stepmax = 10 *
  sqrt(p %*% p), steptol = 1e-05, iterlim = 100, fscale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gnlr3_+3A_y">y</code></td>
<td>
<p>The response vector for uncensored data, two columns for censored
data, with the second being the censoring indicator (1: uncensored, 0: right
censored, -1: left censored.), or an object of class, <code>response</code>
(created by <code><a href="rmutil.html#topic+restovec">restovec</a></code>) or <code>repeated</code> (created by
<code><a href="rmutil.html#topic+rmna">rmna</a></code> or <code><a href="rmutil.html#topic+lvna">lvna</a></code>). If the
<code>repeated</code> data object contains more than one response variable, give
that object in <code>envir</code> and give the name of the response variable to be
used here.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_distribution">distribution</code></td>
<td>
<p>Either a character string containing the name of the
distribution or a function giving the -log likelihood and calling the
location, shape, and family functions. Distributions are Box-Cox transformed
normal, generalized inverse Gauss, generalized logistic, Hjorth, generalized
gamma, Burr, generalized Weibull, power exponential, Student t, generalized
extreme value, power variance function Poisson, and skew Laplace. (For
definitions of distributions, see the corresponding [dpqr]distribution
help.)</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_mu">mu</code></td>
<td>
<p>A user-specified function of <code>pmu</code>, and possibly
<code>linear</code>, giving the regression equation for the location. This may
contain a linear part as the second argument to the function. It may also be
a formula beginning with ~, specifying either a linear regression function
for the location parameter in the Wilkinson and Rogers notation or a general
function with named unknown parameters. If it contains unknown parameters,
the keyword <code>linear</code> may be used to specify a linear part. If nothing
is supplied, the location is taken to be constant unless the linear argument
is given.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_shape">shape</code></td>
<td>
<p>A user-specified function of <code>pshape</code>, and possibly
<code>linear</code>, giving the regression equation for the dispersion or shape
parameter. This may contain a linear part as the second argument to the
function. It may also be a formula beginning with ~, specifying either a
linear regression function for the shape parameter in the Wilkinson and
Rogers notation or a general function with named unknown parameters. If it
contains unknown parameters, the keyword <code>linear</code> may be used to
specify a linear part. If nothing is supplied, this parameter is taken to be
constant unless the linear argument is given. This parameter is the
logarithm of the usual one.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_family">family</code></td>
<td>
<p>A user-specified function of <code>pfamily</code>, and possibly
<code>linear</code>, for the regression equation of the third (family) parameter
of the distribution. This may contain a linear part that is the second
argument to the function. It may also be a formula beginning with ~,
specifying either a linear regression function for the family parameter in
the Wilkinson and Rogers notation or a general function with named unknown
parameters. If neither is supplied, this parameter is taken to be constant
unless the linear argument is given. In most cases, this parameter is the
logarithm of the usual one.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_linear">linear</code></td>
<td>
<p>A formula beginning with ~ in W&amp;R notation, specifying the
linear part of the regression function for the location parameters or list
of three such expressions for the location, shape, and/or family parameters.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_pmu">pmu</code></td>
<td>
<p>Vector of initial estimates for the location parameters. If
<code>mu</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_pshape">pshape</code></td>
<td>
<p>Vector of initial estimates for the shape parameters. If
<code>shape</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_pfamily">pfamily</code></td>
<td>
<p>Vector of initial estimates for the family parameters. If
<code>family</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_exact">exact</code></td>
<td>
<p>If TRUE, fits the exact likelihood function for continuous data
by integration over intervals of observation given in <code>delta</code>, i.e.
interval censoring.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_wt">wt</code></td>
<td>
<p>Weight vector.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_common">common</code></td>
<td>
<p>If TRUE, at least two of <code>mu</code>, <code>shape</code>, and
<code>family</code> must both be either functions with, as argument, a vector of
parameters having some or all elements in common between them so that
indexing is in common between them or formulae with unknowns. All parameter
estimates must be supplied in <code>pmu</code>. If FALSE, parameters are distinct
between the two functions and indexing starts at one in each function.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_delta">delta</code></td>
<td>
<p>Scalar or vector giving the unit of measurement (always one for
discrete data) for each response value, set to unity by default - for
example, if a response is measured to two decimals, <code>delta=0.01</code>. If
the response is transformed, this must be multiplied by the Jacobian. The
transformation cannot contain unknown parameters. For example, with a log
transformation, <code>delta=1/y</code>. (The delta values for the censored
response are ignored.)</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_envir">envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_print.level">print.level</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_typsize">typsize</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_ndigit">ndigit</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_gradtol">gradtol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_stepmax">stepmax</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_steptol">steptol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_iterlim">iterlim</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="gnlr3_+3A_fscale">fscale</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nonlinear regression models can be supplied as formulae where parameters are
unknowns in which case factor variables cannot be used and parameters must
be scalars. (See <code><a href="rmutil.html#topic+finterp">finterp</a></code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the maximum likelihood estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class <code>gnlm</code> is returned that contains all of the
relevant information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code><a href="rmutil.html#topic+finterp">finterp</a></code>, <code><a href="#topic+fmr">fmr</a></code>,
<code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+gnlr">gnlr</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>,
<code><a href="#topic+nlr">nlr</a></code>, <code><a href="stats.html#topic+nls">nls</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sex &lt;- c(rep(0,10),rep(1,10))
sexf &lt;- gl(2,10)
age &lt;- c(8,10,12,12,8,7,16,7,9,11,8,9,14,12,12,11,7,7,7,12)
y &lt;- cbind(c(9.2, 7.3,13.0, 6.9, 3.9,14.9,17.8, 4.8, 6.4, 3.3,17.2,
	14.4,17.0, 5.0,17.3, 3.8,19.4, 5.0, 2.0,19.0),
	c(0,1,0,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1))
# y &lt;- cbind(rweibull(20,2,2+2*sex+age),rbinom(20,1,0.7))
# log linear regression with the generalized Weibull distribution
mu &lt;- function(p) exp(p[1]+p[2]*sex+p[3]*age)
gnlr3(y, dist="Weibull", mu=mu, pmu=c(3,1,0), pshape=2, pfamily=-2)
# or equivalently
mu1 &lt;- function(p,linear) exp(linear)
gnlr3(y, dist="Weibull", mu=mu1, linear=~sex+age, pmu=c(3,1,0),
	pshape=2, pfamily=-2)
# or
gnlr3(y, dist="Weibull", mu=~exp(b0+b1*sex+b2*age),
	pmu=list(b0=3,b1=1,b2=0), pshape=2, pfamily=-2)
#
# include regression for the shape parameter with same mu function
shape &lt;- function(p) p[1]+p[2]*sex+p[3]*age
gnlr3(y, dist="Weibull", mu=mu, shape=shape,
	pmu=c(3,1,0), pshape=c(2,0,0), pfamily=-2)
# or equivalently
gnlr3(y, dist="Weibull", mu=mu1, linear=list(~sexf+age,~sex+age,NULL),
	pmu=c(3,1,0), pshape=c(2,0,0), pfamily=-2)
# or
gnlr3(y, dist="Weibull", mu=~exp(b0+b1*sex+b2*age),
	shape=~c0+c1*sex+c2*age, pmu=c(3,1,0),
	pshape=list(c0=2,c1=0,c2=0), pfamily=-2)
# include regression for the family parameter with same mu
# and shape functions
family &lt;- function(p) p[1]+p[2]*sex+p[3]*age
gnlr3(y, dist="Weibull", mu=mu1, linear=~sexf+age, shape=shape,
	family=family, pmu=c(2.5,1,0), pshape=c(2,0,0), pfamily=c(-2,0,0))
# or equivalently
gnlr3(y, dist="Weibull", mu=mu1, linear=list(~sex+age,~sex+age,~sex+age),
	pmu=c(2.5,1,0), pshape=c(2,0,0), pfamily=c(-2,0,0))
# or
gnlr3(y, dist="Weibull", mu=~exp(b0+b1*sex+b2*age),
	shape=~c0+c1*sex+c2*age, family=~d0+d1*sex+d2*age,
	pmu=list(b0=2.5,b1=1,b2=0), pshape=list(c0=2,c1=0,c2=0),
	pfamily=list(d0=-2,d1=0,d2=0))
#
# common parameters
mu &lt;- function(p) exp(p[1]+p[2]*sex+p[3]*age)
shape &lt;- function(p) p[4]+p[5]*sex+p[3]*age
family &lt;- function(p) p[6]+p[7]*sex+p[3]*age
gnlr3(y, dist="Weibull", mu=mu, shape=shape, family=family,
	pmu=c(2.5,1,0,1,0,1,0), common=TRUE)
# or
gnlr3(y, dist="Weibull", mu=~exp(a+b*sex+c*age), shape=~d+e*sex+c*age,
	family=~f+g*sex+c*age, pmu=c(2.5,1,0,1,0,1,0), common=TRUE)

</code></pre>

<hr>
<h2 id='nlr'>Nonlinear Normal, Gamma, and Inverse Gaussian Regression Models</h2><span id='topic+nlr'></span>

<h3>Description</h3>

<p><code>nlr</code> fits a user-specified nonlinear regression equation by least
squares (normal) or its generalization for the gamma and inverse Gauss
distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlr(y = NULL, mu = NULL, pmu = NULL, distribution = "normal",
  wt = 1, delta = 1, envir = parent.frame(), print.level = 0,
  typsize = abs(pmu), ndigit = 10, gradtol = 1e-05, stepmax = 10 *
  sqrt(pmu %*% pmu), steptol = 1e-05, iterlim = 100, fscale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlr_+3A_y">y</code></td>
<td>
<p>The response vector or an object of class, <code>response</code> (created
by <code><a href="rmutil.html#topic+restovec">restovec</a></code>) or <code>repeated</code> (created by
<code><a href="rmutil.html#topic+rmna">rmna</a></code> or <code><a href="rmutil.html#topic+lvna">lvna</a></code>).</p>
</td></tr>
<tr><td><code id="nlr_+3A_mu">mu</code></td>
<td>
<p>A function of <code>p</code> giving the regression equation for the mean
or a formula beginning with ~, specifying either a linear regression
function in the Wilkinson and Rogers notation or a general nonlinear
function with named unknown parameters.</p>
</td></tr>
<tr><td><code id="nlr_+3A_pmu">pmu</code></td>
<td>
<p>Vector of initial estimates of the parameters. If <code>mu</code> is a
formula with unknown parameters, their estimates must be supplied either in
their order of appearance in the expression or in a named list.</p>
</td></tr>
<tr><td><code id="nlr_+3A_distribution">distribution</code></td>
<td>
<p>The distribution to be used: normal, gamma, or inverse
Gauss.</p>
</td></tr>
<tr><td><code id="nlr_+3A_wt">wt</code></td>
<td>
<p>Weight vector.</p>
</td></tr>
<tr><td><code id="nlr_+3A_delta">delta</code></td>
<td>
<p>Scalar or vector giving the unit of measurement for each
response value, set to unity by default. For example, if a response is
measured to two decimals, <code>delta=0.01</code>. If the response is transformed,
this must be multiplied by the Jacobian. For example, with a log
transformation, <code>delta=1/y</code>.</p>
</td></tr>
<tr><td><code id="nlr_+3A_envir">envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>. If
<code>y</code> has class <code>repeated</code>, it is used as the environment.</p>
</td></tr>
<tr><td><code id="nlr_+3A_print.level">print.level</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nlr_+3A_typsize">typsize</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nlr_+3A_ndigit">ndigit</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nlr_+3A_gradtol">gradtol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nlr_+3A_stepmax">stepmax</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nlr_+3A_steptol">steptol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nlr_+3A_iterlim">iterlim</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nlr_+3A_fscale">fscale</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A nonlinear regression model can be supplied as a formula where parameters
are unknowns in which case factor variables cannot be used and parameters
must be scalars. (See <code><a href="rmutil.html#topic+finterp">finterp</a></code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the parameter estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class <code>nlr</code> is returned that contains all of the
relevant information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code><a href="rmutil.html#topic+finterp">finterp</a></code>, <code><a href="#topic+fmr">fmr</a></code>,
<code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="repeated.html#topic+glmm">glmm</a></code>,
<code><a href="repeated.html#topic+gnlmm">gnlmm</a></code>, <code><a href="#topic+gnlr">gnlr</a></code>,
<code><a href="#topic+gnlr3">gnlr3</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+nls">nls</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- c(3,5,0,0,0,3,2,2,2,7,4,0,0,2,2,2,0,1,3,4)
y &lt;- c(5.8,11.6,2.2,2.7,2.3,9.4,11.7,3.3,1.5,14.6,9.6,7.4,10.7,6.9,
	2.6,17.3,2.8,1.2,1.0,3.6)
# rgamma(20,2,scale=0.2+2*exp(0.1*x))
# linear least squares regression
mu1 &lt;- function(p) p[1]+p[2]*x
summary(lm(y~x))
nlr(y, mu=mu1, pmu=c(3,0))
# or
nlr(y, mu=~x, pmu=c(3,0))
# or
nlr(y, mu=~b0+b1*x, pmu=c(3,0))
# linear gamma regression
nlr(y, dist="gamma", mu=~x, pmu=c(3,0))
# nonlinear regression
mu2 &lt;- function(p) p[1]+p[2]*exp(p[3]*x)
nlr(y, mu=mu2, pmu=c(0.2,3,0.2))
# or
nlr(y, mu=~b0+c0*exp(c1*x), pmu=list(b0=0.2,c0=3,c1=0.2))
# with gamma distribution
nlr(y, dist="gamma", mu=~b0+c0*exp(c1*x), pmu=list(b0=0.2,c0=3,c1=0.2))

</code></pre>

<hr>
<h2 id='nordr'>Nonlinear Ordinal Regression Models</h2><span id='topic+nordr'></span>

<h3>Description</h3>

<p><code>nordr</code> fits arbitrary nonlinear regression functions (with logistic
link) to ordinal response data by proportional odds, continuation ratio, or
adjacent categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nordr(y = NULL, distribution = "proportional", mu = NULL,
  linear = NULL, pmu = NULL, pintercept = NULL, weights = NULL,
  envir = parent.frame(), print.level = 0, ndigit = 10,
  gradtol = 1e-05, steptol = 1e-05, fscale = 1, iterlim = 100,
  typsize = abs(p), stepmax = 10 * sqrt(p %*% p))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nordr_+3A_y">y</code></td>
<td>
<p>A vector of ordinal responses, integers numbered from zero to one
less than the number of categories or an object of class, <code>response</code>
(created by <code><a href="rmutil.html#topic+restovec">restovec</a></code>) or <code>repeated</code> (created by
<code><a href="rmutil.html#topic+rmna">rmna</a></code>) or <code><a href="rmutil.html#topic+lvna">lvna</a></code>). If the
<code>repeated</code> data object contains more than one response variable, give
that object in <code>envir</code> and give the name of the response variable to be
used here.</p>
</td></tr>
<tr><td><code id="nordr_+3A_distribution">distribution</code></td>
<td>
<p>The ordinal distribution: proportional odds,
continuation ratio, or adjacent categories.</p>
</td></tr>
<tr><td><code id="nordr_+3A_mu">mu</code></td>
<td>
<p>User-specified function of <code>pmu</code>, and possibly <code>linear</code>,
giving the logistic regression equation. This must contain the first
intercept. It may contain a linear part as the second argument to the
function. It may also be a formula beginning with ~, specifying a logistic
regression function for the location parameter, either a linear one using
the Wilkinson and Rogers notation or a general function with named unknown
parameters. If it contains unknown parameters, the keyword <code>linear</code> may
be used to specify a linear part. If nothing is supplied, the location is
taken to be constant unless the linear argument is given.</p>
</td></tr>
<tr><td><code id="nordr_+3A_linear">linear</code></td>
<td>
<p>A formula beginning with ~ in W&amp;R notation, specifying the
linear part of the logistic regression function.</p>
</td></tr>
<tr><td><code id="nordr_+3A_pmu">pmu</code></td>
<td>
<p>Vector of initial estimates for the regression parameters,
including the first intercept. If <code>mu</code> is a formula with unknown
parameters, their estimates must be supplied either in their order of
appearance in the expression or in a named list.</p>
</td></tr>
<tr><td><code id="nordr_+3A_pintercept">pintercept</code></td>
<td>
<p>Vector of initial estimates for the contrasts with the
first intercept parameter (difference in intercept for successive
categories): two less than the number of different ordinal values.</p>
</td></tr>
<tr><td><code id="nordr_+3A_weights">weights</code></td>
<td>
<p>Weight vector for use with contingency tables.</p>
</td></tr>
<tr><td><code id="nordr_+3A_envir">envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td></tr>
<tr><td><code id="nordr_+3A_print.level">print.level</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nordr_+3A_ndigit">ndigit</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nordr_+3A_gradtol">gradtol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nordr_+3A_steptol">steptol</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nordr_+3A_fscale">fscale</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nordr_+3A_iterlim">iterlim</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nordr_+3A_typsize">typsize</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="nordr_+3A_stepmax">stepmax</code></td>
<td>
<p>Arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nonlinear regression models can be supplied as formulae where parameters are
unknowns in which case factor variables cannot be used and parameters must
be scalars. (See <code><a href="rmutil.html#topic+finterp">finterp</a></code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the maximum likelihood estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class nordr is returned that contains all of the relevant
information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code><a href="rmutil.html#topic+finterp">finterp</a></code>, <code><a href="#topic+fmr">fmr</a></code>,
<code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="repeated.html#topic+glmm">glmm</a></code>,
<code><a href="repeated.html#topic+gnlmm">gnlmm</a></code>, <code><a href="#topic+gnlr">gnlr</a></code>,
<code><a href="#topic+gnlr3">gnlr3</a></code>, <code><a href="#topic+nlr">nlr</a></code>,
<code><a href="#topic+ordglm">ordglm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# McCullagh (1980) JRSS B42, 109-142
# tonsil size: 2x3 contingency table
y &lt;- c(0:2,0:2)
carrier &lt;- c(rep(0,3),rep(1,3))
carrierf &lt;- gl(2,3,6)
wt &lt;- c(19,29,24,
	497,560,269)
pmu &lt;- c(-1,0.5)
mu &lt;- function(p) c(rep(p[1],3),rep(p[1]+p[2],3))
# proportional odds
# with mean function
nordr(y, dist="prop", mu=mu, pmu=pmu, weights=wt, pintercept=1.5)
# using Wilkinson and Rogers notation
nordr(y, dist="prop", mu=~carrierf, pmu=pmu, weights=wt, pintercept=1.5)
# using formula with unknowns
nordr(y, dist="prop", mu=~b0+b1*carrier, pmu=pmu, weights=wt, pintercept=1.5)
# continuation ratio
nordr(y, dist="cont", mu=mu, pmu=pmu, weights=wt, pintercept=1.5)
# adjacent categories
nordr(y, dist="adj", mu=~carrierf, pmu=pmu, weights=wt, pintercept=1.5)
#
# Haberman (1974) Biometrics 30, 589-600
# institutionalized schizophrenics: 3x3 contingency table
y &lt;- rep(0:2,3)
fr &lt;- c(43,6,9,
	16,11,18,
	3,10,16)
length &lt;- gl(3,3)
## Not run: 
# fit continuation ratio model with nordr and as a logistic model
nordr(y, mu=~length, weights=fr, pmu=c(0,-1.4,-2.3), pint=0.13,
	dist="cont")
	
## End(Not run)
# logistic regression with reconstructed table
frcr &lt;- cbind(c(43,16,3,49,27,13),c(6,11,10,9,18,16))
lengthord &lt;- gl(3,1,6)
block &lt;- gl(2,3)
summary(glm(frcr~lengthord+block,fam=binomial))
# note that AICs and deviances are different

</code></pre>

<hr>
<h2 id='ordglm'>Generalized Linear Ordinal Regression Models</h2><span id='topic+ordglm'></span>

<h3>Description</h3>

<p><code>ordglm</code> fits linear regression functions with logistic or probit link
to ordinal response data by proportional odds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordglm(formula, data = parent.frame(), link = "logit", maxiter = 10,
  weights = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ordglm_+3A_formula">formula</code></td>
<td>
<p>A model formula. The response must be integers numbered from
zero to one less than the number of ordered categories.</p>
</td></tr>
<tr><td><code id="ordglm_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="ordglm_+3A_link">link</code></td>
<td>
<p>Logit or probit link function.</p>
</td></tr>
<tr><td><code id="ordglm_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed.</p>
</td></tr>
<tr><td><code id="ordglm_+3A_weights">weights</code></td>
<td>
<p>A vector containing the frequencies for grouped data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class ordglm is returned. The printed output includes the
-log likelihood, the corresponding AIC, the deviance, the maximum likelihood
estimates, standard errors, and correlations.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey, adapted and heavily modified from Matlab code
(ordinalMLE) by J.H. Albert.
</p>


<h3>References</h3>

<p>Jansen, J. (1991) Fitting regression models to ordinal data.
Biometrical Journal 33, 807-815.
</p>
<p>Johnson, V.E. and Albert, J.H. (1999) Ordinal Data Modeling.
Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+nordr">nordr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# McCullagh (1980) JRSS B42, 109-142
# tonsil size: 2x3 contingency table
y &lt;- c(0:2,0:2)
carrier &lt;- gl(2,3,6)
wt &lt;- c(19,29,24,497,560,269)
ordglm(y~carrier, weights=wt)

</code></pre>

<hr>
<h2 id='rs2'>Two-factor Box-Tidwell Nonlinear Response Surface Models</h2><span id='topic+rs2'></span>

<h3>Description</h3>

<p><code>rs2</code> fits a two-covariate power-transformed response surface by
iterating the function, <code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs2(y, x1, x2, power = c(1, 1), weight = rep(1, length(x1)),
  family = gaussian, iterlim = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs2_+3A_y">y</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="rs2_+3A_x1">x1</code></td>
<td>
<p>First covariate</p>
</td></tr>
<tr><td><code id="rs2_+3A_x2">x2</code></td>
<td>
<p>Second covariate</p>
</td></tr>
<tr><td><code id="rs2_+3A_power">power</code></td>
<td>
<p>Initial estimates of the two power transformations</p>
</td></tr>
<tr><td><code id="rs2_+3A_weight">weight</code></td>
<td>
<p>Weight vector</p>
</td></tr>
<tr><td><code id="rs2_+3A_family">family</code></td>
<td>
<p>glm family</p>
</td></tr>
<tr><td><code id="rs2_+3A_iterlim">iterlim</code></td>
<td>
<p>Iteration limit</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class, <code>rs</code>, is returned containing the model and the
power estimates.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+gnlr">gnlr</a></code>,
<code><a href="#topic+gnlr3">gnlr3</a></code>, <code><a href="#topic+rs3">rs3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x1 &lt;- rep(1:4,5)
x2 &lt;- rep(1:5,rep(4,5))
y &lt;- rpois(20,1+2*sqrt(x1)+3*log(x2)+4*x1+log(x2)^2+2*sqrt(x1)*log(x2))
rs2(y, x1, x2, family=poisson)

</code></pre>

<hr>
<h2 id='rs3'>Three-factor Box-Tidwell Nonlinear Response Surface Models</h2><span id='topic+rs3'></span>

<h3>Description</h3>

<p><code>rs3</code> fits a three-covariate power-transformed response surface by
iterating the function, <code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs3(y, x1, x2, x3, power = c(1, 1, 1), weight = rep(1, length(x1)),
  family = gaussian, iterlim = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs3_+3A_y">y</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="rs3_+3A_x1">x1</code></td>
<td>
<p>First covariate</p>
</td></tr>
<tr><td><code id="rs3_+3A_x2">x2</code></td>
<td>
<p>Second covariate</p>
</td></tr>
<tr><td><code id="rs3_+3A_x3">x3</code></td>
<td>
<p>Third covariate</p>
</td></tr>
<tr><td><code id="rs3_+3A_power">power</code></td>
<td>
<p>Initial estimates of the three power transformations</p>
</td></tr>
<tr><td><code id="rs3_+3A_weight">weight</code></td>
<td>
<p>Weight vector</p>
</td></tr>
<tr><td><code id="rs3_+3A_family">family</code></td>
<td>
<p>glm family</p>
</td></tr>
<tr><td><code id="rs3_+3A_iterlim">iterlim</code></td>
<td>
<p>Iteration limit</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class, <code>rs</code>, is returned containing the model and the
power estimates.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+gnlr">gnlr</a></code>,
<code><a href="#topic+gnlr3">gnlr3</a></code>, <code><a href="#topic+rs2">rs2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x1 &lt;- rep(1:4,5)
x2 &lt;- rep(1:5,rep(4,5))
x3 &lt;- c(rep(1:3,6),1,2)
#y &lt;- rpois(20,1+2*sqrt(x1)+3*log(x2)+1/x3+4*x1+log(x2)^2+1/x3^2+
#	2*sqrt(x1)*log(x2)+sqrt(x1)/x3+log(x2)/x3)
y &lt;- c(9,11,14,33,11,19,20,27,22,32,24,24,20,28,25,41,26,31,37,34)
rs3(y, x1, x2, x3, family=poisson)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
