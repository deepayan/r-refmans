<!DOCTYPE html><html lang="en-US"><head><title>Help for package VisCov</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VisCov}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#panelSelect'><p>Selecting a Panel(s) using the Mouse</p></a></li>
<li><a href='#panelSelectCorr'><p>Selecting a Panel(s) using the Mouse</p></a></li>
<li><a href='#panelSelectMultiple'><p>Selecting Panels From Several Distributions</p></a></li>
<li><a href='#VisCov'><p>Visualizing of Distributions of Covariance Matrices</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Visualizing of Distributions of Covariance Matrices</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kristof Meers &lt;kristof.meers+cran@kuleuven.be&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.12.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>bayesm, clusterGeneration, scatterplot3d, KernSmooth, trialr,
methods</td>
</tr>
<tr>
<td>Description:</td>
<td>Visualizing of distributions of covariance matrices.
    The package implements the methodology described in Tokuda, T., Goodrich, B., Van Mechelen, I., Gelman, A., &amp; Tuerlinckx, F. (2012) <a href="https://stat.columbia.edu/~gelman/research/unpublished/Visualization.pdf">https://stat.columbia.edu/~gelman/research/unpublished/Visualization.pdf</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-04 11:41:47 UTC; u0046811</td>
</tr>
<tr>
<td>Author:</td>
<td>Tomoki Tokuda [aut],
  Ben Goodrich [ctb],
  Iven Van Mechelen [ctb],
  Andrew Gelman [ctb],
  Francis Tuerlinckx [ctb],
  Kristof Meers [cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-04 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='panelSelect'>Selecting a Panel(s) using the Mouse</h2><span id='topic+panelSelect'></span>

<h3>Description</h3>

<p>To select (using the mouse) one or more panels from a four-layered plot for a 
single distribution. The selected panels will be drawn in a separate graphics 
window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>panelSelect(panel.no, CovPlotData)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="panelSelect_+3A_panel.no">panel.no</code></td>
<td>
<p>an integer indicating the number of panels that one wishes to 
select.</p>
</td></tr>
<tr><td><code id="panelSelect_+3A_covplotdata">CovPlotData</code></td>
<td>
<p>the output list returned by <code>VisCov</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After drawing a graph by <code>VisCov</code>, one can select and draw the specified 
number of panels by clicking the mouse on the panels of interest.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>References</h3>

<p>Tokuda, T., Goodrich, B., Van Mechelen, I., Gelman, A. and Tuerlinckx, F. 
(submitted). Visualizing Distributions of Covariance Matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234)
CovPlotData = VisCov()
panelSelect(panel.no = 1, CovPlotData) # Click once on the plot you want to select
panelSelect(panel.no = 4, CovPlotData) # Click four times on the plots you want to select

</code></pre>

<hr>
<h2 id='panelSelectCorr'>Selecting a Panel(s) using the Mouse</h2><span id='topic+panelSelectCorr'></span>

<h3>Description</h3>

<p>To visualize relevant parameters for correlation matrix, removing those panels
related to variances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>panelSelectCorr(CovPlotData, range.logical.contour = FALSE,
                range.logical.all = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="panelSelectCorr_+3A_covplotdata">CovPlotData</code></td>
<td>
<p>the output list returned by <code>VisCov</code>.</p>
</td></tr>
<tr><td><code id="panelSelectCorr_+3A_range.logical.all">range.logical.all</code></td>
<td>
<p>a logical value indicating whether the ranges in the 
panels are set as the same over different sets of samples. For the histograms,
the ranges of frequencies are set as the same over the different sets of 
samples.</p>
</td></tr>
<tr><td><code id="panelSelectCorr_+3A_range.logical.contour">range.logical.contour</code></td>
<td>
<p>a logical value indicating whether the ranges of
the contour plots are set as the same over different sets of samples when 
<code>range.logical.all</code> is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After drawing a graph by <code>VisCov</code>, one can select and draw relevant 
panels for correlation matrix.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>References</h3>

<p>Tokuda, T., Goodrich, B., Van Mechelen, I., Gelman, A. and Tuerlinckx, F. 
(submitted). Visualizing Distributions of Covariance Matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1234)
distribution = "LKJ"
eta = 5
dim = 50
param = list(prob = 0.5, dim = dim, eta=eta, scaleCov = diag(1,dim))
CovPlotData = VisCov(distribution, param,title.logical = FALSE)
panelSelectCorr(CovPlotData)

</code></pre>

<hr>
<h2 id='panelSelectMultiple'>Selecting Panels From Several Distributions</h2><span id='topic+panelSelectMultiple'></span>

<h3>Description</h3>

<p>To draw the selected panels from several distributions generated by 
<code>VisCov</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>panelSelectMultiple(selected.condition, CovPlotDataMultiple, 
                    range.logical.contour = FALSE, range.logical.all = TRUE,
                    row = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="panelSelectMultiple_+3A_selected.condition">selected.condition</code></td>
<td>
<p>a vector of strings containing types of the panels 
that one wishes to select: For layer 1, &quot;vari&quot;, &quot;cor&quot;; for layer 2, 
&quot;scatter1&quot;, &quot;scatter2&quot;, &quot;scatter3&quot;, &quot;scatter4&quot;, &quot;scatter5&quot;; for layer 3, 
&quot;contour&quot;, &quot;threeD&quot;; for layer 4, &quot;Effective.Variance&quot;, 
&quot;Effective.Dependence&quot;, &quot;Effective.Dependence.submatrix&quot;.</p>
</td></tr>
<tr><td><code id="panelSelectMultiple_+3A_covplotdatamultiple">CovPlotDataMultiple</code></td>
<td>
<p>a list of objects returned by <code>VisCov</code>.</p>
</td></tr>
<tr><td><code id="panelSelectMultiple_+3A_range.logical.all">range.logical.all</code></td>
<td>
<p>a logical value indicating whether the ranges in the 
panels are set as the same over different sets of samples. For the histograms,
the ranges of frequencies are set as the same over the different sets of 
samples.</p>
</td></tr>
<tr><td><code id="panelSelectMultiple_+3A_range.logical.contour">range.logical.contour</code></td>
<td>
<p>a logical value indicating whether the ranges of 
the contour plots are set as the same over different sets of samples when 
<code>range.logical.all</code> is TRUE.</p>
</td></tr>
<tr><td><code id="panelSelectMultiple_+3A_row">row</code></td>
<td>
<p>a logical value whether the panels belonging to the same set of 
samples are arranged in the same row. If it is FALSE, they are arranged in 
the same column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>References</h3>

<p>Tokuda, T., Goodrich, B., Van Mechelen, I., Gelman, A. and Tuerlinckx, F. 
(submitted). Visualizing Distributions of Covariance Matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
distribution = "Inverse Wishart"
dim = 4
param = list(prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData1 = VisCov(distribution, param, title.logical = FALSE)
distribution = "Inverse Wishart"
dim = 4
param = list(prob = 0.5, dim = dim, nu = dim+50, scaleCov = diag(1,dim))
CovPlotData2 = VisCov(distribution, param, title.logical = FALSE)
selected.condition = c("scatter1", "scatter4", "contour", "Effective.Dependence")
panelSelectMultiple(selected.condition, list(CovPlotData1, CovPlotData2))
</code></pre>

<hr>
<h2 id='VisCov'>Visualizing of Distributions of Covariance Matrices</h2><span id='topic+VisCov'></span>

<h3>Description</h3>

<p>To generate samples from a specific distribution of covariance matrices, draw 
the four-layered graphs and return the sampled matrices and the related 
information on the distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VisCov(distribution = "Inverse Wishart", param = list(prob = 0.5, dim = 4, 
       nu = 5, eta = 1, scaleCov = diag(1,4)), title = distribution, 
       Nsamples = 1000, Ncontours = 100, logSD = TRUE, 
       histogram.Variance = TRUE, histogram.Correlation = TRUE, 
       histogram.Effective.Variance = TRUE, 
       histogram.Effective.Dependence = TRUE, 
       extreme.regio = "Effective Dependence", title.logical = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VisCov_+3A_distribution">distribution</code></td>
<td>
<p>a distribution to be plotted among:<br /><br /> 
&quot;Inverse Wishart&quot;, &quot;Scaled Inverse Wishart&quot;, &quot;Scaled Inverse Wishart for 
correlation&quot;, &quot;Scaled with uniform on correlation&quot;, &quot;Wishart&quot;, &quot;LKJ&quot;, and 
&quot;User defined distribution&quot;.</p>
</td></tr>
<tr><td><code id="VisCov_+3A_title.logical">title.logical</code></td>
<td>
<p>a logical value indicating whether a title should be 
given to the graph.</p>
</td></tr>
<tr><td><code id="VisCov_+3A_title">title</code></td>
<td>
<p>title of the graph.</p>
</td></tr>
<tr><td><code id="VisCov_+3A_nsamples">Nsamples</code></td>
<td>
<p>the number of samples for all plots except the contour plot.</p>
</td></tr>
<tr><td><code id="VisCov_+3A_ncontours">Ncontours</code></td>
<td>
<p>the number of samples for the contour plot.</p>
</td></tr>
<tr><td><code id="VisCov_+3A_logsd">logSD</code></td>
<td>
<p>a logical value indicating whether the natural logarithm of the 
standard deviation is plotted.</p>
</td></tr>
<tr><td><code id="VisCov_+3A_histogram.variance">histogram.Variance</code></td>
<td>
<p>a logical value indicating whether the univariate 
graph of the (log) standard deviation is a histogram (TRUE) or a density 
(FALSE).</p>
</td></tr>
<tr><td><code id="VisCov_+3A_histogram.correlation">histogram.Correlation</code></td>
<td>
<p>a logical value indicating whether the univariate
graph of the correlation is a histogram (TRUE) or a density curve (FALSE).</p>
</td></tr>
<tr><td><code id="VisCov_+3A_histogram.effective.variance">histogram.Effective.Variance</code></td>
<td>
<p>a logical value indicating whether the 
univariate graph of the effective variance is a histogram (TRUE) or a density 
curve (FALSE).</p>
</td></tr>
<tr><td><code id="VisCov_+3A_histogram.effective.dependence">histogram.Effective.Dependence</code></td>
<td>
<p>a logical value indicating whether the 
univariate graph of the effective dependence is a histogram (TRUE) or a 
density curve (FALSE).</p>
</td></tr>
<tr><td><code id="VisCov_+3A_extreme.regio">extreme.regio</code></td>
<td>
<p>indicates whether the coloring of extreme samples (in red
and blue) is based on the &quot;Effective Dependence&quot; or &quot;Effective Variance&quot;. If 
neither of them is specified, there is no coloring.</p>
</td></tr>
<tr><td><code id="VisCov_+3A_param">param</code></td>
<td>
<p>a list of parameters consisting of the following objects:
<code>mat</code>, a list of covariance matrices; applicable only when 
distribution = &quot;User defined distribution&quot;; <code>prob</code>, mass 
concentration in the equiprobability contour plot; <code>dim</code>, dimension
of matrices; <code>nu</code>, degrees of freedom for the inverse Wishart or 
Wishart distributions; <code>scaleCov</code>, scale matrix for the inverse 
Wishart or Wishart distributions; <code>mu0</code> and <code>s0</code> are the mean
and the standard deviation for the folded normal distribution, 
applicable when <code>distribution</code> is &quot;Scaled Inverse Wishart&quot;, 
&quot;Scaled Inverse Wishart for correlation&quot; or &quot;Scaled with uniform on 
correlation&quot;; <code>eta</code>, shape parameter for the LKJ distribution.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>VisCov</code> generates samples from a specific distribution of covariance 
matrices (or user defined distribution), draws the four-layered graphs and 
returns the sampled matrices and the related information on the distribution. 
</p>
<p>For more detail, see Tokuda et al. in the following reference.
</p>


<h3>Value</h3>

<p>A list of variables to pass for selecting panels.
</p>


<h3>References</h3>

<p>Tokuda, T., Goodrich, B., Van Mechelen, I., Gelman, A. and Tuerlinckx, F. 
(submitted). Visualizing Distributions of Covariance Matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Figures in the paper (Tokuda, Goodrich, Van Mechelen, Gelman, and Tuerlinckx)
## Example 1 (Figure 1 in the paper)
set.seed(1234)
distribution = "Inverse Wishart"
dim = 4
param = list(prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData = VisCov(distribution, param, title.logical = FALSE)

## Example 2  (Figure 2 in the paper)
set.seed(1234)
distribution = "Inverse Wishart"
dim = 4
param = list(prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData1 = VisCov(distribution, param, title.logical = FALSE)
distribution = "Inverse Wishart"
dim = 4
param = list(prob = 0.5, dim = dim, nu = dim+50, scaleCov = diag(1,dim))
CovPlotData2 = VisCov(distribution, param, title.logical = FALSE)
selected.condition = c("scatter1", "scatter4", "contour", "Effective.Dependence")
panelSelectMultiple(selected.condition, list(CovPlotData1, CovPlotData2))

## Example 3  (Figure 3 in the paper)
set.seed(1234)
distribution = "Inverse Wishart"
dim = 4
param = list(prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData1 = VisCov(distribution, param, title.logical = FALSE)
dim = 100
param = list(prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData2 = VisCov(distribution, param, title.logical = FALSE)
selected.condition = c("Effective.Dependence")
panelSelectMultiple(selected.condition, list(CovPlotData1, CovPlotData2))

## Example 4  (Figure 4 in the paper)
set.seed(1234)
distribution = "Scaled Inverse Wishart for correlation"
dim = 4
param = list(mu0 = 0, s0 = 1, prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData1 = VisCov(distribution, param, title.logical = FALSE)
param = list(mu0 = 0, s0 = 1,prob = 0.5, dim = dim, nu = dim+50, scaleCov = diag(1,dim))
CovPlotData2 = VisCov(distribution, param, title.logical = FALSE)
selected.condition = c("scatter1", "scatter2", "scatter4", "contour")
panelSelectMultiple(selected.condition, list(CovPlotData1, CovPlotData2))

## Example 5  (Figure 5 in the paper)
set.seed(1234)
distribution = "Scaled with uniform on correlation"
dim = 4
param = list(mu0 = 0, s0 = 1, prob = 0.5, dim = dim)
CovPlotData1 = VisCov(distribution, param, title.logical = FALSE)
dim = 50
param = list(mu0 = 0, s0 = 1, prob = 0.5, dim = dim)
CovPlotData2 = VisCov(distribution, param,title.logical = FALSE)
selected.condition = c("scatter2", "scatter4", "contour", "Effective.Dependence.submatrix")
panelSelectMultiple(selected.condition, list(CovPlotData1, CovPlotData2))

## Example 6  (Figure 6 in the paper)
set.seed(1234)
distribution = "LKJ"
eta = 5
dim = 100
param = list(prob = 0.5, dim = dim, eta=eta, scaleCov = diag(1,dim))
CovPlotData = VisCov(distribution, param,title.logical = FALSE)
panelSelectCorr(CovPlotData)

## Example 7  (Figure 7 in the paper)
set.seed(1234)
distribution = "Scaled Inverse Wishart"
dim = 4
param = list(mu0 = 0, s0 = 1, prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData1 = VisCov(distribution, param, title.logical = FALSE)
param = list(mu0 = 0, s0 = 1,prob = 0.5, dim = dim, nu = dim+50, scaleCov = diag(1,dim))
CovPlotData2 = VisCov(distribution, param, title.logical = FALSE)
selected.condition = c("scatter2", "scatter4", "contour", "Effective.Dependence")
panelSelectMultiple(selected.condition, list(CovPlotData1,CovPlotData2))

## Example 8  (Figure 8 in the paper)
distribution = "Wishart"
set.seed(1234)
dim = 4
param = list(prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData1 = VisCov(distribution, param, title.logical = FALSE)
dim = 50
param = list(prob = 0.5, dim = dim, nu = dim+1, scaleCov = diag(1,dim))
CovPlotData2 = VisCov(distribution, param,title.logical = FALSE)
selected.condition = c("scatter2", "scatter4", "contour", "Effective.Dependence")
panelSelectMultiple(selected.condition, list(CovPlotData1, CovPlotData2))

## Example 9  (Figure 9 in the paper)
set.seed(1234)
distribution = "User defined distribution"
param = list()
mat = list()
# Generation of covariance matrices
for (i in 1:1000){
  index = 0
  dim = 50
  while (index == 0){
    W = matrix(rnorm(dim * dim, 0, 1), nrow = dim)
    svdW= svd(W)
    Rho = svdW$u %*% t(svdW$v)
    D = diag(rbeta(dim, 0.5, 5))
    Sigma = diag(rnorm(dim, 0, 1))
    Sigma = abs(Sigma)
    S = Sigma %*% Rho %*% D %*% t(Rho) %*% Sigma
    # Checking positive definiteness
    eigenv = eigen(S)$values
    if (all(eigenv &gt; 0)) index = 1
    if (index == 0){ print("zero") }
    mat[[i]] = S
  }
}
param = list(prob = 0.5, mat = mat)
CovPlotData = VisCov(distribution, param , title.logical = FALSE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
