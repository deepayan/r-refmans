<!DOCTYPE html><html><head><title>Help for package AzureGraph</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AzureGraph}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#az_app'><p>Registered app in Azure Active Directory</p></a></li>
<li><a href='#az_device'><p>Device in Azure Active Directory</p></a></li>
<li><a href='#az_directory_role'><p>Directory role</p></a></li>
<li><a href='#az_group'><p>Group in Azure Active Directory</p></a></li>
<li><a href='#az_object'><p>Azure Active Directory object</p></a></li>
<li><a href='#az_service_principal'><p>Service principal in Azure Active Directory</p></a></li>
<li><a href='#az_user'><p>User in Azure Active Directory</p></a></li>
<li><a href='#call_batch_endpoint'><p>Call the Graph API batch endpoint</p></a></li>
<li><a href='#call_graph_endpoint'><p>Call the Microsoft Graph REST API</p></a></li>
<li><a href='#create_graph_login'><p>Login to Azure Active Directory Graph</p></a></li>
<li><a href='#extract_list_values'><p>Get the list of values from a Graph pager object</p></a></li>
<li><a href='#find_class_generator'><p>Find the R6 class for a Graph object</p></a></li>
<li><a href='#format_public_fields'><p>Format a Microsoft Graph or Azure object</p></a></li>
<li><a href='#graph_request'><p>Microsoft Graph request</p></a></li>
<li><a href='#is_app'><p>Informational functions</p></a></li>
<li><a href='#ms_graph'><p>Microsoft Graph</p></a></li>
<li><a href='#ms_graph_pager'><p>Pager object for Graph list results</p></a></li>
<li><a href='#ms_object'><p>Microsoft Graph object</p></a></li>
<li><a href='#named_list'><p>Miscellaneous utility functions</p></a></li>
<li><a href='#register_graph_class'><p>Extensible registry of Microsoft Graph classes that AzureGraph supports</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Simple Interface to 'Microsoft Graph'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.4</td>
</tr>
<tr>
<td>Description:</td>
<td>A simple interface to the 'Microsoft Graph' API <a href="https://learn.microsoft.com/en-us/graph/overview">https://learn.microsoft.com/en-us/graph/overview</a>. 'Graph' is a comprehensive framework for accessing data in various online Microsoft services. This package was originally intended to provide an R interface only to the 'Azure Active Directory' part, with a view to supporting interoperability of R and 'Azure': users, groups, registered apps and service principals. However it has since been expanded into a more general tool for interacting with Graph. Part of the 'AzureR' family of packages.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Azure/AzureGraph">https://github.com/Azure/AzureGraph</a>
<a href="https://github.com/Azure/AzureR">https://github.com/Azure/AzureR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Azure/AzureGraph/issues">https://github.com/Azure/AzureGraph/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>AzureAuth (&ge; 1.0.1), utils, httr (&ge; 1.3), jsonlite, openssl,
curl, R6</td>
</tr>
<tr>
<td>Suggests:</td>
<td>AzureRMR, vctrs, knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-06 00:03:14 UTC; hongo</td>
</tr>
<tr>
<td>Author:</td>
<td>Hong Ooi [aut, cre],
  Microsoft [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hong Ooi &lt;hongooi73@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-06 04:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='az_app'>Registered app in Azure Active Directory</h2><span id='topic+az_app'></span>

<h3>Description</h3>

<p>Base class representing an AAD app.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_app</code>, inheriting from <code>az_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this app.
</p>
</li>
<li> <p><code>type</code>: always &quot;application&quot; for an app object.
</p>
</li>
<li> <p><code>properties</code>: The app properties.
</p>
</li>
<li> <p><code>password</code>: The app password. Note that the Graph API does not return previously-generated passwords. This field will only be populated for an app object created with <code>ms_graph$create_app()</code>, or after a call to the <code>add_password()</code> method below.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new app object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete an app. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the app data in Azure Active Directory. For what properties can be updated, consult the REST API documentation link below.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the app.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the app data in Azure Active Directory.
</p>
</li>
<li> <p><code>list_owners(type=c("user", "group", "application", "servicePrincipal"), filter=NULL, n=Inf)</code>: Return a list of all owners of this app. Specify the <code>type</code> argument to limit the result to specific object type(s).
</p>
</li>
<li> <p><code>create_service_principal(...)</code>: Create a service principal for this app, by default in the current tenant.
</p>
</li>
<li> <p><code>get_service_principal()</code>: Get the service principal for this app.
</p>
</li>
<li> <p><code>delete_service_principal(confirm=TRUE)</code>: Delete the service principal for this app. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>add_password(password_name=NULL, password_duration=NULL)</code>: Adds a strong password. <code>password_duration</code> is the length of time in years that the password remains valid, with default duration 2 years. Returns the ID of the generated password.
</p>
</li>
<li> <p><code>remove_password(password_id, confirm=TRUE)</code>: Removes the password with the given ID. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>add_certificate(certificate)</code>: Adds a certificate for authentication. This can be specified as the name of a .pfx or .pem file, an <code>openssl::cert</code> object, an <code>AzureKeyVault::stored_cert</code> object, or a raw or character vector.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;remove_certificate(certificate_id, confirm=TRUE&#8288;</code>): Removes the certificate with the given ID. By default, ask for confirmation first.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>create_app</code> and <code>get_app</code> methods of the <a href="#topic+ms_graph">ms_graph</a> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to create the actual app.
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-beta">REST API reference</a>
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="#topic+az_service_principal">az_service_principal</a>, <a href="#topic+az_user">az_user</a>, <a href="#topic+az_group">az_group</a>, <a href="#topic+az_object">az_object</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

gr &lt;- get_graph_login()
app &lt;- gr$create_app("MyNewApp")

# password resetting: remove the old password, add a new one
pwd_id &lt;- app$properties$passwordCredentials[[1]]$keyId
app$add_password()
app$remove_password(pwd_id)

# set a redirect URI
app$update(publicClient=list(redirectUris=I("http://localhost:1410")))

# add API permission (access Azure Storage as user)
app$update(requiredResourceAccess=list(
    list(
        resourceAppId="e406a681-f3d4-42a8-90b6-c2b029497af1",
        resourceAccess=list(
            list(
                id="03e0da56-190b-40ad-a80c-ea378c433f7f",
                type="Scope"
            )
        )
    )
))

# add a certificate from a .pem file
app$add_certificate("cert.pem")

# can also read the file into an openssl object, and then add the cert
cert &lt;- openssl::read_cert("cert.pem")
app$add_certificate(cert)

# add a certificate stored in Azure Key Vault
vault &lt;- AzureKeyVault::key_vault("mytenant")
cert2 &lt;- vault$certificates$get("certname")
app$add_certificate(cert2)

# change the app name
app$update(displayName="MyRenamedApp")


## End(Not run)
</code></pre>

<hr>
<h2 id='az_device'>Device in Azure Active Directory</h2><span id='topic+az_device'></span>

<h3>Description</h3>

<p>Class representing a registered device.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_device</code>, inheriting from <code>az_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this group.
</p>
</li>
<li> <p><code>type</code>: always &quot;device&quot; for a device object.
</p>
</li>
<li> <p><code>properties</code>: The device properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new device object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete a device. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the device information in Azure Active Directory.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the device.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the app data in Azure Active Directory.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Create objects of this class via the <code>list_registered_devices()</code> and <code>list_owned_devices()</code> methods of the <code>az_user</code> class.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="#topic+az_user">az_user</a>, <a href="#topic+az_object">az_object</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>

<hr>
<h2 id='az_directory_role'>Directory role</h2><span id='topic+az_directory_role'></span>

<h3>Description</h3>

<p>Class representing a role in Azure Active Directory.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_directory_role</code>, inheriting from <code>az_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this role.
</p>
</li>
<li> <p><code>type</code>: always &quot;directory role&quot; for a directory role object.
</p>
</li>
<li> <p><code>properties</code>: The item properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this item. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the item's properties in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the item.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the item metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>list_members(filter=NULL, n=Inf)</code>: Return a list of all members of this group.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Currently support for directory roles is limited. Objects of this class should not be initialized directly.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="#topic+az_user">az_user</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>

<hr>
<h2 id='az_group'>Group in Azure Active Directory</h2><span id='topic+az_group'></span>

<h3>Description</h3>

<p>Class representing an AAD group.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_group</code>, inheriting from <code>az_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this group.
</p>
</li>
<li> <p><code>type</code>: always &quot;group&quot; for a group object.
</p>
</li>
<li> <p><code>properties</code>: The group properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new group object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete a group. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the group information in Azure Active Directory.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the group.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the app data in Azure Active Directory.
</p>
</li>
<li> <p><code>list_members(type=c("user", "group", "application", "servicePrincipal"), filter=NULL, n=Inf)</code>: Return a list of all members of this group. Specify the <code>type</code> argument to limit the result to specific object type(s).
</p>
</li>
<li> <p><code>list_owners(type=c("user", "group", "application", "servicePrincipal"), filter=NULL, n=Inf)</code>: Return a list of all owners of this group. Specify the <code>type</code> argument to limit the result to specific object type(s).
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>create_group</code> and <code>get_group</code> methods of the <a href="#topic+ms_graph">ms_graph</a> and <a href="#topic+az_app">az_app</a> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to create the actual group.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="#topic+az_app">az_app</a>, <a href="#topic+az_user">az_user</a>, <a href="#topic+az_object">az_object</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

gr &lt;- get_graph_login()
usr &lt;- gr$get_user("myname@aadtenant.com")

grps &lt;- usr$list_group_memberships()
grp &lt;- gr$get_group(grps[1])

grp$list_members()
grp$list_owners()

# capping the number of results
grp$list_members(n=10)

# get the pager object for a listing method
pager &lt;- grp$list_members(n=NULL)
pager$value


## End(Not run)
</code></pre>

<hr>
<h2 id='az_object'>Azure Active Directory object</h2><span id='topic+az_object'></span>

<h3>Description</h3>

<p>Base class representing an Azure Active Directory object in Microsoft Graph.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_object</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this object.
</p>
</li>
<li> <p><code>type</code>: The type of object: user, group, application or service principal.
</p>
</li>
<li> <p><code>properties</code>: The object properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new directory object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete an object. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the object information in Azure Active Directory.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the object.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the data in Azure Active Directory.
</p>
</li>
<li> <p><code>list_group_memberships(security_only=FALSE, filter=NULL, n=Inf)</code>: Return the IDs of all groups this object is a member of. If <code>security_only</code> is TRUE, only security group IDs are returned.
</p>
</li>
<li> <p><code>list_object_memberships(security_only=FALSE, filter=NULL, n=Inf)</code>: Return the IDs of all groups, administrative units and directory roles this object is a member of.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Objects of this class should not be created directly. Instead, create an object of the appropriate subclass: <a href="#topic+az_app">az_app</a>, <a href="#topic+az_service_principal">az_service_principal</a>, <a href="#topic+az_user">az_user</a>, <a href="#topic+az_group">az_group</a>.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="#topic+az_app">az_app</a>, <a href="#topic+az_service_principal">az_service_principal</a>, <a href="#topic+az_user">az_user</a>, <a href="#topic+az_group">az_group</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>

<hr>
<h2 id='az_service_principal'>Service principal in Azure Active Directory</h2><span id='topic+az_service_principal'></span>

<h3>Description</h3>

<p>Class representing an AAD service principal.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_service_principal</code>, inheriting from <code>az_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this service principal.
</p>
</li>
<li> <p><code>type</code>: always &quot;service principal&quot; for a service principal object.
</p>
</li>
<li> <p><code>properties</code>: The service principal properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new service principal object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete a service principal. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the service principal information in Azure Active Directory.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the service principal.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the service principal data in Azure Active Directory.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>create_service_principal</code> and <code>get_service_principal</code> methods of the <a href="#topic+ms_graph">ms_graph</a> and <a href="#topic+az_app">az_app</a> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to create the actual service principal.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="#topic+az_app">az_app</a>, <a href="#topic+az_object">az_object</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Azure Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>

<hr>
<h2 id='az_user'>User in Azure Active Directory</h2><span id='topic+az_user'></span>

<h3>Description</h3>

<p>Class representing an AAD user account.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_user</code>, inheriting from <code>az_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this user.
</p>
</li>
<li> <p><code>type</code>: always &quot;user&quot; for a user object.
</p>
</li>
<li> <p><code>properties</code>: The user properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new user object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete a user account. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the user information in Azure Active Directory.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the user account.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the app data in Azure Active Directory.
</p>
</li>
<li> <p><code>list_direct_memberships(filter=NULL, n=Inf)</code>: List the groups and directory roles this user is a direct member of.
</p>
</li>
<li> <p><code>list_owned_objects(type=c("user", "group", "application", "servicePrincipal"), filter=NULL, n=Inf)</code>: List directory objects (groups/apps/service principals) owned by this user. Specify the <code>type</code> argument to limit the result to specific object type(s).
</p>
</li>
<li> <p><code>list_created_objects(type=c("user", "group", "application", "servicePrincipal"), filter=NULL, n=Inf)</code>: List directory objects (groups/apps/service principals) created by this user. Specify the <code>type</code> argument to limit the result to specific object type(s).
</p>
</li>
<li> <p><code>list_owned_devices(filter=NULL, n=Inf)</code>: List the devices owned by this user.
</p>
</li>
<li> <p><code>list_registered_devices(filter=NULL, n=Inf)</code>: List the devices registered by this user.
</p>
</li>
<li> <p><code>reset_password(password=NULL, force_password_change=TRUE)</code>: Resets a user password. By default the new password will be randomly generated, and must be changed at next login.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>create_user</code> and <code>get_user</code> methods of the <a href="#topic+ms_graph">ms_graph</a> and <a href="#topic+az_app">az_app</a> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to create the actual user account.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="#topic+az_app">az_app</a>, <a href="#topic+az_group">az_group</a>, <a href="#topic+az_device">az_device</a>, <a href="#topic+az_object">az_object</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

gr &lt;- get_graph_login()

# my user account
gr$get_user()

# another user account
usr &lt;- gr$get_user("myname@aadtenant.com")

grps &lt;- usr$list_direct_memberships()
head(grps)

# owned objects
usr$list_owned_objects()

# owned apps and service principals
usr$list_owned_objects(type=c("application", "servicePrincipal"))

# first 5 objects
usr$list_owned_objects(n=5)

# get the pager object
pager &lt;- usr$list_owned_objects(n=NULL)
pager$value


## End(Not run)
</code></pre>

<hr>
<h2 id='call_batch_endpoint'>Call the Graph API batch endpoint</h2><span id='topic+call_batch_endpoint'></span>

<h3>Description</h3>

<p>Call the Graph API batch endpoint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call_batch_endpoint(token, requests = list(), depends_on = NULL,
  api_version = getOption("azure_graph_api_version"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="call_batch_endpoint_+3A_token">token</code></td>
<td>
<p>An Azure OAuth token, of class <a href="AzureAuth.html#topic+AzureToken">AzureToken</a>.</p>
</td></tr>
<tr><td><code id="call_batch_endpoint_+3A_requests">requests</code></td>
<td>
<p>A list of <a href="#topic+graph_request">graph_request</a> objects, representing individual requests to the Graph API.</p>
</td></tr>
<tr><td><code id="call_batch_endpoint_+3A_depends_on">depends_on</code></td>
<td>
<p>An optional named vector, or TRUE. See below.</p>
</td></tr>
<tr><td><code id="call_batch_endpoint_+3A_api_version">api_version</code></td>
<td>
<p>The API version to use, which will form part of the URL sent to the host.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use this function to combine multiple requests into a single HTTPS call. This can save significant network latency.
</p>
<p>The <code>depends_on</code> argument specifies the dependencies that may exist between requests. The default is to treat the requests as independent, which allows them to be executed in parallel. If <code>depends_on</code> is TRUE, each request is specified as depending on the immediately preceding request. Otherwise, this should be a named vector or list that gives the dependency or dependencies for each request.
</p>
<p>There are 2 restrictions on <code>depends_on</code>:
</p>

<ul>
<li><p> If one request has a dependency, then all requests must have dependencies specified
</p>
</li>
<li><p> A request can only depend on previous requests in the list, not on later ones.
</p>
</li></ul>

<p>A request list that has dependencies will be executed serially.
</p>


<h3>Value</h3>

<p>A list containing the responses to each request. Each item has components <code>id</code> and <code>status</code> at a minimum. It may also contain <code>headers</code> and <code>body</code>, depending on the specifics of the request.
</p>


<h3>See Also</h3>

<p><a href="#topic+graph_request">graph_request</a>, <a href="#topic+call_graph_endpoint">call_graph_endpoint</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/json-batching">Batch endpoint documentation</a>
</p>
<p><a href="https://docs.oasis-open.org/odata/odata-json-format/v4.01/odata-json-format-v4.01.html#sec_BatchRequestsandResponses">OData documentation on batch requests</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

req1 &lt;- graph_request$new("me")

# a new email message in Outlook
req_create &lt;- graph_request$new("me/messages",
    body=list(
        body=list(
            content="Hello from R",
            content_type="text"
        ),
        subject="Hello",
        toRecipients="bob@example.com"
    ),
    http_verb="POST"
)

# messages in drafts
req_get &lt;- graph_request$new("me/mailFolders/drafts/messages")

# requests are dependent: 2nd list of drafts will include just-created message
call_batch_endpoint(token, list(req_get, req_create, req_get), depends_on=TRUE)

# alternate way: enumerate all requests
call_batch_endpoint(token, list(req_get, req_create, req_get), depends_on=c("2"=1, "3"=2))


## End(Not run)
</code></pre>

<hr>
<h2 id='call_graph_endpoint'>Call the Microsoft Graph REST API</h2><span id='topic+call_graph_endpoint'></span><span id='topic+call_graph_url'></span>

<h3>Description</h3>

<p>Call the Microsoft Graph REST API
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call_graph_endpoint(token, operation, ..., options = list(),
  api_version = getOption("azure_graph_api_version"))

call_graph_url(token, url, ..., body = NULL, encode = "json",
  http_verb = c("GET", "DELETE", "PUT", "POST", "HEAD", "PATCH"),
  http_status_handler = c("stop", "warn", "message", "pass"),
  simplify = FALSE, auto_refresh = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="call_graph_endpoint_+3A_token">token</code></td>
<td>
<p>An Azure OAuth token, of class <a href="AzureAuth.html#topic+AzureToken">AzureToken</a>.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_operation">operation</code></td>
<td>
<p>The operation to perform, which will form part of the URL path.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_...">...</code></td>
<td>
<p>Other arguments passed to lower-level code, ultimately to the appropriate functions in httr.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_options">options</code></td>
<td>
<p>A named list giving the URL query parameters.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_api_version">api_version</code></td>
<td>
<p>The API version to use, which will form part of the URL sent to the host.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_url">url</code></td>
<td>
<p>A complete URL to send to the host.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_body">body</code></td>
<td>
<p>The body of the request, for <code>PUT</code>/<code>POST</code>/<code>PATCH</code>.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_encode">encode</code></td>
<td>
<p>The encoding (really content-type) for the request body. The default value &quot;json&quot; means to serialize a list body into a JSON object. If you pass an already-serialized JSON object as the body, set <code>encode</code> to &quot;raw&quot;.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_http_verb">http_verb</code></td>
<td>
<p>The HTTP verb as a string, one of <code>GET</code>, <code>PUT</code>, <code>POST</code>, <code>DELETE</code>, <code>HEAD</code> or <code>PATCH</code>.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_http_status_handler">http_status_handler</code></td>
<td>
<p>How to handle in R the HTTP status code of a response. <code>"stop"</code>, <code>"warn"</code> or <code>"message"</code> will call the appropriate handlers in httr, while <code>"pass"</code> ignores the status code.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_simplify">simplify</code></td>
<td>
<p>Whether to turn arrays of objects in the JSON response into data frames. Set this to <code>TRUE</code> if you are expecting the endpoint to return tabular data and you want a tabular result, as opposed to a list of objects.</p>
</td></tr>
<tr><td><code id="call_graph_endpoint_+3A_auto_refresh">auto_refresh</code></td>
<td>
<p>Whether to refresh/renew the OAuth token if it is no longer valid.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions form the low-level interface between R and Microsoft Graph. <code>call_graph_endpoint</code> forms a URL from its arguments and passes it to <code>call_graph_url</code>.
</p>
<p>If <code>simplify</code> is <code>TRUE</code>, <code>call_graph_url</code> will exploit the ability of <code>jsonlite::fromJSON</code> to convert arrays of objects into R data frames. This can be useful for REST calls that return tabular data. However, it can also cause problems for <em>paged</em> lists, where each page will be turned into a separate data frame; as the individual objects may not have the same fields, the resulting data frames will also have differing columns. This will cause base R's <code>rbind</code> to fail when binding the pages together. When processing paged lists, AzureGraph will use <code>vctrs::vec_rbind</code> instead of <code>rbind</code> when the vctrs package is available; <code>vec_rbind</code> does not have this problem. For safety, you should only set <code>simplify=TRUE</code> when vctrs is installed.
</p>


<h3>Value</h3>

<p>If <code>http_status_handler</code> is one of <code>"stop"</code>, <code>"warn"</code> or <code>"message"</code>, the status code of the response is checked. If an error is not thrown, the parsed content of the response is returned with the status code attached as the &quot;status&quot; attribute.
</p>
<p>If <code>http_status_handler</code> is <code>"pass"</code>, the entire response is returned without modification.
</p>


<h3>See Also</h3>

<p><a href="httr.html#topic+GET">httr::GET</a>, <a href="httr.html#topic+PUT">httr::PUT</a>, <a href="httr.html#topic+POST">httr::POST</a>, <a href="httr.html#topic+DELETE">httr::DELETE</a>, <a href="httr.html#topic+stop_for_status">httr::stop_for_status</a>, <a href="httr.html#topic+content">httr::content</a>
</p>

<hr>
<h2 id='create_graph_login'>Login to Azure Active Directory Graph</h2><span id='topic+create_graph_login'></span><span id='topic+get_graph_login'></span><span id='topic+delete_graph_login'></span><span id='topic+list_graph_logins'></span>

<h3>Description</h3>

<p>Login to Azure Active Directory Graph
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_graph_login(tenant = "common", app = NULL, password = NULL,
  username = NULL, certificate = NULL, auth_type = NULL, version = 2,
  host = "https://graph.microsoft.com/",
  aad_host = "https://login.microsoftonline.com/", scopes = ".default",
  config_file = NULL, token = NULL, ...)

get_graph_login(tenant = "common", selection = NULL, app = NULL,
  scopes = NULL, auth_type = NULL, refresh = TRUE)

delete_graph_login(tenant = "common", confirm = TRUE)

list_graph_logins()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_graph_login_+3A_tenant">tenant</code></td>
<td>
<p>The Azure Active Directory tenant for which to obtain a login client. Can be a name (&quot;myaadtenant&quot;), a fully qualified domain name (&quot;myaadtenant.onmicrosoft.com&quot; or &quot;mycompanyname.com&quot;), or a GUID. The default is to login via the &quot;common&quot; tenant, which will infer your actual tenant from your credentials.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_app">app</code></td>
<td>
<p>The client/app ID to use to authenticate with Azure Active Directory. The default is to login interactively using the Azure CLI cross-platform app, but you can supply your own app credentials as well.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_password">password</code></td>
<td>
<p>If <code>auth_type == "client_credentials"</code>, the app secret; if <code>auth_type == "resource_owner"</code>, your account password.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_username">username</code></td>
<td>
<p>If <code>auth_type == "resource_owner"</code>, your username.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_certificate">certificate</code></td>
<td>
<p>If 'auth_type == &quot;client_credentials&quot;, a certificate to authenticate with. This is a more secure alternative to using an app secret.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_auth_type">auth_type</code></td>
<td>
<p>The OAuth authentication method to use, one of &quot;client_credentials&quot;, &quot;authorization_code&quot;, &quot;device_code&quot; or &quot;resource_owner&quot;. If <code>NULL</code>, this is chosen based on the presence of the <code>username</code> and <code>password</code> arguments.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_version">version</code></td>
<td>
<p>The Azure Active Directory version to use for authenticating.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_host">host</code></td>
<td>
<p>Your Microsoft Graph host. Defaults to <code style="white-space: pre;">&#8288;https://graph.microsoft.com/&#8288;</code>. Change this if you are using a government or private cloud.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_aad_host">aad_host</code></td>
<td>
<p>Azure Active Directory host for authentication. Defaults to <code style="white-space: pre;">&#8288;https://login.microsoftonline.com/&#8288;</code>. Change this if you are using a government or private cloud.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_scopes">scopes</code></td>
<td>
<p>The Microsoft Graph scopes (permissions) to obtain for this Graph login. For <code>create_graph_login</code>, this is used only for <code>version=2</code>. For <code>get_graph_login</code>, set this to NA to require an AAD v1.0 token.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_config_file">config_file</code></td>
<td>
<p>Optionally, a JSON file containing any of the arguments listed above. Arguments supplied in this file take priority over those supplied on the command line. You can also use the output from the Azure CLI <code style="white-space: pre;">&#8288;az ad sp create-for-rbac&#8288;</code> command.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_token">token</code></td>
<td>
<p>Optionally, an OAuth 2.0 token, of class <a href="AzureAuth.html#topic+AzureToken">AzureAuth::AzureToken</a>. This allows you to reuse the authentication details for an existing session. If supplied, all other arguments to <code>create_graph_login</code> will be ignored.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>ms_graph$new()</code>.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_selection">selection</code></td>
<td>
<p>For <code>get_graph_login</code>, if you have multiple logins for a given tenant, which one to use. This can be a number, or the input MD5 hash of the token used for the login. If not supplied, <code>get_graph_login</code> will print a menu and ask you to choose a login.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_refresh">refresh</code></td>
<td>
<p>For <code>get_graph_login</code>, whether to refresh the authentication token on loading the client.</p>
</td></tr>
<tr><td><code id="create_graph_login_+3A_confirm">confirm</code></td>
<td>
<p>For <code>delete_graph_login</code>, whether to ask for confirmation before deleting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>create_graph_login</code> creates a login client to authenticate with Microsoft Graph, using the supplied arguments. The authentication token is obtained using <a href="AzureAuth.html#topic+get_azure_token">get_azure_token</a>, which automatically caches and reuses tokens for subsequent sessions.
</p>
<p>For interactive use, you would normally <em>not</em> supply the <code>username</code> and <code>password</code> arguments. Omitting them will prompt <code>create_graph_login</code> to authenticate you with AAD using your browser, which is the recommended method. If you don't have a browser available to your R session, for example if you're using RStudio Server or Azure Databricks, you can specify <code style="white-space: pre;">&#8288;auth_type="device_code&#8288;</code>&quot;.
</p>
<p>For non-interactive use, for example if you're calling AzureGraph in a deployment pipeline, the recommended authentication method is via client credentials. For this method, you supply <em>only</em> the <code>password</code> argument, which should contain the client secret for your app registration. You must also specify your own app registration ID, in the <code>app</code> argument.
</p>
<p>The AzureAuth package has a <a href="https://cran.r-project.org/package=AzureAuth/vignettes/scenarios.html">vignette</a> that goes into more detail on these authentication scenarios.
</p>
<p><code>get_graph_login</code> returns a previously created login client. If there are multiple existing clients, you can specify which client to return via the <code>selection</code>, <code>app</code>, <code>scopes</code> and <code>auth_type</code> arguments. If you don't specify which one to return, it will pop up a menu and ask you to choose one.
</p>
<p>One difference between <code>create_graph_login</code> and <code>get_graph_login</code> is the former will delete any previously saved credentials that match the arguments it was given. You can use this to force AzureGraph to remove obsolete tokens that may be lying around.
</p>


<h3>Value</h3>

<p>For <code>get_graph_login</code> and <code>create_graph_login</code>, an object of class <code>ms_graph</code>, representing the login client. For <code>list_graph_logins</code>, a (possibly nested) list of such objects.
</p>
<p>If the AzureR data directory for saving credentials does not exist, <code>get_graph_login</code> will throw an error.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="AzureAuth.html#topic+get_azure_token">AzureAuth::get_azure_token</a> for more details on authentication methods
</p>
<p><a href="https://cran.r-project.org/package=AzureAuth/vignettes/scenarios.html">AzureAuth vignette on authentication scenarios</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# without any arguments, this will create a client using your AAD organisational account
az &lt;- create_graph_login()

# retrieve the login in subsequent sessions
az &lt;- get_graph_login()

# this will create an Microsoft Graph client for the tenant 'mytenant.onmicrosoft.com',
# using the client_credentials method
az &lt;- create_graph_login("mytenant", app="{app_id}", password="{password}")

# you can also login using credentials in a json file
az &lt;- create_graph_login(config_file="~/creds.json")

# creating and obtaining a login with specific scopes
create_graph_login("mytenant", scopes=c("User.Read", "Files.ReadWrite.All"))
get_graph_login("mytenant", scopes=c("User.Read", "Files.ReadWrite.All"))

# to use your personal account, set the tenant to one of the following
create_graph_login("9188040d-6c67-4c5b-b112-36a304b66dad")
create_graph_login("consumers")  # requires AzureAuth 1.3.0


## End(Not run)
</code></pre>

<hr>
<h2 id='extract_list_values'>Get the list of values from a Graph pager object</h2><span id='topic+extract_list_values'></span>

<h3>Description</h3>

<p>Get the list of values from a Graph pager object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_list_values(pager, n = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_list_values_+3A_pager">pager</code></td>
<td>
<p>An object of class <code>ms_graph_pager</code>, which is an iterator for a list of paged query results.</p>
</td></tr>
<tr><td><code id="extract_list_values_+3A_n">n</code></td>
<td>
<p>The number of items from the list to return. Note this is <em>not</em> the number of <em>pages</em> (each page will usually contain multiple items). The default value of <code>Inf</code> extracts all the values from the list, leaving the pager empty. If this is NULL, the pager itself is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function to perform the common task of extracting all or some of the items from a paged response.
</p>


<h3>Value</h3>

<p>If <code>n</code> is <code>Inf</code> or a number, the items from the paged query results. The format of the returned value depends on the pager settings. This will either be a nested list containing the properties for each of the items; a list of R6 objects; or a data frame. If the pager is empty, an error is thrown.
</p>
<p>If <code>n</code> is NULL, the pager itself is returned.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_graph_pager">ms_graph_pager</a>, <a href="#topic+ms_object">ms_object</a>, <a href="#topic+call_graph_endpoint">call_graph_endpoint</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

firstpage &lt;- call_graph_endpoint(token, "me/memberOf")
pager &lt;- ms_graph_pager$new(token, firstpage)
extract_list_values(pager)

# trying to extract values a 2nd time will fail
try(extract_list_values(pager))


## End(Not run)
</code></pre>

<hr>
<h2 id='find_class_generator'>Find the R6 class for a Graph object</h2><span id='topic+find_class_generator'></span>

<h3>Description</h3>

<p>Find the R6 class for a Graph object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_class_generator(props, type_filter = NULL, default_generator = ms_object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_class_generator_+3A_props">props</code></td>
<td>
<p>A list of object properties, generally the result of a Graph API call.</p>
</td></tr>
<tr><td><code id="find_class_generator_+3A_type_filter">type_filter</code></td>
<td>
<p>An optional vector of types by which to filter the result.</p>
</td></tr>
<tr><td><code id="find_class_generator_+3A_default_generator">default_generator</code></td>
<td>
<p>The default class generator to use, if a match couldn't be found.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function maps Graph objects to AzureGraph classes.
</p>


<h3>Value</h3>

<p>An R6 class generator for the appropriate AzureGraph class. If no matching R6 class could be found, the default generator is returned. If <code>type_filter</code> is provided, but the matching R6 class isn't in the filter, NULL is returned.
</p>

<hr>
<h2 id='format_public_fields'>Format a Microsoft Graph or Azure object</h2><span id='topic+format_public_fields'></span><span id='topic+format_public_methods'></span>

<h3>Description</h3>

<p>Miscellaneous functions for printing Microsoft Graph and Azure R6 objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_public_fields(env, exclude = character(0))

format_public_methods(env)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_public_fields_+3A_env">env</code></td>
<td>
<p>An R6 object's environment for printing.</p>
</td></tr>
<tr><td><code id="format_public_fields_+3A_exclude">exclude</code></td>
<td>
<p>Objects in <code>env</code> to exclude from the printout.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are utilities to aid in printing R6 objects created by this package or its descendants. They are not meant to be called by the user.
</p>

<hr>
<h2 id='graph_request'>Microsoft Graph request</h2><span id='topic+graph_request'></span>

<h3>Description</h3>

<p>Class representing a request to the Microsoft Graph API. Currently this is used only in building a batch call.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>graph_request</code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new request object with the given parameters. See 'Details' below.
</p>
</li>
<li> <p><code>batchify()</code>: Generate a list object suitable for incorporating into a call to the batch endpoint.
</p>
</li></ul>



<h3>Details</h3>

<p>The <code>initialize()</code> method takes the following arguments, representing the components of a HTTPS request:
</p>

<ul>
<li> <p><code>op</code>: The path of the HTTPS URL, eg <code style="white-space: pre;">&#8288;/me/drives&#8288;</code>.
</p>
</li>
<li> <p><code>body</code>: The body of the HTTPS request, if it is a PUT, POST or PATCH.
</p>
</li>
<li> <p><code>options</code>: A list containing the query parameters for the URL.
</p>
</li>
<li> <p><code>headers</code>: Any optional HTTP headers for the request.
</p>
</li>
<li> <p><code>encode</code>: If a request body is present, how it should be encoded when sending it to the endpoint. The default is <code>json</code>, meaning it will be sent as JSON text; an alternative is <code>raw</code>, for binary data.
</p>
</li>
<li> <p><code>http_verb</code>: One of &quot;GET&quot; (the default), &quot;DELETE&quot;, &quot;PUT&quot;, &quot;POST&quot;, &quot;HEAD&quot;, or &quot;PATCH&quot;.
</p>
</li></ul>

<p>This class is currently used only for building batch calls. Future versions of AzureGraph may be refactored to use it in general API calls as well.
</p>


<h3>See Also</h3>

<p><a href="#topic+call_batch_endpoint">call_batch_endpoint</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/json-batching">Batch endpoint documentation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>graph_request$new("me")

# a new email message in Outlook
graph_request$new("me/messages",
    body=list(
        body=list(
            content="Hello from R",
            content_type="text"
        ),
        subject="Hello",
        toRecipients="bob@example.com"
    ),
    http_verb="POST"
)
</code></pre>

<hr>
<h2 id='is_app'>Informational functions</h2><span id='topic+is_app'></span><span id='topic+is_service_principal'></span><span id='topic+is_user'></span><span id='topic+is_group'></span><span id='topic+is_directory_role'></span><span id='topic+is_aad_object'></span><span id='topic+is_msgraph_object'></span>

<h3>Description</h3>

<p>These functions return whether the object is of the corresponding class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_app(object)

is_service_principal(object)

is_user(object)

is_group(object)

is_directory_role(object)

is_aad_object(object)

is_msgraph_object(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_app_+3A_object">object</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean.
</p>

<hr>
<h2 id='ms_graph'>Microsoft Graph</h2><span id='topic+ms_graph'></span>

<h3>Description</h3>

<p>Base class for interacting with Microsoft Graph API.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_graph</code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><code>new(tenant, app, ...)</code>: Initialize a new Microsoft Graph connection with the given credentials. See 'Authentication' for more details.
</p>
</li>
<li> <p><code>create_app(name, ..., add_password=TRUE, password_name=NULL, password_duration=2, certificate=NULL, create_service_principal=TRUE)</code>: Creates a new app registration in Azure Active Directory. See 'App creation' below.
</p>
</li>
<li> <p><code>get_app(app_id, object_id)</code>: Retrieves an existing app registration, via either its app ID or object ID.
</p>
</li>
<li> <p><code>list_apps(filter=NULL, n=Inf)</code>: Lists the app registrations in the current tenant.
</p>
</li>
<li> <p><code>delete_app(app_id, object_id, confirm=TRUE)</code>: Deletes an existing app registration. Any associated service principal will also be deleted.
</p>
</li>
<li> <p><code>create_service_principal(app_id, ...)</code>: Creates a service principal for a app registration.
</p>
</li>
<li> <p><code>get_service_principal()</code>: Retrieves an existing service principal.
</p>
</li>
<li> <p><code>list_service_principals(filter=NULL, n=Inf)</code>: Lists the service principals in the current tenant.
</p>
</li>
<li> <p><code>delete_service_principal()</code>: Deletes an existing service principal.
</p>
</li>
<li> <p><code>create_user(name, email, enabled=TRUE, ..., password=NULL, force_password_change=TRUE)</code>: Creates a new user account. By default this will be a work account (not social or local) in the current tenant, and will have a randomly generated password that must be changed at next login.
</p>
</li>
<li> <p><code>get_user(user_id, email, name)</code>: Retrieves an existing user account. You can supply either the user ID, email address, or display name. The default is to return the logged-in user.
</p>
</li>
<li> <p><code>list_users(filter=NULL, n=Inf)</code>: Lists the users in the current tenant.
</p>
</li>
<li> <p><code>delete_user(user_id, email, name, confirm=TRUE)</code>: Deletes a user account.
</p>
</li>
<li> <p><code>create_group(name, email, ...)</code>: Creates a new group. Note that only security groups can be created via the Microsoft Graph API.
</p>
</li>
<li> <p><code>get_group(group_id, name)</code>: Retrieves an existing group.
</p>
</li>
<li> <p><code>list_groups(filter=NULL, n=Inf)</code>: Lists the groups in the current tenant.
</p>
</li>
<li> <p><code>delete_group(group_id, name, confirm=TRUE)</code>: Deletes a group.
</p>
</li>
<li> <p><code>call_graph_endpoint(op="", ...)</code>: Calls the Microsoft Graph API using this object's token and tenant as authentication arguments. See <a href="#topic+call_graph_endpoint">call_graph_endpoint</a>.
</p>
</li>
<li> <p><code>call_batch_endpoint(requests=list(), ...)</code>: Calls the batch endpoint with a list of individual requests. See <a href="#topic+call_batch_endpoint">call_batch_endpoint</a>.
</p>
</li>
<li> <p><code>get_aad_object(id)</code>: Retrieves an arbitrary Azure Active Directory object by ID.
</p>
</li></ul>



<h3>Authentication</h3>

<p>The recommended way to authenticate with Microsoft Graph is via the <a href="#topic+create_graph_login">create_graph_login</a> function, which creates a new instance of this class.
</p>
<p>To authenticate with the <code>ms_graph</code> class directly, provide the following arguments to the <code>new</code> method:
</p>

<ul>
<li> <p><code>tenant</code>: Your tenant ID. This can be a name (&quot;myaadtenant&quot;), a fully qualified domain name (&quot;myaadtenant.onmicrosoft.com&quot; or &quot;mycompanyname.com&quot;), or a GUID.
</p>
</li>
<li> <p><code>app</code>: The client/app ID to use to authenticate with Azure Active Directory. The default is to login interactively using the Azure CLI cross-platform app, but it's recommended to supply your own app credentials if possible.
</p>
</li>
<li> <p><code>password</code>: if <code>auth_type == "client_credentials"</code>, the app secret; if <code>auth_type == "resource_owner"</code>, your account password.
</p>
</li>
<li> <p><code>username</code>: if <code>auth_type == "resource_owner"</code>, your username.
</p>
</li>
<li> <p><code>certificate</code>: If 'auth_type == &quot;client_credentials&quot;, a certificate to authenticate with. This is a more secure alternative to using an app secret.
</p>
</li>
<li> <p><code>auth_type</code>: The OAuth authentication method to use, one of &quot;client_credentials&quot;, &quot;authorization_code&quot;, &quot;device_code&quot; or &quot;resource_owner&quot;. See <a href="AzureAuth.html#topic+get_azure_token">get_azure_token</a> for how the default method is chosen, along with some caveats.
</p>
</li>
<li> <p><code>version</code>: The Azure Active Directory (AAD) version to use for authenticating.
</p>
</li>
<li> <p><code>host</code>: your Microsoft Graph host. Defaults to <code style="white-space: pre;">&#8288;https://graph.microsoft.com/&#8288;</code>.
</p>
</li>
<li> <p><code>aad_host</code>: Azure Active Directory host for authentication. Defaults to <code style="white-space: pre;">&#8288;https://login.microsoftonline.com/&#8288;</code>. Change this if you are using a government or private cloud.
</p>
</li>
<li> <p><code>scopes</code>: The Microsoft Graph scopes (permissions) to obtain for this Graph login. Only for <code>version=2</code>.
</p>
</li>
<li> <p><code>token</code>: Optionally, an OAuth 2.0 token, of class <a href="AzureAuth.html#topic+AzureToken">AzureAuth::AzureToken</a>. This allows you to reuse the authentication details for an existing session. If supplied, all other arguments will be ignored.
</p>
</li></ul>



<h3>App creation</h3>

<p>The <code>create_app</code> method creates a new app registration. By default, a new app will have a randomly generated strong password with duration of 2 years. To skip assigning a password, set the <code>add_password</code> argument to FALSE.
</p>
<p>The <code>certificate</code> argument allows authenticating via a certificate instead of a password. This should be a character string containing the certificate public key (aka the CER file). Alternatively it can be an list, or an object of class <code>AzureKeyVault::stored_cert</code> representing a certificate stored in an Azure Key Vault. See the examples below.
</p>
<p>A new app will also have a service principal created for it by default. To disable this, set <code>create_service_principal=FALSE</code>.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_graph_login">create_graph_login</a>, <a href="#topic+get_graph_login">get_graph_login</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# start a new Graph session
gr &lt;- ms_graph$new(tenant="myaadtenant.onmicrosoft.com")

# authenticate with credentials in a file
gr &lt;- ms_graph$new(config_file="creds.json")

# authenticate with device code
gr &lt;- ms_graph$new(tenant="myaadtenant.onmicrosoft.com", app="app_id", auth_type="device_code")

# retrieve an app registration
gr$get_app(app_id="myappid")

# create a new app and associated service principal, set password duration to 10 years
app &lt;- gr$create_app("mynewapp", password_duration=10)

# delete the app
gr$delete_app(app_id=app$properties$appId)
# ... but better to call the object's delete method directly
app$delete()

# create an app with authentication via a certificate
cert &lt;- readLines("mycert.cer")
gr$create_app("mycertapp", password=FALSE, certificate=cert)

# retrieving your own user details (assuming interactive authentication)
gr$get_user()

# retrieving another user's details
gr$get_user("username@myaadtenant.onmicrosoft.com")
gr$get_user(email="firstname.lastname@mycompany.com")
gr$get_user(name="Hong Ooi")

# get an AAD object (a group)
id &lt;- gr$get_user()$list_group_memberships()[1]
gr$get_aad_object(id)

# list the users in the tenant
gr$list_users()

# list (guest) users with a 'gmail.com' email address
gr$list_users(filter="endsWith(mail,'gmail.com')")

# list Microsoft 365 groups
gr$list_groups(filter="groupTypes/any(c:c eq 'Unified')")


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_graph_pager'>Pager object for Graph list results</h2><span id='topic+ms_graph_pager'></span>

<h3>Description</h3>

<p>Class representing an <em>iterator</em> for a set of paged query results.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_graph_pager</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>output</code>: What the pager should yield on each iteration, either &quot;data.frame&quot;,&quot;list&quot; or &quot;object&quot;. See 'Value' below.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new user object. See 'Initialization' below.
</p>
</li>
<li> <p><code>has_data()</code>: Returns TRUE if there are pages remaining in the iterator, or FALSE otherwise.
</p>
</li></ul>



<h3>Active bindings</h3>


<ul>
<li> <p><code>value</code>: The returned value on each iteration of the pager.
</p>
</li></ul>



<h3>Initialization</h3>

<p>The recommended way to create objects of this class is via the <code>ms_object$get_list_pager()</code> method, but it can also be initialized directly. The arguments to the <code>new()</code> method are:
</p>

<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>first_page</code>: A list containing the first page of results, generally from a call to <code>call_graph_endpoint()</code> or the <code>do_operation()</code> method of an AzureGraph R6 object.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;next_link_name,value_name&#8288;</code>: The names of the components of <code>first_page</code> containing the link to the next page, and the set of values for the page respectively. The default values are <code style="white-space: pre;">&#8288;@odata.nextLink&#8288;</code> and <code>value</code>.
</p>
</li>
<li> <p><code>generate_objects</code>: Whether the iterator should return a list containing the parsed JSON for the page values, or convert it into a list of R6 objects. See 'Value' below.
</p>
</li>
<li> <p><code>type_filter</code>: Any extra arguments required to initialise the returned objects. Only used if <code>generate_objects</code> is TRUE.
</p>
</li>
<li> <p><code>default_generator</code>: The default generator object to use when converting a list of properties into an R6 object, if the class can't be detected. Defaults to <code>ms_object</code>. Only used if <code>generate_objects</code> is TRUE.
</p>
</li>
<li> <p><code>...</code>: Any extra arguments required to initialise the returned objects. Only used if <code>generate_objects</code> is TRUE.
</p>
</li></ul>



<h3>Value</h3>

<p>The <code>value</code> active binding returns the page values for each iteration of the pager. This can take one of 3 forms, based on the initial format of the first page and the <code>generate_objects</code> argument.
</p>
<p>If the first page of results is a data frame (each item has been converted into a row), then the pager will return results as data frames. In this case, the <code>output</code> field is automatically set to &quot;data.frame&quot; and the <code>generate_objects</code> initialization argument is ignored. Usually this will be the case when the results are meant to represent external data, eg items in a SharePoint list.
</p>
<p>If the first page of results is a list, the <code>generate_objects</code> argument sets whether to convert the items in each page into R6 objects defined by the AzureGraph class framework. If <code>generate_objects</code> is TRUE, the <code>output</code> field is set to &quot;object&quot;, and if <code>generate_objects</code> is FALSE, the <code>output</code> field is set to &quot;list&quot;.
</p>


<h3>See Also</h3>

<p><a href="#topic+ms_object">ms_object</a>, <a href="#topic+extract_list_values">extract_list_values</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/paging">Paging documentation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# list direct memberships
firstpage &lt;- call_graph_endpoint(token, "me/memberOf")

pager &lt;- ms_graph_pager$new(token, firstpage)
pager$has_data()
pager$value

# once all the pages have been returned
isFALSE(pager$has_data())
is.null(pager$value)

# returning items, 1 per page, as raw lists of properties
firstpage &lt;- call_graph_endpoint(token, "me/memberOf", options=list(`$top`=1))
pager &lt;- ms_graph_pager$new(token, firstpage, generate_objects=FALSE)
lst &lt;- NULL
while(pager$has_data())
    lst &lt;- c(lst, pager$value)

# returning items as a data frame
firstdf &lt;- call_graph_endpoint(token, "me/memberOf", options=list(`$top`=1),
                               simplify=TRUE)
pager &lt;- ms_graph_pager$new(token, firstdf)
df &lt;- NULL
while(pager$has_data())
    df &lt;- vctrs::vec_rbin(df, pager$value)


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_object'>Microsoft Graph object</h2><span id='topic+ms_object'></span>

<h3>Description</h3>

<p>Base class representing a object in Microsoft Graph. All other Graph object classes ultimately inherit from this class.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this object.
</p>
</li>
<li> <p><code>type</code>: The type of object, in a human-readable format.
</p>
</li>
<li> <p><code>properties</code>: The object properties, as obtained from the Graph host.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new directory object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete an object. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the object information in Azure Active Directory.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the object.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the data in Azure Active Directory.
</p>
</li>
<li> <p><code>get_list_pager(...)</code>: Returns a pager object, which is an <em>iterator</em> for a set of paged query results. See 'Paged results' below.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Objects of this class should not be created directly. Instead, create an object of the appropriate subclass.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>Paged results</h3>

<p>Microsoft Graph returns lists in pages, with each page containing a subset of objects and a link to the next page. AzureGraph provides an iterator-based API that lets you access each page individually, or collect them all into a single object.
</p>
<p>To create a new pager object, call the <code>get_list_pager()</code> method with the following arguments:
</p>

<ul>
<li> <p><code>lst</code>: A list containing the first page of results, generally from a call to the <code>do_operation()</code> method.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;next_link_name,value_name&#8288;</code>: The names of the components of <code>first_page</code> containing the link to the next page, and the set of values for the page respectively. The default values are <code style="white-space: pre;">&#8288;@odata.nextLink&#8288;</code> and <code>value</code>.
</p>
</li>
<li> <p><code>generate_objects</code>: Whether the iterator should return a list containing the parsed JSON for the page values, or convert it into a list of R6 objects.
</p>
</li>
<li> <p><code>type_filter</code>: Any extra arguments required to initialise the returned objects. Only used if <code>generate_objects</code> is TRUE.
</p>
</li>
<li> <p><code>default_generator</code>: The default generator object to use when converting a list of properties into an R6 object, if the class can't be detected. Defaults to <code>ms_object</code>. Only used if <code>generate_objects</code> is TRUE.
</p>
</li>
<li> <p><code>...</code>: Any extra arguments required to initialise the returned objects. Only used if <code>generate_objects</code> is TRUE.
</p>
</li></ul>

<p>This returns an object of class <a href="#topic+ms_graph_pager">ms_graph_pager</a>, which is an <em>iterator</em> for the set of paged results. Each call to the object's <code>value</code> active binding yields the next page. When all pages have been returned, <code>value</code> contains NULL.
</p>
<p>The format of the returned values can take one of 3 forms, based on the initial format of the first page and the <code>generate_objects</code> argument.
</p>
<p>If the first page of results is a data frame (each item has been converted into a row), then the pager will return results as data frames. In this case, the <code>output</code> field is automatically set to &quot;data.frame&quot; and the <code>generate_objects</code> initialization argument is ignored. Usually this will be the case when the results are meant to represent external data, eg items in a SharePoint list.
</p>
<p>If the first page of results is a list, the <code>generate_objects</code> argument sets whether to convert the items in each page into R6 objects defined by the AzureGraph class framework. If <code>generate_objects</code> is TRUE, the <code>output</code> field is set to &quot;object&quot;, and if <code>generate_objects</code> is FALSE, the <code>output</code> field is set to &quot;list&quot;.
</p>
<p>You can also call the <code>extract_list_values()</code> function to get all or some of the values from a pager, without having to manually combine the pages together.
</p>


<h3>Deprecated methods</h3>

<p>The following methods are private and <strong>deprecated</strong>, and form the older AzureGraph API for accessing paged results. They will eventually be removed.
</p>

<ul>
<li> <p><code>get_paged_list(lst, next_link_name, value_name, simplify, n)</code>: This method reconstructs the list, given the first page.
</p>
</li>
<li> <p><code>init_list_objects(lst, type_filter, default_generator, ...)</code>: <code>get_paged_list</code> returns a raw list, the result of parsing the JSON response from the Graph host. This method converts the list into actual R6 objects.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+ms_graph">ms_graph</a>, <a href="#topic+az_object">az_object</a>, <a href="#topic+ms_graph_pager">ms_graph_pager</a>, <a href="#topic+extract_list_values">extract_list_values</a>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>

<hr>
<h2 id='named_list'>Miscellaneous utility functions</h2><span id='topic+named_list'></span><span id='topic+is_empty'></span>

<h3>Description</h3>

<p>Miscellaneous utility functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>named_list(lst = NULL, name_fields = "name")

is_empty(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="named_list_+3A_lst">lst</code></td>
<td>
<p>A named list of objects.</p>
</td></tr>
<tr><td><code id="named_list_+3A_name_fields">name_fields</code></td>
<td>
<p>The components of the objects in <code>lst</code>, to be used as names.</p>
</td></tr>
<tr><td><code id="named_list_+3A_x">x</code></td>
<td>
<p>For <code>is_empty</code>, An R object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>named_list</code> extracts from each object in <code>lst</code>, the components named by <code>name_fields</code>. It then constructs names for <code>lst</code> from these components, separated by a <code>"/"</code>.
</p>


<h3>Value</h3>

<p>For <code>named_list</code>, the list that was passed in but with names. An empty input results in a <em>named list</em> output: a list of length 0, with a <code>names</code> attribute.
</p>
<p>For <code>is_empty</code>, whether the length of the object is zero (this includes the special case of <code>NULL</code>).
</p>

<hr>
<h2 id='register_graph_class'>Extensible registry of Microsoft Graph classes that AzureGraph supports</h2><span id='topic+register_graph_class'></span>

<h3>Description</h3>

<p>Extensible registry of Microsoft Graph classes that AzureGraph supports
</p>


<h3>Usage</h3>

<pre><code class='language-R'>register_graph_class(name, R6_generator, check_function)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="register_graph_class_+3A_name">name</code></td>
<td>
<p>The name of the Graph class, eg &quot;user&quot;, &quot;servicePrincipal&quot;, etc.</p>
</td></tr>
<tr><td><code id="register_graph_class_+3A_r6_generator">R6_generator</code></td>
<td>
<p>An R6 class generator corresponding to this Graph class.</p>
</td></tr>
<tr><td><code id="register_graph_class_+3A_check_function">check_function</code></td>
<td>
<p>A boolean function that checks if a list of properties is for an object of this class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As written, AzureGraph knows about a subset of all the object classes contained in Microsoft Graph. These are mostly the classes originating from Azure Active Directory: users, groups, app registrations, service principals and registered devices.
</p>
<p>You can extend AzureGraph by writing your own R6 class that inherits from <code>ms_object</code>. If so, you should also <em>register</em> your class by calling <code>register_graph_class</code> and providing the generator object, along with a check function. The latter should accept a list of object properties (as obtained from the Graph REST API), and return TRUE/FALSE based on whether the object is of your class.
</p>


<h3>Value</h3>

<p>An invisible vector of registered class names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# built-in 'az_user' class, for an AAD user object
register_graph_class("user", az_user,
   function(props) !is.null(props$userPrincipalName))


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
