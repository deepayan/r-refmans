<!DOCTYPE html><html lang="en"><head><title>Help for package dafishr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dafishr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#all_mpas'><p>Marine Protected Areas (MPAs) of Mexico</p></a></li>
<li><a href='#clean_land_points'><p>Clean points falling inland</p></a></li>
<li><a href='#join_mpa_data'><p>Detect fishing vessel presence within Marine Protected Areas polygons in Mexico</p></a></li>
<li><a href='#join_ports_locations'><p>Label points when vessel is at port</p></a></li>
<li><a href='#model_vms'><p>Vessel Modeling with Gaussian Mixture Models</p></a></li>
<li><a href='#mpas_buffers'><p>Buffer around remote Marine Protected Areas, MPAs, of Mexico</p></a></li>
<li><a href='#mx_coastline'><p>Mexican coastline</p></a></li>
<li><a href='#mx_coastline_buffer'><p>Buffer around the Mexican coastline</p></a></li>
<li><a href='#mx_eez'><p>Mexico shape</p></a></li>
<li><a href='#mx_eez_pacific'><p>Economic Exclusive Zone (EEZ) of the Pacific side of Mexico</p></a></li>
<li><a href='#mx_inland'><p>Area inland of Mexico</p></a></li>
<li><a href='#mx_ports'><p>Ports and Marinas of Mexico</p></a></li>
<li><a href='#mx_shape'><p>Mexico mainland</p></a></li>
<li><a href='#pacific_landings'><p>Catch data from the vessels in Mexico</p></a></li>
<li><a href='#pelagic_vessels_permits'><p>List of vessels with pelagic fishing permits</p></a></li>
<li><a href='#preprocessing_vms'><p>Preprocessing Vessel Monitoring System data</p></a></li>
<li><a href='#remote_mpas'><p>Remote Marine Protected Areas (MPAs) of Mexico</p></a></li>
<li><a href='#sample_dataset'><p>Vessel Monitoring System, VMS, sample dataset from Mexican fishery commission</p></a></li>
<li><a href='#vms_clean'><p>Fixing dates and column names</p></a></li>
<li><a href='#vms_download'><p>Download Vessel Monitoring System, VMS, raw data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Download, Wrangle, and Analyse Vessel Monitoring System Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows to download, clean and analyse raw Vessel Monitoring System, VMS, data from
    Mexican government. You can use the vms_download() function to
    download raw data, or you can use the sample_dataset provided within
    the package. You can follow the tutorial in the vignette available at
    <a href="https://cbmc-gcmp.github.io/dafishr/index.html">https://cbmc-gcmp.github.io/dafishr/index.html</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/CBMC-GCMP/dafishr">https://github.com/CBMC-GCMP/dafishr</a>,
<a href="https://cbmc-gcmp.github.io/dafishr/">https://cbmc-gcmp.github.io/dafishr/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/CBMC-GCMP/dafishr/issues/">https://github.com/CBMC-GCMP/dafishr/issues/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, fst, ggplot2, lubridate, magrittr, mixtools, readr,
readxl, rlang, sf, stringr, tibble, tidyr, tidyselect, utils,
vroom</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-22 15:16:44 UTC; fabiofavoretto</td>
</tr>
<tr>
<td>Author:</td>
<td>Fabio Favoretto <a href="https://orcid.org/0000-0002-6493-4254"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Eduardo Leon Solorzano [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fabio Favoretto &lt;fabio@gocmarineprogram.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-22 22:10:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='all_mpas'>Marine Protected Areas (MPAs) of Mexico</h2><span id='topic+all_mpas'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing shapefiles of MPA polygons in Mexico
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_mpas
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 24 features and 5 fields
</p>

<dl>
<dt>NOMBRE</dt><dd><p>Name of the MPA in Spanish</p>
</dd>
<dt>CAT_DECRET</dt><dd><p>Decree category, which define the type of MPA</p>
</dd>
<dt>ESTADOS</dt><dd><p>State that have jurisdiction on the MPA</p>
</dd>
<dt>MUNICIPIOS</dt><dd><p>Municipality that have jurisdiction on the MPA</p>
</dd>
<dt>REGION</dt><dd><p>General regional localization of the MPA (in Spanish)</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="http://sig.conanp.gob.mx/">http://sig.conanp.gob.mx/</a>
</p>

<hr>
<h2 id='clean_land_points'>Clean points falling inland</h2><span id='topic+clean_land_points'></span>

<h3>Description</h3>

<p>This functions eliminates points falling inland by using <code>st_difference()</code> function from the <code>sf</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_land_points(x, mx_inland = mx_inland)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clean_land_points_+3A_x">x</code></td>
<td>
<p>A data.frame containing latitude and longitude coordinates of vessels tracks to be cleaned by land area</p>
</td></tr>
<tr><td><code id="clean_land_points_+3A_mx_inland">mx_inland</code></td>
<td>
<p>is a shapefile loaded with the packages representing inland Mexico area, it can be uploaded with <code style="white-space: pre;">&#8288;data("mx_inland)&#8288;</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Points falling inland in Vessel Monitoring System, VMS, dataset are obvious mistakes, thus need to be eliminated from the data.
The function calls a stored shapefile <code>mx_inland</code> which is a custom <code>sf</code> object
created using a coastline buffer to avoid eliminating points because of lack of
precision within the shapefiles.
The function works with any dataset containing coordinate points in <code>crs = 4326</code>
and named <code>latitude</code> and <code>longitude</code>. See first example with a
non-VMS dataset.
A second example below shows the usage on VMS sample data.
</p>


<h3>Value</h3>

<p>A data.frame object
</p>


<h3>Warning</h3>

<p>This function takes a while!! To test you can use the <code>dplyr::sample_n()</code> function as it is shown in the example.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# with non VMS data
x &lt;- data.frame(
  longitude = runif(1000, min = -150, max = -80),
  latitude = runif(1000, min = 15, max = 35)
)
data("mx_inland")
x &lt;- clean_land_points(x, mx_inland)

# using sample_dataset

data("sample_dataset", "mx_inland")

vms_cleaned &lt;- vms_clean(sample_dataset)
vms_no_land &lt;- clean_land_points(vms_cleaned, mx_inland)

# You can check the results by plotting the data

vms_cleaned_sf &lt;- sf::st_as_sf(vms_cleaned, coords = c("longitude", "latitude"), crs = 4326)

vms_no_land_sf &lt;- sf::st_as_sf(vms_no_land, coords = c("longitude", "latitude"), crs = 4326)

library(ggplot2)
ggplot(vms_cleaned_sf) +
  geom_sf(col = "red") +
  geom_sf(data = vms_no_land_sf, col = "black")

# in the provided example only few inland points are eliminated.
# There are more evident one within historical data.

</code></pre>

<hr>
<h2 id='join_mpa_data'>Detect fishing vessel presence within Marine Protected Areas polygons in Mexico</h2><span id='topic+join_mpa_data'></span>

<h3>Description</h3>

<p>The function spatially joins the Vessels Monitoring System, VMS, points with the Marine Protected Area, MPAs, polygons in Mexico.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>join_mpa_data(x, all_mpas = all_mpas)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="join_mpa_data_+3A_x">x</code></td>
<td>
<p>A data.frame with VMS data that must contain columns longitude and latitude</p>
</td></tr>
<tr><td><code id="join_mpa_data_+3A_all_mpas">all_mpas</code></td>
<td>
<p>A shape file that contains all MPA polygons in Mexico you can upload this using <code>data("all_mpas")</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>It adds three columns <code>zone</code>, <code>mpa_decree</code>, <code>state</code>, <code>municipality</code>, <code>region</code>, which are data from the
MPAs polygon. <code>zone</code> contains the name of the MPA (in Spanish) and when the vessel is outside an MPA polygon is dubbed as <code style="white-space: pre;">&#8288;open area&#8288;</code>,
<code>mpa_decree</code> contains the type of MPA (such as National Park, etc.),
<code>state</code> contains the Mexican state with jurisdiction on the MPA, <code>municipality</code> contains the Mexican municipality with jurisdiction over the MPA,
and <code>region</code> contains the overall location of the MPA (in Spanish)
</p>


<h3>Value</h3>

<p>A data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Use sample_dataset
data("sample_dataset")
data("all_mpas")
vms_cleaned &lt;- vms_clean(sample_dataset)
vms_mpas &lt;- join_mpa_data(vms_cleaned, all_mpas)


# Plotting data
# Points NOT inside MPA are removed to reduce data size
vms_mpas_sub &lt;- vms_mpas  |&gt;
  dplyr::filter(zone != "open area")

vms_mpas_sf &lt;- sf::st_as_sf(vms_mpas_sub, coords = c("longitude", "latitude"), crs = 4326)

# Loading Mexico shapefile
data("mx_shape")

# Map
library(ggplot2)
ggplot(mx_shape, col = "gray90") +
  geom_sf(data = all_mpas, fill = "gray60") +
  geom_sf(data = vms_mpas_sf, aes(col = zone)) +
  theme_void() +
  theme(legend.position = "")
</code></pre>

<hr>
<h2 id='join_ports_locations'>Label points when vessel is at port</h2><span id='topic+join_ports_locations'></span>

<h3>Description</h3>

<p>The function joins ports locations using data from ports buffers. <code>mx_ports</code> data is used which is
provided by INEGI https://en.www.inegi.org.mx/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>join_ports_locations(x, mx_ports = mx_ports, buffer_size = 0.15)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="join_ports_locations_+3A_x">x</code></td>
<td>
<p>a data.frame with latitude and longitude coordinates</p>
</td></tr>
<tr><td><code id="join_ports_locations_+3A_mx_ports">mx_ports</code></td>
<td>
<p>is a shapefile of point data storing coordinates of ports and marina in Mexico, you can upload this using <code>data("mx_ports")</code></p>
</td></tr>
<tr><td><code id="join_ports_locations_+3A_buffer_size">buffer_size</code></td>
<td>
<p>a number (double) indicating the size of the buffer for the ports to implement</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function adds a <code>location</code> column indicating if the vessel was at port or at sea.
</p>


<h3>Value</h3>

<p>A data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# With sample data

data("sample_dataset")
data("mx_ports")
vms_cleaned &lt;- vms_clean(sample_dataset)

# It is a good idea to subsample when testing... it takes a while on the full data!

vms_subset &lt;- dplyr::sample_n(vms_cleaned, 1000)
with_ports &lt;- join_ports_locations(vms_subset)
with_ports_sf &lt;- sf::st_as_sf(with_ports, coords = c("longitude", "latitude"), crs = 4326)

data("mx_shape")
library(ggplot2)
ggplot(mx_shape) +
  geom_sf(col = "gray90") +
  geom_sf(data = with_ports_sf, aes(col = location)) +
  facet_wrap(~location) +
  theme_bw()
</code></pre>

<hr>
<h2 id='model_vms'>Vessel Modeling with Gaussian Mixture Models</h2><span id='topic+model_vms'></span>

<h3>Description</h3>

<p>This function uses <code>normalmixEM</code> from the <code>mixtools</code> package to model speed of vessels and estimates their behavior.
Specifically, if the vessel was in a fishing activity or cruising
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_vms(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_vms_+3A_df">df</code></td>
<td>
<p>a data.frame preprocessed using the <code>preprocessing_vms()</code> function from this package</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with a <code>vessel_state</code> column with the type of model implemented
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
preprocessing_vms(sample_dataset, destination.folder = tempdir())
df &lt;- fst::read_fst(paste0(tempdir(), "/vms_2019_1_1_10_preprocessed.fst"))
model_vms(df)

</code></pre>

<hr>
<h2 id='mpas_buffers'>Buffer around remote Marine Protected Areas, MPAs, of Mexico</h2><span id='topic+mpas_buffers'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing shapefiles of buffers around remote MPAs in Mexico.
The buffer equals the area inside each MPA polygon and was created to assess differences in fishing
activity inside or outside each of the remote MPAs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpas_buffers
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 5 features and 2 fields
</p>

<dl>
<dt>Name</dt><dd><p>Name of the MPAs to which the buffer correspond</p>
</dd>
<dt>Description</dt><dd><p>empty</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>this project
</p>

<hr>
<h2 id='mx_coastline'>Mexican coastline</h2><span id='topic+mx_coastline'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing a the Mexican coastline shapefile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mx_coastline
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 177 features and 3 fields
</p>

<dl>
<dt>featurecla</dt><dd><p>Name of the object</p>
</dd>
<dt>scalerank</dt><dd><p>resolution rank</p>
</dd>
<dt>min_zoom</dt><dd><p>zoom precision</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://cran.r-project.org/package=rnaturalearth">https://cran.r-project.org/package=rnaturalearth</a>
</p>

<hr>
<h2 id='mx_coastline_buffer'>Buffer around the Mexican coastline</h2><span id='topic+mx_coastline_buffer'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing a buffer around Mexican coastline
that was used to create the inland shapefile available in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mx_coastline_buffer
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 1 feature and 3 fields
</p>

<dl>
<dt>featurecla</dt><dd><p>Name of the object</p>
</dd>
<dt>scalerank</dt><dd><p>resolution rank</p>
</dd>
<dt>min_zoom</dt><dd><p>zoom precision</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://cran.r-project.org/package=rnaturalearth">https://cran.r-project.org/package=rnaturalearth</a>
</p>

<hr>
<h2 id='mx_eez'>Mexico shape</h2><span id='topic+mx_eez'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing the shapefile representing Mexico
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mx_eez
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 1 features and 2 fields
</p>

<dl>
<dt>Name</dt><dd><p>empty</p>
</dd>
<dt>Description</dt><dd><p>empty</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://en.www.inegi.org.mx/">https://en.www.inegi.org.mx/</a>
</p>

<hr>
<h2 id='mx_eez_pacific'>Economic Exclusive Zone (EEZ) of the Pacific side of Mexico</h2><span id='topic+mx_eez_pacific'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing shapefiles of Mexican EEZ in the Pacific
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mx_eez_pacific
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 1 feature and 1 field
</p>

<dl>
<dt>Name</dt><dd><p>Mexican Pacific Exclusive Economic Zone</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://en.www.inegi.org.mx/">https://en.www.inegi.org.mx/</a>
</p>

<hr>
<h2 id='mx_inland'>Area inland of Mexico</h2><span id='topic+mx_inland'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing shapefiles of inland area in Mexico
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mx_inland
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 1 feature and 2 fields
</p>

<dl>
<dt>Name</dt><dd><p>Mexico</p>
</dd>
<dt>Desciption</dt><dd><p>empty</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>modified from Mexican shapefile
</p>

<hr>
<h2 id='mx_ports'>Ports and Marinas of Mexico</h2><span id='topic+mx_ports'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing points representing the locations of Ports and Marinas in Mexico
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mx_ports
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 237 features and 2 fields
</p>

<dl>
<dt>class</dt><dd><p>Type of infrastructure it can be Puerto (Port), or Marina</p>
</dd>
<dt>name</dt><dd><p>Name of the infrastructure (i.e. port or marina)</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://en.www.inegi.org.mx/">https://en.www.inegi.org.mx/</a>
</p>

<hr>
<h2 id='mx_shape'>Mexico mainland</h2><span id='topic+mx_shape'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing a shapefile of Mexico
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mx_shape
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 1 feature and 2 fields
</p>

<dl>
<dt>Name</dt><dd><p>Mexico</p>
</dd>
<dt>Description</dt><dd><p>empty</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://en.www.inegi.org.mx/">https://en.www.inegi.org.mx/</a>
</p>

<hr>
<h2 id='pacific_landings'>Catch data from the vessels in Mexico</h2><span id='topic+pacific_landings'></span>

<h3>Description</h3>

<p>A <code>data.frame</code> object containing catch data per each vessel from 2008 to 2021.
Vessels are only from the Pacific and are only Tuna, Sharks, and Marlin catches.
The dataset was created by wrangling and filtering the raw data (available under request to the authors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pacific_landings
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code>  with 23,231 rows and 5 columns
</p>

<dl>
<dt>date</dt><dd><p>Date of the catch report</p>
</dd>
<dt>rnp_activo</dt><dd><p>Vessel RNP unique ID code</p>
</dd>
<dt>vessel_name</dt><dd><p>Official name of the vessel</p>
</dd>
<dt>catch</dt><dd><p>Final weight of the catch in tons</p>
</dd>
<dt>days_declared</dt><dd><p>Days at sea that were declared at port</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>Data are available under request to CONAPESCA, a raw version of data is available under request to authors
</p>

<hr>
<h2 id='pelagic_vessels_permits'>List of vessels with pelagic fishing permits</h2><span id='topic+pelagic_vessels_permits'></span>

<h3>Description</h3>

<p>A <code>data.frame</code> object extracted from a raw dataset of permits available
under request at dataMares (https://datamares.org/)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pelagic_vessels_permits
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 719 rows and 2 columns.
</p>

<dl>
<dt>RNP</dt><dd><p>Unique code identifying the vessel</p>
</dd>
<dt>vessel_name</dt><dd><p>Name of the vessel</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://www.datamares.org/">https://www.datamares.org/</a>
</p>

<hr>
<h2 id='preprocessing_vms'>Preprocessing Vessel Monitoring System data</h2><span id='topic+preprocessing_vms'></span>

<h3>Description</h3>

<p>This functions bundles all the cleaning functions and allows them to be
easily used in parallel processing to speed up the cleaning of all the Vessel Monitoring System, VMS, data <code>.csv</code> files.
While it runs, it creates a folder called <code>preprocessed</code> that will store VMS data that
underwent the preprocessing. If multiple files are used as input (see examples below) it will create
multiple files. All the outputs are in <code>.fst</code> format, which allows fast upload of large files.
See <code>fst</code> package documentation for further information https://www.fstpackage.org/.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocessing_vms(files.path, destination.folder)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="preprocessing_vms_+3A_files.path">files.path</code></td>
<td>
<p>it can be a path to the file downloaded or the data object itself.
If function is used with a path it adds a <code>file</code> column to the returning data.frame object that
stores the name of the file as a reference.</p>
</td></tr>
<tr><td><code id="preprocessing_vms_+3A_destination.folder">destination.folder</code></td>
<td>
<p>it must record the path to a folder were all the preprocessed files
will be stored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>.fst</code> file saved within a directory chosen by the user, that is created automatically if does not exist, and that stores
each of the files that are used as input to the function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# An example with the `sample.dataset`

preprocessing_vms(sample_dataset, destination.folder = tempdir())


</code></pre>

<hr>
<h2 id='remote_mpas'>Remote Marine Protected Areas (MPAs) of Mexico</h2><span id='topic+remote_mpas'></span>

<h3>Description</h3>

<p>A <code>sf</code> object containing shapefiles of remote MPA polygons in Mexico that are of particular
conservation interest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remote_mpas
</code></pre>


<h3>Format</h3>

<p>A simple feature collection with 5 features and 2 fields
</p>

<dl>
<dt>Name</dt><dd><p>Name of the remote MPA in Spanish</p>
</dd>
<dt>Description</dt><dd><p>empty</p>
</dd>
<dt>geometry</dt><dd><p>column containing geometry details</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="http://sig.conanp.gob.mx/">http://sig.conanp.gob.mx/</a>
</p>

<hr>
<h2 id='sample_dataset'>Vessel Monitoring System, VMS, sample dataset from Mexican fishery commission</h2><span id='topic+sample_dataset'></span>

<h3>Description</h3>

<p>A <code>data.frame</code> object extracted from a raw dataset of Vessels Monitoring System, VMS, data from the year 2019.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_dataset
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 10,000 rows and 9 columns.
</p>

<dl>
<dt>Nombre</dt><dd><p>Name of the vessel</p>
</dd>
<dt>RNP</dt><dd><p>Unique code identifing the vessel</p>
</dd>
<dt>Puerto Base</dt><dd><p>Base port where the vessel is officially registered</p>
</dd>
<dt>Permisionario o Concesionario</dt><dd><p>Owner of the vessel or partnership name</p>
</dd>
<dt>FechaRecepcionUnitrac</dt><dd><p>Date as &quot;%d/%m/%Y %H:%M&quot;</p>
</dd>
<dt>Latitud</dt><dd><p>Latitude degree in WGS84, crs = 4326, of the position of the vessel</p>
</dd>
<dt>Longitud</dt><dd><p>Longitude degree in WGS84, crs = 4326, of the position of the vessel</p>
</dd>
<dt>Velocidad</dt><dd><p>Speed in knots of the vessel at that specific time</p>
</dd>
<dt>Rumbo</dt><dd><p>Direction in degrees of the vessel at that specific time</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://www.datos.gob.mx/">https://www.datos.gob.mx/</a>
</p>

<hr>
<h2 id='vms_clean'>Fixing dates and column names</h2><span id='topic+vms_clean'></span>

<h3>Description</h3>

<p>This function cleans raw Vessel Monitoring System, VMS, data column files,
eliminate NULL values in coordinates, parse dates, and returns a <code>data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vms_clean(path_to_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vms_clean_+3A_path_to_data">path_to_data</code></td>
<td>
<p>it can be a path to the file downloaded or the data object itself.
If function is used with a path it adds a <code>file</code> column to the returning data.frame object that
stores the name of the file as a reference.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It takes a raw data file downloaded using the <code>vms_download()</code> function by
specifying directly its path or by referencing a data.frame already stored as an R object.
If path is used, column with the name of the raw file is conveniently added as future reference.
It also split date into three new columns <code>year</code>, <code>month</code>, <code>day</code>, and retains the original <code>date</code> column.
This function can be used with <code>apply</code> functions over a list
of files or it can be paralleled using <code>furrr</code> functions.
</p>


<h3>Value</h3>

<p>A data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using sample dataset, or a data.frame already stored as an object
# It is possible to use a path directly as argument

data("sample_dataset")
cleaned_vms &lt;- vms_clean(sample_dataset)
head(cleaned_vms)

</code></pre>

<hr>
<h2 id='vms_download'>Download Vessel Monitoring System, VMS, raw data</h2><span id='topic+vms_download'></span>

<h3>Description</h3>

<p>This functions download data form the <em>Datos Abiertos</em> initiative
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vms_download(
  year = lubridate::year((Sys.time())) - 1,
  destination.folder,
  check.url.certificate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vms_download_+3A_year">year</code></td>
<td>
<p>year of data that user wants to download are selected default to the last year. A vector of years can also be used.</p>
</td></tr>
<tr><td><code id="vms_download_+3A_destination.folder">destination.folder</code></td>
<td>
<p>can be set to a folder where user want the data to be downloaded into. Defaults to working directory.</p>
</td></tr>
<tr><td><code id="vms_download_+3A_check.url.certificate">check.url.certificate</code></td>
<td>
<p>logical. Under Ubuntu systems the function might draw a certificate error, you can deactivate the certificate check by setting this to <code>FALSE</code> and should work.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data are downloaded from this link: https://www.datos.gob.mx/busca/dataset/localizacion-y-monitoreo-satelital-de-embarcaciones-pesqueras/
Downloaded data will be downloaded and decompressed in a <code>VMS-data</code> folder in
a location chosen by the user by specifying a path in <code>destination.folder</code>.
If a location is not specified it downloads data by default to the current working directory.
Within the main folder, data is organized in different folders by months (in Spanish names)
and within each there are multiple <code>.csv</code> files each containing two weeks of data points.
</p>


<h3>Value</h3>

<p>saves downloaded data into a folder called <code>VMS-data</code> within the directory specified
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Download single year
# in Ubuntu it draws a certificate error when downloading, testing in windows and MacOS
# does not draw that error and you can use default certificate checking.

vms_download(2019, destination.folder = tempdir(), check.url.certificate = FALSE)



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
