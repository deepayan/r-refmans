<!DOCTYPE html><html><head><title>Help for package rncl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rncl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#read_nexus_phylo'><p>Read phylogenetic trees from files</p></a></li>
<li><a href='#rncl'><p>rncl: An R interface to the NEXUS Class Library</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>An Interface to the Nexus Class Library</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.7</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francois Michonneau &lt;francois.michonneau@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An interface to the Nexus Class Library which allows parsing
    of NEXUS, Newick and other phylogenetic tree file formats. It provides
    elements of the file that can be used to build phylogenetic objects
    such as ape's 'phylo' or phylobase's 'phylo4(d)'. This functionality
    is demonstrated with 'read_newick_phylo()' and 'read_nexus_phylo()'.</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.0), progress (&ge; 1.1.2), stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, ape</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, progress</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/fmichonneau/rncl">https://github.com/fmichonneau/rncl</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fmichonneau/rncl/issues">https://github.com/fmichonneau/rncl/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-07 20:06:31 UTC; francois</td>
</tr>
<tr>
<td>Author:</td>
<td>Francois Michonneau
    <a href="https://orcid.org/0000-0002-9092-966X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Ben Bolker <a href="https://orcid.org/0000-0002-2127-0443"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Mark Holder <a href="https://orcid.org/0000-0001-5575-0536"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Paul Lewis <a href="https://orcid.org/0000-0001-9852-8759"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Brian O'Meara <a href="https://orcid.org/0000-0002-0337-5997"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-08 10:20:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='read_nexus_phylo'>Read phylogenetic trees from files</h2><span id='topic+read_nexus_phylo'></span><span id='topic+read_newick_phylo'></span><span id='topic+make_phylo'></span>

<h3>Description</h3>

<p>Create phylo objects from NEXUS or Newick files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_nexus_phylo(
  file,
  simplify = FALSE,
  missing_edge_length = NA,
  show_progress = TRUE,
  ...
)

read_newick_phylo(
  file,
  simplify = FALSE,
  missing_edge_length = NA,
  show_progress = TRUE,
  ...
)

make_phylo(file, simplify = FALSE, missing_edge_length = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_nexus_phylo_+3A_file">file</code></td>
<td>
<p>Path of NEXUS or Newick file</p>
</td></tr>
<tr><td><code id="read_nexus_phylo_+3A_simplify">simplify</code></td>
<td>
<p>If the file includes more than one tree, returns
only the first tree; otherwise, returns a multiPhylo object</p>
</td></tr>
<tr><td><code id="read_nexus_phylo_+3A_missing_edge_length">missing_edge_length</code></td>
<td>
<p>If the tree contains missing edge
lengths, the value to be attributed to these edge lengths. By
default, (<code>missing_edge_length = NA</code>) if at least edge
length is missing, they are all removed. Otherwise, the value
must be a single numeric value. In any case, a warning will
be generated if the tree contains missing edge lengths.</p>
</td></tr>
<tr><td><code id="read_nexus_phylo_+3A_show_progress">show_progress</code></td>
<td>
<p>If <code>TRUE</code> (default)), a progress bar is displayed
during the possibly time consuming step of removing the singletons from
the tree.</p>
</td></tr>
<tr><td><code id="read_nexus_phylo_+3A_...">...</code></td>
<td>
<p>additional parameters to be passed to the rncl function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions read NEXUS or Newick files and return an object of
class phylo/multiPhylo.
</p>


<h3>Value</h3>

<p>A phylo or a multiPhylo object
</p>


<h3>Note</h3>

<p><code>make_phylo</code> will soon be deprecated, use
<code>read_nexus_phylo</code> or <code>read_newick_phylo</code> instead.
</p>


<h3>Author(s)</h3>

<p>Francois Michonneau
</p>


<h3>See Also</h3>

<p>rncl-package
</p>

<hr>
<h2 id='rncl'>rncl: An R interface to the NEXUS Class Library</h2><span id='topic+rncl'></span>

<h3>Description</h3>

<p>rncl provides an interface to the NEXUS Class Library (NCL), a C++
library intended to parse valid NEXUS files as well as other
common formats used in phylogenetic analysis. Currently, rncl
focuses on parsing trees and supports both NEXUS and Newick
formatted files. Because NCL is used by several phylogenetic
software (e.g., MrBayes, Garli), rncl can parse files generated by
these programs. However, other popular programs (including BEAST)
use an extension of the NEXUS file format, and if trees can be
imported, associated annotations (e.g., confidence intervals on
the time since divergence) cannot.
</p>
<p>Returns a list of the elements contained in a NEXUS file used to
build phylogenetic objects in R
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rncl(
  file,
  file.format = c("nexus", "newick"),
  spacesAsUnderscores = TRUE,
  char.all = TRUE,
  polymorphic.convert = TRUE,
  levels.uniform = TRUE,
  show_progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rncl_+3A_file">file</code></td>
<td>
<p>path to a NEXUS or Newick file</p>
</td></tr>
<tr><td><code id="rncl_+3A_file.format">file.format</code></td>
<td>
<p>a character string indicating the type of file to be
parsed.</p>
</td></tr>
<tr><td><code id="rncl_+3A_spacesasunderscores">spacesAsUnderscores</code></td>
<td>
<p>In the NEXUS file format white spaces are not
allowed and are represented by underscores. Therefore, NCL converts
underscores found in taxon labels in the NEXUS file into white spaces
(e.g. <code>species_1</code> will become <code>"species 1"</code>). If you want to
preserve the underscores, set as <code>TRUE</code> (default). This option
affects taxon labels, character labels and state labels.</p>
</td></tr>
<tr><td><code id="rncl_+3A_char.all">char.all</code></td>
<td>
<p>If <code>TRUE</code> (default), returns all characters, even those
excluded in the NEXUS file (only when NEXUS file contains DATA block).</p>
</td></tr>
<tr><td><code id="rncl_+3A_polymorphic.convert">polymorphic.convert</code></td>
<td>
<p>If TRUE (default), converts polymorphic
characters to missing data (only when NEXUS file contains DATA block).</p>
</td></tr>
<tr><td><code id="rncl_+3A_levels.uniform">levels.uniform</code></td>
<td>
<p>If TRUE (default), uses the same levels for all
characters (only when NEXUS file contains DATA block).</p>
</td></tr>
<tr><td><code id="rncl_+3A_show_progress">show_progress</code></td>
<td>
<p>If <code>TRUE</code> (default)), a progress bar is displayed
during the possibly time consuming step of removing the singletons from
the tree.</p>
</td></tr>
<tr><td><code id="rncl_+3A_...">...</code></td>
<td>
<p>additional parameters (currently not in use).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NCL can also parse data associated with species included in NEXUS
files. If you are interested in importing such data, see the
phylobase package.
</p>
<p>NEXUS is a common file format used in phylogenetics to represent
phylogenetic trees, and other types of phylogenetic data. This
function uses NCL (the NEXUS Class Library) to parse NEXUS, Newick
or other common phylogenetic file formats, and returns the
relevant elements as a list. <code>phylo</code> (from the ape package)
or <code>phylo4</code> (from the phylobase package) can be constructed
from the elements contained in this list.
</p>


<h3>Value</h3>

<p>A list that contains the elements extracted from a NEXUS
or a Newick file.
</p>

<ul>
<li> <p><code>taxaNames</code> A vector of the taxa names listed in
the TAXA block of the NEXUS file or inferred from the tree strings
(if block missing or Newick file).
</p>
</li>
<li> <p><code>treeNames</code> A vector listing the names of the trees
</p>
</li>
<li> <p><code>taxonLabelVector</code> A list containing as many
elements as there are trees in the file. Each element is a
character vector that lists the taxon names encountered in the
tree string *in the order they appear*, and therefore may not
match the order they are listed in the translation table.
</p>
</li>
<li> <p><code>parentVector</code>  A list containing as many elements
as there are trees in the file. Each element is a numeric vector
listing the parent node for the node given by its position in the
vector. If the beginning of the vector is 5 5 6, the parent node
of node 1 is 5, the parent of node 2 is 5 and the parent of node 3
is 6. The implicit root of the tree is identified with 0 (node
without a parent).
</p>
</li>
<li><p><code>branchLengthVector</code>  A list containing as many
elements as there are trees in the file. Each element is a numeric
vector listing the edge/branch lengths for the edges in the same
order as nodes are listed in the corresponding <code>parentVector</code>
element. Values of -999 indicate that the value is missing for this
particular edge. The implicit root as a length of 0.
</p>
</li>
<li><p><code>nodeLabelsVector</code>  A list containing as many
elements as there are trees in the file. Each element is a
character vector listing the node labels in the same order as the
nodes are specified in the same order as nodes are listed in the
corresponding <code>parentVector</code> element.
</p>
</li>
<li><p><code>trees</code>  A character vector listing the tree
strings where tip labels have been replaced by their indices in
the <code>taxaNames</code> vector. They do not correspond to the numbers
listed in the translation table that might be associated with the
tree.
</p>
</li>
<li><p><code>dataTypes</code>  A character vector indicating the type
of data associated with the tree (e.g., &ldquo;standard&rdquo;). 
</p>
</li>
<li><p><code>nbCharacters</code>  A numeric vector indicating how
many characters/traits are available. 
</p>
</li>
<li><p><code>charLabels</code>  A character vector listing the names
of the characters/traits that are available. 
</p>
</li>
<li> <p><code>nbStates</code>  A numeric vector listing the number of
possible states for each character/trait.
</p>
</li>
<li> <p><code>stateLabels</code>  A character vector listing in
order, all possible states for each character/trait.
</p>
</li>
<li> <p><code>dataChr</code>  A character vector with as many
elements as there are characters/traits in the dataset. Each
element is string that can be parsed by R to create a factor
vector representing the data found in the file.
</p>
</li>
<li> <p><code>isRooted</code>  A list with as many elements as there
are trees in the file. Each element is a logical indicating
whether the tree is rooted. NCL definition of a rooted tree
differs from the one APE uses in some cases. 
</p>
</li>
<li> <p><code>hasPolytomies</code>  A list with as many elements as
there are trees in the file. Each element is a logical indicating
whether the tree contains polytomies.
</p>
</li>
<li> <p><code>hasSingletons</code>  A list with as many elements as
there are trees in the file. Each element is a logical indicating
whether the tree contains singleton nodes, in other words nodes
with a single descendant (also known as knuckles).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Francois Michonneau
</p>


<h3>References</h3>

<p>Maddison DR, Swofford DL, Maddison WP (1997).
&quot;NEXUS: An extensible file format for systematic information&quot;.
Systematic Biology 46(4) : 590-621.
doi: <a href="https://doi.org/10.1093/sysbio/46.4.590">doi:10.1093/sysbio/46.4.590</a>
</p>
<p>Lewis, P. O. 2003. NCL: a C++ class library for interpreting data
files in NEXUS format. Bioinformatics 19 (17) : 2330-2331.
</p>


<h3>See Also</h3>

<p>For examples on how to use the elements of the list
returned by this function to build tree objects, inspect the
source code of this package, in particular how
<code>read_newick_phylo</code> and <code>read_nexus_phylo</code> work. For a
more complex example that also use the data contained in NEXUS
files, inspect the source code of the <code>readNCL</code> function in
the phylobase package.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
