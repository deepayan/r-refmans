<!DOCTYPE html><html><head><title>Help for package mreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#densityfn'><p>wrapper to evaluate a density function given by a character string as an argument</p></a></li>
<li><a href='#form.add'><p>adds together two formula</p></a></li>
<li><a href='#mreg'><p>To perform regression when discrete outcome variables are missing</p></a></li>
<li><a href='#mreg_package'><p>mreg: Implements the techniques of exact likelihood when the discrete outcome can be missing in a regression mode</p></a></li>
<li><a href='#paper'><p>An example of a function to calculate the effect on the location that depends on previous outcome in an mreg model</p></a></li>
<li><a href='#print.mreg'><p>Prints the coefficients from an mreg object</p></a></li>
<li><a href='#public'><p>Subset of Arthritis Data</p></a></li>
<li><a href='#randfn'><p>wrapper to generate random samples from a density function given by a character string as an argument</p></a></li>
<li><a href='#summary.mreg'><p>Prints a summary of an mreg object</p></a></li>
<li><a href='#unity'><p>The default value of 'modify' function in 'mreg'</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fits Regression Models When the Outcome is Partially Missing</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-26</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the methods described in Bond S, Farewell V, 2006, Exact Likelihood Estimation for a Negative Binomial Regression Model with Missing Outcomes, Biometrics.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/shug0131/mreg">https://github.com/shug0131/mreg</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-26 15:57:24 UTC; sjb277</td>
</tr>
<tr>
<td>Author:</td>
<td>Simon Bond <a href="https://orcid.org/0000-0003-2528-1040"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Vern Farewell [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Simon Bond &lt;simon.bond7@nhs.net&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-26 16:30:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='densityfn'>wrapper to evaluate a density function given by a character string as an argument</h2><span id='topic+densityfn'></span>

<h3>Description</h3>

<p>wrapper to evaluate a density function given by a character string as an argument
</p>


<h3>Usage</h3>

<pre><code class='language-R'>densityfn(x, family, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="densityfn_+3A_x">x</code></td>
<td>
<p>the element of the sample space at which to evaluate the density</p>
</td></tr>
<tr><td><code id="densityfn_+3A_family">family</code></td>
<td>
<p>the name of the density function, character string</p>
</td></tr>
<tr><td><code id="densityfn_+3A_...">...</code></td>
<td>
<p>other named arguments to feed into the density function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value of the density
</p>

<hr>
<h2 id='form.add'>adds together two formula</h2><span id='topic+form.add'></span>

<h3>Description</h3>

<p>adds together two formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>form.add(formula1, formula2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="form.add_+3A_formula1">formula1</code></td>
<td>
<p>a formula</p>
</td></tr>
<tr><td><code id="form.add_+3A_formula2">formula2</code></td>
<td>
<p>a formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>another formula
</p>

<hr>
<h2 id='mreg'>To perform regression when discrete outcome variables are missing</h2><span id='topic+mreg'></span>

<h3>Description</h3>

<p>This software was created for the paper referred to
below. If a longitudinal data base has regularly updated explanatory
variables, but whose outcome variable is only intermittently
collected then we can still perform exact maximum likelihood
estimation of a regression model if the outcome variable is discrete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mreg(
  formula,
  data,
  patid,
  start.theta = NULL,
  modify = unity,
  modify.p = 0,
  mod.formula = ~1,
  density.name = "negbin",
  link = "log",
  iterlim = 100,
  gradtol = 1e-06,
  steptol = 1e-06,
  na.action = NULL,
  print.level = 2,
  zero.start = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mreg_+3A_formula">formula</code></td>
<td>
<p>This is a formula object e.g.  Y~A+B to describe the
location parameter</p>
</td></tr>
<tr><td><code id="mreg_+3A_data">data</code></td>
<td>
<p>This is a data frame in which the variables are recorded</p>
</td></tr>
<tr><td><code id="mreg_+3A_patid">patid</code></td>
<td>
<p>In a longitudinal context this indexes the individuals.
Note that the observations within each patient is assumed to be ordered
according the timing of the observations.</p>
</td></tr>
<tr><td><code id="mreg_+3A_start.theta">start.theta</code></td>
<td>
<p>Optional vector of starting values for location
and nuisance parameters</p>
</td></tr>
<tr><td><code id="mreg_+3A_modify">modify</code></td>
<td>
<p>We may wish to let the location depend on functions of
the previous outcomes. Since these may be missing, we have to
provide a function that can cope with all the potential values the
outcome may have taken. See <code><a href="#topic+paper">paper</a></code></p>
</td></tr>
<tr><td><code id="mreg_+3A_modify.p">modify.p</code></td>
<td>
<p>This is the dimension of the parameters associated
with the modify function.</p>
</td></tr>
<tr><td><code id="mreg_+3A_mod.formula">mod.formula</code></td>
<td>
<p>If we require other variables to interact with the
previous observation we must create a set of variables to use. This is
a one-sided formula e.g. ~X+Z, if we wanted to use those variables.</p>
</td></tr>
<tr><td><code id="mreg_+3A_density.name">density.name</code></td>
<td>
<p>This is the density the increment in outcome is
assumed to follow. It can be one of three values: negbin, poisson, geometric.</p>
</td></tr>
<tr><td><code id="mreg_+3A_link">link</code></td>
<td>
<p>This is the link function <code class="reqn">g(\mu)=\eta</code>. Where <code class="reqn">\eta</code> is a linear
combination of covariates, and <code class="reqn">\mu</code> is the expected value of the
outcome. The link function can be one of four values: identity, log,
logit, hyper.</p>
</td></tr>
<tr><td><code id="mreg_+3A_iterlim">iterlim</code></td>
<td>
<p>The maximum number of iterations allowed for the
<code><a href="stats.html#topic+nlm">nlm</a></code> function.</p>
</td></tr>
<tr><td><code id="mreg_+3A_gradtol">gradtol</code></td>
<td>
<p>The parameter <code>gradtol</code> for the <code><a href="stats.html#topic+nlm">nlm</a></code>
function.</p>
</td></tr>
<tr><td><code id="mreg_+3A_steptol">steptol</code></td>
<td>
<p>The parameter  <code>steptol</code> for the <code><a href="stats.html#topic+nlm">nlm</a></code> function</p>
</td></tr>
<tr><td><code id="mreg_+3A_na.action">na.action</code></td>
<td>
<p>Parameter is not used: If any covariates are missing
the function will return an error.</p>
</td></tr>
<tr><td><code id="mreg_+3A_print.level">print.level</code></td>
<td>
<p>The parameter <code>print.level</code> for the
<code><a href="stats.html#topic+nlm">nlm</a></code> function. Set to the maximum, verbose level.</p>
</td></tr>
<tr><td><code id="mreg_+3A_zero.start">zero.start</code></td>
<td>
<p>It may be the case that it is known that the first
value of the outcome was zero for all individuals, in which case
invoke this TRUE/FALSE option.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns an object of class <code><a href="#topic+mreg">mreg</a></code> which is similar
to a <code><a href="stats.html#topic+lm">lm</a></code> object. It has <code><a href="base.html#topic+print">print</a></code> and
<code><a href="base.html#topic+summary">summary</a></code> methods to display the fitted parameters and standard errors.
</p>


<h3>References</h3>

<p>Bond S, Farewell V, 2006, Exact Likelihood Estimation for a
Negative Binomial Regression Model with Missing Outcomes, Biometrics
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.mreg">print.mreg</a></code>, <code><a href="#topic+summary.mreg">summary.mreg</a></code>,
<code><a href="#topic+paper">paper</a></code>, <code><a href="#topic+unity">unity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(public)
## Not run: 
mod1 &lt;- mreg( damaged~offset(log(intervisit.time))+esr.init,
data=public,patid=ptno,print.level=2, iterlim=1000 )
mod.ncar &lt;-mreg(damaged ~ offset(log(intervisit.time)) + esr.init +
         tender + effused + clinic.time, data = public, patid = ptno,
         modify = paper, modify.p = 5, mod.formula = ~art.dur.init,
       density.name = "negbin.ncar", iterlim = 1000, print.level = 2)

## End(Not run)
</code></pre>

<hr>
<h2 id='mreg_package'>mreg: Implements the techniques of exact likelihood when the discrete outcome can be missing in a regression mode</h2><span id='topic+mreg_package'></span><span id='topic+mreg-package'></span>

<h3>Description</h3>

<p>Implements the methods described in Bond S, Farewell V, 2006, Exact Likelihood Estimation for a
Negative Binomial Regression Model with Missing Outcomes, Biometrics,
Submitted. The main function is <code><a href="#topic+mreg">mreg</a></code>.
</p>


<h3>References</h3>

<p>Bond S, Farewell V, 2006, Exact Likelihood Estimation for a
Negative Binomial Regression Model with Missing Outcomes, Biometrics
</p>

<hr>
<h2 id='paper'>An example of a function to calculate the effect on the location that depends on previous outcome in an mreg model</h2><span id='topic+paper'></span>

<h3>Description</h3>

<p>In a regression model one may want to let the linear predictor depend on
previous values of the outcome variable in longitudinal data. When the outcome variable is missing we can still do this but we have to create a
function that calculates a vector of linear predictors with one element
for each of the possible preceding values of the outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paper(x, y, mod.Z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paper_+3A_x">x</code></td>
<td>
<p>is a vector of possible values the previous value of the
response could take.</p>
</td></tr>
<tr><td><code id="paper_+3A_y">y</code></td>
<td>
<p>is an vector of the coefficients. Its length is specified in
the <code><a href="#topic+mreg">mreg</a></code> function by the argument <code>modify.p</code>.</p>
</td></tr>
<tr><td><code id="paper_+3A_mod.z">mod.Z</code></td>
<td>
<p>vector of observed covariates that may interact with the
unobserved preceding outcome corresponding to the observation. It is
taken from the <code><a href="stats.html#topic+model.frame">model.frame</a></code> produced by the <code>mod.formula</code>
argument in <code><a href="#topic+mreg">mreg</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an example function that was used in the paper referred to
below. The user may write their own function as long as it takes the
arguments specified above and returns a vector the same length as
<code>x</code> that will be added to the linear predictor. It is up to the user to ensure that
their function  identifies the correct column of <code>mod.Z</code> using indices
(<code>[]</code> that correspond to the desired variables in  <code>mod.formula</code>.
If any function other than <code><a href="#topic+unity">unity</a></code> (which does nothing to
the linear predictor) is used then it is not possible to produce fitted
values or residuals.
</p>


<h3>Value</h3>

<p>A numeric vector the same length as
<code>x</code> that will be added to the linear predictor.
It also has two subsidiary attributes: <code>par.names</code> names to be
used to label the associated coefficients, and <code>par.dim</code> the
length of this vector of coefficients.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+unity">unity</a></code> <code><a href="#topic+mreg">mreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The function is currently defined as
function(x,y, mod.Z){
  #x is the imputed response
  #y is the set of parameters
 #mod.Z is a VECTOR/matrix of explanatory variables
 rad.type &lt;- cut(x, breaks=c(-1,0,4,9,50))
 if( is.vector(mod.Z)){
   arthdur.first &lt;- rep(mod.Z[2],length(x))
 }
 else{
   arthdur.first &lt;- rep(mod.Z[1,2], length(x))
 }
 X &lt;- model.matrix( ~rad.type+I(x==0):arthdur.first)
 structure( X[,-1, drop=FALSE]%*%y, par.names= colnames( X)[-1],par.dim=dim(X)[2]-1)
}
</code></pre>

<hr>
<h2 id='print.mreg'>Prints the coefficients from an mreg object</h2><span id='topic+print.mreg'></span>

<h3>Description</h3>

<p>Prints the coefficients from an mreg object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mreg'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mreg_+3A_x">x</code></td>
<td>
<p>an mreg object</p>
</td></tr>
<tr><td><code id="print.mreg_+3A_digits">digits</code></td>
<td>
<p>number of digits to print decimals to.</p>
</td></tr>
<tr><td><code id="print.mreg_+3A_...">...</code></td>
<td>
<p>other arguments, not currently used but required for generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It prints the coefficients from an
<code><a href="#topic+mreg">mreg</a></code> regression model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mreg">mreg</a></code> <code><a href="#topic+summary.mreg">summary.mreg</a></code>
</p>

<hr>
<h2 id='public'>Subset of Arthritis Data</h2><span id='topic+public'></span>

<h3>Description</h3>

<p>This is a subset of 100 patients and variables from the clinical data
used in the paper below.
<em>Not to be used in publications without
permission of the authors.</em>
</p>
<p>@format  A data frame with 943 observations on the following 8 variables.
</p>

<dl>
<dt><code>damaged</code></dt><dd><p>The number of radiologically damaged joints</p>
</dd>
<dt><code>intervisit.time</code></dt><dd><p>Time between clinic visits</p>
</dd>
<dt><code>esr.init</code></dt><dd><p>The first ESR measurement</p>
</dd>
<dt><code>art.dur.init</code></dt><dd><p>The duration of arthritis at first
clinic visit</p>
</dd>
<dt><code>tender</code></dt><dd><p>Count of the number of tender joints</p>
</dd>
<dt><code>effused</code></dt><dd><p>Count of the number of effused joints</p>
</dd>
<dt><code>ptno</code></dt><dd><p>Anonymous patient number</p>
</dd>
<dt><code>clinic.time</code></dt><dd><p>Total time spend under clinical care</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>public
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 943 rows and 8 columns.
</p>


<h3>Source</h3>

<p>Bond S, Farewell V, 2006, Exact Likelihood Estimation for a
Negative Binomial Regression Model with Missing Outcomes
</p>

<hr>
<h2 id='randfn'>wrapper to generate random samples from a density function given by a character string as an argument</h2><span id='topic+randfn'></span>

<h3>Description</h3>

<p>wrapper to generate random samples from a density function given by a character string as an argument
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randfn(n, family, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randfn_+3A_n">n</code></td>
<td>
<p>the number of samples to generate</p>
</td></tr>
<tr><td><code id="randfn_+3A_family">family</code></td>
<td>
<p>the name of the density function, character string</p>
</td></tr>
<tr><td><code id="randfn_+3A_...">...</code></td>
<td>
<p>other named arguments to feed into the density function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the vector of samples
</p>

<hr>
<h2 id='summary.mreg'>Prints a summary of an mreg object</h2><span id='topic+summary.mreg'></span>

<h3>Description</h3>

<p>@description Similar to <code><a href="stats.html#topic+summary.glm">summary.glm</a></code>, it prints the coefficients,
standard errors, Wald tests, residuals (if available) and dispersion from
an <code><a href="#topic+mreg">mreg</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mreg'
summary(
  object,
  digits = max(3, getOption("digits") - 3),
  symbolic.cor = object$symbolic.cor,
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mreg_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mreg">mreg</a></code> object</p>
</td></tr>
<tr><td><code id="summary.mreg_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.mreg_+3A_symbolic.cor">symbolic.cor</code></td>
<td>
<p>logical. If <code>TRUE</code>, print the correlations in
a symbolic form (see <code><a href="stats.html#topic+symnum">symnum</a></code>) rather than as numbers.</p>
</td></tr>
<tr><td><code id="summary.mreg_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If <code>TRUE</code>, &lsquo;significance stars&rsquo;
are printed for each coefficient.</p>
</td></tr>
<tr><td><code id="summary.mreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>prints to output a description of the fitted model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mreg">mreg</a></code> <code><a href="#topic+print.mreg">print.mreg</a></code>
</p>

<hr>
<h2 id='unity'>The default value of 'modify' function in 'mreg'</h2><span id='topic+unity'></span>

<h3>Description</h3>

<p>If the location term in a regression model does not depend on any
previously observed values of the outcome in a longitudinal data set,
then we obtain simplification in our estimation procedure when the
outcomes can be missing. Using the default value of <code>unity</code> for the
argument <code>modify</code> in the <code><a href="#topic+mreg">mreg</a></code> function does this.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unity(x, y, mod.Z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unity_+3A_x">x</code></td>
<td>
<p>is a vector of possible values the previous value of the
response could take.</p>
</td></tr>
<tr><td><code id="unity_+3A_y">y</code></td>
<td>
<p>is an vector of the coefficients. Its length is specified in
the <code><a href="#topic+mreg">mreg</a></code> function by the argument <code>modify.p</code>.</p>
</td></tr>
<tr><td><code id="unity_+3A_mod.z">mod.Z</code></td>
<td>
<p>vector of observed covariates that may interact with the
unobserved preceding outcome corresponding to the observation. It is
taken from the <code><a href="stats.html#topic+model.frame">model.frame</a></code> produced by the <code>mod.formula</code>
argument in <code><a href="#topic+mreg">mreg</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function  is the default value for the argument <code>modify</code>  for
<code><a href="#topic+mreg">mreg</a></code>. It does nothing to the linear predictor term.
For this function <code>unity</code> there are no such covariates.
A default value for <code>mod.formula</code> is <code>~1</code>.
</p>


<h3>Value</h3>

<p>A vector of zeroes the same length is the argument <code>x</code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
