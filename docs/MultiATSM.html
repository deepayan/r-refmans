<!DOCTYPE html><html lang="en"><head><title>Help for package MultiATSM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiATSM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MultiATSM'><p>ATSM Package</p></a></li>
<li><a href='#A0N__BnAn'><p>Compute the cross-section loadings of yields of a canonical A0_N model</p></a></li>
<li><a href='#Adjust_Const_Type'><p>Adjust the constant label</p></a></li>
<li><a href='#AdjustOptm_BS'><p>Gathers the estimate of the bootstrap draws</p></a></li>
<li><a href='#AdjustPathFEVDs'><p>Generate paths to save IRFs/GIRFs graphs</p></a></li>
<li><a href='#AdjustPathIRFs'><p>Generate paths to save IRFs/GIRFs graphs</p></a></li>
<li><a href='#AdjustYieldsDates'><p>Makes sure that the time series of yields and risk factors have coincident sample spans</p></a></li>
<li><a href='#Aux_BlockDiag'><p>Transformation of the block diagonal parameters (auxiliary form)</p></a></li>
<li><a href='#Aux_BoundDiag'><p>Transformation of the bounded parameters (auxiliary form)</p></a></li>
<li><a href='#Aux_JLLstruct'><p>Transformation of the JLL-related parameters (auxiliary form)</p></a></li>
<li><a href='#Aux_Jordan'><p>Transformation of the Jordan-related parameters (auxiliary form)</p></a></li>
<li><a href='#Aux_PSD'><p>Transformation of a PSD matrix (auxiliary form)</p></a></li>
<li><a href='#Bias_Correc_VAR'><p>Estimates an unbiased VAR(1) using stochastic approximation (Bauer, Rudebusch and Wu, 2012)</p></a></li>
<li><a href='#Boot_DataGraphFact_perShock'><p>Generates the desired bootstrap graphs</p></a></li>
<li><a href='#Boot_DataGraphYield_perShock'><p>Generates the desired bootstrap graphs</p></a></li>
<li><a href='#Boot_Fac_Graphs'><p>Build P-dynamic graphs after the bootstrap implementation</p></a></li>
<li><a href='#Boot_graph_template'><p>Builds template from bootstrap-related graphs</p></a></li>
<li><a href='#Boot_Yields_Graphs'><p>Build P-dynamic graphs after the bootstrap implementation</p></a></li>
<li><a href='#Bootstrap'><p>Generates the bootstrap-related outputs</p></a></li>
<li><a href='#BootstrapBoundsSet'><p>Builds the confidence bounds and graphs (Bootstrap set)</p></a></li>
<li><a href='#bound2x'><p>Transform a number bounded between a lower bound and upper bound to x by:</p></a></li>
<li><a href='#BR_jps_out'><p>Replications of the JPS (2014) outputs by Bauer and Rudebusch (2017)</p></a></li>
<li><a href='#Build_xvec'><p>Obtain the auxiliary values corresponding to each parameter, its size and its name</p></a></li>
<li><a href='#BuildATSM_RiskFactors'><p>Builds the time series of the risk factors that are used in the estimation of the ATSM</p></a></li>
<li><a href='#BuildCI_Yields'><p>Build Confidence intervals for yield-related outputs</p></a></li>
<li><a href='#BuildFEVDlist'><p>Build the list of IRF and GIRF for both factors and bond yields</p></a></li>
<li><a href='#BuildGVAR'><p>Build the GVAR(1) from the country-specific VARX(1,1,1)</p></a></li>
<li><a href='#BuildIRFlist'><p>Build the list of IRF and GIRF for both factors and bond yields</p></a></li>
<li><a href='#BuildLinkMat'><p>Build country-specific link matrices</p></a></li>
<li><a href='#BuildRiskFactors_BS'><p>Build the time-series of the risk factors in each bootstrap draw</p></a></li>
<li><a href='#BuildYields_BS'><p>Build the time-series of bond yields for each bootstrap draw</p></a></li>
<li><a href='#BUnspannedAdapJoint'><p>Transform B_spanned into B_unspanned for jointQ models</p></a></li>
<li><a href='#BUnspannedAdapSep'><p>Transform B_spanned into B_unspanned for sepQ models</p></a></li>
<li><a href='#BUnspannedAdapSep_BS'><p>Obtain the full form of B unspanned for &quot;sep Q&quot; models within the bootstrap setting</p></a></li>
<li><a href='#Check_comparison__OLS'><p>check whether mean/median of OLS is close to actual OLS estimates</p></a></li>
<li><a href='#Check_label_consistency'><p>Check consistency of labels (economies, domestic and global variables)</p></a></li>
<li><a href='#CheckInputsForMLE'><p>Check consistence of inputs</p></a></li>
<li><a href='#CheckInputsGVAR'><p>Check consistency of the inputs provided in GVARinputs</p></a></li>
<li><a href='#CheckJLLinputs'><p>Check consistency of the inputs provided in JLL-based models</p></a></li>
<li><a href='#ChecksOOS'><p>Preliminary checks for inputs provided for the performing out-of-sample forecasting</p></a></li>
<li><a href='#CholRestrictionsJLL'><p>Impose the zero-restrictions on the Cholesky-factorization from JLL-based models.</p></a></li>
<li><a href='#CleanOrthoJLL_Boot'><p>Clean unnecessary outputs of JLL models in the bootstrap setup</p></a></li>
<li><a href='#Compute_BnX_AnX'><p>Compute the latent loading AnX and BnX</p></a></li>
<li><a href='#Compute_EP'><p>Compute the expected component for all models</p></a></li>
<li><a href='#ComputeBounds_FEVDandGFEVD'><p>Compute the confidence bounds around the P-dynamics and bond yields for FEVD and GFEVD</p></a></li>
<li><a href='#ComputeBounds_IRFandGIRF'><p>Compute the confidence bounds from the model's numerical outputs</p></a></li>
<li><a href='#ComputeFEVDs'><p>Compute FEVDs for all models</p></a></li>
<li><a href='#ComputeGFEVDs'><p>Compute GFEVDs for all models</p></a></li>
<li><a href='#ComputeGIRFs'><p>Compute GIRFs for all models</p></a></li>
<li><a href='#ComputeIRFs'><p>Compute IRFs of all models</p></a></li>
<li><a href='#contain'><p>Check whether one element is a subset of another element</p></a></li>
<li><a href='#Convert2JordanForm'><p>Convert a generic matrix to its Jordan form</p></a></li>
<li><a href='#DatabasePrep'><p>Gather data of several countries in a list. Particularly useful for GVAR-based setups (Compute &quot;GVARFactors&quot;)</p></a></li>
<li><a href='#DataForEstimation'><p>Retrieves data from Excel and build the database used in the model estimation</p></a></li>
<li><a href='#DataSet_BS'><p>Prepare the factor set for GVAR models  (Bootstrap version)</p></a></li>
<li><a href='#df__dx'><p>Computes numerical first order derivative of f(x)</p></a></li>
<li><a href='#DomesticMacroVar'><p>Data: Risk Factors - Candelon and Moura (forthcoming, JFEC)</p></a></li>
<li><a href='#DomMacro'><p>Data: Risk Factors for the GVAR - Candelon and Moura (2023)</p></a></li>
<li><a href='#EstimationSigma_GVARrest'><p>Estimate numerically the variance-covariance matrix from the GVAR-based models</p></a></li>
<li><a href='#EstimationSigma_Ye'><p>Estimate numerically the Cholesky-factorization from the JLL-based models</p></a></li>
<li><a href='#estVARbrw'><p>Estimate a VAR(1) - suited to Bauer, Rudebusch and Wu (2012) methodology</p></a></li>
<li><a href='#ExpectedComponent'><p>Get the expected component of all models</p></a></li>
<li><a href='#FacQuantile_bs'><p>Compute quantiles for model P-dynamics</p></a></li>
<li><a href='#FactorBounds_FEVDandGFEVD'><p>Compute the confidence bounds for the model bond P-dynamics-related outputs</p></a></li>
<li><a href='#FactorBounds_IRFandGIRF'><p>Compute the confidence bounds for the model P-dynamics</p></a></li>
<li><a href='#Factors_NonOrtho'><p>Makes the pre-allocation of the factors set for JLL-based models</p></a></li>
<li><a href='#FactorsGVAR'><p>Data: Risk Factors for the GVAR - Candelon and Moura (forthcoming, JFEC)</p></a></li>
<li><a href='#FeedbackMat_BS'><p>Compute the Feedback matrix of each bootstrap draw</p></a></li>
<li><a href='#FeedbackMatrixRestrictionsJLL'><p>Set the zero-restrictions on the feedback matrix of JLL's P-dynamics</p></a></li>
<li><a href='#FEVDandGFEVD'><p>FEVDs and GFEVDs for all models</p></a></li>
<li><a href='#FEVDandGFEVD_BS'><p>FEVDs and GFEVDs after bootstrap for all models</p></a></li>
<li><a href='#FEVDandGFEVDbs'><p>Creates the confidence bounds and the graphs of FEVDs and GFEVDs after bootstrap (all models)</p></a></li>
<li><a href='#FEVDandGFEVDgraphs'><p>FEVD and GFEVD graphs for all models</p></a></li>
<li><a href='#FEVDandGFEVDs_Graphs'><p>Generates graphs for FEVDs and GFEVDs</p></a></li>
<li><a href='#FF'><p>mean of the llk function used in the estimation of the selected ATSM</p></a></li>
<li><a href='#FFtemporary'><p>Mean of the llk function used in the estimation of the selected ATSM</p></a></li>
<li><a href='#Fit_Subplot'><p>Build subplot for fitted yields</p></a></li>
<li><a href='#Fitgraphs'><p>Model fit graphs for all models</p></a></li>
<li><a href='#FMN__Rotate'><p>Performs state rotations</p></a></li>
<li><a href='#FolderCreation_Boot'><p>Creates folder to store graphs generated from the bootstrap analysis</p></a></li>
<li><a href='#FolderCreationBoot'><p>Creates the folders and the path in which the graphical outputs are stored (Bootstrap version)</p></a></li>
<li><a href='#FolderCreationPoint'><p>Creates the folders and the path in which the graphical outputs are stored (point estimate version)</p></a></li>
<li><a href='#FolderPrep_FEVDs'><p>Create folders for storing IRFs and GIRFs</p></a></li>
<li><a href='#FolderPrep_IRFs'><p>Create folders for storing IRFs and GIRFs</p></a></li>
<li><a href='#ForecastYields'><p>Generates forecasts of bond yields for all model types</p></a></li>
<li><a href='#ForwardPremia'><p>Compute the forward premia for all models</p></a></li>
<li><a href='#Functionf'><p>Set up the vector-valued objective function (Point estimate)</p></a></li>
<li><a href='#Functionf_vectorized'><p>Use function f to generate the outputs from a ATSM</p></a></li>
<li><a href='#Gather_Forecasts'><p>Gather several forecast dates</p></a></li>
<li><a href='#GaussianDensity'><p>computes the density function of a gaussian process</p></a></li>
<li><a href='#Gen_Artificial_Series'><p>Generate artificial time-series in the bootstrap setup</p></a></li>
<li><a href='#Gen_Forecast_Yields'><p>compute the bond yield forecast for any model type</p></a></li>
<li><a href='#GeneralMLEInputs'><p>Gathers the general inputs for model estimation</p></a></li>
<li><a href='#genVARbrw'><p>Generate M data sets from VAR(1) model</p></a></li>
<li><a href='#Get_a0'><p>Obtain the country-specific a0</p></a></li>
<li><a href='#Get_As'><p>Compute the A loadings</p></a></li>
<li><a href='#Get_BFull'><p>Compute the B matrix of loadings</p></a></li>
<li><a href='#Get_Bs'><p>BUild the B loadings</p></a></li>
<li><a href='#Get_G0G1Sigma'><p>Get the intercept, feedback matrix and the variance-covariance matrix from GVAR without global factors</p></a></li>
<li><a href='#Get_Gy1'><p>Compute the feedback matrix from a GVAR model with global factors</p></a></li>
<li><a href='#Get_llk'><p>Compute the log-likelihood function</p></a></li>
<li><a href='#Get_r0'><p>Compute r0 for the various models</p></a></li>
<li><a href='#Get_Sigama_JLL'><p>Compute Sigmas/Cholesky factorizations</p></a></li>
<li><a href='#Get_SigmaYields'><p>Compute the variance-covariance matrix of the bond yields</p></a></li>
<li><a href='#Get_Unspanned'><p>Collect both the domestic and global unspanned factors of all countries in single matrices</p></a></li>
<li><a href='#Get_V_tilde_BC'><p>Compute the variance-covariance matrix after the bias correction procedure</p></a></li>
<li><a href='#GetAuxPara'><p>Map constrained parameters b to unconstrained auxiliary parameters a.</p></a></li>
<li><a href='#Getdt'><p>Get delta t</p></a></li>
<li><a href='#GetLabels_JLL'><p>Generate the variable labels of the JLL models</p></a></li>
<li><a href='#GetLabels_sepQ'><p>Generate the factor labels for models estimated on a country-by-country bases</p></a></li>
<li><a href='#getpara'><p>Extract the parameter values from the parameter list set</p></a></li>
<li><a href='#GetPdynPara'><p>Compute the parameters used in the P-dynamics of the model</p></a></li>
<li><a href='#GetPdynPara_BC'><p>Compute P-dynamics parameters using the bias correction method from BRW (2012)</p></a></li>
<li><a href='#GetPdynPara_NoBC'><p>Compute P-dynamics parameters without using the bias correction method from BRW (2012)</p></a></li>
<li><a href='#GetTruePara'><p>Map auxiliary (unconstrained) parameters a to constrained parameters b</p></a></li>
<li><a href='#GetYields_AllCountries'><p>Gather all country-specific yields in a single matrix of dimension CJ x T</p></a></li>
<li><a href='#GlobalMacro'><p>Data: Risk Factors - Candelon and Moura (2023)</p></a></li>
<li><a href='#GlobalMacroVar'><p>Data: Risk Factors - Candelon and Moura (forthcoming, JFEC)</p></a></li>
<li><a href='#GraphicalOutputs'><p>Generate the graphical outputs for the selected models (Point estimate)</p></a></li>
<li><a href='#GVAR'><p>Estimates a GVAR(1) and a VARX(1,1,1) models</p></a></li>
<li><a href='#GVAR_PrepFactors'><p>Prepare risk factors for the estimation of the GVAR model</p></a></li>
<li><a href='#Idx_UnspanFact'><p>Obtain the indexes of both the domestic and global unspanned factors</p></a></li>
<li><a href='#IdxAllSpanned'><p>Find the indexes of the spanned factors</p></a></li>
<li><a href='#IdxSpanned'><p>Extract the indexes related to the spanned factors in the variance-covariance matrix</p></a></li>
<li><a href='#IDXZeroRestrictionsJLLVarCovOrtho'><p>Find the indexes of zero-restrictions from the orthogonalized variance-covariance matrix from the JLL-based models</p></a></li>
<li><a href='#ImposeStat_Aux'><p>Impose stationary constraint under the risk-neutral measure</p></a></li>
<li><a href='#ImposeStat_True'><p>Makes sure that the stationary constraint under the risk-neutral measure is preserved</p></a></li>
<li><a href='#InputsForOpt'><p>Generates several  inputs that are necessary to build the likelihood function</p></a></li>
<li><a href='#InputsForOutputs'><p>Collects the inputs that are used to construct the numerical and the graphical outputs</p></a></li>
<li><a href='#IRFandGIRF'><p>IRFs and GIRFs for all models</p></a></li>
<li><a href='#IRFandGIRF_BS'><p>IRFs and GIRFs after bootstrap for all models</p></a></li>
<li><a href='#IRFandGIRFbs'><p>Creates the confidence bounds and the graphs of IRFs and GIRFs after bootstrap</p></a></li>
<li><a href='#IRFandGIRFgraphs'><p>IRF and GIRF graphs for all models</p></a></li>
<li><a href='#IRFandGIRFs_Format_Fac'><p>Gather data for IRFs and GIRFs grahs (version &quot;Factors&quot;)</p></a></li>
<li><a href='#IRFandGIRFs_Format_Yields'><p>Gather data for IRFs and GIRFs grahs (version &quot;Yields&quot;)</p></a></li>
<li><a href='#JLL'><p>Estimates the P-dynamics from JLL-based models</p></a></li>
<li><a href='#Jordan_JLL'><p>Check for JLL models for Jordan restrictions (auxiliary form)</p></a></li>
<li><a href='#K1XQStationary'><p>Impose stationarity under the Q-measure</p></a></li>
<li><a href='#LabelsSpanned'><p>Generate the labels of the spanned factors</p></a></li>
<li><a href='#LabelsStar'><p>Generate the labels of the star variables</p></a></li>
<li><a href='#LabFac'><p>Generates the labels factors</p></a></li>
<li><a href='#llk_JLL_Sigma'><p>Build the log-likelihood function of the P-dynamics from the JLL-based models</p></a></li>
<li><a href='#LoadData'><p>Loads data sets from several papers</p></a></li>
<li><a href='#logdet'><p>computes the logarithm of determinant of a matrix A</p></a></li>
<li><a href='#m_var'><p>Find mean or median of OLS when DGP is VAR(1)</p></a></li>
<li><a href='#MarginalModelPara'><p>Estimate the marginal model for the global factors</p></a></li>
<li><a href='#MatAdjusted'><p>Adjust vector of maturities</p></a></li>
<li><a href='#Maturities'><p>Create a vector of numerical maturities in years</p></a></li>
<li><a href='#MLEdensity'><p>Compute the maximum likelihood function of all models</p></a></li>
<li><a href='#ModelPara'><p>Replications of the JPS (2014) outputs by the MultiATSM package</p></a></li>
<li><a href='#mult__inv'><p>Inverts an array of matrices so that:  inva[,,i] = inv(a[,,i])</p></a></li>
<li><a href='#mult__prod'><p>Efficient computation of matrix product for arrays</p></a></li>
<li><a href='#mult_inv_large'><p>Inverse each 2D slice of an array (M) with arbitrary dimensions support</p></a></li>
<li><a href='#mult_inv_small'><p>Inverse the (m,m,T) array of matrices for m&lt;=4</p></a></li>
<li><a href='#mult_logabsdet'><p>Inverse each 2D slice of an array (M) with arbitrary dimensions support</p></a></li>
<li><a href='#multiprod_2terms'><p>computes matrix product for arrays a and b:   c[,,i] = a[,,i] b[,,i]</p></a></li>
<li><a href='#NoOrthoVAR_JLL'><p>Obtain the non-orthogonalized model parameters</p></a></li>
<li><a href='#NumOutputs'><p>Constructs the model numerical outputs (model fit, IRFs, GIRFs, FEVDs, GFEVDs, and risk premia decomposition)</p></a></li>
<li><a href='#NumOutputs_Bootstrap'><p>Numerical outputs (IRFs, GIRFs, FEVD, and GFEVD) for bootstrap</p></a></li>
<li><a href='#OOS_Forecast'><p>Perform out-of-sample forecast of bond yields</p></a></li>
<li><a href='#Optimization'><p>Perform the optimization of the log-likelihood function of the chosen ATSM</p></a></li>
<li><a href='#Optimization_PE'><p>Peform the minimization of mean(f)</p></a></li>
<li><a href='#OptimizationSetup_ATSM'><p>Optimization routine for the entire selected ATSM</p></a></li>
<li><a href='#OptOutputs'><p>Prepare outputs to export after the model optimization</p></a></li>
<li><a href='#OrthoReg_JLL'><p>Get coefficients from the orthogonalized regressions</p></a></li>
<li><a href='#OrthoVAR_JLL'><p>VAR(1) with orthogonalized factors (JLL models)</p></a></li>
<li><a href='#OutputConstruction'><p>Numerical outputs (variance explained, model fit, IRFs, GIRFs, FEVDs, GFEVDs, and risk premia decomposition)</p>
for all models</a></li>
<li><a href='#Outputs2exportMLE'><p>Prepares inputs to export</p></a></li>
<li><a href='#ParaATSM_opt_ALL'><p>Update the list of parameters</p></a></li>
<li><a href='#ParaLabelsOpt'><p>Create the variable labels used in the estimation</p></a></li>
<li><a href='#pca_weights_one_country'><p>Weight matrix from principal components</p></a></li>
<li><a href='#PdynResid_BS'><p>Compute some key parameters from the P-dynamics (Bootstrap set)</p></a></li>
<li><a href='#pos2x'><p>Transform a positive number y to back to x by:</p></a></li>
<li><a href='#Reg__OLSconstrained'><p>Restricted OLS regression</p></a></li>
<li><a href='#Reg_K1Q'><p>Estimate the risk-neutral feedbak matrix K1Q using linear regressions</p></a></li>
<li><a href='#Remove_at'><p>Eliminates the @</p></a></li>
<li><a href='#RemoveNA'><p>Exclude series that contain NAs</p></a></li>
<li><a href='#ResampleResiduals_BS'><p>Compute the residuals from the original model</p></a></li>
<li><a href='#residY_original'><p>Compute the residuals from the observational equation</p></a></li>
<li><a href='#rhoParas'><p>Compute  risk-neutral intercept and slope</p></a></li>
<li><a href='#RiskFactors'><p>Data: Risk Factors - Candelon and Moura (forthcoming, JFEC)</p></a></li>
<li><a href='#RiskFactorsGraphs'><p>Spanned and unspanned factors plot</p></a></li>
<li><a href='#RiskFactorsPrep'><p>Builds the complete set of time series of the risk factors (spanned and unspanned)</p></a></li>
<li><a href='#RMSEjoint'><p>Compute the root mean square error (&quot;joint Q&quot; models)</p></a></li>
<li><a href='#RMSEsep'><p>Compute the root mean square error (&quot;sep Q&quot; models)</p></a></li>
<li><a href='#shrink_Phi'><p>Killan's VAR stationarity adjustment</p></a></li>
<li><a href='#Spanned_Factors'><p>Computes the country-specific spanned factors</p></a></li>
<li><a href='#SpannedFactorsjointQ'><p>Gather all spanned factors (&quot;joint Q&quot; models)</p></a></li>
<li><a href='#SpannedFactorsSepQ'><p>Gather all spanned factors (&quot;sep Q&quot; models)</p></a></li>
<li><a href='#SpecificMLEInputs'><p>Concatenate the model-specific inputs in a list</p></a></li>
<li><a href='#sqrtm_robust'><p>Compute the square root of a matrix</p></a></li>
<li><a href='#StarFactors'><p>Generates the star variables necessary for the GVAR estimation</p></a></li>
<li><a href='#TermPremia'><p>Compute the term premia</p></a></li>
<li><a href='#TermPremiaDecomp'><p>Decomposition of yields into the average of expected future short-term interest rate and risk premia for all models</p></a></li>
<li><a href='#TPDecompGraph'><p>Term Premia decomposition graphs for all models</p></a></li>
<li><a href='#Trade_Flows'><p>Data: Trade Flows - Candelon and Moura (2023)</p></a></li>
<li><a href='#TradeFlows'><p>Data: Trade Flows - Candelon and Moura (forthcoming, JFEC)</p></a></li>
<li><a href='#Transition_Matrix'><p>Computes the transition matrix required in the estimation of the GVAR model</p></a></li>
<li><a href='#True_BlockDiag'><p>Transformation of the block diagonal parameters (true form)</p></a></li>
<li><a href='#True_BoundDiag'><p>Transformation of the bounded parameters (True form)</p></a></li>
<li><a href='#True_JLLstruct'><p>Transformation of the JLL-related parameters (true form)</p></a></li>
<li><a href='#True_Jordan'><p>Transformation of the Jordan-related parameters (True form)</p></a></li>
<li><a href='#True_PSD'><p>Transformation of a PSD matrix (true form)</p></a></li>
<li><a href='#Update_ParaList'><p>converts the vectorized auxiliary parameter vector x to the parameters that go directly</p>
into the likelihood function.</a></li>
<li><a href='#Update_SSZ_JLL'><p>Update the variance-covariance matrix from the &quot;JLL joint Sigma&quot; model. Necessary for optimization</p></a></li>
<li><a href='#VAR'><p>Estimates a standard VAR(1)</p></a></li>
<li><a href='#VarianceExplained'><p>Percentage explained by the spanned factors of the variations in the set of observed yields for all models</p></a></li>
<li><a href='#VARX'><p>Estimate a VARX(1,1,1)</p></a></li>
<li><a href='#Wished_Graphs_FEVDandGFEVD'><p>Extract list of desired graph features (IRFs anc GIRFs)</p></a></li>
<li><a href='#Wished_Graphs_IRFandGIRF'><p>Extract list of desired graph features (IRFs anc GIRFs)</p></a></li>
<li><a href='#WishGraphs_FEVDandGFEVD_Boot'><p>Extract graphs of interest (bootstrap version)</p></a></li>
<li><a href='#WishGraphs_IRFandGIRF_Boot'><p>Extract graphs of interest (bootstrap version)</p></a></li>
<li><a href='#x2bound'><p>Transform x to a number bounded btw lb and ub by:</p></a></li>
<li><a href='#x2pos'><p>Transform x to a positive number by: y = log(e^x + 1)</p></a></li>
<li><a href='#Y_Fit'><p>Model-implied yields (cross-section)</p></a></li>
<li><a href='#Y_ModImp'><p>Model-implied yields (P-dynamics)</p></a></li>
<li><a href='#YieldBounds_FEVDandGFEVD'><p>Compute the confidence bounds for the model bond yield-related outputs</p></a></li>
<li><a href='#YieldBounds_IRFandGIRF'><p>Compute the confidence bounds for the model bond yield-related outputs</p></a></li>
<li><a href='#YieldFor'><p>Compile the bond yield forecast for any model type</p></a></li>
<li><a href='#YieldQuantile_bs'><p>Compute quantiles for model bond yield-related outputs</p></a></li>
<li><a href='#Yields'><p>Data: Yields - Candelon and Moura (forthcoming, JFEC)</p></a></li>
<li><a href='#YieldsFit'><p>Computes two measures of model fit for bond yields (all models)</p></a></li>
<li><a href='#YieldsFitAllJoint'><p>Fit yields for all maturities of interest</p></a></li>
<li><a href='#YieldsFitAllSep'><p>Fit yields for all maturities of interest</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multicountry Term Structure of Interest Rates Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-27</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation routines for several classes of affine term structure of interest rates models. All the models are based on the single-country unspanned macroeconomic risk framework from Joslin, Priebsch, and Singleton (2014, JF) &lt;<a href="https://doi.org/10.1111%2Fjofi.12131">doi:10.1111/jofi.12131</a>&gt;. Multicountry extensions such as the ones of Jotikasthira, Le, and Lundblad (2015, JFE) &lt;<a href="https://doi.org/10.1016%2Fj.jfineco.2014.09.004">doi:10.1016/j.jfineco.2014.09.004</a>&gt;, Candelon and Moura (2023, EM) &lt;<a href="https://doi.org/10.1016%2Fj.econmod.2023.106453">doi:10.1016/j.econmod.2023.106453</a>&gt;, and Candelon and Moura (Forthcoming, JFEC) &lt;<a href="https://doi.org/10.1093%2Fjjfinec%2Fnbae008">doi:10.1093/jjfinec/nbae008</a>&gt; are also available. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>pracma, ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>readxl, readr, magic, Jmisc, functional, cowplot, reshape2,
sjmisc, stringr, knitr, rmarkdown, bookdown, kableExtra,
neldermead, magrittr, hablar</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/rubensmoura87/MultiATSM">https://github.com/rubensmoura87/MultiATSM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rubensmoura87/MultiATSM/issues">https://github.com/rubensmoura87/MultiATSM/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-27 16:59:24 UTC; rmoura</td>
</tr>
<tr>
<td>Author:</td>
<td>Rubens Moura <a href="https://orcid.org/0000-0001-8105-4729"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rubens Moura &lt;rubens.gtmoura@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-27 17:10:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='MultiATSM'>ATSM Package</h2><span id='topic+MultiATSM'></span><span id='topic+MultiATSM-package'></span>

<h3>Description</h3>

<p>Estimation of several classes of affine term structure of interest rates models.
</p>


<h3>Author(s)</h3>

<p>Rubens Moura <a href="mailto:rubens.gtmoura@gmail.com">rubens.gtmoura@gmail.com</a>
</p>

<hr>
<h2 id='A0N__BnAn'>Compute the cross-section loadings of yields of a canonical A0_N model</h2><span id='topic+A0N__BnAn'></span>

<h3>Description</h3>

<p>Compute the cross-section loadings of yields of a canonical A0_N model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>A0N__BnAn(mat, K1XQ, ModelType, dX = NULL, r0 = NULL, SSX = NULL, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="A0N__BnAn_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (J x 1). Maturities are in multiples of the discrete interval used in the model</p>
</td></tr>
<tr><td><code id="A0N__BnAn_+3A_k1xq">K1XQ</code></td>
<td>
<p>risk-neutral feedback matrix (N x N)</p>
</td></tr>
<tr><td><code id="A0N__BnAn_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="A0N__BnAn_+3A_dx">dX</code></td>
<td>
<p>state loadings for the one-period rate (1xN). Default is a vector of ones</p>
</td></tr>
<tr><td><code id="A0N__BnAn_+3A_r0">r0</code></td>
<td>
<p>the long run risk neutral mean of the short rate (scalar)</p>
</td></tr>
<tr><td><code id="A0N__BnAn_+3A_ssx">SSX</code></td>
<td>
<p>the covariance matrix of the errors (N x N)</p>
</td></tr>
<tr><td><code id="A0N__BnAn_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing:
</p>

<ul>
<li><p> Intercept (Jx1)
</p>
</li>
<li><p> slope (JxN)
</p>
</li>
<li><p> the betan (JX1, part of the intercepts unrelated to the long run risk neutral mean r0)
coefficients of a canonical A_0(N) model.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> This function is a modified version of the &quot;A0N__computeBnAn&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>
</li>
<li><p> Dai and Singleton (2000). &quot;Specification Analysis of Affine Term Structure Models&quot; (The Journal of Finance)
</p>
</li></ul>


<hr>
<h2 id='Adjust_Const_Type'>Adjust the constant label</h2><span id='topic+Adjust_Const_Type'></span>

<h3>Description</h3>

<p>Adjust the constant label
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Adjust_Const_Type(Const_Type_Full)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Adjust_Const_Type_+3A_const_type_full">Const_Type_Full</code></td>
<td>
<p>Type of constraint (Full Name)</p>
</td></tr>
</table>

<hr>
<h2 id='AdjustOptm_BS'>Gathers the estimate of the bootstrap draws</h2><span id='topic+AdjustOptm_BS'></span>

<h3>Description</h3>

<p>Gathers the estimate of the bootstrap draws
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AdjustOptm_BS(ModelType, ModelBootstrap, Draw_Opt, Economies, tt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AdjustOptm_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="AdjustOptm_BS_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>List to store the bootstrap set</p>
</td></tr>
<tr><td><code id="AdjustOptm_BS_+3A_draw_opt">Draw_Opt</code></td>
<td>
<p>List of model estimated parameters</p>
</td></tr>
<tr><td><code id="AdjustOptm_BS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="AdjustOptm_BS_+3A_tt">tt</code></td>
<td>
<p>number of the bootstrap draw</p>
</td></tr>
</table>

<hr>
<h2 id='AdjustPathFEVDs'>Generate paths to save IRFs/GIRFs graphs</h2><span id='topic+AdjustPathFEVDs'></span>

<h3>Description</h3>

<p>Generate paths to save IRFs/GIRFs graphs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AdjustPathFEVDs(OutputType, ElementType, PathsGraphs, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AdjustPathFEVDs_+3A_outputtype">OutputType</code></td>
<td>
<p>available options are &quot;IRF&quot; and &quot;GIRF&quot;</p>
</td></tr>
<tr><td><code id="AdjustPathFEVDs_+3A_elementtype">ElementType</code></td>
<td>
<p>available options are &quot;Factors&quot; and &quot;Yields&quot;</p>
</td></tr>
<tr><td><code id="AdjustPathFEVDs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>desired path to save the graphs</p>
</td></tr>
<tr><td><code id="AdjustPathFEVDs_+3A_economies">Economies</code></td>
<td>
<p>Economies of the economic system</p>
</td></tr>
<tr><td><code id="AdjustPathFEVDs_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired estimated model type</p>
</td></tr>
</table>

<hr>
<h2 id='AdjustPathIRFs'>Generate paths to save IRFs/GIRFs graphs</h2><span id='topic+AdjustPathIRFs'></span>

<h3>Description</h3>

<p>Generate paths to save IRFs/GIRFs graphs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AdjustPathIRFs(OutputType, ElementType, PathsGraphs, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AdjustPathIRFs_+3A_outputtype">OutputType</code></td>
<td>
<p>available options are &quot;IRF&quot; and &quot;GIRF&quot;</p>
</td></tr>
<tr><td><code id="AdjustPathIRFs_+3A_elementtype">ElementType</code></td>
<td>
<p>available options are &quot;Factors&quot; and &quot;Yields&quot;</p>
</td></tr>
<tr><td><code id="AdjustPathIRFs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>desired path to save the graphs</p>
</td></tr>
<tr><td><code id="AdjustPathIRFs_+3A_economies">Economies</code></td>
<td>
<p>Economies of the economic system</p>
</td></tr>
<tr><td><code id="AdjustPathIRFs_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired estimated model type</p>
</td></tr>
</table>

<hr>
<h2 id='AdjustYieldsDates'>Makes sure that the time series of yields and risk factors have coincident sample spans</h2><span id='topic+AdjustYieldsDates'></span>

<h3>Description</h3>

<p>Makes sure that the time series of yields and risk factors have coincident sample spans
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AdjustYieldsDates(Yields, PdynamicsFactors, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AdjustYieldsDates_+3A_yields">Yields</code></td>
<td>
<p>time series of bond yields (CJ x T1 )</p>
</td></tr>
<tr><td><code id="AdjustYieldsDates_+3A_pdynamicsfactors">PdynamicsFactors</code></td>
<td>
<p>time series of risk factors (F x T2)</p>
</td></tr>
<tr><td><code id="AdjustYieldsDates_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies of the system.</p>
</td></tr>
</table>

<hr>
<h2 id='Aux_BlockDiag'>Transformation of the block diagonal parameters (auxiliary form)</h2><span id='topic+Aux_BlockDiag'></span>

<h3>Description</h3>

<p>Transformation of the block diagonal parameters (auxiliary form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Aux_BlockDiag(ParaValue, Const_Type, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Aux_BlockDiag_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter value</p>
</td></tr>
<tr><td><code id="Aux_BlockDiag_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
<tr><td><code id="Aux_BlockDiag_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Aux_BlockDiag_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='Aux_BoundDiag'>Transformation of the bounded parameters (auxiliary form)</h2><span id='topic+Aux_BoundDiag'></span>

<h3>Description</h3>

<p>Transformation of the bounded parameters (auxiliary form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Aux_BoundDiag(ParaValue, Const_Type, lb, ub)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Aux_BoundDiag_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter value</p>
</td></tr>
<tr><td><code id="Aux_BoundDiag_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
<tr><td><code id="Aux_BoundDiag_+3A_lb">lb</code></td>
<td>
<p>lower bound</p>
</td></tr>
<tr><td><code id="Aux_BoundDiag_+3A_ub">ub</code></td>
<td>
<p>upper bound</p>
</td></tr>
</table>

<hr>
<h2 id='Aux_JLLstruct'>Transformation of the JLL-related parameters (auxiliary form)</h2><span id='topic+Aux_JLLstruct'></span>

<h3>Description</h3>

<p>Transformation of the JLL-related parameters (auxiliary form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Aux_JLLstruct(ParaValue, Const_Type, FactorLabels, Economies, JLLinputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Aux_JLLstruct_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter value</p>
</td></tr>
<tr><td><code id="Aux_JLLstruct_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
<tr><td><code id="Aux_JLLstruct_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Aux_JLLstruct_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Aux_JLLstruct_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models (see &quot;JLL&quot; function)</p>
</td></tr>
</table>

<hr>
<h2 id='Aux_Jordan'>Transformation of the Jordan-related parameters (auxiliary form)</h2><span id='topic+Aux_Jordan'></span>

<h3>Description</h3>

<p>Transformation of the Jordan-related parameters (auxiliary form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Aux_Jordan(ParaValue, Const_Type, FactorLabels, Economies, JLLinputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Aux_Jordan_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter</p>
</td></tr>
<tr><td><code id="Aux_Jordan_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
<tr><td><code id="Aux_Jordan_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Aux_Jordan_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Aux_Jordan_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models (see &quot;JLL&quot; function)</p>
</td></tr>
</table>

<hr>
<h2 id='Aux_PSD'>Transformation of a PSD matrix (auxiliary form)</h2><span id='topic+Aux_PSD'></span>

<h3>Description</h3>

<p>Transformation of a PSD matrix (auxiliary form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Aux_PSD(ParaValue, Const_Type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Aux_PSD_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter value</p>
</td></tr>
<tr><td><code id="Aux_PSD_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
</table>

<hr>
<h2 id='Bias_Correc_VAR'>Estimates an unbiased VAR(1) using stochastic approximation (Bauer, Rudebusch and Wu, 2012)</h2><span id='topic+Bias_Correc_VAR'></span>

<h3>Description</h3>

<p>Estimates an unbiased VAR(1) using stochastic approximation (Bauer, Rudebusch and Wu, 2012)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bias_Correc_VAR(
  ModelType,
  BRWinputs,
  RiskFactors,
  N,
  Economies,
  FactorLabels,
  GVARinputs = NULL,
  JLLinputs = NULL,
  ev_restr = 1,
  nargout = 4
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Bias_Correc_VAR_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_brwinputs">BRWinputs</code></td>
<td>
<p>A list containing the necessary inputs for the BRW model estimation:
</p>

<ol>
<li> <p><code>flag_mean</code>: Logical. Determines whether mean- (TRUE) or median- (FALSE) unbiased estimation is desired. Default is TRUE.
</p>
</li>
<li> <p><code>gamma</code>: Numeric. Adjustment parameter between 0 and 1. Default is 0.5.
</p>
</li>
<li> <p><code>N_iter</code>: Integer. Number of iterations for the stochastic approximation algorithm after burn-in. Default is 5,000.
</p>
</li>
<li> <p><code>N_burn</code>: Integer. Number of burn-in iterations. Default is 15
</p>
</li>
<li> <p><code>B</code>: Integer. Number of bootstrap samples per iteration for calculating the noisy measure of the OLS estimator's mean or median. Default is 50.
</p>
</li>
<li> <p><code>check</code>: Logical. Indicates whether to perform a closeness check. Default is TRUE.
</p>
</li>
<li> <p><code>B_check</code>: Integer. Number of bootstrap samples for the closeness check. Default is 100,000.
</p>
</li></ol>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>A numeric matrix (T x F) representing the time series of risk factors.</p>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_n">N</code></td>
<td>
<p>Integer. Number of country-specific spanned factors.</p>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List. Inputs for GVAR model estimation (see <code><a href="#topic+GVAR">GVAR</a></code> function). Default is NULL.</p>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List. Inputs for JLL model estimation (see <code><a href="#topic+JLL">JLL</a></code> function). Default is NULL.</p>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_ev_restr">ev_restr</code></td>
<td>
<p>Numeric. Restriction on the largest eigenvalue under the P-measure. Default is 1.</p>
</td></tr>
<tr><td><code id="Bias_Correc_VAR_+3A_nargout">nargout</code></td>
<td>
<p>Integer. Number of elements in the output list. Default is 4.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bias-corrected VAR paramaters based on the framework of Bauer, Rudebusch and Wu (2012). The list contains:
</p>

<ol>
<li> <p><code>Phi_tilde</code>: estimated coefficient matrix (F x F);
</p>
</li>
<li> <p><code>mu_tilde</code>: estimated intercept (F x 1);
</p>
</li>
<li> <p><code>V_tilde</code>: estimated variance-covariance matrix (F x F);
</p>
</li>
<li> <p><code>dist</code>: root mean square distance (scalar);
</p>
</li>
<li> <p><code>Phi_sample</code>: sample estimated variance-covariance matrix used in the checks (F x F x B_check) - this output is
reported if nargout is 5.
</p>
</li></ol>



<h3>References</h3>

<p>Bauer, Rudebusch and, Wu (2012). &quot;Correcting Estimation Bias in Dynamic Term Structure Models&quot; <br />
This function is based on the <code>est_unb_var</code> Matlab function available at Cynthia Wu's website
(https://sites.google.com/view/jingcynthiawu/).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(CM_Factors)
Factors &lt;- t(RiskFactors[1:7,])

BRWinputs &lt;- list(flag_mean = TRUE, gamma = 0.4, N_iter = 1000, N_burn = 100,
                  B = 10, check = 1, B_check = 5000)

Economies &lt;- "China"
N &lt;- 3
ModelType &lt;- "JPS original"
FactorLabels &lt;- NULL


BRWpara &lt;- Bias_Correc_VAR(ModelType, BRWinputs, Factors, N, Economies, FactorLabels)


</code></pre>

<hr>
<h2 id='Boot_DataGraphFact_perShock'>Generates the desired bootstrap graphs</h2><span id='topic+Boot_DataGraphFact_perShock'></span>

<h3>Description</h3>

<p>Generates the desired bootstrap graphs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Boot_DataGraphFact_perShock(
  NumOutBounds,
  NumOutPE,
  IdxShock,
  nmResponse,
  Lab_Int,
  ModelType,
  FacDim,
  Horiz,
  Economies = NULL,
  Ortho = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_numoutbounds">NumOutBounds</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>numerical output set from the point estimate analysis</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_idxshock">IdxShock</code></td>
<td>
<p>index associated with the shock variable</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_nmresponse">nmResponse</code></td>
<td>
<p>Label of the response variable</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_lab_int">Lab_Int</code></td>
<td>
<p>Output types &quot;IRF&quot;, &quot;GIRF&quot; and &quot;IRF Ortho&quot;</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_facdim">FacDim</code></td>
<td>
<p>dimension from the P-dynamics</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of analysis</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_economies">Economies</code></td>
<td>
<p>name of economies forming the economic system</p>
</td></tr>
<tr><td><code id="Boot_DataGraphFact_perShock_+3A_ortho">Ortho</code></td>
<td>
<p>Option for orthogonal outputs, for JLL models. Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='Boot_DataGraphYield_perShock'>Generates the desired bootstrap graphs</h2><span id='topic+Boot_DataGraphYield_perShock'></span>

<h3>Description</h3>

<p>Generates the desired bootstrap graphs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Boot_DataGraphYield_perShock(
  NumOutBounds,
  NumOutPE,
  IdxShock,
  nmResponse,
  Lab_Int,
  ModelType,
  FacDim,
  YieldDim,
  Horiz,
  Economies = NULL,
  Ortho = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_numoutbounds">NumOutBounds</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>numerical output set from the point estimate analysis</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_idxshock">IdxShock</code></td>
<td>
<p>index associated with the shock variable</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_nmresponse">nmResponse</code></td>
<td>
<p>Label of the response variable</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_lab_int">Lab_Int</code></td>
<td>
<p>Output types &quot;IRF&quot; or &quot;FEVD&quot;</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_facdim">FacDim</code></td>
<td>
<p>dimension from bond yield set</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_yielddim">YieldDim</code></td>
<td>
<p>dimension from the P-dynamics</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of analysis</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_economies">Economies</code></td>
<td>
<p>name of economies forming the economic system</p>
</td></tr>
<tr><td><code id="Boot_DataGraphYield_perShock_+3A_ortho">Ortho</code></td>
<td>
<p>Option for orthogonal outputs, for JLL models. Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='Boot_Fac_Graphs'>Build P-dynamic graphs after the bootstrap implementation</h2><span id='topic+Boot_Fac_Graphs'></span>

<h3>Description</h3>

<p>Build P-dynamic graphs after the bootstrap implementation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Boot_Fac_Graphs(
  NumOutBounds,
  NumOutPE,
  ModelType,
  FacDim,
  Horiz,
  Economies,
  PathsGraphs,
  OutInt,
  WishFacGraphs,
  WishFacGraphsOrtho = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Boot_Fac_Graphs_+3A_numoutbounds">NumOutBounds</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>numerical output set from the point estimate analysis</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_economies">Economies</code></td>
<td>
<p>Economies that are part of the economic system</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>Path to save the desired graphs</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_outint">OutInt</code></td>
<td>
<p>available options are &quot;IRF&quot; and &quot;FEVD&quot;</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_wishfacgraphs">WishFacGraphs</code></td>
<td>
<p>Binary variable reflecting the graphs of interest</p>
</td></tr>
<tr><td><code id="Boot_Fac_Graphs_+3A_wishfacgraphsortho">WishFacGraphsOrtho</code></td>
<td>
<p>Binary variable reflecting the graphs of interest (orthogonalized version). Default is NULL</p>
</td></tr>
</table>

<hr>
<h2 id='Boot_graph_template'>Builds template from bootstrap-related graphs</h2><span id='topic+Boot_graph_template'></span>

<h3>Description</h3>

<p>Builds template from bootstrap-related graphs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Boot_graph_template(ALLdata, nmResponse)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Boot_graph_template_+3A_alldata">ALLdata</code></td>
<td>
<p>data-frame containing the necessary data for building the grahs</p>
</td></tr>
<tr><td><code id="Boot_graph_template_+3A_nmresponse">nmResponse</code></td>
<td>
<p>string containing the name of the response variable</p>
</td></tr>
</table>

<hr>
<h2 id='Boot_Yields_Graphs'>Build P-dynamic graphs after the bootstrap implementation</h2><span id='topic+Boot_Yields_Graphs'></span>

<h3>Description</h3>

<p>Build P-dynamic graphs after the bootstrap implementation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Boot_Yields_Graphs(
  NumOutBounds,
  NumOutPE,
  ModelType,
  FacDim,
  YielDim,
  Horiz,
  Economies,
  PathsGraphs,
  OutInt,
  WishYieldGraphs,
  WishYieldGraphsOrtho = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Boot_Yields_Graphs_+3A_numoutbounds">NumOutBounds</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>numerical output set from the point estimate analysis</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_economies">Economies</code></td>
<td>
<p>Economies that are part of the economic system</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>Path to save the desired graphs</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_outint">OutInt</code></td>
<td>
<p>Available option are &quot;IRF&quot; or &quot;FEVD&quot;</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_wishyieldgraphs">WishYieldGraphs</code></td>
<td>
<p>Binary variable reflecting the graphs of interest</p>
</td></tr>
<tr><td><code id="Boot_Yields_Graphs_+3A_wishyieldgraphsortho">WishYieldGraphsOrtho</code></td>
<td>
<p>Binary variable reflecting the graphs of interest (orthogonalized version). Default is NULL</p>
</td></tr>
</table>

<hr>
<h2 id='Bootstrap'>Generates the bootstrap-related outputs</h2><span id='topic+Bootstrap'></span>

<h3>Description</h3>

<p>Generates the bootstrap-related outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bootstrap(
  ModelType,
  ModelParaPE,
  NumOutPE,
  Economies,
  InputsForOutputs,
  FactorLabels,
  JLLlist = NULL,
  GVARlist = NULL,
  WishBC = 0,
  BRWlist = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Bootstrap_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_modelparape">ModelParaPE</code></td>
<td>
<p>A list containing the point estimates of the model parameters. For details, refer to the outputs from the <code><a href="#topic+Optimization">Optimization</a></code> function.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>The point estimate derived from numerical outputs. See the outputs from the <code><a href="#topic+NumOutputs">NumOutputs</a></code> function for further information.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>A list containing the necessary inputs for generating IRFs, GIRFs, FEVDs, GFEVDs and Term Premia.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_jlllist">JLLlist</code></td>
<td>
<p>List. Inputs for JLL model estimation (see <code><a href="#topic+JLL">JLL</a></code> function). Default is NULL.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_gvarlist">GVARlist</code></td>
<td>
<p>List. Inputs for GVAR model estimation (see <code><a href="#topic+GVAR">GVAR</a></code> function). Default is NULL.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_wishbc">WishBC</code></td>
<td>
<p>Whether to estimate the physical parameter model with bias correction, based on the method by Bauer, Rudebusch and Wu (2012) (see <code><a href="#topic+Bias_Correc_VAR">Bias_Correc_VAR</a></code> function). Default is set to 0.</p>
</td></tr>
<tr><td><code id="Bootstrap_+3A_brwlist">BRWlist</code></td>
<td>
<p>List of necessary inputs for performing the bias-corrected estimation (see <code><a href="#topic+Bias_Correc_VAR">Bias_Correc_VAR</a></code> function).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing the following elements:
</p>

<ul>
<li><p> list of model parameters for one each one the draws;
</p>
</li>
<li><p> list of numerical outputs (IRFs, GIRFs, FEVDs, GFEVDs and Term Premia) for each one of the draws;
</p>
</li>
<li><p> Confidence bounds for the chosen level of significance.
</p>
</li></ul>



<h3>References</h3>

<p>This function is a modified and extended version of the <code>VARirbound</code> function from &quot;A toolbox for VAR analysis&quot;
by Ambrogio Cesa-Bianchi (https://github.com/ambropo/VAR-Toolbox)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See an example of implementation in the vignette file of this package (Section 4).

</code></pre>

<hr>
<h2 id='BootstrapBoundsSet'>Builds the confidence bounds and graphs (Bootstrap set)</h2><span id='topic+BootstrapBoundsSet'></span>

<h3>Description</h3>

<p>Builds the confidence bounds and graphs (Bootstrap set)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BootstrapBoundsSet(
  ModelType,
  ModelBootstrap,
  NumOutPE,
  InputsForOutputs,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BootstrapBoundsSet_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="BootstrapBoundsSet_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>list containing the complete set of model parameters after the bootstrap estimation procedure</p>
</td></tr>
<tr><td><code id="BootstrapBoundsSet_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>point estimate from the numerical outputs (see the outputs of the &quot;NumOutputs&quot; function)</p>
</td></tr>
<tr><td><code id="BootstrapBoundsSet_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction of IRFs, GIRFs, FEVDs, and GFEVDs</p>
</td></tr>
<tr><td><code id="BootstrapBoundsSet_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='bound2x'>Transform a number bounded between a lower bound and upper bound to x by:</h2><span id='topic+bound2x'></span>

<h3>Description</h3>

<p>Transform a number bounded between a lower bound and upper bound to x by:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bound2x(y, lb, ub)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bound2x_+3A_y">y</code></td>
<td>
<p>Number to be transformed (scalar)</p>
</td></tr>
<tr><td><code id="bound2x_+3A_lb">lb</code></td>
<td>
<p>lower bound (scalar)</p>
</td></tr>
<tr><td><code id="bound2x_+3A_ub">ub</code></td>
<td>
<p>upper bound (scalar)</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is based on the &quot;bound2x&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='BR_jps_out'>Replications of the JPS (2014) outputs by Bauer and Rudebusch (2017)</h2><span id='topic+BR_jps_out'></span>

<h3>Description</h3>

<p>Unspanned macro risk model outputs by Bauer and Rudebusch (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BR_jps_gro_R3")
</code></pre>


<h3>Format</h3>

<p>Unspanned macro risk model outputs by Bauer and Rudebusch (2017)
</p>

<dl>
<dt>est.llk</dt><dd><p>summary list of log-likelihood estimations</p>
</dd>
<dt>M.o</dt><dd><p>time series of unspanned factors</p>
</dd>
<dt>pars</dt><dd><p>additional summary list of log-likelihood estimations</p>
</dd>
<dt>W</dt><dd><p>Weight matrix that results from principal components analysis</p>
</dd>
<dt>Y</dt><dd><p>time series of bond yields</p>
</dd>
<dt>N</dt><dd><p>total number of  risk factor of the model (spanned and unspanned)</p>
</dd>
<dt>R</dt><dd><p>total number of  spanned factor of the model</p>
</dd>
</dl>



<h3>References</h3>

<p>Bauer, M. and Rudebusch, G. &quot;Resolving the Spanning Puzzle in Macro-Finance Term Structure Models&quot;
</p>

<hr>
<h2 id='Build_xvec'>Obtain the auxiliary values corresponding to each parameter, its size and its name</h2><span id='topic+Build_xvec'></span>

<h3>Description</h3>

<p>Obtain the auxiliary values corresponding to each parameter, its size and its name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Build_xvec(ListInputSet, Economies, FactorLabels, JLLinputs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Build_xvec_+3A_listinputset">ListInputSet</code></td>
<td>
<p>variable inputs used in the optimization (see &quot;optimization&quot; function)</p>
</td></tr>
<tr><td><code id="Build_xvec_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Build_xvec_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models (see <code>JLL</code> function)</p>
</td></tr>
<tr><td><code id="Build_xvec_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>Necessary inputs for the estimation of the JLL-based models</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is a based on the &quot;getx&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
</p>

<hr>
<h2 id='BuildATSM_RiskFactors'>Builds the time series of the risk factors that are used in the estimation of the ATSM</h2><span id='topic+BuildATSM_RiskFactors'></span>

<h3>Description</h3>

<p>Builds the time series of the risk factors that are used in the estimation of the ATSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildATSM_RiskFactors(
  InitialSampleDate,
  FinalSampleDate,
  Yields,
  GlobalMacroFactors,
  DomMacroFactors,
  Economies,
  FactorLabels,
  ModelType,
  BS_Adj = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BuildATSM_RiskFactors_+3A_initialsampledate">InitialSampleDate</code></td>
<td>
<p>Sample starting date</p>
</td></tr>
<tr><td><code id="BuildATSM_RiskFactors_+3A_finalsampledate">FinalSampleDate</code></td>
<td>
<p>Sample last date</p>
</td></tr>
<tr><td><code id="BuildATSM_RiskFactors_+3A_yields">Yields</code></td>
<td>
<p>matrix  (J x T), where  J - the number of maturities and  T - time series length</p>
</td></tr>
<tr><td><code id="BuildATSM_RiskFactors_+3A_globalmacrofactors">GlobalMacroFactors</code></td>
<td>
<p>time series of the global macroeconomic risk factors (G x T)</p>
</td></tr>
<tr><td><code id="BuildATSM_RiskFactors_+3A_dommacrofactors">DomMacroFactors</code></td>
<td>
<p>time series of the country-specific macroeconomic risk factors for all C countries (CM x T)</p>
</td></tr>
<tr><td><code id="BuildATSM_RiskFactors_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="BuildATSM_RiskFactors_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="BuildATSM_RiskFactors_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="BuildATSM_RiskFactors_+3A_bs_adj">BS_Adj</code></td>
<td>
<p>adjustment of global series for sepQ model in the Bootstrap setting. Default is set to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Generates the complete set of risk factors that are used in the estimation of the ATSM
</p>

<hr>
<h2 id='BuildCI_Yields'>Build Confidence intervals for yield-related outputs</h2><span id='topic+BuildCI_Yields'></span>

<h3>Description</h3>

<p>Build Confidence intervals for yield-related outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildCI_Yields(
  NumOutBounds,
  NumOutPE,
  Lab_Int,
  ModelType,
  Economies,
  IdxResp,
  IdxShock,
  Ortho = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BuildCI_Yields_+3A_numoutbounds">NumOutBounds</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="BuildCI_Yields_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>numerical output set from the point estimate analysis</p>
</td></tr>
<tr><td><code id="BuildCI_Yields_+3A_lab_int">Lab_Int</code></td>
<td>
<p>Label of interest. available options are &quot;IRF&quot; and &quot;FEVD&quot;</p>
</td></tr>
<tr><td><code id="BuildCI_Yields_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="BuildCI_Yields_+3A_economies">Economies</code></td>
<td>
<p>name of the economies forming the economic system</p>
</td></tr>
<tr><td><code id="BuildCI_Yields_+3A_idxresp">IdxResp</code></td>
<td>
<p>index associated with the response variable</p>
</td></tr>
<tr><td><code id="BuildCI_Yields_+3A_idxshock">IdxShock</code></td>
<td>
<p>index associated with the shock variable</p>
</td></tr>
<tr><td><code id="BuildCI_Yields_+3A_ortho">Ortho</code></td>
<td>
<p>Option for orthogonal outputs, for JLL models. Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='BuildFEVDlist'>Build the list of IRF and GIRF for both factors and bond yields</h2><span id='topic+BuildFEVDlist'></span>

<h3>Description</h3>

<p>Build the list of IRF and GIRF for both factors and bond yields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildFEVDlist(
  NumOut,
  Economies,
  ModelType,
  FEVDhoriz,
  FacDim,
  YieldsDim,
  OutputType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BuildFEVDlist_+3A_numout">NumOut</code></td>
<td>
<p>list of computed outputs containing the model fit, IRFs, FEVDs, GIRFs, GFEVDs and Term Premia</p>
</td></tr>
<tr><td><code id="BuildFEVDlist_+3A_economies">Economies</code></td>
<td>
<p>Economies of the economic system</p>
</td></tr>
<tr><td><code id="BuildFEVDlist_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model type</p>
</td></tr>
<tr><td><code id="BuildFEVDlist_+3A_fevdhoriz">FEVDhoriz</code></td>
<td>
<p>time-horizon of the FEVD and GFEVD</p>
</td></tr>
<tr><td><code id="BuildFEVDlist_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor vector</p>
</td></tr>
<tr><td><code id="BuildFEVDlist_+3A_yieldsdim">YieldsDim</code></td>
<td>
<p>dimension of the model set of yields</p>
</td></tr>
<tr><td><code id="BuildFEVDlist_+3A_outputtype">OutputType</code></td>
<td>
<p>available option are 'FEVD' and 'GFEVD'</p>
</td></tr>
</table>

<hr>
<h2 id='BuildGVAR'>Build the GVAR(1) from the country-specific VARX(1,1,1)</h2><span id='topic+BuildGVAR'></span>

<h3>Description</h3>

<p>Build the GVAR(1) from the country-specific VARX(1,1,1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildGVAR(ParaVARX, GlobalPara, GVARinputs, DomLabels, GlobalLabels, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BuildGVAR_+3A_paravarx">ParaVARX</code></td>
<td>
<p>Set of VARX model parameters</p>
</td></tr>
<tr><td><code id="BuildGVAR_+3A_globalpara">GlobalPara</code></td>
<td>
<p>Set of marginal model parameters</p>
</td></tr>
<tr><td><code id="BuildGVAR_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
<tr><td><code id="BuildGVAR_+3A_domlabels">DomLabels</code></td>
<td>
<p>string-based vector containing label of the domestic risk factors</p>
</td></tr>
<tr><td><code id="BuildGVAR_+3A_globallabels">GlobalLabels</code></td>
<td>
<p>string-based vector containing label of the global risk factors</p>
</td></tr>
<tr><td><code id="BuildGVAR_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='BuildIRFlist'>Build the list of IRF and GIRF for both factors and bond yields</h2><span id='topic+BuildIRFlist'></span>

<h3>Description</h3>

<p>Build the list of IRF and GIRF for both factors and bond yields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildIRFlist(NumOut, Economies, ModelType, IRFhoriz, FacDim, OutputType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BuildIRFlist_+3A_numout">NumOut</code></td>
<td>
<p>list of computed outputs containing the model fit, IRFs, FEVDs, GIRFs, GFEVDs and Term Premia</p>
</td></tr>
<tr><td><code id="BuildIRFlist_+3A_economies">Economies</code></td>
<td>
<p>Economies of the economic system</p>
</td></tr>
<tr><td><code id="BuildIRFlist_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model type</p>
</td></tr>
<tr><td><code id="BuildIRFlist_+3A_irfhoriz">IRFhoriz</code></td>
<td>
<p>time-horizon of the IRF and GIRF</p>
</td></tr>
<tr><td><code id="BuildIRFlist_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor vector</p>
</td></tr>
<tr><td><code id="BuildIRFlist_+3A_outputtype">OutputType</code></td>
<td>
<p>available option are 'IRF' and 'GIRF'</p>
</td></tr>
</table>

<hr>
<h2 id='BuildLinkMat'>Build country-specific link matrices</h2><span id='topic+BuildLinkMat'></span>

<h3>Description</h3>

<p>Build country-specific link matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildLinkMat(GVARinputs, N, M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BuildLinkMat_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
<tr><td><code id="BuildLinkMat_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
<tr><td><code id="BuildLinkMat_+3A_m">M</code></td>
<td>
<p>number of country-specific unspanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='BuildRiskFactors_BS'>Build the time-series of the risk factors in each bootstrap draw</h2><span id='topic+BuildRiskFactors_BS'></span>

<h3>Description</h3>

<p>Build the time-series of the risk factors in each bootstrap draw
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildRiskFactors_BS(
  ModelParaPE,
  residPdynOriginal,
  residYieOriginal,
  InputsForOutputs,
  Economies,
  ModelType,
  FactorLabels,
  GVARlist,
  JLLlist,
  WishBRW,
  BRWlist,
  nlag = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BuildRiskFactors_BS_+3A_modelparape">ModelParaPE</code></td>
<td>
<p>list of point estimates of the model parameter</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_residpdynoriginal">residPdynOriginal</code></td>
<td>
<p>Time-series of the residuals from the P-dynamics equation (T x F)</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_residyieoriginal">residYieOriginal</code></td>
<td>
<p>Time-series of the residuals from the observational equation (T x J or T x CJ)</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model to be estimated</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_gvarlist">GVARlist</code></td>
<td>
<p>list of necessary inputs for the estimation of GVAR-based models</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_jlllist">JLLlist</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_wishbrw">WishBRW</code></td>
<td>
<p>Whether the user wishes to estimate the physical parameter model with the Bias correction model from BRW (2012) (see &quot;Bias_Correc_VAR&quot; function).<br />
Default is set to 0.</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_brwlist">BRWlist</code></td>
<td>
<p>list of necessary inputs for performing the bias-corrected estimation (see &quot;Bias_Correc_VAR&quot; function)</p>
</td></tr>
<tr><td><code id="BuildRiskFactors_BS_+3A_nlag">nlag</code></td>
<td>
<p>Number of lags in the P-dynamics. Default is set to 1.</p>
</td></tr>
</table>

<hr>
<h2 id='BuildYields_BS'>Build the time-series of bond yields for each bootstrap draw</h2><span id='topic+BuildYields_BS'></span>

<h3>Description</h3>

<p>Build the time-series of bond yields for each bootstrap draw
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BuildYields_BS(
  ModelParaPE,
  ModelType,
  RiskFactors_BS,
  BFull,
  BS_Set,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BuildYields_BS_+3A_modelparape">ModelParaPE</code></td>
<td>
<p>list of point estimates of the model parameter</p>
</td></tr>
<tr><td><code id="BuildYields_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="BuildYields_BS_+3A_riskfactors_bs">RiskFactors_BS</code></td>
<td>
<p>Time-series of the risk factors (F x T)</p>
</td></tr>
<tr><td><code id="BuildYields_BS_+3A_bfull">BFull</code></td>
<td>
<p>B matrix of loadings</p>
</td></tr>
<tr><td><code id="BuildYields_BS_+3A_bs_set">BS_Set</code></td>
<td>
<p>Set of bootstrap inputs</p>
</td></tr>
<tr><td><code id="BuildYields_BS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='BUnspannedAdapJoint'>Transform B_spanned into B_unspanned for jointQ models</h2><span id='topic+BUnspannedAdapJoint'></span>

<h3>Description</h3>

<p>Transform B_spanned into B_unspanned for jointQ models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BUnspannedAdapJoint(G, M, N, C, J, BSpanned)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BUnspannedAdapJoint_+3A_g">G</code></td>
<td>
<p>number of global unspanned factors</p>
</td></tr>
<tr><td><code id="BUnspannedAdapJoint_+3A_m">M</code></td>
<td>
<p>number of domestic unspanned factors</p>
</td></tr>
<tr><td><code id="BUnspannedAdapJoint_+3A_n">N</code></td>
<td>
<p>number of domestic spanned factors</p>
</td></tr>
<tr><td><code id="BUnspannedAdapJoint_+3A_c">C</code></td>
<td>
<p>number of economies of the economic system</p>
</td></tr>
<tr><td><code id="BUnspannedAdapJoint_+3A_j">J</code></td>
<td>
<p>number of country-specific observed bond yields</p>
</td></tr>
<tr><td><code id="BUnspannedAdapJoint_+3A_bspanned">BSpanned</code></td>
<td>
<p>B that accomodates only the map to the spanned factors only</p>
</td></tr>
</table>

<hr>
<h2 id='BUnspannedAdapSep'>Transform B_spanned into B_unspanned for sepQ models</h2><span id='topic+BUnspannedAdapSep'></span>

<h3>Description</h3>

<p>Transform B_spanned into B_unspanned for sepQ models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BUnspannedAdapSep(G, M, ModelPara, Economies, Economy, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BUnspannedAdapSep_+3A_g">G</code></td>
<td>
<p>number of global unspanned factors</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_+3A_m">M</code></td>
<td>
<p>number of domestic unspanned factors per country</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_+3A_economies">Economies</code></td>
<td>
<p>complet set of economies of the economic system</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_+3A_economy">Economy</code></td>
<td>
<p>specific economy under study</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='BUnspannedAdapSep_BS'>Obtain the full form of B unspanned for &quot;sep Q&quot; models within the bootstrap setting</h2><span id='topic+BUnspannedAdapSep_BS'></span>

<h3>Description</h3>

<p>Obtain the full form of B unspanned for &quot;sep Q&quot; models within the bootstrap setting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BUnspannedAdapSep_BS(G, M, ModelParaBoot, Economies, Economy, ModelType, tt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BUnspannedAdapSep_BS_+3A_g">G</code></td>
<td>
<p>number of global unspanned factors</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_BS_+3A_m">M</code></td>
<td>
<p>number of country-specific domestic unspanned factors</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_BS_+3A_modelparaboot">ModelParaBoot</code></td>
<td>
<p>list of model parameter estimates (see the &quot;Optimization&quot; function) after a bootstrap draw</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_BS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_BS_+3A_economy">Economy</code></td>
<td>
<p>string-vector containing the names of the economy under study</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="BUnspannedAdapSep_BS_+3A_tt">tt</code></td>
<td>
<p>number of the bootstrap draw</p>
</td></tr>
</table>

<hr>
<h2 id='Check_comparison__OLS'>check whether mean/median of OLS is close to actual OLS estimates</h2><span id='topic+Check_comparison__OLS'></span>

<h3>Description</h3>

<p>check whether mean/median of OLS is close to actual OLS estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Check_comparison__OLS(
  theta_tilde,
  theta_OLS,
  B_check,
  RiskFactors,
  N,
  GVARinputs,
  JLLinputs,
  FactorLabels,
  Economies,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Check_comparison__OLS_+3A_theta_tilde">theta_tilde</code></td>
<td>
<p>feedback matrix after the bias correction procedure</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_theta_ols">theta_OLS</code></td>
<td>
<p>feedback matrix obtained by OLS estimation (without bias correction)</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_b_check">B_check</code></td>
<td>
<p>number of bootstrap samples used in the closeness check</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of the risk factors (F x T)</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>inputs used in the estimation of the GVAR-based models (see &quot;GVAR&quot; function). Default is set to NULL</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>inputs used in the estimation of the JLL-based models (see &quot;JLL&quot; function). Default is set to NULL</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Check_comparison__OLS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Check_label_consistency'>Check consistency of labels (economies, domestic and global variables)</h2><span id='topic+Check_label_consistency'></span>

<h3>Description</h3>

<p>Check consistency of labels (economies, domestic and global variables)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Check_label_consistency(
  Economies,
  DomesticMacroFac,
  GlobalMacroFac,
  DomVarLab,
  GloVarLab
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Check_label_consistency_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Check_label_consistency_+3A_domesticmacrofac">DomesticMacroFac</code></td>
<td>
<p>time series of the country-specific domestic risk factors (C(M+N) x T)</p>
</td></tr>
<tr><td><code id="Check_label_consistency_+3A_globalmacrofac">GlobalMacroFac</code></td>
<td>
<p>time series of the global risk factors (G X T)</p>
</td></tr>
<tr><td><code id="Check_label_consistency_+3A_domvarlab">DomVarLab</code></td>
<td>
<p>string-vector containing the names of the desired domestic risk factors</p>
</td></tr>
<tr><td><code id="Check_label_consistency_+3A_glovarlab">GloVarLab</code></td>
<td>
<p>string-vector containing the names of the desired global risk factors</p>
</td></tr>
</table>

<hr>
<h2 id='CheckInputsForMLE'>Check consistence of inputs</h2><span id='topic+CheckInputsForMLE'></span>

<h3>Description</h3>

<p>Check consistence of inputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CheckInputsForMLE(
  t0,
  tF,
  Economies,
  DomesticMacroFac,
  GlobalMacroFac,
  UnitYields,
  DataFreq,
  Label_Single_Models,
  Label_Multi_Models,
  FactorLabels,
  GVARlist,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CheckInputsForMLE_+3A_t0">t0</code></td>
<td>
<p>Sample starting date</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_tf">tF</code></td>
<td>
<p>Sample last date</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies of the system.</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_domesticmacrofac">DomesticMacroFac</code></td>
<td>
<p>time series of the country-specific macroeconomic risk factors for all C countries (CM x T)</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_globalmacrofac">GlobalMacroFac</code></td>
<td>
<p>time series of the global macroeconomic risk factors (G x T)</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_unityields">UnitYields</code></td>
<td>
<p>(i) &quot;Month&quot;: if maturity of yields are expressed in months or
(ii) &quot;Year&quot;: if maturity of yields are expressed in years</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_datafreq">DataFreq</code></td>
<td>
<p>single element character-based vector. Available options are: &quot;Daily All Days&quot;, <br />
&quot;Daily Business Days&quot;, &quot;Weekly&quot;, &quot;Monthly&quot;,  &quot;Quarterly&quot;, &quot;Annually&quot;</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_label_single_models">Label_Single_Models</code></td>
<td>
<p>string-vector containing the names of the single country setups</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_label_multi_models">Label_Multi_Models</code></td>
<td>
<p>string-vector containing the names of the multicountry setups</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_gvarlist">GVARlist</code></td>
<td>
<p>list of necessary inputs for the estimation of GVAR-based models (see &quot;GVAR&quot; function)</p>
</td></tr>
<tr><td><code id="CheckInputsForMLE_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='CheckInputsGVAR'>Check consistency of the inputs provided in GVARinputs</h2><span id='topic+CheckInputsGVAR'></span>

<h3>Description</h3>

<p>Check consistency of the inputs provided in GVARinputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CheckInputsGVAR(GVARinputs, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CheckInputsGVAR_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
<tr><td><code id="CheckInputsGVAR_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='CheckJLLinputs'>Check consistency of the inputs provided in JLL-based models</h2><span id='topic+CheckJLLinputs'></span>

<h3>Description</h3>

<p>Check consistency of the inputs provided in JLL-based models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CheckJLLinputs(RiskFactorsNonOrtho, JLLinputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CheckJLLinputs_+3A_riskfactorsnonortho">RiskFactorsNonOrtho</code></td>
<td>
<p>Risk factors before the orthogonalization (FxT)</p>
</td></tr>
<tr><td><code id="CheckJLLinputs_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of necessary inputs to estimate JLL-based setups</p>
</td></tr>
</table>

<hr>
<h2 id='ChecksOOS'>Preliminary checks for inputs provided for the performing out-of-sample forecasting</h2><span id='topic+ChecksOOS'></span>

<h3>Description</h3>

<p>Preliminary checks for inputs provided for the performing out-of-sample forecasting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ChecksOOS(t0Forecast, t0Sample, nForecasts, ForecastType, TimeLength)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ChecksOOS_+3A_t0forecast">t0Forecast</code></td>
<td>
<p>Index of the last set of observations in the information set at the first forecasting round</p>
</td></tr>
<tr><td><code id="ChecksOOS_+3A_t0sample">t0Sample</code></td>
<td>
<p>Index of the first set of observations in the information set at the first forecasting round</p>
</td></tr>
<tr><td><code id="ChecksOOS_+3A_nforecasts">nForecasts</code></td>
<td>
<p>number of forecasting sets generated</p>
</td></tr>
<tr><td><code id="ChecksOOS_+3A_forecasttype">ForecastType</code></td>
<td>
<p>Forecast type. Available options are &quot;Rolling&quot; and &quot;Expanding&quot;.</p>
</td></tr>
<tr><td><code id="ChecksOOS_+3A_timelength">TimeLength</code></td>
<td>
<p>time-series dimension of the model</p>
</td></tr>
</table>

<hr>
<h2 id='CholRestrictionsJLL'>Impose the zero-restrictions on the Cholesky-factorization from JLL-based models.</h2><span id='topic+CholRestrictionsJLL'></span>

<h3>Description</h3>

<p>Impose the zero-restrictions on the Cholesky-factorization from JLL-based models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CholRestrictionsJLL(SigmaUnres, M, G, N, Economies, DomUnit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CholRestrictionsJLL_+3A_sigmaunres">SigmaUnres</code></td>
<td>
<p>unrestricted variance-covariance matrix (K X K)</p>
</td></tr>
<tr><td><code id="CholRestrictionsJLL_+3A_m">M</code></td>
<td>
<p>number of domestic unspanned factors per country (scalar)</p>
</td></tr>
<tr><td><code id="CholRestrictionsJLL_+3A_g">G</code></td>
<td>
<p>number of global unspanned factors (scalar)</p>
</td></tr>
<tr><td><code id="CholRestrictionsJLL_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
<tr><td><code id="CholRestrictionsJLL_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="CholRestrictionsJLL_+3A_domunit">DomUnit</code></td>
<td>
<p>Name of the economy which is assigned as the dominant unit. <br />
If no dominant unit is assigned, then this variable is defined as &quot;none&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>restricted version the Cholesky factorization matrix from JLL-based models (K x K)
</p>

<hr>
<h2 id='CleanOrthoJLL_Boot'>Clean unnecessary outputs of JLL models in the bootstrap setup</h2><span id='topic+CleanOrthoJLL_Boot'></span>

<h3>Description</h3>

<p>Clean unnecessary outputs of JLL models in the bootstrap setup
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CleanOrthoJLL_Boot(ModelBootstrap, ndraws, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CleanOrthoJLL_Boot_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>List of outputs to store bootstrap draws</p>
</td></tr>
<tr><td><code id="CleanOrthoJLL_Boot_+3A_ndraws">ndraws</code></td>
<td>
<p>Total number of bootstrap draws</p>
</td></tr>
<tr><td><code id="CleanOrthoJLL_Boot_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Compute_BnX_AnX'>Compute the latent loading AnX and BnX</h2><span id='topic+Compute_BnX_AnX'></span>

<h3>Description</h3>

<p>Compute the latent loading AnX and BnX
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Compute_BnX_AnX(mat, N, K1XQ, r0, dX, SSX, Economies, ModelType, Lab_SingleQ)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Compute_BnX_AnX_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (J x 1). Maturities are in multiples of the discrete interval used in the model</p>
</td></tr>
<tr><td><code id="Compute_BnX_AnX_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="Compute_BnX_AnX_+3A_k1xq">K1XQ</code></td>
<td>
<p>risk neutral feedback matrix (N x N)</p>
</td></tr>
<tr><td><code id="Compute_BnX_AnX_+3A_r0">r0</code></td>
<td>
<p>the long run risk neutral mean of the short rate (scalar)</p>
</td></tr>
<tr><td><code id="Compute_BnX_AnX_+3A_dx">dX</code></td>
<td>
<p>state loadings for the one-period rate (1xN). Default is a vector of ones</p>
</td></tr>
<tr><td><code id="Compute_BnX_AnX_+3A_ssx">SSX</code></td>
<td>
<p>the covariance matrix of the errors (N x N)</p>
</td></tr>
<tr><td><code id="Compute_BnX_AnX_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Compute_BnX_AnX_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="Compute_BnX_AnX_+3A_lab_singleq">Lab_SingleQ</code></td>
<td>
<p>string-vector containing the labels of the models estimated on a country-by-country basis</p>
</td></tr>
</table>

<hr>
<h2 id='Compute_EP'>Compute the expected component for all models</h2><span id='topic+Compute_EP'></span>

<h3>Description</h3>

<p>Compute the expected component for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Compute_EP(
  ModelPara,
  ModelType,
  UnitYields,
  matAdjUnit,
  N,
  rhoList,
  Economies,
  FactorLabels,
  WishFP = FALSE,
  matMIN = FALSE,
  matMAX = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Compute_EP_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model type</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_unityields">UnitYields</code></td>
<td>
<p>Available options: &quot;Month&quot; and &quot;Year&quot;</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_matadjunit">matAdjUnit</code></td>
<td>
<p>Adjusted vector of matutities</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_rholist">rhoList</code></td>
<td>
<p>List of risk-neutral parameters</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>List of factor labels</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_wishfp">WishFP</code></td>
<td>
<p>If users wants to compute the forward premia. Default is FALSE.</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_matmin">matMIN</code></td>
<td>
<p>For the forward premia, the shortest maturity of the remium of interest</p>
</td></tr>
<tr><td><code id="Compute_EP_+3A_matmax">matMAX</code></td>
<td>
<p>For the forward premia, the longest maturity of the remium of interest</p>
</td></tr>
</table>

<hr>
<h2 id='ComputeBounds_FEVDandGFEVD'>Compute the confidence bounds around the P-dynamics and bond yields for FEVD and GFEVD</h2><span id='topic+ComputeBounds_FEVDandGFEVD'></span>

<h3>Description</h3>

<p>Compute the confidence bounds around the P-dynamics and bond yields for FEVD and GFEVD
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ComputeBounds_FEVDandGFEVD(
  ModelBootstrap,
  quants,
  FacDim,
  YieDim,
  ModelType,
  Economies,
  ndraws,
  Horiz
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ComputeBounds_FEVDandGFEVD_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="ComputeBounds_FEVDandGFEVD_+3A_quants">quants</code></td>
<td>
<p>quantile of the confidence bounds</p>
</td></tr>
<tr><td><code id="ComputeBounds_FEVDandGFEVD_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="ComputeBounds_FEVDandGFEVD_+3A_yiedim">YieDim</code></td>
<td>
<p>dimension of the bond yield set</p>
</td></tr>
<tr><td><code id="ComputeBounds_FEVDandGFEVD_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="ComputeBounds_FEVDandGFEVD_+3A_economies">Economies</code></td>
<td>
<p>Economies that are part of the economic system</p>
</td></tr>
<tr><td><code id="ComputeBounds_FEVDandGFEVD_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws</p>
</td></tr>
<tr><td><code id="ComputeBounds_FEVDandGFEVD_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
</table>

<hr>
<h2 id='ComputeBounds_IRFandGIRF'>Compute the confidence bounds from the model's numerical outputs</h2><span id='topic+ComputeBounds_IRFandGIRF'></span>

<h3>Description</h3>

<p>Compute the confidence bounds from the model's numerical outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ComputeBounds_IRFandGIRF(
  ModelBootstrap,
  quants,
  FacDim,
  YieDim,
  ModelType,
  Economies,
  ndraws,
  Horiz
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ComputeBounds_IRFandGIRF_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="ComputeBounds_IRFandGIRF_+3A_quants">quants</code></td>
<td>
<p>quantile of the confidence bounds</p>
</td></tr>
<tr><td><code id="ComputeBounds_IRFandGIRF_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="ComputeBounds_IRFandGIRF_+3A_yiedim">YieDim</code></td>
<td>
<p>dimension of the bond yield set</p>
</td></tr>
<tr><td><code id="ComputeBounds_IRFandGIRF_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model type</p>
</td></tr>
<tr><td><code id="ComputeBounds_IRFandGIRF_+3A_economies">Economies</code></td>
<td>
<p>Economies that are part of the economic system</p>
</td></tr>
<tr><td><code id="ComputeBounds_IRFandGIRF_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws selected</p>
</td></tr>
<tr><td><code id="ComputeBounds_IRFandGIRF_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
</table>

<hr>
<h2 id='ComputeFEVDs'>Compute FEVDs for all models</h2><span id='topic+ComputeFEVDs'></span>

<h3>Description</h3>

<p>Compute FEVDs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ComputeFEVDs(
  SIGMA,
  K1Z,
  G0,
  BLoad,
  FactorLabels,
  FacDim,
  MatLength,
  FEVDhoriz,
  YieldsLabel,
  ModelType,
  Economy = NULL,
  CholFac_JLL = NULL,
  PI = NULL,
  Mode = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ComputeFEVDs_+3A_sigma">SIGMA</code></td>
<td>
<p>Variance-covariance matrix</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_k1z">K1Z</code></td>
<td>
<p>Loading As</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_g0">G0</code></td>
<td>
<p>contemporaneous terms</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_bload">BLoad</code></td>
<td>
<p>Loading Bs</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>List containing the label of factors</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_facdim">FacDim</code></td>
<td>
<p>Dimension of the P-dynamics</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_matlength">MatLength</code></td>
<td>
<p>Length of the maturity vector</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_fevdhoriz">FEVDhoriz</code></td>
<td>
<p>Horizon of the analysis</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_yieldslabel">YieldsLabel</code></td>
<td>
<p>Label of bond yields</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model type</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_economy">Economy</code></td>
<td>
<p>specific economy under study</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_cholfac_jll">CholFac_JLL</code></td>
<td>
<p>Cholesky factorization term from JLL models</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_pi">PI</code></td>
<td>
<p>matrix PI for JLL-based models</p>
</td></tr>
<tr><td><code id="ComputeFEVDs_+3A_mode">Mode</code></td>
<td>
<p>allows for the orthogonalized version in the case of JLL-based models</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li><p> This function is a modified and extended version of the &quot;fevd&quot; function from
Smith, L.V. and A. Galesi (2014). GVAR Toolbox 2.0, available at https://sites.google.com/site/gvarmodelling/gvar-toolbox.
</p>
</li>
<li><p> Pesaran and Shin, 1998. &quot;Generalized impulse response analysis in linear multivariate models&quot; (Economics Letters)
</p>
</li></ul>


<hr>
<h2 id='ComputeGFEVDs'>Compute GFEVDs for all models</h2><span id='topic+ComputeGFEVDs'></span>

<h3>Description</h3>

<p>Compute GFEVDs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ComputeGFEVDs(
  SIGMA,
  K1Z,
  G0,
  BLoad,
  FactorLabels,
  FacDim,
  MatLength,
  GFEVDhoriz,
  YieldsLabel,
  ModelType,
  Economy,
  PI = NULL,
  Mode = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ComputeGFEVDs_+3A_sigma">SIGMA</code></td>
<td>
<p>Variance-covariance matrix</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_k1z">K1Z</code></td>
<td>
<p>Loading As</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_g0">G0</code></td>
<td>
<p>contemporaneous terms</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_bload">BLoad</code></td>
<td>
<p>Loading Bs</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>List containing the label of factors</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_facdim">FacDim</code></td>
<td>
<p>Dimension of the P-dynamics</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_matlength">MatLength</code></td>
<td>
<p>Length of the maturity vector</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_gfevdhoriz">GFEVDhoriz</code></td>
<td>
<p>Horizon of the analysis</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_yieldslabel">YieldsLabel</code></td>
<td>
<p>Label of bond yields</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model type</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_economy">Economy</code></td>
<td>
<p>specific economy under study</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_pi">PI</code></td>
<td>
<p>matrix PI for JLL-based models</p>
</td></tr>
<tr><td><code id="ComputeGFEVDs_+3A_mode">Mode</code></td>
<td>
<p>allows for the orthogonalized version in the case of JLL-based models</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li><p> This function is a modified and extended version of the &quot;fevd&quot; function from
Smith, L.V. and A. Galesi (2014). GVAR Toolbox 2.0, available at https://sites.google.com/site/gvarmodelling/gvar-toolbox.
</p>
</li>
<li><p> Pesaran and Shin, 1998. &quot;Generalized impulse response analysis in linear multivariate models&quot; (Economics Letters)
</p>
</li></ul>


<hr>
<h2 id='ComputeGIRFs'>Compute GIRFs for all models</h2><span id='topic+ComputeGIRFs'></span>

<h3>Description</h3>

<p>Compute GIRFs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ComputeGIRFs(
  Sigma.y,
  F1,
  BLoad,
  G0.y,
  FactorLabels,
  FacDim,
  MatLength,
  GIRFhoriz,
  YieldsLabel,
  ModelType,
  Economy = NULL,
  PI = NULL,
  Mode = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ComputeGIRFs_+3A_sigma.y">Sigma.y</code></td>
<td>
<p>Variance-covariance matrix</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_f1">F1</code></td>
<td>
<p>Feedback matrix</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_bload">BLoad</code></td>
<td>
<p>Loading Bs</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_g0.y">G0.y</code></td>
<td>
<p>matrix of contemporaneous terms</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>List containing the labels of the factors</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_facdim">FacDim</code></td>
<td>
<p>Dimension of the P-dynamics</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_matlength">MatLength</code></td>
<td>
<p>Length of the maturity vector</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_girfhoriz">GIRFhoriz</code></td>
<td>
<p>Horizon of the analysis</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_yieldslabel">YieldsLabel</code></td>
<td>
<p>Label o yields</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_modeltype">ModelType</code></td>
<td>
<p>desired Model type</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_economy">Economy</code></td>
<td>
<p>Economy under study</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_pi">PI</code></td>
<td>
<p>matrix PI for JLL-based models</p>
</td></tr>
<tr><td><code id="ComputeGIRFs_+3A_mode">Mode</code></td>
<td>
<p>allows for the orthogonalized version in the case of JLL-based models
</p>
<p>#'#' @references
</p>

<ul>
<li><p> This function is a partially based on the version of the &quot;irf&quot; function from
Smith, L.V. and A. Galesi (2014). GVAR Toolbox 2.0, available at https://sites.google.com/site/gvarmodelling/gvar-toolbox.
</p>
</li>
<li><p> Pesaran and Shin, 1998. &quot;Generalized impulse response analysis in linear multivariate models&quot; (Economics Letters)
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='ComputeIRFs'>Compute IRFs of all models</h2><span id='topic+ComputeIRFs'></span>

<h3>Description</h3>

<p>Compute IRFs of all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ComputeIRFs(
  SIGMA,
  K1Z,
  BLoad,
  FactorLabels,
  FacDim,
  MatLength,
  IRFhoriz,
  YieldsLabel,
  ModelType,
  Economy = NULL,
  PI = NULL,
  Mode = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ComputeIRFs_+3A_sigma">SIGMA</code></td>
<td>
<p>Variance-covariance matrix</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_k1z">K1Z</code></td>
<td>
<p>Loading As</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_bload">BLoad</code></td>
<td>
<p>Loading Bs</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>List containing the label of factors</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_facdim">FacDim</code></td>
<td>
<p>Dimension of the P-dynamics</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_matlength">MatLength</code></td>
<td>
<p>Length of the maturity vector</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_irfhoriz">IRFhoriz</code></td>
<td>
<p>Horizon of the analysis</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_yieldslabel">YieldsLabel</code></td>
<td>
<p>Label of bond yields</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model type</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_economy">Economy</code></td>
<td>
<p>specific economy under study</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_pi">PI</code></td>
<td>
<p>matrix PI for JLL-based models</p>
</td></tr>
<tr><td><code id="ComputeIRFs_+3A_mode">Mode</code></td>
<td>
<p>allows for the orthogonalized version in the case of JLL-based models</p>
</td></tr>
</table>

<hr>
<h2 id='contain'>Check whether one element is a subset of another element</h2><span id='topic+contain'></span>

<h3>Description</h3>

<p>Check whether one element is a subset of another element
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contain(s1, s2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contain_+3A_s1">s1</code></td>
<td>
<p>smaller subset</p>
</td></tr>
<tr><td><code id="contain_+3A_s2">s2</code></td>
<td>
<p>complete set</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is based on the &quot;contain&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Convert2JordanForm'>Convert a generic matrix to its Jordan form</h2><span id='topic+Convert2JordanForm'></span>

<h3>Description</h3>

<p>Convert a generic matrix to its Jordan form
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Convert2JordanForm(K1XQ)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Convert2JordanForm_+3A_k1xq">K1XQ</code></td>
<td>
<p>squared matrix in non-Jordan form</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this Jordan matrix form handles real, complex and repeated eigenvalues.
</p>


<h3>Value</h3>

<p>squared matrix in Jordam form
</p>


<h3>References</h3>

<p>This function is based on the &quot;Convert2JordanForm&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='DatabasePrep'>Gather data of several countries in a list. Particularly useful for GVAR-based setups (Compute &quot;GVARFactors&quot;)</h2><span id='topic+DatabasePrep'></span>

<h3>Description</h3>

<p>Gather data of several countries in a list. Particularly useful for GVAR-based setups (Compute &quot;GVARFactors&quot;)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatabasePrep(
  t_First,
  t_Last,
  Economies,
  N,
  FactorLabels,
  ModelType,
  Wgvar = NULL,
  DataPathMacro = NULL,
  DataPathYields = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DatabasePrep_+3A_t_first">t_First</code></td>
<td>
<p>Start date of the sample period in the format yyyy-mm-dd.</p>
</td></tr>
<tr><td><code id="DatabasePrep_+3A_t_last">t_Last</code></td>
<td>
<p>End date of the sample period in the format yyyy-mm-dd.</p>
</td></tr>
<tr><td><code id="DatabasePrep_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="DatabasePrep_+3A_n">N</code></td>
<td>
<p>Integer. Number of country-specific spanned factors.</p>
</td></tr>
<tr><td><code id="DatabasePrep_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="DatabasePrep_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="DatabasePrep_+3A_wgvar">Wgvar</code></td>
<td>
<p>GVAR transition matrix of size C x C, applicable if a GVAR-type model is selected. Default is NULL.</p>
</td></tr>
<tr><td><code id="DatabasePrep_+3A_datapathmacro">DataPathMacro</code></td>
<td>
<p>File path to the Excel file containing macroeconomic data, if provided. The default path points to the Excel file available within the package.</p>
</td></tr>
<tr><td><code id="DatabasePrep_+3A_datapathyields">DataPathYields</code></td>
<td>
<p>File path to the Excel file containing yields data, if provided. The default path points to the Excel file available within the package</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the risk factor set used in the estimation of the GVAR-based models
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DomVar &lt;- c("Eco_Act", "Inflation")
GlobalVar &lt;- c("GBC", "CPI_OECD")
t0 &lt;- "2006-09-01"
tF &lt;-  "2019-01-01"
Economies &lt;- c("China", "Brazil", "Mexico", "Uruguay", "Russia")
N &lt;- 3
ModelType &lt;- "GVAR multi"
FactorLabels &lt;-  LabFac(N, DomVar, GlobalVar, Economies, ModelType)
Wgvar &lt;- Transition_Matrix(t_First = "2006", t_Last= "2019", Economies, type = "Sample Mean")


GVARFactors &lt;- DatabasePrep(t0, tF, Economies, N, FactorLabels, ModelType, Wgvar)


</code></pre>

<hr>
<h2 id='DataForEstimation'>Retrieves data from Excel and build the database used in the model estimation</h2><span id='topic+DataForEstimation'></span>

<h3>Description</h3>

<p>Retrieves data from Excel and build the database used in the model estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DataForEstimation(
  t0,
  tF,
  Economies,
  N,
  FactorLabels,
  ModelType,
  DataFrequency,
  W_type = NULL,
  t_First_Wgvar = NULL,
  t_Last_Wgvar = NULL,
  DataPathMacro = NULL,
  DataPathYields = NULL,
  DataPathTrade = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DataForEstimation_+3A_t0">t0</code></td>
<td>
<p>Start date of the sample period in the format yyyy-mm-dd.</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_tf">tF</code></td>
<td>
<p>End date of the sample period in the format yyyy-mm-dd.</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_n">N</code></td>
<td>
<p>Integer. Number of country-specific spanned factors.</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>String-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_modeltype">ModelType</code></td>
<td>
<p>String-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_datafrequency">DataFrequency</code></td>
<td>
<p>Character-based-vector. Avaialable options are: &quot;Daily All Days&quot;, &quot;Daily Business Days&quot;, &quot;Weekly&quot;, &quot;Monthly&quot;, &quot;Quarterly&quot;, &quot;Annually&quot;</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_w_type">W_type</code></td>
<td>
<p>Three possibilities:
</p>

<ul>
<li> <p><code>Full Sample</code>: if one wishes ALL weight matrices of each year from which data is available (it may extrapolate the sample period);
</p>
</li>
<li> <p><code>Sample Mean</code>: if one wishes a SINGLE weight matrix containing the average of weights over of the entire sample period;
</p>
</li>
<li><p> Some year in particular (e.g. &quot;1998&quot;, &quot;2005&quot; ...).
</p>
</li></ul>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_t_first_wgvar">t_First_Wgvar</code></td>
<td>
<p>Sample starting date (year)</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_t_last_wgvar">t_Last_Wgvar</code></td>
<td>
<p>Sample last date (year)</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_datapathmacro">DataPathMacro</code></td>
<td>
<p>Path of the Excel file containing the macroeconomic data (if any). The default is linked to the excel file present in the package.</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_datapathyields">DataPathYields</code></td>
<td>
<p>Path of the Excel file containing the yields data (if any). The default is linked to the excel file present in the package.</p>
</td></tr>
<tr><td><code id="DataForEstimation_+3A_datapathtrade">DataPathTrade</code></td>
<td>
<p>Path of the Excel file containing the trade data (if any). The default is linked to the excel file present in the package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the
</p>

<ol>
<li><p> time series of the complete set of bond yields (matrix, J x T or CJ x T);
</p>
</li>
<li><p> time series of the complete set risk factors (matrix, K x T);
</p>
</li>
<li><p> 'GVARFactors': list of all variables that are used in the estimation of the VARX <br />
(see e.g. <code>CM_Factors_GVAR</code> file). If the estimated model type is not GVAR-based, then returns NULL.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+InputsForOpt">InputsForOpt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DomVar &lt;- c("Eco_Act", "Inflation")
GlobalVar &lt;- c("GBC", "CPI_OECD")
t0 &lt;- "2006-09-01"
tF &lt;-  "2019-01-01"
Economies &lt;- c("China", "Brazil", "Mexico", "Uruguay", "Russia")
N &lt;- 2
ModelType &lt;- "JPS original"
FactorLabels &lt;-  LabFac(N, DomVar, GlobalVar, Economies, ModelType)
DataFrequency &lt;- "Monthly"


DataModel &lt;- DataForEstimation(t0, tF, Economies, N, FactorLabels, ModelType, DataFrequency)

</code></pre>

<hr>
<h2 id='DataSet_BS'>Prepare the factor set for GVAR models  (Bootstrap version)</h2><span id='topic+DataSet_BS'></span>

<h3>Description</h3>

<p>Prepare the factor set for GVAR models  (Bootstrap version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DataSet_BS(ModelType, RiskFactors, Wgvar, Economies, FactorLabels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DataSet_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="DataSet_BS_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>Complete set of risk factors (KxT)</p>
</td></tr>
<tr><td><code id="DataSet_BS_+3A_wgvar">Wgvar</code></td>
<td>
<p>transition matrix from GVAR models (CxC)</p>
</td></tr>
<tr><td><code id="DataSet_BS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="DataSet_BS_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
</table>

<hr>
<h2 id='df__dx'>Computes numerical first order derivative of f(x)</h2><span id='topic+df__dx'></span>

<h3>Description</h3>

<p>Computes numerical first order derivative of f(x)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df__dx(f, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df__dx_+3A_f">f</code></td>
<td>
<p>function which contains vector (J x T) valued function handle</p>
</td></tr>
<tr><td><code id="df__dx_+3A_x">x</code></td>
<td>
<p>parameter values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>transformed matrix (MN x JT)
</p>


<h3>References</h3>

<p>This function is based on the &quot;df__dx&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='DomesticMacroVar'>Data: Risk Factors - Candelon and Moura (forthcoming, JFEC)</h2><span id='topic+DomesticMacroVar'></span>

<h3>Description</h3>

<p>Risk factors data used in Candelon and Moura (forthcoming, JFEC)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_DomMacroFactors")
</code></pre>


<h3>Format</h3>

<p>matrix containing the  risk factors of the models
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (Forthcoming) &quot;A Multicountry Model of the Term Structures of Interest Rates with a GVAR&quot;. (Journal of Financial Econometrics)
</p>

<hr>
<h2 id='DomMacro'>Data: Risk Factors for the GVAR - Candelon and Moura (2023)</h2><span id='topic+DomMacro'></span>

<h3>Description</h3>

<p>Risk factors data used in the GVAR models - Candelon and Moura (2023)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_DomMacro_2023")
</code></pre>


<h3>Format</h3>

<p>list containing the variables used in the GVAR models
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (2023) &quot;Sovereign yield curves and the COVID-19 in emerging markets&quot;. (Economic Modelling)
</p>

<hr>
<h2 id='EstimationSigma_GVARrest'>Estimate numerically the variance-covariance matrix from the GVAR-based models</h2><span id='topic+EstimationSigma_GVARrest'></span>

<h3>Description</h3>

<p>Estimate numerically the variance-covariance matrix from the GVAR-based models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstimationSigma_GVARrest(SigmaUnres, res, IdxVarRest)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EstimationSigma_GVARrest_+3A_sigmaunres">SigmaUnres</code></td>
<td>
<p>Unrestricted variance-covariance matrix (K x K)</p>
</td></tr>
<tr><td><code id="EstimationSigma_GVARrest_+3A_res">res</code></td>
<td>
<p>residuals from the VAR of a GVAR model (K x T)</p>
</td></tr>
<tr><td><code id="EstimationSigma_GVARrest_+3A_idxvarrest">IdxVarRest</code></td>
<td>
<p>index of the variable that is selected as strictly exogenous</p>
</td></tr>
</table>


<h3>Value</h3>

<p>restricted version of the variance-covariance matrix a GVAR model (K x K)
</p>

<hr>
<h2 id='EstimationSigma_Ye'>Estimate numerically the Cholesky-factorization from the JLL-based models</h2><span id='topic+EstimationSigma_Ye'></span>

<h3>Description</h3>

<p>Estimate numerically the Cholesky-factorization from the JLL-based models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstimationSigma_Ye(SigmaUnres, res, M, G, Economies, DomUnit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EstimationSigma_Ye_+3A_sigmaunres">SigmaUnres</code></td>
<td>
<p>unrestricted variance-covariance matrix (K x K)</p>
</td></tr>
<tr><td><code id="EstimationSigma_Ye_+3A_res">res</code></td>
<td>
<p>residuals from the VAR of the JLL model (K x T)</p>
</td></tr>
<tr><td><code id="EstimationSigma_Ye_+3A_m">M</code></td>
<td>
<p>number of domestic unspanned factors per country (scalar)</p>
</td></tr>
<tr><td><code id="EstimationSigma_Ye_+3A_g">G</code></td>
<td>
<p>number of global unspanned factors (scalar)</p>
</td></tr>
<tr><td><code id="EstimationSigma_Ye_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="EstimationSigma_Ye_+3A_domunit">DomUnit</code></td>
<td>
<p>Name of the economy which is assigned as the dominant unit. <br />
If no dominant unit is assigned, then this variable is defined as &quot;none&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cholesky-factorization after the maximization (K x K)
</p>

<hr>
<h2 id='estVARbrw'>Estimate a VAR(1) - suited to Bauer, Rudebusch and Wu (2012) methodology</h2><span id='topic+estVARbrw'></span>

<h3>Description</h3>

<p>Estimate a VAR(1) - suited to Bauer, Rudebusch and Wu (2012) methodology
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estVARbrw(
  RiskFactors,
  ModelType,
  N,
  GVARinputs,
  JLLinputs,
  FactorLabels,
  Economies,
  demean = FALSE,
  intercept = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estVARbrw_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of the risk factors (T x F)</p>
</td></tr>
<tr><td><code id="estVARbrw_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="estVARbrw_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
<tr><td><code id="estVARbrw_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>inputs used in the estimation of the GVAR-based models (see &quot;GVAR&quot; function)</p>
</td></tr>
<tr><td><code id="estVARbrw_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>inputs used in the estimation of the JLL-based models (see &quot;JLL&quot; function)</p>
</td></tr>
<tr><td><code id="estVARbrw_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="estVARbrw_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="estVARbrw_+3A_demean">demean</code></td>
<td>
<p>demean the data before estimation. Default is set to FALSE</p>
</td></tr>
<tr><td><code id="estVARbrw_+3A_intercept">intercept</code></td>
<td>
<p>Include intercept in the VAR model. Default is set to TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing VAR(1) parameters
#'</p>

<ol>
<li><p> Gamma_hat: feedback matrix (F X F)
</p>
</li>
<li><p> alpha_hat: intercept (F x 1)
</p>
</li></ol>

<p>#'@references
Bauer, Rudebusch and, Wu (2012). &quot;Correcting Estimation Bias in Dynamic Term Structure Models&quot;. <br />
This function is similar to the &quot;estVAR&quot; Matlab function available at Cynthia Wu's website
(https://sites.google.com/view/jingcynthiawu/).
</p>

<hr>
<h2 id='ExpectedComponent'>Get the expected component of all models</h2><span id='topic+ExpectedComponent'></span>

<h3>Description</h3>

<p>Get the expected component of all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExpectedComponent(
  ModelPara,
  InputsForOutputs,
  ModelType,
  Economies,
  FactorLabels,
  WishFP = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExpectedComponent_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates</p>
</td></tr>
<tr><td><code id="ExpectedComponent_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired horizon of analysis for the model fit, IRFs, GIRFs, FEVDs, GFEVDs,
and risk premia decomposition</p>
</td></tr>
<tr><td><code id="ExpectedComponent_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="ExpectedComponent_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="ExpectedComponent_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="ExpectedComponent_+3A_wishfp">WishFP</code></td>
<td>
<p>If users wants to compute the forward premia. Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='FacQuantile_bs'>Compute quantiles for model P-dynamics</h2><span id='topic+FacQuantile_bs'></span>

<h3>Description</h3>

<p>Compute quantiles for model P-dynamics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FacQuantile_bs(
  DrawSet,
  LabIRF,
  ndraws,
  quants,
  Horiz,
  FacDim,
  DimLabelsFac,
  ModelType,
  Ortho = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FacQuantile_bs_+3A_drawset">DrawSet</code></td>
<td>
<p>Draw-specific set</p>
</td></tr>
<tr><td><code id="FacQuantile_bs_+3A_labirf">LabIRF</code></td>
<td>
<p>vector containing the labels &quot;IRF&quot; and &quot;GIRF&quot;</p>
</td></tr>
<tr><td><code id="FacQuantile_bs_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws</p>
</td></tr>
<tr><td><code id="FacQuantile_bs_+3A_quants">quants</code></td>
<td>
<p>quantile of the confidence bounds</p>
</td></tr>
<tr><td><code id="FacQuantile_bs_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
<tr><td><code id="FacQuantile_bs_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="FacQuantile_bs_+3A_dimlabelsfac">DimLabelsFac</code></td>
<td>
<p>labels of the factor set</p>
</td></tr>
<tr><td><code id="FacQuantile_bs_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="FacQuantile_bs_+3A_ortho">Ortho</code></td>
<td>
<p>Orthogonolized version for the JLL models. Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='FactorBounds_FEVDandGFEVD'>Compute the confidence bounds for the model bond P-dynamics-related outputs</h2><span id='topic+FactorBounds_FEVDandGFEVD'></span>

<h3>Description</h3>

<p>Compute the confidence bounds for the model bond P-dynamics-related outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FactorBounds_FEVDandGFEVD(
  ModelBootstrap,
  quants,
  ModelType,
  ndraws,
  Horiz,
  FacDim,
  LabFEVD,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FactorBounds_FEVDandGFEVD_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="FactorBounds_FEVDandGFEVD_+3A_quants">quants</code></td>
<td>
<p>quantile of the confidence bounds</p>
</td></tr>
<tr><td><code id="FactorBounds_FEVDandGFEVD_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="FactorBounds_FEVDandGFEVD_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws</p>
</td></tr>
<tr><td><code id="FactorBounds_FEVDandGFEVD_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
<tr><td><code id="FactorBounds_FEVDandGFEVD_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="FactorBounds_FEVDandGFEVD_+3A_labfevd">LabFEVD</code></td>
<td>
<p>vector containing the labels &quot;FEVD&quot; and &quot;GFEVD&quot;</p>
</td></tr>
<tr><td><code id="FactorBounds_FEVDandGFEVD_+3A_economies">Economies</code></td>
<td>
<p>Economies that are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='FactorBounds_IRFandGIRF'>Compute the confidence bounds for the model P-dynamics</h2><span id='topic+FactorBounds_IRFandGIRF'></span>

<h3>Description</h3>

<p>Compute the confidence bounds for the model P-dynamics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FactorBounds_IRFandGIRF(
  ModelBootstrap,
  quants,
  ModelType,
  ndraws,
  Horiz,
  FacDim,
  LabIRF,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FactorBounds_IRFandGIRF_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="FactorBounds_IRFandGIRF_+3A_quants">quants</code></td>
<td>
<p>quantile of the confidence bounds</p>
</td></tr>
<tr><td><code id="FactorBounds_IRFandGIRF_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="FactorBounds_IRFandGIRF_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws</p>
</td></tr>
<tr><td><code id="FactorBounds_IRFandGIRF_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
<tr><td><code id="FactorBounds_IRFandGIRF_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="FactorBounds_IRFandGIRF_+3A_labirf">LabIRF</code></td>
<td>
<p>vector containing the labels &quot;IRF&quot; and &quot;GIRF&quot;</p>
</td></tr>
<tr><td><code id="FactorBounds_IRFandGIRF_+3A_economies">Economies</code></td>
<td>
<p>Economies that are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='Factors_NonOrtho'>Makes the pre-allocation of the factors set for JLL-based models</h2><span id='topic+Factors_NonOrtho'></span>

<h3>Description</h3>

<p>Makes the pre-allocation of the factors set for JLL-based models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Factors_NonOrtho(NonOrthoFactors, JLLinputs, FactorLab, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Factors_NonOrtho_+3A_nonorthofactors">NonOrthoFactors</code></td>
<td>
<p>Risk factors before the orthogonalization (FxT)</p>
</td></tr>
<tr><td><code id="Factors_NonOrtho_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of necessary inputs to estimate JLL-based setups</p>
</td></tr>
<tr><td><code id="Factors_NonOrtho_+3A_factorlab">FactorLab</code></td>
<td>
<p>Variable labels from JLL-based models</p>
</td></tr>
<tr><td><code id="Factors_NonOrtho_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='FactorsGVAR'>Data: Risk Factors for the GVAR - Candelon and Moura (forthcoming, JFEC)</h2><span id='topic+FactorsGVAR'></span>

<h3>Description</h3>

<p>Risk factors data used in the GVAR models - Candelon and Moura (forthcoming, JFEC)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_Factors_GVAR")
</code></pre>


<h3>Format</h3>

<p>list containing the variables used in the GVAR models
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (Forthcoming) &quot;A Multicountry Model of the Term Structures of Interest Rates with a GVAR&quot;. (Journal of Financial Econometrics)
</p>

<hr>
<h2 id='FeedbackMat_BS'>Compute the Feedback matrix of each bootstrap draw</h2><span id='topic+FeedbackMat_BS'></span>

<h3>Description</h3>

<p>Compute the Feedback matrix of each bootstrap draw
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FeedbackMat_BS(
  ModelType,
  RiskFactors_TS,
  FactorLabels,
  Economies,
  GVARlist,
  JLLlist,
  WishBRW,
  BRWlist
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FeedbackMat_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="FeedbackMat_BS_+3A_riskfactors_ts">RiskFactors_TS</code></td>
<td>
<p>Time-series of risk factors of the bootstrap (F x T)</p>
</td></tr>
<tr><td><code id="FeedbackMat_BS_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="FeedbackMat_BS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="FeedbackMat_BS_+3A_gvarlist">GVARlist</code></td>
<td>
<p>list of necessary inputs for the estimation of GVAR-based models</p>
</td></tr>
<tr><td><code id="FeedbackMat_BS_+3A_jlllist">JLLlist</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models</p>
</td></tr>
<tr><td><code id="FeedbackMat_BS_+3A_wishbrw">WishBRW</code></td>
<td>
<p>Whether the user wishes to estimate the physical parameter model with the Bias correction model from BRW (2012) (see &quot;Bias_Correc_VAR&quot; function).<br />
Default is set to 0.</p>
</td></tr>
<tr><td><code id="FeedbackMat_BS_+3A_brwlist">BRWlist</code></td>
<td>
<p>list of necessary inputs for performing the bias-corrected estimation (see <code><a href="#topic+Bias_Correc_VAR">Bias_Correc_VAR</a></code> function)</p>
</td></tr>
</table>

<hr>
<h2 id='FeedbackMatrixRestrictionsJLL'>Set the zero-restrictions on the feedback matrix of JLL's P-dynamics</h2><span id='topic+FeedbackMatrixRestrictionsJLL'></span>

<h3>Description</h3>

<p>Set the zero-restrictions on the feedback matrix of JLL's P-dynamics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FeedbackMatrixRestrictionsJLL(DomUnit, K, G, M, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FeedbackMatrixRestrictionsJLL_+3A_domunit">DomUnit</code></td>
<td>
<p>Name of the economy which is assigned as the dominant unit. <br />
If no dominant unit is assigned, then this variable is defined as &quot;none&quot;</p>
</td></tr>
<tr><td><code id="FeedbackMatrixRestrictionsJLL_+3A_k">K</code></td>
<td>
<p>Total number of risk factors of the economic system (scalar)</p>
</td></tr>
<tr><td><code id="FeedbackMatrixRestrictionsJLL_+3A_g">G</code></td>
<td>
<p>Number of global unspanned factors (scalar)</p>
</td></tr>
<tr><td><code id="FeedbackMatrixRestrictionsJLL_+3A_m">M</code></td>
<td>
<p>Number of country-specific unspanned factors (scalar)</p>
</td></tr>
<tr><td><code id="FeedbackMatrixRestrictionsJLL_+3A_n">N</code></td>
<td>
<p>Number of country-specific spanned factors (scalar)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix containing the restrictions of the feedback matrix (K x K)
</p>

<hr>
<h2 id='FEVDandGFEVD'>FEVDs and GFEVDs for all models</h2><span id='topic+FEVDandGFEVD'></span>

<h3>Description</h3>

<p>FEVDs and GFEVDs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FEVDandGFEVD(ModelType, ModelPara, FEVDhoriz, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FEVDandGFEVD_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="FEVDandGFEVD_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates (see the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="FEVDandGFEVD_+3A_fevdhoriz">FEVDhoriz</code></td>
<td>
<p>single numerical vector containing the desired horizon of analysis for the FEVDs and GFEVDs</p>
</td></tr>
<tr><td><code id="FEVDandGFEVD_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="FEVDandGFEVD_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Structural shocks are identified via Cholesky decomposition
</p>

<hr>
<h2 id='FEVDandGFEVD_BS'>FEVDs and GFEVDs after bootstrap for all models</h2><span id='topic+FEVDandGFEVD_BS'></span>

<h3>Description</h3>

<p>FEVDs and GFEVDs after bootstrap for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FEVDandGFEVD_BS(ModelType, ModelParaBoot, FEVDhoriz, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FEVDandGFEVD_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="FEVDandGFEVD_BS_+3A_modelparaboot">ModelParaBoot</code></td>
<td>
<p>list of model parameter estimates (see the &quot;Optimization&quot; function) after a bootstrap draw</p>
</td></tr>
<tr><td><code id="FEVDandGFEVD_BS_+3A_fevdhoriz">FEVDhoriz</code></td>
<td>
<p>single numerical vector conataining the desired horizon of analysis for the FEVDs</p>
</td></tr>
<tr><td><code id="FEVDandGFEVD_BS_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="FEVDandGFEVD_BS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='FEVDandGFEVDbs'>Creates the confidence bounds and the graphs of FEVDs and GFEVDs after bootstrap (all models)</h2><span id='topic+FEVDandGFEVDbs'></span>

<h3>Description</h3>

<p>Creates the confidence bounds and the graphs of FEVDs and GFEVDs after bootstrap (all models)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FEVDandGFEVDbs(
  ModelType,
  ModelBootstrap,
  NumOutPE,
  InputsForOutputs,
  Economies,
  PathsGraphs
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FEVDandGFEVDbs_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDbs_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>list containing the complete set of model parameters after bootstrap estimation procedure</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDbs_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>list of model parameter point estimates</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDbs_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction of the outputs of interest</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDbs_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDbs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>path of the folder in which the graphs will be saved</p>
</td></tr>
</table>

<hr>
<h2 id='FEVDandGFEVDgraphs'>FEVD and GFEVD graphs for all models</h2><span id='topic+FEVDandGFEVDgraphs'></span>

<h3>Description</h3>

<p>FEVD and GFEVD graphs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FEVDandGFEVDgraphs(
  ModelType,
  NumOut,
  WishPdynamicsgraphs,
  WishYieldsgraphs,
  FEVDhoriz,
  PathsGraphs,
  OutputType,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FEVDandGFEVDgraphs_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDgraphs_+3A_numout">NumOut</code></td>
<td>
<p>list of computed outputs containing the model fit, IRFs, FEVDs, GIRFs, and GFEVDs</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDgraphs_+3A_wishpdynamicsgraphs">WishPdynamicsgraphs</code></td>
<td>
<p>binary variable: set 1, if the user wishes graphs to be generated; or set 0, otherwise</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDgraphs_+3A_wishyieldsgraphs">WishYieldsgraphs</code></td>
<td>
<p>binary variable: set 1, if the user wishes graphs to be generated; or set 0, otherwise</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDgraphs_+3A_fevdhoriz">FEVDhoriz</code></td>
<td>
<p>single numerical vector containing the desired horizon of analysis for the FEVDs</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDgraphs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>Path of the folder in which the graphs will be saved</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDgraphs_+3A_outputtype">OutputType</code></td>
<td>
<p>Available options are 'FEVD' and 'GFEVD'</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDgraphs_+3A_economies">Economies</code></td>
<td>
<p>a string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='FEVDandGFEVDs_Graphs'>Generates graphs for FEVDs and GFEVDs</h2><span id='topic+FEVDandGFEVDs_Graphs'></span>

<h3>Description</h3>

<p>Generates graphs for FEVDs and GFEVDs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FEVDandGFEVDs_Graphs(OutputType, FEVDlist, nmVarInt, Lab_Fac, PathsGraphs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FEVDandGFEVDs_Graphs_+3A_outputtype">OutputType</code></td>
<td>
<p>available options are &quot;FEVD&quot;, &quot;GFEVD&quot;, &quot;FEVD Ortho&quot; and &quot;GFEVD Ortho&quot;</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDs_Graphs_+3A_fevdlist">FEVDlist</code></td>
<td>
<p>list of FEVD and GFEVD outputs</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDs_Graphs_+3A_nmvarint">nmVarInt</code></td>
<td>
<p>name of variable of interest. Options: &quot;Factors&quot; and &quot;Yields&quot;</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDs_Graphs_+3A_lab_fac">Lab_Fac</code></td>
<td>
<p>label of the model factors</p>
</td></tr>
<tr><td><code id="FEVDandGFEVDs_Graphs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>Path to save graphs</p>
</td></tr>
</table>

<hr>
<h2 id='FF'>mean of the llk function used in the estimation of the selected ATSM</h2><span id='topic+FF'></span>

<h3>Description</h3>

<p>mean of the llk function used in the estimation of the selected ATSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FF(x0, FFvectorized)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FF_+3A_x0">x0</code></td>
<td>
<p>vector of parameters to be estimated numerically</p>
</td></tr>
<tr><td><code id="FF_+3A_ffvectorized">FFvectorized</code></td>
<td>
<p>log-likelihood function</p>
</td></tr>
</table>

<hr>
<h2 id='FFtemporary'>Mean of the llk function used in the estimation of the selected ATSM</h2><span id='topic+FFtemporary'></span>

<h3>Description</h3>

<p>Mean of the llk function used in the estimation of the selected ATSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FFtemporary(xtemp, scaling_vector, FFvectorized)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FFtemporary_+3A_xtemp">xtemp</code></td>
<td>
<p>temporary vector of parameters to be estimated numerically</p>
</td></tr>
<tr><td><code id="FFtemporary_+3A_scaling_vector">scaling_vector</code></td>
<td>
<p>scaling factor</p>
</td></tr>
<tr><td><code id="FFtemporary_+3A_ffvectorized">FFvectorized</code></td>
<td>
<p>log-likelihood function</p>
</td></tr>
</table>

<hr>
<h2 id='Fit_Subplot'>Build subplot for fitted yields</h2><span id='topic+Fit_Subplot'></span>

<h3>Description</h3>

<p>Build subplot for fitted yields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fit_Subplot(
  YieldData,
  ModelFit,
  ModelImplied,
  MatLength,
  mat,
  Economies,
  ModelType,
  PathsGraphs
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Fit_Subplot_+3A_yielddata">YieldData</code></td>
<td>
<p>Time series of bond yields</p>
</td></tr>
<tr><td><code id="Fit_Subplot_+3A_modelfit">ModelFit</code></td>
<td>
<p>Time series of fitted bond yields</p>
</td></tr>
<tr><td><code id="Fit_Subplot_+3A_modelimplied">ModelImplied</code></td>
<td>
<p>Time series of model-implied bond yields</p>
</td></tr>
<tr><td><code id="Fit_Subplot_+3A_matlength">MatLength</code></td>
<td>
<p>number of country-specific maturities</p>
</td></tr>
<tr><td><code id="Fit_Subplot_+3A_mat">mat</code></td>
<td>
<p>vector of maturities</p>
</td></tr>
<tr><td><code id="Fit_Subplot_+3A_economies">Economies</code></td>
<td>
<p>Economies of the economic system</p>
</td></tr>
<tr><td><code id="Fit_Subplot_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired estimated model</p>
</td></tr>
<tr><td><code id="Fit_Subplot_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>Path to save the graphs</p>
</td></tr>
</table>

<hr>
<h2 id='Fitgraphs'>Model fit graphs for all models</h2><span id='topic+Fitgraphs'></span>

<h3>Description</h3>

<p>Model fit graphs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fitgraphs(ModelType, WishFitgraphs, ModelPara, NumOut, Economies, PathsGraphs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Fitgraphs_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="Fitgraphs_+3A_wishfitgraphs">WishFitgraphs</code></td>
<td>
<p>binary variable: set 1, if the user wishes graphs to be generated; or set 0, otherwise</p>
</td></tr>
<tr><td><code id="Fitgraphs_+3A_modelpara">ModelPara</code></td>
<td>
<p>List of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="Fitgraphs_+3A_numout">NumOut</code></td>
<td>
<p>list of computed outputs containing the model fit, IRFs, FEVDs, GIRFs, and GFEVDs</p>
</td></tr>
<tr><td><code id="Fitgraphs_+3A_economies">Economies</code></td>
<td>
<p>a string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Fitgraphs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>Path of the folder in which the graphs will be saved</p>
</td></tr>
</table>

<hr>
<h2 id='FMN__Rotate'>Performs state rotations</h2><span id='topic+FMN__Rotate'></span>

<h3>Description</h3>

<p>Performs state rotations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMN__Rotate(y0, U1, U0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FMN__Rotate_+3A_y0">y0</code></td>
<td>
<p>list  of model parameters as described below</p>
</td></tr>
<tr><td><code id="FMN__Rotate_+3A_u1">U1</code></td>
<td>
<p>matrix (N x N)</p>
</td></tr>
<tr><td><code id="FMN__Rotate_+3A_u0">U0</code></td>
<td>
<p>vector (N x 1). Optional. Default: vector of zeros.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a rotation from a model with Z as states to one with S = U0 + U1*Z as states. <br />
Specifically, each model is characterized by the following inputs organized in a list of variables:<br />
(i) K0: intercepts (N x 1);<br />
(ii) K1: feedback matrix (N x N*p); <br />
(iii) SS: volatility matrices (N x N*(M+1))<br />
More specifically, the state Z follows the dynamics: <br />
Z_t = N(K0 + K1 [Z_{t-1}; Z_{t-2}; ...],  SSi[ , , 1] + sum_{i=1}^M SSi[ , ,i+1]
where SSi &lt;- array(SS, c(N, N, M+1))
</p>


<h3>Value</h3>

<p>y1 - list of outputs after the transformation, the structure parallels that of y0
</p>


<h3>References</h3>

<p>#' This function is modified version of the &quot;FMN__Rotate&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot;<br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='FolderCreation_Boot'>Creates folder to store graphs generated from the bootstrap analysis</h2><span id='topic+FolderCreation_Boot'></span>

<h3>Description</h3>

<p>Creates folder to store graphs generated from the bootstrap analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FolderCreation_Boot(ModelType, LabIRF, Economies, OutType, Ortho = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FolderCreation_Boot_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model type</p>
</td></tr>
<tr><td><code id="FolderCreation_Boot_+3A_labirf">LabIRF</code></td>
<td>
<p>Output types &quot;IRF&quot;, &quot;GIRF&quot; and &quot;IRF Ortho&quot;</p>
</td></tr>
<tr><td><code id="FolderCreation_Boot_+3A_economies">Economies</code></td>
<td>
<p>economies of the economic system</p>
</td></tr>
<tr><td><code id="FolderCreation_Boot_+3A_outtype">OutType</code></td>
<td>
<p>Available option &quot;Factors&quot; or &quot;Yields</p>
</td></tr>
<tr><td><code id="FolderCreation_Boot_+3A_ortho">Ortho</code></td>
<td>
<p>Option for orthogonal outputs, for JLL models. Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='FolderCreationBoot'>Creates the folders and the path in which the graphical outputs are stored (Bootstrap version)</h2><span id='topic+FolderCreationBoot'></span>

<h3>Description</h3>

<p>Creates the folders and the path in which the graphical outputs are stored (Bootstrap version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FolderCreationBoot(ModelType, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FolderCreationBoot_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="FolderCreationBoot_+3A_economies">Economies</code></td>
<td>
<p>a string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='FolderCreationPoint'>Creates the folders and the path in which the graphical outputs are stored (point estimate version)</h2><span id='topic+FolderCreationPoint'></span>

<h3>Description</h3>

<p>Creates the folders and the path in which the graphical outputs are stored (point estimate version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FolderCreationPoint(ModelType, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FolderCreationPoint_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="FolderCreationPoint_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
</table>

<hr>
<h2 id='FolderPrep_FEVDs'>Create folders for storing IRFs and GIRFs</h2><span id='topic+FolderPrep_FEVDs'></span>

<h3>Description</h3>

<p>Create folders for storing IRFs and GIRFs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FolderPrep_FEVDs(
  OutputType,
  WishPdynamicsgraphs,
  WishYieldsgraphs,
  Economies,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FolderPrep_FEVDs_+3A_outputtype">OutputType</code></td>
<td>
<p>available options are &quot;IRF&quot;, &quot;GIRF&quot;, &quot;IRF Ortho&quot; and &quot;GIRF Ortho&quot;</p>
</td></tr>
<tr><td><code id="FolderPrep_FEVDs_+3A_wishpdynamicsgraphs">WishPdynamicsgraphs</code></td>
<td>
<p>binary variable specifing whether the user whishes IRFs and/or GIRFs of risk factors</p>
</td></tr>
<tr><td><code id="FolderPrep_FEVDs_+3A_wishyieldsgraphs">WishYieldsgraphs</code></td>
<td>
<p>binary variable specifing whether the user whishes IRFs and/or GIRFs of bond yields</p>
</td></tr>
<tr><td><code id="FolderPrep_FEVDs_+3A_economies">Economies</code></td>
<td>
<p>Set of economies that are part of the economic system</p>
</td></tr>
<tr><td><code id="FolderPrep_FEVDs_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired modem type</p>
</td></tr>
</table>

<hr>
<h2 id='FolderPrep_IRFs'>Create folders for storing IRFs and GIRFs</h2><span id='topic+FolderPrep_IRFs'></span>

<h3>Description</h3>

<p>Create folders for storing IRFs and GIRFs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FolderPrep_IRFs(
  OutputType,
  WishPdynamicsgraphs,
  WishYieldsgraphs,
  Economies,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FolderPrep_IRFs_+3A_outputtype">OutputType</code></td>
<td>
<p>available options are &quot;IRF&quot;, &quot;GIRF&quot;, &quot;IRF Ortho&quot; and &quot;GIRF Ortho&quot;</p>
</td></tr>
<tr><td><code id="FolderPrep_IRFs_+3A_wishpdynamicsgraphs">WishPdynamicsgraphs</code></td>
<td>
<p>binary variable specifying whether the user whishes IRFs and/or GIRFs of risk factors</p>
</td></tr>
<tr><td><code id="FolderPrep_IRFs_+3A_wishyieldsgraphs">WishYieldsgraphs</code></td>
<td>
<p>binary variable specifying whether the user whishes IRFs and/or GIRFs of bond yields</p>
</td></tr>
<tr><td><code id="FolderPrep_IRFs_+3A_economies">Economies</code></td>
<td>
<p>Set of economies that are part of the economic system</p>
</td></tr>
<tr><td><code id="FolderPrep_IRFs_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired modem type</p>
</td></tr>
</table>

<hr>
<h2 id='ForecastYields'>Generates forecasts of bond yields for all model types</h2><span id='topic+ForecastYields'></span>

<h3>Description</h3>

<p>Generates forecasts of bond yields for all model types
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ForecastYields(
  ModelType,
  ModelPara,
  InputsForOutputs,
  FactorLabels,
  Economies,
  JLLlist = NULL,
  GVARlist = NULL,
  WishBRW,
  BRWlist = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ForecastYields_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="ForecastYields_+3A_modelpara">ModelPara</code></td>
<td>
<p>A list containing the point estimates of the model parameters. For details, refer to the outputs from the <code><a href="#topic+Optimization">Optimization</a></code> function.</p>
</td></tr>
<tr><td><code id="ForecastYields_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>A list containing the necessary inputs for generating IRFs, GIRFs, FEVDs, GFEVDs and Term Premia.</p>
</td></tr>
<tr><td><code id="ForecastYields_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="ForecastYields_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="ForecastYields_+3A_jlllist">JLLlist</code></td>
<td>
<p>A list of necessary inputs for the estimation of JLL-based models (see the <code><a href="#topic+JLL">JLL</a></code> function).</p>
</td></tr>
<tr><td><code id="ForecastYields_+3A_gvarlist">GVARlist</code></td>
<td>
<p>A list containing the necessary inputs for the estimation of GVAR-based models (see the <code><a href="#topic+GVAR">GVAR</a></code> function).</p>
</td></tr>
<tr><td><code id="ForecastYields_+3A_wishbrw">WishBRW</code></td>
<td>
<p>Whether to estimate the physical parameter model with bias correction, based on the method by Bauer, Rudebusch and Wu (2012) (see <code><a href="#topic+Bias_Correc_VAR">Bias_Correc_VAR</a></code> function). Default is set to 0.</p>
</td></tr>
<tr><td><code id="ForecastYields_+3A_brwlist">BRWlist</code></td>
<td>
<p>List of necessary inputs for performing the bias-corrected estimation (see <code><a href="#topic+Bias_Correc_VAR">Bias_Correc_VAR</a></code> function).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the following elements
</p>

<ol>
<li><p> Out-of-sample forecasts of bond yields per forecast horizon
</p>
</li>
<li><p> Out-of-sample forecast errors of bond yields per forecast horizon
</p>
</li>
<li><p> Root mean square errors per forecast horizon
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'># See an example of implementation in the vignette file of this package (Section 4).


</code></pre>

<hr>
<h2 id='ForwardPremia'>Compute the forward premia for all models</h2><span id='topic+ForwardPremia'></span>

<h3>Description</h3>

<p>Compute the forward premia for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ForwardPremia(
  ModelPara,
  avexpFP,
  ModelType,
  FactorLabels,
  InputsForOutputs,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ForwardPremia_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates</p>
</td></tr>
<tr><td><code id="ForwardPremia_+3A_avexpfp">avexpFP</code></td>
<td>
<p>list containing the country-specific expected component of the forward period</p>
</td></tr>
<tr><td><code id="ForwardPremia_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="ForwardPremia_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>List of factor labels</p>
</td></tr>
<tr><td><code id="ForwardPremia_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired horizon of analysis for the model fit, IRFs, GIRFs, FEVDs, GFEVDs,
and risk premia decomposition</p>
</td></tr>
<tr><td><code id="ForwardPremia_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='Functionf'>Set up the vector-valued objective function (Point estimate)</h2><span id='topic+Functionf'></span>

<h3>Description</h3>

<p>Set up the vector-valued objective function (Point estimate)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Functionf(
  MLEinputs,
  Economies,
  DataFrequency,
  FactorLabels,
  ModelType,
  BS_outType = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Functionf_+3A_mleinputs">MLEinputs</code></td>
<td>
<p>Set of inputs that are necessary to the log-likelihood function</p>
</td></tr>
<tr><td><code id="Functionf_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Functionf_+3A_datafrequency">DataFrequency</code></td>
<td>
<p>character-based vector: &quot;Daily All Days&quot;, &quot;Daily Business Days&quot;, &quot;Weekly&quot;, &quot;Monthly&quot;, &quot;Quarterly&quot;, &quot;Annually&quot;</p>
</td></tr>
<tr><td><code id="Functionf_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Functionf_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="Functionf_+3A_bs_outtype">BS_outType</code></td>
<td>
<p>Generates simplified output list in the bootstrap setting. Default is set to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>objective function
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in the vignette file of this package (Section 4).

</code></pre>

<hr>
<h2 id='Functionf_vectorized'>Use function f to generate the outputs from a ATSM</h2><span id='topic+Functionf_vectorized'></span>

<h3>Description</h3>

<p>Use function f to generate the outputs from a ATSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Functionf_vectorized(
  x,
  sizex,
  f,
  con,
  ListInputSet,
  ModelType,
  FactorLabels,
  Economies,
  JLLinputs,
  GVARinputs,
  WithEstimation
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Functionf_vectorized_+3A_x">x</code></td>
<td>
<p>vector containing all the vectorized auxiliary parameters</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_sizex">sizex</code></td>
<td>
<p>matrix (6x2) containing the size information of all parameters</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_f">f</code></td>
<td>
<p>vector-valued objective function (function)</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_con">con</code></td>
<td>
<p>if con = 'concentration', then set the value of the parameter whose name
contains @ to empty</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_listinputset">ListInputSet</code></td>
<td>
<p>variable inputs used in the optimization (see inputs from &quot;optimization&quot; function)</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>Set of necessary inputs used in the estimation of the JLL-based models (see &quot;JLL&quot; function)</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>Set of necessary inputs used in the estimation of the GVAR-based models (see &quot;GVAR&quot; function)</p>
</td></tr>
<tr><td><code id="Functionf_vectorized_+3A_withestimation">WithEstimation</code></td>
<td>
<p>if TRUE, returns only the values of the likelihood function, else generates the entire set of outputs</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is modified version of the &quot;f_with_vectorized_parameters&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Gather_Forecasts'>Gather several forecast dates</h2><span id='topic+Gather_Forecasts'></span>

<h3>Description</h3>

<p>Gather several forecast dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gather_Forecasts(Forecast_OneDate, Forecast_AllDates, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Gather_Forecasts_+3A_forecast_onedate">Forecast_OneDate</code></td>
<td>
<p>Bond yield forecasts for a single date</p>
</td></tr>
<tr><td><code id="Gather_Forecasts_+3A_forecast_alldates">Forecast_AllDates</code></td>
<td>
<p>Bond yield forecasts for multiple dates</p>
</td></tr>
<tr><td><code id="Gather_Forecasts_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Gather_Forecasts_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='GaussianDensity'>computes the density function of a gaussian process</h2><span id='topic+GaussianDensity'></span>

<h3>Description</h3>

<p>computes the density function of a gaussian process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GaussianDensity(res, SS, invSS, logabsdetSS)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GaussianDensity_+3A_res">res</code></td>
<td>
<p>matrix of residuals (N x T)</p>
</td></tr>
<tr><td><code id="GaussianDensity_+3A_ss">SS</code></td>
<td>
<p>covariance matrice or array of covariance matrices <br />
(If dim(SS) &gt; 3, then the model has a stochastic volatility) (N x N) or (N x N x T)</p>
</td></tr>
<tr><td><code id="GaussianDensity_+3A_invss">invSS</code></td>
<td>
<p>Inverse of SS (N x N) or (N x N x T) - optional input</p>
</td></tr>
<tr><td><code id="GaussianDensity_+3A_logabsdetss">logabsdetSS</code></td>
<td>
<p>log(abs(|SS|)) (1 x T) - optional input</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y   - vector of density (1 x T)
</p>


<h3>References</h3>

<p>This function is based on the &quot;Gaussian&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Gen_Artificial_Series'>Generate artificial time-series in the bootstrap setup</h2><span id='topic+Gen_Artificial_Series'></span>

<h3>Description</h3>

<p>Generate artificial time-series in the bootstrap setup
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gen_Artificial_Series(
  ModelParaPE,
  residPdynOriginal,
  residYieOriginal,
  ModelType,
  BFull,
  InputsForOutputs,
  Economies,
  FactorLabels,
  GVARlist,
  JLLlist,
  WishBRW,
  BRWlist,
  nlag = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Gen_Artificial_Series_+3A_modelparape">ModelParaPE</code></td>
<td>
<p>list of point estimates of the model parameter</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_residpdynoriginal">residPdynOriginal</code></td>
<td>
<p>Time-series of the residuals from the P-dynamics equation (T x F)</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_residyieoriginal">residYieOriginal</code></td>
<td>
<p>Time-series of the residuals from the observational equation (T x J or T x CJ)</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_modeltype">ModelType</code></td>
<td>
<p>Desired model to be estimated</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_bfull">BFull</code></td>
<td>
<p>matrix B of loadings (CJ x F or J x F)</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_gvarlist">GVARlist</code></td>
<td>
<p>list of necessary inputs for the estimation of GVAR-based models</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_jlllist">JLLlist</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_wishbrw">WishBRW</code></td>
<td>
<p>Whether the user wishes to estimate the physical parameter model with the Bias correction model from BRW (2012) (see &quot;Bias_Correc_VAR&quot; function).<br />
Default is set to 0.</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_brwlist">BRWlist</code></td>
<td>
<p>list of necessary inputs for performing the bias-corrected estimation (see &quot;Bias_Correc_VAR&quot; function)</p>
</td></tr>
<tr><td><code id="Gen_Artificial_Series_+3A_nlag">nlag</code></td>
<td>
<p>Number of lags in the P-dynamics. Default is set to 1.</p>
</td></tr>
</table>

<hr>
<h2 id='Gen_Forecast_Yields'>compute the bond yield forecast for any model type</h2><span id='topic+Gen_Forecast_Yields'></span>

<h3>Description</h3>

<p>compute the bond yield forecast for any model type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gen_Forecast_Yields(
  K0Z,
  K1Z,
  A,
  Bfull,
  ZZsubsample,
  C,
  J,
  YieldsLabels,
  ForLabels,
  ForHoriz,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Gen_Forecast_Yields_+3A_k0z">K0Z</code></td>
<td>
<p>Intercept from the P-dynamics (F x 1)</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_k1z">K1Z</code></td>
<td>
<p>Feedback matrix from the P-dynamics (F x F)</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_a">A</code></td>
<td>
<p>Intercept of model-implied yields model (J x 1)</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_bfull">Bfull</code></td>
<td>
<p>Slope of model-implied yields model (J x N or CJ x CN)</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_zzsubsample">ZZsubsample</code></td>
<td>
<p>Sub-sample of risk factors (F X t)</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_c">C</code></td>
<td>
<p>Number of countries in the economic cohort (scalar)</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_j">J</code></td>
<td>
<p>Number of country-specific bond yields</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_yieldslabels">YieldsLabels</code></td>
<td>
<p>Labels of bond yields</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_forlabels">ForLabels</code></td>
<td>
<p>Forecast labels (string-based vector)</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_forhoriz">ForHoriz</code></td>
<td>
<p>forecast horizon (scalar)</p>
</td></tr>
<tr><td><code id="Gen_Forecast_Yields_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='GeneralMLEInputs'>Gathers the general inputs for model estimation</h2><span id='topic+GeneralMLEInputs'></span>

<h3>Description</h3>

<p>Gathers the general inputs for model estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GeneralMLEInputs(
  Yields,
  RiskFactors,
  FactorLabels,
  mat,
  DataFrequency,
  Label_Multi_Models,
  Economies,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GeneralMLEInputs_+3A_yields">Yields</code></td>
<td>
<p>matrix (CJ x T) or a list containing those matrices, where C is the number of countries,
J - the number of maturities and T - time series length <br /></p>
</td></tr>
<tr><td><code id="GeneralMLEInputs_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of risk factors (F x T). Could be stored in a list depending on the model</p>
</td></tr>
<tr><td><code id="GeneralMLEInputs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="GeneralMLEInputs_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) used in the estimation</p>
</td></tr>
<tr><td><code id="GeneralMLEInputs_+3A_datafrequency">DataFrequency</code></td>
<td>
<p>single element character-based vector. Available options are: &quot;Daily All Days&quot;, <br />
&quot;Daily Business Days&quot;, &quot;Weekly&quot;, &quot;Monthly&quot;,  &quot;Quarterly&quot;, &quot;Annually&quot;</p>
</td></tr>
<tr><td><code id="GeneralMLEInputs_+3A_label_multi_models">Label_Multi_Models</code></td>
<td>
<p>string-vector containing the names of the multicountry setups</p>
</td></tr>
<tr><td><code id="GeneralMLEInputs_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="GeneralMLEInputs_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='genVARbrw'>Generate M data sets from VAR(1) model</h2><span id='topic+genVARbrw'></span>

<h3>Description</h3>

<p>Generate M data sets from VAR(1) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genVARbrw(Phi, M, RiskFactors)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genVARbrw_+3A_phi">Phi</code></td>
<td>
<p>feedback matrix (F x F)</p>
</td></tr>
<tr><td><code id="genVARbrw_+3A_m">M</code></td>
<td>
<p>number of Monte Carlo replications</p>
</td></tr>
<tr><td><code id="genVARbrw_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of the risk factors (T x F)</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bauer, Rudebusch and, Wu (2012). &quot;Correcting Estimation Bias in Dynamic Term Structure Models&quot;. <br />
This function is based on to the&quot;genVAR&quot; Matlab function available at Cynthia Wu's website
(https://sites.google.com/view/jingcynthiawu/).
</p>

<hr>
<h2 id='Get_a0'>Obtain the country-specific a0</h2><span id='topic+Get_a0'></span>

<h3>Description</h3>

<p>Obtain the country-specific a0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_a0(GVARinputs, ParaVARX)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_a0_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
<tr><td><code id="Get_a0_+3A_paravarx">ParaVARX</code></td>
<td>
<p>List containing the set of VARX model parameters</p>
</td></tr>
</table>

<hr>
<h2 id='Get_As'>Compute the A loadings</h2><span id='topic+Get_As'></span>

<h3>Description</h3>

<p>Compute the A loadings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_As(LoadBs, Wpca, r0, dt, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_As_+3A_loadbs">LoadBs</code></td>
<td>
<p>list containing the B loadings</p>
</td></tr>
<tr><td><code id="Get_As_+3A_wpca">Wpca</code></td>
<td>
<p>matrix of weights of the portfolios observed without errors (N x J or CN x J)</p>
</td></tr>
<tr><td><code id="Get_As_+3A_r0">r0</code></td>
<td>
<p>long-run interest rate  (scalar or vector with length C)</p>
</td></tr>
<tr><td><code id="Get_As_+3A_dt">dt</code></td>
<td>
<p>time interval unit of the model (scalar). For instance, if data is (i) monthly, dt &lt;- 12; (ii) quarterly, dt &lt;- 4; (iii) yearly, dt &lt;- 1</p>
</td></tr>
<tr><td><code id="Get_As_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Get_As_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Get_BFull'>Compute the B matrix of loadings</h2><span id='topic+Get_BFull'></span>

<h3>Description</h3>

<p>Compute the B matrix of loadings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_BFull(ModelParaPE, FactorLabels, mat, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_BFull_+3A_modelparape">ModelParaPE</code></td>
<td>
<p>list of point estimates of the model parameter</p>
</td></tr>
<tr><td><code id="Get_BFull_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Get_BFull_+3A_mat">mat</code></td>
<td>
<p>vector of bond yield maturities</p>
</td></tr>
<tr><td><code id="Get_BFull_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Get_BFull_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Get_Bs'>BUild the B loadings</h2><span id='topic+Get_Bs'></span>

<h3>Description</h3>

<p>BUild the B loadings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_Bs(mat, dt, K1XQ, SSZ, Wpca, FactorLabels, Economy, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_Bs_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) of yields used in estimation (J x 1)</p>
</td></tr>
<tr><td><code id="Get_Bs_+3A_dt">dt</code></td>
<td>
<p>time interval unit of the model (scalar). For instance, if data is (i) monthly, dt &lt;- 12; (ii) quarterly, dt &lt;- 4; (iii) yearly, dt &lt;- 1</p>
</td></tr>
<tr><td><code id="Get_Bs_+3A_k1xq">K1XQ</code></td>
<td>
<p>risk-neutral feedback matrix (N x N or CN x CN)</p>
</td></tr>
<tr><td><code id="Get_Bs_+3A_ssz">SSZ</code></td>
<td>
<p>variance-covariance matrix (F x F)</p>
</td></tr>
<tr><td><code id="Get_Bs_+3A_wpca">Wpca</code></td>
<td>
<p>matrix of weights of the portfolios observed without errors (N x J or CN x J)</p>
</td></tr>
<tr><td><code id="Get_Bs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Get_Bs_+3A_economy">Economy</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Get_Bs_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Get_G0G1Sigma'>Get the intercept, feedback matrix and the variance-covariance matrix from GVAR without global factors</h2><span id='topic+Get_G0G1Sigma'></span>

<h3>Description</h3>

<p>Get the intercept, feedback matrix and the variance-covariance matrix from GVAR without global factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_G0G1Sigma(ParaVARX, GVARinputs, Ai0, Ai1, Wi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_G0G1Sigma_+3A_paravarx">ParaVARX</code></td>
<td>
<p>Set of VARX model parameters</p>
</td></tr>
<tr><td><code id="Get_G0G1Sigma_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
<tr><td><code id="Get_G0G1Sigma_+3A_ai0">Ai0</code></td>
<td>
<p>list containing the country-specific intercepts</p>
</td></tr>
<tr><td><code id="Get_G0G1Sigma_+3A_ai1">Ai1</code></td>
<td>
<p>list containing the country-specific feedback matrices</p>
</td></tr>
<tr><td><code id="Get_G0G1Sigma_+3A_wi">Wi</code></td>
<td>
<p>list containing the country-specific link matrices</p>
</td></tr>
</table>

<hr>
<h2 id='Get_Gy1'>Compute the feedback matrix from a GVAR model with global factors</h2><span id='topic+Get_Gy1'></span>

<h3>Description</h3>

<p>Compute the feedback matrix from a GVAR model with global factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_Gy1(ParaVARX, GVARinputs, G1, Phi.w1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_Gy1_+3A_paravarx">ParaVARX</code></td>
<td>
<p>List containing the set of VARX model parameters</p>
</td></tr>
<tr><td><code id="Get_Gy1_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
<tr><td><code id="Get_Gy1_+3A_g1">G1</code></td>
<td>
<p>feedback matrix from a GVAR without global variables</p>
</td></tr>
<tr><td><code id="Get_Gy1_+3A_phi.w1">Phi.w1</code></td>
<td>
<p>feedback matrix from a marginal model</p>
</td></tr>
</table>

<hr>
<h2 id='Get_llk'>Compute the log-likelihood function</h2><span id='topic+Get_llk'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_llk(P, Y, Z, N, mat, We, Wpca, K0Z, K1Z, SSZ, LoadBs, LoadAs, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_llk_+3A_p">P</code></td>
<td>
<p>time-series of spanned factors (N x T or CN x T)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_y">Y</code></td>
<td>
<p>time-series of yields (J x T or CJ x T)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_z">Z</code></td>
<td>
<p>time-series of risk factors (F x T)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) of yields used in estimation (J x 1)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_we">We</code></td>
<td>
<p>matrix of weights of the portfolios observed with errors ((J-N) x J or C(J-N) x CJ)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_wpca">Wpca</code></td>
<td>
<p>matrix of weights of the portfolios observed without errors (N x J or CN x CJ)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_k0z">K0Z</code></td>
<td>
<p>matrix of intercepts (P-dynamics)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_k1z">K1Z</code></td>
<td>
<p>feedback matrix (P-dynamics)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_ssz">SSZ</code></td>
<td>
<p>variance-covariance matrix (P-dynamics)</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_loadbs">LoadBs</code></td>
<td>
<p>list containing the B loadings</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_loadas">LoadAs</code></td>
<td>
<p>list containing the A loadings</p>
</td></tr>
<tr><td><code id="Get_llk_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Get_r0'>Compute r0 for the various models</h2><span id='topic+Get_r0'></span>

<h3>Description</h3>

<p>Compute r0 for the various models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_r0(Y, P, N, mat, dt, B_list, Wpca, We, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_r0_+3A_y">Y</code></td>
<td>
<p>matrix of yields used in estimation  (J x T or CJ x T)</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_p">P</code></td>
<td>
<p>complete set of spanned factors (N x T or CN x T)</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) of yields used in estimation (J x 1)</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_dt">dt</code></td>
<td>
<p>time interval unit of the model (scalar). For instance, if data is (i) monthly, dt &lt;- 12; (ii) quarterly, dt &lt;- 4; (iii) yearly, dt &lt;- 1.</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_b_list">B_list</code></td>
<td>
<p>list containing the B loadings</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_wpca">Wpca</code></td>
<td>
<p>matrix of weights of the portfolios observed without errors (N x J or CN x J)</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_we">We</code></td>
<td>
<p>matrix of weights of the portfolios observed with errors ((J-N) x J or C(J-N) x CJ)</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Get_r0_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Get_Sigama_JLL'>Compute Sigmas/Cholesky factorizations</h2><span id='topic+Get_Sigama_JLL'></span>

<h3>Description</h3>

<p>Compute Sigmas/Cholesky factorizations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_Sigama_JLL(JLLinputs, FacSet, Para_Ortho_Reg, Para_Ortho_VAR, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_Sigama_JLL_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of necessary inputs to estimate JLL-based setups</p>
</td></tr>
<tr><td><code id="Get_Sigama_JLL_+3A_facset">FacSet</code></td>
<td>
<p>Set of factors used in the estimation of JLL-based setups</p>
</td></tr>
<tr><td><code id="Get_Sigama_JLL_+3A_para_ortho_reg">Para_Ortho_Reg</code></td>
<td>
<p>Set of parameters obtained from the JLL regressions</p>
</td></tr>
<tr><td><code id="Get_Sigama_JLL_+3A_para_ortho_var">Para_Ortho_VAR</code></td>
<td>
<p>Set of parameters obtained from the VAR(1) of JLL-based models</p>
</td></tr>
<tr><td><code id="Get_Sigama_JLL_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='Get_SigmaYields'>Compute the variance-covariance matrix of the bond yields</h2><span id='topic+Get_SigmaYields'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of the bond yields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_SigmaYields(YieldsTS, N, mat, WpcaFull, se, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_SigmaYields_+3A_yieldsts">YieldsTS</code></td>
<td>
<p>matrix of yields used in estimation  (J x T or CJ x T)</p>
</td></tr>
<tr><td><code id="Get_SigmaYields_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="Get_SigmaYields_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) of yields used in estimation (J x 1)</p>
</td></tr>
<tr><td><code id="Get_SigmaYields_+3A_wpcafull">WpcaFull</code></td>
<td>
<p>composite matrix of weights the portfolios observed with and without errors</p>
</td></tr>
<tr><td><code id="Get_SigmaYields_+3A_se">se</code></td>
<td>
<p>Variance of the portfolio of yields observed with error (scalar). Default is set to NULL</p>
</td></tr>
<tr><td><code id="Get_SigmaYields_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Get_Unspanned'>Collect both the domestic and global unspanned factors of all countries in single matrices</h2><span id='topic+Get_Unspanned'></span>

<h3>Description</h3>

<p>Collect both the domestic and global unspanned factors of all countries in single matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_Unspanned(ModelPara, FactorLabels, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_Unspanned_+3A_modelpara">ModelPara</code></td>
<td>
<p>List of model parameter estimates</p>
</td></tr>
<tr><td><code id="Get_Unspanned_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>a string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Get_Unspanned_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Get_Unspanned_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Get_V_tilde_BC'>Compute the variance-covariance matrix after the bias correction procedure</h2><span id='topic+Get_V_tilde_BC'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix after the bias correction procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_V_tilde_BC(
  Phi_tilde,
  N,
  RiskFactors,
  GVARinputs,
  JLLinputs,
  FactorLabels,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_V_tilde_BC_+3A_phi_tilde">Phi_tilde</code></td>
<td>
<p>Feedback matrix resulting from the bias-correction procedure</p>
</td></tr>
<tr><td><code id="Get_V_tilde_BC_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
<tr><td><code id="Get_V_tilde_BC_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of the risk factors (T x F)</p>
</td></tr>
<tr><td><code id="Get_V_tilde_BC_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>inputs used in the estimation of the GVAR-based models (see &quot;GVAR&quot; function). Default is set to NULL</p>
</td></tr>
<tr><td><code id="Get_V_tilde_BC_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>inputs used in the estimation of the JLL-based models (see &quot;JLL&quot; function). Default is set to NULL</p>
</td></tr>
<tr><td><code id="Get_V_tilde_BC_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="Get_V_tilde_BC_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='GetAuxPara'>Map constrained parameters b to unconstrained auxiliary parameters a.</h2><span id='topic+GetAuxPara'></span>

<h3>Description</h3>

<p>Map constrained parameters b to unconstrained auxiliary parameters a.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetAuxPara(
  ParaValue,
  Const_Type_Full,
  lb,
  ub,
  Economies,
  FactorLabels,
  JLLinputs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetAuxPara_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter</p>
</td></tr>
<tr><td><code id="GetAuxPara_+3A_const_type_full">Const_Type_Full</code></td>
<td>
<p>character-based vector that describes the constraints. Constraints are:
</p>

<ul>
<li><p> 'Jordan';
</p>
</li>
<li><p> 'Jordan; stationary'
</p>
</li>
<li><p> 'Jordan MultiCountry'
</p>
</li>
<li><p> 'Jordan MultiCountry; stationary'
</p>
</li>
<li><p> 'stationary'
</p>
</li>
<li><p> 'psd'
</p>
</li>
<li><p> 'BlockDiag'
</p>
</li>
<li><p> 'bounded'
</p>
</li>
<li><p> 'diag'
</p>
</li>
<li><p> 'JLLstructure'
</p>
</li></ul>
</td></tr>
<tr><td><code id="GetAuxPara_+3A_lb">lb</code></td>
<td>
<p>lower bounds (a scalar or a matrix) of ParaValue (for the bounded case).</p>
</td></tr>
<tr><td><code id="GetAuxPara_+3A_ub">ub</code></td>
<td>
<p>upper bounds (a scalar or a matrix) of ParaValue (for the bounded case).</p>
</td></tr>
<tr><td><code id="GetAuxPara_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="GetAuxPara_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="GetAuxPara_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models (see &quot;JLL&quot; function)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>unconstrained auxiliary matrix.
</p>


<h3>References</h3>

<p>This function is a modified and extended version of the &quot;true2aux&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Getdt'>Get delta t</h2><span id='topic+Getdt'></span>

<h3>Description</h3>

<p>Get delta t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Getdt(DataFrequency)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Getdt_+3A_datafrequency">DataFrequency</code></td>
<td>
<p>single element character-based vector. Available options are: &quot;Daily All Days&quot;, <br />
&quot;Daily Business Days&quot;, &quot;Weekly&quot;, &quot;Monthly&quot;,  &quot;Quarterly&quot;, &quot;Annually&quot;</p>
</td></tr>
</table>

<hr>
<h2 id='GetLabels_JLL'>Generate the variable labels of the JLL models</h2><span id='topic+GetLabels_JLL'></span>

<h3>Description</h3>

<p>Generate the variable labels of the JLL models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetLabels_JLL(NonOrthoFactors, JLLinputs, G)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetLabels_JLL_+3A_nonorthofactors">NonOrthoFactors</code></td>
<td>
<p>Risk factors before the orthogonalization (FxT)</p>
</td></tr>
<tr><td><code id="GetLabels_JLL_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of necessary inputs to estimate JLL-based setups</p>
</td></tr>
<tr><td><code id="GetLabels_JLL_+3A_g">G</code></td>
<td>
<p>number of global unspanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='GetLabels_sepQ'>Generate the factor labels for models estimated on a country-by-country bases</h2><span id='topic+GetLabels_sepQ'></span>

<h3>Description</h3>

<p>Generate the factor labels for models estimated on a country-by-country bases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetLabels_sepQ(Economy, ModelType, FactorLabels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetLabels_sepQ_+3A_economy">Economy</code></td>
<td>
<p>string containing the names of the economy to be estimated</p>
</td></tr>
<tr><td><code id="GetLabels_sepQ_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="GetLabels_sepQ_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>list containing the factor labels</p>
</td></tr>
</table>

<hr>
<h2 id='getpara'>Extract the parameter values from the parameter list set</h2><span id='topic+getpara'></span>

<h3>Description</h3>

<p>Extract the parameter values from the parameter list set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getpara(ListInputSet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getpara_+3A_listinputset">ListInputSet</code></td>
<td>
<p>All parameter features</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is modified version of the &quot;getpara&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='GetPdynPara'>Compute the parameters used in the P-dynamics of the model</h2><span id='topic+GetPdynPara'></span>

<h3>Description</h3>

<p>Compute the parameters used in the P-dynamics of the model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetPdynPara(
  RiskFactors,
  FactorLabels,
  Economies,
  ModelType,
  BRWinputs,
  GVARinputs,
  JLLinputs,
  CheckInputs = F
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetPdynPara_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of risk factors (F x T). Could be stored in a list depending on the model</p>
</td></tr>
<tr><td><code id="GetPdynPara_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="GetPdynPara_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="GetPdynPara_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="GetPdynPara_+3A_brwinputs">BRWinputs</code></td>
<td>
<p>list of necessary inputs for performing the bias-corrected estimation (see &quot;Bias_Correc_VAR&quot; function)</p>
</td></tr>
<tr><td><code id="GetPdynPara_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of GVAR-based models (see &quot;GVAR&quot; function)</p>
</td></tr>
<tr><td><code id="GetPdynPara_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models (see &quot;JLL&quot; function)</p>
</td></tr>
</table>

<hr>
<h2 id='GetPdynPara_BC'>Compute P-dynamics parameters using the bias correction method from BRW (2012)</h2><span id='topic+GetPdynPara_BC'></span>

<h3>Description</h3>

<p>Compute P-dynamics parameters using the bias correction method from BRW (2012)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetPdynPara_BC(
  ModelType,
  BRWinputs,
  RiskFactors,
  Economies,
  FactorLabels,
  GVARinputs,
  JLLinputs
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetPdynPara_BC_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="GetPdynPara_BC_+3A_brwinputs">BRWinputs</code></td>
<td>
<p>list of necessary inputs for performing the bias-corrected estimation (see &quot;Bias_Correc_VAR&quot; function)</p>
</td></tr>
<tr><td><code id="GetPdynPara_BC_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of risk factors (F x T). Could be stored in a list depending on the model</p>
</td></tr>
<tr><td><code id="GetPdynPara_BC_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="GetPdynPara_BC_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="GetPdynPara_BC_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of GVAR-based models (see &quot;GVAR&quot; function)</p>
</td></tr>
<tr><td><code id="GetPdynPara_BC_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models (see &quot;JLL&quot; function)</p>
</td></tr>
</table>

<hr>
<h2 id='GetPdynPara_NoBC'>Compute P-dynamics parameters without using the bias correction method from BRW (2012)</h2><span id='topic+GetPdynPara_NoBC'></span>

<h3>Description</h3>

<p>Compute P-dynamics parameters without using the bias correction method from BRW (2012)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetPdynPara_NoBC(
  ModelType,
  RiskFactors,
  Economies,
  N,
  GVARinputs,
  JLLinputs,
  CheckInpts = F
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetPdynPara_NoBC_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="GetPdynPara_NoBC_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of risk factors (F x T). Could be stored in a list depending on the model</p>
</td></tr>
<tr><td><code id="GetPdynPara_NoBC_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="GetPdynPara_NoBC_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="GetPdynPara_NoBC_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of GVAR-based models (see &quot;GVAR&quot; function)</p>
</td></tr>
<tr><td><code id="GetPdynPara_NoBC_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>list of necessary inputs for the estimation of JLL-based models (see &quot;JLL&quot; function)</p>
</td></tr>
</table>

<hr>
<h2 id='GetTruePara'>Map auxiliary (unconstrained) parameters a to constrained parameters b</h2><span id='topic+GetTruePara'></span>

<h3>Description</h3>

<p>Map auxiliary (unconstrained) parameters a to constrained parameters b
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetTruePara(
  ParaValue,
  Const_Type_Full,
  lb,
  ub,
  FactorLabels,
  Economies,
  JLLinputs = NULL,
  GVARinputs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetTruePara_+3A_paravalue">ParaValue</code></td>
<td>
<p>unconstrained auxiliary parameter</p>
</td></tr>
<tr><td><code id="GetTruePara_+3A_const_type_full">Const_Type_Full</code></td>
<td>
<p>One of the following options:
</p>

<ul>
<li><p> 'Jordan'
</p>
</li>
<li><p> 'Jordan; stationary'
</p>
</li>
<li><p> 'Jordan MultiCountry'
</p>
</li>
<li><p> 'Jordan MultiCountry; stationary'
</p>
</li>
<li><p> 'psd';
</p>
</li>
<li><p> 'BlockDiag'
</p>
</li>
<li><p> 'bounded'
</p>
</li>
<li><p> 'diag'
</p>
</li>
<li><p> 'JLLstructure'
</p>
</li></ul>
</td></tr>
<tr><td><code id="GetTruePara_+3A_lb">lb</code></td>
<td>
<p>lower bounds of b (if option 'bounded' is chosen)</p>
</td></tr>
<tr><td><code id="GetTruePara_+3A_ub">ub</code></td>
<td>
<p>upper bounds of b (if option 'bounded' is chosen)</p>
</td></tr>
<tr><td><code id="GetTruePara_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="GetTruePara_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="GetTruePara_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>Inputs used in the estimation of the JLL-based models</p>
</td></tr>
<tr><td><code id="GetTruePara_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>Inputs used in the estimation of the GVAR-based models</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is a modified and extended of the &quot;aux2true&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='GetYields_AllCountries'>Gather all country-specific yields in a single matrix of dimension CJ x T</h2><span id='topic+GetYields_AllCountries'></span>

<h3>Description</h3>

<p>Gather all country-specific yields in a single matrix of dimension CJ x T
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetYields_AllCountries(ModelPara, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetYields_AllCountries_+3A_modelpara">ModelPara</code></td>
<td>
<p>List of model parameter estimates</p>
</td></tr>
<tr><td><code id="GetYields_AllCountries_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="GetYields_AllCountries_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='GlobalMacro'>Data: Risk Factors - Candelon and Moura (2023)</h2><span id='topic+GlobalMacro'></span>

<h3>Description</h3>

<p>Risk factors data used in Candelon and Moura (2023)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_GlobalMacro_2023")
</code></pre>


<h3>Format</h3>

<p>matrix containing the  risk factors of the models
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (2023) &quot;Sovereign yield curves and the COVID-19 in emerging markets&quot;. (Economic Modelling)
</p>

<hr>
<h2 id='GlobalMacroVar'>Data: Risk Factors - Candelon and Moura (forthcoming, JFEC)</h2><span id='topic+GlobalMacroVar'></span>

<h3>Description</h3>

<p>Risk factors data used in Candelon and Moura (forthcoming, JFEC)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_GlobalMacroFactors")
</code></pre>


<h3>Format</h3>

<p>matrix containing the  risk factors of the models
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (Forthcoming) &quot;A Multicountry Model of the Term Structures of Interest Rates with a GVAR&quot;. (Journal of Financial Econometrics)
</p>

<hr>
<h2 id='GraphicalOutputs'>Generate the graphical outputs for the selected models (Point estimate)</h2><span id='topic+GraphicalOutputs'></span>

<h3>Description</h3>

<p>Generate the graphical outputs for the selected models (Point estimate)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GraphicalOutputs(
  ModelType,
  ModelPara,
  NumOut,
  InputsForOutputs,
  Economies,
  FactorLabels
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GraphicalOutputs_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="GraphicalOutputs_+3A_modelpara">ModelPara</code></td>
<td>
<p>List of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="GraphicalOutputs_+3A_numout">NumOut</code></td>
<td>
<p>list of computed outputs containing the model fit, IRFs, FEVDs, GIRFs, GFEVDs and Term Premia</p>
</td></tr>
<tr><td><code id="GraphicalOutputs_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction of the desired output</p>
</td></tr>
<tr><td><code id="GraphicalOutputs_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="GraphicalOutputs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
</table>

<hr>
<h2 id='GVAR'>Estimates a GVAR(1) and a VARX(1,1,1) models</h2><span id='topic+GVAR'></span>

<h3>Description</h3>

<p>Estimates a GVAR(1) and a VARX(1,1,1) models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GVAR(GVARinputs, N, CheckInputs = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GVAR_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>GVARinputs List. Inputs for GVAR model estimation:
</p>

<ol>
<li>  <p><code>Economies</code>:  A character vector containing the names of the economies included in the system.
</p>
</li>
<li>  <p><code>GVARFactors</code>: A list of all variables used in the estimation of the VARX model <br />
(see e.g. <code>CM_Factors_GVAR</code> file for details);
</p>
</li>
<li> <p><code>VARXtype</code>: A character vector with three possible options:
</p>

<ul>
<li> <p><code>'unconstrained'</code>: model is estimated without constraints (each equation is estimated individually by ordinary least square);
</p>
</li>
<li> <p><code>'constrained: Spanned Factors'</code>: The model is estimated with the restriction that foreign pricing factors do NOT
affect (i) domestic economic variables and (ii) domestic pricing factors. <br />
(Equations are estimated using restricted least squares)
</p>
</li>
<li> <p><code>'constrained : [factor_name]'</code>: The model is estimated with the restriction that the specified risk factor
is influenced only by its own lagged values and the lagged values of its corresponding star variables.
(Equations are estimated using restricted least squares.)
</p>
</li></ul>

</li>
<li> <p><code>Wgvar</code>: The GVAR transition matrix (C x C) used in the model solution. <br />
(See the output from the <code><a href="#topic+Transition_Matrix">Transition_Matrix</a></code> function.).
</p>
</li></ol>
</td></tr>
<tr><td><code id="GVAR_+3A_n">N</code></td>
<td>
<p>Integer. Number of country-specific spanned factors.</p>
</td></tr>
<tr><td><code id="GVAR_+3A_checkinputs">CheckInputs</code></td>
<td>
<p>A logical flag to indicate whether to perform a prior consistency check on the inputs provided in <code>GVARinputs</code>. The default is set to FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ol>
<li><p> parameters of the country-specific VARX(1,1,1)
</p>

<ul>
<li><p> intercept (M+Nx1);
</p>
</li>
<li><p> phi_1   (M+N x M+N);
</p>
</li>
<li><p> phi_1^star (M+N x M+N);
</p>
</li>
<li><p> phi_g (M+N x M+N);
</p>
</li>
<li><p> Sigma (M+N x G)
</p>
</li></ul>

</li>
<li><p> parameters of the GVAR.
</p>

<ul>
<li><p> F0 (F X 1);
</p>
</li>
<li><p> F1 (F x F);
</p>
</li>
<li><p> Sigma_y (F x F)
</p>
</li></ul>

</li></ol>



<h3>References</h3>

<p>Chudik and Pesaran, (2016). &quot;Theory and Practice of GVAR modelling&quot; (Journal of Economic Surveys)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CM_Factors_GVAR)

GVARinputs &lt;- list( Economies = c("China", "Brazil", "Mexico", "Uruguay"),
                    GVARFactors = FactorsGVAR, VARXtype = "unconstrained")

GVARinputs$Wgvar &lt;- matrix( c(0, 0.83, 0.86, 0.38,
                              0.65, 0, 0.13, 0.55,
                              0.32, 0.12, 0, 0.07,
                              0.03, 0.05, 0.01, 0), nrow = 4, ncol = 4)
N &lt;- 3

GVARPara &lt;- GVAR(GVARinputs, N)
</code></pre>

<hr>
<h2 id='GVAR_PrepFactors'>Prepare risk factors for the estimation of the GVAR model</h2><span id='topic+GVAR_PrepFactors'></span>

<h3>Description</h3>

<p>Prepare risk factors for the estimation of the GVAR model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GVAR_PrepFactors(GVARinputs, DomLabels, StarLabels, GlobalLabels, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GVAR_PrepFactors_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
<tr><td><code id="GVAR_PrepFactors_+3A_domlabels">DomLabels</code></td>
<td>
<p>string-based vector containing label of the domestic risk factors</p>
</td></tr>
<tr><td><code id="GVAR_PrepFactors_+3A_starlabels">StarLabels</code></td>
<td>
<p>string-based vector containing label of the star domestic risk factors</p>
</td></tr>
<tr><td><code id="GVAR_PrepFactors_+3A_globallabels">GlobalLabels</code></td>
<td>
<p>string-based vector containing label of the global risk factors</p>
</td></tr>
<tr><td><code id="GVAR_PrepFactors_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='Idx_UnspanFact'>Obtain the indexes of both the domestic and global unspanned factors</h2><span id='topic+Idx_UnspanFact'></span>

<h3>Description</h3>

<p>Obtain the indexes of both the domestic and global unspanned factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Idx_UnspanFact(RiskFactors_TS, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Idx_UnspanFact_+3A_riskfactors_ts">RiskFactors_TS</code></td>
<td>
<p>time series of risk factors for the jointly estimated models (CJ x T)</p>
</td></tr>
<tr><td><code id="Idx_UnspanFact_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>a string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Idx_UnspanFact_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='IdxAllSpanned'>Find the indexes of the spanned factors</h2><span id='topic+IdxAllSpanned'></span>

<h3>Description</h3>

<p>Find the indexes of the spanned factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IdxAllSpanned(ModelType, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IdxAllSpanned_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="IdxAllSpanned_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="IdxAllSpanned_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='IdxSpanned'>Extract the indexes related to the spanned factors in the variance-covariance matrix</h2><span id='topic+IdxSpanned'></span>

<h3>Description</h3>

<p>Extract the indexes related to the spanned factors in the variance-covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IdxSpanned(G, M, N, C)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IdxSpanned_+3A_g">G</code></td>
<td>
<p>number of global unspanned factors (scalar)</p>
</td></tr>
<tr><td><code id="IdxSpanned_+3A_m">M</code></td>
<td>
<p>number of domestic unspanned factors per country (scalar)</p>
</td></tr>
<tr><td><code id="IdxSpanned_+3A_n">N</code></td>
<td>
<p>number of domestic spanned factors per country (scalar)</p>
</td></tr>
<tr><td><code id="IdxSpanned_+3A_c">C</code></td>
<td>
<p>number of countries of the economic system (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='IDXZeroRestrictionsJLLVarCovOrtho'>Find the indexes of zero-restrictions from the orthogonalized variance-covariance matrix from the JLL-based models</h2><span id='topic+IDXZeroRestrictionsJLLVarCovOrtho'></span>

<h3>Description</h3>

<p>Find the indexes of zero-restrictions from the orthogonalized variance-covariance matrix from the JLL-based models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IDXZeroRestrictionsJLLVarCovOrtho(M, N, G, Economies, DomUnit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IDXZeroRestrictionsJLLVarCovOrtho_+3A_m">M</code></td>
<td>
<p>number of country-specific unspanned factors (scalar)</p>
</td></tr>
<tr><td><code id="IDXZeroRestrictionsJLLVarCovOrtho_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
<tr><td><code id="IDXZeroRestrictionsJLLVarCovOrtho_+3A_g">G</code></td>
<td>
<p>number of global unspanned factors (scalar)</p>
</td></tr>
<tr><td><code id="IDXZeroRestrictionsJLLVarCovOrtho_+3A_economies">Economies</code></td>
<td>
<p>Set of economies that are part of the economic system (string-vector)</p>
</td></tr>
<tr><td><code id="IDXZeroRestrictionsJLLVarCovOrtho_+3A_domunit">DomUnit</code></td>
<td>
<p>Name of the economy which is assigned as the dominant unit. <br />
If no dominant unit is assigned, then this variable is defined as &quot;None&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>restricted version of the JLL of the Cholesky factorization (F x F)
</p>

<hr>
<h2 id='ImposeStat_Aux'>Impose stationary constraint under the risk-neutral measure</h2><span id='topic+ImposeStat_Aux'></span>

<h3>Description</h3>

<p>Impose stationary constraint under the risk-neutral measure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ImposeStat_Aux(yy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ImposeStat_Aux_+3A_yy">yy</code></td>
<td>
<p>numerical vector before imposing stationary constraint</p>
</td></tr>
</table>

<hr>
<h2 id='ImposeStat_True'>Makes sure that the stationary constraint under the risk-neutral measure is preserved</h2><span id='topic+ImposeStat_True'></span>

<h3>Description</h3>

<p>Makes sure that the stationary constraint under the risk-neutral measure is preserved
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ImposeStat_True(x, K1Q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ImposeStat_True_+3A_x">x</code></td>
<td>
<p>parameter of interest (scalar or matrix)</p>
</td></tr>
<tr><td><code id="ImposeStat_True_+3A_k1q">K1Q</code></td>
<td>
<p>risk-neutral feedback matrix</p>
</td></tr>
</table>

<hr>
<h2 id='InputsForOpt'>Generates several  inputs that are necessary to build the likelihood function</h2><span id='topic+InputsForOpt'></span>

<h3>Description</h3>

<p>Generates several  inputs that are necessary to build the likelihood function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>InputsForOpt(
  InitialSampleDate,
  FinalSampleDate,
  ModelType,
  Yields,
  GlobalMacro,
  DomMacro,
  FactorLabels,
  Economies,
  DataFrequency,
  GVARlist = NULL,
  JLLlist = NULL,
  WishBRW = 0,
  BRWlist = NULL,
  UnitYields = "Month",
  CheckInputs = TRUE,
  BS_Adj = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="InputsForOpt_+3A_initialsampledate">InitialSampleDate</code></td>
<td>
<p>Start date of the sample period in the format &quot;dd-mm-yyyy&quot;</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_finalsampledate">FinalSampleDate</code></td>
<td>
<p>End date of the sample period in the format &quot;dd-mm-yyyy&quot;</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_yields">Yields</code></td>
<td>
<p>A numerical matrix with time series of yields (JxT or CJ x T)</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_globalmacro">GlobalMacro</code></td>
<td>
<p>A numerical matrix with time series of the global risk factors (G x T)</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_dommacro">DomMacro</code></td>
<td>
<p>A numerical matrix with time series of the country-specific risk factors for all C countries (CM x T)</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_datafrequency">DataFrequency</code></td>
<td>
<p>A character vector specifying the frequency of the data. Available options are:
&quot;Daily All Days&quot;, &quot;Daily Business Days&quot;, &quot;Weekly&quot;, &quot;Monthly&quot;, &quot;Quarterly&quot;, or &quot;Annually&quot;.</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_gvarlist">GVARlist</code></td>
<td>
<p>A list containing the necessary inputs for the estimation of GVAR-based models</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_jlllist">JLLlist</code></td>
<td>
<p>A list of necessary inputs for the estimation of JLL-based models. If the chosen model is &quot;JLL original&quot; or &quot;JLL joint Sigma&quot;, then a dominant unit economy must be chosen. Otherwise, this list must be set as 'None'.</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_wishbrw">WishBRW</code></td>
<td>
<p>Whether to estimate the physical parameter model with bias correction, based on the method by Bauer, Rudebusch and Wu (2012) (see <code><a href="#topic+Bias_Correc_VAR">Bias_Correc_VAR</a></code> function). Default is set to 0.</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_brwlist">BRWlist</code></td>
<td>
<p>List of necessary inputs for performing the bias-corrected estimation (see <code><a href="#topic+Bias_Correc_VAR">Bias_Correc_VAR</a></code> function).</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_unityields">UnitYields</code></td>
<td>
<p>A character string indicating the maturity unit of yields. Options are: (i) &quot;Month&quot; for yields expressed in months, or (ii) &quot;Year&quot; for yields expressed in years. Default is &quot;Month&quot;.</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_checkinputs">CheckInputs</code></td>
<td>
<p>A logical value indicating whether to perform a prior check on the consistency of the provided input list.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="InputsForOpt_+3A_bs_adj">BS_Adj</code></td>
<td>
<p>A logical value indicating whether to adjust the global series for the sepQ models in the Bootstrap setting.
Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of necessary inputs for performing the model optimization.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1:
data(CM_GlobalMacroFactors)
data(CM_DomMacroFactors)
data(CM_Yields)


ModelType &lt;- "JPS original"
Economies &lt;- "Mexico"
t0 &lt;- "01-05-2007" # Initial Sample Date (Format: "dd-mm-yyyy")
tF &lt;- "01-12-2018" # Final Sample Date (Format: "dd-mm-yyyy")
N &lt;- 3
GlobalVar &lt;- c("Gl_Eco_Act") # Global Variables
DomVar &lt;- c("Eco_Act") # Domestic Variables
FactorLabels &lt;- LabFac(N, DomVar, GlobalVar, Economies, ModelType)
DataFreq &lt;- "Monthly"

ATSMInputs &lt;- InputsForOpt(t0, tF, ModelType, Yields, GlobalMacroVar, DomesticMacroVar,
                             FactorLabels, Economies, DataFreq, CheckInputs = FALSE)
# Example 2:
LoadData("CM_2024")

ModelType &lt;- "GVAR multi"
Economies &lt;- c("China", "Brazil", "Mexico", "Uruguay")
t0 &lt;- "01-05-2007" # InitialSampleDate (Format: "dd-mm-yyyy")
tF &lt;- "01-12-2019" # FinalSampleDate (Format: "dd-mm-yyyy")#'
N &lt;- 2
GlobalVar &lt;- c("Gl_Eco_Act", "Gl_Inflation") # Global Variables
DomVar &lt;- c("Inflation") # Domestic Variables
FactorLabels &lt;- LabFac(N, DomVar,GlobalVar, Economies, ModelType)

DataFreq &lt;- "Monthly"
GVARlist &lt;- list(VARXtype = "unconstrained", W_type = "Sample Mean",
                 t_First_Wgvar = "2007", t_Last_Wgvar = "2019")
ATSMInputs &lt;- InputsForOpt(t0, tF, ModelType, Yields, GlobalMacroVar, DomesticMacroVar,
                           FactorLabels, Economies, DataFreq, GVARlist, CheckInputs = FALSE)

# Example 3:
if (requireNamespace('neldermead', quietly = TRUE)) {
LoadData("CM_2024")

ModelType &lt;- "JLL original"

Economies &lt;- c("China", "Brazil", "Uruguay")
t0 &lt;- "01-05-2007" # InitialSampleDate (Format: "dd-mm-yyyy")
tF &lt;- "01-12-2019" # FinalSampleDate (Format: "dd-mm-yyyy")#'
N &lt;- 2
GlobalVar &lt;- c("Gl_Eco_Act", "Gl_Inflation") # Global Variables
DomVar &lt;- c("Eco_Act", "Inflation") # Domestic Variables
FactorLabels &lt;- LabFac(N, DomVar,GlobalVar, Economies, ModelType)

JLLinputs &lt;- list(DomUnit = "China")

DataFrequency &lt;- "Monthly"

ATSMInputs &lt;- InputsForOpt(t0, tF, ModelType, Yields, GlobalMacroVar, DomesticMacroVar,
                           FactorLabels, Economies, DataFreq, JLLlist = JLLinputs,
                           CheckInputs = FALSE)
} else {
 message("skipping functionality due to missing Suggested dependency")
}



</code></pre>

<hr>
<h2 id='InputsForOutputs'>Collects the inputs that are used to construct the numerical and the graphical outputs</h2><span id='topic+InputsForOutputs'></span>

<h3>Description</h3>

<p>Collects the inputs that are used to construct the numerical and the graphical outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>InputsForOutputs(
  ModelType,
  Horiz,
  ListOutputWished,
  OutputLabel,
  WishStationarityQ,
  DataFrequency,
  WishGraphYields = 0,
  WishGraphRiskFactors = 0,
  WishOrthoJLLgraphs = 0,
  WishForwardPremia = 0,
  LimFP = NULL,
  WishBootstrap = 0,
  ListBoot = NULL,
  WishForecast = 0,
  ListForecast = NULL,
  UnitYields = "Month"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="InputsForOutputs_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_horiz">Horiz</code></td>
<td>
<p>A numeric scalar specifying the desired analysis horizon for the outputs.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_listoutputwished">ListOutputWished</code></td>
<td>
<p>A list of desired graphical outputs. Available options are: &quot;Fit&quot;, &quot;IRF&quot;, &quot;FEVD&quot;, &quot;GIRF&quot;, &quot;GFEVD&quot;, &quot;TermPremia&quot;.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_outputlabel">OutputLabel</code></td>
<td>
<p>A string for the name of the output label to be stored.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_wishstationarityq">WishStationarityQ</code></td>
<td>
<p>A binary variable (1 or 0) indicating whether to impose that the largest eigenvalue under Q is strictly
smaller than 1. Set to 1 to impose the restriction, or 0 otherwise.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_datafrequency">DataFrequency</code></td>
<td>
<p>A character vector specifying the data frequency. Available options: &quot;Daily All Days&quot;, &quot;Daily Business Days&quot;,
&quot;Weekly&quot;, &quot;Monthly&quot;, &quot;Quarterly&quot;, &quot;Annually&quot;.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_wishgraphyields">WishGraphYields</code></td>
<td>
<p>A binary variable (1 or 0) indicating whether the user wishes to generate graphs for yields. Default is 0.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_wishgraphriskfactors">WishGraphRiskFactors</code></td>
<td>
<p>A binary variable (1 or 0) indicating whether the user wishes to generate graphs for risk factors. Default is 0.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_wishorthojllgraphs">WishOrthoJLLgraphs</code></td>
<td>
<p>A binary variable (1 or 0) indicating whether the user wishes to generate orthogonalized JLL-based graphs.
Default is 0.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_wishforwardpremia">WishForwardPremia</code></td>
<td>
<p>A binary variable (1 or 0) indicating whether the user wishes to generate forward premia graphs. Default is 0.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_limfp">LimFP</code></td>
<td>
<p>A numeric vector containing the maturities associated with the start and end dates of the loan.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_wishbootstrap">WishBootstrap</code></td>
<td>
<p>A binary variable (1 or 0) indicating whether the user wishes to perform bootstrap-based estimation. Default is 0.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_listboot">ListBoot</code></td>
<td>
<p>A List containing the following four elements:
</p>

<ol>
<li> <p><code>methodBS</code>: Desired bootstrap method: (a) 'bs' for standard residual bootstrap, (b) 'wild' for wild bootstrap,
or (c) 'block' for block bootstrap.
</p>
</li>
<li> <p><code>BlockLength</code>: If block bootstrap is chosen, specify the block length (numeric scalar).
</p>
</li>
<li> <p><code>ndraws</code>: Number of bootstrap draws.
</p>
</li>
<li> <p><code>pctg</code>: Confidence level expressed in basis points (numeric vector).
</p>
</li></ol>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_wishforecast">WishForecast</code></td>
<td>
<p>A binary variable (1 or 0) indicating whether the user wishes to generate forecasts. Default is 0.</p>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_listforecast">ListForecast</code></td>
<td>
<p>A list containing the following three elements:
</p>

<ol>
<li> <p><code>ForHoriz</code>: forecast horizon;
</p>
</li>
<li> <p><code>t0Sample</code>: Index of the first variable in the information set.
</p>
</li>
<li> <p><code>t0Forecast</code>: Index of the first forecast cut-off date.
</p>
</li>
<li> <p><code>ForType</code>: A string specifying the desired forecast type. Available options are: &quot;Rolling&quot; or &quot;Expanding&quot;.
</p>
</li></ol>
</td></tr>
<tr><td><code id="InputsForOutputs_+3A_unityields">UnitYields</code></td>
<td>
<p>A character string indicating the maturity unit of yields. Options are: (i) &quot;Month&quot; for yields expressed in months, or (ii) &quot;Year&quot; for yields expressed in years. Default is &quot;Month&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of necessary inputs to generate the graphs of the outputs of the desired model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ModelType &lt;- "JPS original"
Horiz &lt;- 100
DesiredOutputGraphs &lt;- c("Fit", "GIRF", "GFEVD")
OutputLabel &lt;- "Test"
WishStationarityQ &lt;- 1
WishGraphRiskFac &lt;- 0
WishGraphYields &lt;- 1


InputsList &lt;- InputsForOutputs(ModelType, Horiz, DesiredOutputGraphs, OutputLabel,
                              WishStationarityQ, WishGraphYields, WishGraphRiskFac)
</code></pre>

<hr>
<h2 id='IRFandGIRF'>IRFs and GIRFs for all models</h2><span id='topic+IRFandGIRF'></span>

<h3>Description</h3>

<p>IRFs and GIRFs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRFandGIRF(ModelType, ModelPara, IRFhoriz, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IRFandGIRF_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="IRFandGIRF_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="IRFandGIRF_+3A_irfhoriz">IRFhoriz</code></td>
<td>
<p>single numerical vector containing the desired horizon of analysis for the IRFs</p>
</td></tr>
<tr><td><code id="IRFandGIRF_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="IRFandGIRF_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Structural shocks from the IRFs are identified via Cholesky decomposition
</p>

<hr>
<h2 id='IRFandGIRF_BS'>IRFs and GIRFs after bootstrap for all models</h2><span id='topic+IRFandGIRF_BS'></span>

<h3>Description</h3>

<p>IRFs and GIRFs after bootstrap for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRFandGIRF_BS(ModelType, ModelParaBoot, IRFhoriz, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IRFandGIRF_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="IRFandGIRF_BS_+3A_modelparaboot">ModelParaBoot</code></td>
<td>
<p>list of model parameter estimates (see the &quot;Optimization&quot; function) after a bootstrap draw</p>
</td></tr>
<tr><td><code id="IRFandGIRF_BS_+3A_irfhoriz">IRFhoriz</code></td>
<td>
<p>single numerical vector containing the desired horizon of analysis for the IRFs</p>
</td></tr>
<tr><td><code id="IRFandGIRF_BS_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="IRFandGIRF_BS_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='IRFandGIRFbs'>Creates the confidence bounds and the graphs of IRFs and GIRFs after bootstrap</h2><span id='topic+IRFandGIRFbs'></span>

<h3>Description</h3>

<p>Creates the confidence bounds and the graphs of IRFs and GIRFs after bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRFandGIRFbs(
  ModelType,
  ModelBootstrap,
  NumOutPE,
  InputsForOutputs,
  Economies,
  PathsGraphs
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IRFandGIRFbs_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="IRFandGIRFbs_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>list containing the complete set of model parameters after bootstrap estimation procedure</p>
</td></tr>
<tr><td><code id="IRFandGIRFbs_+3A_numoutpe">NumOutPE</code></td>
<td>
<p>list of model parameter point estimates</p>
</td></tr>
<tr><td><code id="IRFandGIRFbs_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction of the outputs of interest</p>
</td></tr>
<tr><td><code id="IRFandGIRFbs_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="IRFandGIRFbs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>path of the folder in which the graphs will be saved</p>
</td></tr>
</table>

<hr>
<h2 id='IRFandGIRFgraphs'>IRF and GIRF graphs for all models</h2><span id='topic+IRFandGIRFgraphs'></span>

<h3>Description</h3>

<p>IRF and GIRF graphs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRFandGIRFgraphs(
  ModelType,
  NumOut,
  WishPdynamicsgraphs,
  WishYieldsgraphs,
  IRFhoriz,
  PathsGraphs,
  OutputType,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IRFandGIRFgraphs_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="IRFandGIRFgraphs_+3A_numout">NumOut</code></td>
<td>
<p>list of computed outputs containing the model fit, IRFs, FEVDs, GIRFs, and GFEVDs</p>
</td></tr>
<tr><td><code id="IRFandGIRFgraphs_+3A_wishpdynamicsgraphs">WishPdynamicsgraphs</code></td>
<td>
<p>binary variable: set 1, if the user wishes graphs to be generated; or set 0, otherwise</p>
</td></tr>
<tr><td><code id="IRFandGIRFgraphs_+3A_wishyieldsgraphs">WishYieldsgraphs</code></td>
<td>
<p>binary variable: set 1, if the user wishes graphs to be generated; or set 0, otherwise</p>
</td></tr>
<tr><td><code id="IRFandGIRFgraphs_+3A_irfhoriz">IRFhoriz</code></td>
<td>
<p>single numerical vector containing the desired horizon of analysis for the IRFs</p>
</td></tr>
<tr><td><code id="IRFandGIRFgraphs_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>Path of the folder in which the graphs will be saved</p>
</td></tr>
<tr><td><code id="IRFandGIRFgraphs_+3A_outputtype">OutputType</code></td>
<td>
<p>Available options are 'IRF' and 'GIRF'</p>
</td></tr>
<tr><td><code id="IRFandGIRFgraphs_+3A_economies">Economies</code></td>
<td>
<p>a string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='IRFandGIRFs_Format_Fac'>Gather data for IRFs and GIRFs grahs (version &quot;Factors&quot;)</h2><span id='topic+IRFandGIRFs_Format_Fac'></span>

<h3>Description</h3>

<p>Gather data for IRFs and GIRFs grahs (version &quot;Factors&quot;)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRFandGIRFs_Format_Fac(IRFFac)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IRFandGIRFs_Format_Fac_+3A_irffac">IRFFac</code></td>
<td>
<p>Data-frame with basic features of a single IRF for risk factors</p>
</td></tr>
</table>

<hr>
<h2 id='IRFandGIRFs_Format_Yields'>Gather data for IRFs and GIRFs grahs (version &quot;Yields&quot;)</h2><span id='topic+IRFandGIRFs_Format_Yields'></span>

<h3>Description</h3>

<p>Gather data for IRFs and GIRFs grahs (version &quot;Yields&quot;)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRFandGIRFs_Format_Yields(IRFYields)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IRFandGIRFs_Format_Yields_+3A_irfyields">IRFYields</code></td>
<td>
<p>Data-frame with basic features of a single IRF for yields</p>
</td></tr>
</table>

<hr>
<h2 id='JLL'>Estimates the P-dynamics from JLL-based models</h2><span id='topic+JLL'></span>

<h3>Description</h3>

<p>Estimates the P-dynamics from JLL-based models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JLL(NonOrthoFactors, N, JLLinputs, CheckInputs = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="JLL_+3A_nonorthofactors">NonOrthoFactors</code></td>
<td>
<p>A numeric matrix (F x T) representing the time series of risk factors before the orthogonalization process.</p>
</td></tr>
<tr><td><code id="JLL_+3A_n">N</code></td>
<td>
<p>Integer. Number of country-specific spanned factors.</p>
</td></tr>
<tr><td><code id="JLL_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of necessary inputs to estimate JLL models:
</p>

<ol>
<li><p> Economies:  set of economies that are part of the economic system (string-vector)
</p>
</li>
<li> <p><code>DomUnit</code>: A string specifying the name of the economy assigned as the dominant unit. <br />
If no dominant unit is assigned, set this variable to &quot;None&quot;.
</p>
</li>
<li> <p><code>WishSigmas</code>: Set to &quot;1&quot; if the user wishes to estimate the variance-covariance matrices and Cholesky factorizations <br />
(this can take a long time). Set to &quot;0&quot; if not.
</p>
</li>
<li> <p><code>SigmaNonOrtho</code>: A NULL value or an F x F matrix from the non-orthogonalized dynamics.
</p>
</li>
<li> <p><code>JLLModelType</code>: A string specifying the type of JLL model. Available options are: &quot;JLL original&quot;, &quot;JLL joint Sigma&quot;, or &quot;JLL No DomUnit&quot;.
</p>
</li></ol>
</td></tr>
<tr><td><code id="JLL_+3A_checkinputs">CheckInputs</code></td>
<td>
<p>A logical flag to indicate whether to perform a prior consistency check on the inputs provided in <code>JLLinputs</code>. The default is set to FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of model parameters from both the orthogonalized and non-orthogonalized versions of the JLL's based models
</p>


<h3>References</h3>

<p>Jotiskhatira, Le and Lundblad (2015). &quot;Why do interest rates in different currencies co-move?&quot; (Journal of Financial Economics)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(CM_Factors)
RF_TS &lt;- RiskFactors
N &lt;- 3

JLLinputs &lt;- list(Economies = c("China", "Brazil", "Mexico", "Uruguay"), DomUnit = "China",
                  WishSigmas = 1, SigmaNonOrtho = NULL, JLLModelType = "JLL original")


JLLPara &lt;- JLL(RF_TS, N, JLLinputs)


</code></pre>

<hr>
<h2 id='Jordan_JLL'>Check for JLL models for Jordan restrictions (auxiliary form)</h2><span id='topic+Jordan_JLL'></span>

<h3>Description</h3>

<p>Check for JLL models for Jordan restrictions (auxiliary form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Jordan_JLL(ParaValue, C, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Jordan_JLL_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter value</p>
</td></tr>
<tr><td><code id="Jordan_JLL_+3A_c">C</code></td>
<td>
<p>number of countries of the economic system</p>
</td></tr>
<tr><td><code id="Jordan_JLL_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
</table>

<hr>
<h2 id='K1XQStationary'>Impose stationarity under the Q-measure</h2><span id='topic+K1XQStationary'></span>

<h3>Description</h3>

<p>Impose stationarity under the Q-measure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>K1XQStationary(StationaryEigenvalues)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="K1XQStationary_+3A_stationaryeigenvalues">StationaryEigenvalues</code></td>
<td>
<p>Binary variable: set &quot;1&quot; if the user wishes the largest eigenvalue
to be strictly smaller than 1. Set &quot;0&quot;, otherwise</p>
</td></tr>
</table>

<hr>
<h2 id='LabelsSpanned'>Generate the labels of the spanned factors</h2><span id='topic+LabelsSpanned'></span>

<h3>Description</h3>

<p>Generate the labels of the spanned factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LabelsSpanned(N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LabelsSpanned_+3A_n">N</code></td>
<td>
<p>number of spanned factors</p>
</td></tr>
</table>

<hr>
<h2 id='LabelsStar'>Generate the labels of the star variables</h2><span id='topic+LabelsStar'></span>

<h3>Description</h3>

<p>Generate the labels of the star variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LabelsStar(FactorLabels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LabelsStar_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>Factor labels</p>
</td></tr>
</table>

<hr>
<h2 id='LabFac'>Generates the labels factors</h2><span id='topic+LabFac'></span>

<h3>Description</h3>

<p>Generates the labels factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LabFac(N, DomVar, GlobalVar, Economies, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LabFac_+3A_n">N</code></td>
<td>
<p>Integer. Number of country-specific spanned factors.</p>
</td></tr>
<tr><td><code id="LabFac_+3A_domvar">DomVar</code></td>
<td>
<p>A character vector containing the names of the domestic variables.</p>
</td></tr>
<tr><td><code id="LabFac_+3A_globalvar">GlobalVar</code></td>
<td>
<p>A character vector containing the names of the global variables.</p>
</td></tr>
<tr><td><code id="LabFac_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="LabFac_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the risk factor labels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 2
DomVar &lt;- c("inflation", "Output gap")
GlobalVar &lt;- "Commodity Prices"
Economies &lt;- c("U.S.", "Canada", "Germany", "Japan")
ModelType &lt;- "JPS original"

VarLabels &lt;- LabFac(N, DomVar, GlobalVar, Economies, ModelType)


</code></pre>

<hr>
<h2 id='llk_JLL_Sigma'>Build the log-likelihood function of the P-dynamics from the JLL-based models</h2><span id='topic+llk_JLL_Sigma'></span>

<h3>Description</h3>

<p>Build the log-likelihood function of the P-dynamics from the JLL-based models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>llk_JLL_Sigma(VecPara, res, IdxNONzero, K)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="llk_JLL_Sigma_+3A_vecpara">VecPara</code></td>
<td>
<p>vector that contains all the non-zero entries of the lower-triangualar part of the Cholesky factorization</p>
</td></tr>
<tr><td><code id="llk_JLL_Sigma_+3A_res">res</code></td>
<td>
<p>residuals from the VAR of the JLL model (K x T)</p>
</td></tr>
<tr><td><code id="llk_JLL_Sigma_+3A_idxnonzero">IdxNONzero</code></td>
<td>
<p>vector that contains indexes of the matrix of the non-zero entries of the Cholesky factorization</p>
</td></tr>
<tr><td><code id="llk_JLL_Sigma_+3A_k">K</code></td>
<td>
<p>dimensions of the variance-covariance matrix (scalar)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log-likelihood function (scalar)
</p>

<hr>
<h2 id='LoadData'>Loads data sets from several papers</h2><span id='topic+LoadData'></span>

<h3>Description</h3>

<p>Loads data sets from several papers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LoadData(DataPaper)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LoadData_+3A_datapaper">DataPaper</code></td>
<td>
<p>Available options are <code>BR_2017</code> (Bauer and Rudebusch, 2017) , <code>CM_2023</code> (Candelon and Moura, 2023), <code>CM_2024</code> (Candelon and Moura, forthcoming)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Complete set of data from several papers.
</p>


<h3>References</h3>


<ol>
<li><p> Bauer and Rudebusch (2017). &quot;Resolving the Spanning Puzzle in Macro-Finance Term Structure Models&quot; (Review of Finance)
</p>
</li>
<li><p> Candelon and Moura (2023). &quot;Sovereign yield curves and the COVID-19 in emerging markets&quot; (Economic Modelling)
</p>
</li>
<li><p> Candelon and Moura (forthcoming). &quot;A Multicountry Model of the Term Structures of Interest Rates with a GVAR&quot; (Journal of Financial Econometrics)
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>#Example 1:
LoadData("BR_2017")

#Example 2:
LoadData("CM_2023")

#Example 3:
LoadData("CM_2024")


</code></pre>

<hr>
<h2 id='logdet'>computes the logarithm of determinant of a matrix A</h2><span id='topic+logdet'></span>

<h3>Description</h3>

<p>computes the logarithm of determinant of a matrix A
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logdet(A, opt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logdet_+3A_a">A</code></td>
<td>
<p>squared matrix</p>
</td></tr>
<tr><td><code id="logdet_+3A_opt">opt</code></td>
<td>
<p>&quot;chol&quot; or &quot;NULL&quot; (text)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Theoretically, this function should be functionally equivalent to log(det(A)). However, it avoids the
overflow/underflow problems that are likely to happen when applying det to large matrices.
The key idea is based on the mathematical fact that the determinant of a triangular matrix equals the
product of its diagonal elements. Hence, the matrix's log-determinant is equal to the sum of their logarithm
values. By keeping all computations in log-scale, the problem of underflow/overflow caused by product of
many numbers can be effectively circumvented. The implementation is based on LU factorization.
</p>


<h3>References</h3>

<p>This function is based on the &quot;logdet&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='m_var'>Find mean or median of OLS when DGP is VAR(1)</h2><span id='topic+m_var'></span>

<h3>Description</h3>

<p>Find mean or median of OLS when DGP is VAR(1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m_var(
  theta,
  M,
  RiskFactors,
  N,
  GVARinputs,
  JLLinputs,
  FactorLabels,
  Economies,
  ModelType,
  flag_mean = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="m_var_+3A_theta">theta</code></td>
<td>
<p>parameters from the feedback matrix in vector form</p>
</td></tr>
<tr><td><code id="m_var_+3A_m">M</code></td>
<td>
<p>number of Monte Carlo replications</p>
</td></tr>
<tr><td><code id="m_var_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of the risk factors (T x F)</p>
</td></tr>
<tr><td><code id="m_var_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
<tr><td><code id="m_var_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>inputs used in the estimation of the GVAR-based models (see &quot;GVAR&quot; function). Default is set to NULL</p>
</td></tr>
<tr><td><code id="m_var_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>inputs used in the estimation of the JLL-based models (see &quot;JLL&quot; function). Default is set to NULL</p>
</td></tr>
<tr><td><code id="m_var_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all variables present in the model</p>
</td></tr>
<tr><td><code id="m_var_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="m_var_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="m_var_+3A_flag_mean">flag_mean</code></td>
<td>
<p>flag whether mean- (TRUE) or median- (FALSE) unbiased estimation is desired. Default is set to TRUE</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bauer, Rudebusch and, Wu (2012). &quot;Correcting Estimation Bias in Dynamic Term Structure Models&quot;. <br />
This function is similar to the &quot;m_var&quot; Matlab function available at Cynthia Wu's website
(https://sites.google.com/view/jingcynthiawu/).
</p>

<hr>
<h2 id='MarginalModelPara'>Estimate the marginal model for the global factors</h2><span id='topic+MarginalModelPara'></span>

<h3>Description</h3>

<p>Estimate the marginal model for the global factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MarginalModelPara(GVARinputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MarginalModelPara_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
</table>

<hr>
<h2 id='MatAdjusted'>Adjust vector of maturities</h2><span id='topic+MatAdjusted'></span>

<h3>Description</h3>

<p>Adjust vector of maturities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MatAdjusted(mat, UnitYields)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MatAdjusted_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (J x 1)</p>
</td></tr>
<tr><td><code id="MatAdjusted_+3A_unityields">UnitYields</code></td>
<td>
<p>Available options: &quot;Month&quot; and &quot;Year&quot;</p>
</td></tr>
</table>

<hr>
<h2 id='Maturities'>Create a vector of numerical maturities in years</h2><span id='topic+Maturities'></span>

<h3>Description</h3>

<p>Create a vector of numerical maturities in years
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Maturities(DataYields, Economies, UnitYields)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Maturities_+3A_datayields">DataYields</code></td>
<td>
<p>matrix containing all yields of the system (JxT,if the model is single-country-based
or CJxT if the model is multy-country-based)</p>
</td></tr>
<tr><td><code id="Maturities_+3A_economies">Economies</code></td>
<td>
<p>vector containing names of all the economies of the system</p>
</td></tr>
<tr><td><code id="Maturities_+3A_unityields">UnitYields</code></td>
<td>
<p>(i) &quot;Month&quot;: if maturity of yields are expressed in months or
(ii) &quot;Year&quot;: if maturity of yields are expressed in years</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing all observed maturities expressed in years
</p>

<hr>
<h2 id='MLEdensity'>Compute the maximum likelihood function of all models</h2><span id='topic+MLEdensity'></span>

<h3>Description</h3>

<p>Compute the maximum likelihood function of all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLEdensity(
  K1XQ,
  r0,
  SSZ,
  K0Z,
  K1Z,
  se,
  Gy.0,
  mat,
  Y,
  Z,
  P,
  Wpca,
  We,
  WpcaFull,
  dt,
  Economies,
  FactorLabels,
  ModelType,
  GVARinputs = NULL,
  JLLinputs = NULL,
  BS_outputs = F,
  nargout
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLEdensity_+3A_k1xq">K1XQ</code></td>
<td>
<p>risk-neutral feedback matrix (N x N or CN x CN)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_r0">r0</code></td>
<td>
<p>long-run interest rate  (scalar or vector with length C)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_ssz">SSZ</code></td>
<td>
<p>variance-covariance matrix (F x F)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_k0z">K0Z</code></td>
<td>
<p>intercept from the P-dynamics (F x 1)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_k1z">K1Z</code></td>
<td>
<p>feedback matrix from the P-dynamics (F x F)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_se">se</code></td>
<td>
<p>Variance of the portfolio of yields observed with error (scalar). Default is set to NULL.</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_gy.0">Gy.0</code></td>
<td>
<p>matrix of contemporaneous terms from the P-dynamics (F x F)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) of yields used in estimation (J x 1)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_y">Y</code></td>
<td>
<p>matrix of yields used in estimation  (J x T or CJ x T)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_z">Z</code></td>
<td>
<p>complete set of spanned and unspanned factors (F x T)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_p">P</code></td>
<td>
<p>complete set of spanned factors (N x T or CN x T)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_wpca">Wpca</code></td>
<td>
<p>matrix of weights of the portfolios observed without errors (N x J or CN x J)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_we">We</code></td>
<td>
<p>matrix of weights of the portfolios observed with errors ((J-N) x J or C(J-N) x CJ)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_wpcafull">WpcaFull</code></td>
<td>
<p>composite matrix of weights the portfolios observed with and without errors</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_dt">dt</code></td>
<td>
<p>time interval unit of the model (scalar). For instance, if data is (i) monthly, dt &lt;- 12; (ii) quarterly, dt &lt;- 4; (iii) yearly, dt &lt;- 1.</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>if the model chosen is the &quot;GVAR single&quot; or &quot;GVAR multi&quot;, the &quot;GVARinputs&quot; should be specified (see &quot;GVAR&quot; function)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>if the model chosen is JLL-based. &quot;JLLinputs&quot; should contain (i) DomUnit, (ii) WishSigmas, (iii) SigmaNonOrtho, (iv) JLLModelType (See JLL function)</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_bs_outputs">BS_outputs</code></td>
<td>
<p>Generates simplified output list in the bootstrap setting. Default is set to FALSE.</p>
</td></tr>
<tr><td><code id="MLEdensity_+3A_nargout">nargout</code></td>
<td>
<p>if nargout== 1: provides only the values of the likelihood; if nargout== 2: complete ATSM outputs</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is modified version of the &quot;A0N_MLEdensity_WOE&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='ModelPara'>Replications of the JPS (2014) outputs by the MultiATSM package</h2><span id='topic+ModelPara'></span>

<h3>Description</h3>

<p>Unspanned macro risk model outputs by the MultiATSM package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("JPSrep")
</code></pre>


<h3>Format</h3>

<p>list of inputs and outputs
</p>

<dl>
<dt>inputs</dt><dd><p>general model inputs</p>
</dd>
<dt>ests</dt><dd><p>model parameters estimates (JPS form)</p>
</dd>
<dt>llk</dt><dd><p>log-likelihood of the observations</p>
</dd>
<dt>rot</dt><dd><p>model parameters estimates (rotation form)</p>
</dd>
</dl>


<hr>
<h2 id='mult__inv'>Inverts an array of matrices so that:  inva[,,i] = inv(a[,,i])</h2><span id='topic+mult__inv'></span>

<h3>Description</h3>

<p>Inverts an array of matrices so that:  inva[,,i] = inv(a[,,i])
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult__inv(a, whichoutput, nargout)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult__inv_+3A_a">a</code></td>
<td>
<p>matrix array (N x N x T)</p>
</td></tr>
<tr><td><code id="mult__inv_+3A_whichoutput">whichoutput</code></td>
<td>
<p>if = 'lobabsdet' computes the log(abs(det(a))) only (text).</p>
</td></tr>
<tr><td><code id="mult__inv_+3A_nargout">nargout</code></td>
<td>
<p>&quot;nargout == 1&quot; or &quot;nargout == 2&quot;(scalar)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>&quot;nargout == 1&quot; returns inva -&gt; matrix array: a^(-1) (N x N x T) <br />
&quot;nargout == 2&quot; returns inva -&gt; matrix array: a^(-1) (N x N x T) and  logabsdet -&gt;  vector of log(abs(det(a)))  (1 x T)
</p>


<h3>References</h3>

<p>This function is modified version of the &quot;mult__inv&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot;<br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='mult__prod'>Efficient computation of matrix product for arrays</h2><span id='topic+mult__prod'></span>

<h3>Description</h3>

<p>Efficient computation of matrix product for arrays
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult__prod(a, b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult__prod_+3A_a">a</code></td>
<td>
<p>array</p>
</td></tr>
<tr><td><code id="mult__prod_+3A_b">b</code></td>
<td>
<p>array</p>
</td></tr>
<tr><td><code id="mult__prod_+3A_c">c</code></td>
<td>
<p>array</p>
</td></tr>
</table>


<h3>Details</h3>

<p>#' Efficiently computes matrix product for arrays a and b and c:
d[,,i] = a[,,i] b[,,i] c[,,i].
(efficiently = without using an inefficient loop)
</p>


<h3>References</h3>

<p>This function is modified version of the &quot;mult__prod&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot;<br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='mult_inv_large'>Inverse each 2D slice of an array (M) with arbitrary dimensions support</h2><span id='topic+mult_inv_large'></span>

<h3>Description</h3>

<p>Inverse each 2D slice of an array (M) with arbitrary dimensions support
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult_inv_large(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult_inv_large_+3A_m">M</code></td>
<td>
<p>multi-dimension array</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inverse every 2D slice (the first two dimensions of M) for multi-dimension array M.
M[,,p,q,...] * X[,,p,q,...] &lt;- repmat(diag(m),[1,1,p,q,...])
</p>


<h3>Value</h3>

<p>n_D array (m x m x [p x q x  ...]), with same size as M
</p>


<h3>References</h3>

<p>This function is based on the &quot;mult_inv_large&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='mult_inv_small'>Inverse the (m,m,T) array of matrices for m&lt;=4</h2><span id='topic+mult_inv_small'></span>

<h3>Description</h3>

<p>Inverse the (m,m,T) array of matrices for m&lt;=4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult_inv_small(A)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult_inv_small_+3A_a">A</code></td>
<td>
<p>multi-dimensional array</p>
</td></tr>
</table>


<h3>Details</h3>

<p>equivalent to the following for loop:
</p>
<p><code> for (i in 1:T){ y[ , ,i] = inv(A[,,i]) } </code>
</p>


<h3>Value</h3>

<p>dd  vector of determinants (Tx1)
</p>


<h3>References</h3>

<p>This function is based on the &quot;mult_inv_small&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='mult_logabsdet'>Inverse each 2D slice of an array (M) with arbitrary dimensions support</h2><span id='topic+mult_logabsdet'></span>

<h3>Description</h3>

<p>Inverse each 2D slice of an array (M) with arbitrary dimensions support
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult_logabsdet(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mult_logabsdet_+3A_m">M</code></td>
<td>
<p>multi-dimensional array</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inverse every 2D slice (the first two dimensions of M) for multi-dimension array M. In Matlab language:
M[ , , p,q,...] * X[ , ,p,q,...] = repmat(diag(m),[1,1,p,q,...])
</p>


<h3>Value</h3>

<p>X  : (n-2)_D array ([p x q x  ...])
</p>


<h3>References</h3>

<p>This function is based on the &quot;mult_logabsdet&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='multiprod_2terms'>computes matrix product for arrays a and b:   c[,,i] = a[,,i] b[,,i]</h2><span id='topic+multiprod_2terms'></span>

<h3>Description</h3>

<p>computes matrix product for arrays a and b:   c[,,i] = a[,,i] b[,,i]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiprod_2terms(a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiprod_2terms_+3A_a">a</code></td>
<td>
<p>array (M x N x T)</p>
</td></tr>
<tr><td><code id="multiprod_2terms_+3A_b">b</code></td>
<td>
<p>array (N x K x T)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>c  array (M x K x T)
</p>


<h3>References</h3>

<p>This function is based on the &quot;multiprod_2terms&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='NoOrthoVAR_JLL'>Obtain the non-orthogonalized model parameters</h2><span id='topic+NoOrthoVAR_JLL'></span>

<h3>Description</h3>

<p>Obtain the non-orthogonalized model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NoOrthoVAR_JLL(Para_Ortho_Reg, Para_Ortho_VAR)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NoOrthoVAR_JLL_+3A_para_ortho_reg">Para_Ortho_Reg</code></td>
<td>
<p>Set of parameters obtained from the JLL regressions</p>
</td></tr>
<tr><td><code id="NoOrthoVAR_JLL_+3A_para_ortho_var">Para_Ortho_VAR</code></td>
<td>
<p>Set of parameters obtained from the VAR(1) of JLL-based models</p>
</td></tr>
</table>

<hr>
<h2 id='NumOutputs'>Constructs the model numerical outputs (model fit, IRFs, GIRFs, FEVDs, GFEVDs, and risk premia decomposition)</h2><span id='topic+NumOutputs'></span>

<h3>Description</h3>

<p>Constructs the model numerical outputs (model fit, IRFs, GIRFs, FEVDs, GFEVDs, and risk premia decomposition)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NumOutputs(ModelType, ModelPara, InputsForOutputs, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NumOutputs_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="NumOutputs_+3A_modelpara">ModelPara</code></td>
<td>
<p>A list containing the point estimates of the model parameters. For details, refer to the outputs from the <code><a href="#topic+Optimization">Optimization</a></code> function.</p>
</td></tr>
<tr><td><code id="NumOutputs_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>A list containing the necessary inputs for generating IRFs, GIRFs, FEVDs, GFEVDs and Term Premia.</p>
</td></tr>
<tr><td><code id="NumOutputs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="NumOutputs_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both IRFs and FEVDs are computed using the Cholesky decomposition method. The risk factors are ordered as follows: (i) global unspanned factors, and (ii) domestic unspanned and spanned factors for each country. The order of countries follows the sequence defined in the <code>Economies</code> vector.
</p>


<h3>Value</h3>

<p>List of the model numerical outputs, namely
</p>

<ol>
<li><p> Model fit of bond yields
</p>
</li>
<li><p> IRFs
</p>
</li>
<li><p> FEVDs
</p>
</li>
<li><p> GIRFs
</p>
</li>
<li><p> GFEVDs
</p>
</li>
<li><p> Bond yield decomposition
</p>
</li></ol>



<h3>References</h3>

<p>Pesaran, H. Hashem, and Shin, Yongcheol. &quot;Generalized impulse response analysis in linear multivariate models.&quot; Economics letters 58.1 (1998): 17-29.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See an example of implementation in the vignette file of this package (Section 4).


</code></pre>

<hr>
<h2 id='NumOutputs_Bootstrap'>Numerical outputs (IRFs, GIRFs, FEVD, and GFEVD) for bootstrap</h2><span id='topic+NumOutputs_Bootstrap'></span>

<h3>Description</h3>

<p>Numerical outputs (IRFs, GIRFs, FEVD, and GFEVD) for bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NumOutputs_Bootstrap(
  ModelType,
  ModelParaBoot,
  InputsForOutputs,
  FactorLabels,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NumOutputs_Bootstrap_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="NumOutputs_Bootstrap_+3A_modelparaboot">ModelParaBoot</code></td>
<td>
<p>A list of model parameter estimates (see the &quot;Optimization&quot; function) after a bootstrap draw</p>
</td></tr>
<tr><td><code id="NumOutputs_Bootstrap_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>A list containing the necessary inputs for generating IRFs, GIRFs, FEVDs, GFEVDs and Term Premia.</p>
</td></tr>
<tr><td><code id="NumOutputs_Bootstrap_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="NumOutputs_Bootstrap_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
</table>

<hr>
<h2 id='OOS_Forecast'>Perform out-of-sample forecast of bond yields</h2><span id='topic+OOS_Forecast'></span>

<h3>Description</h3>

<p>Perform out-of-sample forecast of bond yields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OOS_Forecast(
  ForHoriz,
  t_Last,
  ModelParaList,
  FactorLabels,
  Yields_FullSample,
  Economies,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OOS_Forecast_+3A_forhoriz">ForHoriz</code></td>
<td>
<p>forecast horizon-ahead (scalar)</p>
</td></tr>
<tr><td><code id="OOS_Forecast_+3A_t_last">t_Last</code></td>
<td>
<p>Index of the last set of observations in the information set at a given forecasting round</p>
</td></tr>
<tr><td><code id="OOS_Forecast_+3A_modelparalist">ModelParaList</code></td>
<td>
<p>List of model parameter estimates</p>
</td></tr>
<tr><td><code id="OOS_Forecast_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>a string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="OOS_Forecast_+3A_yields_fullsample">Yields_FullSample</code></td>
<td>
<p>Time-series of bond yields, complete set (J x T or CJ x T)</p>
</td></tr>
<tr><td><code id="OOS_Forecast_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="OOS_Forecast_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='Optimization'>Perform the optimization of the log-likelihood function of the chosen ATSM</h2><span id='topic+Optimization'></span>

<h3>Description</h3>

<p>Perform the optimization of the log-likelihood function of the chosen ATSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Optimization(
  MLEinputs,
  StatQ,
  DataFreq,
  FactorLabels,
  Economies,
  ModelType,
  tol = 1e-04,
  TimeCount = TRUE,
  BS_outputs = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Optimization_+3A_mleinputs">MLEinputs</code></td>
<td>
<p>A list containing the necessary inputs for building the log-likelihood function (see <code><a href="#topic+InputsForOpt">InputsForOpt</a></code> function).</p>
</td></tr>
<tr><td><code id="Optimization_+3A_statq">StatQ</code></td>
<td>
<p>A binary variable (1 or 0) indicating whether to impose that the largest eigenvalue under Q is strictly
smaller than 1. Set to 1 to impose the restriction, or 0 otherwise.</p>
</td></tr>
<tr><td><code id="Optimization_+3A_datafreq">DataFreq</code></td>
<td>
<p>A character vector specifying the data frequency. Available options: &quot;Daily All Days&quot;, &quot;Daily Business Days&quot;,
&quot;Weekly&quot;, &quot;Monthly&quot;, &quot;Quarterly&quot;, &quot;Annually&quot;.</p>
</td></tr>
<tr><td><code id="Optimization_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="Optimization_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="Optimization_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="Optimization_+3A_tol">tol</code></td>
<td>
<p>Convergence tolerance (scalar). The default is 1e-4.</p>
</td></tr>
<tr><td><code id="Optimization_+3A_timecount">TimeCount</code></td>
<td>
<p>Logical. If TRUE, computes the time required for model estimation. Default is TRUE.</p>
</td></tr>
<tr><td><code id="Optimization_+3A_bs_outputs">BS_outputs</code></td>
<td>
<p>Logical. If TRUE, generates a simplified output list in the bootstrap setting. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An extensive list containing model outputs after the optimization of the chosen ATSM specification.
</p>


<h3>References</h3>

<p>This function is partially adapted from the <code>LS__opt</code> function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in the vignette file of this package (Section 4).

</code></pre>

<hr>
<h2 id='Optimization_PE'>Peform the minimization of mean(f)</h2><span id='topic+Optimization_PE'></span>

<h3>Description</h3>

<p>Peform the minimization of mean(f)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Optimization_PE(
  f,
  ListInputSet,
  FactorLabels,
  Economies,
  ModelType,
  JLLinputs = NULL,
  GVARinputs = NULL,
  tol = 1e-04,
  TimeCount = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Optimization_PE_+3A_f">f</code></td>
<td>
<p>vector-valued objective function (function)</p>
</td></tr>
<tr><td><code id="Optimization_PE_+3A_listinputset">ListInputSet</code></td>
<td>
<p>list contain starting values and constraints:
for each input argument K (of f), we need four inputs that look like:
</p>

<ol>
<li><p> a starting value: K0
</p>
</li>
<li><p> a variable label ('K0') followed by a ':' followed by a type of constraint. The constraint can be:
</p>

<ul>
<li><p> 'bounded': bounded matrix;
</p>
</li>
<li><p> 'Jordan' or 'Jordan MultiCountry': a matrix of Jordan type;
</p>
</li>
<li><p> 'psd': psd matrix;
</p>
</li>
<li><p> 'stationary': largest eigenvalue of the risk-neutral feedback matrix is strictly smaller than 1;
</p>
</li>
<li><p> 'diag' or 'BlockDiag': a diagonal or block diagonal matrix.
</p>
</li>
<li><p> 'JLLstructure': to impose the zero-restrictions on the variance-variance matrix along
the lines of the JLL models
</p>
</li></ul>

</li>
<li><p> a lower bound lb (lb &lt;- NULL -&gt; no lower bound)
</p>
</li>
<li><p> an upper bound ub (ub &lt;- NULL -&gt; no upper bound)
</p>
</li>
<li><p> Specification of the optimization settings:
</p>

<ul>
<li><p> 'iter off': hide the printouts of the numerical optimization routines;
</p>
</li>
<li><p> 'fminunc only': only uses fminunc for the optimization;
</p>
</li>
<li><p> &rdquo;fminsearch only': only uses fminsearch for the optimization.
</p>
</li></ul>

</li></ol>
</td></tr>
<tr><td><code id="Optimization_PE_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="Optimization_PE_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="Optimization_PE_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated.</p>
</td></tr>
<tr><td><code id="Optimization_PE_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List. Inputs for JLL model estimation (see <code>JLL</code>). Default is NULL.</p>
</td></tr>
<tr><td><code id="Optimization_PE_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List. Inputs for GVAR model estimation (see <code>GVAR</code>). Default is NULL.</p>
</td></tr>
<tr><td><code id="Optimization_PE_+3A_tol">tol</code></td>
<td>
<p>convergence tolerance (scalar). Default value is 1e-4.</p>
</td></tr>
<tr><td><code id="Optimization_PE_+3A_timecount">TimeCount</code></td>
<td>
<p>computes the required time for estimation of the model. Default is TRUE.</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is a conceptually based on the &quot;LS__opt&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' # See an example of implementation in the vignette file of this package (Section 4).


</code></pre>

<hr>
<h2 id='OptimizationSetup_ATSM'>Optimization routine for the entire selected ATSM</h2><span id='topic+OptimizationSetup_ATSM'></span>

<h3>Description</h3>

<p>Optimization routine for the entire selected ATSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OptimizationSetup_ATSM(AuxVecSet, FFvec, EstType, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OptimizationSetup_ATSM_+3A_auxvecset">AuxVecSet</code></td>
<td>
<p>List containing features for estimation of the risk-neutral parameters.</p>
</td></tr>
<tr><td><code id="OptimizationSetup_ATSM_+3A_ffvec">FFvec</code></td>
<td>
<p>Log-likelihood function</p>
</td></tr>
<tr><td><code id="OptimizationSetup_ATSM_+3A_esttype">EstType</code></td>
<td>
<p>Estimation type</p>
</td></tr>
<tr><td><code id="OptimizationSetup_ATSM_+3A_tol">tol</code></td>
<td>
<p>convergence tolerance (scalar). Default value is set as 1e-4.</p>
</td></tr>
</table>

<hr>
<h2 id='OptOutputs'>Prepare outputs to export after the model optimization</h2><span id='topic+OptOutputs'></span>

<h3>Description</h3>

<p>Prepare outputs to export after the model optimization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OptOutputs(
  Y,
  Z,
  mat,
  N,
  dt,
  Wpca,
  K1XQ,
  SSZ,
  LoadAs,
  LoadBs,
  r0,
  se,
  K0Z,
  K1Z,
  Gy.0,
  VarYields,
  y,
  GVARinputs,
  JLLinputs,
  Economies,
  ModelType,
  BS_out = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OptOutputs_+3A_y">Y</code></td>
<td>
<p>matrix of yields used in estimation  (J x T or CJ x T)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_z">Z</code></td>
<td>
<p>complete set of spanned and unspanned factors (F x T)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) of yields used in estimation (J x 1)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_dt">dt</code></td>
<td>
<p>time interval unit of the model (scalar)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_wpca">Wpca</code></td>
<td>
<p>matrix of weights of the portfolios observed without errors (N x J or CN x J)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_k1xq">K1XQ</code></td>
<td>
<p>risk-neutral feedback matrix (N x N or CN x CN)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_ssz">SSZ</code></td>
<td>
<p>variance-covariance matrix (F x F)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_loadas">LoadAs</code></td>
<td>
<p>list containing the A loadings</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_loadbs">LoadBs</code></td>
<td>
<p>list containing the B loadings</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_r0">r0</code></td>
<td>
<p>long-run interest rate  (scalar or vector with length C)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_se">se</code></td>
<td>
<p>Variance of the portfolio of yields observed with error (scalar).</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_k0z">K0Z</code></td>
<td>
<p>intercept from the P-dynamics (F x 1)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_k1z">K1Z</code></td>
<td>
<p>feedback matrix from the P-dynamics (F x F)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_gy.0">Gy.0</code></td>
<td>
<p>matrix of contemporaneous terms from the P-dynamics (F x F)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_varyields">VarYields</code></td>
<td>
<p>variance-covariance matrix of the bond yields</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_y">y</code></td>
<td>
<p>likelihood of each time series (Tx1)</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs from GVAR models</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of inputs from JLL models</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_economies">Economies</code></td>
<td>
<p>string containing the names of the economy to be estimated</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="OptOutputs_+3A_bs_out">BS_out</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='OrthoReg_JLL'>Get coefficients from the orthogonalized regressions</h2><span id='topic+OrthoReg_JLL'></span>

<h3>Description</h3>

<p>Get coefficients from the orthogonalized regressions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OrthoReg_JLL(JLLinputs, FacSet, FactorLab_NonOrth, FactorLab_JLL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OrthoReg_JLL_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of necessary inputs to estimate JLL-based setups</p>
</td></tr>
<tr><td><code id="OrthoReg_JLL_+3A_facset">FacSet</code></td>
<td>
<p>Set of factors used in the estimation of JLL-based setups</p>
</td></tr>
<tr><td><code id="OrthoReg_JLL_+3A_factorlab_nonorth">FactorLab_NonOrth</code></td>
<td>
<p>Variable labels of the non-orthogonalized risk factors</p>
</td></tr>
<tr><td><code id="OrthoReg_JLL_+3A_factorlab_jll">FactorLab_JLL</code></td>
<td>
<p>Variable labels of the orthogonalized risk factors</p>
</td></tr>
</table>

<hr>
<h2 id='OrthoVAR_JLL'>VAR(1) with orthogonalized factors (JLL models)</h2><span id='topic+OrthoVAR_JLL'></span>

<h3>Description</h3>

<p>VAR(1) with orthogonalized factors (JLL models)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OrthoVAR_JLL(NonOrthoFactors, JLLinputs, Ortho_Set, FactLabels, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OrthoVAR_JLL_+3A_nonorthofactors">NonOrthoFactors</code></td>
<td>
<p>Risk factors before the orthogonalization (FxT)</p>
</td></tr>
<tr><td><code id="OrthoVAR_JLL_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of necessary inputs to estimate JLL-based setups</p>
</td></tr>
<tr><td><code id="OrthoVAR_JLL_+3A_ortho_set">Ortho_Set</code></td>
<td>
<p>Set of orthogonalized risk factors</p>
</td></tr>
<tr><td><code id="OrthoVAR_JLL_+3A_factlabels">FactLabels</code></td>
<td>
<p>Variable labels of the orthogonalized risk factors</p>
</td></tr>
<tr><td><code id="OrthoVAR_JLL_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='OutputConstruction'>Numerical outputs (variance explained, model fit, IRFs, GIRFs, FEVDs, GFEVDs, and risk premia decomposition)
for all models</h2><span id='topic+OutputConstruction'></span>

<h3>Description</h3>

<p>Numerical outputs (variance explained, model fit, IRFs, GIRFs, FEVDs, GFEVDs, and risk premia decomposition)
for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OutputConstruction(
  ModelType,
  ModelPara,
  InputsForOutputs,
  FactorLabels,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OutputConstruction_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="OutputConstruction_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="OutputConstruction_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list conataining the desired horizon of analysis for the model fit, IRFs, GIRFs, FEVDs, GFEVDs,
and risk premia decomposition</p>
</td></tr>
<tr><td><code id="OutputConstruction_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="OutputConstruction_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='Outputs2exportMLE'>Prepares inputs to export</h2><span id='topic+Outputs2exportMLE'></span>

<h3>Description</h3>

<p>Prepares inputs to export
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Outputs2exportMLE(
  Label_Multi_Models,
  Economies,
  RiskFactors,
  Yields,
  mat,
  ModelInputsGen,
  ModelInputsSpec,
  PdynPara,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Outputs2exportMLE_+3A_label_multi_models">Label_Multi_Models</code></td>
<td>
<p>string-vector containing the names of the multicountry setups</p>
</td></tr>
<tr><td><code id="Outputs2exportMLE_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Outputs2exportMLE_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of risk factors (F x T). Could be stored in a list depending on the model</p>
</td></tr>
<tr><td><code id="Outputs2exportMLE_+3A_yields">Yields</code></td>
<td>
<p>matrix (CJ x T) or a list containing those matrices, where C is the number of countries,
J - the number of maturities and T - time series length <br /></p>
</td></tr>
<tr><td><code id="Outputs2exportMLE_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) used in the estimation</p>
</td></tr>
<tr><td><code id="Outputs2exportMLE_+3A_modelinputsgen">ModelInputsGen</code></td>
<td>
<p>List of generic inputs</p>
</td></tr>
<tr><td><code id="Outputs2exportMLE_+3A_modelinputsspec">ModelInputsSpec</code></td>
<td>
<p>List of specific inputs</p>
</td></tr>
<tr><td><code id="Outputs2exportMLE_+3A_pdynpara">PdynPara</code></td>
<td>
<p>Model parameters estimated in the P-dynamics the</p>
</td></tr>
<tr><td><code id="Outputs2exportMLE_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='ParaATSM_opt_ALL'>Update the list of parameters</h2><span id='topic+ParaATSM_opt_ALL'></span>

<h3>Description</h3>

<p>Update the list of parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParaATSM_opt_ALL(Update_Temp, FF_opt, AuxVecSet_opt, ParaLabels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ParaATSM_opt_ALL_+3A_update_temp">Update_Temp</code></td>
<td>
<p>List of model parameter features updated</p>
</td></tr>
<tr><td><code id="ParaATSM_opt_ALL_+3A_ff_opt">FF_opt</code></td>
<td>
<p>llk after optimization</p>
</td></tr>
<tr><td><code id="ParaATSM_opt_ALL_+3A_auxvecset_opt">AuxVecSet_opt</code></td>
<td>
<p>List containing features for estimation of several parameters after optimization</p>
</td></tr>
<tr><td><code id="ParaATSM_opt_ALL_+3A_paralabels">ParaLabels</code></td>
<td>
<p>Several variable labels</p>
</td></tr>
</table>

<hr>
<h2 id='ParaLabelsOpt'>Create the variable labels used in the estimation</h2><span id='topic+ParaLabelsOpt'></span>

<h3>Description</h3>

<p>Create the variable labels used in the estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParaLabelsOpt(ModelType, WishStationarityQ, MLEinputs, BS_outputs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ParaLabelsOpt_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="ParaLabelsOpt_+3A_wishstationarityq">WishStationarityQ</code></td>
<td>
<p>User must set &quot;1&quot; is she whises to impose the largest eigenvalue under the Q to be strictly
smaller than 1. Otherwise set &quot;0&quot;</p>
</td></tr>
<tr><td><code id="ParaLabelsOpt_+3A_mleinputs">MLEinputs</code></td>
<td>
<p>Set of inputs that are necessary to the log-likelihood function</p>
</td></tr>
<tr><td><code id="ParaLabelsOpt_+3A_bs_outputs">BS_outputs</code></td>
<td>
<p>Generates simplified output list in the bootstrap setting. Default is set to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing starting values and constraints:
for each input argument K (of f), we need four inputs that look like:
</p>

<ol>
<li><p> a starting value: K0
</p>
</li>
<li><p> a variable label ('K0') followed by a ':' followed by a type of constraint. The constraint can be:
</p>

<ul>
<li><p> 'bounded': bounded matrix;
</p>
</li>
<li><p> 'Jordan' or 'Jordan MultiCountry': a matrix of Jordan type;
</p>
</li>
<li><p> 'psd': psd matrix;
</p>
</li>
<li><p> 'stationary': largest eigenvalue of the risk-neutral feedback matrix is strictly smaller than 1;
</p>
</li>
<li><p> 'diag' or 'BlockDiag': a diagonal or block diagonal matrix.
</p>
</li>
<li><p> 'JLLstructure': to impose the zero-restrictions on the variance-voriance matrix along
the lines of the JLL models
</p>
</li></ul>

</li>
<li><p> a lower bound lb (lb &lt;- NULL -&gt; no lower bound)
</p>
</li>
<li><p> an upper bound ub (ub &lt;- NULL -&gt; no upper bound)
</p>
</li>
<li><p> Specification of the optimization settings:
</p>

<ul>
<li><p> 'iter off': hide the printouts of the numerical optimization routines;
</p>
</li>
<li><p> 'fminunc only': only uses fminunc for the optimization;
</p>
</li>
<li><p> &rdquo;fminsearch only': only uses fminsearch for the optimization.
</p>
</li></ul>

</li></ol>


<hr>
<h2 id='pca_weights_one_country'>Weight matrix from principal components</h2><span id='topic+pca_weights_one_country'></span>

<h3>Description</h3>

<p>Weight matrix from principal components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca_weights_one_country(Y, Economy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pca_weights_one_country_+3A_y">Y</code></td>
<td>
<p>A numeric matrix (T x J) representing the time series of bond yields of a specific country</p>
</td></tr>
<tr><td><code id="pca_weights_one_country_+3A_economy">Economy</code></td>
<td>
<p>String-vector containing the name of a single economy.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix (J x J) that corresponds to the eigenvectors of the variance-covariance matrix of yields
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CM_Yields")
pca_weights_one_country(Yields, Economy= "Brazil")
</code></pre>

<hr>
<h2 id='PdynResid_BS'>Compute some key parameters from the P-dynamics (Bootstrap set)</h2><span id='topic+PdynResid_BS'></span>

<h3>Description</h3>

<p>Compute some key parameters from the P-dynamics (Bootstrap set)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PdynResid_BS(ModelType, Economies, ModelPara_PE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PdynResid_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="PdynResid_BS_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="PdynResid_BS_+3A_modelpara_pe">ModelPara_PE</code></td>
<td>
<p>point estimate from the model parameters</p>
</td></tr>
</table>

<hr>
<h2 id='pos2x'>Transform a positive number y to back to x by:</h2><span id='topic+pos2x'></span>

<h3>Description</h3>

<p>Transform a positive number y to back to x by:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pos2x(y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pos2x_+3A_y">y</code></td>
<td>
<p>scalar</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is based on the &quot;pos2x&quot; function by Le and Singleton (2018).<br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Reg__OLSconstrained'>Restricted OLS regression</h2><span id='topic+Reg__OLSconstrained'></span>

<h3>Description</h3>

<p>Restricted OLS regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Reg__OLSconstrained(Y, X, Bcon, G)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Reg__OLSconstrained_+3A_y">Y</code></td>
<td>
<p>left hand side variables (M x T)</p>
</td></tr>
<tr><td><code id="Reg__OLSconstrained_+3A_x">X</code></td>
<td>
<p>regressors (i.e. N-1 variables + the intercept) (N x T)</p>
</td></tr>
<tr><td><code id="Reg__OLSconstrained_+3A_bcon">Bcon</code></td>
<td>
<p>constraints matrix (M x N). If Bcon(i,j) = nan &ndash;&gt; B(i,j) is a free parameter</p>
</td></tr>
<tr><td><code id="Reg__OLSconstrained_+3A_g">G</code></td>
<td>
<p>weighting matrix (psd) - (M x M). Default is set to be identity</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Estimate of B is obtained by minimizing the objective:<br />
sum_t (Y_t-B X_t)' G^(-1) (Y_t-B*X_t) <br />
subject to the constraint that B = Bcon for all non-nan entries of Bcon
</p>


<h3>Value</h3>

<p>matrix of coefficient (M x N)
</p>


<h3>References</h3>

<p>This function is based on the &quot;Reg__OLSconstrained&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Reg_K1Q'>Estimate the risk-neutral feedbak matrix K1Q using linear regressions</h2><span id='topic+Reg_K1Q'></span>

<h3>Description</h3>

<p>Estimate the risk-neutral feedbak matrix K1Q using linear regressions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Reg_K1Q(Y, mat, Z, dt, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Reg_K1Q_+3A_y">Y</code></td>
<td>
<p>matrix of yields used in estimation  (J x T)</p>
</td></tr>
<tr><td><code id="Reg_K1Q_+3A_mat">mat</code></td>
<td>
<p>vector of maturities (in years) of yields used in estimation (J x 1)</p>
</td></tr>
<tr><td><code id="Reg_K1Q_+3A_z">Z</code></td>
<td>
<p>pricing factors (can be yields-based or non-yields/macro variables) (N x T)</p>
</td></tr>
<tr><td><code id="Reg_K1Q_+3A_dt">dt</code></td>
<td>
<p>time unit of the model (scalar). For instance, if data is (i) monthly, dt &lt;- 12; (ii) quarterly, dt &lt;- 4; (iii) yearly, dt &lt;- 1.</p>
</td></tr>
<tr><td><code id="Reg_K1Q_+3A_type">type</code></td>
<td>
<p>'Jordan' -&gt; K1Q will be of the Jordan type <br /></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Risk neutral feedback matrix K1Q.
</p>


<h3>References</h3>

<p>This function is modified version of the &quot;Reg_K1Q&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Remove_at'>Eliminates the @</h2><span id='topic+Remove_at'></span>

<h3>Description</h3>

<p>Eliminates the @
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Remove_at(s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Remove_at_+3A_s">s</code></td>
<td>
<p>text vector containing the feature of the variable</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is a modified version of the &quot;killa&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
</p>

<hr>
<h2 id='RemoveNA'>Exclude series that contain NAs</h2><span id='topic+RemoveNA'></span>

<h3>Description</h3>

<p>Exclude series that contain NAs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RemoveNA(YieldsData, MacroData, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RemoveNA_+3A_yieldsdata">YieldsData</code></td>
<td>
<p>List of country-specific bond yields</p>
</td></tr>
<tr><td><code id="RemoveNA_+3A_macrodata">MacroData</code></td>
<td>
<p>List of country-specific and global economic variables</p>
</td></tr>
<tr><td><code id="RemoveNA_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return the time series data that were not initially composed by NAs.
</p>

<hr>
<h2 id='ResampleResiduals_BS'>Compute the residuals from the original model</h2><span id='topic+ResampleResiduals_BS'></span>

<h3>Description</h3>

<p>Compute the residuals from the original model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ResampleResiduals_BS(
  residPdynOriginal,
  residYieOriginal,
  InputsForOutputs,
  ModelType,
  nlag = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ResampleResiduals_BS_+3A_residpdynoriginal">residPdynOriginal</code></td>
<td>
<p>Time-series of the residuals from the P-dynamics equation (T x F)</p>
</td></tr>
<tr><td><code id="ResampleResiduals_BS_+3A_residyieoriginal">residYieOriginal</code></td>
<td>
<p>Time-series of the residuals from the observational equation (T x J or T x CJ)</p>
</td></tr>
<tr><td><code id="ResampleResiduals_BS_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction of the numerical outputs.</p>
</td></tr>
<tr><td><code id="ResampleResiduals_BS_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated</p>
</td></tr>
<tr><td><code id="ResampleResiduals_BS_+3A_nlag">nlag</code></td>
<td>
<p>Number of lags in the P-dynamics. Default is set to 1.</p>
</td></tr>
</table>

<hr>
<h2 id='residY_original'>Compute the residuals from the observational equation</h2><span id='topic+residY_original'></span>

<h3>Description</h3>

<p>Compute the residuals from the observational equation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>residY_original(ModelParaPE, BFull, ModelType, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residY_original_+3A_modelparape">ModelParaPE</code></td>
<td>
<p>list of point estimates of the model parameter</p>
</td></tr>
<tr><td><code id="residY_original_+3A_bfull">BFull</code></td>
<td>
<p>matrix B of loadings (CJ x F or J x F)</p>
</td></tr>
<tr><td><code id="residY_original_+3A_modeltype">ModelType</code></td>
<td>
<p>A character vector indicating the model type to be estimated</p>
</td></tr>
<tr><td><code id="residY_original_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='rhoParas'>Compute  risk-neutral intercept and slope</h2><span id='topic+rhoParas'></span>

<h3>Description</h3>

<p>Compute  risk-neutral intercept and slope
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rhoParas(ModelPara, N, ModelType, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rhoParas_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates</p>
</td></tr>
<tr><td><code id="rhoParas_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="rhoParas_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="rhoParas_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='RiskFactors'>Data: Risk Factors - Candelon and Moura (forthcoming, JFEC)</h2><span id='topic+RiskFactors'></span>

<h3>Description</h3>

<p>Risk factors data used in Candelon and Moura (forthcoming, JFEC)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_Factors")
</code></pre>


<h3>Format</h3>

<p>matrix containing the  risk factors of the models
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (Forthcoming) &quot;A Multicountry Model of the Term Structures of Interest Rates with a GVAR&quot;. (Journal of Financial Econometrics)
</p>

<hr>
<h2 id='RiskFactorsGraphs'>Spanned and unspanned factors plot</h2><span id='topic+RiskFactorsGraphs'></span>

<h3>Description</h3>

<p>Spanned and unspanned factors plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RiskFactorsGraphs(ModelType, ModelOutputs, Economies, FactorLabels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RiskFactorsGraphs_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="RiskFactorsGraphs_+3A_modeloutputs">ModelOutputs</code></td>
<td>
<p>list of model parameter estimates (see the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="RiskFactorsGraphs_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="RiskFactorsGraphs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
</table>

<hr>
<h2 id='RiskFactorsPrep'>Builds the complete set of time series of the risk factors (spanned and unspanned)</h2><span id='topic+RiskFactorsPrep'></span>

<h3>Description</h3>

<p>Builds the complete set of time series of the risk factors (spanned and unspanned)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RiskFactorsPrep(
  FactorSet,
  Economies,
  FactorLabels,
  Initial_Date,
  Final_Date,
  DataFrequency
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RiskFactorsPrep_+3A_factorset">FactorSet</code></td>
<td>
<p>Factor set list (see e.g. &quot;CM_Factors_GVAR&quot; data file)</p>
</td></tr>
<tr><td><code id="RiskFactorsPrep_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="RiskFactorsPrep_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>A list of character vectors with labels for all variables in the model.</p>
</td></tr>
<tr><td><code id="RiskFactorsPrep_+3A_initial_date">Initial_Date</code></td>
<td>
<p>Start date of the sample period in the format yyyy-mm-dd</p>
</td></tr>
<tr><td><code id="RiskFactorsPrep_+3A_final_date">Final_Date</code></td>
<td>
<p>End date of the sample period in the format yyyy-mm-dd</p>
</td></tr>
<tr><td><code id="RiskFactorsPrep_+3A_datafrequency">DataFrequency</code></td>
<td>
<p>A character vector specifying the data frequency. Available options: &quot;Daily All Days&quot;, &quot;Daily Business Days&quot;,
&quot;Weekly&quot;, &quot;Monthly&quot;, &quot;Quarterly&quot;, &quot;Annually&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Risk factors used in the estimation of the desired ATSM
</p>

<hr>
<h2 id='RMSEjoint'>Compute the root mean square error (&quot;joint Q&quot; models)</h2><span id='topic+RMSEjoint'></span>

<h3>Description</h3>

<p>Compute the root mean square error (&quot;joint Q&quot; models)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RMSEjoint(ForecastOutputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RMSEjoint_+3A_forecastoutputs">ForecastOutputs</code></td>
<td>
<p>List of country-specific forecasts</p>
</td></tr>
</table>

<hr>
<h2 id='RMSEsep'>Compute the root mean square error (&quot;sep Q&quot; models)</h2><span id='topic+RMSEsep'></span>

<h3>Description</h3>

<p>Compute the root mean square error (&quot;sep Q&quot; models)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RMSEsep(ForecastOutputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RMSEsep_+3A_forecastoutputs">ForecastOutputs</code></td>
<td>
<p>List of country-specific forecasts (see &quot;ForecastYieldsSepQ&quot; function)</p>
</td></tr>
</table>

<hr>
<h2 id='shrink_Phi'>Killan's VAR stationarity adjustment</h2><span id='topic+shrink_Phi'></span>

<h3>Description</h3>

<p>Killan's VAR stationarity adjustment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shrink_Phi(Phi_tilde, Phi_hat, ev_restr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shrink_Phi_+3A_phi_tilde">Phi_tilde</code></td>
<td>
<p>VAR (1) bias-corrected feedback matrix from Bauer, Rudebusch and, Wu (2012)</p>
</td></tr>
<tr><td><code id="shrink_Phi_+3A_phi_hat">Phi_hat</code></td>
<td>
<p>unrestricted VAR(1) feedback matrix</p>
</td></tr>
<tr><td><code id="shrink_Phi_+3A_ev_restr">ev_restr</code></td>
<td>
<p>maximum eigenvalue desired in the feedback matrix after the adjustement</p>
</td></tr>
</table>


<h3>Value</h3>

<p>stationary VAR(1)
</p>


<h3>References</h3>

<p>Bauer, Rudebusch and, Wu (2012). &quot;Correcting Estimation Bias in Dynamic Term Structure Models&quot;. <br />
This function is an adapted version of the&quot;shrink_Phi&quot; Matlab function available at Cynthia Wu's website
(https://sites.google.com/view/jingcynthiawu/).
</p>

<hr>
<h2 id='Spanned_Factors'>Computes the country-specific spanned factors</h2><span id='topic+Spanned_Factors'></span>

<h3>Description</h3>

<p>Computes the country-specific spanned factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Spanned_Factors(Yields, Economies, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Spanned_Factors_+3A_yields">Yields</code></td>
<td>
<p>matrix  (J x T), where J is the number of maturities and T is the length of the time series.</p>
</td></tr>
<tr><td><code id="Spanned_Factors_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="Spanned_Factors_+3A_n">N</code></td>
<td>
<p>Scalar representing the desired number of country-specific spanned factors (maximum allowed is N = J).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix containing the N spanned for all the countries of the system  (CJ xT)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CM_Yields)
Economies &lt;- c("China", "Brazil", "Mexico", "Uruguay")
N &lt;- 3
SpaFact_TS &lt;- Spanned_Factors(Yields, Economies, N)

</code></pre>

<hr>
<h2 id='SpannedFactorsjointQ'>Gather all spanned factors (&quot;joint Q&quot; models)</h2><span id='topic+SpannedFactorsjointQ'></span>

<h3>Description</h3>

<p>Gather all spanned factors (&quot;joint Q&quot; models)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpannedFactorsjointQ(ModelType, ModelPara, Economies, t0Sample, tlastObserved)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpannedFactorsjointQ_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="SpannedFactorsjointQ_+3A_modelpara">ModelPara</code></td>
<td>
<p>set of model parameters</p>
</td></tr>
<tr><td><code id="SpannedFactorsjointQ_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="SpannedFactorsjointQ_+3A_t0sample">t0Sample</code></td>
<td>
<p>index for the initial sample date</p>
</td></tr>
<tr><td><code id="SpannedFactorsjointQ_+3A_tlastobserved">tlastObserved</code></td>
<td>
<p>index for the last observation of the information set</p>
</td></tr>
</table>

<hr>
<h2 id='SpannedFactorsSepQ'>Gather all spanned factors (&quot;sep Q&quot; models)</h2><span id='topic+SpannedFactorsSepQ'></span>

<h3>Description</h3>

<p>Gather all spanned factors (&quot;sep Q&quot; models)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpannedFactorsSepQ(ModelType, ModelPara, Economies, t0Sample, tlastObserved)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpannedFactorsSepQ_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="SpannedFactorsSepQ_+3A_modelpara">ModelPara</code></td>
<td>
<p>set of model parameters</p>
</td></tr>
<tr><td><code id="SpannedFactorsSepQ_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="SpannedFactorsSepQ_+3A_t0sample">t0Sample</code></td>
<td>
<p>index for the initial sample date</p>
</td></tr>
<tr><td><code id="SpannedFactorsSepQ_+3A_tlastobserved">tlastObserved</code></td>
<td>
<p>index for the last observation of the information set</p>
</td></tr>
</table>

<hr>
<h2 id='SpecificMLEInputs'>Concatenate the model-specific inputs in a list</h2><span id='topic+SpecificMLEInputs'></span>

<h3>Description</h3>

<p>Concatenate the model-specific inputs in a list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpecificMLEInputs(
  ModelType,
  Economies,
  RiskFactors,
  FactorLabels,
  GVARlist = NULL,
  JLLlist = NULL,
  WishBRW = 0,
  BRWlist = NULL,
  DataPathTrade = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpecificMLEInputs_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="SpecificMLEInputs_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies of the system</p>
</td></tr>
<tr><td><code id="SpecificMLEInputs_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of risk factors (F x T)</p>
</td></tr>
<tr><td><code id="SpecificMLEInputs_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="SpecificMLEInputs_+3A_gvarlist">GVARlist</code></td>
<td>
<p>A list of required inputs to estimate the GVAR-based setups:
</p>

<ol>
<li><p> VARXtype  string-vector containing the VARX feature (see &quot;GVAR&quot; function) (GVAR-based models)
</p>
</li>
<li><p> t_First_Wgvar Sample starting date (year) (GVAR-based models)
</p>
</li>
<li><p> t_Last_Wgvar  Sample last date (year) (GVAR-based models)
</p>
</li>
<li><p> W_type  Criterion used in the computation of the star variables (see &quot;Transition_Matrix&quot; function)
(GVAR-based models)
</p>
</li></ol>
</td></tr>
<tr><td><code id="SpecificMLEInputs_+3A_jlllist">JLLlist</code></td>
<td>
<p>A list of required inputs to estimate the JLL-based setups:
</p>

<ol>
<li><p> DomUnit name of the economy which is assigned as the dominant unit (JLL-based models)
</p>
</li>
<li><p> WishSigmas equal to &quot;1&quot; if one wishes the variance-covariance matrices and the Cholesky factorizations (JLL-based models)
</p>
</li>
<li><p> SigmaNonOrtho NULL or some F x F matrix from the non-orthogonalized dynamics (JLL-based models)
</p>
</li></ol>
</td></tr>
<tr><td><code id="SpecificMLEInputs_+3A_wishbrw">WishBRW</code></td>
<td>
<p>Whether the user wishes to estimate the physical parameter model with the Bias correction model from BRW (2012) (see &quot;Bias_Correc_VAR&quot; function).<br />
Default is set to 0.</p>
</td></tr>
<tr><td><code id="SpecificMLEInputs_+3A_brwlist">BRWlist</code></td>
<td>
<p>A list of required inputs to estimate the bias corrected setups of the type of BRW:
</p>

<ol>
<li><p> BiasCorrection binary variable. it takes value equal to 1 if the user whishes the estimates to be bias-corrected
and 0, otherwise. (BRW model)
</p>
</li>
<li><p> flag_mean flag whether mean- (TRUE) or median- (FALSE) unbiased estimation is desired
</p>
</li>
<li><p> gamma adjustment parameter (BRW model)
</p>
</li>
<li><p> N_iter number of iterations (BRW model)
</p>
</li>
<li><p> N_burn number of burn-in iterations (BRW model)
</p>
</li>
<li><p> B  number of bootstrap samples (BRW model)
</p>
</li>
<li><p> checkBRW flag whether the user wishes to perform the closeness check (BRW model)
</p>
</li>
<li><p> B_check number of bootstrap samples for closeness check
</p>
</li></ol>
</td></tr>
<tr><td><code id="SpecificMLEInputs_+3A_datapathtrade">DataPathTrade</code></td>
<td>
<p>path of the Excel file containing the data (if any)</p>
</td></tr>
</table>

<hr>
<h2 id='sqrtm_robust'>Compute the square root of a matrix</h2><span id='topic+sqrtm_robust'></span>

<h3>Description</h3>

<p>Compute the square root of a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqrtm_robust(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqrtm_robust_+3A_m">m</code></td>
<td>
<p>squared matrix (KxK)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>squred matrix x (KxK) such that x
</p>


<h3>References</h3>

<p>#' This function is a modified version of the &quot;sqrtm_robust&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='StarFactors'>Generates the star variables necessary for the GVAR estimation</h2><span id='topic+StarFactors'></span>

<h3>Description</h3>

<p>Generates the star variables necessary for the GVAR estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StarFactors(RiskFactors, Economies, W)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="StarFactors_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>time series of the risk factors (F x T)</p>
</td></tr>
<tr><td><code id="StarFactors_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="StarFactors_+3A_w">W</code></td>
<td>
<p>GVAR transition matrix (C x C)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containg the star factors of each country of the economic system
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CM_Factors)
Economies &lt;- c("China", "Brazil", "Mexico", "Uruguay")
Wgvar &lt;- matrix( c(0, 0.83, 0.86, 0.38, 0.65, 0, 0.13, 0.55,
         0.32, 0.12, 0, 0.07, 0.03, 0.05, 0.01, 0), nrow = 4, ncol = 4,
         dimnames = list(Economies, Economies))
SF &lt;- StarFactors(RiskFactors, Economies, Wgvar)

</code></pre>

<hr>
<h2 id='TermPremia'>Compute the term premia</h2><span id='topic+TermPremia'></span>

<h3>Description</h3>

<p>Compute the term premia
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TermPremia(ModelPara, avexp, ModelType, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TermPremia_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates</p>
</td></tr>
<tr><td><code id="TermPremia_+3A_avexp">avexp</code></td>
<td>
<p>list containing the country-specific pure expected component</p>
</td></tr>
<tr><td><code id="TermPremia_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="TermPremia_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='TermPremiaDecomp'>Decomposition of yields into the average of expected future short-term interest rate and risk premia for all models</h2><span id='topic+TermPremiaDecomp'></span>

<h3>Description</h3>

<p>Decomposition of yields into the average of expected future short-term interest rate and risk premia for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TermPremiaDecomp(
  ModelPara,
  FactorLabels,
  ModelType,
  InputsForOutputs,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TermPremiaDecomp_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates (see the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="TermPremiaDecomp_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="TermPremiaDecomp_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="TermPremiaDecomp_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired horizon of analysis for the model fit, IRFs, GIRFs, FEVDs, GFEVDs,
and risk premia decomposition</p>
</td></tr>
<tr><td><code id="TermPremiaDecomp_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='TPDecompGraph'>Term Premia decomposition graphs for all models</h2><span id='topic+TPDecompGraph'></span>

<h3>Description</h3>

<p>Term Premia decomposition graphs for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TPDecompGraph(
  ModelType,
  NumOut,
  ModelPara,
  WishRPgraphs,
  UnitYields,
  Economies,
  PathsGraphs
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TPDecompGraph_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="TPDecompGraph_+3A_numout">NumOut</code></td>
<td>
<p>list of computed outputs containing the model fit, IRFs, FEVDs, GIRFs, GFEVDs and Risk premia</p>
</td></tr>
<tr><td><code id="TPDecompGraph_+3A_modelpara">ModelPara</code></td>
<td>
<p>list of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="TPDecompGraph_+3A_wishrpgraphs">WishRPgraphs</code></td>
<td>
<p>binary variable: set 1, if the user wishes graphs to be generated; or set 0, otherwise</p>
</td></tr>
<tr><td><code id="TPDecompGraph_+3A_unityields">UnitYields</code></td>
<td>
<p>(i) &quot;Month&quot;: if maturity of yields are expressed in months or
(ii) &quot;Year&quot;: if maturity of yields are expressed in years</p>
</td></tr>
<tr><td><code id="TPDecompGraph_+3A_economies">Economies</code></td>
<td>
<p>a string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="TPDecompGraph_+3A_pathsgraphs">PathsGraphs</code></td>
<td>
<p>Path of the folder in which the graphs will be saved</p>
</td></tr>
</table>

<hr>
<h2 id='Trade_Flows'>Data: Trade Flows - Candelon and Moura (2023)</h2><span id='topic+Trade_Flows'></span>

<h3>Description</h3>

<p>Trade Flows data used in Candelon and Moura (2023)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_Trade")
</code></pre>


<h3>Format</h3>

<p>list containing the bilateral trade flows
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (2023) &quot;Sovereign yield curves and the COVID-19 in emerging markets&quot;. (Economic Modelling)
</p>

<hr>
<h2 id='TradeFlows'>Data: Trade Flows - Candelon and Moura (forthcoming, JFEC)</h2><span id='topic+TradeFlows'></span>

<h3>Description</h3>

<p>Trade Flows data used in Candelon and Moura (forthcoming, JFEC)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_Trade")
</code></pre>


<h3>Format</h3>

<p>list containing the bilateral trade flows
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (Forthcoming) &quot;A Multicountry Model of the Term Structures of Interest Rates with a GVAR&quot;. (Journal of Financial Econometrics)
</p>

<hr>
<h2 id='Transition_Matrix'>Computes the transition matrix required in the estimation of the GVAR model</h2><span id='topic+Transition_Matrix'></span>

<h3>Description</h3>

<p>Computes the transition matrix required in the estimation of the GVAR model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Transition_Matrix(
  t_First,
  t_Last,
  Economies,
  type,
  DataConnectedness = NULL,
  DataPath = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Transition_Matrix_+3A_t_first">t_First</code></td>
<td>
<p>Sample starting date (in the format: yyyy).</p>
</td></tr>
<tr><td><code id="Transition_Matrix_+3A_t_last">t_Last</code></td>
<td>
<p>Sample ending date (in the format: yyyy).</p>
</td></tr>
<tr><td><code id="Transition_Matrix_+3A_economies">Economies</code></td>
<td>
<p>A character vector containing the names of the economies included in the system.</p>
</td></tr>
<tr><td><code id="Transition_Matrix_+3A_type">type</code></td>
<td>
<p>A character string indicating the method for computing interdependence. Possible options include:
</p>

<ul>
<li> <p><code>Time-varying</code>: Computes time-varying interdependence and returns the weight matrices for each year based on available data (may extrapolate the sample period).
</p>
</li>
<li> <p><code>Sample Mean</code>: Returns a single weight matrix containing the average weights over the entire sample period, suitable for time-invariant interdependence.
</p>
</li>
<li><p> A specific year (e.g., &quot;1998&quot;, &quot;2005&quot;): Used to compute time-invariant interdependence for the specified year.
</p>
</li></ul>
</td></tr>
<tr><td><code id="Transition_Matrix_+3A_dataconnectedness">DataConnectedness</code></td>
<td>
<p>Data used to compute the transition matrix. Default is set to NULL.</p>
</td></tr>
<tr><td><code id="Transition_Matrix_+3A_datapath">DataPath</code></td>
<td>
<p>Path to the Excel file containing the data (if applicable). The default is linked to the Excel file available in the package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there is missing data for any country of the system for that particularly year,
then the transition matrix will include only NAs.
</p>


<h3>Value</h3>

<p>matrix or list of matrices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CM_Trade)

t_First &lt;- "2006"
t_Last &lt;-  "2019"
Economies &lt;- c("China", "Brazil", "Mexico", "Uruguay")
type &lt;- "Sample Mean"
W_mat &lt;- Transition_Matrix(t_First, t_Last, Economies, type, DataConnectedness = TradeFlows)


</code></pre>

<hr>
<h2 id='True_BlockDiag'>Transformation of the block diagonal parameters (true form)</h2><span id='topic+True_BlockDiag'></span>

<h3>Description</h3>

<p>Transformation of the block diagonal parameters (true form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>True_BlockDiag(ParaValue, Const_Type, FactorLabels, Economies, GVARinputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="True_BlockDiag_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter</p>
</td></tr>
<tr><td><code id="True_BlockDiag_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
<tr><td><code id="True_BlockDiag_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="True_BlockDiag_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="True_BlockDiag_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>Inputs used in the estimation of the GVAR-based models</p>
</td></tr>
</table>

<hr>
<h2 id='True_BoundDiag'>Transformation of the bounded parameters (True form)</h2><span id='topic+True_BoundDiag'></span>

<h3>Description</h3>

<p>Transformation of the bounded parameters (True form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>True_BoundDiag(ParaValue, Const_Type, lb, ub)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="True_BoundDiag_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter value</p>
</td></tr>
<tr><td><code id="True_BoundDiag_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
<tr><td><code id="True_BoundDiag_+3A_lb">lb</code></td>
<td>
<p>lower bound</p>
</td></tr>
<tr><td><code id="True_BoundDiag_+3A_ub">ub</code></td>
<td>
<p>upper bound</p>
</td></tr>
</table>

<hr>
<h2 id='True_JLLstruct'>Transformation of the JLL-related parameters (true form)</h2><span id='topic+True_JLLstruct'></span>

<h3>Description</h3>

<p>Transformation of the JLL-related parameters (true form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>True_JLLstruct(ParaValue, Const_Type, FactorLabels, Economies, JLLinputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="True_JLLstruct_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter value</p>
</td></tr>
<tr><td><code id="True_JLLstruct_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
<tr><td><code id="True_JLLstruct_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="True_JLLstruct_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="True_JLLstruct_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>Inputs used in the estimation of the JLL-based models</p>
</td></tr>
</table>

<hr>
<h2 id='True_Jordan'>Transformation of the Jordan-related parameters (True form)</h2><span id='topic+True_Jordan'></span>

<h3>Description</h3>

<p>Transformation of the Jordan-related parameters (True form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>True_Jordan(ParaValue, Const_Type, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="True_Jordan_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter</p>
</td></tr>
<tr><td><code id="True_Jordan_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
<tr><td><code id="True_Jordan_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="True_Jordan_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='True_PSD'>Transformation of a PSD matrix (true form)</h2><span id='topic+True_PSD'></span>

<h3>Description</h3>

<p>Transformation of a PSD matrix (true form)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>True_PSD(ParaValue, Const_Type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="True_PSD_+3A_paravalue">ParaValue</code></td>
<td>
<p>Constrained parameter value</p>
</td></tr>
<tr><td><code id="True_PSD_+3A_const_type">Const_Type</code></td>
<td>
<p>Type of constraint</p>
</td></tr>
</table>

<hr>
<h2 id='Update_ParaList'>converts the vectorized auxiliary parameter vector x to the parameters that go directly
into the likelihood function.</h2><span id='topic+Update_ParaList'></span>

<h3>Description</h3>

<p>converts the vectorized auxiliary parameter vector x to the parameters that go directly
into the likelihood function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Update_ParaList(
  x,
  sizex,
  con,
  FactorLabels,
  Economies,
  JLLinputs = NULL,
  GVARinputs = NULL,
  ListInputSet
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Update_ParaList_+3A_x">x</code></td>
<td>
<p>vector containing all the vectorized auxiliary parameters</p>
</td></tr>
<tr><td><code id="Update_ParaList_+3A_sizex">sizex</code></td>
<td>
<p>matrix (6x2) containing the size information of all parameters</p>
</td></tr>
<tr><td><code id="Update_ParaList_+3A_con">con</code></td>
<td>
<p>if con = 'concentration', then set the value of the parameter whose name
contains @ to empty</p>
</td></tr>
<tr><td><code id="Update_ParaList_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="Update_ParaList_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="Update_ParaList_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>Set of necessary inputs used in the estimation of the JLL-based models</p>
</td></tr>
<tr><td><code id="Update_ParaList_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>Set of necessary inputs used in the estimation of the GVAR-based models</p>
</td></tr>
<tr><td><code id="Update_ParaList_+3A_listinputset">ListInputSet</code></td>
<td>
<p>variable inputs used in the optimization (see &quot;Optimization&quot; function)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>same form as varargin, except now the parameters are updated with the values provided by the auxiliary x.
Importantly, by construction, all the constraints on the underlying parameters are satisfied.
</p>


<h3>References</h3>

<p>This function is a modified version of the &quot;update_para&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot;<br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Update_SSZ_JLL'>Update the variance-covariance matrix from the &quot;JLL joint Sigma&quot; model. Necessary for optimization</h2><span id='topic+Update_SSZ_JLL'></span>

<h3>Description</h3>

<p>Update the variance-covariance matrix from the &quot;JLL joint Sigma&quot; model. Necessary for optimization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Update_SSZ_JLL(SSZ, Z, N, JLLinputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Update_SSZ_JLL_+3A_ssz">SSZ</code></td>
<td>
<p>Variance-covariance matrix from JLL model</p>
</td></tr>
<tr><td><code id="Update_SSZ_JLL_+3A_z">Z</code></td>
<td>
<p>complete set of spanned and unspanned factors (F x T)</p>
</td></tr>
<tr><td><code id="Update_SSZ_JLL_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors</p>
</td></tr>
<tr><td><code id="Update_SSZ_JLL_+3A_jllinputs">JLLinputs</code></td>
<td>
<p>List of inputs from JLL models</p>
</td></tr>
</table>

<hr>
<h2 id='VAR'>Estimates a standard VAR(1)</h2><span id='topic+VAR'></span>

<h3>Description</h3>

<p>Estimates a standard VAR(1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VAR(RiskFactors, VARtype, Bcon = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VAR_+3A_riskfactors">RiskFactors</code></td>
<td>
<p>A numeric matrix (FTx T) representing the time series of risk factors.</p>
</td></tr>
<tr><td><code id="VAR_+3A_vartype">VARtype</code></td>
<td>
<p>String vector with two possible values: 'unconstrained' or 'constrained'.</p>
</td></tr>
<tr><td><code id="VAR_+3A_bcon">Bcon</code></td>
<td>
<p>Constraints matrix (F+1 x N), which includes an intercept. If Bcon(i,j) = NA, then B(i,j) is treated as a free parameter. <br />
Default is set to NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>intercept, feedback matrix and the variance-covariance matrix of a VAR(1)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CM_Factors")
#Example 1: unconstrained case
VAR(RiskFactors, VARtype= 'unconstrained')
#Example 2: constrainted case
K &lt;- nrow(RiskFactors)
Bcon &lt;-matrix(0, nrow = K, ncol = K+1)
Bcon[ , 1:3] &lt;- NaN
VAR(RiskFactors, VARtype= 'constrained', Bcon)


</code></pre>

<hr>
<h2 id='VarianceExplained'>Percentage explained by the spanned factors of the variations in the set of observed yields for all models</h2><span id='topic+VarianceExplained'></span>

<h3>Description</h3>

<p>Percentage explained by the spanned factors of the variations in the set of observed yields for all models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarianceExplained(ModelType, ModelPara, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VarianceExplained_+3A_modeltype">ModelType</code></td>
<td>
<p>string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="VarianceExplained_+3A_modelpara">ModelPara</code></td>
<td>
<p>List of model parameter estimates (see the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="VarianceExplained_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="VarianceExplained_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='VARX'>Estimate a VARX(1,1,1)</h2><span id='topic+VARX'></span>

<h3>Description</h3>

<p>Estimate a VARX(1,1,1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VARX(GVARinputs, Factors_GVAR, DomLabels, StarLabels, GlobalLabels, N)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VARX_+3A_gvarinputs">GVARinputs</code></td>
<td>
<p>List of inputs for GVAR-based models</p>
</td></tr>
<tr><td><code id="VARX_+3A_factors_gvar">Factors_GVAR</code></td>
<td>
<p>list containing the set of eisk factors used in the estimation of the VARX models</p>
</td></tr>
<tr><td><code id="VARX_+3A_domlabels">DomLabels</code></td>
<td>
<p>string-based vector containing label of the domestic risk factors</p>
</td></tr>
<tr><td><code id="VARX_+3A_starlabels">StarLabels</code></td>
<td>
<p>string-based vector containing label of the star domestic risk factors</p>
</td></tr>
<tr><td><code id="VARX_+3A_globallabels">GlobalLabels</code></td>
<td>
<p>string-based vector containing label of the global risk factors</p>
</td></tr>
<tr><td><code id="VARX_+3A_n">N</code></td>
<td>
<p>number of country-specific spanned factors (scalar)</p>
</td></tr>
</table>

<hr>
<h2 id='Wished_Graphs_FEVDandGFEVD'>Extract list of desired graph features (IRFs anc GIRFs)</h2><span id='topic+Wished_Graphs_FEVDandGFEVD'></span>

<h3>Description</h3>

<p>Extract list of desired graph features (IRFs anc GIRFs)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wished_Graphs_FEVDandGFEVD(InputsForOutputs, OutType, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Wished_Graphs_FEVDandGFEVD_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>List of inputs for outputs</p>
</td></tr>
<tr><td><code id="Wished_Graphs_FEVDandGFEVD_+3A_outtype">OutType</code></td>
<td>
<p>Output types &quot;FEVD&quot;, &quot;GFEVD&quot; and &quot;FEVD Ortho&quot;</p>
</td></tr>
<tr><td><code id="Wished_Graphs_FEVDandGFEVD_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
</table>

<hr>
<h2 id='Wished_Graphs_IRFandGIRF'>Extract list of desired graph features (IRFs anc GIRFs)</h2><span id='topic+Wished_Graphs_IRFandGIRF'></span>

<h3>Description</h3>

<p>Extract list of desired graph features (IRFs anc GIRFs)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wished_Graphs_IRFandGIRF(InputsForOutputs, OutType, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Wished_Graphs_IRFandGIRF_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>List of inputs for outputs</p>
</td></tr>
<tr><td><code id="Wished_Graphs_IRFandGIRF_+3A_outtype">OutType</code></td>
<td>
<p>Output types &quot;IRF&quot;, &quot;GIRF&quot; and &quot;IRF Ortho&quot;</p>
</td></tr>
<tr><td><code id="Wished_Graphs_IRFandGIRF_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
</table>

<hr>
<h2 id='WishGraphs_FEVDandGFEVD_Boot'>Extract graphs of interest (bootstrap version)</h2><span id='topic+WishGraphs_FEVDandGFEVD_Boot'></span>

<h3>Description</h3>

<p>Extract graphs of interest (bootstrap version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WishGraphs_FEVDandGFEVD_Boot(InputsForOutputs, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WishGraphs_FEVDandGFEVD_Boot_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction of IRFs, GIRFs, FEVDs, and GFEVDs</p>
</td></tr>
<tr><td><code id="WishGraphs_FEVDandGFEVD_Boot_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
</table>

<hr>
<h2 id='WishGraphs_IRFandGIRF_Boot'>Extract graphs of interest (bootstrap version)</h2><span id='topic+WishGraphs_IRFandGIRF_Boot'></span>

<h3>Description</h3>

<p>Extract graphs of interest (bootstrap version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WishGraphs_IRFandGIRF_Boot(InputsForOutputs, ModelType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WishGraphs_IRFandGIRF_Boot_+3A_inputsforoutputs">InputsForOutputs</code></td>
<td>
<p>list containing the desired inputs for the construction of IRFs, GIRFs, FEVDs, and GFEVDs</p>
</td></tr>
<tr><td><code id="WishGraphs_IRFandGIRF_Boot_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
</table>

<hr>
<h2 id='x2bound'>Transform x to a number bounded btw lb and ub by:</h2><span id='topic+x2bound'></span>

<h3>Description</h3>

<p>Transform x to a number bounded btw lb and ub by:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x2bound(x, lb, ub, nargout)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x2bound_+3A_x">x</code></td>
<td>
<p>number to be transformed (scalar)</p>
</td></tr>
<tr><td><code id="x2bound_+3A_lb">lb</code></td>
<td>
<p>lower bound (scalar)</p>
</td></tr>
<tr><td><code id="x2bound_+3A_ub">ub</code></td>
<td>
<p>upper bound (scalar)</p>
</td></tr>
<tr><td><code id="x2bound_+3A_nargout">nargout</code></td>
<td>
<p>&quot;1&quot; or &quot;2&quot; (scalar)</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is based on the &quot;x2bound&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling).
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='x2pos'>Transform x to a positive number by: y = log(e^x + 1)</h2><span id='topic+x2pos'></span>

<h3>Description</h3>

<p>Transform x to a positive number by: y = log(e^x + 1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x2pos(x, nargout)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x2pos_+3A_x">x</code></td>
<td>
<p>scalar or vector</p>
</td></tr>
<tr><td><code id="x2pos_+3A_nargout">nargout</code></td>
<td>
<p>1 or 2</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function is based on the &quot;x2pos&quot; function by Le and Singleton (2018). <br />
&quot;A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.&quot; <br />
(Euro Area Business Cycle Network Training School - Term Structure Modelling)
Available at: https://cepr.org/40029
</p>

<hr>
<h2 id='Y_Fit'>Model-implied yields (cross-section)</h2><span id='topic+Y_Fit'></span>

<h3>Description</h3>

<p>Model-implied yields (cross-section)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Y_Fit(ALoad, BLoad, Spa_TS, MatLength, TDim, YieldLab)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Y_Fit_+3A_aload">ALoad</code></td>
<td>
<p>A loadings</p>
</td></tr>
<tr><td><code id="Y_Fit_+3A_bload">BLoad</code></td>
<td>
<p>B loadings</p>
</td></tr>
<tr><td><code id="Y_Fit_+3A_spa_ts">Spa_TS</code></td>
<td>
<p>time series of spanned factors</p>
</td></tr>
<tr><td><code id="Y_Fit_+3A_matlength">MatLength</code></td>
<td>
<p>length of the vector of maturities</p>
</td></tr>
<tr><td><code id="Y_Fit_+3A_tdim">TDim</code></td>
<td>
<p>Time-series dimension</p>
</td></tr>
<tr><td><code id="Y_Fit_+3A_yieldlab">YieldLab</code></td>
<td>
<p>Label of yields</p>
</td></tr>
</table>

<hr>
<h2 id='Y_ModImp'>Model-implied yields (P-dynamics)</h2><span id='topic+Y_ModImp'></span>

<h3>Description</h3>

<p>Model-implied yields (P-dynamics)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Y_ModImp(ALoad, BLoad, K0Z, K1Z, PdynFact, MatLength, TDim, YieldLab)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Y_ModImp_+3A_aload">ALoad</code></td>
<td>
<p>A loadings</p>
</td></tr>
<tr><td><code id="Y_ModImp_+3A_bload">BLoad</code></td>
<td>
<p>B loadings</p>
</td></tr>
<tr><td><code id="Y_ModImp_+3A_k0z">K0Z</code></td>
<td>
<p>intercept from the P-dynamics</p>
</td></tr>
<tr><td><code id="Y_ModImp_+3A_k1z">K1Z</code></td>
<td>
<p>feedback matrix from the P-dynamics</p>
</td></tr>
<tr><td><code id="Y_ModImp_+3A_pdynfact">PdynFact</code></td>
<td>
<p>time series of the risk-factors spanned factors</p>
</td></tr>
<tr><td><code id="Y_ModImp_+3A_matlength">MatLength</code></td>
<td>
<p>length of the vector of maturities</p>
</td></tr>
<tr><td><code id="Y_ModImp_+3A_tdim">TDim</code></td>
<td>
<p>Time-series dimension</p>
</td></tr>
<tr><td><code id="Y_ModImp_+3A_yieldlab">YieldLab</code></td>
<td>
<p>Label of yields</p>
</td></tr>
</table>

<hr>
<h2 id='YieldBounds_FEVDandGFEVD'>Compute the confidence bounds for the model bond yield-related outputs</h2><span id='topic+YieldBounds_FEVDandGFEVD'></span>

<h3>Description</h3>

<p>Compute the confidence bounds for the model bond yield-related outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YieldBounds_FEVDandGFEVD(
  ModelBootstrap,
  quants,
  ModelType,
  ndraws,
  Horiz,
  FacDim,
  YieDim,
  LabFEVD,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_quants">quants</code></td>
<td>
<p>quantile of the confidence bounds</p>
</td></tr>
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws</p>
</td></tr>
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_yiedim">YieDim</code></td>
<td>
<p>dimension of the bond yield set</p>
</td></tr>
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_labfevd">LabFEVD</code></td>
<td>
<p>vector containing the labels &quot;FEVD&quot; and &quot;GFEVD&quot;</p>
</td></tr>
<tr><td><code id="YieldBounds_FEVDandGFEVD_+3A_economies">Economies</code></td>
<td>
<p>Economies that are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='YieldBounds_IRFandGIRF'>Compute the confidence bounds for the model bond yield-related outputs</h2><span id='topic+YieldBounds_IRFandGIRF'></span>

<h3>Description</h3>

<p>Compute the confidence bounds for the model bond yield-related outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YieldBounds_IRFandGIRF(
  ModelBootstrap,
  quants,
  ModelType,
  ndraws,
  Horiz,
  FacDim,
  YieDim,
  LabIRF,
  Economies
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_modelbootstrap">ModelBootstrap</code></td>
<td>
<p>numerical output set from the bootstrap analysis</p>
</td></tr>
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_quants">quants</code></td>
<td>
<p>quantile of the confidence bounds</p>
</td></tr>
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws</p>
</td></tr>
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_yiedim">YieDim</code></td>
<td>
<p>dimension of the bond yield set</p>
</td></tr>
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_labirf">LabIRF</code></td>
<td>
<p>vector containing the labels &quot;IRF&quot; and &quot;GIRF&quot;</p>
</td></tr>
<tr><td><code id="YieldBounds_IRFandGIRF_+3A_economies">Economies</code></td>
<td>
<p>Economies that are part of the economic system</p>
</td></tr>
</table>

<hr>
<h2 id='YieldFor'>Compile the bond yield forecast for any model type</h2><span id='topic+YieldFor'></span>

<h3>Description</h3>

<p>Compile the bond yield forecast for any model type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YieldFor(
  ModelParaList,
  ForHoriz,
  Economies,
  FactorLabels,
  ForLabels,
  ModelType
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="YieldFor_+3A_modelparalist">ModelParaList</code></td>
<td>
<p>List of model parameter estimates</p>
</td></tr>
<tr><td><code id="YieldFor_+3A_forhoriz">ForHoriz</code></td>
<td>
<p>forecast horizon (scalar)</p>
</td></tr>
<tr><td><code id="YieldFor_+3A_economies">Economies</code></td>
<td>
<p>string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="YieldFor_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>a string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="YieldFor_+3A_forlabels">ForLabels</code></td>
<td>
<p>Forecast labels (string-based vector)</p>
</td></tr>
<tr><td><code id="YieldFor_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
</table>

<hr>
<h2 id='YieldQuantile_bs'>Compute quantiles for model bond yield-related outputs</h2><span id='topic+YieldQuantile_bs'></span>

<h3>Description</h3>

<p>Compute quantiles for model bond yield-related outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YieldQuantile_bs(
  DrawSet,
  LabIRF,
  ndraws,
  quants,
  Horiz,
  FacDim,
  YieDim,
  LabelsYies,
  ModelType,
  Ortho = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="YieldQuantile_bs_+3A_drawset">DrawSet</code></td>
<td>
<p>Draw-specific set</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_labirf">LabIRF</code></td>
<td>
<p>vector containing the labels &quot;IRF&quot; and &quot;GIRF&quot;</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_ndraws">ndraws</code></td>
<td>
<p>number of draws</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_quants">quants</code></td>
<td>
<p>quantile of the confidence bounds</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_horiz">Horiz</code></td>
<td>
<p>horizon of numerical outputs</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_facdim">FacDim</code></td>
<td>
<p>dimension of the risk factor set</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_yiedim">YieDim</code></td>
<td>
<p>dimension of the bond yield set</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_labelsyies">LabelsYies</code></td>
<td>
<p>labels of the factor set</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_modeltype">ModelType</code></td>
<td>
<p>desired model type</p>
</td></tr>
<tr><td><code id="YieldQuantile_bs_+3A_ortho">Ortho</code></td>
<td>
<p>Orthogonolized version for the JLL models. Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='Yields'>Data: Yields - Candelon and Moura (forthcoming, JFEC)</h2><span id='topic+Yields'></span>

<h3>Description</h3>

<p>Yields data used in Candelon and Moura (forthcoming, JFEC)
</p>
<p>Bond yield data used in Candelon and Moura (2023)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CM_Yields")

data("CM_Yields_2023")
</code></pre>


<h3>Format</h3>

<p>matrix containing the Yields of the models
</p>
<p>matrix containing the Yields of the models
</p>


<h3>References</h3>

<p>Candelon, B. and Moura, R. (Forthcoming) &quot;A Multicountry Model of the Term Structures of Interest Rates with a GVAR&quot;. (Journal of Financial Econometrics)
</p>
<p>Candelon, B. and Moura, R. (2023) &quot;Sovereign yield curves and the COVID-19 in emerging markets&quot;. (Economic Modelling)
</p>

<hr>
<h2 id='YieldsFit'>Computes two measures of model fit for bond yields (all models)</h2><span id='topic+YieldsFit'></span>

<h3>Description</h3>

<p>Computes two measures of model fit for bond yields (all models)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YieldsFit(ModelType, ModelPara, FactorLabels, Economies)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="YieldsFit_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="YieldsFit_+3A_modelpara">ModelPara</code></td>
<td>
<p>List of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="YieldsFit_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>a string-list based which contains the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="YieldsFit_+3A_economies">Economies</code></td>
<td>
<p>a string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&quot;Model-implied yields&quot; is the measure of fit based exclusively on the risk-neutral parameters, whereas the
&quot;Model-Fit&quot; takes into account both the risk-neutral and the physical paameters.
</p>


<h3>References</h3>

<p>See, for instance, Jotiskhatira, Le and Lundblad (2015). &quot;Why do interest rates in different currencies co-move?&quot; (Journal of Financial Economics)
</p>

<hr>
<h2 id='YieldsFitAllJoint'>Fit yields for all maturities of interest</h2><span id='topic+YieldsFitAllJoint'></span>

<h3>Description</h3>

<p>Fit yields for all maturities of interest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YieldsFitAllJoint(MatInt, ModelPara, FactorLabels, ModelType, Economies, YLab)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="YieldsFitAllJoint_+3A_matint">MatInt</code></td>
<td>
<p>numerical vector containing the fit maturities of interest</p>
</td></tr>
<tr><td><code id="YieldsFitAllJoint_+3A_modelpara">ModelPara</code></td>
<td>
<p>List of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="YieldsFitAllJoint_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>a string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="YieldsFitAllJoint_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="YieldsFitAllJoint_+3A_economies">Economies</code></td>
<td>
<p>a string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="YieldsFitAllJoint_+3A_ylab">YLab</code></td>
<td>
<p>Label of yields (&quot;Months&quot; or &quot;Yields&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='YieldsFitAllSep'>Fit yields for all maturities of interest</h2><span id='topic+YieldsFitAllSep'></span>

<h3>Description</h3>

<p>Fit yields for all maturities of interest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YieldsFitAllSep(MatInt, ModelPara, FactorLabels, ModelType, Economies, YLab)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="YieldsFitAllSep_+3A_matint">MatInt</code></td>
<td>
<p>numerical vector containing the fit maturities of interest</p>
</td></tr>
<tr><td><code id="YieldsFitAllSep_+3A_modelpara">ModelPara</code></td>
<td>
<p>List of model parameter estimates (See the &quot;Optimization&quot; function)</p>
</td></tr>
<tr><td><code id="YieldsFitAllSep_+3A_factorlabels">FactorLabels</code></td>
<td>
<p>a string-list based which contains all the labels of all the variables present in the model</p>
</td></tr>
<tr><td><code id="YieldsFitAllSep_+3A_modeltype">ModelType</code></td>
<td>
<p>a string-vector containing the label of the model to be estimated</p>
</td></tr>
<tr><td><code id="YieldsFitAllSep_+3A_economies">Economies</code></td>
<td>
<p>a string-vector containing the names of the economies which are part of the economic system</p>
</td></tr>
<tr><td><code id="YieldsFitAllSep_+3A_ylab">YLab</code></td>
<td>
<p>Label of yields (&quot;Months&quot; or &quot;Yields&quot;)</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
