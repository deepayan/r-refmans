<!DOCTYPE html><html lang="en"><head><title>Help for package inTextSummaryTable</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {inTextSummaryTable}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#inTextSummaryTable'><p>inTextSummaryTable: creation of in-text summary table</p></a></li>
<li><a href='#checkVar'><p>Check if variable(s) are present in reference: either in columns in</p>
a dataset or in reference set.</a></li>
<li><a href='#checkVarLabInclude'><p>Check the <code>varLabInclude</code> variable.</p></a></li>
<li><a href='#combine'><p>Combine objects</p></a></li>
<li><a href='#combine.summaryTable'><p>Combine summary statistics table</p></a></li>
<li><a href='#combineColTotal'><p>Combine the column total for a combined summary table</p></a></li>
<li><a href='#combineVariables'><p>Create a data.frame combining a set of records from same or multiple variables.</p></a></li>
<li><a href='#computeSummaryStatistics'><p>Compute summary statistics of interest of an unique variable of interest.</p></a></li>
<li><a href='#computeSummaryStatisticsByRowColVar'><p>Compute summary statistics by specified <code>rowVar</code> and <code>colVar</code></p></a></li>
<li><a href='#computeSummaryStatisticsTable'><p>Compute summary statistics for a specific dataset and variables of interest</p></a></li>
<li><a href='#computeSummaryStatisticsTableTotal'><p>Compute summary statistics total table.</p></a></li>
<li><a href='#convertSummaryStatisticsTableToFlextable'><p>Convert summary statistics table to flextable</p></a></li>
<li><a href='#convertVarFlag'><p>Convert flag variable to a format such as only the flagged records are counted</p>
in the summary table.</a></li>
<li><a href='#convertVarRowVarColVarToFactor'><p>Convert <code>rowVar</code>, <code>colVar</code> and character <code>var</code> in <code>data</code> to factor</p></a></li>
<li><a href='#convertVarToFactorWithOrder'><p>Convert a variable to a factor with levels in specified order.</p></a></li>
<li><a href='#convertVectToBinary'><p>Convert vector to a bincode of 0/1</p>
based on consecutive values in the vector.</a></li>
<li><a href='#createFlextableWithHeader'><p>Create a flextable, setting the column names to syntactic names</p>
if it is not the case.</a></li>
<li><a href='#cv'><p>Compute the percentage coefficient of variation,</p>
(in a scale from 0 to 100).</a></li>
<li><a href='#export'><p>Export an object</p></a></li>
<li><a href='#export.summaryTable'><p>Export a summary table to <code>docx</code>, <code>pptx</code></p>
or <code>html</code> format (interactive table)</a></li>
<li><a href='#exportFlextableToDocx'><p>Export flextable to docx file</p></a></li>
<li><a href='#exportSummaryStatisticsTableToDT'><p>Export summary table to an interactive DT table,</p>
e.g. to be exported into an html document.</a></li>
<li><a href='#exportSummaryStatisticsTableToFlextable'><p>Export summary table to a flextable object,</p>
e.g. to be exported in Word or PowerPoint.</a></li>
<li><a href='#formatCustomFlextable'><p>Format superscript/subscripts/bold cells in a flextable.</p>
Superscript should be indicated as: '<code>a^{b}</code>',
subscript as '<code>a_{b}</code>' and bold as '<code>bold{a}</code>' in the
the input summary table.</a></li>
<li><a href='#formatPercentage'><p>Format a percentage.</p></a></li>
<li><a href='#formatSummaryStatisticsTable'><p>Format summary statistics table for export</p></a></li>
<li><a href='#formatSummaryStatisticsTableFlextable'><p>Merge nested rows of a summary table</p>
for a format compatible with <code>flextable</code></a></li>
<li><a href='#geomCV'><p>Compute geometric coefficient of variation</p>
(in a scale from 0 to 100).</a></li>
<li><a href='#geomMean'><p>Compute geometric mean.</p></a></li>
<li><a href='#geomSD'><p>Compute geometric standard deviation</p></a></li>
<li><a href='#geomSE'><p>Compute geometric standard error of the mean.</p></a></li>
<li><a href='#getAttribute'><p>Get specific attribute from a summaryTable or a list of summaryTables</p></a></li>
<li><a href='#getColorPaletteTable'><p>Get color palette for the tables</p></a></li>
<li><a href='#getDimPage'><p>Get dimension of the page available for content</p>
for standard Word report or PowerPoint presentation.</a></li>
<li><a href='#getListing'><p>Format or create flextable for listings.</p></a></li>
<li><a href='#getMaxNDecimals'><p>Get maximum number of decimals in a variable,</p>
based on pre-defined rule and/or data.</a></li>
<li><a href='#getMaxNDecimalsData'><p>Get maximum number of decimals in a variable based on the data</p>
(<code>getNDecimalsData</code>)</a></li>
<li><a href='#getNDecimals'><p>Get number of decimals for a specific vector.</p></a></li>
<li><a href='#getNDecimalsData'><p>Get number of decimals based on the data in a numeric vector.</p>
Note: NA is returned if the element is missing (NA).</a></li>
<li><a href='#getNDecimalsRule'><p>Get number of decimals based pre-defined rule(s).</p></a></li>
<li><a href='#getPatternPosition'><p>Get position(s) (start, end) of a pattern in a string.</p></a></li>
<li><a href='#getStatisticsSummaryStatisticsTable'><p>Compute custom statistics specified by the user.</p></a></li>
<li><a href='#getStats'><p>Get default set of statistics for one particular variable.</p></a></li>
<li><a href='#getStatsData'><p>Get default set of statistics for variables of interest and specific dataset.</p></a></li>
<li><a href='#getSummaryStatisticsTable'><p>Get summary statistics table</p></a></li>
<li><a href='#interactionCustom'><p>Compute the interaction between variable(s),</p>
without propagating the missing values (if present in one of the variable)
unlike the behaviour with <code>interaction</code>.
This also ensure that the levels of the final interaction variables
are ordered similarly as the levels of the input <code>var</code> (if present).</a></li>
<li><a href='#inTextSummaryTable-common-args'><p>Arguments used across the functions of the inTextSummaryTable package.</p></a></li>
<li><a href='#inTextSummaryTable-DT-args'><p>Common arguments for the functionalities of the inTextSummaryTable package</p>
for DT export.</a></li>
<li><a href='#inTextSummaryTable-flextable-args'><p>Common arguments for the functionalities of the inTextSummaryTable package</p>
for flextable export.</a></li>
<li><a href='#inTextSummaryTable-stats'><p>Statistics in the in-text table package.</p></a></li>
<li><a href='#inTextSummaryTable-stats-utility'><p>Common arguments for the for the statistics utility functions</p>
of the inTextSummaryTable package.</a></li>
<li><a href='#mergeHeaderCols'><p>Merge columns and rows in the header of a flextable object.</p></a></li>
<li><a href='#pageDimPresentation'><p>Page dimension for powerpoints</p></a></li>
<li><a href='#postProcessVarFlag'><p>Post-process the summary statistics table with variable flag.</p></a></li>
<li><a href='#se'><p>Compute standard error of the mean.</p></a></li>
<li><a href='#smoothPadding'><p>Smooth padding, e.g. remove padding bigger than 1</p></a></li>
<li><a href='#subjectProfileSummaryPlot'><p>Plot subject summary profile.</p></a></li>
<li><a href='#subjectProfileSummaryTable'><p>Plot a table with <code>ggplot</code> of a text variable of interest.</p></a></li>
<li><a href='#summaryTable'><p><code>summaryTable</code></p></a></li>
<li><a href='#tableColorsPresentation'><p>Colors for tables in a presentation style</p></a></li>
<li><a href='#tableColorsReport'><p>Colors for tables in a report style</p></a></li>
<li><a href='#uniqueVarWithOrder'><p>Get unique variables with meaningful order.</p></a></li>
<li><a href='#writeTable'><p>Custom function to write table to a text file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Creation of in-Text Summary Table</td>
</tr>
<tr>
<td>Version:</td>
<td>3.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-12</td>
</tr>
<tr>
<td>Description:</td>
<td>Creation of tables of summary statistics or counts for clinical data (for 'TLFs'). 
  These tables can be exported as in-text table (with the 'flextable' package) for a Clinical Study Report 
  (Word format) or a 'topline' presentation (PowerPoint format), 
  or as interactive table (with the 'DT' package) to an html document for clinical data review.</td>
</tr>
<tr>
<td>Imports:</td>
<td>clinUtils (&ge; 0.1.0), cowplot, flextable (&ge; 0.5.5), ggplot2,
ggrepel, magrittr, methods, officer, plyr, reshape2 (&ge; 1.4),
scales, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>htmltools, knitr, rmarkdown, pander, testthat, xml2, tools,
dplyr, tibble, extrafont</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/openanalytics/inTextSummaryTable">https://github.com/openanalytics/inTextSummaryTable</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/openanalytics/inTextSummaryTable/issues">https://github.com/openanalytics/inTextSummaryTable/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>pandoc (to export an interactive summary table to a
file)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-12 17:36:37 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Laure Cougnaud [aut, cre],
  Michela Pasetto [aut],
  Margaux Faes [rev] (tests),
  Open Analytics [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Laure Cougnaud &lt;laure.cougnaud@openanalytics.eu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-12 18:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='inTextSummaryTable'>inTextSummaryTable: creation of in-text summary table</h2><span id='topic+inTextSummaryTable'></span><span id='topic+inTextSummaryTable-package'></span>

<h3>Description</h3>

<p>Tables of summary statistics or count tables are created. 
These tables can be exported as in-text table to a Clinical Study Report 
(Word format), a topline presentation (PowerPoint format),
or as interactive table to an html document.
</p>


<h3>Details</h3>


<ul>
<li><p>To get started with the package, see:<br />
<code>vignette("inTextSummaryTable-introduction", package = "inTextSummaryTable")</code>
</p>
</li>
<li><p>To get example code for standard in-text tables created with the package, 
see:<br />
<code>vignette("inTextSummaryTable-standardTables", package = "inTextSummaryTable")</code>
</p>
</li>
<li><p>The main function: <code><a href="#topic+getSummaryStatisticsTable">getSummaryStatisticsTable</a></code> enables
to create ready in-text table.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Laure Cougnaud <a href="mailto:laure.cougnaud@openanalytics.eu">laure.cougnaud@openanalytics.eu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Michela Pasetto <a href="mailto:michela.pasetto@openanalytics.eu">michela.pasetto@openanalytics.eu</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Margaux Faes (tests) [reviewer]
</p>
</li>
<li><p> Open Analytics [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/openanalytics/inTextSummaryTable">https://github.com/openanalytics/inTextSummaryTable</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/openanalytics/inTextSummaryTable/issues">https://github.com/openanalytics/inTextSummaryTable/issues</a>
</p>
</li></ul>


<hr>
<h2 id='checkVar'>Check if variable(s) are present in reference: either in columns in 
a dataset or in reference set.</h2><span id='topic+checkVar'></span>

<h3>Description</h3>

<p>Filter variables not present in the data or in reference set with a warning,
and only returned filtered vector, or NULL if empty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkVar(
  var,
  varLabel,
  varUncheck = NULL,
  varRef,
  refLabel = ifelse(!missing(varRef), "reference variable", "data"),
  data,
  msgType = c("warning", "error")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkVar_+3A_var">var</code></td>
<td>
<p>String with variable to check.</p>
</td></tr>
<tr><td><code id="checkVar_+3A_varlabel">varLabel</code></td>
<td>
<p>String with label for <code>var</code>, e.g.
name of associated parameter.</p>
</td></tr>
<tr><td><code id="checkVar_+3A_varuncheck">varUncheck</code></td>
<td>
<p>(Named) character vector with extra variables 
in <code>var</code> which shouldn't be checked.</p>
</td></tr>
<tr><td><code id="checkVar_+3A_varref">varRef</code></td>
<td>
<p>(Named) character vector with set of reference variables.</p>
</td></tr>
<tr><td><code id="checkVar_+3A_reflabel">refLabel</code></td>
<td>
<p>String with label for the reference</p>
</td></tr>
<tr><td><code id="checkVar_+3A_data">data</code></td>
<td>
<p>Data.frame with data.</p>
</td></tr>
<tr><td><code id="checkVar_+3A_msgtype">msgType</code></td>
<td>
<p>String with type of message returned, either a 'warning' (default)
or an error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on <code>msgType</code>:
</p>

<ul>
<li><p><code>warning</code>: warning is printed in the console, and a 
<code>var</code> filtered with element not in <code>data</code>
or in <code>refSet</code> is returned.
If filtered <code>var</code> is empty, NULL is returned.
</p>
</li>
<li><p><code>error</code>: an error is triggered.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='checkVarLabInclude'>Check the <code>varLabInclude</code> variable.</h2><span id='topic+checkVarLabInclude'></span>

<h3>Description</h3>

<p>This function ensures that:
</p>

<ul>
<li><p>variable name is included if more than one variable
are specified

</p>
</li>
<li><p>variable name is not included if no variable is specified
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>checkVarLabInclude(var, varLabInclude = length(var) &gt; 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkVarLabInclude_+3A_var">var</code></td>
<td>
<p>String with variable to check.</p>
</td></tr>
<tr><td><code id="checkVarLabInclude_+3A_varlabinclude">varLabInclude</code></td>
<td>
<p>Logical, if TRUE
the name of the summary statistic variable(s) (<code>var</code>)
are included in the table.
This is automatically set to TRUE if more than one variable(s) 
and is specified, and FALSE if only one variable is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(Updated) <code>varLabInclude</code>
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='combine'>Combine objects</h2><span id='topic+combine'></span>

<h3>Description</h3>

<p>Combine objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine_+3A_...">...</code></td>
<td>
<p>Extra parameters for the corresponding
method.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+combine.summaryTable">combine.summaryTable</a></code>
to combine <code><a href="#topic+summaryTable">summaryTable</a></code> objects.
</p>

<hr>
<h2 id='combine.summaryTable'>Combine summary statistics table</h2><span id='topic+combine.summaryTable'></span>

<h3>Description</h3>


<ul>
<li><p>A new table is created, combining the tables by rows.
</p>
</li>
<li><p>The attributes of the combined summary table are 
obtained by combining the attributes of all summary tables
(and removing duplicates).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summaryTable'
combine(..., summaryTables, combineVar = NULL, combineDir = c("row", "col"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine.summaryTable_+3A_...">...</code></td>
<td>
<p><code><a href="#topic+summaryTable">summaryTable</a></code> objects.</p>
</td></tr>
<tr><td><code id="combine.summaryTable_+3A_summarytables">summaryTables</code></td>
<td>
<p>List of <code><a href="#topic+summaryTable">summaryTable</a></code> objects.</p>
</td></tr>
<tr><td><code id="combine.summaryTable_+3A_combinevar">combineVar</code></td>
<td>
<p>(optional) String with name
of a new variable tracking from which table
each record originally come from.<br />
The label for each table is extracted from the names
of the <code>summaryTables</code> list, or 1:length(tables)
if the list is not named.<br />
If not specified (by default), the tables will be combined
but the information on which input table:
each record from the combined table belongs to will
not be retained.</p>
</td></tr>
<tr><td><code id="combine.summaryTable_+3A_combinedir">combineDir</code></td>
<td>
<p>String indicating
on which direction: 'row' or 'col' (a.k.a column)
the information on the table appartenance 
(<code>combineVar</code>) will
be displayed when the table is exported.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>In case only a set of tables contain categorical variable,
in nested rows, so the <code>variable</code> and <code>variableGroup</code>
variables, these variables are included as last in 
the 'row variables' attribute of the combined table.
</p>
</li>
<li><p>Only one row is retained for the columns totals
per column variable (the first one in order of appearance).<br />
The column totals are not included if the column
variable(s) are not the same across tables, or
if the totals differ between tables.
</p>
</li></ul>



<h3>Value</h3>

<p>A combined <code><a href="#topic+summaryTable">summaryTable</a></code>.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='combineColTotal'>Combine the column total for a combined summary table</h2><span id='topic+combineColTotal'></span>

<h3>Description</h3>

<p>Combine the column total for a combined summary table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineColTotal(summaryTable, attrs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combineColTotal_+3A_summarytable">summaryTable</code></td>
<td>
<p>Combined summary table</p>
</td></tr>
<tr><td><code id="combineColTotal_+3A_attrs">attrs</code></td>
<td>
<p>Nested list with attributes of each
summary table.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summary table, with combined total columns
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='combineVariables'>Create a data.frame combining a set of records from same or multiple variables.</h2><span id='topic+combineVariables'></span>

<h3>Description</h3>

<p>This typically converts the data from a wide to a long format.
For each variable, a subset of interest based on a condition can be specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineVariables(
  data,
  paramsList,
  newVar,
  labelVars = NULL,
  fctTest = "==",
  includeAll = FALSE,
  labelAll = "Any"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combineVariables_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="combineVariables_+3A_paramslist">paramsList</code></td>
<td>
<p>nested list of parameters, 
specifying how the records of interest should be selected.<br />
There are two ways to select a subset of interest:
</p>

<ul>
<li><p>by specifying one unique variable of interest with: 
</p>

<ul>
<li><p><code>var</code>: string with column of <code>data</code> of interest
</p>
</li>
<li><p><code>value</code>: value of <code>var</code> of interest (only used if <code>var</code> is specified).<br />
If not specified only the values different than NA and &rdquo; are considered.
</p>
</li>
<li><p><code>fctTest</code>: string with name or directly comparison function
to apply on <code>var</code> to select subset of interest versus <code>value</code>.<br />
The function should take <code>var</code> as first parameter and <code>value</code> to compare to
as second parameter and returns a logical vector with TRUE or FALSE (of length <code>var</code>)
if the condition is fullfilled.<br />
If not specified, the records with <code>var</code> equal to <code>value</code> are retained 
(<code>fctTest</code> is set to '=='). 
</p>
</li>
<li><p>label specification: 
</p>

<ul>
<li><p><code>label</code>: string with label for the condition,
includde in the new 'variable' column.<br />
If not specified and:
</p>

<ul>
<li><p><code>var</code> is specified: label is extracted from 
<code>labelVars</code> if available or set to <code>var</code> otherwise.
</p>
</li>
<li><p><code>var</code> is not specified: label should be specified.
</p>
</li></ul>

</li>
<li><p><code>labelExtra</code>: string with extra label, will be concatenated with <code>label</code>
</p>
</li></ul>

</li></ul>

</li>
<li><p>by specifying a combination of variable of interest with: 
</p>

<ul>
<li><p><code>exprs</code>: string with expression of columns of <code>data</code> to select subset of interest
</p>
</li>
<li><p><code>label</code>: string with complete label for the group
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="combineVariables_+3A_newvar">newVar</code></td>
<td>
<p>String with name of new variable to construct.</p>
</td></tr>
<tr><td><code id="combineVariables_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
<tr><td><code id="combineVariables_+3A_fcttest">fctTest</code></td>
<td>
<p>Default function to use to compare <code>var</code> and <code>value</code> specified
in each sublist of <code>paramsList</code>.<br />
This is only used if <code>fctTest</code> is not specified in each sublist.</p>
</td></tr>
<tr><td><code id="combineVariables_+3A_includeall">includeAll</code></td>
<td>
<p>Logical, if TRUE (FALSE by default) include also the entire data as an additional subgroup.</p>
</td></tr>
<tr><td><code id="combineVariables_+3A_labelall">labelAll</code></td>
<td>
<p>String of group label for the entire data in case <code>includeAll</code> is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.frame with records from <code>data</code> extracted based on
the different conditions specified in <code>paramsList</code>.<br />
This data.frame contains an additional variable 
(labelled based on <code>newVar</code>) mentioning the
specific condition for which the record was extracted
(based <code>label</code>, <code>labelExtra</code>, <code>labelVars</code>).<br />
This variable is a factor whose levels are ordered based on the order
of the condition specified in <code>paramsList</code>.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='computeSummaryStatistics'>Compute summary statistics of interest of an unique variable of interest.</h2><span id='topic+computeSummaryStatistics'></span>

<h3>Description</h3>

<p>Additionally, this function run extra checks on the data:
</p>

<ul>
<li><p>an error message is triggered if any subject (identified by <code>subjectVar</code>) 
have different values in a continuous <code>var</code>

</p>
</li>
<li><p>an indicative message is triggered if multiple but identical records are available
for <code>subjectVar</code> and a continuous <code>var</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>computeSummaryStatistics(
  data,
  var = NULL,
  varTotalInclude = FALSE,
  statsExtra = NULL,
  subjectVar = "USUBJID",
  filterEmptyVar = TRUE,
  type = "auto",
  checkVarDiffBySubj = c("error", "warning", "none"),
  msgLabel = NULL,
  msgVars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeSummaryStatistics_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) of <code>data</code>, 
to compute statistics on.<br />
If NULL (by default), counts by row/column variable(s) are computed.<br />
To also return counts of the <code>rowVar</code> in case other <code>var</code>
are specified, you can include: 'all' in the <code>var</code>.<br />
Missing values, if present, are filtered 
(also for the report of number of subjects/records).</p>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_vartotalinclude">varTotalInclude</code></td>
<td>
<p>Logical (FALSE by default)
Should the total across all categories of <code>var</code> 
be included for the count table?
Only used if <code>var</code> is a categorical variable.</p>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_statsextra">statsExtra</code></td>
<td>
<p>(optional) Named list with functions for additional custom
statistics to be computed.<br />
Each function:
</p>

<ul>
<li><p>has as parameter, either: 'x': the variable (<code>var</code>) to compute
the summary statistic on or 'data': the entire dataset
</p>
</li>
<li><p>returns the corresponding summary statistic as a numeric vector
</p>
</li></ul>

<p>For example, to additionally compute the coefficient of variation, this can be set to:
<code>list(statCVPerc = function(x) sd(x)/mean(x)*100)</code> (or <code><a href="#topic+cv">cv</a></code>).</p>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_subjectvar">subjectVar</code></td>
<td>
<p>String, variable of <code>data</code> with subject ID,
'USUBJID' by default.</p>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_filteremptyvar">filterEmptyVar</code></td>
<td>
<p>Logical, if TRUE doesn't return any results
if the variable is empty, otherwise return 0 for the counts and NA for summary 
statistics.
Criterias to consider a variable empty are:
</p>

<ul>
<li><p>for a continuous variable: all missing (NA)
</p>
</li>
<li><p>for a categorical variable: all missing or **category is included in the 
factor levels but not available in <code>data</code>**
</p>
</li></ul>

<p>By default, an empty variable are filtered.</p>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_type">type</code></td>
<td>
<p>String with type of table: 
</p>

<ul>
<li><p>'summaryTable': summary table with statistics for numeric variable
</p>
</li>
<li><p>'countTable': count table
</p>
</li>
<li><p>'auto' (by default): 'summaryTable' if the variable is numeric,
'countTable' otherwise
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_checkvardiffbysubj">checkVarDiffBySubj</code></td>
<td>
<p>String, 'error' (default), 'warning',
or 'none'.  
Should an error, a warning, or nothing be produced
if a continuous variable (<code>var</code>) contains
different values for the same subject?</p>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_msglabel">msgLabel</code></td>
<td>
<p>(optional) String with label for the data (NULL by default), 
included in the message/warning for checks.</p>
</td></tr>
<tr><td><code id="computeSummaryStatistics_+3A_msgvars">msgVars</code></td>
<td>
<p>(optional) Character vector with columns of <code>data</code>
containing extra variables (besides <code>var</code> and <code>subjectVar</code>)
that should be included in the message/warning for checks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.frame with summary statistics in columns,
depending if <code>type</code> is:
</p>

<ul>
<li><p>'summary': 
</p>

<ul>
<li><p>'statN': number of subjects
</p>
</li>
<li><p>'statm': number of records
</p>
</li>
<li><p>'statMean': mean of <code>var</code>
</p>
</li>
<li><p>'statSD': standard deviation of <code>var</code>
</p>
</li>
<li><p>'statSE': standard error the mean of <code>var</code>
</p>
</li>
<li><p>'statMedian': median of <code>var</code>
</p>
</li>
<li><p>'statMin': minimum of <code>var</code>
</p>
</li>
<li><p>'statMax': maximum of <code>var</code>
</p>
</li></ul>


</li>
<li><p>'count': 
</p>

<ul>
<li><p>'variableGroup': factor with groups of <code>var</code> for which counts are reported
</p>
</li>
<li><p>'statN': number of subjects
</p>
</li>
<li><p>'statm': number of records
</p>
</li></ul>


</li></ul>



<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='computeSummaryStatisticsByRowColVar'>Compute summary statistics by specified <code>rowVar</code> and <code>colVar</code></h2><span id='topic+computeSummaryStatisticsByRowColVar'></span>

<h3>Description</h3>

<p>Compute summary statistics by specified <code>rowVar</code> and <code>colVar</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeSummaryStatisticsByRowColVar(
  data,
  var = NULL,
  varLab = getLabelVar(var = var, data = data, labelVars = labelVars),
  varInclude0 = FALSE,
  varLabInclude = length(var) &gt; 1,
  varTotalInclude = FALSE,
  type = "auto",
  rowVar = NULL,
  rowInclude0 = FALSE,
  rowVarDataLevels = NULL,
  colVar = NULL,
  colInclude0 = FALSE,
  colVarDataLevels = NULL,
  subjectVar = "USUBJID",
  labelVars = NULL,
  statsExtra = NULL,
  msgLabel = NULL,
  checkVarDiffBySubj = "error"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) of <code>data</code>, 
to compute statistics on.<br />
If NULL (by default), counts by row/column variable(s) are computed.<br />
To also return counts of the <code>rowVar</code> in case other <code>var</code>
are specified, you can include: 'all' in the <code>var</code>.<br />
Missing values, if present, are filtered 
(also for the report of number of subjects/records).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_varlab">varLab</code></td>
<td>
<p>Named character vector with label for each variable 
specified in <code>var</code>.
By default, extracted from the <code>labelVars</code>.
if not available, <code>var</code> is used.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_varinclude0">varInclude0</code></td>
<td>
<p>Logical, should rows with no counts 
for the count <code>var</code> or <code>varFlag</code> variable(s)
be included in the table?
Either:
</p>

<ul>
<li><p>logical of length 1, if TRUE (FALSE by default) 
rows with no count are included for all <code>var</code>

</p>
</li>
<li><p>a character vector containing categorical <code>var</code> 
for which zero counts rows should be included
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_varlabinclude">varLabInclude</code></td>
<td>
<p>Logical, if TRUE
the name of the summary statistic variable(s) (<code>var</code>)
are included in the table.
This is automatically set to TRUE if more than one variable(s) 
and is specified, and FALSE if only one variable is specified.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_vartotalinclude">varTotalInclude</code></td>
<td>
<p>Should the total across all categories of <code>var</code> 
be included for the count table?
Only used for categorical variables (and <code>var</code> not 'all').
Either:
</p>

<ul>
<li><p>logical of length 1, if TRUE (FALSE by default) include the total for all categorical <code>var</code>
</p>
</li>
<li><p>a character vector containing categorical <code>var</code> for which the total should be included
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_type">type</code></td>
<td>
<p>String with type of table: 
</p>

<ul>
<li><p>'summaryTable': summary table with statistics for numeric variable
</p>
</li>
<li><p>'countTable': count table
</p>
</li>
<li><p>'auto' (by default): 'summaryTable' if the variable is numeric,
'countTable' otherwise
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_rowinclude0">rowInclude0</code></td>
<td>
<p>Logical, if TRUE (FALSE by default),
include rows with no records, based on all combinations 
of the <code>rowVar</code> (assuming nested variable(s)).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_rowvardatalevels">rowVarDataLevels</code></td>
<td>
<p>Data.frame with unique combinations of <code>rowVar</code>
to be included in columns.
Each column should correspond to <code>colVar</code> and as factor
if the elements should be ordered in the final table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_colinclude0">colInclude0</code></td>
<td>
<p>Logical, if TRUE (FALSE by default),
include columns with no records, based on all combinations 
of the <code>columnVar</code> (assuming nested variable(s)).
If variable(s) are not nested, possible combinations
can be specified via <code>colVarDataLevels</code>.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_colvardatalevels">colVarDataLevels</code></td>
<td>
<p>Data.frame with unique combinations of <code>colVar</code>
to be included in columns.
Each column should correspond to <code>colVar</code> and as factor
if the elements should be ordered in the final table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_subjectvar">subjectVar</code></td>
<td>
<p>String, variable of <code>data</code> with subject ID,
'USUBJID' by default.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_statsextra">statsExtra</code></td>
<td>
<p>(optional) Named list with functions for additional custom
statistics to be computed.<br />
Each function:
</p>

<ul>
<li><p>has as parameter, either: 'x': the variable (<code>var</code>) to compute
the summary statistic on or 'data': the entire dataset
</p>
</li>
<li><p>returns the corresponding summary statistic as a numeric vector
</p>
</li></ul>

<p>For example, to additionally compute the coefficient of variation, this can be set to:
<code>list(statCVPerc = function(x) sd(x)/mean(x)*100)</code> (or <code><a href="#topic+cv">cv</a></code>).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsByRowColVar_+3A_checkvardiffbysubj">checkVarDiffBySubj</code></td>
<td>
<p>String, 'error' (default), 'warning',
or 'none'.  
Should an error, a warning, or nothing be produced
if a continuous variable (<code>var</code>) contains
different values for the same subject (by row/column)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame of class 'countTable' or 'summaryTable',
depending on the 'type' parameter; with statistics in columns,
either if <code>type</code> is:
</p>

<ul>
<li><p>'summaryTable': 
</p>

<ul>
<li><p>'N': number of subjects
</p>
</li>
<li><p>'Mean': mean of <code>var</code>
</p>
</li>
<li><p>'SD': standard deviation of <code>var</code>
</p>
</li>
<li><p>'SE': standard error of <code>var</code>
</p>
</li>
<li><p>'Median': median of <code>var</code>
</p>
</li>
<li><p>'Min': minimum of <code>var</code>
</p>
</li>
<li><p>'Max': maximum of <code>var</code>
</p>
</li>
<li><p>'m': number of records
</p>
</li></ul>


</li>
<li><p>'countTable': 
</p>

<ul>
<li><p>'N': number of subjects
</p>
</li>
<li><p>'m': number of records
</p>
</li></ul>


</li></ul>



<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='computeSummaryStatisticsTable'>Compute summary statistics for a specific dataset and variables of interest</h2><span id='topic+computeSummaryStatisticsTable'></span>

<h3>Description</h3>

<p>Compute summary statistics for a specific dataset and variables of interest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeSummaryStatisticsTable(
  data,
  var = NULL,
  varFlag = NULL,
  varInclude0 = FALSE,
  varLab = NULL,
  varLabInclude = length(var) &gt; 1,
  varGeneralLab = "Variable",
  varSubgroupLab = "Variable group",
  varIgnore = NULL,
  varIncludeTotal = FALSE,
  varTotalInclude = FALSE,
  varTotalInSepRow = FALSE,
  colVar = NULL,
  colVarDataLevels = NULL,
  colVarTotal = colVar,
  colVarTotalPerc = colVarTotal,
  colTotalInclude = FALSE,
  colTotalLab = "Total",
  colInclude0 = FALSE,
  rowVar = NULL,
  rowVarDataLevels = NULL,
  rowVarLab = NULL,
  rowOrder = "auto",
  rowOrderTotalFilterFct = NULL,
  rowOrderCatLast = NULL,
  rowVarTotalInclude = NULL,
  rowVarTotalInSepRow = NULL,
  rowVarTotalByVar = NULL,
  rowVarTotalPerc = NULL,
  rowInclude0 = FALSE,
  type = "auto",
  subjectVar = "USUBJID",
  dataTotal = NULL,
  dataTotalPerc = dataTotal,
  dataTotalRow = NULL,
  dataTotalCol = NULL,
  stats = NULL,
  statsVarBy = NULL,
  statsExtra = NULL,
  statsGeneralLab = "Statistic",
  statsPerc = c("statN", "statm"),
  filterFct = NULL,
  labelVars = NULL,
  byVar = NULL,
  byVarLab = NULL,
  checkVarDiffBySubj = "error"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeSummaryStatisticsTable_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) of <code>data</code>, 
to compute statistics on.<br />
If NULL (by default), counts by row/column variable(s) are computed.<br />
To also return counts of the <code>rowVar</code> in case other <code>var</code>
are specified, you can include: 'all' in the <code>var</code>.<br />
Missing values, if present, are filtered 
(also for the report of number of subjects/records).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_varflag">varFlag</code></td>
<td>
<p>Character vector, subset of <code>var</code> with variable(s) 
of type 'flag' (with 'Y', 'N' or &rdquo; for empty/non specified value).
Only the counts for records flagged (with 'Y') are retained.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_varinclude0">varInclude0</code></td>
<td>
<p>Logical, should rows with no counts 
for the count <code>var</code> or <code>varFlag</code> variable(s)
be included in the table?
Either:
</p>

<ul>
<li><p>logical of length 1, if TRUE (FALSE by default) 
rows with no count are included for all <code>var</code>

</p>
</li>
<li><p>a character vector containing categorical <code>var</code> 
for which zero counts rows should be included
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_varlab">varLab</code></td>
<td>
<p>Named character vector with label for each variable 
specified in <code>var</code>.
By default, extracted from the <code>labelVars</code>.
if not available, <code>var</code> is used.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_varlabinclude">varLabInclude</code></td>
<td>
<p>Logical, if TRUE
the name of the summary statistic variable(s) (<code>var</code>)
are included in the table.
This is automatically set to TRUE if more than one variable(s) 
and is specified, and FALSE if only one variable is specified.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_vargenerallab">varGeneralLab</code></td>
<td>
<p>String with general label for variable specified in <code>var</code>.
In case of multiple variable in <code>var</code>, this will be included in the table header
(see 'rowVarLab' attribute of the output).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_varsubgrouplab">varSubgroupLab</code></td>
<td>
<p>String with general label for sub-group of
categorical variable(s) for count table, 'Variable group' by default.
This will be included in the final table header (see 'rowVarLab' attribute of the output).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_varignore">varIgnore</code></td>
<td>
<p>Vector with elements to ignore in the <code>var</code> variable(s).
The <code>data</code> records with such elements in <code>var</code> are <strong>filtered</strong> from the data 
at the start of the workflow.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_varincludetotal">varIncludeTotal</code></td>
<td>
<p>This argument is deprecated, please use: 'varTotalInclude' instead.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_vartotalinclude">varTotalInclude</code></td>
<td>
<p>Should the total across all categories of <code>var</code> 
be included for the count table?
Only used for categorical variables (and <code>var</code> not 'all').
Either:
</p>

<ul>
<li><p>logical of length 1, if TRUE (FALSE by default) include the total for all categorical <code>var</code>
</p>
</li>
<li><p>a character vector containing categorical <code>var</code> for which the total should be included
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_vartotalinseprow">varTotalInSepRow</code></td>
<td>
<p>Logical, should the total per variable be included in
a separated row (by default) or in the row containing the header of the variable?</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_colvardatalevels">colVarDataLevels</code></td>
<td>
<p>Data.frame with unique combinations of <code>colVar</code>
to be included in columns.
Each column should correspond to <code>colVar</code> and as factor
if the elements should be ordered in the final table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_colvartotal">colVarTotal</code></td>
<td>
<p>String with column(s) considered to compute the total by,
reported in the header of the table, by default same as <code>colVar</code>.
Use: 'variable' to compute total by <code>var</code> (if multiple).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_colvartotalperc">colVarTotalPerc</code></td>
<td>
<p>String with column(s) considered to compute the total by,
used as denominator for the percentage computation, by default same as <code>colVarTotal</code>.
Use: 'variable' to compute total by <code>var</code> (if multiple).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_coltotalinclude">colTotalInclude</code></td>
<td>
<p>Logical, if TRUE (FALSE by default) include the summary 
statistics across columns in a separated column.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_coltotallab">colTotalLab</code></td>
<td>
<p>String, label for the total column  'Total' by default.<br /></p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_colinclude0">colInclude0</code></td>
<td>
<p>Logical, if TRUE (FALSE by default),
include columns with no records, based on all combinations 
of the <code>columnVar</code> (assuming nested variable(s)).
If variable(s) are not nested, possible combinations
can be specified via <code>colVarDataLevels</code>.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowvardatalevels">rowVarDataLevels</code></td>
<td>
<p>Data.frame with unique combinations of <code>rowVar</code>
to be included in columns.
Each column should correspond to <code>colVar</code> and as factor
if the elements should be ordered in the final table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowvarlab">rowVarLab</code></td>
<td>
<p>Named character vector with 
label for the <code>rowVar</code> variable(s).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_roworder">rowOrder</code></td>
<td>
<p>Specify how the rows should be ordered in the final table, either a:
</p>

<ul>
<li><p>String among:
</p>

<ul>
<li><p>'auto' (by default): if the variable is a factor, keep its order, otherwise order alphabetically
</p>
</li>
<li><p>'alphabetical': order alphabetically
</p>
</li>
<li><p>'total': order rows in decreasing order of the total number of subjects
across all columns for this specific category.
</p>
</li></ul>

</li>
<li><p>Function with input the summary table and output the ordered elements of the <code>rowVar</code>
</p>
</li></ul>

<p>To specify different ordering methods for different <code>rowVar</code>, specify a list
of such elements, named with the <code>rowVar</code> variable.
For the table output of <code><a href="#topic+computeSummaryStatisticsTable">computeSummaryStatisticsTable</a></code> (long format),
this order is also reflected in the <strong><code>levels</code></strong> of the row factor variable.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowordertotalfilterfct">rowOrderTotalFilterFct</code></td>
<td>
<p>Function used to filter the data used to order the rows
based on total counts (in case <code>rowOrder</code> is 'total'),
To order rows based on one specific column category,
e.g. to order based on the counts in the treatment column:
function(x) subset(x, TRTP == &quot;treatmentX&quot;)</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowordercatlast">rowOrderCatLast</code></td>
<td>
<p>String with category to be printed in the last 
row of each <code>rowVar</code> (if any, set to NULL if none).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowvartotalinclude">rowVarTotalInclude</code></td>
<td>
<p>Character vector with <code>rowVar</code>
for which the total should be reported.<br />
If the higher row variable is specified, the total across all rows
is reported. <br />
For the export, these variable(s) are formatted as factor with 
<strong>'Total' as the first level</strong>.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowvartotalinseprow">rowVarTotalInSepRow</code></td>
<td>
<p>Character vector with <code>rowVarTotalInclude</code>
(not in <code>rowVarInSepCol</code>) for which the total should be included in a separated row labelled 'Total'.
Otherwise (by default) the total is included in the header row of each category.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowvartotalbyvar">rowVarTotalByVar</code></td>
<td>
<p>Character vector with a row variable
used to categorize the row total.<br />
Note that this is only used if row total(s) is/are requested via <code>rowVarTotalInclude</code>,
and this variable should also be included in <code>rowVar</code>.
This can be specified also for a specific row variable if the vector is named.<br />
For example: <code>c(ADECOD = "AESEV")</code> to compute total by severity 
for row adverse event term in a typical adverse event count table 
(by System Organ Class and Adverse Event Term).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowvartotalperc">rowVarTotalPerc</code></td>
<td>
<p>Character vector with row variables by which the total
should be computed for the denominator for the percentage computation.
By default the total is only computed only by column (NULL by default).
If the total should be based on the total number of records per variable,
<code>rowVarTotalPerc</code> should be set to 'variable'.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_rowinclude0">rowInclude0</code></td>
<td>
<p>Logical, if TRUE (FALSE by default),
include rows with no records, based on all combinations 
of the <code>rowVar</code> (assuming nested variable(s)).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_type">type</code></td>
<td>
<p>String with type of table: 
</p>

<ul>
<li><p>'summaryTable': summary table with statistics for numeric variable
</p>
</li>
<li><p>'countTable': count table
</p>
</li>
<li><p>'auto' (by default): 'summaryTable' if the variable is numeric,
'countTable' otherwise
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_subjectvar">subjectVar</code></td>
<td>
<p>String, variable of <code>data</code> with subject ID,
'USUBJID' by default.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_datatotal">dataTotal</code></td>
<td>
<p>Data.frame used to extract the Total number of subject
per column in column header ('N = [X]').
It should contain the variables specified by <code>colVarTotal</code>.
If not specified, the total number of subjects is extracted from the <code>data</code>.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_datatotalperc">dataTotalPerc</code></td>
<td>
<p>Data.frame used to extract the total counts per column 
for the computation of the percentage.<br />
By default, <code>dataTotal</code> is used.<br />
It should contain the variables specified by <code>colVarTotalPerc</code>.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_datatotalrow">dataTotalRow</code></td>
<td>
<p>Data.frame used to extract the total count across all
elements of the row
variable, list of such data.frame for each <code>rowVar</code> variable.<br />
If the dataset is specified by row variable, the list should be named with:
variable X if the total across elements of variable X should be included.
By default, <code>data</code> is used.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_datatotalcol">dataTotalCol</code></td>
<td>
<p>Data.frame from which the total across columns is 
extracted (in case <code>colTotalInclude</code> is TRUE)
or list of such data.frame for each <code>rowVar</code> variable.<br />
If the dataset is specified by row variable, the list should be named with:
with:
</p>

<ul>
<li><p>last row variable: for the dataset used in the total column for 
the most nested row variable
</p>
</li>
<li><p>higher row variable (X+1): for the dataset used for the total column
and row total of X
</p>
</li>
<li><p>'total': for the dataset used for the total column and general row total
</p>
</li></ul>

<p>If only a subset of the variables is specified in this list, 
<code>data</code> is used for the remaining variable(s) (or 'total') if needed.<br />
This dataset (the one for 'total' if a list) is also used for:
</p>

<ul>
<li><p>the header of the total column in case <code>dataTotal</code> is
not specified
</p>
</li>
<li><p>the denominator of the percentages in the total column
in case <code>dataTotalPerc</code> is not specified
</p>
</li></ul>

<p>By default, <code>data</code> is used.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_stats">stats</code></td>
<td>
<p>(optional) Statistic(s) of interest to compute, either:
</p>

<ul>
<li><p>string with the name of a default set of statistics
available in the package, 
see section 'Formatted statistics' in
<code><a href="#topic+inTextSummaryTable-stats">in-text table statistics</a></code>.<br />
See the corresponding <code>type</code> parameter of the
<code><a href="#topic+getStatsData">getStatsData</a></code> for more information
on how the statistic is internally extracted.
</p>
</li>
<li><p>(expert mode) named list of language object (see <code><a href="base.html#topic+is.language">is.language</a></code>) 
of base summary statistics of interest, see section:
'Base statistics' in
<code><a href="#topic+inTextSummaryTable-stats">in-text table statistics</a></code>.<br />
The names are reported in the header.<br />
If <code>stats</code> if of length 1, the name of the summary statistic is not included
in the table.<br />
The statistics can be specified separately:
</p>

<ul>
<li><p>for each <code>var</code> (if multiple), 
by naming each element of the list:
<code>list(varName1 = list(...), varName2 = list())</code>

</p>
</li>
<li><p>and/or for each element in:
<code>statsVarBy</code>, by naming each sublist.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_statsvarby">statsVarBy</code></td>
<td>
<p>String with variable in <code>rowVar</code>/<code>colVar</code>
which the statistics should be computed by.<br />
In this case, <code>stats</code> (nested list or not) should be additionally nested
to specify the statistics for each element in <code>statsVarBy</code>.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_statsextra">statsExtra</code></td>
<td>
<p>(optional) Named list with functions for additional custom
statistics to be computed.<br />
Each function:
</p>

<ul>
<li><p>has as parameter, either: 'x': the variable (<code>var</code>) to compute
the summary statistic on or 'data': the entire dataset
</p>
</li>
<li><p>returns the corresponding summary statistic as a numeric vector
</p>
</li></ul>

<p>For example, to additionally compute the coefficient of variation, this can be set to:
<code>list(statCVPerc = function(x) sd(x)/mean(x)*100)</code> (or <code><a href="#topic+cv">cv</a></code>).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_statsgenerallab">statsGeneralLab</code></td>
<td>
<p>String with general label for statistics, 'Statistic' by default.
Only included if no <code>statsVar</code> if longer than 1.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_statsperc">statsPerc</code></td>
<td>
<p>String with 'base statistical variable' used to compute the 
percentage, either: 
</p>

<ul>
<li><p>'statN' (by default): the number of subjects
</p>
</li>
<li><p>'statm': the number of records
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_filterfct">filterFct</code></td>
<td>
<p>(optional) Function taking as input
the summary table with computed statistics and returning a subset 
of the summary table.<br />
Note: The filtering function should also handle records with :
</p>

<ul>
<li><p>total for the column header: <code>isTotal</code> set to TRUE,
and <code>colVar</code>/<code>rowVar</code> is NA.<br />
For example: <code>filterFct = function(data) subset(data, isTotal &amp; myColVar == "group 1")</code>

</p>
</li>
<li><p><code>rowVar</code>/<code>colVar</code> set to 'Total'/<code>colTotalLab</code> 
if <code>rowVarTotalInclude</code>/<code>colTotalInclude</code> is specified
</p>
</li></ul>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_byvar">byVar</code></td>
<td>
<p>Variable(s) of <code>data</code> for which separated table(s)
should be created.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_byvarlab">byVarLab</code></td>
<td>
<p>String with label for <code>byVar</code>, used to set the names
of the output list of table(s).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTable_+3A_checkvardiffbysubj">checkVarDiffBySubj</code></td>
<td>
<p>String, 'error' (default), 'warning',
or 'none'.  
Should an error, a warning, or nothing be produced
if a continuous variable (<code>var</code>) contains
different values for the same subject (by row/column)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object <code><a href="#topic+summaryTable">summaryTable</a></code>
or list of such objects if
<code>byVar</code> is specified.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='computeSummaryStatisticsTableTotal'>Compute summary statistics total table.</h2><span id='topic+computeSummaryStatisticsTableTotal'></span>

<h3>Description</h3>

<p>Compute summary statistics total table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeSummaryStatisticsTableTotal(
  data,
  colVar = NULL,
  colVarTotal = colVar,
  rowVarTotal = NULL,
  var = NULL,
  varLab = getLabelVar(var, data = data, labelVars = labelVars),
  colTotalLab = "Total",
  colInclude0 = FALSE,
  colTotalInclude = FALSE,
  dataTotalCol = NULL,
  colVarDataLevels = NULL,
  colVarLevels = NULL,
  subjectVar = "USUBJID",
  labelVars = NULL,
  msgLabel = "total",
  checkVarDiffBySubj = "error"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_colvartotal">colVarTotal</code></td>
<td>
<p>Character vector with column(s) considered to compute the total.
This could also contain 'variable'.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_rowvartotal">rowVarTotal</code></td>
<td>
<p>Character vector with row(s) considered to compute the total.
This could also contain 'variable'.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) of <code>data</code>, 
to compute statistics on.<br />
If NULL (by default), counts by row/column variable(s) are computed.<br />
To also return counts of the <code>rowVar</code> in case other <code>var</code>
are specified, you can include: 'all' in the <code>var</code>.<br />
Missing values, if present, are filtered 
(also for the report of number of subjects/records).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_coltotallab">colTotalLab</code></td>
<td>
<p>String, label for the total column  'Total' by default.<br /></p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_coltotalinclude">colTotalInclude</code></td>
<td>
<p>Logical, if TRUE (FALSE by default) include the summary 
statistics across columns in a separated column.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_datatotalcol">dataTotalCol</code></td>
<td>
<p>Data.frame from which the total across columns is 
extracted (in case <code>colTotalInclude</code> is TRUE).</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_colvarlevels">colVarLevels</code></td>
<td>
<p>list with levels of each <code>colVar</code></p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_subjectvar">subjectVar</code></td>
<td>
<p>String, variable of <code>data</code> with subject ID,
'USUBJID' by default.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
<tr><td><code id="computeSummaryStatisticsTableTotal_+3A_msglabel">msgLabel</code></td>
<td>
<p>(optional) String with label for the data ('total' by default), 
included in the message/warning for checks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with total table.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='convertSummaryStatisticsTableToFlextable'>Convert summary statistics table to flextable</h2><span id='topic+convertSummaryStatisticsTableToFlextable'></span>

<h3>Description</h3>

<p>Convert summary statistics table to flextable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertSummaryStatisticsTableToFlextable(
  summaryTable,
  colHeaderMerge = TRUE,
  landscape = (style == "presentation"),
  margin = 1,
  rowPadBase = 14.4,
  title = NULL,
  footer = NULL,
  style = "report",
  colorTable = getColorPaletteTable(style = style),
  fontname = switch(style, report = "Times", presentation = "Tahoma"),
  fontsize = switch(style, report = 8, presentation = 10),
  file = NULL,
  pageDim = NULL,
  columnsWidth = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_summarytable">summaryTable</code></td>
<td>
<p>A <code><a href="#topic+summaryTable">summaryTable</a></code> object.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_colheadermerge">colHeaderMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (FALSE by default) 
the column header is merged.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_landscape">landscape</code></td>
<td>
<p>(flextable output) Logical, if TRUE the file is in landscape format.<br />
By default: FALSE if <code>style</code> is 'report' and TRUE if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_margin">margin</code></td>
<td>
<p>(flextable output) Margin in the document in inches
(1 by default).
This is used to specify the width of the table, from:
[<code>pageDim[1]</code> - 2 * margin].</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_rowpadbase">rowPadBase</code></td>
<td>
<p>(flextable output) Base padding for row (in points), 
14.4 by default (corresponds to 0.2 inches)</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_title">title</code></td>
<td>
<p>Character vector with title(s) for the table.
Set to NULL (by default) if no title should be included.
If multiple are specified, specified for each element of <code>byVar</code> (in order of the levels).</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_footer">footer</code></td>
<td>
<p>(flextable output) Character vector with footer(s) for the table.
Set to NULL (by default) if no footer should be included.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_style">style</code></td>
<td>
<p>(flextable output) String with table style,
either 'report' or 'presentation'.
This parameter affects the fontsize, font family, color of the text and background, 
and table dimensions of the table.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_colortable">colorTable</code></td>
<td>
<p>(flextable output) Named character vector with color for the table background/body/text/line,
e.g. created with the <code><a href="#topic+getColorPaletteTable">getColorPaletteTable</a></code> function.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_fontname">fontname</code></td>
<td>
<p>(flextable output) String with font name, by default:
'Times' if <code>style</code> is 'report' and 'Tahoma' if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_fontsize">fontsize</code></td>
<td>
<p>(flextable output) Integer with font size, by default:
8 if <code>style</code> is 'report' and 10 if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_file">file</code></td>
<td>
<p>String with path of the file where the table should be exported.
The file should have the extension: '.html'.
If NULL, the summary table is not exported but only returned as output.
If <code>byVar</code> is specified, each table is exported to a separated
file with the suffix: 'file_[i].html' with i the index of the file.</p>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_pagedim">pageDim</code></td>
<td>
<p>Numeric vector of length 2 with page width and height.<br />
Depending on <code>outputType</code>:
</p>

<ul>
<li><p>'flextable': in inches
</p>
</li>
<li><p>'DT': in number of rows in the table.<br />
Currently only the height is used (e.g. <code>c(NA, 4)</code>)
</p>
</li></ul>
</td></tr>
<tr><td><code id="convertSummaryStatisticsTableToFlextable_+3A_columnswidth">columnsWidth</code></td>
<td>
<p>(expert mode) Column widths of the table. This is only used 
for flextable and DT tables.<br />
For flextable, note that the widths should be set to fit into the document page
(see <code><a href="#topic+getDimPage">getDimPage</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="flextable.html#topic+flextable">flextable</a></code> object with summary table
If <code>summaryTable</code> is a list of summary tables,
returns a list of <code><a href="flextable.html#topic+flextable">flextable</a></code>.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='convertVarFlag'>Convert flag variable to a format such as only the flagged records are counted
in the summary table.</h2><span id='topic+convertVarFlag'></span>

<h3>Description</h3>

<p>Convert flag variable to a format such as only the flagged records are counted
in the summary table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertVarFlag(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertVarFlag_+3A_x">x</code></td>
<td>
<p>Character or factor variable with flag variable,
should contain elements: 'Y' and 'N', or &rdquo; (for missing value).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted factor variable with levels: 'Y' &amp; 'N'.
Empty strings have been converted to NA.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='convertVarRowVarColVarToFactor'>Convert <code>rowVar</code>, <code>colVar</code> and character <code>var</code> in <code>data</code> to factor</h2><span id='topic+convertVarRowVarColVarToFactor'></span>

<h3>Description</h3>

<p>Convert <code>rowVar</code>, <code>colVar</code> and character <code>var</code> in <code>data</code> to factor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertVarRowVarColVarToFactor(data, rowVar = NULL, colVar = NULL, var = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertVarRowVarColVarToFactor_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="convertVarRowVarColVarToFactor_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="convertVarRowVarColVarToFactor_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="convertVarRowVarColVarToFactor_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) of <code>data</code>, 
to compute statistics on.<br />
If NULL (by default), counts by row/column variable(s) are computed.<br />
To also return counts of the <code>rowVar</code> in case other <code>var</code>
are specified, you can include: 'all' in the <code>var</code>.<br />
Missing values, if present, are filtered 
(also for the report of number of subjects/records).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updated <code>data</code>
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='convertVarToFactorWithOrder'>Convert a variable to a factor with levels in specified order.</h2><span id='topic+convertVarToFactorWithOrder'></span>

<h3>Description</h3>

<p>Convert a variable to a factor with levels in specified order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertVarToFactorWithOrder(
  data,
  var,
  otherVars = NULL,
  colVar = NULL,
  colTotalLab = "Total",
  method = c("auto", "alphabetical", "total"),
  totalFilterFct = NULL,
  totalVar = "statN",
  catLast = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertVarToFactorWithOrder_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="convertVarToFactorWithOrder_+3A_var">var</code></td>
<td>
<p>String with variable of <code>data</code> to sort.</p>
</td></tr>
<tr><td><code id="convertVarToFactorWithOrder_+3A_othervars">otherVars</code></td>
<td>
<p>Character vector with other variable(s) of <code>data</code>
considered in the specific dimension.</p>
</td></tr>
<tr><td><code id="convertVarToFactorWithOrder_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="convertVarToFactorWithOrder_+3A_coltotallab">colTotalLab</code></td>
<td>
<p>String, label for the total column  'Total' by default.<br /></p>
</td></tr>
<tr><td><code id="convertVarToFactorWithOrder_+3A_method">method</code></td>
<td>
<p>Ordering method to use, either:
</p>

<ul>
<li><p>String among:
</p>

<ul>
<li><p>'auto': if <code>var</code> is a factor, keep its order, otherwise alphabetically
</p>
</li>
<li><p>'alphabetical': <code>var</code> is order in alphabetical order
</p>
</li>
<li><p>'total': <code>var</code> is ordered based on the <code>totalVar</code> variable, in decreasing order.
The total count is extracted from the rows with all <code>otherVars</code> equal to 'Total'.
If no <code>otherVars</code> is specified, consider all rows.
</p>
</li></ul>


</li>
<li><p>Function to be applied on each subset to get the order elements of the variable
</p>
</li></ul>
</td></tr>
<tr><td><code id="convertVarToFactorWithOrder_+3A_totalfilterfct">totalFilterFct</code></td>
<td>
<p>(optional) Function which returns a subset of the data of interest,
to filter the total data considered for the ordering.</p>
</td></tr>
<tr><td><code id="convertVarToFactorWithOrder_+3A_totalvar">totalVar</code></td>
<td>
<p>String with variable of <code>data</code> considered in case <code>type</code> is 'total',
'statN' by default.</p>
</td></tr>
<tr><td><code id="convertVarToFactorWithOrder_+3A_catlast">catLast</code></td>
<td>
<p>String with last category (if any).
Set to NULL if no specific category should be included as last element.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Factor <code>var</code> variable of <code>data</code> with specified order.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='convertVectToBinary'>Convert vector to a bincode of 0/1
based on consecutive values in the vector.</h2><span id='topic+convertVectToBinary'></span>

<h3>Description</h3>

<p>Convert vector to a bincode of 0/1
based on consecutive values in the vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertVectToBinary(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertVectToBinary_+3A_x">x</code></td>
<td>
<p>Vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer vector of same length than <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c("group1", "group1", "group1", "group2", "group2", "group3", "group4", "group4")
convertVectToBinary(x = x)
</code></pre>

<hr>
<h2 id='createFlextableWithHeader'>Create a flextable, setting the column names to syntactic names
if it is not the case.</h2><span id='topic+createFlextableWithHeader'></span>

<h3>Description</h3>

<p>Create a flextable, setting the column names to syntactic names
if it is not the case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createFlextableWithHeader(
  data,
  headerDf = NULL,
  title = NULL,
  includeRownames = TRUE,
  colHeaderMerge = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createFlextableWithHeader_+3A_data">data</code></td>
<td>
<p>Data.frame with data.</p>
</td></tr>
<tr><td><code id="createFlextableWithHeader_+3A_headerdf">headerDf</code></td>
<td>
<p>(optional) Data.frame with header.
This should contain the same number of columns than <code>data</code>
(+ if <code>includeRownames</code> is TRUE) and optionally multiple rows. 
Neighbouring cells with same content
will be represented merged in the output.</p>
</td></tr>
<tr><td><code id="createFlextableWithHeader_+3A_title">title</code></td>
<td>
<p>Character vector with title(s) for the table.
Set to NULL (by default) if no title should be included.</p>
</td></tr>
<tr><td><code id="createFlextableWithHeader_+3A_includerownames">includeRownames</code></td>
<td>
<p>Logical, if TRUE (by default)
rownames are included in the <code><a href="flextable.html#topic+flextable">flextable</a></code> object.</p>
</td></tr>
<tr><td><code id="createFlextableWithHeader_+3A_colheadermerge">colHeaderMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (FALSE by default) 
the column header is merged.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with:
</p>

<ul>
<li><p>'ft': <code><a href="flextable.html#topic+flextable">flextable</a></code>
</p>
</li>
<li><p>'colsData': Named vector with original column names,
with names set to new syntactic names.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='cv'>Compute the percentage coefficient of variation,
(in a scale from 0 to 100).</h2><span id='topic+cv'></span>

<h3>Description</h3>

<p>The coefficient of variation is computed as:
<code class="reqn">\frac{\sigma(x)}{\bar{x}}*100</code>, with:
</p>

<ul>
<li><p><code class="reqn">\sigma(x)</code>: standard deviation of <code>x</code>
</p>
</li>
<li><p><code class="reqn">\bar{x}</code>: arithmetic mean of <code>x</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>cv(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="cv_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical, should NA value(s) be removed (FALSE by default)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of length 1 with coefficient of variation.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other stats utility functions: 
<code><a href="#topic+geomCV">geomCV</a>()</code>,
<code><a href="#topic+geomMean">geomMean</a>()</code>,
<code><a href="#topic+geomSD">geomSD</a>()</code>,
<code><a href="#topic+geomSE">geomSE</a>()</code>,
<code><a href="#topic+se">se</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># coefficient of variation of normal distribution tends to 100%
cv(rnorm(n = 1000, mean = 1, sd = 1))
</code></pre>

<hr>
<h2 id='export'>Export an object</h2><span id='topic+export'></span>

<h3>Description</h3>

<p>Export an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="export_+3A_...">...</code></td>
<td>
<p>Extra parameters for the corresponding
method.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+export.summaryTable">export.summaryTable</a></code>
to export <code><a href="#topic+summaryTable">summaryTable</a></code> objects.
</p>

<hr>
<h2 id='export.summaryTable'>Export a summary table to <code>docx</code>, <code>pptx</code> 
or <code>html</code> format (interactive table)</h2><span id='topic+export.summaryTable'></span><span id='topic+exportSummaryStatisticsTable'></span>

<h3>Description</h3>

<p>The use of <code>export</code> is recommended.<br />
<code>exportSummaryStatisticsTable</code> is retained for
back-compatibility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summaryTable'
export(...)

exportSummaryStatisticsTable(
  summaryTable,
  rowVar = getAttribute(summaryTable, "rowVar"),
  rowVarLab = getAttribute(summaryTable, "rowVarLab", default = getLabelVar(rowVar,
    labelVars = labelVars)),
  rowVarInSepCol = NULL,
  rowVarFormat = NULL,
  rowVarTotalInclude = getAttribute(summaryTable, "rowVarTotalInclude"),
  rowTotalLab = NULL,
  rowVarTotalInSepRow = getAttribute(summaryTable, "rowVarTotalInSepRow"),
  rowAutoMerge = TRUE,
  colVar = getAttribute(summaryTable, "colVar"),
  colTotalLab = getAttribute(summaryTable, "colTotalLab", default = "Total"),
  colHeaderTotalInclude = TRUE,
  colHeaderMerge = TRUE,
  statsVar = getAttribute(summaryTable, "statsVar"),
  statsLayout = getAttribute(summaryTable, "statsLayout", default = ifelse("DT" %in%
    outputType, "col", "row")),
  statsValueLab = "StatisticValue",
  statsLabInclude = NULL,
  emptyValue = "-",
  labelVars = NULL,
  file = NULL,
  title = NULL,
  outputType = "flextable",
  pageDim = NULL,
  columnsWidth = NULL,
  landscape = (style == "presentation"),
  margin = 1,
  rowPadBase = 14.4,
  footer = NULL,
  style = "report",
  colorTable = getColorPaletteTable(style = style),
  fontsize = switch(style, report = 8, presentation = 10),
  fontname = switch(style, report = "Times", presentation = "Tahoma"),
  vline = "none",
  hline = "auto",
  expandVar = NULL,
  noEscapeVar = NULL,
  barVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="export.summaryTable_+3A_...">...</code></td>
<td>
<p>(DT output) Extra parameters passed to the 
<code><a href="clinUtils.html#topic+getClinDT">getClinDT</a></code></p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_summarytable">summaryTable</code></td>
<td>
<p>A <code><a href="#topic+summaryTable">summaryTable</a></code> object.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowvarlab">rowVarLab</code></td>
<td>
<p>Named character vector with 
label for the <code>rowVar</code> variable(s).</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowvarinsepcol">rowVarInSepCol</code></td>
<td>
<p>Character vector with <code>rowVar</code>
that should be included in separated columns.
By default (NULL), all row variables are nested in the first column 
of the table.<br />
To include the groups within a <code>var</code> variable in a separated column, 
set: <code>rowVarInSepCol == 'variableGroup'</code>.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowvarformat">rowVarFormat</code></td>
<td>
<p>(flextable output) Named list with special formatting for the <code>rowVar</code>.
Currently, only possibility is to set the variable elements in bold, with:
list(var1 = &quot;bold&quot;).
(Use 'variable' for <code>var</code> or 'variableGroup' for group within categorical variables.)</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowvartotalinclude">rowVarTotalInclude</code></td>
<td>
<p>Character vector with <code>rowVar</code>
for which the total should be reported.<br />
If the higher row variable is specified, the total across all rows
is reported. <br />
For the export, these variable(s) are formatted as factor with 
<strong>'Total' as the first level</strong>.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowtotallab">rowTotalLab</code></td>
<td>
<p>(flextable output) string with label for the row with total.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowvartotalinseprow">rowVarTotalInSepRow</code></td>
<td>
<p>Character vector with <code>rowVarTotalInclude</code>
(not in <code>rowVarInSepCol</code>) for which the total should be included in a separated row labelled 'Total'.
Otherwise (by default) the total is included in the header row of each category.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowautomerge">rowAutoMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (by default) automatically merge rows,
e.g. in case there is only one sub-category (e.g. categorical variable with only one group)
or only one statistic per category.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_coltotallab">colTotalLab</code></td>
<td>
<p>String, label for the total column  'Total' by default.<br /></p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_colheadertotalinclude">colHeaderTotalInclude</code></td>
<td>
<p>Logical, if TRUE include the total of number of patients
(<code>'statN'</code>) in the column header.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_colheadermerge">colHeaderMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (FALSE by default) 
the column header is merged.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_statsvar">statsVar</code></td>
<td>
<p>Character vector with columns of <code>summaryTable</code> with
statistic variables. For the export: if not specified, all columns of <code>data</code>
besides row, column variables, 'variable', 'variableGroup'
and 'isTotal' are considered.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_statslayout">statsLayout</code></td>
<td>
<p>String with layout for the statistics names 
(in case more than one statistic is included), among:
</p>

<ul>
<li><p>row (by default for 'flextable' output): <br /> All statistics are
included in different rows in the first column of the table (after the row variable(s))
</p>
</li>
<li><p>'col' (by default for 'DT' output): <br /> Statistics are included 
in separated columns (last row of the header).<br />
This option is not compatible with categorical variable(s).
</p>
</li>
<li><p>'rowInSepCol': <br /> Statistics are included in different rows, 
but in a separated column than the <code>rowVar</code> variable(s)
</p>
</li></ul>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_statsvaluelab">statsValueLab</code></td>
<td>
<p>String with label for the statistic value, 
'StatisticValue' by default.<br />
This is only included in the table if the statistics provided in 
<code>stats</code> are not named and if no <code>colVar</code> is specified.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_statslabinclude">statsLabInclude</code></td>
<td>
<p>Logical, if TRUE include the statistic label
in the table. <br /> By default only included if more than
one statistic variables are available in the table.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_emptyvalue">emptyValue</code></td>
<td>
<p>String with placeholder used to fill the table for missing values, '-' by default.
This value is typically used e.g. if not all statistics are computed for all specified
row/col/var variables.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_file">file</code></td>
<td>
<p>(Optional) Name of the file the table should be exported to, 
either:
</p>

<ul>
<li><p>string (of length 1). In this case, depending on the
file extension, the following is exported: 
</p>

<ul>
<li><p>'txt': summary table in long format ('data.frame-base' <code>outputType</code>)
</p>
</li>
<li><p>'docx': summary table in final format is exported ('flextable' <code>outputType</code>)
</p>
</li>
<li><p>'html': interactive summary table is exported ('DT' <code>outputType</code>)
</p>
</li></ul>

</li>
<li><p>named character vector in case of multiple exports.
The names should correspond to the options in <code>outputType</code>:
</p>

<ul>
<li><p>for 'data.frame-base' and 'data.frame': filename with 'txt' extension
</p>
</li>
<li><p>for 'flextable': filename with 'docx' extension
</p>
</li>
<li><p>for 'DT': filename with 'html' extension
</p>
</li></ul>

</li></ul>

<p>If NULL (by default), the summary table is not exported but only returned as output.
If <code>byVar</code> is specified, each table is exported to a separated
file with the suffix: 'file_[i].[ext]' with i the index of the file
(and [ext] the file extension).</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_title">title</code></td>
<td>
<p>Character vector with title(s) for the table.
Set to NULL (by default) if no title should be included.
If multiple are specified, specified for each element of <code>byVar</code> (in order of the levels).</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_outputtype">outputType</code></td>
<td>
<p>String with output type:
</p>

<ul>
<li><p>'flextable' (by default): <code><a href="flextable.html#topic+flextable">flextable</a></code> object, with format for
CSR, compatible with Word/PowerPoint export
</p>
</li>
<li><p>'DT': <code><a href="DT.html#topic+datatable">datatable</a></code> interactive table,
compatible with html export
</p>
</li>
<li><p>'data.frame': data.frame in wide format (with elements in 
<code>colVar</code> in different columns)
</p>
</li>
<li><p>'data.frame-base': data.frame in long format (with elements in 
<code>colVar</code> in different rows), useful for QC
</p>
</li></ul>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_pagedim">pageDim</code></td>
<td>
<p>Numeric vector of length 2 with page width and height.<br />
Depending on <code>outputType</code>:
</p>

<ul>
<li><p>'flextable': in inches
</p>
</li>
<li><p>'DT': in number of rows in the table.<br />
Currently only the height is used (e.g. <code>c(NA, 4)</code>)
</p>
</li></ul>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_columnswidth">columnsWidth</code></td>
<td>
<p>(expert mode) Column widths of the table. This is only used 
for flextable and DT tables.<br />
For flextable, note that the widths should be set to fit into the document page
(see <code><a href="#topic+getDimPage">getDimPage</a></code>).</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_landscape">landscape</code></td>
<td>
<p>(flextable output) Logical, if TRUE the file is in landscape format.<br />
By default: FALSE if <code>style</code> is 'report' and TRUE if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_margin">margin</code></td>
<td>
<p>(flextable output) Margin in the document in inches
(1 by default).
This is used to specify the width of the table, from:
[<code>pageDim[1]</code> - 2 * margin].</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_rowpadbase">rowPadBase</code></td>
<td>
<p>(flextable output) Base padding for row (in points), 
14.4 by default (corresponds to 0.2 inches)</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_footer">footer</code></td>
<td>
<p>(flextable output) Character vector with footer(s) for the table.
Set to NULL (by default) if no footer should be included.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_style">style</code></td>
<td>
<p>(flextable output) String with table style,
either 'report' or 'presentation'.
This parameter affects the fontsize, font family, color of the text and background, 
and table dimensions of the table.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_colortable">colorTable</code></td>
<td>
<p>(flextable output) Named character vector with color for the table background/body/text/line,
e.g. created with the <code><a href="#topic+getColorPaletteTable">getColorPaletteTable</a></code> function.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_fontsize">fontsize</code></td>
<td>
<p>(flextable output) Integer with font size, by default:
8 if <code>style</code> is 'report' and 10 if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_fontname">fontname</code></td>
<td>
<p>(flextable output) String with font name, by default:
'Times' if <code>style</code> is 'report' and 'Tahoma' if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_vline">vline</code></td>
<td>
<p>(flextable output) String mentioning how vertical lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none' (default): no vertical lines included
</p>
</li>
<li><p>'auto': vertical lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_hline">hline</code></td>
<td>
<p>(flextable output) String mentioning how horizontal lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none': no horizontal lines included
</p>
</li>
<li><p>'auto' (default): horizontal lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_expandvar">expandVar</code></td>
<td>
<p>(DT output) Character vector with variables of the summary table which
should be expanded in the data.</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_noescapevar">noEscapeVar</code></td>
<td>
<p>(DT output) Character vector with variables of <code>summaryTable</code>
which shouldn't be escaped in the table (e.g. containing URLs).</p>
</td></tr>
<tr><td><code id="export.summaryTable_+3A_barvar">barVar</code></td>
<td>
<p>(DT output) Character vector with variables of <code>summaryTable</code>
that should be represented as a bar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the <code>outputType</code>:
</p>

<ul>
<li><p>'data.frame-base': input summary table in a long format with
all computed statistics
</p>
</li>
<li><p>'data.frame': summary table in a wide format (
different columns for each <code>colVar</code>), with specified labels
</p>
</li>
<li><p>'flextable' (by default): <code><a href="flextable.html#topic+flextable">flextable</a></code>
object with summary table
</p>
</li>
<li><p>'DT': <code><a href="DT.html#topic+datatable">datatable</a></code> object with summary table
</p>
</li></ul>

<p>If multiple <code>outputType</code> are specified, a list of those objects, named
by <code>outputType</code>.<br />
If <code>byVar</code> is specified, each object consists of a list of tables,
one for each element in <code>byVar</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>export(summaryTable)</code>: export <code><a href="#topic+summaryTable">summaryTable</a></code> object
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='exportFlextableToDocx'>Export flextable to docx file</h2><span id='topic+exportFlextableToDocx'></span>

<h3>Description</h3>

<p>Export flextable to docx file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exportFlextableToDocx(
  object,
  file,
  landscape = FALSE,
  breaksAfter = if (!inherits(object, "flextable")) seq_along(object) else 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exportFlextableToDocx_+3A_object">object</code></td>
<td>
<p><code><a href="flextable.html#topic+flextable">flextable</a></code> object, or list of such objects</p>
</td></tr>
<tr><td><code id="exportFlextableToDocx_+3A_file">file</code></td>
<td>
<p>String with path of the file where the table should be exported.
The file should have the extension: '.html'.
If NULL, the summary table is not exported but only returned as output.
If <code>byVar</code> is specified, each table is exported to a separated
file with the suffix: 'file_[i].html' with i the index of the file.</p>
</td></tr>
<tr><td><code id="exportFlextableToDocx_+3A_landscape">landscape</code></td>
<td>
<p>(flextable output) Logical, if TRUE the file is in landscape format.<br />
By default: FALSE if <code>style</code> is 'report' and TRUE if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="exportFlextableToDocx_+3A_breaksafter">breaksAfter</code></td>
<td>
<p>In case <code>object</code> is list: 
integer vector with indices of list item after which a page break should 
be included in the final document.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no returned value, the <code>object</code> is exported to a docx file.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='exportSummaryStatisticsTableToDT'>Export summary table to an interactive DT table,
e.g. to be exported into an html document.</h2><span id='topic+exportSummaryStatisticsTableToDT'></span>

<h3>Description</h3>

<p>Export summary table to an interactive DT table,
e.g. to be exported into an html document.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exportSummaryStatisticsTableToDT(
  summaryTable,
  rowVar = getAttribute(summaryTable, "rowVar"),
  rowVarLab = getAttribute(summaryTable, "rowVarLab", default = getLabelVar(rowVar,
    labelVars = labelVars)),
  rowVarInSepCol = NULL,
  statsVar = getAttribute(summaryTable, "statsVar"),
  statsLayout = getAttribute(summaryTable, "statsLayout", default = "col"),
  statsValueLab = "StatisticValue",
  title = NULL,
  expandVar = NULL,
  noEscapeVar = NULL,
  barVar = NULL,
  pageDim = NULL,
  labelVars = NULL,
  file = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_summarytable">summaryTable</code></td>
<td>
<p>Summary table as provided by the 
<code><a href="#topic+formatSummaryStatisticsTable">formatSummaryStatisticsTable</a></code>.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_rowvarlab">rowVarLab</code></td>
<td>
<p>Named character vector with 
label for the <code>rowVar</code> variable(s).</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_rowvarinsepcol">rowVarInSepCol</code></td>
<td>
<p>Character vector with <code>rowVar</code>
that should be included in separated columns.
By default (NULL), all row variables are nested in the first column 
of the table.<br />
To include the groups within a <code>var</code> variable in a separated column, 
set: <code>rowVarInSepCol == 'variableGroup'</code>.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_statsvar">statsVar</code></td>
<td>
<p>Character vector with columns of <code>summaryTable</code> with
statistic variables. For the export: if not specified, all columns of <code>data</code>
besides row, column variables, 'variable', 'variableGroup'
and 'isTotal' are considered.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_statslayout">statsLayout</code></td>
<td>
<p>String with layout for the statistics names 
(in case more than one statistic is included), among:
</p>

<ul>
<li><p>row (by default for 'flextable' output): <br /> All statistics are
included in different rows in the first column of the table (after the row variable(s))
</p>
</li>
<li><p>'col' (by default for 'DT' output): <br /> Statistics are included 
in separated columns (last row of the header).<br />
This option is not compatible with categorical variable(s).
</p>
</li>
<li><p>'rowInSepCol': <br /> Statistics are included in different rows, 
but in a separated column than the <code>rowVar</code> variable(s)
</p>
</li></ul>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_statsvaluelab">statsValueLab</code></td>
<td>
<p>String with label for the statistic value, 
'StatisticValue' by default.<br />
This is only included in the table if the statistics provided in 
<code>stats</code> are not named and if no <code>colVar</code> is specified.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_title">title</code></td>
<td>
<p>Character vector with title(s) for the table.
Set to NULL (by default) if no title should be included.
If multiple are specified, specified for each element of <code>byVar</code> (in order of the levels).</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_expandvar">expandVar</code></td>
<td>
<p>(DT output) Character vector with variables of the summary table which
should be expanded in the data.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_noescapevar">noEscapeVar</code></td>
<td>
<p>(DT output) Character vector with variables of <code>summaryTable</code>
which shouldn't be escaped in the table (e.g. containing URLs).</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_barvar">barVar</code></td>
<td>
<p>(DT output) Character vector with variables of <code>summaryTable</code>
that should be represented as a bar.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_pagedim">pageDim</code></td>
<td>
<p>Numeric vector of length 2 with page width and height.<br />
Depending on <code>outputType</code>:
</p>

<ul>
<li><p>'flextable': in inches
</p>
</li>
<li><p>'DT': in number of rows in the table.<br />
Currently only the height is used (e.g. <code>c(NA, 4)</code>)
</p>
</li></ul>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_file">file</code></td>
<td>
<p>String with path of the file where the table should be exported.
The file should have the extension: '.docx'.
If NULL, the summary table is not exported but only returned as output.
If <code>byVar</code> is specified, each table is exported to a separated
file with the suffix: 'file_[i].docx' with i the index of the file.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToDT_+3A_...">...</code></td>
<td>
<p>(DT output) Extra parameters passed to the 
<code><a href="clinUtils.html#topic+getClinDT">getClinDT</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="DT.html#topic+datatable">datatable</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='exportSummaryStatisticsTableToFlextable'>Export summary table to a flextable object,
e.g. to be exported in Word or PowerPoint.</h2><span id='topic+exportSummaryStatisticsTableToFlextable'></span>

<h3>Description</h3>

<p>Export summary table to a flextable object,
e.g. to be exported in Word or PowerPoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exportSummaryStatisticsTableToFlextable(
  summaryTable,
  rowVar = getAttribute(summaryTable, "rowVar"),
  rowVarInSepCol = NULL,
  rowVarTotalInclude = getAttribute(summaryTable, "rowVarTotalInclude"),
  statsLayout = getAttribute(summaryTable, "statsLayout", default = "row"),
  statsVar = getAttribute(summaryTable, "statsVar"),
  statsLabInclude = getAttribute(summaryTable, "statsLabInclude", default =
    length(statsVar) &gt; 1),
  rowVarLab = getAttribute(summaryTable, "rowVarLab", default = getLabelVar(rowVar,
    labelVars = labelVars)),
  rowVarTotalInSepRow = NULL,
  vline = c("none", "auto"),
  hline = c("auto", "none"),
  rowAutoMerge = TRUE,
  rowVarFormat = NULL,
  rowTotalLab = NULL,
  colHeaderMerge = TRUE,
  landscape = (style == "presentation"),
  margin = 1,
  rowPadBase = 14.4,
  title = NULL,
  footer = NULL,
  style = "report",
  colorTable = getColorPaletteTable(style = style),
  fontname = switch(style, report = "Times", presentation = "Tahoma"),
  fontsize = switch(style, report = 8, presentation = 10),
  file = NULL,
  pageDim = NULL,
  columnsWidth = NULL,
  labelVars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_summarytable">summaryTable</code></td>
<td>
<p>Summary table as provided by the 
<code><a href="#topic+formatSummaryStatisticsTable">formatSummaryStatisticsTable</a></code></p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowvarinsepcol">rowVarInSepCol</code></td>
<td>
<p>Character vector with <code>rowVar</code>
that should be included in separated columns.
By default (NULL), all row variables are nested in the first column 
of the table.<br />
To include the groups within a <code>var</code> variable in a separated column, 
set: <code>rowVarInSepCol == 'variableGroup'</code>.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowvartotalinclude">rowVarTotalInclude</code></td>
<td>
<p>Character vector with <code>rowVar</code>
for which the total should be reported.<br />
If the higher row variable is specified, the total across all rows
is reported. <br />
For the export, these variable(s) are formatted as factor with 
<strong>'Total' as the first level</strong>.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_statslayout">statsLayout</code></td>
<td>
<p>String with layout for the statistics names 
(in case more than one statistic is included), among:
</p>

<ul>
<li><p>row (by default for 'flextable' output): <br /> All statistics are
included in different rows in the first column of the table (after the row variable(s))
</p>
</li>
<li><p>'col' (by default for 'DT' output): <br /> Statistics are included 
in separated columns (last row of the header).<br />
This option is not compatible with categorical variable(s).
</p>
</li>
<li><p>'rowInSepCol': <br /> Statistics are included in different rows, 
but in a separated column than the <code>rowVar</code> variable(s)
</p>
</li></ul>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_statsvar">statsVar</code></td>
<td>
<p>Character vector with columns of <code>summaryTable</code> with
statistic variables. For the export: if not specified, all columns of <code>data</code>
besides row, column variables, 'variable', 'variableGroup'
and 'isTotal' are considered.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_statslabinclude">statsLabInclude</code></td>
<td>
<p>Logical, if TRUE include the statistic label
in the table. <br /> By default only included if more than
one statistic variables are available in the table.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowvarlab">rowVarLab</code></td>
<td>
<p>Named character vector with 
label for the <code>rowVar</code> variable(s).</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowvartotalinseprow">rowVarTotalInSepRow</code></td>
<td>
<p>Character vector with <code>rowVarTotalInclude</code>
(not in <code>rowVarInSepCol</code>) for which the total should be included in a separated row labelled 'Total'.
Otherwise (by default) the total is included in the header row of each category.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_vline">vline</code></td>
<td>
<p>(flextable output) String mentioning how vertical lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none' (default): no vertical lines included
</p>
</li>
<li><p>'auto': vertical lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_hline">hline</code></td>
<td>
<p>(flextable output) String mentioning how horizontal lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none': no horizontal lines included
</p>
</li>
<li><p>'auto' (default): horizontal lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowautomerge">rowAutoMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (by default) automatically merge rows,
e.g. in case there is only one sub-category (e.g. categorical variable with only one group)
or only one statistic per category.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowvarformat">rowVarFormat</code></td>
<td>
<p>(flextable output) Named list with special formatting for the <code>rowVar</code>.
Currently, only possibility is to set the variable elements in bold, with:
list(var1 = &quot;bold&quot;).
(Use 'variable' for <code>var</code> or 'variableGroup' for group within categorical variables.)</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowtotallab">rowTotalLab</code></td>
<td>
<p>(flextable output) string with label for the row with total.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_colheadermerge">colHeaderMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (FALSE by default) 
the column header is merged.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_landscape">landscape</code></td>
<td>
<p>(flextable output) Logical, if TRUE the file is in landscape format.<br />
By default: FALSE if <code>style</code> is 'report' and TRUE if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_margin">margin</code></td>
<td>
<p>(flextable output) Margin in the document in inches
(1 by default).
This is used to specify the width of the table, from:
[<code>pageDim[1]</code> - 2 * margin].</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_rowpadbase">rowPadBase</code></td>
<td>
<p>(flextable output) Base padding for row (in points), 
14.4 by default (corresponds to 0.2 inches)</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_title">title</code></td>
<td>
<p>Character vector with title(s) for the table.
Set to NULL (by default) if no title should be included.
If multiple are specified, specified for each element of <code>byVar</code> (in order of the levels).</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_footer">footer</code></td>
<td>
<p>(flextable output) Character vector with footer(s) for the table.
Set to NULL (by default) if no footer should be included.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_style">style</code></td>
<td>
<p>(flextable output) String with table style,
either 'report' or 'presentation'.
This parameter affects the fontsize, font family, color of the text and background, 
and table dimensions of the table.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_colortable">colorTable</code></td>
<td>
<p>(flextable output) Named character vector with color for the table background/body/text/line,
e.g. created with the <code><a href="#topic+getColorPaletteTable">getColorPaletteTable</a></code> function.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_fontname">fontname</code></td>
<td>
<p>(flextable output) String with font name, by default:
'Times' if <code>style</code> is 'report' and 'Tahoma' if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_fontsize">fontsize</code></td>
<td>
<p>(flextable output) Integer with font size, by default:
8 if <code>style</code> is 'report' and 10 if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_file">file</code></td>
<td>
<p>String with path of the file where the table should be exported.
The file should have the extension: '.html'.
If NULL, the summary table is not exported but only returned as output.
If <code>byVar</code> is specified, each table is exported to a separated
file with the suffix: 'file_[i].html' with i the index of the file.</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_pagedim">pageDim</code></td>
<td>
<p>Numeric vector of length 2 with page width and height.<br />
Depending on <code>outputType</code>:
</p>

<ul>
<li><p>'flextable': in inches
</p>
</li>
<li><p>'DT': in number of rows in the table.<br />
Currently only the height is used (e.g. <code>c(NA, 4)</code>)
</p>
</li></ul>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_columnswidth">columnsWidth</code></td>
<td>
<p>(expert mode) Column widths of the table. This is only used 
for flextable and DT tables.<br />
For flextable, note that the widths should be set to fit into the document page
(see <code><a href="#topic+getDimPage">getDimPage</a></code>).</p>
</td></tr>
<tr><td><code id="exportSummaryStatisticsTableToFlextable_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="flextable.html#topic+flextable">flextable</a></code> object with summary table
If <code>summaryTable</code> is a list of summary tables,
returns a list of <code><a href="flextable.html#topic+flextable">flextable</a></code>.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='formatCustomFlextable'>Format superscript/subscripts/bold cells in a flextable.
Superscript should be indicated as: '<code>a^{b}</code>',
subscript as '<code>a_{b}</code>' and bold as '<code>bold{a}</code>' in the
the input summary table.</h2><span id='topic+formatCustomFlextable'></span>

<h3>Description</h3>

<p>Format superscript/subscripts/bold cells in a flextable.
Superscript should be indicated as: '<code>a^{b}</code>',
subscript as '<code>a_{b}</code>' and bold as '<code>bold{a}</code>' in the
the input summary table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatCustomFlextable(
  dataTable,
  ft,
  fontname = "Times",
  part = "body",
  fontsize = 8,
  iBase = 0,
  bold = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formatCustomFlextable_+3A_datatable">dataTable</code></td>
<td>
<p>data.frame with data used in table,
summary table for body or header data.frame for the header.</p>
</td></tr>
<tr><td><code id="formatCustomFlextable_+3A_ft">ft</code></td>
<td>
<p>Corresponding <code><a href="flextable.html#topic+flextable">flextable</a></code>.</p>
</td></tr>
<tr><td><code id="formatCustomFlextable_+3A_fontname">fontname</code></td>
<td>
<p>String with font name, 'Times' by default.</p>
</td></tr>
<tr><td><code id="formatCustomFlextable_+3A_part">part</code></td>
<td>
<p>string with part of the table to consider, 
see <code><a href="flextable.html#topic+compose">compose</a></code>.</p>
</td></tr>
<tr><td><code id="formatCustomFlextable_+3A_fontsize">fontsize</code></td>
<td>
<p>Integer with font size, 8 by default.</p>
</td></tr>
<tr><td><code id="formatCustomFlextable_+3A_ibase">iBase</code></td>
<td>
<p>Integer with base row index (if different than 0).</p>
</td></tr>
<tr><td><code id="formatCustomFlextable_+3A_bold">bold</code></td>
<td>
<p>Logical (FALSE by default) should the superscript/subscript 
be indicated in bold?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="flextable.html#topic+flextable">flextable</a></code> with superscript/subscript.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='formatPercentage'>Format a percentage.</h2><span id='topic+formatPercentage'></span>

<h3>Description</h3>

<p>The following rules are used:
</p>

<ul>
<li><p>percentage = 0%: '0'
</p>
</li>
<li><p> 0% &lt; percentage &lt; 0.1%: '&lt;0.1'
</p>
</li>
<li><p>99.9% &lt; percentage &lt; 100%: '&gt;99.9'
</p>
</li>
<li><p>percentage = 100%: '100'
</p>
</li>
<li><p>missing value (NA) (class without valid data): '-'
</p>
</li>
<li><p>other: 'x.x' (1 decimal)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>formatPercentage(x, nDec = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formatPercentage_+3A_x">x</code></td>
<td>
<p>Numeric vector with percentage(s)</p>
</td></tr>
<tr><td><code id="formatPercentage_+3A_ndec">nDec</code></td>
<td>
<p>Integer of length 1, number
of decimals used to round the percentage,
1 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String with formatted percentage
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other decimals: 
<code><a href="#topic+getMaxNDecimals">getMaxNDecimals</a>()</code>,
<code><a href="#topic+getMaxNDecimalsData">getMaxNDecimalsData</a>()</code>,
<code><a href="#topic+getNDecimals">getNDecimals</a>()</code>,
<code><a href="#topic+getNDecimalsData">getNDecimalsData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xPerc &lt;- c(NA, 0, 100, 99.95, 0.012, 34.768)
formatPercentage(x = xPerc)
</code></pre>

<hr>
<h2 id='formatSummaryStatisticsTable'>Format summary statistics table for export</h2><span id='topic+formatSummaryStatisticsTable'></span>

<h3>Description</h3>

<p>Format summary statistics table for export
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatSummaryStatisticsTable(
  summaryTable,
  rowVar = getAttribute(summaryTable, "rowVar"),
  colVar = getAttribute(summaryTable, "colVar"),
  colTotalLab = getAttribute(summaryTable, "colTotalLab", default = "Total"),
  colHeaderTotalInclude = TRUE,
  statsVar = getAttribute(summaryTable, "statsVar"),
  statsLabInclude = NULL,
  statsLayout = "row",
  statsValueLab = "StatisticValue",
  emptyValue = "-"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formatSummaryStatisticsTable_+3A_summarytable">summaryTable</code></td>
<td>
<p>A <code><a href="#topic+summaryTable">summaryTable</a></code> object.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_coltotallab">colTotalLab</code></td>
<td>
<p>String, label for the total column  'Total' by default.<br /></p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_colheadertotalinclude">colHeaderTotalInclude</code></td>
<td>
<p>Logical, if TRUE include the total of number of patients
(<code>'statN'</code>) in the column header.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_statsvar">statsVar</code></td>
<td>
<p>Character vector with columns of <code>summaryTable</code> with
statistic variables. For the export: if not specified, all columns of <code>data</code>
besides row, column variables, 'variable', 'variableGroup'
and 'isTotal' are considered.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_statslabinclude">statsLabInclude</code></td>
<td>
<p>Logical, if TRUE include the statistic label
in the table. <br /> By default only included if more than
one statistic variables are available in the table.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_statslayout">statsLayout</code></td>
<td>
<p>String with layout for the statistics names 
(in case more than one statistic is included), among:
</p>

<ul>
<li><p>row (by default for 'flextable' output): <br /> All statistics are
included in different rows in the first column of the table (after the row variable(s))
</p>
</li>
<li><p>'col' (by default for 'DT' output): <br /> Statistics are included 
in separated columns (last row of the header).<br />
This option is not compatible with categorical variable(s).
</p>
</li>
<li><p>'rowInSepCol': <br /> Statistics are included in different rows, 
but in a separated column than the <code>rowVar</code> variable(s)
</p>
</li></ul>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_statsvaluelab">statsValueLab</code></td>
<td>
<p>String with label for the statistic value, 
'StatisticValue' by default.<br />
This is only included in the table if the statistics provided in 
<code>stats</code> are not named and if no <code>colVar</code> is specified.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTable_+3A_emptyvalue">emptyValue</code></td>
<td>
<p>String with placeholder used to fill the table for missing values, '-' by default.
This value is typically used e.g. if not all statistics are computed for all specified
row/col/var variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summaryTable reformatted to wide format
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='formatSummaryStatisticsTableFlextable'>Merge nested rows of a summary table
for a format compatible with <code>flextable</code></h2><span id='topic+formatSummaryStatisticsTableFlextable'></span>

<h3>Description</h3>

<p>Merge nested rows of a summary table
for a format compatible with <code>flextable</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatSummaryStatisticsTableFlextable(
  summaryTable,
  rowVar = getAttribute(summaryTable, "rowVar"),
  rowVarInSepCol = NULL,
  rowVarTotalInclude = getAttribute(summaryTable, "rowVarTotalInclude"),
  statsLayout = "row",
  statsVar = getAttribute(summaryTable, "statsVar"),
  statsLabInclude = getAttribute(summaryTable, "statsLabInclude", default =
    length(statsVar) &gt; 1),
  rowVarLab = getAttribute(summaryTable, "rowVarLab", default = getLabelVar(rowVar,
    labelVars = labelVars)),
  rowVarTotalInSepRow = NULL,
  vline = c("none", "auto"),
  hline = c("none", "auto"),
  rowAutoMerge = TRUE,
  rowVarFormat = NULL,
  rowTotalLab = NULL,
  labelVars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_summarytable">summaryTable</code></td>
<td>
<p>A <code><a href="#topic+summaryTable">summaryTable</a></code> object.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_rowvarinsepcol">rowVarInSepCol</code></td>
<td>
<p>Character vector with <code>rowVar</code>
that should be included in separated columns.
By default (NULL), all row variables are nested in the first column 
of the table.<br />
To include the groups within a <code>var</code> variable in a separated column, 
set: <code>rowVarInSepCol == 'variableGroup'</code>.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_rowvartotalinclude">rowVarTotalInclude</code></td>
<td>
<p>Character vector with <code>rowVar</code>
for which the total should be reported.<br />
If the higher row variable is specified, the total across all rows
is reported. <br />
For the export, these variable(s) are formatted as factor with 
<strong>'Total' as the first level</strong>.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_statslayout">statsLayout</code></td>
<td>
<p>String with layout for the statistics names 
(in case more than one statistic is included), among:
</p>

<ul>
<li><p>row (by default for 'flextable' output): <br /> All statistics are
included in different rows in the first column of the table (after the row variable(s))
</p>
</li>
<li><p>'col' (by default for 'DT' output): <br /> Statistics are included 
in separated columns (last row of the header).<br />
This option is not compatible with categorical variable(s).
</p>
</li>
<li><p>'rowInSepCol': <br /> Statistics are included in different rows, 
but in a separated column than the <code>rowVar</code> variable(s)
</p>
</li></ul>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_statsvar">statsVar</code></td>
<td>
<p>Character vector with columns of <code>summaryTable</code> with
statistic variables. For the export: if not specified, all columns of <code>data</code>
besides row, column variables, 'variable', 'variableGroup'
and 'isTotal' are considered.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_statslabinclude">statsLabInclude</code></td>
<td>
<p>Logical, if TRUE include the statistic label
in the table. <br /> By default only included if more than
one statistic variables are available in the table.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_rowvarlab">rowVarLab</code></td>
<td>
<p>Named character vector with 
label for the <code>rowVar</code> variable(s).</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_rowvartotalinseprow">rowVarTotalInSepRow</code></td>
<td>
<p>Character vector with <code>rowVarTotalInclude</code>
(not in <code>rowVarInSepCol</code>) for which the total should be included in a separated row labelled 'Total'.
Otherwise (by default) the total is included in the header row of each category.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_vline">vline</code></td>
<td>
<p>(flextable output) String mentioning how vertical lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none' (default): no vertical lines included
</p>
</li>
<li><p>'auto': vertical lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_hline">hline</code></td>
<td>
<p>(flextable output) String mentioning how horizontal lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none': no horizontal lines included
</p>
</li>
<li><p>'auto' (default): horizontal lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_rowautomerge">rowAutoMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (by default) automatically merge rows,
e.g. in case there is only one sub-category (e.g. categorical variable with only one group)
or only one statistic per category.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_rowvarformat">rowVarFormat</code></td>
<td>
<p>(flextable output) Named list with special formatting for the <code>rowVar</code>.
Currently, only possibility is to set the variable elements in bold, with:
list(var1 = &quot;bold&quot;).
(Use 'variable' for <code>var</code> or 'variableGroup' for group within categorical variables.)</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_rowtotallab">rowTotalLab</code></td>
<td>
<p>(flextable output) string with label for the row with total.</p>
</td></tr>
<tr><td><code id="formatSummaryStatisticsTableFlextable_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summaryTable reformatted in long format, with extra attributes:
</p>

<ul>
<li><p>'header': data.frame with header for each column
</p>
</li>
<li><p>'padParams': list of list of parameters to be passed to the 
<code><a href="flextable.html#topic+padding">padding</a></code> function
</p>
</li>
<li><p>'rowVar': column of output with row variable
</p>
</li>
<li><p>'rowVarInSepCol': column(s) of output with row variable in separated column(s)
</p>
</li>
<li><p>'vlineParams' and 'hlineParams': 
list of list with correspondingly parameters for
vertical and horizontal lines

</p>
</li>
<li><p>'vline': <code>vline</code> parameter
</p>
</li>
<li><p>'formatParams': list of list with special formatting for the table,
currently only used if <code>rowVarFormat</code> if specified.
</p>
</li></ul>

<p>If <code>summaryTable</code> is a list of summary tables,
returns a list of corresponding summary tables in long format.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='geomCV'>Compute geometric coefficient of variation 
(in a scale from 0 to 100).</h2><span id='topic+geomCV'></span>

<h3>Description</h3>

<p>The geometric coefficient of variation is computed as:
<code class="reqn">\sqrt{\exp(\sigma(log(x))^2)-1}*100</code>, with:
</p>

<ul>
<li><p>log: natural logarithm
</p>
</li>
<li><p><code class="reqn">\sigma</code>: standard deviation
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>geomCV(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geomCV_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="geomCV_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical, should NA value(s) be removed (FALSE by default)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of length 1 with 
geometric coefficient of variation.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other stats utility functions: 
<code><a href="#topic+cv">cv</a>()</code>,
<code><a href="#topic+geomMean">geomMean</a>()</code>,
<code><a href="#topic+geomSD">geomSD</a>()</code>,
<code><a href="#topic+geomSE">geomSE</a>()</code>,
<code><a href="#topic+se">se</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Geometric coefficient of variation of a sample from a log normal distribution:
geomCV(rlnorm(n = 1000, meanlog = 0, sdlog = 1))
</code></pre>

<hr>
<h2 id='geomMean'>Compute geometric mean.</h2><span id='topic+geomMean'></span>

<h3>Description</h3>

<p>The geometric mean is computed as:
<code class="reqn">\exp(\bar{log(x)})</code>, with:
</p>

<ul>
<li><p>log: natural logarithm
</p>
</li>
<li><p><code class="reqn">\bar{log(x)}</code>: arithmetic mean of log(x)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>geomMean(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geomMean_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="geomMean_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical, should NA value(s) be removed (FALSE by default)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of length 1 with geometric mean.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other stats utility functions: 
<code><a href="#topic+cv">cv</a>()</code>,
<code><a href="#topic+geomCV">geomCV</a>()</code>,
<code><a href="#topic+geomSD">geomSD</a>()</code>,
<code><a href="#topic+geomSE">geomSE</a>()</code>,
<code><a href="#topic+se">se</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># geometric mean of a big sample from log normal distribution
# tends to the mean of the distribution:
geomMean(rlnorm(n = 1000, meanlog = 0, sdlog = 1))
</code></pre>

<hr>
<h2 id='geomSD'>Compute geometric standard deviation</h2><span id='topic+geomSD'></span>

<h3>Description</h3>

<p>The geometric standard deviation is computed as:
<code class="reqn">\exp(\sigma(log(x)))</code>, with:
</p>

<ul>
<li><p>log: natural logarithm
</p>
</li>
<li><p><code class="reqn">\sigma</code>: standard deviation
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>geomSD(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geomSD_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="geomSD_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical, should NA value(s) be removed (FALSE by default)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of length 1 with geometric mean.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other stats utility functions: 
<code><a href="#topic+cv">cv</a>()</code>,
<code><a href="#topic+geomCV">geomCV</a>()</code>,
<code><a href="#topic+geomMean">geomMean</a>()</code>,
<code><a href="#topic+geomSE">geomSE</a>()</code>,
<code><a href="#topic+se">se</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># geometric standard deviation of a sample from a log normal distribution:
geomSD(rlnorm(n = 1000, meanlog = 0, sdlog = 1))
</code></pre>

<hr>
<h2 id='geomSE'>Compute geometric standard error of the mean.</h2><span id='topic+geomSE'></span>

<h3>Description</h3>

<p>The geometric standard error of the mean is computed as:
<code class="reqn">\exp(se(log(x)</code>, with:
</p>

<ul>
<li><p>log: natural logarithm
</p>
</li>
<li><p><code class="reqn">se</code>: standard error of the mean, as computed with <code><a href="#topic+se">se</a></code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>geomSE(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geomSE_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="geomSE_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical, should NA value(s) be removed (FALSE by default)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of length 1 with 
geometric standard error of the mean.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other stats utility functions: 
<code><a href="#topic+cv">cv</a>()</code>,
<code><a href="#topic+geomCV">geomCV</a>()</code>,
<code><a href="#topic+geomMean">geomMean</a>()</code>,
<code><a href="#topic+geomSD">geomSD</a>()</code>,
<code><a href="#topic+se">se</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Geometric standard error of the mean of a sample from a log normal distribution:
geomSE(rlnorm(n = 1000, meanlog = 0, sdlog = 1))
</code></pre>

<hr>
<h2 id='getAttribute'>Get specific attribute from a summaryTable or a list of summaryTables</h2><span id='topic+getAttribute'></span>

<h3>Description</h3>

<p>Get specific attribute from a summaryTable or a list of summaryTables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAttribute(summaryTable, name, default = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAttribute_+3A_name">name</code></td>
<td>
<p>String with attribute name.</p>
</td></tr>
<tr><td><code id="getAttribute_+3A_default">default</code></td>
<td>
<p>Object with default value for attribute, 
NULL by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object with attribute, or <code>default</code> is doesn't
exists in <code>summaryTable</code>
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='getColorPaletteTable'>Get color palette for the tables</h2><span id='topic+getColorPaletteTable'></span>

<h3>Description</h3>

<p>This function gets the color palettes for the tables 
specified as global options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getColorPaletteTable(style = c("report", "presentation"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getColorPaletteTable_+3A_style">style</code></td>
<td>
<p>String with style of report. Either 'report' or
'presentation'. By default, the style is 'report'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, the function returns the palette of the package. 
The user can specify a custom palette by setting the global options.
</p>


<h3>Value</h3>

<p>A named vector with hex colors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># report style (the default)
getColorPaletteTable()
# presentation style
getColorPaletteTable(style = "presentation")
# custom palette
customColorTable &lt;- c('header' = "#FFFFFF",'headerBackground' = "#3F4788FF", 
'body' = "#000000", 'bodyBackground1' = "#D9D9D9", 'bodyBackground2' = "#D9D9D9", 
'footer' = "#000000", 'footerBackground' = "#FFFFFF",'line' = "#FFFFFF")
options(inTextSummaryTable.colors.table.presentation = customColorTable)
getColorPaletteTable("presentation")
</code></pre>

<hr>
<h2 id='getDimPage'>Get dimension of the page available for content 
for standard Word report or PowerPoint presentation.</h2><span id='topic+getDimPage'></span>

<h3>Description</h3>

<p>Report is in A4 and presentation dimensions extracted from
PowerPoint.
The returned dimensions are the page dimensions without the margins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDimPage(
  type = c("width", "height"),
  landscape = (style == "presentation"),
  margin = 1,
  pageDim = NULL,
  style = "report"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDimPage_+3A_type">type</code></td>
<td>
<p>Character vector with dimension of interest, among: 
'width', 'height', multiple are possible.
By default: <code>c("width", "height")</code></p>
</td></tr>
<tr><td><code id="getDimPage_+3A_landscape">landscape</code></td>
<td>
<p>Logical, if TRUE the table is presented in landscape
format. <br />
By default: TRUE for <code>style</code>: 'report',
FALSE for <code>style</code>: 'presentation'.</p>
</td></tr>
<tr><td><code id="getDimPage_+3A_margin">margin</code></td>
<td>
<p>Margin in the document in inches, 1 by default.</p>
</td></tr>
<tr><td><code id="getDimPage_+3A_pagedim">pageDim</code></td>
<td>
<p>(optional) Numeric vector of length 2 with 
page width and height in inches in portrait format,
in case page dimensions differ from the default
implemented report/presentation.
These dimensions should include the margins.</p>
</td></tr>
<tr><td><code id="getDimPage_+3A_style">style</code></td>
<td>
<p>String with table style, either 'report' (by default, a4 format) 
or 'presentation'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector with dimension of interest,
in the same order as specified via the <code>type</code>
parameter.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get part of the page available for content
# report A4 portrait format:
getDimPage(type = "width")
getDimPage(type = "height")
# report A4 landscape format:
getDimPage(type = "width", landscape = TRUE)
getDimPage(type = "height", landscape = TRUE)
# Note that the layout is by default set to 'landscape'
getDimPage(type = "width", style = "presentation")
getDimPage(type = "height", style = "presentation")
# custom dimensions: A3 format
getDimPage(type = "width", pageDim = c(11.7, 16.5))
# increase margin
getDimPage(type = "width", margin = 1.5)
# get both dimensions at once
getDimPage(type = c("width", "height"))
# get dimensions of the full page (including margins)
getDimPage(type = c("width", "height"), style = "report", margin = 0)
getDimPage(type = c("width", "height"), style = "presentation", margin = 0)
</code></pre>

<hr>
<h2 id='getListing'>Format or create flextable for listings.</h2><span id='topic+getListing'></span>

<h3>Description</h3>

<p>Flextable version &gt;= 0.4.7 and pandoc &gt;= 2.4
is required to included such table in a Rmarkdown document.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getListing(
  data,
  ft,
  border = TRUE,
  highlight = integer(),
  bgVar = NULL,
  fontname = switch(style, report = "Times", presentation = "Tahoma"),
  fontsize = switch(style, report = 8, presentation = 10),
  landscape = (style == "presentation"),
  style = "report",
  margin = 1,
  adjustWidth = TRUE,
  colorTable = getColorPaletteTable(style = style),
  align = TRUE,
  title = NULL,
  pageDim = NULL,
  includeRownames = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getListing_+3A_data">data</code></td>
<td>
<p>data.frame with data used in table.</p>
</td></tr>
<tr><td><code id="getListing_+3A_ft">ft</code></td>
<td>
<p>Corresponding <code><a href="flextable.html#topic+flextable">flextable</a></code>.</p>
</td></tr>
<tr><td><code id="getListing_+3A_border">border</code></td>
<td>
<p>Logical, if TRUE add a border.</p>
</td></tr>
<tr><td><code id="getListing_+3A_highlight">highlight</code></td>
<td>
<p>Integer vector with index(ices) of column(s) to highlight
(only applies for <code>style</code>: 'presentation').
0 for rownames (if present).
Colors for:
</p>

<ul>
<li><p>highlighted columns is specified in <code>colorTable["headerBackgroundHighlight"]</code>
</p>
</li>
<li><p>non highlighted columns is specified in <code>colorTable["headerBackground"]</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="getListing_+3A_bgvar">bgVar</code></td>
<td>
<p>String with the column of the <code>data</code> used for
alternating the body background colors of the table.</p>
</td></tr>
<tr><td><code id="getListing_+3A_fontname">fontname</code></td>
<td>
<p>String with font name, 'Times' by default.</p>
</td></tr>
<tr><td><code id="getListing_+3A_fontsize">fontsize</code></td>
<td>
<p>Integer with font size, 8 by default.</p>
</td></tr>
<tr><td><code id="getListing_+3A_landscape">landscape</code></td>
<td>
<p>Logical, if TRUE the table is presented in landscape
format. <br />
By default: TRUE for <code>style</code>: 'report',
FALSE for <code>style</code>: 'presentation'.</p>
</td></tr>
<tr><td><code id="getListing_+3A_style">style</code></td>
<td>
<p>String with table style, either 'report' (by default, a4 format) 
or 'presentation'</p>
</td></tr>
<tr><td><code id="getListing_+3A_margin">margin</code></td>
<td>
<p>Margin in the document in inches, 1 by default.</p>
</td></tr>
<tr><td><code id="getListing_+3A_adjustwidth">adjustWidth</code></td>
<td>
<p>Logical, if TRUE adjust column widths,
to comply to specification of <code>landscape</code>,
<code>margin</code> and <code>pageDim</code>
(only set to <code>FALSE</code> if e.g. table dimensions 
are pre-set with the specified <code>ft</code>).</p>
</td></tr>
<tr><td><code id="getListing_+3A_colortable">colorTable</code></td>
<td>
<p>Named character vector with color for the table,
see output of <code><a href="#topic+getColorPaletteTable">getColorPaletteTable</a></code> for required elements.</p>
</td></tr>
<tr><td><code id="getListing_+3A_align">align</code></td>
<td>
<p>Logical, if TRUE (by default), 
default alignment is set ('center' in all table).</p>
</td></tr>
<tr><td><code id="getListing_+3A_title">title</code></td>
<td>
<p>Character vector with title(s) for the table.
Set to NULL (by default) if no title should be included.
Only available if <code>ft</code> is not specified.</p>
</td></tr>
<tr><td><code id="getListing_+3A_pagedim">pageDim</code></td>
<td>
<p>(optional) Numeric vector of length 2 with 
page width and height in inches in portrait format,
in case page dimensions differ from the default
implemented report/presentation.
These dimensions should include the margins.</p>
</td></tr>
<tr><td><code id="getListing_+3A_includerownames">includeRownames</code></td>
<td>
<p>Logical, if TRUE (by default)
rownames are included in the <code><a href="flextable.html#topic+flextable">flextable</a></code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="flextable.html#topic+flextable">flextable</a></code> with style.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># style: report or presentation
getListing(data = head(mtcars), style = "report")
getListing(data = head(mtcars), style = "presentation")
# remove rownames (included by default)
getListing(data = head(mtcars), style = "presentation", includeRownames = FALSE)
# highlight:
#  all columns
getListing(data = head(mtcars), style = "presentation", highlight = seq_along(mtcars))
# rownames
getListing(data = head(mtcars), style = "presentation", highlight = 0)
# specific columns
getListing(data = head(mtcars), style = "presentation", highlight = c(2, 4))
</code></pre>

<hr>
<h2 id='getMaxNDecimals'>Get maximum number of decimals in a variable,
based on pre-defined rule and/or data.</h2><span id='topic+getMaxNDecimals'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+getNDecimals">getNDecimals</a></code>) extracts the number
of decimals in a specific variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMaxNDecimals(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMaxNDecimals_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="getMaxNDecimals_+3A_...">...</code></td>
<td>
<p>Any parameters for the <code><a href="#topic+getNDecimals">getNDecimals</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer with maximum number of decimals in a character vector.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other decimals: 
<code><a href="#topic+formatPercentage">formatPercentage</a>()</code>,
<code><a href="#topic+getMaxNDecimalsData">getMaxNDecimalsData</a>()</code>,
<code><a href="#topic+getNDecimals">getNDecimals</a>()</code>,
<code><a href="#topic+getNDecimalsData">getNDecimalsData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0.99, 5.679, 50.45, 1450)
# extract max number of decimals based on data:
getMaxNDecimals(x, useRule = FALSE, useData = TRUE)
# extract max number of decimals based on pre-defined rule:
getMaxNDecimals(x, useRule = TRUE, useData = FALSE)
# extract max number of decimals based on both rules
# minimum of both is used (by default)
getMaxNDecimals(x, useRule = TRUE, useData = TRUE)
</code></pre>

<hr>
<h2 id='getMaxNDecimalsData'>Get maximum number of decimals in a variable based on the data
(<code><a href="#topic+getNDecimalsData">getNDecimalsData</a></code>)</h2><span id='topic+getMaxNDecimalsData'></span>

<h3>Description</h3>

<p>Get maximum number of decimals in a variable based on the data
(<code><a href="#topic+getNDecimalsData">getNDecimalsData</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMaxNDecimalsData(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMaxNDecimalsData_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer with maximum number of decimals in a character vector.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
x &lt;- c(0.99, 5.679, 50.45, 1450)
# extract max number of decimals based on data:
getMaxNDecimalsData(x)
</p>


<h3>See Also</h3>

<p>Other decimals: 
<code><a href="#topic+formatPercentage">formatPercentage</a>()</code>,
<code><a href="#topic+getMaxNDecimals">getMaxNDecimals</a>()</code>,
<code><a href="#topic+getNDecimals">getNDecimals</a>()</code>,
<code><a href="#topic+getNDecimalsData">getNDecimalsData</a>()</code>
</p>

<hr>
<h2 id='getNDecimals'>Get number of decimals for a specific vector.</h2><span id='topic+getNDecimals'></span>

<h3>Description</h3>

<p>The number of decimals is extracted either:
</p>

<ul>
<li><p>from specific implemented rule :
see <code><a href="#topic+getNDecimalsRule">getNDecimalsRule</a></code> for further details
</p>
</li>
<li><p>from the data itself: 
see <code><a href="#topic+getNDecimalsData">getNDecimalsData</a></code> for further details

</p>
</li>
<li><p>both criterias: in this case the minimum of 
the number of decimals for both criterias is used
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>getNDecimals(x, useRule = TRUE, rule = "1", useData = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getNDecimals_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="getNDecimals_+3A_userule">useRule</code></td>
<td>
<p>Logical (TRUE by default), should the <code>rule</code> be applied?</p>
</td></tr>
<tr><td><code id="getNDecimals_+3A_rule">rule</code></td>
<td>
<p>Character vector with rule to use to derive 
the number of parameters.
Currently only: '1' is implemented.
</p>

<ul>
<li><p>'1': standard rule for the number of 
decimals for individual values for a 
continuous variable:
</p>

<ul>
<li><p>value &lt; 1 ('very small values'): 3
</p>
</li>
<li><p>value &lt; 10: 2
</p>
</li>
<li><p>value in [10, 1000[: 1
</p>
</li>
<li><p>value &gt;= 1000: 0
</p>
</li></ul>


</li></ul>
</td></tr>
<tr><td><code id="getNDecimals_+3A_usedata">useData</code></td>
<td>
<p>Logical (TRUE by default), should the number of decimals
be extracted based on the input data <code>x</code>?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of same length than <code>x</code>
with the number of decimals.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other decimals: 
<code><a href="#topic+formatPercentage">formatPercentage</a>()</code>,
<code><a href="#topic+getMaxNDecimals">getMaxNDecimals</a>()</code>,
<code><a href="#topic+getMaxNDecimalsData">getMaxNDecimalsData</a>()</code>,
<code><a href="#topic+getNDecimalsData">getNDecimalsData</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0.99, 5.679, 50.45, 1450)
# extract number of decimals based on data:
getNDecimals(x, useRule = FALSE, useData = TRUE)
# extract number of decimals based on pre-defined rule:
getNDecimals(x, useRule = TRUE, useData = FALSE)
# extract number of decimals based on both rules
# minimum of both is used (by default)
getNDecimals(x, useRule = TRUE, useData = TRUE)
</code></pre>

<hr>
<h2 id='getNDecimalsData'>Get number of decimals based on the data in a numeric vector.
Note: NA is returned if the element is missing (NA).</h2><span id='topic+getNDecimalsData'></span>

<h3>Description</h3>

<p>Get number of decimals based on the data in a numeric vector.
Note: NA is returned if the element is missing (NA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNDecimalsData(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getNDecimalsData_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of same length than <code>x</code>
with the number of decimals.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other decimals: 
<code><a href="#topic+formatPercentage">formatPercentage</a>()</code>,
<code><a href="#topic+getMaxNDecimals">getMaxNDecimals</a>()</code>,
<code><a href="#topic+getMaxNDecimalsData">getMaxNDecimalsData</a>()</code>,
<code><a href="#topic+getNDecimals">getNDecimals</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0.99, 5.679, 50.45, 1450)
getNDecimalsData(x)
</code></pre>

<hr>
<h2 id='getNDecimalsRule'>Get number of decimals based pre-defined rule(s).</h2><span id='topic+getNDecimalsRule'></span>

<h3>Description</h3>

<p>Note: NA is returned if the element is missing (NA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNDecimalsRule(x, rule = c("1"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getNDecimalsRule_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="getNDecimalsRule_+3A_rule">rule</code></td>
<td>
<p>Character vector with rule to use to derive 
the number of parameters.
Currently only: '1' is implemented.
</p>

<ul>
<li><p>'1': standard rule for the number of 
decimals for individual values for a 
continuous variable:
</p>

<ul>
<li><p>value &lt; 1 ('very small values'): 3
</p>
</li>
<li><p>value &lt; 10: 2
</p>
</li>
<li><p>value in [10, 1000[: 1
</p>
</li>
<li><p>value &gt;= 1000: 0
</p>
</li></ul>


</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of same length than <code>x</code>
with the number of decimals.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0.99, 5.679, 50.45, 1450)
getNDecimalsRule(x = x)
</code></pre>

<hr>
<h2 id='getPatternPosition'>Get position(s) (start, end) of a pattern in a string.</h2><span id='topic+getPatternPosition'></span>

<h3>Description</h3>

<p>Get position(s) (start, end) of a pattern in a string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPatternPosition(x, startPattern, endPattern = "\\}", format)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPatternPosition_+3A_x">x</code></td>
<td>
<p>String.</p>
</td></tr>
<tr><td><code id="getPatternPosition_+3A_startpattern">startPattern</code></td>
<td>
<p>String with start pattern.</p>
</td></tr>
<tr><td><code id="getPatternPosition_+3A_endpattern">endPattern</code></td>
<td>
<p>String with end pattern.</p>
</td></tr>
<tr><td><code id="getPatternPosition_+3A_format">format</code></td>
<td>
<p>String with type of formatting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with columns: 'start' and 'end' with
start and end position(x) of the pattern, 'format' with
the <code>format</code> and 'pattern' with the regex pattern for the full match. 
NULL if no match.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='getStatisticsSummaryStatisticsTable'>Compute custom statistics specified by the user.</h2><span id='topic+getStatisticsSummaryStatisticsTable'></span>

<h3>Description</h3>

<p>Compute custom statistics specified by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStatisticsSummaryStatisticsTable(
  summaryTable,
  statsVarInit,
  var = NULL,
  stats = NULL,
  statsVarBy = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStatisticsSummaryStatisticsTable_+3A_summarytable">summaryTable</code></td>
<td>
<p>Summary table.</p>
</td></tr>
<tr><td><code id="getStatisticsSummaryStatisticsTable_+3A_statsvarinit">statsVarInit</code></td>
<td>
<p>Character vector with initial statistics names.</p>
</td></tr>
<tr><td><code id="getStatisticsSummaryStatisticsTable_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) of <code>data</code>, 
to compute statistics on.<br />
If NULL (by default), counts by row/column variable(s) are computed.<br />
To also return counts of the <code>rowVar</code> in case other <code>var</code>
are specified, you can include: 'all' in the <code>var</code>.<br />
Missing values, if present, are filtered 
(also for the report of number of subjects/records).</p>
</td></tr>
<tr><td><code id="getStatisticsSummaryStatisticsTable_+3A_stats">stats</code></td>
<td>
<p>(Optionally) named list of expression or call object of summary statistics of interest.
The names are reported in the header.
The following variables are recognized, if the table is a: 
</p>

<ul>
<li><p>'summaryTable': 
</p>

<ul>
<li><p>'statN': number of subjects
</p>
</li>
<li><p>'statMean': mean of <code>var</code>
</p>
</li>
<li><p>'statSD': standard deviation of <code>var</code>
</p>
</li>
<li><p>'statSE': standard error of <code>var</code>
</p>
</li>
<li><p>'statMedian': median of <code>var</code>
</p>
</li>
<li><p>'statMin': minimum of <code>var</code>
</p>
</li>
<li><p>'statMax': maximum of <code>var</code>
</p>
</li>
<li><p>'statPerc': percentage of subjects
</p>
</li>
<li><p>'statm': number of records
</p>
</li></ul>


</li>
<li><p>'countTable': 
</p>

<ul>
<li><p>'statN': number of subjects
</p>
</li>
<li><p>'statPercN': percentage of subjects
</p>
</li>
<li><p>'statm': number of records
</p>
</li></ul>


</li></ul>

<p>If <code>stats</code> if of length 1, the name of the summary statistic is not included
in the table.
The statistics can be specified for each <code>var</code> (if multiple), 
by naming each element of the list:
list(varName1 = list(...), varName2 = list()) and/or for each element in:
<code>statsVarBy</code>, by naming each sublist.</p>
</td></tr>
<tr><td><code id="getStatisticsSummaryStatisticsTable_+3A_statsvarby">statsVarBy</code></td>
<td>
<p>Character vector with colnames of
<code>data</code> by which the statistics should be computed.
In this case, <code>stats</code> (nested list or not) should be additionally nested
to specify the statistics for each element in <code>statsVarBy</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two elements:
</p>

<ul>
<li><p>'summaryTable': summary table updated with statistics specified in <code>stats</code>
</p>
</li>
<li><p>'statsVar': Character vector with statistics names
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='getStats'>Get default set of statistics for one particular variable.</h2><span id='topic+getStats'></span>

<h3>Description</h3>

<p>This set of statistics can be passed directly to the <code>stats</code> parameter
of the of the package functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStats(
  type = "summary",
  includeName = TRUE,
  x = NULL,
  nDecCont = getMaxNDecimals,
  nDecN = 0,
  nDecm = nDecN,
  formatPercentage = inTextSummaryTable::formatPercentage
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStats_+3A_type">type</code></td>
<td>
<p>Character vector with type of statistics (multiple are possible).
Available statistics are specified in the section 'Formatted statistics' and
formatting in 'Statistics formatting' in
<code><a href="#topic+inTextSummaryTable-stats">in-text table statistics</a></code>.</p>
</td></tr>
<tr><td><code id="getStats_+3A_includename">includeName</code></td>
<td>
<p>Logical, should the statistics name be included (TRUE by default)?
This is applied for the statistic names used in each for the set defined in <code>type</code>;
and for the label of the list if <code>type</code> is of length 2.
If there are multiple <code>type</code> or statistics within a set, the names are retained (to avoid confusion).</p>
</td></tr>
<tr><td><code id="getStats_+3A_x">x</code></td>
<td>
<p>(optional, recommended for continuous variable) Numeric vector 
for which the statistics should be computed on.<br />
This is used to derive the number of decimals to include
for a continuous variable.<br />
If not specified, the values are rounded with <code><a href="base.html#topic+formatC">formatC</a></code>.</p>
</td></tr>
<tr><td><code id="getStats_+3A_ndeccont">nDecCont</code></td>
<td>
<p>Integer with base number of decimals 
for continuous variable, or function returning this number based on <code>x</code> 
(<code><a href="#topic+getNDecimals">getNDecimals</a></code> by default).</p>
</td></tr>
<tr><td><code id="getStats_+3A_ndecn">nDecN</code>, <code id="getStats_+3A_ndecm">nDecm</code></td>
<td>
<p>Integer with number of decimals 
for number of subjects/records (0 by default).</p>
</td></tr>
<tr><td><code id="getStats_+3A_formatpercentage">formatPercentage</code></td>
<td>
<p>Function used to format the percentages
(see <code><a href="#topic+formatPercentage">formatPercentage</a></code> for default behaviour).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Expression (or call object) containing
function to extract requested summary statistics.
If multiple <code>type</code> are specified, they are combined to a list.
Names of the list will be typically used to name the statistic
in the summary table.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p><a href="#topic+getStatsData">getStatsData</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## default set of statistics are available for:

# for count table:
getStats("count")
getStats("n (%)")
getStats("n")
getStats("%")
getStats("m")
getStats("%m")
getStats("m (%)")
# for continuous variable:
getStats("summary")
getStats("mean (se)")
getStats("mean (sd)")
getStats("median (range)")
getStats("median\n(range)")
getStats(c("Mean", "SE"))

## to not include statistic name in the table
getStats("median\n(range)", includeName = FALSE)
getStats(c("summary", "median\n(range)"), includeName = FALSE)

## to extract the number of decimals based on a continuous variable (see ?getMaxNDecimals) 
exampleData &lt;- data.frame(
  USUBJID = 1 : 4, 
  WEIGHT = c(67, 78, 83, 61), 
  SEX = c("F", "M", "M", "F"), 
  stringsAsFactors = FALSE
)
getStats(type = c('median (range)', 'mean (se)'), x = exampleData$WEIGHT)
# compare with when 'x' is not specified:
getStats(type = c('median (range)', 'mean (se)'))

## custom function to format the percentages:
getStats(type = "count", formatPercentage = function(x) round(x, 2))
</code></pre>

<hr>
<h2 id='getStatsData'>Get default set of statistics for variables of interest and specific dataset.</h2><span id='topic+getStatsData'></span>

<h3>Description</h3>

<p>This set of statistics can be passed directly to the <code>stats</code> parameter
of the package functions.<br />
By default, statistics are extracted based on the variable(s) type
and formatted with the default rules implemented in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStatsData(
  data,
  var = NULL,
  type = "default",
  extra = NULL,
  args = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStatsData_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="getStatsData_+3A_var">var</code></td>
<td>
<p>(optional, recommended for continuous variable)
Character vector with variable(s) of data, to
compute statistics on.<br />
If NULL (by default), counts of the entire dataset are computed.<br />
It is passed to the <code>x</code> parameter of <code><a href="#topic+getStats">getStats</a></code>.</p>
</td></tr>
<tr><td><code id="getStatsData_+3A_type">type</code></td>
<td>
<p>Character vector with type of statistics to extract, among:
</p>

<ul>
<li><p>'default': default sets of statistics, 
see types: 'summary-default' and 'count-default' in <code><a href="#topic+getStats">getStats</a></code>
</p>
</li>
<li><p>'all': all computed statistics, see types: 'summary' and 'count' in 
<code><a href="#topic+getStats">getStats</a></code>
</p>
</li>
<li><p>any formatted statistics as implemented in <code><a href="#topic+getStats">getStats</a></code>, 
see section 'Formatted statistics' in
<code><a href="#topic+inTextSummaryTable-stats">in-text table statistics</a></code>.

</p>
</li></ul>

<p>To specify statistics for a continuous (numeric) or categorical
variable separately, this vector can be named with: 'cont' or
'cat' respectively (elements not named are used for both continuous 
and categorical variables).</p>
</td></tr>
<tr><td><code id="getStatsData_+3A_extra">extra</code></td>
<td>
<p>List with extra statistics to include, or function to apply on each
<code>var</code> (e.g. depending on the class of <code>var</code>) to get such statistic.</p>
</td></tr>
<tr><td><code id="getStatsData_+3A_args">args</code></td>
<td>
<p>(optional) Named list with extra arguments for 
<code><a href="#topic+getStats">getStats</a></code> for continuous (name: 'cont') or 
categorical variable (name: 'cat') specifically.</p>
</td></tr>
<tr><td><code id="getStatsData_+3A_...">...</code></td>
<td>
<p>Extra parameters passed to the <code><a href="#topic+getStats">getStats</a></code> function
(independent of the variable type).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with statistics to compute, named by <code>var</code>
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p><a href="#topic+getStats">getStats</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default set of statistics (depending if the variable is continuous or categorical)
exampleData &lt;- data.frame(
  USUBJID = 1 : 4, 
  WEIGHT = c(67, 78, 83, 61), 
  SEX = c("F", "M", "M", "F"), 
  stringsAsFactors = FALSE
)
getStatsData(data = exampleData, var = c("WEIGHT", "SEX"))
# all set of statistics (depending if the variable is continuous or categorical)
getStatsData(data = exampleData, var = c("WEIGHT", "SEX"), type = "all")
# custom set of statistics for all variables
getStatsData(data = exampleData, var = c("WEIGHT", "SEX"), type = c("n", "%"))
# custom set of statistics, depending on the type of the variable
getStatsData(data = exampleData, var = c("WEIGHT", "SEX"), 
  type = c(cont = "median (range)", cont = "mean (se)", cat = "n (%)"), 
  args = list(cat = list(includeName = FALSE))
)
</code></pre>

<hr>
<h2 id='getSummaryStatisticsTable'>Get summary statistics table</h2><span id='topic+getSummaryStatisticsTable'></span>

<h3>Description</h3>

<p>Get summary statistics table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSummaryStatisticsTable(
  data,
  var = NULL,
  varFlag = NULL,
  varLab = NULL,
  varLabInclude = length(var) &gt; 1,
  varInclude0 = FALSE,
  varIgnore = NULL,
  varGeneralLab = "Variable",
  varSubgroupLab = "Variable group",
  varIncludeTotal = FALSE,
  varTotalInclude = FALSE,
  varTotalInSepRow = FALSE,
  rowVar = NULL,
  rowVarLab = NULL,
  rowVarDataLevels = NULL,
  rowOrder = "auto",
  rowOrderTotalFilterFct = NULL,
  rowOrderCatLast = NULL,
  rowVarInSepCol = NULL,
  rowVarFormat = NULL,
  rowVarTotalInclude = NULL,
  rowVarTotalByVar = NULL,
  rowVarTotalInSepRow = NULL,
  rowTotalLab = NULL,
  rowInclude0 = FALSE,
  rowAutoMerge = TRUE,
  emptyValue = "-",
  rowVarTotalPerc = NULL,
  colVar = NULL,
  colVarTotal = colVar,
  colVarTotalPerc = colVarTotal,
  colInclude0 = FALSE,
  colVarDataLevels = NULL,
  colTotalInclude = FALSE,
  colTotalLab = "Total",
  stats = NULL,
  statsExtra = NULL,
  statsVarBy = NULL,
  statsPerc = c("statN", "statm"),
  statsGeneralLab = "Statistic",
  statsValueLab = "StatisticValue",
  statsLabInclude = NULL,
  subjectVar = "USUBJID",
  filterFct = NULL,
  dataTotal = NULL,
  dataTotalPerc = dataTotal,
  dataTotalRow = NULL,
  dataTotalCol = NULL,
  type = "auto",
  byVar = NULL,
  byVarLab = NULL,
  checkVarDiffBySubj = "error",
  labelVars = NULL,
  outputType = "flextable",
  statsLayout = ifelse("DT" %in% outputType, "col", "row"),
  landscape = (style == "presentation"),
  margin = 1,
  rowPadBase = 14.4,
  title = NULL,
  footer = NULL,
  file = NULL,
  style = "report",
  colorTable = getColorPaletteTable(style = style),
  colHeaderTotalInclude = TRUE,
  colHeaderMerge = TRUE,
  fontsize = switch(style, report = 8, presentation = 10),
  fontname = switch(style, report = "Times", presentation = "Tahoma"),
  vline = "none",
  hline = "auto",
  pageDim = NULL,
  columnsWidth = NULL,
  expandVar = NULL,
  noEscapeVar = NULL,
  barVar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSummaryStatisticsTable_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) of <code>data</code>, 
to compute statistics on.<br />
If NULL (by default), counts by row/column variable(s) are computed.<br />
To also return counts of the <code>rowVar</code> in case other <code>var</code>
are specified, you can include: 'all' in the <code>var</code>.<br />
Missing values, if present, are filtered 
(also for the report of number of subjects/records).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_varflag">varFlag</code></td>
<td>
<p>Character vector, subset of <code>var</code> with variable(s) 
of type 'flag' (with 'Y', 'N' or &rdquo; for empty/non specified value).
Only the counts for records flagged (with 'Y') are retained.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_varlab">varLab</code></td>
<td>
<p>Named character vector with label for each variable 
specified in <code>var</code>.
By default, extracted from the <code>labelVars</code>.
if not available, <code>var</code> is used.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_varlabinclude">varLabInclude</code></td>
<td>
<p>Logical, if TRUE
the name of the summary statistic variable(s) (<code>var</code>)
are included in the table.
This is automatically set to TRUE if more than one variable(s) 
and is specified, and FALSE if only one variable is specified.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_varinclude0">varInclude0</code></td>
<td>
<p>Logical, should rows with no counts 
for the count <code>var</code> or <code>varFlag</code> variable(s)
be included in the table?
Either:
</p>

<ul>
<li><p>logical of length 1, if TRUE (FALSE by default) 
rows with no count are included for all <code>var</code>

</p>
</li>
<li><p>a character vector containing categorical <code>var</code> 
for which zero counts rows should be included
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_varignore">varIgnore</code></td>
<td>
<p>Vector with elements to ignore in the <code>var</code> variable(s).
The <code>data</code> records with such elements in <code>var</code> are <strong>filtered</strong> from the data 
at the start of the workflow.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_vargenerallab">varGeneralLab</code></td>
<td>
<p>String with general label for variable specified in <code>var</code>.
In case of multiple variable in <code>var</code>, this will be included in the table header
(see 'rowVarLab' attribute of the output).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_varsubgrouplab">varSubgroupLab</code></td>
<td>
<p>String with general label for sub-group of
categorical variable(s) for count table, 'Variable group' by default.
This will be included in the final table header (see 'rowVarLab' attribute of the output).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_varincludetotal">varIncludeTotal</code></td>
<td>
<p>This argument is deprecated, please use: 'varTotalInclude' instead.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_vartotalinclude">varTotalInclude</code></td>
<td>
<p>Should the total across all categories of <code>var</code> 
be included for the count table?
Only used for categorical variables (and <code>var</code> not 'all').
Either:
</p>

<ul>
<li><p>logical of length 1, if TRUE (FALSE by default) include the total for all categorical <code>var</code>
</p>
</li>
<li><p>a character vector containing categorical <code>var</code> for which the total should be included
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_vartotalinseprow">varTotalInSepRow</code></td>
<td>
<p>Logical, should the total per variable be included in
a separated row (by default) or in the row containing the header of the variable?</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvarlab">rowVarLab</code></td>
<td>
<p>Named character vector with 
label for the <code>rowVar</code> variable(s).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvardatalevels">rowVarDataLevels</code></td>
<td>
<p>Data.frame with unique combinations of <code>rowVar</code>
to be included in columns.
Each column should correspond to <code>colVar</code> and as factor
if the elements should be ordered in the final table.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_roworder">rowOrder</code></td>
<td>
<p>Specify how the rows should be ordered in the final table, either a:
</p>

<ul>
<li><p>String among:
</p>

<ul>
<li><p>'auto' (by default): if the variable is a factor, keep its order, otherwise order alphabetically
</p>
</li>
<li><p>'alphabetical': order alphabetically
</p>
</li>
<li><p>'total': order rows in decreasing order of the total number of subjects
across all columns for this specific category.
</p>
</li></ul>

</li>
<li><p>Function with input the summary table and output the ordered elements of the <code>rowVar</code>
</p>
</li></ul>

<p>To specify different ordering methods for different <code>rowVar</code>, specify a list
of such elements, named with the <code>rowVar</code> variable.
For the table output of <code><a href="#topic+computeSummaryStatisticsTable">computeSummaryStatisticsTable</a></code> (long format),
this order is also reflected in the <strong><code>levels</code></strong> of the row factor variable.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowordertotalfilterfct">rowOrderTotalFilterFct</code></td>
<td>
<p>Function used to filter the data used to order the rows
based on total counts (in case <code>rowOrder</code> is 'total'),
To order rows based on one specific column category,
e.g. to order based on the counts in the treatment column:
function(x) subset(x, TRTP == &quot;treatmentX&quot;)</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowordercatlast">rowOrderCatLast</code></td>
<td>
<p>String with category to be printed in the last 
row of each <code>rowVar</code> (if any, set to NULL if none).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvarinsepcol">rowVarInSepCol</code></td>
<td>
<p>Character vector with <code>rowVar</code>
that should be included in separated columns.
By default (NULL), all row variables are nested in the first column 
of the table.<br />
To include the groups within a <code>var</code> variable in a separated column, 
set: <code>rowVarInSepCol == 'variableGroup'</code>.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvarformat">rowVarFormat</code></td>
<td>
<p>(flextable output) Named list with special formatting for the <code>rowVar</code>.
Currently, only possibility is to set the variable elements in bold, with:
list(var1 = &quot;bold&quot;).
(Use 'variable' for <code>var</code> or 'variableGroup' for group within categorical variables.)</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvartotalinclude">rowVarTotalInclude</code></td>
<td>
<p>Character vector with <code>rowVar</code>
for which the total should be reported.<br />
If the higher row variable is specified, the total across all rows
is reported. <br />
For the export, these variable(s) are formatted as factor with 
<strong>'Total' as the first level</strong>.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvartotalbyvar">rowVarTotalByVar</code></td>
<td>
<p>Character vector with a row variable
used to categorize the row total.<br />
Note that this is only used if row total(s) is/are requested via <code>rowVarTotalInclude</code>,
and this variable should also be included in <code>rowVar</code>.
This can be specified also for a specific row variable if the vector is named.<br />
For example: <code>c(ADECOD = "AESEV")</code> to compute total by severity 
for row adverse event term in a typical adverse event count table 
(by System Organ Class and Adverse Event Term).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvartotalinseprow">rowVarTotalInSepRow</code></td>
<td>
<p>Character vector with <code>rowVarTotalInclude</code>
(not in <code>rowVarInSepCol</code>) for which the total should be included in a separated row labelled 'Total'.
Otherwise (by default) the total is included in the header row of each category.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowtotallab">rowTotalLab</code></td>
<td>
<p>(flextable output) string with label for the row with total.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowinclude0">rowInclude0</code></td>
<td>
<p>Logical, if TRUE (FALSE by default),
include rows with no records, based on all combinations 
of the <code>rowVar</code> (assuming nested variable(s)).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowautomerge">rowAutoMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (by default) automatically merge rows,
e.g. in case there is only one sub-category (e.g. categorical variable with only one group)
or only one statistic per category.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_emptyvalue">emptyValue</code></td>
<td>
<p>String with placeholder used to fill the table for missing values, '-' by default.
This value is typically used e.g. if not all statistics are computed for all specified
row/col/var variables.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowvartotalperc">rowVarTotalPerc</code></td>
<td>
<p>Character vector with row variables by which the total
should be computed for the denominator for the percentage computation.
By default the total is only computed only by column (NULL by default).
If the total should be based on the total number of records per variable,
<code>rowVarTotalPerc</code> should be set to 'variable'.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_colvartotal">colVarTotal</code></td>
<td>
<p>String with column(s) considered to compute the total by,
reported in the header of the table, by default same as <code>colVar</code>.
Use: 'variable' to compute total by <code>var</code> (if multiple).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_colvartotalperc">colVarTotalPerc</code></td>
<td>
<p>String with column(s) considered to compute the total by,
used as denominator for the percentage computation, by default same as <code>colVarTotal</code>.
Use: 'variable' to compute total by <code>var</code> (if multiple).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_colinclude0">colInclude0</code></td>
<td>
<p>Logical, if TRUE (FALSE by default),
include columns with no records, based on all combinations 
of the <code>columnVar</code> (assuming nested variable(s)).
If variable(s) are not nested, possible combinations
can be specified via <code>colVarDataLevels</code>.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_colvardatalevels">colVarDataLevels</code></td>
<td>
<p>Data.frame with unique combinations of <code>colVar</code>
to be included in columns.
Each column should correspond to <code>colVar</code> and as factor
if the elements should be ordered in the final table.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_coltotalinclude">colTotalInclude</code></td>
<td>
<p>Logical, if TRUE (FALSE by default) include the summary 
statistics across columns in a separated column.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_coltotallab">colTotalLab</code></td>
<td>
<p>String, label for the total column  'Total' by default.<br /></p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_stats">stats</code></td>
<td>
<p>(optional) Statistic(s) of interest to compute, either:
</p>

<ul>
<li><p>string with the name of a default set of statistics
available in the package, 
see section 'Formatted statistics' in
<code><a href="#topic+inTextSummaryTable-stats">in-text table statistics</a></code>.<br />
See the corresponding <code>type</code> parameter of the
<code><a href="#topic+getStatsData">getStatsData</a></code> for more information
on how the statistic is internally extracted.
</p>
</li>
<li><p>(expert mode) named list of language object (see <code><a href="base.html#topic+is.language">is.language</a></code>) 
of base summary statistics of interest, see section:
'Base statistics' in
<code><a href="#topic+inTextSummaryTable-stats">in-text table statistics</a></code>.<br />
The names are reported in the header.<br />
If <code>stats</code> if of length 1, the name of the summary statistic is not included
in the table.<br />
The statistics can be specified separately:
</p>

<ul>
<li><p>for each <code>var</code> (if multiple), 
by naming each element of the list:
<code>list(varName1 = list(...), varName2 = list())</code>

</p>
</li>
<li><p>and/or for each element in:
<code>statsVarBy</code>, by naming each sublist.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_statsextra">statsExtra</code></td>
<td>
<p>(optional) Named list with functions for additional custom
statistics to be computed.<br />
Each function:
</p>

<ul>
<li><p>has as parameter, either: 'x': the variable (<code>var</code>) to compute
the summary statistic on or 'data': the entire dataset
</p>
</li>
<li><p>returns the corresponding summary statistic as a numeric vector
</p>
</li></ul>

<p>For example, to additionally compute the coefficient of variation, this can be set to:
<code>list(statCVPerc = function(x) sd(x)/mean(x)*100)</code> (or <code><a href="#topic+cv">cv</a></code>).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_statsvarby">statsVarBy</code></td>
<td>
<p>String with variable in <code>rowVar</code>/<code>colVar</code>
which the statistics should be computed by.<br />
In this case, <code>stats</code> (nested list or not) should be additionally nested
to specify the statistics for each element in <code>statsVarBy</code>.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_statsperc">statsPerc</code></td>
<td>
<p>String with 'base statistical variable' used to compute the 
percentage, either: 
</p>

<ul>
<li><p>'statN' (by default): the number of subjects
</p>
</li>
<li><p>'statm': the number of records
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_statsgenerallab">statsGeneralLab</code></td>
<td>
<p>String with general label for statistics, 'Statistic' by default.
Only included if no <code>statsVar</code> if longer than 1.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_statsvaluelab">statsValueLab</code></td>
<td>
<p>String with label for the statistic value, 
'StatisticValue' by default.<br />
This is only included in the table if the statistics provided in 
<code>stats</code> are not named and if no <code>colVar</code> is specified.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_statslabinclude">statsLabInclude</code></td>
<td>
<p>Logical, if TRUE include the statistic label
in the table. <br /> By default only included if more than
one statistic variables are available in the table.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_subjectvar">subjectVar</code></td>
<td>
<p>String, variable of <code>data</code> with subject ID,
'USUBJID' by default.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_filterfct">filterFct</code></td>
<td>
<p>(optional) Function taking as input
the summary table with computed statistics and returning a subset 
of the summary table.<br />
Note: The filtering function should also handle records with :
</p>

<ul>
<li><p>total for the column header: <code>isTotal</code> set to TRUE,
and <code>colVar</code>/<code>rowVar</code> is NA.<br />
For example: <code>filterFct = function(data) subset(data, isTotal &amp; myColVar == "group 1")</code>

</p>
</li>
<li><p><code>rowVar</code>/<code>colVar</code> set to 'Total'/<code>colTotalLab</code> 
if <code>rowVarTotalInclude</code>/<code>colTotalInclude</code> is specified
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_datatotal">dataTotal</code></td>
<td>
<p>Data.frame used to extract the Total number of subject
per column in column header ('N = [X]').
It should contain the variables specified by <code>colVarTotal</code>.
If not specified, the total number of subjects is extracted from the <code>data</code>.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_datatotalperc">dataTotalPerc</code></td>
<td>
<p>Data.frame used to extract the total counts per column 
for the computation of the percentage.<br />
By default, <code>dataTotal</code> is used.<br />
It should contain the variables specified by <code>colVarTotalPerc</code>.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_datatotalrow">dataTotalRow</code></td>
<td>
<p>Data.frame used to extract the total count across all
elements of the row
variable, list of such data.frame for each <code>rowVar</code> variable.<br />
If the dataset is specified by row variable, the list should be named with:
variable X if the total across elements of variable X should be included.
By default, <code>data</code> is used.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_datatotalcol">dataTotalCol</code></td>
<td>
<p>Data.frame from which the total across columns is 
extracted (in case <code>colTotalInclude</code> is TRUE)
or list of such data.frame for each <code>rowVar</code> variable.<br />
If the dataset is specified by row variable, the list should be named with:
with:
</p>

<ul>
<li><p>last row variable: for the dataset used in the total column for 
the most nested row variable
</p>
</li>
<li><p>higher row variable (X+1): for the dataset used for the total column
and row total of X
</p>
</li>
<li><p>'total': for the dataset used for the total column and general row total
</p>
</li></ul>

<p>If only a subset of the variables is specified in this list, 
<code>data</code> is used for the remaining variable(s) (or 'total') if needed.<br />
This dataset (the one for 'total' if a list) is also used for:
</p>

<ul>
<li><p>the header of the total column in case <code>dataTotal</code> is
not specified
</p>
</li>
<li><p>the denominator of the percentages in the total column
in case <code>dataTotalPerc</code> is not specified
</p>
</li></ul>

<p>By default, <code>data</code> is used.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_type">type</code></td>
<td>
<p>String with type of table: 
</p>

<ul>
<li><p>'summaryTable': summary table with statistics for numeric variable
</p>
</li>
<li><p>'countTable': count table
</p>
</li>
<li><p>'auto' (by default): 'summaryTable' if the variable is numeric,
'countTable' otherwise
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_byvar">byVar</code></td>
<td>
<p>Variable(s) of <code>data</code> for which separated table(s)
should be created.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_byvarlab">byVarLab</code></td>
<td>
<p>String with label for <code>byVar</code>, used to set the names
of the output list of table(s).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_checkvardiffbysubj">checkVarDiffBySubj</code></td>
<td>
<p>String, 'error' (default), 'warning',
or 'none'.  
Should an error, a warning, or nothing be produced
if a continuous variable (<code>var</code>) contains
different values for the same subject (by row/column)?</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_outputtype">outputType</code></td>
<td>
<p>String with output type:
</p>

<ul>
<li><p>'flextable' (by default): <code><a href="flextable.html#topic+flextable">flextable</a></code> object, with format for
CSR, compatible with Word/PowerPoint export
</p>
</li>
<li><p>'DT': <code><a href="DT.html#topic+datatable">datatable</a></code> interactive table,
compatible with html export
</p>
</li>
<li><p>'data.frame': data.frame in wide format (with elements in 
<code>colVar</code> in different columns)
</p>
</li>
<li><p>'data.frame-base': data.frame in long format (with elements in 
<code>colVar</code> in different rows), useful for QC
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_statslayout">statsLayout</code></td>
<td>
<p>String with layout for the statistics names 
(in case more than one statistic is included), among:
</p>

<ul>
<li><p>row (by default for 'flextable' output): <br /> All statistics are
included in different rows in the first column of the table (after the row variable(s))
</p>
</li>
<li><p>'col' (by default for 'DT' output): <br /> Statistics are included 
in separated columns (last row of the header).<br />
This option is not compatible with categorical variable(s).
</p>
</li>
<li><p>'rowInSepCol': <br /> Statistics are included in different rows, 
but in a separated column than the <code>rowVar</code> variable(s)
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_landscape">landscape</code></td>
<td>
<p>(flextable output) Logical, if TRUE the file is in landscape format.<br />
By default: FALSE if <code>style</code> is 'report' and TRUE if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_margin">margin</code></td>
<td>
<p>(flextable output) Margin in the document in inches
(1 by default).
This is used to specify the width of the table, from:
[<code>pageDim[1]</code> - 2 * margin].</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_rowpadbase">rowPadBase</code></td>
<td>
<p>(flextable output) Base padding for row (in points), 
14.4 by default (corresponds to 0.2 inches)</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_title">title</code></td>
<td>
<p>Character vector with title(s) for the table.
Set to NULL (by default) if no title should be included.
If multiple are specified, specified for each element of <code>byVar</code> (in order of the levels).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_footer">footer</code></td>
<td>
<p>(flextable output) Character vector with footer(s) for the table.
Set to NULL (by default) if no footer should be included.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_file">file</code></td>
<td>
<p>(Optional) Name of the file the table should be exported to, 
either:
</p>

<ul>
<li><p>string (of length 1). In this case, depending on the
file extension, the following is exported: 
</p>

<ul>
<li><p>'txt': summary table in long format ('data.frame-base' <code>outputType</code>)
</p>
</li>
<li><p>'docx': summary table in final format is exported ('flextable' <code>outputType</code>)
</p>
</li>
<li><p>'html': interactive summary table is exported ('DT' <code>outputType</code>)
</p>
</li></ul>

</li>
<li><p>named character vector in case of multiple exports.
The names should correspond to the options in <code>outputType</code>:
</p>

<ul>
<li><p>for 'data.frame-base' and 'data.frame': filename with 'txt' extension
</p>
</li>
<li><p>for 'flextable': filename with 'docx' extension
</p>
</li>
<li><p>for 'DT': filename with 'html' extension
</p>
</li></ul>

</li></ul>

<p>If NULL (by default), the summary table is not exported but only returned as output.
If <code>byVar</code> is specified, each table is exported to a separated
file with the suffix: 'file_[i].[ext]' with i the index of the file
(and [ext] the file extension).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_style">style</code></td>
<td>
<p>(flextable output) String with table style,
either 'report' or 'presentation'.
This parameter affects the fontsize, font family, color of the text and background, 
and table dimensions of the table.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_colortable">colorTable</code></td>
<td>
<p>(flextable output) Named character vector with color for the table background/body/text/line,
e.g. created with the <code><a href="#topic+getColorPaletteTable">getColorPaletteTable</a></code> function.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_colheadertotalinclude">colHeaderTotalInclude</code></td>
<td>
<p>Logical, if TRUE include the total of number of patients
(<code>'statN'</code>) in the column header.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_colheadermerge">colHeaderMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (FALSE by default) 
the column header is merged.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_fontsize">fontsize</code></td>
<td>
<p>(flextable output) Integer with font size, by default:
8 if <code>style</code> is 'report' and 10 if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_fontname">fontname</code></td>
<td>
<p>(flextable output) String with font name, by default:
'Times' if <code>style</code> is 'report' and 'Tahoma' if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_vline">vline</code></td>
<td>
<p>(flextable output) String mentioning how vertical lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none' (default): no vertical lines included
</p>
</li>
<li><p>'auto': vertical lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_hline">hline</code></td>
<td>
<p>(flextable output) String mentioning how horizontal lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none': no horizontal lines included
</p>
</li>
<li><p>'auto' (default): horizontal lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_pagedim">pageDim</code></td>
<td>
<p>Numeric vector of length 2 with page width and height.<br />
Depending on <code>outputType</code>:
</p>

<ul>
<li><p>'flextable': in inches
</p>
</li>
<li><p>'DT': in number of rows in the table.<br />
Currently only the height is used (e.g. <code>c(NA, 4)</code>)
</p>
</li></ul>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_columnswidth">columnsWidth</code></td>
<td>
<p>(expert mode) Column widths of the table. This is only used 
for flextable and DT tables.<br />
For flextable, note that the widths should be set to fit into the document page
(see <code><a href="#topic+getDimPage">getDimPage</a></code>).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_expandvar">expandVar</code></td>
<td>
<p>(DT output) Character vector with variables of the summary table which
should be expanded in the data.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_noescapevar">noEscapeVar</code></td>
<td>
<p>(DT output) Character vector with variables of <code>summaryTable</code>
which shouldn't be escaped in the table (e.g. containing URLs).</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_barvar">barVar</code></td>
<td>
<p>(DT output) Character vector with variables of <code>summaryTable</code>
that should be represented as a bar.</p>
</td></tr>
<tr><td><code id="getSummaryStatisticsTable_+3A_...">...</code></td>
<td>
<p>(DT output) Extra parameters passed to the 
<code><a href="clinUtils.html#topic+getClinDT">getClinDT</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the <code>outputType</code>:
</p>

<ul>
<li><p>'data.frame-base': input summary table in a long format with
all computed statistics
</p>
</li>
<li><p>'data.frame': summary table in a wide format (
different columns for each <code>colVar</code>), with specified labels
</p>
</li>
<li><p>'flextable' (by default): <code><a href="flextable.html#topic+flextable">flextable</a></code>
object with summary table
</p>
</li>
<li><p>'DT': <code><a href="DT.html#topic+datatable">datatable</a></code> object with summary table
</p>
</li></ul>

<p>If multiple <code>outputType</code> are specified, a list of those objects, named
by <code>outputType</code>.<br />
If <code>byVar</code> is specified, each object consists of a list of tables,
one for each element in <code>byVar</code>.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='interactionCustom'>Compute the interaction between variable(s),
without propagating the missing values (if present in one of the variable)
unlike the behaviour with <code><a href="base.html#topic+interaction">interaction</a></code>.
This also ensure that the levels of the final interaction variables
are ordered similarly as the levels of the input <code>var</code> (if present).</h2><span id='topic+interactionCustom'></span>

<h3>Description</h3>

<p>Compute the interaction between variable(s),
without propagating the missing values (if present in one of the variable)
unlike the behaviour with <code><a href="base.html#topic+interaction">interaction</a></code>.
This also ensure that the levels of the final interaction variables
are ordered similarly as the levels of the input <code>var</code> (if present).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interactionCustom(data, var, varDataLevels = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interactionCustom_+3A_data">data</code></td>
<td>
<p>Data.frame with data.</p>
</td></tr>
<tr><td><code id="interactionCustom_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) to consider.</p>
</td></tr>
<tr><td><code id="interactionCustom_+3A_vardatalevels">varDataLevels</code></td>
<td>
<p>(optional) Data.frame with data to consider
to define the levels of the variable.
If not specified, only the combinations of variable(s) available in the data are retained.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with:
</p>

<ul>
<li><p>'x': factor with interaction between the input <code>var</code>
</p>
</li>
<li><p>'dataLevels': data.frame with mapping between the <code>var</code> 
variable(s) and the new factor levels
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='inTextSummaryTable-common-args'>Arguments used across the functions of the inTextSummaryTable package.</h2><span id='topic+inTextSummaryTable-common-args'></span>

<h3>Description</h3>

<p>Arguments used across the functions of the inTextSummaryTable package.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inTextSummaryTable-common-args_+3A_data">data</code></td>
<td>
<p>Data.frame with dataset to consider for the summary table.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_summarytable">summaryTable</code></td>
<td>
<p>A <code><a href="#topic+summaryTable">summaryTable</a></code> object.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_var">var</code></td>
<td>
<p>Character vector with variable(s) of <code>data</code>, 
to compute statistics on.<br />
If NULL (by default), counts by row/column variable(s) are computed.<br />
To also return counts of the <code>rowVar</code> in case other <code>var</code>
are specified, you can include: 'all' in the <code>var</code>.<br />
Missing values, if present, are filtered 
(also for the report of number of subjects/records).</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_varflag">varFlag</code></td>
<td>
<p>Character vector, subset of <code>var</code> with variable(s) 
of type 'flag' (with 'Y', 'N' or &rdquo; for empty/non specified value).
Only the counts for records flagged (with 'Y') are retained.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_varlabinclude">varLabInclude</code></td>
<td>
<p>Logical, if TRUE
the name of the summary statistic variable(s) (<code>var</code>)
are included in the table.
This is automatically set to TRUE if more than one variable(s) 
and is specified, and FALSE if only one variable is specified.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_rowvar">rowVar</code></td>
<td>
<p>Character vector with variable(s)
to be included in the rows.
If multiple variables are specified, the variables should 
be sorted in hierarchical order
(e.g. body system class before adverse event term)
and are nested in the table.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_rowvarinsepcol">rowVarInSepCol</code></td>
<td>
<p>Character vector with <code>rowVar</code>
that should be included in separated columns.
By default (NULL), all row variables are nested in the first column 
of the table.<br />
To include the groups within a <code>var</code> variable in a separated column, 
set: <code>rowVarInSepCol == 'variableGroup'</code>.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_rowvarlab">rowVarLab</code></td>
<td>
<p>Named character vector with 
label for the <code>rowVar</code> variable(s).</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_statsvar">statsVar</code></td>
<td>
<p>Character vector with columns of <code>summaryTable</code> with
statistic variables. For the export: if not specified, all columns of <code>data</code>
besides row, column variables, 'variable', 'variableGroup'
and 'isTotal' are considered.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_rowvartotalinclude">rowVarTotalInclude</code></td>
<td>
<p>Character vector with <code>rowVar</code>
for which the total should be reported.<br />
If the higher row variable is specified, the total across all rows
is reported. <br />
For the export, these variable(s) are formatted as factor with 
<strong>'Total' as the first level</strong>.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_rowvartotalinseprow">rowVarTotalInSepRow</code></td>
<td>
<p>Character vector with <code>rowVarTotalInclude</code>
(not in <code>rowVarInSepCol</code>) for which the total should be included in a separated row labelled 'Total'.
Otherwise (by default) the total is included in the header row of each category.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_colvar">colVar</code></td>
<td>
<p>Character vector with variable(s) to be included in columns.
If multiple variables are specified, the variables should 
be sorted in hierarchical order,
and are included in multi-columns layout.<br />
Use: 'variable' to include the variables to summarize: <code>var</code>
(if multiple) in different columns.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_coltotalinclude">colTotalInclude</code></td>
<td>
<p>Logical, if TRUE (FALSE by default) include the summary 
statistics across columns in a separated column.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_coltotallab">colTotalLab</code></td>
<td>
<p>String, label for the total column  'Total' by default.<br /></p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_subjectvar">subjectVar</code></td>
<td>
<p>String, variable of <code>data</code> with subject ID,
'USUBJID' by default.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_statslayout">statsLayout</code></td>
<td>
<p>String with layout for the statistics names 
(in case more than one statistic is included), among:
</p>

<ul>
<li><p>row (by default for 'flextable' output): <br /> All statistics are
included in different rows in the first column of the table (after the row variable(s))
</p>
</li>
<li><p>'col' (by default for 'DT' output): <br /> Statistics are included 
in separated columns (last row of the header).<br />
This option is not compatible with categorical variable(s).
</p>
</li>
<li><p>'rowInSepCol': <br /> Statistics are included in different rows, 
but in a separated column than the <code>rowVar</code> variable(s)
</p>
</li></ul>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_statsvaluelab">statsValueLab</code></td>
<td>
<p>String with label for the statistic value, 
'StatisticValue' by default.<br />
This is only included in the table if the statistics provided in 
<code>stats</code> are not named and if no <code>colVar</code> is specified.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_statsextra">statsExtra</code></td>
<td>
<p>(optional) Named list with functions for additional custom
statistics to be computed.<br />
Each function:
</p>

<ul>
<li><p>has as parameter, either: 'x': the variable (<code>var</code>) to compute
the summary statistic on or 'data': the entire dataset
</p>
</li>
<li><p>returns the corresponding summary statistic as a numeric vector
</p>
</li></ul>

<p>For example, to additionally compute the coefficient of variation, this can be set to:
<code>list(statCVPerc = function(x) sd(x)/mean(x)*100)</code> (or <code><a href="#topic+cv">cv</a></code>).</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_type">type</code></td>
<td>
<p>String with type of table: 
</p>

<ul>
<li><p>'summaryTable': summary table with statistics for numeric variable
</p>
</li>
<li><p>'countTable': count table
</p>
</li>
<li><p>'auto' (by default): 'summaryTable' if the variable is numeric,
'countTable' otherwise
</p>
</li></ul>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_statslabinclude">statsLabInclude</code></td>
<td>
<p>Logical, if TRUE include the statistic label
in the table. <br /> By default only included if more than
one statistic variables are available in the table.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_title">title</code></td>
<td>
<p>Character vector with title(s) for the table.
Set to NULL (by default) if no title should be included.
If multiple are specified, specified for each element of <code>byVar</code> (in order of the levels).</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_pagedim">pageDim</code></td>
<td>
<p>Numeric vector of length 2 with page width and height.<br />
Depending on <code>outputType</code>:
</p>

<ul>
<li><p>'flextable': in inches
</p>
</li>
<li><p>'DT': in number of rows in the table.<br />
Currently only the height is used (e.g. <code>c(NA, 4)</code>)
</p>
</li></ul>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_columnswidth">columnsWidth</code></td>
<td>
<p>(expert mode) Column widths of the table. This is only used 
for flextable and DT tables.<br />
For flextable, note that the widths should be set to fit into the document page
(see <code><a href="#topic+getDimPage">getDimPage</a></code>).</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-common-args_+3A_labelvars">labelVars</code></td>
<td>
<p>(optional) Named character vector with label for
the row, column variable(s) or variable(s) to summarize. <br />
Labels specified via dedicated parameter: e.g. 
<code>rowVarLab</code>, <code>colVarLab</code>, <code>varLab</code>
have priority on this parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, used for the documentation of R functions
</p>

<hr>
<h2 id='inTextSummaryTable-DT-args'>Common arguments for the functionalities of the inTextSummaryTable package
for DT export.</h2><span id='topic+inTextSummaryTable-DT-args'></span>

<h3>Description</h3>

<p>Common arguments for the functionalities of the inTextSummaryTable package
for DT export.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inTextSummaryTable-DT-args_+3A_expandvar">expandVar</code></td>
<td>
<p>(DT output) Character vector with variables of the summary table which
should be expanded in the data.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-DT-args_+3A_pagedim">pageDim</code></td>
<td>
<p>(DT output) Numeric vector of length 2 with page width and height,
in number of rows (currently only
the height is used (e.g. <code>c(NA, 4)</code>)</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-DT-args_+3A_noescapevar">noEscapeVar</code></td>
<td>
<p>(DT output) Character vector with variables of <code>summaryTable</code>
which shouldn't be escaped in the table (e.g. containing URLs).</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-DT-args_+3A_barvar">barVar</code></td>
<td>
<p>(DT output) Character vector with variables of <code>summaryTable</code>
that should be represented as a bar.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-DT-args_+3A_file">file</code></td>
<td>
<p>String with path of the file where the table should be exported.
The file should have the extension: '.docx'.
If NULL, the summary table is not exported but only returned as output.
If <code>byVar</code> is specified, each table is exported to a separated
file with the suffix: 'file_[i].docx' with i the index of the file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, used for the documentation of 
R functions for 'DT' output
</p>

<hr>
<h2 id='inTextSummaryTable-flextable-args'>Common arguments for the functionalities of the inTextSummaryTable package
for flextable export.</h2><span id='topic+inTextSummaryTable-flextable-args'></span>

<h3>Description</h3>

<p>Common arguments for the functionalities of the inTextSummaryTable package
for flextable export.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_style">style</code></td>
<td>
<p>(flextable output) String with table style,
either 'report' or 'presentation'.
This parameter affects the fontsize, font family, color of the text and background, 
and table dimensions of the table.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_rowtotallab">rowTotalLab</code></td>
<td>
<p>(flextable output) string with label for the row with total.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_rowautomerge">rowAutoMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (by default) automatically merge rows,
e.g. in case there is only one sub-category (e.g. categorical variable with only one group)
or only one statistic per category.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_rowvarformat">rowVarFormat</code></td>
<td>
<p>(flextable output) Named list with special formatting for the <code>rowVar</code>.
Currently, only possibility is to set the variable elements in bold, with:
list(var1 = &quot;bold&quot;).
(Use 'variable' for <code>var</code> or 'variableGroup' for group within categorical variables.)</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_rowpadbase">rowPadBase</code></td>
<td>
<p>(flextable output) Base padding for row (in points), 
14.4 by default (corresponds to 0.2 inches)</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_fontname">fontname</code></td>
<td>
<p>(flextable output) String with font name, by default:
'Times' if <code>style</code> is 'report' and 'Tahoma' if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_fontsize">fontsize</code></td>
<td>
<p>(flextable output) Integer with font size, by default:
8 if <code>style</code> is 'report' and 10 if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_margin">margin</code></td>
<td>
<p>(flextable output) Margin in the document in inches
(1 by default).
This is used to specify the width of the table, from:
[<code>pageDim[1]</code> - 2 * margin].</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_colortable">colorTable</code></td>
<td>
<p>(flextable output) Named character vector with color for the table background/body/text/line,
e.g. created with the <code><a href="#topic+getColorPaletteTable">getColorPaletteTable</a></code> function.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_landscape">landscape</code></td>
<td>
<p>(flextable output) Logical, if TRUE the file is in landscape format.<br />
By default: FALSE if <code>style</code> is 'report' and TRUE if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_footer">footer</code></td>
<td>
<p>(flextable output) Character vector with footer(s) for the table.
Set to NULL (by default) if no footer should be included.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_vline">vline</code></td>
<td>
<p>(flextable output) String mentioning how vertical lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none' (default): no vertical lines included
</p>
</li>
<li><p>'auto': vertical lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_hline">hline</code></td>
<td>
<p>(flextable output) String mentioning how horizontal lines 
should be included in the body of the table, either: 
</p>

<ul>
<li><p>'none': no horizontal lines included
</p>
</li>
<li><p>'auto' (default): horizontal lines included between sub-groups
</p>
</li></ul>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_file">file</code></td>
<td>
<p>String with path of the file where the table should be exported.
The file should have the extension: '.html'.
If NULL, the summary table is not exported but only returned as output.
If <code>byVar</code> is specified, each table is exported to a separated
file with the suffix: 'file_[i].html' with i the index of the file.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-flextable-args_+3A_colheadermerge">colHeaderMerge</code></td>
<td>
<p>(flextable output) Logical, if TRUE (FALSE by default) 
the column header is merged.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, used for the documentation of 
R functions for 'flextable' output
</p>

<hr>
<h2 id='inTextSummaryTable-stats'>Statistics in the in-text table package.</h2><span id='topic+inTextSummaryTable-stats'></span>

<h3>Description</h3>

<p>In the in-text package, different set of statistics are available.
</p>


<h3>Details</h3>

<p>The statistics are first computed as numeric
('Base statistics' section below),
then formatted to be displayed in the table
('Formatted statistics' section below).
</p>


<h3>Value</h3>

<p>No return value, used for the documentation of 
the <code>stats</code> parameter
</p>


<h3>Base statistics</h3>

<p>In the in-text package, the following 'base
statistics' are reported in the summary table:
</p>

<ul>
<li><p>for a continuous variable: 
</p>

<ul>
<li><p>'statMean': variable mean
</p>
</li>
<li><p>'statSD': variable standard deviation
</p>
</li>
<li><p>'statSE': variable standard error
</p>
</li>
<li><p>'statMedian': variable median
</p>
</li>
<li><p>'statMin': variable minimum
</p>
</li>
<li><p>'statMax': variable maximum
</p>
</li></ul>

<p>During the computation of the statistics,
if multiple and different values are available for a specific variable
and subject ID (by row/column): an error is triggered.

</p>
</li>
<li><p>for a categorical and continuous variable (or the full table): 
</p>

<ul>
<li><p>'statN': number of subjects
</p>
</li>
<li><p>'statm': number of records
</p>
</li>
<li><p>'statPercN' (or 'statPercm'): percentage of subjects
(or records) for the specific group
</p>
</li>
<li><p>'statPercTotalN' (or 'statPercTotalm'): number of subjects 
(or records) considered for the total (denominator) of the percentage
</p>
</li></ul>

<p>The percentage and denominator of the percentage are based
on the number of subjects or records depending on
the <code>statsPerc</code> parameter.

</p>
</li></ul>

<p>These statistics are reported as numeric and
non rounded in the summary table, and are
typically used as input for the formatted statistics,
or for plots.
</p>


<h3>Formatted statistics</h3>

<p>In the in-text package, the following formatted
statistics can be reported in the final output table.
</p>

<ul>
<li><p>for a continuous variable: 
</p>

<ul>
<li><p>base statistics: 
</p>

<ul>
<li><p>'Mean': formatted mean
</p>
</li>
<li><p>'Median': formatted median
</p>
</li>
<li><p>'SE': formatted standard error
</p>
</li>
<li><p>'SD': formatted standard deviation
</p>
</li>
<li><p>'Min': formatted minimum
</p>
</li>
<li><p>'Max': formatted maximum
</p>
</li></ul>

</li>
<li><p>multiple: 
</p>

<ul>
<li><p>'summary-default': default set of statistics for a continuous variable:
'n', 'Mean', 'SD', 'SE', 'Median', 'Min', 'Max'
</p>
</li>
<li><p>'summary': all statistics available for a continuous variable:
'n', 'Mean', 'SD', 'SE', 'Median', 'Min', 'Max', '%', 'm'
</p>
</li></ul>

</li>
<li><p>combined statistics: 
</p>

<ul>
<li><p>'median (range)': median (minimum,maximum)
</p>
</li>
<li><p>'median\n(range)': median and (minimum, maximum) below (linebreak)
</p>
</li>
<li><p>'mean (sd)': mean and standard deviation
</p>
</li>
<li><p>'mean (se)': mean and standard error
</p>
</li>
<li><p>'mean (range)': mean and (minimum, maximum)
</p>
</li>
<li><p>'(min, max)': (minimum, maximum)
</p>
</li></ul>

</li></ul>

</li>
<li><p>for a categorical or continuous variable (or the full table): 
</p>

<ul>
<li><p>base statistics: 
</p>

<ul>
<li><p>'n': formatted number of subjects
</p>
</li>
<li><p>'m': formatted number of records
</p>
</li>
<li><p>'%': formatted percentage of subjects
</p>
</li>
<li><p>'%m': formatted percentage of records.<br />
Note: this is only available if the percentage of records is reported
(<code>statsPerc</code> set to 'statm').
</p>
</li></ul>

</li>
<li><p>multiple: 
</p>

<ul>
<li><p>'count-default': default set of statistics for a categorical variable:
'n', '%'
</p>
</li>
<li><p>'count': all statistics available for a categorical variable: 'n', '%', 'm'
</p>
</li></ul>

</li>
<li><p>combined statistics: 
</p>

<ul>
<li><p>'n (%)': number of subjects (and associated percentage)
</p>
</li>
<li><p>'n/N (%)': number of subjects/total number of subjects (percentage)
</p>
</li>
<li><p>'m (%)': number of records (and associated percentage).<br />
Note: this is only available if the percentage of records is reported
(<code>statsPerc</code> set to 'statm').
</p>
</li></ul>

</li></ul>

<p>#' These statistics are specified via the <code>stats</code> parameter 
(or <code>type</code> parameter of <code><a href="#topic+getStats">getStats</a></code>).<br />
These statistics are reported as text variables
in the summary table (as data.frame),
and typically displayed inside the final table.
</p>
</li></ul>



<h3>Statistics formatting</h3>


<ul>
<li><p>In general, all rounding is handled with <code><a href="clinUtils.html#topic+roundHalfUpTextFormat">roundHalfUpTextFormat</a></code>.
</p>
</li>
<li><p>statistics for continuous variable: 
</p>

<ul>
<li><p>if the number of decimals (<code>nDecCont</code>) is specified: 
<br /> statistics are rounded with the following number of decimals,
based on:
</p>

<ul>
<li><p>'Min', 'Max': <code>nDecCont</code>
</p>
</li>
<li><p>'Mean', 'SD', 'Median': <code>nDecCont</code> + 1
</p>
</li>
<li><p>'SE': <code>nDecCont</code> + 2
</p>
</li></ul>

<p>Note that the number of decimals is extracted
from standard rules/data is the variable of interest 
is specified (e.g. via <code>var</code> in <code><a href="#topic+getStatsData">getStatsData</a></code>).

</p>
</li>
<li><p>if the number of decimals is not specified: 
<br /> a default format is set via the <code><a href="base.html#topic+formatC">formatC</a></code> function.
</p>
</li></ul>

</li>
<li><p>statistics for counts:
</p>

<ul>
<li><p>number of subjects, records are rounded with the number of decimals
specified via <code>nDecN</code> or <code>nDecm</code> (0 by default)
</p>
</li>
<li><p>percentages are formatted by default with <code><a href="#topic+formatPercentage">formatPercentage</a></code>.
</p>
</li>
<li><p>'n (%)' and 'm (%)':  
</p>

<ul>
<li><p>if the percentage of subjects/records is missing, '-' is reported
</p>
</li>
<li><p>if the number of subjects/records is 0, '0' is reported instead of '0 (0%)'
</p>
</li>
<li><p>otherwise the number and percentage of subjects/records are formatted as specified
</p>
</li></ul>

</li>
<li><p>'n/N (%)': 
</p>

<ul>
<li><p>if the percentage of subjects is missing, '-' is reported
</p>
</li>
<li><p>if the number of subjects is 0, '0' is reported instead of '0/... (0%)'
</p>
</li>
<li><p>otherwise the number and percentage of subjects and total are formatted as specified
</p>
</li></ul>

</li></ul>

</li></ul>


<hr>
<h2 id='inTextSummaryTable-stats-utility'>Common arguments for the for the statistics utility functions
of the inTextSummaryTable package.</h2><span id='topic+inTextSummaryTable-stats-utility'></span>

<h3>Description</h3>

<p>Common arguments for the for the statistics utility functions
of the inTextSummaryTable package.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inTextSummaryTable-stats-utility_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="inTextSummaryTable-stats-utility_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical, should NA value(s) be removed (FALSE by default)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, used for the documentation of 
stat utility R functions
</p>

<hr>
<h2 id='mergeHeaderCols'>Merge columns and rows in the header of a flextable object.</h2><span id='topic+mergeHeaderCols'></span>

<h3>Description</h3>

<p>This:
</p>

<ul>
<li><p>(1) for each row: checks that subsequent columns are identical (and corresponding
sub-header overlap), so should be merged
</p>
</li>
<li><p>(2) for each column: checks that subsequent rows are identical, so should be
merged
</p>
</li>
<li><p>filters cells planned to be merged across rows (2) if they are already
merged across columns (1)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>mergeHeaderCols(x, mapping)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mergeHeaderCols_+3A_x">x</code></td>
<td>
<p>a <code>flextable</code> object</p>
</td></tr>
<tr><td><code id="mergeHeaderCols_+3A_mapping">mapping</code></td>
<td>
<p>a <code>data.frame</code> specyfing for each colname
content of the column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updated flextable object with merged cells in the header.
</p>

<hr>
<h2 id='pageDimPresentation'>Page dimension for powerpoints</h2><span id='topic+pageDimPresentation'></span>

<h3>Description</h3>

<p>Page dimension for powerpoints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pageDimPresentation
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 2.
</p>

<hr>
<h2 id='postProcessVarFlag'>Post-process the summary statistics table with variable flag.</h2><span id='topic+postProcessVarFlag'></span>

<h3>Description</h3>

<p>This function is for internal use within
the <code><a href="#topic+computeSummaryStatisticsTable">computeSummaryStatisticsTable</a></code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>postProcessVarFlag(summaryTable, varFlag)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="postProcessVarFlag_+3A_summarytable">summaryTable</code></td>
<td>
<p>Summary table as created internally in
<code><a href="#topic+computeSummaryStatisticsTable">computeSummaryStatisticsTable</a></code>.</p>
</td></tr>
<tr><td><code id="postProcessVarFlag_+3A_varflag">varFlag</code></td>
<td>
<p>Character vector, subset of <code>var</code> with variable(s) 
of type 'flag' (with 'Y', 'N' or &rdquo; for empty/non specified value).
Only the counts for records flagged (with 'Y') are retained.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This includes:
</p>

<ul>
<li><p>converting the records from a flag variable
for the 'variableGroup' variable 
from 'Y' to <code>NA_character_</code>

</p>
</li>
<li><p>filter records from a flag variable 
with variableGroup set as 'N'
</p>
</li></ul>



<h3>Value</h3>

<p>Summary table with
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='se'>Compute standard error of the mean.</h2><span id='topic+se'></span>

<h3>Description</h3>

<p>The standard error of the mean is computed as:
<code class="reqn">\frac{\sigma(x)}{\sqrt{length(x)}}</code>, with:<br />
<code class="reqn">\sigma(x)</code>: standard deviation of <code>x</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>se(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="se_+3A_x">x</code></td>
<td>
<p>Numeric vector.</p>
</td></tr>
<tr><td><code id="se_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical, should NA value(s) be removed (FALSE by default)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with standard error of the mean
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other stats utility functions: 
<code><a href="#topic+cv">cv</a>()</code>,
<code><a href="#topic+geomCV">geomCV</a>()</code>,
<code><a href="#topic+geomMean">geomMean</a>()</code>,
<code><a href="#topic+geomSD">geomSD</a>()</code>,
<code><a href="#topic+geomSE">geomSE</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>se(rnorm(1000))
</code></pre>

<hr>
<h2 id='smoothPadding'>Smooth padding, e.g. remove padding bigger than 1</h2><span id='topic+smoothPadding'></span>

<h3>Description</h3>

<p>Smooth padding, e.g. remove padding bigger than 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothPadding(pad)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smoothPadding_+3A_pad">pad</code></td>
<td>
<p>Integer vector with padding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer vector with 'smooth' padding.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='subjectProfileSummaryPlot'>Plot subject summary profile.</h2><span id='topic+subjectProfileSummaryPlot'></span>

<h3>Description</h3>

<p>The user can either specify a variable for the standard error
(<code>seVar</code>),
or directly the variables for the minimum and maximum values for the error
bars (<code>minVar</code>, <code>maxVar</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subjectProfileSummaryPlot(
  data,
  xVar = NULL,
  xLab = getLabelVar(xVar, labelVars = labelVars),
  xAxisExpand = waiver(),
  xGap = NULL,
  xGapDiffNew = NULL,
  meanVar = "statMean",
  seVar = if ("statSE" %in% colnames(data)) "statSE",
  minVar = NULL,
  maxVar = NULL,
  yLab = paste(c(sub("^stat", "", meanVar), if (!is.null(minVar) &amp; !is.null(maxVar)) {
  
      paste0("(", sub("^stat", "", minVar), ", ", sub("^stat", "", maxVar), ")")
 } else
    if (!is.null(seVar)) paste("+-", sub("^stat", "", seVar))), collapse = " "),
  facetVar = NULL,
  facetScale = "free_y",
  colorVar = NULL,
  colorLab = getLabelVar(colorVar, labelVars = labelVars),
  colorPalette = NULL,
  labelVars = NULL,
  useLinetype = TRUE,
  linetypePalette = NULL,
  useShape = TRUE,
  shapePalette = NULL,
  jitter = NULL,
  title = NULL,
  caption = NULL,
  yTrans = NULL,
  yLim = NULL,
  xLim = NULL,
  yAxisExpand = c(0.05, 0.05),
  yLimExpand = NULL,
  xAxisLabs = NULL,
  sizePoint = GeomPoint$default_aes$size,
  sizeLine = GeomLine$default_aes$size,
  sizeLabel = GeomText$default_aes$size,
  widthErrorBar = GeomErrorbar$default_aes$width,
  tableText = NULL,
  tableTextFontface = 1,
  tableHeight = 0.1,
  tableYAxisLabs = !is.null(colorVar),
  tablePlotMargin = unit(0, "pt"),
  label = FALSE,
  labelPadding = unit(1, "lines"),
  byVar = NULL,
  hLine = NULL,
  hLineColor = "black",
  hLineLty = "solid",
  vLine = NULL,
  vLineColor = "black",
  vLineLty = "solid",
  style = "report",
  fontname = switch(style, report = "Times", presentation = "Tahoma"),
  fontsize = switch(style, report = 8, presentation = 10),
  themeFct = switch(style, report = theme_classic, presentation = theme_bw),
  themeIncludeVerticalGrid = TRUE,
  ggExtra = NULL,
  legendPosition = ifelse(!is.null(tableText), "none", "bottom"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subjectProfileSummaryPlot_+3A_data">data</code></td>
<td>
<p>Data.frame with summary statistics to represent in the plot,
e.g. a <code><a href="#topic+summaryTable">summaryTable</a></code> object.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_xvar">xVar</code></td>
<td>
<p>String, variable of <code>data</code> with variable for the x-axis.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_xlab">xLab</code></td>
<td>
<p>String with label for the <code>xVar</code>.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_xaxisexpand">xAxisExpand</code></td>
<td>
<p>Object passed to the 'expand' parameter of:
<code><a href="ggplot2.html#topic+scale_x_continuous">scale_x_continuous</a></code>,
(<code><a href="ggplot2.html#topic+waiver">waiver</a></code> by default).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_xgap">xGap</code></td>
<td>
<p>(optional) Numeric vector of length 2 for which
a gap should be created in the x-axis.
Only available if <code>xVar</code> is specified and a numeric variable.
Records with <code>xVar</code> within <code>xGap</code> are filtered from the plot,
vertical lines are included at the min/max of the gap,
and the gap is represented as '//' in the x-axis of the plot.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_xgapdiffnew">xGapDiffNew</code></td>
<td>
<p>Numeric vector of length 2 with new range
of the <code>xGap</code>. If not specified, the minimum difference between
consecutive x elements in the data is used.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_meanvar">meanVar</code></td>
<td>
<p>String, variable of <code>data</code> with the mean variable.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_sevar">seVar</code></td>
<td>
<p>String, variable of <code>data</code> with the standard error.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_minvar">minVar</code>, <code id="subjectProfileSummaryPlot_+3A_maxvar">maxVar</code></td>
<td>
<p>String, variables of <code>data</code> with minimum and
maximum value for error bar. 
If both are specified, <code>seVar</code> is ignored.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_ylab">yLab</code></td>
<td>
<p>String with label for the y-axis.
If different labels should be used for different elements of
<code>byVar</code> variable, the vector should be named
with each corresponding element (collapsed with '.' if multiple).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_facetvar">facetVar</code></td>
<td>
<p>Character vector, variable(s) of <code>data</code> for facetting.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_facetscale">facetScale</code></td>
<td>
<p>String with type of scale used for facetting, 'free_y' by default
(fixed scale in the x-axis and free in the y-axis).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_colorvar">colorVar</code></td>
<td>
<p>String, variable of <code>data</code> for coloring.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_colorlab">colorLab</code></td>
<td>
<p>String, label for <code>colorVar</code>, used in the legend.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_colorpalette">colorPalette</code></td>
<td>
<p>(named) Vector with color palette.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_labelvars">labelVars</code></td>
<td>
<p>Named string with variable labels (names are the variable code).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_uselinetype">useLinetype</code></td>
<td>
<p>Logical, if TRUE (FALSE by default) use also linetype
to differenciate the variable specified via <code>colorVar</code> in the mean line.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_linetypepalette">linetypePalette</code></td>
<td>
<p>Vector with linetype(s), in case <code>useLinetype</code> is TRUE.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_useshape">useShape</code></td>
<td>
<p>Logical, if TRUE (by default) <code>colorVar</code> is also used for the shape.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_shapepalette">shapePalette</code></td>
<td>
<p>Named vector with shape palette for <code>colorVar</code>.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_jitter">jitter</code></td>
<td>
<p>Numeric with jitter for the x-axis, only used if <code>colorVar</code> specified.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_title">title</code></td>
<td>
<p>String with title for the plot.
If different labels should be used for different elements of
<code>byVar</code> variable, the vector should be named
with each corresponding element (collapsed with '.' if multiple).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_caption">caption</code></td>
<td>
<p>String with caption for the plot,
NULL by default.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_ytrans">yTrans</code></td>
<td>
<p>(optional) String with transformation for the y-axis.
Currently only 'log10' (or NULL, default) is available.
In case error bars go in the negative, their values are set to a 'small enough' value for plotting:
<code>min(data)/10</code> or <code>yLim[1]</code> if <code>yLim</code> is specified.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_ylim">yLim</code></td>
<td>
<p>Vector of the length 2 with limits for the y-axis.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_xlim">xLim</code></td>
<td>
<p>Vector of the length 2 with limits for the x-axis.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_yaxisexpand">yAxisExpand</code></td>
<td>
<p>Expansion constants for the limits for the y-axis.
See the documentation of the <code>expand</code> parameter of the 
<code><a href="ggplot2.html#topic+scale_y_continuous">scale_y_continuous</a></code> function
for the available values for this parameter.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_ylimexpand">yLimExpand</code></td>
<td>
<p>This parameter is deprecated, use <code>yAxisExpand</code>
instead.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_xaxislabs">xAxisLabs</code></td>
<td>
<p>(optional) Named character vector with labels for the x-axis.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_sizepoint">sizePoint</code></td>
<td>
<p>Size for the point.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_sizeline">sizeLine</code></td>
<td>
<p>Size for the line linking means and error bars.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_sizelabel">sizeLabel</code></td>
<td>
<p>Size for the label, only used if <code>label</code> is not NULL.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_widtherrorbar">widthErrorBar</code></td>
<td>
<p>Numeric vector of length 1 with width of error bar.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_tabletext">tableText</code></td>
<td>
<p>(optional) Character vector with colname of <code>data</code>
or expression from colnames of <code>data</code> to be represented in
the table below the plot.
By default, no table is displayed.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_tabletextfontface">tableTextFontface</code></td>
<td>
<p>Font face for the text included
in the table.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_tableheight">tableHeight</code></td>
<td>
<p>Numeric of length 1 with height for the table.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_tableyaxislabs">tableYAxisLabs</code></td>
<td>
<p>Logical, if TRUE (by default)
the labels of the <code>colorVar</code> are included
in the y-axis of the table.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_tableplotmargin">tablePlotMargin</code></td>
<td>
<p>Margin between the plot and the table,
expressed as <code><a href="grid.html#topic+unit">unit</a></code>, 0 by default.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_label">label</code></td>
<td>
<p>Logical or expression or list of expression.
Points are labelled with <code>meanVar</code> if set to TRUE,
or with the specified expression if <code>label</code> is an expression.
If a list is specified, 'textLabel' (required) 
should contain expression to extract label, 
and 'textHjust' and 'textVjust' (optional) may contain expression 
specifying horizontal and vertical adjustment of the label.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_labelpadding">labelPadding</code></td>
<td>
<p>Amount of padding (space) between each point
and its <code>label</code>, 1.5 lines by default.
See parameter <code>point.padding</code> of the
<code><a href="ggrepel.html#topic+geom_text_repel">geom_text_repel</a></code> function.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_byvar">byVar</code></td>
<td>
<p>Variable(s) of <code>data</code> for which separated plot(s)
should be created.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_hline">hLine</code></td>
<td>
<p>(optional) numeric with y-intercept of line(s) to be added.
If different thresholds should be used for different elements of the 
<code>byVar</code> or <code>facetVar</code> variables, the vector should be named
with each corresponding element (collapsed with '.' if multiple).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_hlinecolor">hLineColor</code></td>
<td>
<p>String with color for <code>hLine</code>, 'black' by default.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_hlinelty">hLineLty</code></td>
<td>
<p>String with linetype for <code>hLine</code>, 'solid' by default.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_vline">vLine</code></td>
<td>
<p>(optional) numeric with x-intercept of line(s) to be added.
If different thresholds should be used for different elements of the 
<code>byVar</code> or <code>facetVar</code> variables, the vector should be named
with each corresponding element (collapsed with '.' if multiple).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_vlinecolor">vLineColor</code></td>
<td>
<p>String with color for <code>vLine</code>, 'black' by default.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_vlinelty">vLineLty</code></td>
<td>
<p>String with linetype for <code>vLine</code>, 'solid' by defaul</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_style">style</code></td>
<td>
<p>String with subject profile style.
This affects the parameters: <code>fontname</code>, <code>fontsize</code>
and <code>themeFct</code>.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_fontname">fontname</code></td>
<td>
<p>String with font name,
by default 'Times' if <code>style</code> is 'report' and
'Tahoma' if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_fontsize">fontsize</code></td>
<td>
<p>Numeric vector of length 1 with font size,
by default 8 if <code>style</code> is 'report' and
10 if <code>style</code> is 'presentation'</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_themefct">themeFct</code></td>
<td>
<p>Function with ggplot2 theme,
by default <code><a href="ggplot2.html#topic+theme_classic">theme_classic</a></code> if <code>style</code> is 'report' and
<code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code> if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_themeincludeverticalgrid">themeIncludeVerticalGrid</code></td>
<td>
<p>Logical, if TRUE (by default)
include theme vertical grid lines (if present in <code>themeFct</code>).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_ggextra">ggExtra</code></td>
<td>
<p>Extra <code>ggplot</code> call of function generating such call(s)
to be added in main plot.<br />
Multiple calls are set via a function, e.g. 
<code>ggExtra = function(gg){gg + geom_vline(...) + geom_hline(...)}</code>.<br />
If different calls should be used for different elements of the 
<code>byVar</code> variable, the vector should be named
with each corresponding element (collapsed with '.' if multiple).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_legendposition">legendPosition</code></td>
<td>
<p>String with legend position.
By default, 'bottom' of <code>tableText</code> is not specified,
'none' otherwise.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryPlot_+3A_...">...</code></td>
<td>
<p>Additional parameters for <code><a href="ggrepel.html#topic+geom_text_repel">geom_text_repel</a></code> or
<code><a href="ggplot2.html#topic+geom_text">geom_text</a></code>
used for the <code>label</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object or list of such
objects of <code>byVar</code> is specified.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='subjectProfileSummaryTable'>Plot a table with <code>ggplot</code> of a text variable of interest.</h2><span id='topic+subjectProfileSummaryTable'></span>

<h3>Description</h3>

<p>The labels extracted based on the <code>text</code> parameter 
and displayed at the x-position based on <code>xVar</code> and the y-position based on
<code>colorVar</code>.
Each group specified in the color variables are displayed in different
lines in the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subjectProfileSummaryTable(
  data,
  xVar,
  text,
  xLim = NULL,
  colorVar = NULL,
  colorPalette = NULL,
  colorLab = getLabelVar(colorVar, labelVars = labelVars),
  fontface = 1,
  xLab = NULL,
  labelVars = NULL,
  caption = NULL,
  showLegend = TRUE,
  legendPosition = ifelse(showLegend, "right", "none"),
  yAxisLabs = FALSE,
  xAxisLabs = NULL,
  style = "report",
  fontname = switch(style, report = "Times", presentation = "Tahoma"),
  fontsize = switch(style, report = 8, presentation = 10),
  pointSize = 1.5,
  themeFct = switch(style, report = theme_classic, presentation = theme_bw),
  textSize = fontsize/ggplot2::.pt,
  xTrans = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subjectProfileSummaryTable_+3A_data">data</code></td>
<td>
<p>Data.frame (in long format) with data for the table.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_xvar">xVar</code></td>
<td>
<p>String, variable of <code>data</code> with variable for the x-axis.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_text">text</code></td>
<td>
<p>Character vector with colnames of <code>data</code>
or expression based on colnames of <code>data</code> to extract
the text label.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_xlim">xLim</code></td>
<td>
<p>Vector of the length 2 with limits for the x-axis.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_colorvar">colorVar</code></td>
<td>
<p>String, variable of <code>data</code> for coloring.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_colorpalette">colorPalette</code></td>
<td>
<p>(named) Vector with color palette.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_colorlab">colorLab</code></td>
<td>
<p>String, label for <code>colorVar</code>, used in the legend.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_fontface">fontface</code></td>
<td>
<p>Numeric, fontface for the text.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_xlab">xLab</code></td>
<td>
<p>String with label for the x-axis.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_labelvars">labelVars</code></td>
<td>
<p>Named string with variable labels (names are the variable code).</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_caption">caption</code></td>
<td>
<p>String with caption for the plot,
NULL by default.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_showlegend">showLegend</code></td>
<td>
<p>Logical, should the legend be displayed? TRUE by default.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_legendposition">legendPosition</code></td>
<td>
<p>String with legendPosition,
'right' by default.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_yaxislabs">yAxisLabs</code></td>
<td>
<p>Logical, if TRUE include the labels in the y-axis.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_xaxislabs">xAxisLabs</code></td>
<td>
<p>Vector with labels for the x-axis if <code>xVar</code>
is discrete or vector with limits if continuous.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_style">style</code></td>
<td>
<p>String with subject profile style.
This affects the parameters: <code>fontname</code>, <code>fontsize</code>
and <code>themeFct</code>.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_fontname">fontname</code></td>
<td>
<p>String with font name,
by default 'Times' if <code>style</code> is 'report' and
'Tahoma' if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_fontsize">fontsize</code></td>
<td>
<p>Numeric vector of length 1 with font size,
by default 8 if <code>style</code> is 'report' and
10 if <code>style</code> is 'presentation'</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_pointsize">pointSize</code></td>
<td>
<p>Numeric indicating the size of points in the legend, 1.5 by default</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_themefct">themeFct</code></td>
<td>
<p>Function with ggplot2 theme,
by default <code><a href="ggplot2.html#topic+theme_classic">theme_classic</a></code> if <code>style</code> is 'report' and
<code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code> if <code>style</code> is 'presentation'.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_textsize">textSize</code></td>
<td>
<p>Size for the text.</p>
</td></tr>
<tr><td><code id="subjectProfileSummaryTable_+3A_xtrans">xTrans</code></td>
<td>
<p>(optional) ggplot2 transformation
for the x-axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud and Michela Pasetto
</p>

<hr>
<h2 id='summaryTable'><code>summaryTable</code></h2><span id='topic+summaryTable'></span>

<h3>Description</h3>


<ol>
<li><p>The summary statistics are computed in
<code><a href="#topic+computeSummaryStatisticsTable">computeSummaryStatisticsTable</a></code>,
which creates a <code>summaryTable</code> object.
</p>
</li>
<li><p>This object is exported to diverse formats via 
<code><a href="#topic+export">export</a></code>
</p>
</li></ol>

<p>Multiple <code>summaryTable</code> objects are combined
together with <code><a href="#topic+combine.summaryTable">combine.summaryTable</a></code>.
</p>


<h3>Details</h3>

<p>The <code>summaryTable</code> is an intermediary 
object of the package. 
This contains the summary statistics as data.frame.
This object contains:
</p>

<ul>
<li><p>the row and column variable(s)
</p>
</li>
<li><p>the computed statistic(s): <br />
If <code>type</code> is:
</p>

<ul>
<li><p>'summaryTable': 
</p>

<ul>
<li><p>'statN': number of subjects
</p>
</li>
<li><p>'statMean': mean of <code>var</code>
</p>
</li>
<li><p>'statSD': standard deviation of <code>var</code>
</p>
</li>
<li><p>'statSE': standard error of <code>var</code>
</p>
</li>
<li><p>'statMedian': median of <code>var</code>
</p>
</li>
<li><p>'statMin': minimum of <code>var</code>
</p>
</li>
<li><p>'statMax': maximum of <code>var</code>
</p>
</li>
<li><p>'statPerc': percentage of subjects
</p>
</li>
<li><p>'statPercTotalN': total number of subjects based on <code>dataTotalPerc</code>,
denominator of <code>statPerc</code>
</p>
</li>
<li><p>'statm': number of records
</p>
</li></ul>


</li>
<li><p>'countTable': 
</p>

<ul>
<li><p>'statN': number of subjects
</p>
</li>
<li><p>'statPercN' (or 'statPercm'): percentage of subjects
(or records depending on <code>statsPerc</code>)
</p>
</li>
<li><p>'statPercTotalN' (or 'statPercTotalm'): total number of 
subjects (or records) based on <code>dataTotalPerc</code>, and used as
denominator of <code>statPercN</code> (or 'statPercm')
</p>
</li>
<li><p>'statm': number of records
</p>
</li></ul>
</li></ul>


</li>
<li><p>computed statistics.<br />
The statistics are stored in columns corresponding
to names of the <code>statsVar</code>.<br />
If the specified statistics are not named and of length
1, the statistics are stored in a column called: 'Statistic'.
</p>
</li>
<li><p>variables: 
</p>

<ul>
<li><p>'variable': variable name in case <code>var</code> is of length &gt; 1
</p>
</li>
<li><p>'variableGroup': in case <code>var</code> is of length &gt; 1 and for 
variable(s) used for count: elements of the variable
</p>
</li></ul>


</li>
<li><p>'isTotal': variable with logical flag, TRUE if the record contain 
the total by column
</p>
</li></ul>

<p>Additionally, the output contains an extra attribute
'summaryTable', which is a list composed of:
</p>

<ul>
<li><p>'statsVar': column name(s) of summary table with computed statistics
included in the final table
</p>
</li>
<li><p>'rowVar': column name(s) of summary table with row variable
included in the final table. This parameter should be mainly used for qualitative variables and 'nests' together different rows in the final output table.
</p>
</li>
<li><p>'rowVarLab': labels corresponding to the 'rowVar' attribute
</p>
</li>
<li><p>'rowVarTotalInclude': row variables whose total will be included:
<code>rowVarTotalInclude</code> and 'variableGroup' if the variable total should be included
</p>
</li>
<li><p>'rowVarTotalInSepRow': row variables whose total will be included in a separated row:
<code>rowVarTotalInSepRow</code> and 'variableGroup' if <code>varTotalInSepRow</code>
</p>
</li>
<li><p>'colVar': column name(s) of summary table with column variable
included in the final table
</p>
</li>
<li><p>'colTotalLab': label for the total
</p>
</li></ul>



<h3>Value</h3>

<p>Not relevant
</p>

<hr>
<h2 id='tableColorsPresentation'>Colors for tables in a presentation style</h2><span id='topic+tableColorsPresentation'></span>

<h3>Description</h3>

<p>Default colors are
</p>

<ul>
<li><p>header: white text on a blue background
</p>
</li>
<li><p>body: black text on a grey background
</p>
</li>
<li><p>footer: black text on a white background.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>tableColorsPresentation
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 11.
</p>

<hr>
<h2 id='tableColorsReport'>Colors for tables in a report style</h2><span id='topic+tableColorsReport'></span>

<h3>Description</h3>

<p>Default colors are black text on a white background.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableColorsReport
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 7.
</p>

<hr>
<h2 id='uniqueVarWithOrder'>Get unique variables with meaningful order.</h2><span id='topic+uniqueVarWithOrder'></span>

<h3>Description</h3>

<p>The following framework is followed:
</p>

<ol>
<li><p>get the unique elements in the vectors
</p>
</li>
<li><p>for each of this element: get the average order across
the different vectors
</p>
</li>
<li><p>put <code>variable</code>, if present as second to last element
</p>
</li>
<li><p>put <code>variableGroup</code>, if present, as last element
</p>
</li>
<li><p>order the unique elements based on the extracted order
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>uniqueVarWithOrder(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uniqueVarWithOrder_+3A_...">...</code></td>
<td>
<p>Lists</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with unique and ordered elements.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

<hr>
<h2 id='writeTable'>Custom function to write table to a text file</h2><span id='topic+writeTable'></span>

<h3>Description</h3>

<p>This function is mainly a wrapper on <code><a href="utils.html#topic+write.table">write.table</a></code>,
with the specific options:
</p>

<ul>
<li><p>no rownames
</p>
</li>
<li><p>no quoting
</p>
</li>
<li><p>tab separator
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>writeTable(x, file, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeTable_+3A_x">x</code></td>
<td>
<p>Data.frame to export to the table, or list of such tables.</p>
</td></tr>
<tr><td><code id="writeTable_+3A_file">file</code></td>
<td>
<p>String with text file to export to.</p>
</td></tr>
<tr><td><code id="writeTable_+3A_...">...</code></td>
<td>
<p>Any parameters passed to the <code><a href="utils.html#topic+write.table">write.table</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No returned value, the object <code>x</code> is exported to the specified <code>file</code>.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
