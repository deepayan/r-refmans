<!DOCTYPE html><html lang="en"><head><title>Help for package GPCMlasso</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GPCMlasso}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GPCMlasso-package'><p>Find DIF in Generalized Partial Credit Models</p></a></li>
<li><a href='#ctrl_GPCMlasso'><p>Control function for GPCMlasso</p></a></li>
<li><a href='#GPCMlasso'><p>GPCMlasso</p></a></li>
<li><a href='#plot.GPCMlasso'><p>Plot function for GPCMlasso</p></a></li>
<li><a href='#predict.GPCMlasso'><p>Predict function for GPCMlasso</p></a></li>
<li><a href='#print.GPCMlasso'><p>Print function for GPCMlasso</p></a></li>
<li><a href='#tenseness'><p>Tenseness data from the Freiburg Complaint Checklist</p></a></li>
<li><a href='#tenseness_small'><p>Subset of tenseness data from the Freiburg Complaint Checklist</p></a></li>
<li><a href='#trait.posterior'><p>Calculate Posterior Estimates for Trait Parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Differential Item Functioning in Generalized Partial Credit
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Gunther Schauberger</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gunther Schauberger &lt;gunther.schauberger@tum.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a framework to detect Differential Item Functioning (DIF) in Generalized Partial Credit Models (GPCM) and special cases of the GPCM as proposed by Schauberger and Mair (2019) &lt;<a href="https://doi.org/10.3758%2Fs13428-019-01224-2">doi:10.3758/s13428-019-01224-2</a>&gt;. A joint model is set up where DIF is explicitly parametrized and penalized likelihood estimation is used for parameter selection. The big advantage of the method called GPCMlasso is that several variables can be treated simultaneously and that both continuous and categorical variables can be used to detect DIF.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.4), TeachingDemos, cubature, caret, statmod,
mvtnorm, mirt, methods</td>
</tr>
<tr>
<td>Depends:</td>
<td>ltm</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-23 07:53:45 UTC; ge29weh</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-23 08:52:59 UTC</td>
</tr>
</table>
<hr>
<h2 id='GPCMlasso-package'>Find DIF in Generalized Partial Credit Models</h2><span id='topic+GPCMlasso-package'></span>

<h3>Description</h3>

<p>Performs GPCMlasso, a method to identify DIF in Generalized Partial Credit Models. 
A joint parametric model is set up based on an IRT model chosen by the user. Several variables can be considered simultaneously.
For each pair between variable and item, a parametric DIF effect is introduced which
indicates DIF if the respective parameter is selected (estimated to be unequal zero). 
Parameter selection is done using a lasso-type penalization term.
</p>


<h3>Author(s)</h3>

<p>Gunther Schauberger<br /> <a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a>
</p>


<h3>References</h3>

<p>Schauberger, Gunther and Mair, Patrick (2019): A Regularization Approach for the Detection of Differential 
Item Functioning in Generalized Partial Credit Models, <em>Behavior Research Methods</em>, <a href="https://link.springer.com/article/10.3758/s13428-019-01224-2">https://link.springer.com/article/10.3758/s13428-019-01224-2</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPCMlasso">GPCMlasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>

<hr>
<h2 id='ctrl_GPCMlasso'>Control function for GPCMlasso</h2><span id='topic+ctrl_GPCMlasso'></span>

<h3>Description</h3>

<p>Control parameters for penalty terms and for tuning the fitting algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctrl_GPCMlasso(
  log.lambda = TRUE,
  lambda = NULL,
  l.lambda = 50,
  lambda.min = 0.1,
  adaptive = TRUE,
  weight.penalties = TRUE,
  ada.lambda = 1e-04,
  ada.power = 1,
  Q = 15,
  lambda2 = 1e-04,
  cvalue = 1e-05,
  trace = TRUE,
  folds = 10,
  cores = 25,
  null_thresh = 0.01,
  gradtol = 1e-06,
  steptol = 1e-06,
  iterlim = 500,
  precision = 3,
  all.dummies = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ctrl_GPCMlasso_+3A_log.lambda">log.lambda</code></td>
<td>
<p>Should the grid of tuning parameters be created on a log scale?</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_lambda">lambda</code></td>
<td>
<p>Optional argument to specify a vector of tuning parameters. If <code>lambda = NULL</code>, a vector of length <code>l.lambda</code> is created automatically.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_l.lambda">l.lambda</code></td>
<td>
<p>Specifies the length of the grid of tuning parameters.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_lambda.min">lambda.min</code></td>
<td>
<p>Minimal value used if the grid of tuning parameters is created automatically.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_adaptive">adaptive</code></td>
<td>
<p>Should adaptive lasso be used? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_weight.penalties">weight.penalties</code></td>
<td>
<p>Should penalties be weightes accoreding to the number of penalty term and the number of parameters
corresponding to one pair between item and covariate. Only relevant if both <code>DSF = TRUE</code> and the number of 
response categories differs across items (because only then these values can differ).</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_ada.lambda">ada.lambda</code></td>
<td>
<p>Size of tuning parameter for Ridge-regularized estimation of parameters used for adaptive weights.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_ada.power">ada.power</code></td>
<td>
<p>By default, 1st power of absolute values of Ridge-regularized estimates are used. Could be changed to squared values by <code>ada-power = 2</code>.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_q">Q</code></td>
<td>
<p>Number of nodes to be used in Gauss-Hermite quadrature.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_lambda2">lambda2</code></td>
<td>
<p>Tuning parameter for ridge penalty on all coefficients except 
sigma/slope parameters.
Should be small, only used to stabilize results.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_cvalue">cvalue</code></td>
<td>
<p>Internal parameter for the quadratic approximation of the L1
penalty. Should be sufficiently small.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_trace">trace</code></td>
<td>
<p>Should the trace of the progress (current tuning parameter) be printed?</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_folds">folds</code></td>
<td>
<p>Number of folds for cross-validation. Only relevant if <code>cv = TRUE</code> in <code><a href="#topic+GPCMlasso">GPCMlasso</a></code>.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_cores">cores</code></td>
<td>
<p>Number of cores to be used parallel when fitting the model.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_null_thresh">null_thresh</code></td>
<td>
<p>Threshold which is used to distinguih between values equal and unequal to zero.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_gradtol">gradtol</code></td>
<td>
<p>Parameter to tune optimization accuracy, for details see <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_steptol">steptol</code></td>
<td>
<p>Parameter to tune optimization accuracy, for details see <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_iterlim">iterlim</code></td>
<td>
<p>Parameter to tune optimization accuracy, for details see <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_precision">precision</code></td>
<td>
<p>Number of decimal places used to round coefficient estimates.</p>
</td></tr>
<tr><td><code id="ctrl_GPCMlasso_+3A_all.dummies">all.dummies</code></td>
<td>
<p>Should (in case of factors with more than 2 categories) the dummy variables for all categories be included in the design matrix? If <code>all.dummies = TRUE</code>, the dependence on the reference category is eliminated for multi-categorical covariates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gunther Schauberger<br /> <a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a>
</p>


<h3>References</h3>

<p>Schauberger, Gunther and Mair, Patrick (2019): A Regularization Approach for the Detection of Differential 
Item Functioning in Generalized Partial Credit Models, <em>Behavior Research Methods</em>, <a href="https://link.springer.com/article/10.3758/s13428-019-01224-2">https://link.springer.com/article/10.3758/s13428-019-01224-2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>

<hr>
<h2 id='GPCMlasso'>GPCMlasso</h2><span id='topic+GPCMlasso'></span>

<h3>Description</h3>

<p>Performs GPCMlasso, a method to identify differential item functioning (DIF) in Generalized Partial Credit Models. 
A joint parametric model is set up based on an IRT model chosen by the user. Several variables can be considered simultaneously.
For each pair between variable and item, a parametric DIF effect is introduced which
indicates DIF if the respective parameter is selected (estimated to be unequal zero). 
Parameter selection is done using a lasso-type penalization term.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GPCMlasso(
  formula,
  data,
  DSF = FALSE,
  model = c("PCM", "RSM", "GPCM", "GRSM", "RM", "2PL"),
  control = ctrl_GPCMlasso(),
  cv = FALSE,
  main.effects = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GPCMlasso_+3A_formula">formula</code></td>
<td>
<p>Formula to indicate which items are considered and which covariates 
should be used to find DIF. Items are considered to be the response and are 
concatenated by <code>cbind()</code>. If the RHS of the formula is <code>~0</code>, simply the 
model specified in <code>model</code> is calulated.</p>
</td></tr>
<tr><td><code id="GPCMlasso_+3A_data">data</code></td>
<td>
<p>Data frame containing the ordinal item response data 
(as ordered factors) and all covariates.</p>
</td></tr>
<tr><td><code id="GPCMlasso_+3A_dsf">DSF</code></td>
<td>
<p>Should Differential Step Functioning (DSF) be considered? If <code>DSF = TRUE</code>, one parameter per step between two response categories is introduced. For binary items, DSF and DIF conincide.</p>
</td></tr>
<tr><td><code id="GPCMlasso_+3A_model">model</code></td>
<td>
<p>Specify the underlying basic model. Currently, you can choose 
between the partial credit model and the rating scale model and
the respective generalized versions of both models called 'PCM', 'RSM', 
'GPCM' and 'GRSM'. Generalized models allow for different discrimination 
parameters between items.</p>
</td></tr>
<tr><td><code id="GPCMlasso_+3A_control">control</code></td>
<td>
<p>Control argument to specify further arguments for the algorithm
and numerical optimization, specified by <code><a href="#topic+ctrl_GPCMlasso">ctrl_GPCMlasso</a></code>.</p>
</td></tr>
<tr><td><code id="GPCMlasso_+3A_cv">cv</code></td>
<td>
<p>Should cross-validation be performed? Cross-validation can be used as an alternative to BIC to select the optimal tuning parameter.</p>
</td></tr>
<tr><td><code id="GPCMlasso_+3A_main.effects">main.effects</code></td>
<td>
<p>Should also main effects of the variables be included in the model? Default is <code>TRUE</code>. Here, positive parameter estimates correspond 
to an increase of the respective trait if the variable increases.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>Matrix containing all parameters for the GPCMlasso model, one row
per tuning parameter lambda. Due to the penalty the parameters are scaled and, therefore,
are comparable with respect to their size.</p>
</td></tr> 
<tr><td><code>logLik</code></td>
<td>
<p>Vector of log-likelihoods, one value per tuning parameter lambda.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The function call of <code>GPCMlasso</code></p>
</td></tr>
<tr><td><code>cv_error</code></td>
<td>
<p>Vector of cv_errors, one per tuning parameter. Only relevant if <code>cv = TRUE</code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>Basic IRT model chosen by user.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Data from call.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>Control list.</p>
</td></tr>
<tr><td><code>DSF</code></td>
<td>
<p>DSF from call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Formula from call.</p>
</td></tr>
<tr><td><code>item.names</code></td>
<td>
<p>Item names.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>Matrix containing item responses.</p>
</td></tr>
<tr><td><code>design_list</code></td>
<td>
<p>List containing several helpful objects for internal use.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Vector of AIC values, one per tuning parameter.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Vector of BIC values, one per tuning parameter.</p>
</td></tr>
<tr><td><code>cAIC</code></td>
<td>
<p>Vector of corrected AIC values, one per tuning parameter.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Vector of degrees of freedom, one per tuning parameter.</p>
</td></tr>
<tr><td><code>coef.rescal</code></td>
<td>
<p>Matrix containing all rescaled parameters for the GPCMlasso model, one row
per tuning parameter lambda. In contrast to <code>coefficients</code>, all parameters are rescaled back
to their original scales.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gunther Schauberger<br /> <a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a>
</p>


<h3>References</h3>

<p>Schauberger, Gunther and Mair, Patrick (2019): A Regularization Approach for the Detection of Differential 
Item Functioning in Generalized Partial Credit Models, <em>Behavior Research Methods</em>, <a href="https://link.springer.com/article/10.3758/s13428-019-01224-2">https://link.springer.com/article/10.3758/s13428-019-01224-2</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPCMlasso-package">GPCMlasso-package</a></code>, <code><a href="#topic+ctrl_GPCMlasso">ctrl_GPCMlasso</a></code>, <code><a href="#topic+print.GPCMlasso">print.GPCMlasso</a></code>, 
<code><a href="#topic+plot.GPCMlasso">plot.GPCMlasso</a></code>, <code><a href="#topic+predict.GPCMlasso">predict.GPCMlasso</a></code>, <code><a href="#topic+trait.posterior">trait.posterior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.GPCMlasso'>Plot function for GPCMlasso</h2><span id='topic+plot.GPCMlasso'></span>

<h3>Description</h3>

<p>Plot function for a <code>GPCMlasso</code> object. Plots show coefficient paths
of DIF (or DSF) parameters along (a transformation of) the tuning parameter lambda.
One plot per item is created, every single parameter corresponding to this item
is depicted by a single path. 
The optimal model is highlighted with a red dashed line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GPCMlasso'
plot(x, select = c("BIC", "AIC", "cAIC", "cv"),
log.lambda = TRUE, items_per_page = 1, items = "all", 
columns = NULL, ask_new = TRUE, lambda.lines = TRUE,
equal_range = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.GPCMlasso_+3A_x">x</code></td>
<td>
<p><code>GPCMlasso</code> object</p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_select">select</code></td>
<td>
<p>Specifies which criterion to use for the optimal model, we recommend the 
default value &quot;BIC&quot;. If cross-validation was performed, automatically the optimal
model according to cross-validation is used. The chosen optimal model is 
highlighted with a red dashed line.</p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_log.lambda">log.lambda</code></td>
<td>
<p>A logical value indicating whether lambda or a log-transformation of 
lambda should be used as x-axis in the plots.</p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_items_per_page">items_per_page</code></td>
<td>
<p>By default, each plot/item is put on a separate page. For example,
<code>items_per_page=4</code> would put four plots/items on one page.</p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_items">items</code></td>
<td>
<p>By default, all items are plotted. If <code>items=c(1,3)</code>, 
only the first and the third item are plotted.</p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_columns">columns</code></td>
<td>
<p>Specifies the number of columns to use when several
plots are on one page. Only relevant if <code>items_per_page</code>&gt;1.</p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_ask_new">ask_new</code></td>
<td>
<p>If TRUE, the user is asked to confirm before the next item is plotted.</p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_lambda.lines">lambda.lines</code></td>
<td>
<p>A logical value indicating whether a thin gray line plotted
for each value from the vector of tuning parameters from <code>object</code></p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_equal_range">equal_range</code></td>
<td>
<p>A logical value indicating whether for each plot equal limits 
on the y-axis shall be used.</p>
</td></tr>
<tr><td><code id="plot.GPCMlasso_+3A_...">...</code></td>
<td>
<p>Further plot arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gunther Schauberger<br /> <a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a>
</p>


<h3>References</h3>

<p>Schauberger, Gunther and Mair, Patrick (2019): A Regularization Approach for the Detection of Differential 
Item Functioning in Generalized Partial Credit Models, <em>Behavior Research Methods</em>, <a href="https://link.springer.com/article/10.3758/s13428-019-01224-2">https://link.springer.com/article/10.3758/s13428-019-01224-2</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPCMlasso">GPCMlasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.GPCMlasso'>Predict function for GPCMlasso</h2><span id='topic+predict.GPCMlasso'></span>

<h3>Description</h3>

<p>Predict function for a <code>GPCMlasso</code> object. 
Predictions can be linear predictors or probabilities separately for each person and each item.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GPCMlasso'
predict(
  object,
  coefs = NULL,
  newdata = NULL,
  type = c("link", "response"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.GPCMlasso_+3A_object">object</code></td>
<td>
<p><code>GPCMlasso</code> object</p>
</td></tr>
<tr><td><code id="predict.GPCMlasso_+3A_coefs">coefs</code></td>
<td>
<p>Optional vector of coefficients, can be filled with a specific 
row from <code>object$coefficients</code>. If not specified, <code>coefs</code> are specififed to be
the BIC-optimal coefficients or, if cross-validation was performed, the optimal 
coefficients according to cross-validation.</p>
</td></tr>
<tr><td><code id="predict.GPCMlasso_+3A_newdata">newdata</code></td>
<td>
<p>List possibly containing slots Y, X, Z1 and Z2 to use new data for prediction.</p>
</td></tr>
<tr><td><code id="predict.GPCMlasso_+3A_type">type</code></td>
<td>
<p>Type &quot;link&quot; gives vectors of linear predictors for separate categories 
(of length $k_i-1$) and type &quot;response&quot; gives the respective probabilities (of length $k_i$).</p>
</td></tr>
<tr><td><code id="predict.GPCMlasso_+3A_...">...</code></td>
<td>
<p>Further predict arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results are lists of vectors with length equal to the number 
of response categories $k_i$ in case of
probabilities (<code>type="response"</code>) or 
$k_i-1$ in case of linear predictors (<code>type="link"</code>).
</p>


<h3>Author(s)</h3>

<p>Gunther Schauberger<br /> <a href="mailto:gunther@stat.uni-muenchen.de">gunther@stat.uni-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPCMlasso">GPCMlasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.GPCMlasso'>Print function for GPCMlasso</h2><span id='topic+print.GPCMlasso'></span>

<h3>Description</h3>

<p>Print function for a <code>GPCMlasso</code> object. Prints parameters estimates for all model
components for the optimal model chosen by a specific criterion (by default BIC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GPCMlasso'
print(x, select = c("BIC", "AIC", "cAIC", "cv"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.GPCMlasso_+3A_x">x</code></td>
<td>
<p><code>GPCMlasso</code> object</p>
</td></tr>
<tr><td><code id="print.GPCMlasso_+3A_select">select</code></td>
<td>
<p>Specifies which criterion to use for the optimal model, we recommend the 
default value &quot;BIC&quot;. If cross-validation was performed, automatically the optimal
model according to cross-validation is used. Only the parameter estimates from
the chosen optimal model are printed.</p>
</td></tr>
<tr><td><code id="print.GPCMlasso_+3A_...">...</code></td>
<td>
<p>Further print arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gunther Schauberger<br /> <a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a>
</p>


<h3>References</h3>

<p>Schauberger, Gunther and Mair, Patrick (2019): A Regularization Approach for the Detection of Differential 
Item Functioning in Generalized Partial Credit Models, <em>Behavior Research Methods</em>, <a href="https://link.springer.com/article/10.3758/s13428-019-01224-2">https://link.springer.com/article/10.3758/s13428-019-01224-2</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPCMlasso">GPCMlasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>

<hr>
<h2 id='tenseness'>Tenseness data from the Freiburg Complaint Checklist</h2><span id='topic+tenseness'></span>

<h3>Description</h3>

<p>Data from the Freiburg Complaint Checklist. 
The data contain all 8 items corresponding to the scale <em>Tenseness</em> for 2042 participants of the 
standardization sample of the Freiburg Complaint Checklist.
</p>


<h3>Format</h3>

<p>A data frame containing data from the Freiburg Complaint Checklist with 1847 observations. 
All items refer to the scale <em>Tenseness</em> and are measured on a 5-point Likert scale where low numbers 
correspond to low frequencies or low intensitites of the respective complaint and vice versa. 
</p>
 
<dl>
<dt>Clammy_hands</dt><dd><p>Do you have clammy hands?</p>
</dd>
<dt>Sweat_attacks</dt><dd><p>Do you have sudden attacks of sweating?</p>
</dd>
<dt>Clumsiness</dt><dd><p>Do you notice that you behave clumsy?</p>
</dd>
<dt>Wavering_hands</dt><dd><p>Are your hands wavering frequently, e.g. when lightning a cigarette or when holding a cup?</p>
</dd>
<dt>Restless_hands</dt><dd><p>Do you notice that your hands are restless?</p>
</dd>
<dt>Restless_feet</dt><dd><p>Do you notice that your feet are restless?</p>
</dd>
<dt>Twitching_eyes</dt><dd><p>Do you notice unvoluntary twitching of your eyes?</p>
</dd>
<dt>Twitching_mouth</dt><dd><p>Do you notice unvoluntary twitching of your mouth?</p>
</dd>
<dt>Gender</dt><dd><p>Gender of the person</p>
</dd>
<dt>Household</dt><dd><p>Does the person live alone in a household or together with somebody?</p>
</dd>
<dt>Income</dt><dd><p>Income, categorized to levels from 1 (low income) to 11(high income). For simplicity,
due to the high number of categories income can be treated as a metric variable.</p>
</dd>
<dt>WestEast</dt><dd><p>Is the person from East Germany (former GDR)?</p>
</dd>
<dt>Abitur</dt><dd><p>Does the person have Abitur (A-levels)?</p>
</dd>
<dt>Age</dt><dd><p>Age of the person</p>
</dd>
</dl>



<h3>Source</h3>

<p>ZPID (2013). PsychData of the Leibniz Institute for Psychology Information ZPID. Trier: Center for Research Data in Psychology.
</p>
<p>Fahrenberg, J. (2010). Freiburg Complaint Checklist [Freiburger Beschwerdenliste (FBL)]. Goettingen, Hogrefe.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tenseness)

</code></pre>

<hr>
<h2 id='tenseness_small'>Subset of tenseness data from the Freiburg Complaint Checklist</h2><span id='topic+tenseness_small'></span>

<h3>Description</h3>

<p>Data from the Freiburg Complaint Checklist. 
The data contain 5 items (out of 8) corresponding to the scale <em>Tenseness</em> for a subset of 200 participants of the 
standardization sample of the Freiburg Complaint Checklist.
</p>


<h3>Format</h3>

<p>A data frame containing data from the Freiburg Complaint Checklist a subset of 200 observations. 
The complete data set with 1847 observations can be found in <code><a href="#topic+tenseness">tenseness</a></code>.
All items refer to the scale <em>Tenseness</em> and are measured on a 5-point Likert scale where low numbers 
correspond to low frequencies or low intensitites of the respective complaint and vice versa. 
</p>
 
<dl>
<dt>Clammy_hands</dt><dd><p>Do you have clammy hands?</p>
</dd>
<dt>Sweat_attacks</dt><dd><p>Do you have sudden attacks of sweating?</p>
</dd>
<dt>Clumsiness</dt><dd><p>Do you notice that you behave clumsy?</p>
</dd>
<dt>Wavering_hands</dt><dd><p>Are your hands wavering frequently, e.g. when lightning a cigarette or when holding a cup?</p>
</dd>
<dt>Restless_hands</dt><dd><p>Do you notice that your hands are restless?</p>
</dd>
<dt>Gender</dt><dd><p>Gender of the person</p>
</dd>
<dt>Age</dt><dd><p>Age of the person</p>
</dd>
</dl>



<h3>Source</h3>

<p>ZPID (2013). PsychData of the Leibniz Institute for Psychology Information ZPID. Trier: Center for Research Data in Psychology.
</p>
<p>Fahrenberg, J. (2010). Freiburg Complaint Checklist [Freiburger Beschwerdenliste (FBL)]. Goettingen, Hogrefe.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPCMlasso">GPCMlasso</a></code>, <code><a href="#topic+ctrl_GPCMlasso">ctrl_GPCMlasso</a></code>, <code><a href="#topic+trait.posterior">trait.posterior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>

<hr>
<h2 id='trait.posterior'>Calculate Posterior Estimates for Trait Parameters</h2><span id='topic+trait.posterior'></span>

<h3>Description</h3>

<p>Calculates posterior estimates for trait/person parameters using the assumption 
of Gaussian distributed parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trait.posterior(model, coefs = NULL, cores = 25, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trait.posterior_+3A_model">model</code></td>
<td>
<p>Object of class <code>GPCMlasso</code>.</p>
</td></tr>
<tr><td><code id="trait.posterior_+3A_coefs">coefs</code></td>
<td>
<p>Vector of coefficients to be used for prediction. If <code>coefs = NULL</code>, 
the parameters from  the BIC-optimal model will be used. 
If cross-validation was performed, automatically the parameters from the optimal
model according to cross-validation are used.</p>
</td></tr>
<tr><td><code id="trait.posterior_+3A_cores">cores</code></td>
<td>
<p>Number of cores to be used in parallelized computation.</p>
</td></tr>
<tr><td><code id="trait.posterior_+3A_tol">tol</code></td>
<td>
<p>The maximum tolerance for numerical integration, 
for more details see <code>pcubature</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing all estimates of trait/person parameters.
</p>


<h3>Author(s)</h3>

<p>Gunther Schauberger<br /> <a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a>
</p>


<h3>References</h3>

<p>Schauberger, Gunther and Mair, Patrick (2019): A Regularization Approach for the Detection of Differential 
Item Functioning in Generalized Partial Credit Models, <em>Behavior Research Methods</em>, <a href="https://link.springer.com/article/10.3758/s13428-019-01224-2">https://link.springer.com/article/10.3758/s13428-019-01224-2</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GPCMlasso">GPCMlasso</a></code> <code><a href="#topic+GPCMlasso-package">GPCMlasso-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
