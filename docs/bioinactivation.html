<!DOCTYPE html><html><head><title>Help for package bioinactivation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bioinactivation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Arrhenius_iso'><p>Isothermal Arrhenius model</p></a></li>
<li><a href='#Bigelow_iso'><p>Isothermal Bigelow's Model</p></a></li>
<li><a href='#build_temperature_interpolator'><p>Continuum Interpolation of Discrete Temperatures Values</p></a></li>
<li><a href='#check_model_params'><p>Correctness Check of Model Parameters</p></a></li>
<li><a href='#dArrhenius_model'><p>First derivative of the Arrhenius model</p></a></li>
<li><a href='#dBigelow_model'><p>First Derivate of the Linear Bigelow Model</p></a></li>
<li><a href='#dGeeraerd_model'><p>First Derivate of Geeraerd's Model</p></a></li>
<li><a href='#dMafart_model'><p>First Derivate of the Weibull-Mafart Model</p></a></li>
<li><a href='#dMetselaar_model'><p>First Derivate of the Metselaar Model</p></a></li>
<li><a href='#dPeleg_model'><p>First Derivate of the Weibull-Peleg Model</p></a></li>
<li><a href='#dynamic_inactivation'><p>Example Dynamic Inactivation of a Microorganis</p></a></li>
<li><a href='#fit_dynamic_inactivation'><p>Fitting of Dynamic Inactivation Models</p></a></li>
<li><a href='#fit_inactivation_MCMC'><p>Fitting of dynamic inactivation with MCMC</p></a></li>
<li><a href='#fit_isothermal_inactivation'><p>Fit of Isothermal Experiments</p></a></li>
<li><a href='#get_isothermal_model_data'><p>Isothermal Model Data</p></a></li>
<li><a href='#get_model_data'><p>Mapping of Simulation Model Functions</p></a></li>
<li><a href='#get_prediction_cost'><p>Error of the Prediction of Microbial Inactivation</p></a></li>
<li><a href='#goodness_dyna'><p>Goodness of fit for Dynamic fits</p></a></li>
<li><a href='#goodness_iso'><p>Goodness of fit for Isothermal fits</p></a></li>
<li><a href='#goodness_MCMC'><p>Goodness of fit for MCMC fits</p></a></li>
<li><a href='#goodness_of_fit'><p>Goodness of fit for microbial inactivation models</p></a></li>
<li><a href='#is.FitInactivation'><p>Test of FitInactivation object</p></a></li>
<li><a href='#is.FitInactivationMCMC'><p>Test of FitInactivationMCMC object</p></a></li>
<li><a href='#is.IsoFitInactivation'><p>Test of IsoFitInactivation object</p></a></li>
<li><a href='#is.PredInactivationMCMC'><p>Test of PredInactivationMCMC object</p></a></li>
<li><a href='#is.SimulInactivation'><p>Test of SimulInactivation object</p></a></li>
<li><a href='#isothermal_inactivation'><p>Example Isothermal Inactivation of a Microorganis</p></a></li>
<li><a href='#laterosporus_dyna'><p>Example Dynamic Inactivation of a Laterosporus</p></a></li>
<li><a href='#laterosporus_iso'><p>Example Isothermal Inactivation of a Laterosporus</p></a></li>
<li><a href='#Metselaar_iso'><p>Isothermal Metselaar model</p></a></li>
<li><a href='#plot.FitInactivation'><p>Plot of FitInactivation Object</p></a></li>
<li><a href='#plot.FitInactivationMCMC'><p>Plot of FitInactivationMCMC Object</p></a></li>
<li><a href='#plot.IsoFitInactivation'><p>Plot of IsoFitInactivation Object</p></a></li>
<li><a href='#plot.PredInactivationMCMC'><p>Plot of PredInactivationMCMC Object</p></a></li>
<li><a href='#plot.SimulInactivation'><p>Plot of SimulInactivation Object</p></a></li>
<li><a href='#predict_inactivation'><p>Prediction of Dynamic Inactivation</p></a></li>
<li><a href='#predict_inactivation_MCMC'><p>Dynamic Prediction Intervals from a Monte Carlo Adjustment</p></a></li>
<li><a href='#sample_dynaFit'><p>Random sample of the parameters of a FitInactivation object</p></a></li>
<li><a href='#sample_IsoFit'><p>Random sample of the parameters of a IsoFitInactivation object</p></a></li>
<li><a href='#sample_MCMCfit'><p>Random sample of the parameters of a FitInactivationMCMC object</p></a></li>
<li><a href='#summary.FitInactivation'><p>Summary of a FitInactivation object</p></a></li>
<li><a href='#summary.FitInactivationMCMC'><p>Summary of a FitInactivationMCMC object</p></a></li>
<li><a href='#summary.IsoFitInactivation'><p>Summary of a IsoFitInactivation object</p></a></li>
<li><a href='#time_to_logreduction'><p>Time to reach X log reductions</p></a></li>
<li><a href='#WeibullMafart_iso'><p>Isothermal Weibull-Mafart Model</p></a></li>
<li><a href='#WeibullPeleg_iso'><p>Isothermal Weibull-Peleg Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mathematical Modelling of (Dynamic) Microbial Inactivation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-08-01</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for modelling microbial inactivation under
    isothermal or dynamic conditions. The calculations are based on several mathematical models broadly
    used by the scientific community and industry. Functions enable to make predictions for cases where the
    kinetic parameters are known. It also implements functions for parameter estimation for isothermal and
    dynamic conditions. The model fitting capabilities include an Adaptive Monte Carlo method for a Bayesian
    approach to parameter estimation.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 0.4.1), deSolve (&ge; 1.11), FME (&ge; 1.3.2), lazyeval
(&ge; 0.1.10), ggplot2 (&ge; 2.0.0), MASS (&ge; 7.3-39), graphics (&ge;
3.1.3), stats (&ge; 3.1.3), rlang(&ge; 0.1.2), purrr (&ge; 0.3.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.9), testthat (&ge; 0.9.1), rmarkdown (&ge; 1.12)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-01 13:45:05 UTC; alberto</td>
</tr>
<tr>
<td>Author:</td>
<td>Alberto Garre [aut, cre],
  Pablo S. Fernandez [aut],
  Jose A. Egea [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alberto Garre &lt;garre.alberto@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-01 16:40:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='Arrhenius_iso'>Isothermal Arrhenius model</h2><span id='topic+Arrhenius_iso'></span>

<h3>Description</h3>

<p>Returns the predicted logarithmic reduction in microbial count according
to Arrhenius model for the time, temperature and model parameters
given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Arrhenius_iso(time, temp, k_ref, temp_ref, Ea)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Arrhenius_iso_+3A_time">time</code></td>
<td>
<p>numeric indicating the time at which the prediction is taken.</p>
</td></tr>
<tr><td><code id="Arrhenius_iso_+3A_temp">temp</code></td>
<td>
<p>numeric indicating the temperature of the treatment.</p>
</td></tr>
<tr><td><code id="Arrhenius_iso_+3A_k_ref">k_ref</code></td>
<td>
<p>numeric indicating the inactivation rate at the reference
temperature.</p>
</td></tr>
<tr><td><code id="Arrhenius_iso_+3A_temp_ref">temp_ref</code></td>
<td>
<p>numeric indicating the reference temperature.</p>
</td></tr>
<tr><td><code id="Arrhenius_iso_+3A_ea">Ea</code></td>
<td>
<p>numeric indicating the activation energy.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric with the predicted logarithmic reduction
(<code class="reqn">log10(N/N0)</code>).
</p>

<hr>
<h2 id='Bigelow_iso'>Isothermal Bigelow's Model</h2><span id='topic+Bigelow_iso'></span>

<h3>Description</h3>

<p>Returns the predicted logarithmic reduction in microbial count according
to Bigelow's model for the time, temperature and model parameters given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bigelow_iso(time, temp, z, D_R, temp_ref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bigelow_iso_+3A_time">time</code></td>
<td>
<p>numeric indicating the time at which the prediction is taken.</p>
</td></tr>
<tr><td><code id="Bigelow_iso_+3A_temp">temp</code></td>
<td>
<p>numeric indicating the temperature of the treatment.</p>
</td></tr>
<tr><td><code id="Bigelow_iso_+3A_z">z</code></td>
<td>
<p>numeric defining the z-value.</p>
</td></tr>
<tr><td><code id="Bigelow_iso_+3A_d_r">D_R</code></td>
<td>
<p>numeric defining the D-value at the reference temperature.</p>
</td></tr>
<tr><td><code id="Bigelow_iso_+3A_temp_ref">temp_ref</code></td>
<td>
<p>numeric defining the reference temperature.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric with the predicted logarithmic reduction
(<code class="reqn">log10(N/N0)</code>).
</p>

<hr>
<h2 id='build_temperature_interpolator'>Continuum Interpolation of Discrete Temperatures Values</h2><span id='topic+build_temperature_interpolator'></span>

<h3>Description</h3>

<p>Builds an interpolator of the temperature at each time and its first
derivative.
First derivatives are approximated using forward finite
differences (<code><a href="stats.html#topic+approxfun">approxfun</a></code>). It is assumed that temperature is 0
and constant outside the time interval provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_temperature_interpolator(temperature_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_temperature_interpolator_+3A_temperature_data">temperature_data</code></td>
<td>
<p>data frame with the values of the temperatures at
each value of time. It need to have 2 columns, named time and
temperature.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with with two elements: </p>

<ul>
<li><p> temp, the interpolator of the temperature and
</p>
</li>
<li><p> dtemp, the interpolator of its first derivative
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="stats.html#topic+approxfun">approxfun</a></code>
</p>

<hr>
<h2 id='check_model_params'>Correctness Check of Model Parameters</h2><span id='topic+check_model_params'></span>

<h3>Description</h3>

<p>Makes 3 checks of compatibility between the input parameters for the
adjustment and the DOF of the inactivation model selected.
</p>

<ul>
<li><p> Check of equal length of model DOF and input DOF. Raises a
warning if failed.
</p>
</li>
<li><p> Check that every single one of the input DOF is a model DOF.
Raises a warning if failed.
</p>
</li>
<li><p> Check that every single one of the model DOF are defined as
an input DOF.</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>check_model_params(simulation_model, known_params, starting_points,
  adjust_vars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_model_params_+3A_simulation_model">simulation_model</code></td>
<td>
<p>character with a valid model key.</p>
</td></tr>
<tr><td><code id="check_model_params_+3A_known_params">known_params</code></td>
<td>
<p>named vector or list with the dof of the model
known.</p>
</td></tr>
<tr><td><code id="check_model_params_+3A_starting_points">starting_points</code></td>
<td>
<p>named vector or list with the dof of the model to
be adjusted.</p>
</td></tr>
<tr><td><code id="check_model_params_+3A_adjust_vars">adjust_vars</code></td>
<td>
<p>logical specifying whether the model variables need to
be included in the check (not used for isothermal
fit)</p>
</td></tr>
</table>

<hr>
<h2 id='dArrhenius_model'>First derivative of the Arrhenius model</h2><span id='topic+dArrhenius_model'></span>

<h3>Description</h3>

<p>Calculates the first derivative of the Arrhenius model with log-linear
inactivation
for dynamic problems at a given time for the model parameters provided and
the environmental conditions given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dArrhenius_model(t, x, parms, temp_profile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dArrhenius_model_+3A_t">t</code></td>
<td>
<p>numeric vector indicating the time of the experiment.</p>
</td></tr>
<tr><td><code id="dArrhenius_model_+3A_x">x</code></td>
<td>
<p>list with the value of N at t.</p>
</td></tr>
<tr><td><code id="dArrhenius_model_+3A_parms">parms</code></td>
<td>
<p>parameters for the secondary model. No explicit check of their
validity is performed.</p>
</td></tr>
<tr><td><code id="dArrhenius_model_+3A_temp_profile">temp_profile</code></td>
<td>
<p>a function that provides the temperature at a given
time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is compatible with the function
<code><a href="#topic+predict_inactivation">predict_inactivation</a></code>.
</p>


<h3>Value</h3>

<p>The value of the first derivative of <code class="reqn">N</code> at time <code>t</code> as a
list.
</p>


<h3>Model Equation</h3>

<p style="text-align: center;"><code class="reqn">\frac{dN}{dt} = - k * N </code>
</p>



<h3>Model parameters</h3>


<ul>
<li><p> temp_ref: Reference temperature for the calculation,
</p>
</li>
<li><p> k_ref: inactivation rate at the ref. temp.
</p>
</li>
<li><p> Ea: Activation energy.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+predict_inactivation">predict_inactivation</a></code>
</p>

<hr>
<h2 id='dBigelow_model'>First Derivate of the Linear Bigelow Model</h2><span id='topic+dBigelow_model'></span>

<h3>Description</h3>

<p>Calculates the first derivative of the linearized version of Bigelow's model
for dynamic problems at a given time for the model parameters provided and
the environmental conditions given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dBigelow_model(t, x, parms, temp_profile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dBigelow_model_+3A_t">t</code></td>
<td>
<p>numeric vector indicating the time of the experiment.</p>
</td></tr>
<tr><td><code id="dBigelow_model_+3A_x">x</code></td>
<td>
<p>list with the value of N at t.</p>
</td></tr>
<tr><td><code id="dBigelow_model_+3A_parms">parms</code></td>
<td>
<p>parameters for the secondary model. No explicit check of their
validity is performed.</p>
</td></tr>
<tr><td><code id="dBigelow_model_+3A_temp_profile">temp_profile</code></td>
<td>
<p>a function that provides the temperature at a given
time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is developed from the isothermal Bigelow's model assuming during
the derivation process that <code class="reqn">D_T</code> is time independenent.
</p>
<p>This function is compatible with the function
<code><a href="#topic+predict_inactivation">predict_inactivation</a></code>.
</p>


<h3>Value</h3>

<p>The value of the first derivative of <code class="reqn">N</code> at time <code>t</code> as a
list.
</p>


<h3>Model Equation</h3>

<p style="text-align: center;"><code class="reqn">\frac{dN}{dt} = - N \frac {\mathrm{ln}(10)}{D_T(T)}</code>
</p>



<h3>Model parameters</h3>


<ul>
<li><p> temp_ref: Reference temperature for the calculation,
</p>
</li>
<li><p> D_R: D-value at the reference temperature,
</p>
</li>
<li><p> z: z value.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+predict_inactivation">predict_inactivation</a></code>
</p>

<hr>
<h2 id='dGeeraerd_model'>First Derivate of Geeraerd's Model</h2><span id='topic+dGeeraerd_model'></span>

<h3>Description</h3>

<p>Calculates the first derivative of the Geeraerd's model at a given time for
the model parameters provided and the environmental conditions given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dGeeraerd_model(t, x, parms, temp_profile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dGeeraerd_model_+3A_t">t</code></td>
<td>
<p>numeric vector indicating the time of the experiment.</p>
</td></tr>
<tr><td><code id="dGeeraerd_model_+3A_x">x</code></td>
<td>
<p>list with the values of the variables at time <code class="reqn">t</code>.</p>
</td></tr>
<tr><td><code id="dGeeraerd_model_+3A_parms">parms</code></td>
<td>
<p>parameters for the secondary model. No explicit check of their
validity is performed (see section <b>Model Parameters</b>).</p>
</td></tr>
<tr><td><code id="dGeeraerd_model_+3A_temp_profile">temp_profile</code></td>
<td>
<p>a function that provides the temperature at a given time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is compatible with the function
<code><a href="#topic+predict_inactivation">predict_inactivation</a></code>.
</p>


<h3>Value</h3>

<p>A list with the value of the first derivatives of N and C_c at time
<code>t</code>.
</p>


<h3>Model Equation</h3>

<p style="text-align: center;"><code class="reqn">\frac{dN}{dt} = -N \cdot k_{max} \cdot \alpha \cdot \gamma</code>
</p>

<p style="text-align: center;"><code class="reqn">\frac{dC_c}{dt} = - C_c \cdot k_{max}</code>
</p>

<p style="text-align: center;"><code class="reqn">\alpha = \frac {1}{1+C_c}</code>
</p>

<p style="text-align: center;"><code class="reqn">\gamma = 1 - \frac{N_{res}}{N}</code>
</p>

<p style="text-align: center;"><code class="reqn">k_{max} = \frac{1}{D_T}</code>
</p>

<p style="text-align: center;"><code class="reqn">log_{10}D_T = log_{10}D_R + \frac{T_R-T}{z}</code>
</p>



<h3>Model Parameters</h3>


<ul>
<li><p> temp_ref: Reference temperature for the calculation,
</p>
</li>
<li><p> D_R: D-value at the reference temperature,
</p>
</li>
<li><p> z: z value,
</p>
</li>
<li><p> N_min: Minimum value of N (defines the tail).
</p>
</li></ul>



<h3>Notes</h3>

<p>To define the Geeraerd model without tail, assign <code>N_min = 0</code>.
For the model without shoulder, assign <code>C_0 = 0</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_inactivation">predict_inactivation</a></code>
</p>

<hr>
<h2 id='dMafart_model'>First Derivate of the Weibull-Mafart Model</h2><span id='topic+dMafart_model'></span>

<h3>Description</h3>

<p>Calculates the first derivative of Weibull-Mafart model at a given time for
the model parameters provided and the environmental conditions given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dMafart_model(t, x, parms, temp_profile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dMafart_model_+3A_t">t</code></td>
<td>
<p>numeric vector indicating the time of the experiment.</p>
</td></tr>
<tr><td><code id="dMafart_model_+3A_x">x</code></td>
<td>
<p>list with the value of N at t.</p>
</td></tr>
<tr><td><code id="dMafart_model_+3A_parms">parms</code></td>
<td>
<p>parameters for the secondary model. No explicit check of their validity
is performed (see section <b>Model Parameters</b>).</p>
</td></tr>
<tr><td><code id="dMafart_model_+3A_temp_profile">temp_profile</code></td>
<td>
<p>a function that provides the temperature at a given time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is developed from the isothermal Weibull-Mafart model without
taking into
account in the derivation the time dependence of <code class="reqn">\delta_T</code> for
non-isothermal temperature profiles.
</p>
<p>This function is compatible with the function
<code><a href="#topic+predict_inactivation">predict_inactivation</a></code>.
</p>


<h3>Value</h3>

<p>The value of the first derivative of N at time <code>t</code> as a list.
</p>


<h3>Model Equation</h3>

<p style="text-align: center;"><code class="reqn">\frac{dN}{dt} = -N \cdot p \cdot (1/\delta)^p \cdot t^{p-1} </code>
</p>

<p style="text-align: center;"><code class="reqn">\delta(T) = \delta_{ref} \cdot 10^{- (T-T_ref)/z} </code>
</p>



<h3>Model Parameters</h3>


<ul>
<li><p> temp_ref: Reference temperature for the calculation.
</p>
</li>
<li><p> delta_ref: Value of the scale factor at the reference temperature.
</p>
</li>
<li><p> z: z-value.
</p>
</li>
<li><p> p: shape factor of the Weibull distribution.
</p>
</li></ul>



<h3>Note</h3>

<p>For t=0, dN = 0 unless n=1. Hence, a small shift needs to be introduced
to t.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_inactivation">predict_inactivation</a></code>
</p>

<hr>
<h2 id='dMetselaar_model'>First Derivate of the Metselaar Model</h2><span id='topic+dMetselaar_model'></span>

<h3>Description</h3>

<p>Calculates the first derivative of Metselaar model at a given time for
the model parameters provided and the environmental conditions given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dMetselaar_model(t, x, parms, temp_profile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dMetselaar_model_+3A_t">t</code></td>
<td>
<p>numeric vector indicating the time of the experiment.</p>
</td></tr>
<tr><td><code id="dMetselaar_model_+3A_x">x</code></td>
<td>
<p>list with the value of N at t.</p>
</td></tr>
<tr><td><code id="dMetselaar_model_+3A_parms">parms</code></td>
<td>
<p>parameters for the secondary model. No explicit check of their validity
is performed (see section <b>Model Parameters</b>).</p>
</td></tr>
<tr><td><code id="dMetselaar_model_+3A_temp_profile">temp_profile</code></td>
<td>
<p>a function that provides the temperature at a given time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is developed from the isothermal Metselaar model without
taking into
account in the derivation the time dependence of <code class="reqn">\delta_T</code> for
non-isothermal temperature profiles.
</p>
<p>This function is compatible with the function
<code><a href="#topic+predict_inactivation">predict_inactivation</a></code>.
</p>


<h3>Value</h3>

<p>The value of the first derivative of N at time <code>t</code> as a list.
</p>


<h3>Model Equation</h3>

<p style="text-align: center;"><code class="reqn">\frac{dN}{dt} = -N \cdot p \cdot (1/D)^p \cdot (t/Delta)^{p-1} </code>
</p>

<p style="text-align: center;"><code class="reqn">D(T) = D_{ref} \cdot 10^{- (T-T_ref)/z} </code>
</p>



<h3>Model Parameters</h3>


<ul>
<li><p> temp_ref: Reference temperature for the calculation.
</p>
</li>
<li><p> D_R: D-value at the reference temperature.
</p>
</li>
<li><p> z: z-value.
</p>
</li>
<li><p> p: shape factor of the Weibull distribution.
</p>
</li>
<li><p> Delta: Scaling parameter
</p>
</li></ul>



<h3>Note</h3>

<p>For t=0, dN = 0 unless n=1. Hence, a small shift needs to be introduced
to t.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_inactivation">predict_inactivation</a></code>
</p>

<hr>
<h2 id='dPeleg_model'>First Derivate of the Weibull-Peleg Model</h2><span id='topic+dPeleg_model'></span>

<h3>Description</h3>

<p>Calculates the first derivative of Weibull-Peleg model at a given time for
the model parameters provided and the environmental conditions given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dPeleg_model(t, x, parms, temp_profile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dPeleg_model_+3A_t">t</code></td>
<td>
<p>numeric vector indicating the time of the experiment.</p>
</td></tr>
<tr><td><code id="dPeleg_model_+3A_x">x</code></td>
<td>
<p>list with the value of logS at t.</p>
</td></tr>
<tr><td><code id="dPeleg_model_+3A_parms">parms</code></td>
<td>
<p>parameters for the secondary model. No explicit check of their validity
is performed (see section <b>Model Parameters</b>).</p>
</td></tr>
<tr><td><code id="dPeleg_model_+3A_temp_profile">temp_profile</code></td>
<td>
<p>a function that provides the temperature at a given time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is developed from the isothermal Weibull model without
taking into
account in the derivation the time dependence of <code class="reqn">b</code> for
non-isothermal temperature profiles.
</p>
<p>This function is compatible with the function
<code><a href="#topic+predict_inactivation">predict_inactivation</a></code>.
</p>


<h3>Value</h3>

<p>The value of the first derivative of logS at time <code>t</code> as a list.
</p>


<h3>Model Equation</h3>

<p style="text-align: center;"><code class="reqn">\frac{d(\mathrm{log}_{10}(S))}{dt}=-b(T) \cdot n \cdot
                (- log10(S)/b(T))^{(n-1)/n)} </code>
</p>

<p style="text-align: center;"><code class="reqn">b(T) = \mathrm{ln}(1 + exp( k_b*(T - T_{crit}) ))</code>
</p>



<h3>Model Parameters</h3>


<ul>
<li><p> temp_crit: Temperature below which there is inactivation.
</p>
</li>
<li><p> k_b: slope of the b ~ temp line for temperatures above the
critical one.
</p>
</li>
<li><p> n: shape factor of the Weibull distribution.
</p>
</li></ul>



<h3>Note</h3>

<p>For logS=0, dlogS = 0 unless n=1. Hence, a small shift needs to be introduced
to logS.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict_inactivation">predict_inactivation</a></code>
</p>

<hr>
<h2 id='dynamic_inactivation'>Example Dynamic Inactivation of a Microorganis</h2><span id='topic+dynamic_inactivation'></span>

<h3>Description</h3>

<p>Example of experimental data of the dynamic inactivation process of a
microorganism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dynamic_inactivation)
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 rows and 2 variables.</p>


<h3>Details</h3>


<ul>
<li><p> time: Time in minutes of the measurement.
</p>
</li>
<li><p> N: Number of microorganism.
</p>
</li>
<li><p> temperature: Observed temperature.
</p>
</li></ul>


<hr>
<h2 id='fit_dynamic_inactivation'>Fitting of Dynamic Inactivation Models</h2><span id='topic+fit_dynamic_inactivation'></span>

<h3>Description</h3>

<p>Fits the parameters of an inactivation model to experimental data.
The function <code>modFit</code> of the package <code>FME</code> is
used for the adjustment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_dynamic_inactivation(experiment_data, simulation_model, temp_profile,
  starting_points, upper_bounds, lower_bounds, known_params, ...,
  minimize_log = TRUE, tol0 = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_dynamic_inactivation_+3A_experiment_data">experiment_data</code></td>
<td>
<p>data frame with the experimental data to be adjusted.
It must have a column named &ldquo;time&rdquo; and another one named
&ldquo;N&rdquo;.</p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_simulation_model">simulation_model</code></td>
<td>
<p>character identifying the model to be used.</p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_temp_profile">temp_profile</code></td>
<td>
<p>data frame with discrete values of the temperature for
each time. It must have one column named <code>time</code> and another named
<code>temperature</code> providing discrete values of the temperature at
time points.</p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_starting_points">starting_points</code></td>
<td>
<p>starting values of the parameters for the adjustment.</p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_upper_bounds">upper_bounds</code></td>
<td>
<p>named numerical vector defining the upper bounds of the
parameters for the adjustment.</p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_lower_bounds">lower_bounds</code></td>
<td>
<p>named numerical vector defining the lower bounds of the
parameters for the adjustment.</p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_known_params">known_params</code></td>
<td>
<p>named numerical vector with the fixed (i.e., not
adjustable) model parameters.</p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>modFit</code></p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_minimize_log">minimize_log</code></td>
<td>
<p>logical. If <code>TRUE</code>, the adjustment is based on the
minimization of the error of the logarithmic count. <code>TRUE</code> by
default.</p>
</td></tr>
<tr><td><code id="fit_dynamic_inactivation_+3A_tol0">tol0</code></td>
<td>
<p>numeric. Observations at time 0 make Weibull-based models singular.
The time for observatins taken at time 0 are changed for this value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>FitInactivation</code> with the following items:
</p>

<ul>
<li><p> fit_results: a list of class <code>modFit</code> with the info
of the adjustment.
</p>
</li>
<li><p> best_prediction: a list of class <code>SimulInactivation</code>
with prediction made by the adjusted model.
</p>
</li>
<li><p> data: a data frame with the data used for the fitting.
</p>
</li></ul>



<h3>See Also</h3>

<p><code>modFit</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## EXAMPLE 1 ------

data(dynamic_inactivation)  # The example data set is used.

get_model_data()  # Retrieve the valid model keys.

simulation_model &lt;- "Peleg"  # Peleg's model will be used

model_data &lt;- get_model_data(simulation_model)
model_data$parameters  # Set the model parameters

dummy_temp &lt;- data.frame(time = c(0, 1.25, 2.25, 4.6),
                         temperature = c(70, 105, 105, 70))  # Dummy temp. profile

## Set known parameters and initial points/bounds for unknown ones

known_params = c(temp_crit = 100)

starting_points &lt;- c(n = 1, k_b = 0.25, N0 = 1e+05)
upper_bounds &lt;- c(n = 2, k_b = 1, N0 = Inf)
lower_bounds &lt;- c(n = 0, k_b = 0, N0 = 1e4)

dynamic_fit &lt;- fit_dynamic_inactivation(dynamic_inactivation, simulation_model,
                                        dummy_temp, starting_points,
                                        upper_bounds, lower_bounds,
                                        known_params)

plot(dynamic_fit)
goodness_of_fit(dynamic_fit)

## END EXAMPLE 1 -----

</code></pre>

<hr>
<h2 id='fit_inactivation_MCMC'>Fitting of dynamic inactivation with MCMC</h2><span id='topic+fit_inactivation_MCMC'></span>

<h3>Description</h3>

<p>Fits the parameters of an inactivation model to experimental using
the Markov Chain Monte Carlo fitting algorithm implemented in
the function <code>modMCMC</code> of the package <code>FME</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_inactivation_MCMC(experiment_data, simulation_model, temp_profile,
  starting_points, upper_bounds, lower_bounds, known_params, ...,
  minimize_log = TRUE, tol0 = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_inactivation_MCMC_+3A_experiment_data">experiment_data</code></td>
<td>
<p>data frame with the experimental data to be adjusted.
It must have a column named &ldquo;time&rdquo; and another one named
&ldquo;N&rdquo;.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_simulation_model">simulation_model</code></td>
<td>
<p>character identifying the model to be used.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_temp_profile">temp_profile</code></td>
<td>
<p>data frame with discrete values of the temperature for
each time. It must have one column named <code>time</code> and another named
<code>temperature</code> providing discrete values of the temperature at
time points.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_starting_points">starting_points</code></td>
<td>
<p>starting values of the parameters for the adjustment.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_upper_bounds">upper_bounds</code></td>
<td>
<p>named numerical vector defining the upper bounds of the
parameters for the adjustment.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_lower_bounds">lower_bounds</code></td>
<td>
<p>named numerical vector defining the lower bounds of the
parameters for the adjustment.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_known_params">known_params</code></td>
<td>
<p>named numerical vector with the fixed (i.e., not
adjustable) model parameters.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_...">...</code></td>
<td>
<p>other arguments for <code>modMCMC</code>.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_minimize_log">minimize_log</code></td>
<td>
<p>logical. If <code>TRUE</code>, the adjustment is based on the
minimization of the error of the logarithmic count.</p>
</td></tr>
<tr><td><code id="fit_inactivation_MCMC_+3A_tol0">tol0</code></td>
<td>
<p>numeric. Observations at time 0 make Weibull-based models singular.
The time for observatins taken at time 0 are changed for this value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>FitInactivationMCMC</code> with the following items:
</p>

<ul>
<li> <p><code>modMCMC</code>: a list of class <code>modMCMC</code> with the
information of the adjustment process.
</p>
</li>
<li><p> best_prediction: a list of class <code>SimulInactivation</code>
with the prediction generated by the best predictor.
</p>
</li>
<li><p> data: a data frame with the data used for the fitting.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## EXAMPLE 1 ------
data(dynamic_inactivation)  # The example data set is used.

get_model_data()  # Retrieve the valid model keys.

simulation_model &lt;- "Peleg"  # Peleg's model will be used

model_data &lt;- get_model_data(simulation_model)
model_data$parameters  # Set the model parameters

dummy_temp &lt;- data.frame(time = c(0, 1.25, 2.25, 4.6),
                         temperature = c(70, 105, 105, 70))  # Dummy temp. profile

## Set known parameters and initial points/bounds for unknown ones

known_params = c(temp_crit = 100)

starting_points &lt;- c(n = 1, k_b = 0.25, N0 = 1e+05)
upper_bounds &lt;- c(n = 2, k_b = 1, N0 = 1e6)
lower_bounds &lt;- c(n = 0.5, k_b = 0.1, N0 = 1e4)

MCMC_fit &lt;- fit_inactivation_MCMC(dynamic_inactivation, simulation_model,
                                     dummy_temp, starting_points,
                                     upper_bounds, lower_bounds,
                                     known_params,
                                     niter = 100)
                                     # It is recommended to increase niter

plot(MCMC_fit)
goodness_of_fit(MCMC_fit)

## END EXAMPLE 1 -----

</code></pre>

<hr>
<h2 id='fit_isothermal_inactivation'>Fit of Isothermal Experiments</h2><span id='topic+fit_isothermal_inactivation'></span>

<h3>Description</h3>

<p>Fits the parameters of the model chosen to a set of isothermal experiments
using nonlinear regression through the function <code><a href="stats.html#topic+nls">nls</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_isothermal_inactivation(model_name, death_data, starting_point,
  known_params, adjust_log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_isothermal_inactivation_+3A_model_name">model_name</code></td>
<td>
<p>character specyfing the model to adjust.</p>
</td></tr>
<tr><td><code id="fit_isothermal_inactivation_+3A_death_data">death_data</code></td>
<td>
<p>data frame with the experiment data where each row is one
observation. It must have the following columns:
</p>

<ul>
<li><p> log_diff: Number of logarithmic reductions at each data point.
</p>
</li>
<li><p> temp: Temperature of the data point.
</p>
</li>
<li><p> time: Time of the data point.
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_isothermal_inactivation_+3A_starting_point">starting_point</code></td>
<td>
<p>List with the initial values of the parameters
for the adjustment.</p>
</td></tr>
<tr><td><code id="fit_isothermal_inactivation_+3A_known_params">known_params</code></td>
<td>
<p>List of the parameters of the model known.</p>
</td></tr>
<tr><td><code id="fit_isothermal_inactivation_+3A_adjust_log">adjust_log</code></td>
<td>
<p>logical. If <code>TRUE</code>, the adjustment is based on the
minimization of the error of the logarithmic microbial count. If
<code>FALSE</code>, it is based on the minimization of the error of the
microbial count. <code>TRUE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of class <code>IsoFitInactivation</code> with the results.
This list has four entries:
</p>

<ul>
<li><p> nls: The object of class <code><a href="stats.html#topic+nls">nls</a></code> with the results
of the adjustment.
</p>
</li>
<li><p> parameters: a list with the values of the model parameters,
both fixed and adjusted.
</p>
</li>
<li><p> model: a string with the key identifying the model used.
</p>
</li>
<li><p> data: the inactivation data used for the fit.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="stats.html#topic+nls">nls</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## EXAMPLE 1 -----------

data("isothermal_inactivation")  # data set used for the example.

get_isothermal_model_data()  # retrieve valid model keys.
model_name &lt;- "Bigelow"  # Bigelow's model will be used for the adjustment.

model_data &lt;- get_isothermal_model_data(model_name)
model_data$params  # Get the parameters of the model

## Define the input arguments

known_params = list(temp_ref = 100)
starting_point &lt;- c(z = 10,D_R = 1)

## Call the fitting function
iso_fit &lt;- fit_isothermal_inactivation(model_name,
                                       isothermal_inactivation, starting_point,
                                       known_params)

## Output of the results

plot(iso_fit, make_gg = TRUE)
goodness_of_fit(iso_fit)

## END EXAMPLE 1 --------

</code></pre>

<hr>
<h2 id='get_isothermal_model_data'>Isothermal Model Data</h2><span id='topic+get_isothermal_model_data'></span>

<h3>Description</h3>

<p>Provides information of the models implemented for fitting of isothermal
data.
This models are valid only for isothermal adjustment with the function
<code><a href="#topic+fit_isothermal_inactivation">fit_isothermal_inactivation</a></code>. To make predictions with the
function <code><a href="#topic+predict_inactivation">predict_inactivation</a></code> or adjust dynamic experiments
with <code><a href="#topic+fit_dynamic_inactivation">fit_dynamic_inactivation</a></code>, use
<code><a href="#topic+get_model_data">get_model_data</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_isothermal_model_data(model_name = "valids")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_isothermal_model_data_+3A_model_name">model_name</code></td>
<td>
<p>Optional string with the key of the model to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>model_name</code> is missing, a list of the valid model keys.
If <code>model_name</code> is not a valid key, NULL is returned.
Otherwise, a list with the parameters of the model selected and its
<code>formula</code> for the nonlinear adjustment.
</p>

<hr>
<h2 id='get_model_data'>Mapping of Simulation Model Functions</h2><span id='topic+get_model_data'></span>

<h3>Description</h3>

<p>Provides information about the function for dynamic predictions associated
to a valid <code>simulation_model</code> key.
If <code>simulation_model</code> is missing or <code>NULL</code>, a character vector
of valid model keys is provided.
This function is designed as an assistant for using the functions
<code><a href="#topic+predict_inactivation">predict_inactivation</a></code> and
<code><a href="#topic+fit_dynamic_inactivation">fit_dynamic_inactivation</a></code>.
For the adjustment of isothermal experiments with the function
<code><a href="#topic+fit_isothermal_inactivation">fit_isothermal_inactivation</a></code>, use the function
<code><a href="#topic+get_isothermal_model_data">get_isothermal_model_data</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_model_data(simulation_model = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_model_data_+3A_simulation_model">simulation_model</code></td>
<td>
<p>(optional) character with a valid model key or
<code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If simulation_model is <code>NULL</code> or missing, a character vector of
possible names. Otherwise, a list including information of the relevant
function:
</p>

<ul>
<li><p> ode: Pointer to the function defining the model ode.
</p>
</li>
<li><p> cost: Pointer to the function calculating the error of the
approximation.
</p>
</li>
<li><p> dtemp: logical defining whether the function requires the
definition of the first derivative of temperature.
</p>
</li>
<li><p> variables: a character vector defining which entry variables
are needed by the model.
</p>
</li>
<li><p> variables_priv: for internal use only.
</p>
</li>
<li><p> parameters: character vector with the parameters needed by
the model.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+predict_inactivation">predict_inactivation</a></code>,
<code><a href="#topic+fit_dynamic_inactivation">fit_dynamic_inactivation</a></code>
</p>

<hr>
<h2 id='get_prediction_cost'>Error of the Prediction of Microbial Inactivation</h2><span id='topic+get_prediction_cost'></span>

<h3>Description</h3>

<p>Calculates the error of the prediction of microbial inactivation for
the chosen inactivation model and the given parameters with respect to
the experimental data provided.
This function is compatible with the function
<code><a href="#topic+fit_dynamic_inactivation">fit_dynamic_inactivation</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_prediction_cost(data_for_fit, temp_profile, simulation_model, P,
  known_params)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_prediction_cost_+3A_data_for_fit">data_for_fit</code></td>
<td>
<p>A data frame with the experimental data to fit. It
must contain a column named &ldquo;time&rdquo; and another one named
&ldquo;N&rdquo;.</p>
</td></tr>
<tr><td><code id="get_prediction_cost_+3A_temp_profile">temp_profile</code></td>
<td>
<p><code>data.frame</code> defining the temperature profile. It
must have a column named &ldquo;time&rdquo; and another named
&ldquo;temperature&rdquo;.</p>
</td></tr>
<tr><td><code id="get_prediction_cost_+3A_simulation_model">simulation_model</code></td>
<td>
<p>character key defining the inactivation model.</p>
</td></tr>
<tr><td><code id="get_prediction_cost_+3A_p">P</code></td>
<td>
<p>list with the unknown parameters of the model to be adjusted.</p>
</td></tr>
<tr><td><code id="get_prediction_cost_+3A_known_params">known_params</code></td>
<td>
<p>list with the parameters of the model fixed (i.e.,
not adjusted)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of <code>modCost</code> with the error of the
prediction.
</p>


<h3>See Also</h3>

<p><code>modCost</code>, <code><a href="#topic+fit_dynamic_inactivation">fit_dynamic_inactivation</a></code>
</p>

<hr>
<h2 id='goodness_dyna'>Goodness of fit for Dynamic fits</h2><span id='topic+goodness_dyna'></span>

<h3>Description</h3>

<p>Goodness of fit for Dynamic fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goodness_dyna(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="goodness_dyna_+3A_object">object</code></td>
<td>
<p>An instance of FitInactivation</p>
</td></tr>
</table>

<hr>
<h2 id='goodness_iso'>Goodness of fit for Isothermal fits</h2><span id='topic+goodness_iso'></span>

<h3>Description</h3>

<p>Goodness of fit for Isothermal fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goodness_iso(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="goodness_iso_+3A_object">object</code></td>
<td>
<p>An object of class IsoFitInactivation.</p>
</td></tr>
</table>

<hr>
<h2 id='goodness_MCMC'>Goodness of fit for MCMC fits</h2><span id='topic+goodness_MCMC'></span>

<h3>Description</h3>

<p>Goodness of fit for MCMC fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goodness_MCMC(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="goodness_MCMC_+3A_object">object</code></td>
<td>
<p>An instance of FitInactivationMCMC</p>
</td></tr>
</table>

<hr>
<h2 id='goodness_of_fit'>Goodness of fit for microbial inactivation models</h2><span id='topic+goodness_of_fit'></span>

<h3>Description</h3>

<p>Generates a table with several statistical indexes describing the
quality of the model fit: 
</p>

<ul>
<li><p> ME: Mean Error.
</p>
</li>
<li><p> RMSE: Root Mean Squared Error.
</p>
</li>
<li><p> loglik: log-likelihood.
</p>
</li>
<li><p> AIC: Akaike Information Criterion.
</p>
</li>
<li><p> AICc: Akaike Information Criterion with correction for 
finite sample size.
</p>
</li>
<li><p> BIC: Bayesian Infromation Criterion.
</p>
</li>
<li><p> Af: Accuracy factor.
</p>
</li>
<li><p> Bf: Bias factor.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>goodness_of_fit(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="goodness_of_fit_+3A_object">object</code></td>
<td>
<p>A model fit generated by bioinactivation</p>
</td></tr>
</table>

<hr>
<h2 id='is.FitInactivation'>Test of FitInactivation object</h2><span id='topic+is.FitInactivation'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>FitInactivation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.FitInactivation(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.FitInactivation_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logic specifying whether <code>x</code> is of class
<code>FitInactivation</code>
</p>

<hr>
<h2 id='is.FitInactivationMCMC'>Test of FitInactivationMCMC object</h2><span id='topic+is.FitInactivationMCMC'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>FitInactivationMCMC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.FitInactivationMCMC(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.FitInactivationMCMC_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logic specifying whether <code>x</code> is of class
<code>FitInactivationMCMC</code>
</p>

<hr>
<h2 id='is.IsoFitInactivation'>Test of IsoFitInactivation object</h2><span id='topic+is.IsoFitInactivation'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>IsoFitInactivation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.IsoFitInactivation(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.IsoFitInactivation_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logic specifying whether <code>x</code> is of class
<code>IsoFitInactivation</code>
</p>

<hr>
<h2 id='is.PredInactivationMCMC'>Test of PredInactivationMCMC object</h2><span id='topic+is.PredInactivationMCMC'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>PredInactivationMCMC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.PredInactivationMCMC(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.PredInactivationMCMC_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logic specifying whether <code>x</code> is of class
<code>PredInactivationMCMC</code>
</p>

<hr>
<h2 id='is.SimulInactivation'>Test of SimulInactivation object</h2><span id='topic+is.SimulInactivation'></span>

<h3>Description</h3>

<p>Tests if an object is of class <code>SimulInactivation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.SimulInactivation(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.SimulInactivation_+3A_x">x</code></td>
<td>
<p>object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logic specifying whether <code>x</code> is of class
<code>SimulInactivation</code>
</p>

<hr>
<h2 id='isothermal_inactivation'>Example Isothermal Inactivation of a Microorganis</h2><span id='topic+isothermal_inactivation'></span>

<h3>Description</h3>

<p>Example of experimental data for an isothermal process of a
microorganism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(isothermal_inactivation)
</code></pre>


<h3>Format</h3>

<p>A data frame with 36 rows and 3 variables.</p>


<h3>Details</h3>


<ul>
<li><p> time: Time in minutes of the measurement.
</p>
</li>
<li><p> temp: Temperature at which the experiment was made.
</p>
</li>
<li><p> log_diff: Logarithmic difference.
</p>
</li></ul>


<hr>
<h2 id='laterosporus_dyna'>Example Dynamic Inactivation of a Laterosporus</h2><span id='topic+laterosporus_dyna'></span>

<h3>Description</h3>

<p>Example of experimental data of the dynamic inactivation process of
Laterosporus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(laterosporus_dyna)
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 3 variables.</p>


<h3>Details</h3>


<ul>
<li><p> time: Time in minutes of the measurement.
</p>
</li>
<li><p> temp: observed temperature.
</p>
</li>
<li><p> logN: recorded number of microorganism.
</p>
</li></ul>


<hr>
<h2 id='laterosporus_iso'>Example Isothermal Inactivation of a Laterosporus</h2><span id='topic+laterosporus_iso'></span>

<h3>Description</h3>

<p>Example of experimental data for an isothermal process of
Laterosporus.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(laterosporus_iso)
</code></pre>


<h3>Format</h3>

<p>A data frame with 52 rows and 3 variables.</p>


<h3>Details</h3>


<ul>
<li><p> time: Time in minutes of the measurement.
</p>
</li>
<li><p> temp: Temperature at which the experiment was made.
</p>
</li>
<li><p> log_diff: Logarithmic difference.
</p>
</li></ul>


<hr>
<h2 id='Metselaar_iso'>Isothermal Metselaar model</h2><span id='topic+Metselaar_iso'></span>

<h3>Description</h3>

<p>Returns the predicted logarithmic reduction in microbial count according
to Metselaars's model for the time, temperature and model parameters
given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Metselaar_iso(time, temp, D_R, z, p, Delta, temp_ref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Metselaar_iso_+3A_time">time</code></td>
<td>
<p>numeric indicating the time at which the prediction is taken.</p>
</td></tr>
<tr><td><code id="Metselaar_iso_+3A_temp">temp</code></td>
<td>
<p>numeric indicating the temperature of the treatment.</p>
</td></tr>
<tr><td><code id="Metselaar_iso_+3A_d_r">D_R</code></td>
<td>
<p>numeric defining the delta-value at the reference temperature.</p>
</td></tr>
<tr><td><code id="Metselaar_iso_+3A_z">z</code></td>
<td>
<p>numeric defining the z-value.</p>
</td></tr>
<tr><td><code id="Metselaar_iso_+3A_p">p</code></td>
<td>
<p>numeric defining shape factor of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="Metselaar_iso_+3A_delta">Delta</code></td>
<td>
<p>numeric reparametrization factor</p>
</td></tr>
<tr><td><code id="Metselaar_iso_+3A_temp_ref">temp_ref</code></td>
<td>
<p>numeric indicating the reference temperature.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric with the predicted logarithmic reduction
(<code class="reqn">log10(N/N0)</code>).
</p>

<hr>
<h2 id='plot.FitInactivation'>Plot of FitInactivation Object</h2><span id='topic+plot.FitInactivation'></span>

<h3>Description</h3>

<p>Plots a comparison between the experimental data provided and the prediction
produced by the model parameters adjusted for an instance of
<code>FitInactivation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitInactivation'
plot(x, y = NULL, ..., make_gg = TRUE,
  plot_temp = FALSE, label_y1 = "logN", label_y2 = "Temperature",
  ylims = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.FitInactivation_+3A_x">x</code></td>
<td>
<p>the object of class <code>FitInactivation</code> to plot.</p>
</td></tr>
<tr><td><code id="plot.FitInactivation_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="plot.FitInactivation_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.FitInactivation_+3A_make_gg">make_gg</code></td>
<td>
<p>logical. If <code>TRUE</code>, the plot is created using
<code>ggplot2</code>. Otherwise, the plot is crated with base <code>R</code>.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="plot.FitInactivation_+3A_plot_temp">plot_temp</code></td>
<td>
<p>logical. Whether the temperature profile will
be added to the plot. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="plot.FitInactivation_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the principal y-axis.</p>
</td></tr>
<tr><td><code id="plot.FitInactivation_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="plot.FitInactivation_+3A_ylims">ylims</code></td>
<td>
<p>Numeric vector of length 2 with the Limits of the
y-axis. <code>NULL</code> by default (0, max_count).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>make_gg = FALSE</code>, the plot is created. Otherwise, an
an instance of <code>ggplot</code> is generated, printed and returned.
</p>

<hr>
<h2 id='plot.FitInactivationMCMC'>Plot of FitInactivationMCMC Object</h2><span id='topic+plot.FitInactivationMCMC'></span>

<h3>Description</h3>

<p>Plots a comparison between the experimental data provided and the prediction
produced by the model parameters adjusted for an instance of
<code>FitInactivationMCMC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitInactivationMCMC'
plot(x, y = NULL, ..., make_gg = TRUE,
  plot_temp = FALSE, label_y1 = "logN", label_y2 = "Temperature",
  ylims = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.FitInactivationMCMC_+3A_x">x</code></td>
<td>
<p>the object of class <code>FitInactivation</code> to plot.</p>
</td></tr>
<tr><td><code id="plot.FitInactivationMCMC_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="plot.FitInactivationMCMC_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.FitInactivationMCMC_+3A_make_gg">make_gg</code></td>
<td>
<p>logical. If <code>TRUE</code>, the plot is created using
<code>ggplot2</code>. Otherwise, the plot is crated with base <code>R</code>.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="plot.FitInactivationMCMC_+3A_plot_temp">plot_temp</code></td>
<td>
<p>logical. Whether the temperature profile will
be added to the plot. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="plot.FitInactivationMCMC_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the principal y-axis.</p>
</td></tr>
<tr><td><code id="plot.FitInactivationMCMC_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="plot.FitInactivationMCMC_+3A_ylims">ylims</code></td>
<td>
<p>Numeric vector of length 2 with the Limits of the
y-axis. <code>NULL</code> by default (0, max_count).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>make_gg = FALSE</code>, the plot is created. Otherwise, an
an instance of <code>ggplot</code> is generated, printed and returned.
</p>

<hr>
<h2 id='plot.IsoFitInactivation'>Plot of IsoFitInactivation Object</h2><span id='topic+plot.IsoFitInactivation'></span>

<h3>Description</h3>

<p>For each one of the temperatures studied, plots a comparison between the
predicted result and the experimental one for an instance of
<code>IsoFitInactivation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'IsoFitInactivation'
plot(x, y = NULL, ..., make_gg = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.IsoFitInactivation_+3A_x">x</code></td>
<td>
<p>the object of class <code>IsoFitInactivation</code> to plot.</p>
</td></tr>
<tr><td><code id="plot.IsoFitInactivation_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="plot.IsoFitInactivation_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.IsoFitInactivation_+3A_make_gg">make_gg</code></td>
<td>
<p>logical. If <code>TRUE</code>, the plot is created using
<code>ggplot2</code>. Otherwise, the plot is crated with base <code>R</code>.
<code>FALSE</code> by default.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.PredInactivationMCMC'>Plot of PredInactivationMCMC Object</h2><span id='topic+plot.PredInactivationMCMC'></span>

<h3>Description</h3>

<p>Plots the prediction interval generated by
<code><a href="#topic+predict_inactivation_MCMC">predict_inactivation_MCMC</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PredInactivationMCMC'
plot(x, y = NULL, ..., make_gg = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.PredInactivationMCMC_+3A_x">x</code></td>
<td>
<p>the object of class <code>PredInactivationMCMC</code> to plot.</p>
</td></tr>
<tr><td><code id="plot.PredInactivationMCMC_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="plot.PredInactivationMCMC_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.PredInactivationMCMC_+3A_make_gg">make_gg</code></td>
<td>
<p>logical. If <code>TRUE</code>, the plot is created using
<code>ggplot2</code>. Otherwise, the plot is crated with base <code>R</code>.
<code>TRUE</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot generated in ggplot (default) generates a dashed line with the mean
of the MC
simulations. Moreover, a ribbon with the 2 first quantiles (i.e. columns 3
and 4) is generated.
</p>
<p>The plot generated with base R (make_gg = <code>FALSE</code>) generates a solid line
wth the mean of the MC simulations. Each one of the other quantiles included
in the data frame are added with different
</p>


<h3>Value</h3>

<p>If <code>make_gg = FALSE</code>, the plot is created. Otherwise, an
an instance of <code>ggplot</code> is generated, printed and returned.
</p>

<hr>
<h2 id='plot.SimulInactivation'>Plot of SimulInactivation Object</h2><span id='topic+plot.SimulInactivation'></span>

<h3>Description</h3>

<p>Plots the predicted evolution of the logarithmic count with time for an
instance of <code>SimulInactivation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SimulInactivation'
plot(x, y = NULL, ..., make_gg = TRUE,
  plot_temp = FALSE, label_y1 = "logN", label_y2 = "Temperature",
  ylims = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SimulInactivation_+3A_x">x</code></td>
<td>
<p>The object of class <code>SimulInactivation</code> to plot.</p>
</td></tr>
<tr><td><code id="plot.SimulInactivation_+3A_y">y</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="plot.SimulInactivation_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.SimulInactivation_+3A_make_gg">make_gg</code></td>
<td>
<p>logical. If <code>TRUE</code>, the plot is created using
<code>ggplot2</code>. Otherwise, the plot is crated with base <code>R</code>.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="plot.SimulInactivation_+3A_plot_temp">plot_temp</code></td>
<td>
<p>logical. Whether the temperature profile will
be added to the plot. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="plot.SimulInactivation_+3A_label_y1">label_y1</code></td>
<td>
<p>Label of the principal y-axis.</p>
</td></tr>
<tr><td><code id="plot.SimulInactivation_+3A_label_y2">label_y2</code></td>
<td>
<p>Label of the secondary y-axis.</p>
</td></tr>
<tr><td><code id="plot.SimulInactivation_+3A_ylims">ylims</code></td>
<td>
<p>Numeric vector of length 2 with the Limits of the
y-axis. <code>NULL</code> by default (0, max_count).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>make_gg = FALSE</code>, the plot is created. Otherwise, an
an instance of <code>ggplot</code> is generated, printed and returned.
</p>

<hr>
<h2 id='predict_inactivation'>Prediction of Dynamic Inactivation</h2><span id='topic+predict_inactivation'></span>

<h3>Description</h3>

<p>Predicts the inactivation of a microorganism under isothermal or
non-isothermal temperature conditions. The thermal resistence of
the microorganism are defined with the input arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_inactivation(simulation_model, times, parms, temp_profile, ...,
  tol0 = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_inactivation_+3A_simulation_model">simulation_model</code></td>
<td>
<p>character identifying the model to be used.</p>
</td></tr>
<tr><td><code id="predict_inactivation_+3A_times">times</code></td>
<td>
<p>numeric vector of output times.</p>
</td></tr>
<tr><td><code id="predict_inactivation_+3A_parms">parms</code></td>
<td>
<p>list of parameters defining the parameters of the model.</p>
</td></tr>
<tr><td><code id="predict_inactivation_+3A_temp_profile">temp_profile</code></td>
<td>
<p>data frame with discrete values of the temperature for
each time. It must have one column named <code>time</code> and another named
<code>temperature</code> providing discrete values of the temperature at
time points.</p>
</td></tr>
<tr><td><code id="predict_inactivation_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="deSolve.html#topic+ode">ode</a></code>.</p>
</td></tr>
<tr><td><code id="predict_inactivation_+3A_tol0">tol0</code></td>
<td>
<p>numeric. Observations at time 0 make Weibull-based models singular.
The time for observatins taken at time 0 are changed for this value.
By default ('tol0 = 1e-5')</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of the temperature is calculated at each value of time by
linear interpolation of the values provided by the input argument
<code>temp_profile</code>.
The function <code><a href="deSolve.html#topic+ode">ode</a></code> of the package <code><a href="deSolve.html#topic+deSolve">deSolve</a></code> is
used for the resolution of the differential equation.
</p>


<h3>Value</h3>

<p>A list of class <code>SimulInactivation</code> with the results. It has
the following entries:
</p>

<ul>
<li><p> model: character defining the model use for the prediction.
</p>
</li>
<li><p> model_parameters: named numeric vector with the values of
the model parameters used.
</p>
</li>
<li><p> temp_approximations: function used for the interpolation of
the temperature. For a numeric value of
time given, returns the value of the
temperature and its first derivative.
</p>
</li>
<li><p> simulation: A data frame with the results calculated. Its
first column contains the times at which the
solution has been calculated. The following
columns the values of the variables of the
model. The three last columns provide the
values of <code>logN</code>, <code>S</code> and
<code>logS</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="deSolve.html#topic+ode">ode</a></code>, <code><a href="#topic+get_model_data">get_model_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## EXAMPLE 1 -----------

## Retrieve the model keys available for dynamic models.
get_model_data()

## Set the input arguments
example_model &lt;- "Geeraerd"  # Geeraerd's model will be used
times &lt;- seq(0, 5, length=100)  # values of time for output

model_data &lt;- get_model_data(example_model)  # Retrive the data of the model used
print(model_data$parameters)
print(model_data$variables)
model_parms &lt;- c(D_R = 1,
                 z = 10,
                 N_min = 100,
                 temp_ref = 100,
                 N0 = 100000,
                 C_c0 = 1000
                 )

## Define the temperature profile for the prediction
temperature_profile &lt;- data.frame(time = c(0, 1.25, 2.25, 4.6),
                                  temperature = c(70, 105, 105, 70))

## Call the prediction function
prediction_results &lt;- predict_inactivation(example_model, times,
                                           model_parms, temperature_profile)

## Show the results
head(prediction_results$simulation)
plot(prediction_results)
time_to_logreduction(1.5, prediction_results)

## END EXAMPLE 1 -----------

</code></pre>

<hr>
<h2 id='predict_inactivation_MCMC'>Dynamic Prediction Intervals from a Monte Carlo Adjustment</h2><span id='topic+predict_inactivation_MCMC'></span>

<h3>Description</h3>

<p>Given a model adjustment of a dynamic microbial inactivation process
performed using any of the functions in <code>bioinactivation</code> calculates
probability intervals at each time point using a Monte Carlo method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_inactivation_MCMC(fit_object, temp_profile, n_simulations = 100,
  times = NULL, quantiles = c(2.5, 97.5), additional_pars = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_inactivation_MCMC_+3A_fit_object">fit_object</code></td>
<td>
<p>An object of classes <code>FitInactivationMCMC</code>,
<code>IsoFitInactivation</code> or <code>FitInactivation</code>.</p>
</td></tr>
<tr><td><code id="predict_inactivation_MCMC_+3A_temp_profile">temp_profile</code></td>
<td>
<p>data frame with discrete values of the temperature for
each time. It must have one column named <code>time</code> and another named
<code>temperature</code> providing discrete values of the temperature at
time points.</p>
</td></tr>
<tr><td><code id="predict_inactivation_MCMC_+3A_n_simulations">n_simulations</code></td>
<td>
<p>a numeric indicating how many Monte Carlo simulations
to perform. <code>100</code> by default.</p>
</td></tr>
<tr><td><code id="predict_inactivation_MCMC_+3A_times">times</code></td>
<td>
<p>numeric vector specifying the time points when results are
desired. If <code>NULL</code>, the times in <code>MCMC_fit$best_prediction</code>
are used. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="predict_inactivation_MCMC_+3A_quantiles">quantiles</code></td>
<td>
<p>numeric vector indicating the quantiles to calculate in
percentage. By default, it is set to c(2.5, 97.5) which generates a
prediction interval with confidence 0.95. If <code>NULL</code>, the quantiles
are not calculated and all the simulations are returned.</p>
</td></tr>
<tr><td><code id="predict_inactivation_MCMC_+3A_additional_pars">additional_pars</code></td>
<td>
<p>Additional parameters not included in the adjustment (e.g.
the initial number of microorganism in an isothermal fit).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of class <code>PredInactivationMCMC</code>. On its first column,
time at which the calculation has been made is indicated.
If <code>quantiles = NULL</code>, the following columns contain the
results of each simulation. Otherwise, the second and third columns
provide the mean and median of the simulations at the given time
point. Following columns contain the quantiles of the results.
</p>

<hr>
<h2 id='sample_dynaFit'>Random sample of the parameters of a FitInactivation object</h2><span id='topic+sample_dynaFit'></span>

<h3>Description</h3>

<p>Function to be called by <code><a href="#topic+predict_inactivation_MCMC">predict_inactivation_MCMC</a></code>. Produces
a random sample of the parameters adjusted from dynamic experiments with non
linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_dynaFit(dynamic_fit, times, n_simulations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_dynaFit_+3A_dynamic_fit">dynamic_fit</code></td>
<td>
<p>An object of class <code>FitInactivationMCMC</code> as generated
by <code><a href="#topic+fit_inactivation_MCMC">fit_inactivation_MCMC</a></code>.</p>
</td></tr>
<tr><td><code id="sample_dynaFit_+3A_times">times</code></td>
<td>
<p>numeric vector specifying the time points when results are
desired. If <code>NULL</code>, the times in <code>MCMC_fit$best_prediction</code>
are used.</p>
</td></tr>
<tr><td><code id="sample_dynaFit_+3A_n_simulations">n_simulations</code></td>
<td>
<p>a numeric indicating how many Monte Carlo simulations
to perform.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the parameters follow a Multivariate Normal distribution
with the mean the parameters estimated by <code>modFit</code>. The unscaled
covariance matrix returned by <code>modFit</code> is used.
</p>
<p>The function produces a random sample using the function <code><a href="MASS.html#topic+mvrnorm">mvrnorm</a></code>.
</p>


<h3>Value</h3>

<p>Returns a list with 4 components.
</p>

<ul>
<li><p> par_sample: data frame with the parameter sample.
</p>
</li>
<li><p> simulation_model: model key for the simulation
</p>
</li>
<li><p> known_pars: parameters of the model known
</p>
</li>
<li><p> times: points where the calculation is made.
</p>
</li></ul>


<hr>
<h2 id='sample_IsoFit'>Random sample of the parameters of a IsoFitInactivation object</h2><span id='topic+sample_IsoFit'></span>

<h3>Description</h3>

<p>Function to be called by <code><a href="#topic+predict_inactivation_MCMC">predict_inactivation_MCMC</a></code>. Produces
a random sample of the parameters adjusted from isothermal experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_IsoFit(iso_fit, times, n_simulations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_IsoFit_+3A_iso_fit">iso_fit</code></td>
<td>
<p>An object of class <code>FitInactivationMCMC</code> as generated
by <code><a href="#topic+fit_inactivation_MCMC">fit_inactivation_MCMC</a></code>.</p>
</td></tr>
<tr><td><code id="sample_IsoFit_+3A_times">times</code></td>
<td>
<p>numeric vector specifying the time points when results are
desired. If <code>NULL</code>, an equispaced interval between <code>0</code>
and the maximum time of the observations with length <code>50</code>
is used.</p>
</td></tr>
<tr><td><code id="sample_IsoFit_+3A_n_simulations">n_simulations</code></td>
<td>
<p>a numeric indicating how many Monte Carlo simulations
to perform.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the parameters follow a Multivariate Normal distribution
with the mean and covariance matrix estimated by the adjustment. The function
produces a random sample using the function <code><a href="MASS.html#topic+mvrnorm">mvrnorm</a></code>.
</p>


<h3>Value</h3>

<p>Returns a list with 4 components.
</p>

<ul>
<li><p> par_sample: data frame with the parameter sample.
</p>
</li>
<li><p> simulation_model: model key for the simulation
</p>
</li>
<li><p> known_pars: parameters of the model known
</p>
</li>
<li><p> times: points where the calculation is made.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="MASS.html#topic+mvrnorm">mvrnorm</a></code>
</p>

<hr>
<h2 id='sample_MCMCfit'>Random sample of the parameters of a FitInactivationMCMC object</h2><span id='topic+sample_MCMCfit'></span>

<h3>Description</h3>

<p>Function to be called by <code><a href="#topic+predict_inactivation_MCMC">predict_inactivation_MCMC</a></code>. Produces
a random sample of the parameters calculated on the iterations of the Monte
Carlo simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_MCMCfit(MCMC_fit, times, n_simulations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_MCMCfit_+3A_mcmc_fit">MCMC_fit</code></td>
<td>
<p>An object of class <code>FitInactivationMCMC</code> as generated
by <code><a href="#topic+fit_inactivation_MCMC">fit_inactivation_MCMC</a></code>.</p>
</td></tr>
<tr><td><code id="sample_MCMCfit_+3A_times">times</code></td>
<td>
<p>numeric vector specifying the time points when results are
desired. If <code>NULL</code>, the times in <code>MCMC_fit$best_prediction</code>
are used.</p>
</td></tr>
<tr><td><code id="sample_MCMCfit_+3A_n_simulations">n_simulations</code></td>
<td>
<p>a numeric indicating how many Monte Carlo simulations
to perform.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with 4 components.
</p>

<ul>
<li><p> par_sample: data frame with the parameter sample.
</p>
</li>
<li><p> simulation_model: model key for the simulation
</p>
</li>
<li><p> known_pars: parameters of the model known
</p>
</li>
<li><p> times: points where the calculation is made.
</p>
</li></ul>


<hr>
<h2 id='summary.FitInactivation'>Summary of a FitInactivation object</h2><span id='topic+summary.FitInactivation'></span>

<h3>Description</h3>

<p>Summary of a FitInactivation object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitInactivation'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.FitInactivation_+3A_object">object</code></td>
<td>
<p>Instance of Fit Inactivation</p>
</td></tr>
<tr><td><code id="summary.FitInactivation_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='summary.FitInactivationMCMC'>Summary of a FitInactivationMCMC object</h2><span id='topic+summary.FitInactivationMCMC'></span>

<h3>Description</h3>

<p>Summary of a FitInactivationMCMC object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FitInactivationMCMC'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.FitInactivationMCMC_+3A_object">object</code></td>
<td>
<p>Instance of FitInactivationMCMC</p>
</td></tr>
<tr><td><code id="summary.FitInactivationMCMC_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='summary.IsoFitInactivation'>Summary of a IsoFitInactivation object</h2><span id='topic+summary.IsoFitInactivation'></span>

<h3>Description</h3>

<p>Summary of a IsoFitInactivation object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'IsoFitInactivation'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.IsoFitInactivation_+3A_object">object</code></td>
<td>
<p>Instance of IsoFitInactivation</p>
</td></tr>
<tr><td><code id="summary.IsoFitInactivation_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='time_to_logreduction'>Time to reach X log reductions</h2><span id='topic+time_to_logreduction'></span>

<h3>Description</h3>

<p>Calculates the treatment time required to reach a given number of log reductions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_to_logreduction(n_logs, my_prediction)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_to_logreduction_+3A_n_logs">n_logs</code></td>
<td>
<p>Numeric of length one indicating the number of log recutions</p>
</td></tr>
<tr><td><code id="time_to_logreduction_+3A_my_prediction">my_prediction</code></td>
<td>
<p>An object of class SimulInactivation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The treatement time is calculated by linear interpolation betweent the two points of
the simulation whose logS is closer to n_logs
</p>

<hr>
<h2 id='WeibullMafart_iso'>Isothermal Weibull-Mafart Model</h2><span id='topic+WeibullMafart_iso'></span>

<h3>Description</h3>

<p>Returns the predicted logarithmic reduction in microbial count according
to Weibull-Mafarts's model for the time, temperature and model parameters
given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeibullMafart_iso(time, temp, delta_ref, z, p, temp_ref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WeibullMafart_iso_+3A_time">time</code></td>
<td>
<p>numeric indicating the time at which the prediction is taken.</p>
</td></tr>
<tr><td><code id="WeibullMafart_iso_+3A_temp">temp</code></td>
<td>
<p>numeric indicating the temperature of the treatment.</p>
</td></tr>
<tr><td><code id="WeibullMafart_iso_+3A_delta_ref">delta_ref</code></td>
<td>
<p>numeric defining the delta-value at the reference temperature.</p>
</td></tr>
<tr><td><code id="WeibullMafart_iso_+3A_z">z</code></td>
<td>
<p>numeric defining the z-value.</p>
</td></tr>
<tr><td><code id="WeibullMafart_iso_+3A_p">p</code></td>
<td>
<p>numeric defining shape factor of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="WeibullMafart_iso_+3A_temp_ref">temp_ref</code></td>
<td>
<p>numeric indicating the reference temperature.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric with the predicted logarithmic reduction
(<code class="reqn">log10(N/N0)</code>).
</p>

<hr>
<h2 id='WeibullPeleg_iso'>Isothermal Weibull-Peleg Model</h2><span id='topic+WeibullPeleg_iso'></span>

<h3>Description</h3>

<p>Returns the predicted logarithmic reduction in microbial count according
to Weibull-Peleg's model for the time, temperature and model parameters
given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeibullPeleg_iso(time, temp, n, k_b, temp_crit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WeibullPeleg_iso_+3A_time">time</code></td>
<td>
<p>numeric indicating the time at which the prediction is taken.</p>
</td></tr>
<tr><td><code id="WeibullPeleg_iso_+3A_temp">temp</code></td>
<td>
<p>numeric indicating the temperature of the treatment.</p>
</td></tr>
<tr><td><code id="WeibullPeleg_iso_+3A_n">n</code></td>
<td>
<p>numeric defining shape factor of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="WeibullPeleg_iso_+3A_k_b">k_b</code></td>
<td>
<p>numeric indicating the slope of the b~temp line.</p>
</td></tr>
<tr><td><code id="WeibullPeleg_iso_+3A_temp_crit">temp_crit</code></td>
<td>
<p>numeric with the value of the critical temperature.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric with the predicted logarithmic reduction
(<code class="reqn">log10(N/N0)</code>).
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
