<!DOCTYPE html><html><head><title>Help for package dgumbel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dgumbel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gumbel'><p>The Gumbel Distribution and Derivatives</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Gumbel Distribution Functions and Gradients</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-04-07</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Berent Ånund Strømnes Lunde &lt;lundeberent@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Gumbel distribution functions (De Haan L. (2007)
    &lt;<a href="https://doi.org/10.1007%2F0-387-34471-3">doi:10.1007/0-387-34471-3</a>&gt;) implemented with the techniques of automatic
    differentiation (Griewank A. (2008) &lt;isbn:978-0-89871-659-7&gt;).
    With this tool, a user should be able to quickly model extreme
    events for which the Gumbel distribution is the domain of attraction.
    The package makes available the density function, the distribution
    function the quantile function and a random generating function. In
    addition, it supports gradient functions. The package combines 'Adept'
    (C++ templated automatic differentiation) (Hogan R. (2017)
    &lt;<a href="https://doi.org/10.5281%2Fzenodo.1004730">doi:10.5281/zenodo.1004730</a>&gt;) and 'Eigen' (templated matrix-vector
    library) for fast computations of both objective functions and exact
    gradients. It relies on 'RcppEigen' for easy access to 'Eigen' and
    bindings to R.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/blunde1/dgumbel">https://github.com/blunde1/dgumbel</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/blunde1/dgumbel/issues">https://github.com/blunde1/dgumbel/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.2)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-13 19:11:46 UTC; lunde</td>
</tr>
<tr>
<td>Author:</td>
<td>Berent Ånund Strømnes Lunde [aut, cre, cph],
  Robin Hogan [ctb] (Author of included Adept library),
  The University of Reading [cph] (Copyright holder of included Adept
    library)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-16 21:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='gumbel'>The Gumbel Distribution and Derivatives</h2><span id='topic+dgumbel'></span><span id='topic+pgumbel'></span><span id='topic+qgumbel'></span><span id='topic+rgumbel'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantile function and
random generation, and their gradient functions 
for the Gumbel distribution with location and scale parameters. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgumbel(x, location=0, scale=1, log = FALSE, grad=FALSE) 
pgumbel(q, location=0, scale=1, lower.tail = TRUE, log.p = FALSE, grad=FALSE) 
qgumbel(p, location=0, scale=1, lower.tail = TRUE, grad=FALSE)
rgumbel(n, location=0, scale=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gumbel_+3A_x">x</code>, <code id="gumbel_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="gumbel_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="gumbel_+3A_n">n</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="gumbel_+3A_location">location</code>, <code id="gumbel_+3A_scale">scale</code></td>
<td>
<p>Location and scale parameters.</p>
</td></tr>
<tr><td><code id="gumbel_+3A_log">log</code>, <code id="gumbel_+3A_log.p">log.p</code></td>
<td>
<p>Logical; if <code>TRUE</code>, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="gumbel_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical; if <code>TRUE</code> (default), probabilities
are P[X &lt;= x], otherwise, P[X &gt; x]</p>
</td></tr>
<tr><td><code id="gumbel_+3A_grad">grad</code></td>
<td>
<p>Logical; if <code>TRUE</code>, the gradient w.r.t. parameters location and scale is given instead of function value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Gumbel distribution function with parameters
<code class="reqn">\code{location} = a</code> and <code class="reqn">\code{scale} = b</code> is
</p>
<p style="text-align: center;"><code class="reqn">G(z) = \exp\left\{-\exp\left[-\left(\frac{z-a}{b}\right)
    \right]\right\}</code>
</p>

<p>for all real <code class="reqn">z</code>, where <code class="reqn">b &gt; 0</code>.
Gradients are exact numerical derivatives implemented using automatic differentiation.
<code>dgumbel</code> builds on the <code>Eigen</code> linear algebra library, <code>Adept</code> for automatic differentiation and <code>RcppEigen</code> for bindings to <code>R</code> and loading <code>Eigen</code>.
</p>


<h3>Value</h3>

<p><code>dgumbel</code> gives the density function, <code>pgumbel</code> gives
the distribution function, <code>qgumbel</code> gives the quantile
function, and <code>rgumbel</code> generates random deviates. 
If <code>grad=TRUE</code> is supplied, then the gradient is returned instead of the objective function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dgumbel(-1:2, -1, 0.5)
pgumbel(-1:2, -1, 0.5)
qgumbel(seq(0.9, 0.6, -0.1), 2, 0.5)
rgumbel(6, -1, 0.5)
p &lt;- (1:9)/10
pgumbel(qgumbel(p, -1, 2), -1, 2)
## [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9

## Random number generation
loc = .5
scale = 3.2
n &lt;- 1000
x &lt;- rgumbel(n, loc, scale)

## The density
hist(x, freq=FALSE)
xs &lt;- sort(x)
fx &lt;- dgumbel(xs, loc, scale)
points(xs,fx, type="l", col=2, lwd=2)

## The distribution
edf &lt;- sapply(xs, function(x){sum(xs&lt;=x)/n})
plot(xs, edf)
Fx &lt;- pgumbel(xs, loc, scale)
points(xs, Fx, type="l", col=2, lwd=2) 

## The quantile function
q &lt;- qgumbel(0.6, loc, scale)
polygon(c(xs[xs &lt;= q], q), c(Fx[xs&lt;=q], 0), col=3)

## Negative log likelihood: Objective and gradient
nll &lt;- function(par, data) -sum(dgumbel(data, par[1], par[2], log=TRUE))
dnll &lt;- function(par, data) -rowSums(dgumbel(data, par[1], par[2], log=TRUE, grad=TRUE))

## Parameter estimation
par_start &lt;- c(3,1)
opt &lt;- nlminb(par_start, objective=nll, gradient=dnll, data=x, control = list(trace=5))
opt$convergence
opt$par

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
