<!DOCTYPE html><html><head><title>Help for package MBA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MBA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LIDAR'><p>Canopy LIDAR data</p></a></li>
<li><a href='#mba.points'><p>Point approximation from bivariate scattered data using multilevel B-splines</p></a></li>
<li><a href='#mba.surf'><p>Surface approximation from bivariate scattered data using multilevel B-splines</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-22</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Title:</td>
<td>Multilevel B-Spline Approximation</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&gt; 2.10.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>sp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to interpolate irregularly and regularly spaced data using Multilevel B-spline Approximation (MBA). Functions call portions of the SINTEF Multilevel B-spline Library written by Øyvind Hjelle which implements methods developed by Lee, Wolberg and Shin (1997; &lt;<a href="https://doi.org/10.1109%2F2945.620490">doi:10.1109/2945.620490</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-29 13:24:00 UTC; andy</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Finley [aut, cre],
  Sudipto Banerjee [aut],
  Øyvind Hjelle [aut],
  Roger Bivand [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Finley &lt;finleya@msu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-29 13:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='LIDAR'>Canopy LIDAR data</h2><span id='topic+LIDAR'></span>

<h3>Description</h3>

 
<p>This is a small portion of Light Detection and Ranging (LIDAR) data
taken over a forested landscape in Wisconsin, USA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIDAR)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 10123 rows and 3 columns corresponding to
longitude, latitude, and elevation.
</p>


<h3>Source</h3>

<p>Data provided by:
Dr. Paul V. Bolstad,
Department of Forest Resources,
University of Minnesota,
<a href="mailto:pbolstad@umn.edu">pbolstad@umn.edu</a>
</p>

<hr>
<h2 id='mba.points'>Point approximation from bivariate scattered data using multilevel B-splines</h2><span id='topic+mba.points'></span>

<h3>Description</h3>

<p>The function <code>mba.points</code> returns points on a surface
approximated from a bivariate scatter of points using multilevel B-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mba.points(xyz, xy.est, n = 1, m = 1, h = 8, extend = TRUE,
           verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mba.points_+3A_xyz">xyz</code></td>
<td>
<p>a <code class="reqn">n \times 3</code> matrix or data frame, where <code class="reqn">n</code> is
the number of observed points.  The three columns correspond to point x, y, and z
coordinates.  The z value is the response at the given x, y
coordinates.  </p>
</td></tr>
<tr><td><code id="mba.points_+3A_xy.est">xy.est</code></td>
<td>
<p>a <code class="reqn">p \times 2</code> matrix or data frame, where
<code class="reqn">p</code> is the number of points for which to estimate a z.  The two
columns correspond to x, y point coordinates where a z estimate is
required. </p>
</td></tr>
<tr><td><code id="mba.points_+3A_n">n</code></td>
<td>
<p>initial size of the spline space in the hierarchical
construction along the x axis. If the rectangular domain is a
square, n = m = 1 is recommended. If the x axis is k times the length
of the y axis, n = 1, m = k is recommended. The default is n = 1. </p>
</td></tr>
<tr><td><code id="mba.points_+3A_m">m</code></td>
<td>
<p>initial size of the spline space in the hierarchical
construction along the y axis. If the y axis is k times the length
of the x axis, m = 1, n = k is recommended. The default is m = 1.  </p>
</td></tr>
<tr><td><code id="mba.points_+3A_h">h</code></td>
<td>
<p>Number of levels in the hierarchical construction. If, e.g.,
n = m = 1 and h = 8, the resulting spline surface has a coefficient
grid of size <code class="reqn">2^h</code> + 3 = 259 in each direction of the
spline surface. See references for additional information. </p>
</td></tr>
<tr><td><code id="mba.points_+3A_extend">extend</code></td>
<td>
<p>if FALSE, points in <code>xy.est</code> that fall outside of
the domain defined by <code>xyz</code> are set to NA with a warning; otherwise, the
domain is extended to accommodate points in <code>xy.est</code>
with a warning. </p>
</td></tr>
<tr><td><code id="mba.points_+3A_verbose">verbose</code></td>
<td>
<p>if TRUE, warning messages are printed to the screen. </p>
</td></tr>
<tr><td><code id="mba.points_+3A_...">...</code></td>
<td>
<p>currently no additional arguments.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with 1 component:
</p>
<table>
<tr><td><code>xyz.est</code></td>
<td>
<p>a <code class="reqn">p \times 3</code> matrix.  The first two
columns are <code>xy.est</code> and the third column is the corresponding z estimates.  </p>
</td></tr>
</table>


<h3>Note</h3>

<p>The function <code>mba.points</code> relies on the Multilevel B-spline
Approximation (MBA) algorithm.  The underlying code was developed at
SINTEF Applied Mathematics by Dr. Øyvind Hjelle. Dr. Øyvind Hjelle based the
algorithm on the paper by the originators of Multilevel B-splines:
</p>
<p>S. Lee, G. Wolberg, and S. Y. Shin. (1997) Scattered data interpolation with
multilevel B-splines. IEEE Transactions on Visualization and Computer
Graphics, 3(3):229&ndash;244.
</p>
<p>For additional documentation and references see:
</p>
<p><a href="https://www.sintef.no/upload/IKT/9011/geometri/MBA/mba_doc/index.html">https://www.sintef.no/upload/IKT/9011/geometri/MBA/mba_doc/index.html</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mba.surf">mba.surf</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LIDAR)

##split the LIDAR dataset into training and validation sets
tr &lt;- sample(1:nrow(LIDAR),trunc(0.5*nrow(LIDAR)))

##look at how smoothing changes z-approximation,
##careful the number of B-spline surface coefficients
##increases at ~2^h in each direction
for(i in 1:10){
  mba.pts &lt;- mba.points(LIDAR[tr,], LIDAR[-tr,c("x","y")], h=i)$xyz.est
  print(sum(abs(LIDAR[-tr,"z"]-mba.pts[,"z"]))/nrow(mba.pts))
}

## Not run: 
##rgl or scatterplot3d libraries can be fun
library(rgl)

##exaggerate z a bit for effect and take a smaller subset of LIDAR
LIDAR[,"z"] &lt;- 10*LIDAR[,"z"]
tr &lt;- sample(1:nrow(LIDAR),trunc(0.99*nrow(LIDAR)))

##get the "true" surface
mba.int &lt;- mba.surf(LIDAR[tr,], 100, 100, extend=TRUE)$xyz.est

open3d()
surface3d(mba.int$x, mba.int$y, mba.int$z)

##now the point estimates
mba.pts &lt;- mba.points(LIDAR[tr,], LIDAR[-tr,c("x","y")])$xyz.est
spheres3d(mba.pts[,"x"], mba.pts[,"y"], mba.pts[,"z"],
          radius=5, color="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='mba.surf'>Surface approximation from bivariate scattered data using multilevel B-splines</h2><span id='topic+mba.surf'></span>

<h3>Description</h3>

<p>The function <code>mba.surf</code> returns a surface approximated from a
bivariate scatter of data points using multilevel B-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mba.surf(xyz, no.X, no.Y, n = 1, m = 1, h = 8, extend=FALSE,
         sp=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mba.surf_+3A_xyz">xyz</code></td>
<td>
<p>a <code class="reqn">n \times 3</code> matrix or data frame, where <code class="reqn">n</code> is
the number of observed points.  The three columns correspond to point x, y, and z
coordinates.  The z value is the response at the given x, y
coordinates.  </p>
</td></tr>
<tr><td><code id="mba.surf_+3A_no.x">no.X</code></td>
<td>
<p>resolution of the approximated surface along the x axis. </p>
</td></tr>
<tr><td><code id="mba.surf_+3A_no.y">no.Y</code></td>
<td>
<p>resolution of the approximated surface along the y axis. </p>
</td></tr>
<tr><td><code id="mba.surf_+3A_n">n</code></td>
<td>
<p>initial size of the spline space in the hierarchical
construction along the x axis. If the rectangular domain is a
square, n = m = 1 is recommended. If the x axis is k times the length
of the y axis, n = 1, m = k is recommended. The default is n = 1. </p>
</td></tr>
<tr><td><code id="mba.surf_+3A_m">m</code></td>
<td>
<p>initial size of the spline space in the hierarchical
construction along the y axis. If the y axis is k times the length
of the x axis, m = 1, n = k is recommended. The default is m = 1.  </p>
</td></tr>
<tr><td><code id="mba.surf_+3A_h">h</code></td>
<td>
<p>Number of levels in the hierarchical construction. If, e.g.,
n = m = 1 and h = 8, the resulting spline surface has a coefficient
grid of size <code class="reqn">2^h</code> + 3 = 259 in each direction of the
spline surface. See references for additional information. </p>
</td></tr>
<tr><td><code id="mba.surf_+3A_extend">extend</code></td>
<td>
<p>if FALSE, a convex hull is computed for the input points
and all matrix elements in z that have centers outside of this
polygon are set to <code>NA</code>; otherwise, all elements in z are given an
estimated z value. </p>
</td></tr>
<tr><td><code id="mba.surf_+3A_sp">sp</code></td>
<td>
<p>if TRUE, the resulting surface is returned as a
<code>SpatialPixelsDataFrame</code> object; otherwise, the surface is in
<code>image</code> format.</p>
</td></tr>
<tr><td><code id="mba.surf_+3A_...">...</code></td>
<td>
<p><code>b.box</code> is an optional vector to sets the bounding
box. The vector's elements are minimum x, maximum x, minimum y, and maximum
y, respectively.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with 8 component:
</p>
<table>
<tr><td><code>xyz.est</code></td>
<td>
<p>a list that contains vectors x, y and the <code class="reqn">no.X
      \times no.Y</code> matrix z of estimated z-values. </p>
</td></tr>
<tr><td><code>no.X</code></td>
<td>
<p><code>no.X</code> from arguments.</p>
</td></tr> 
<tr><td><code>no.Y</code></td>
<td>
<p><code>no.Y</code> from arguments.</p>
</td></tr> 
<tr><td><code>n</code></td>
<td>
<p><code>n</code> from arguments.</p>
</td></tr> 
<tr><td><code>m</code></td>
<td>
<p><code>m</code> from arguments.</p>
</td></tr> 
<tr><td><code>h</code></td>
<td>
<p><code>h</code> from arguments.</p>
</td></tr> 
<tr><td><code>extend</code></td>
<td>
<p><code>extend</code> from arguments.</p>
</td></tr> 
<tr><td><code>sp</code></td>
<td>
<p><code>sp</code> from arguments.</p>
</td></tr>
<tr><td><code>b.box</code></td>
<td>
<p><code>b.box</code> defines the bounding box over which z is estimated.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If <code>no.X != no.Y</code> then use <code>sp=TRUE</code> for compatibility with
the <code>image</code> function.
</p>
<p>The function <code>mba.surf</code> relies on the Multilevel B-spline
Approximation (MBA) algorithm.  The underlying code was developed at
SINTEF Applied Mathematics by Dr. Øyvind Hjelle.  Dr. Øyvind Hjelle
based the algorithm on the paper by the originators of Multilevel B-splines:
</p>
<p>S. Lee, G. Wolberg, and S. Y. Shin. (1997) Scattered data interpolation with
multilevel B-splines. IEEE Transactions on Visualization and Computer
Graphics, 3(3):229&ndash;244.
</p>
<p>For additional documentation and references see:
</p>
<p><a href="https://www.sintef.no/upload/IKT/9011/geometri/MBA/mba_doc/index.html">https://www.sintef.no/upload/IKT/9011/geometri/MBA/mba_doc/index.html</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mba.points">mba.points</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(LIDAR)

mba.int &lt;- mba.surf(LIDAR, 300, 300, extend=TRUE)$xyz.est

##Image plot
image(mba.int, xaxs="r", yaxs="r")

##Perspective plot
persp(mba.int, theta = 135, phi = 30, col = "green3", scale = FALSE,
      ltheta = -120, shade = 0.75, expand = 10, border = NA, box = FALSE)

##For a good time I recommend using rgl
library(rgl)

ex &lt;- 10
x &lt;- mba.int[[1]]
y &lt;- mba.int[[2]]
z &lt;- ex*mba.int[[3]]
zlim &lt;- range(z)
zlen &lt;- zlim[2] - zlim[1] + 1
colorlut &lt;- heat.colors(as.integer(zlen))
col &lt;- colorlut[ z-zlim[1]+1 ]

open3d()
surface3d(x, y, z, color=col, back="lines")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
