<!DOCTYPE html><html lang="en"><head><title>Help for package sfc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sfc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#sfc-package'><p>sfc: A package for substance flow computation.</p></a></li>
<li><a href='#sfc'><p>Substance Flow Computation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Substance Flow Computation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a function sfc() to compute the substance flow
    with the input files &mdash; "data" and "model". If sample.size is
    set more than 1, uncertainty analysis will be executed while
    the distributions and parameters are supplied in the file "data".</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), dplyr, tidyr</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, triangle, zoo, sna</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ctfysh/sfc">https://github.com/ctfysh/sfc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ctfysh/sfc/issues">https://github.com/ctfysh/sfc/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-08-25 00:30:56 UTC; tiger</td>
</tr>
<tr>
<td>Author:</td>
<td>Hu Sheng [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hu Sheng &lt;shenghu@nju.edu.cn&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-08-25 10:01:01</td>
</tr>
</table>
<hr>
<h2 id='sfc-package'>sfc: A package for substance flow computation.</h2><span id='topic+sfc-package'></span>

<h3>Description</h3>

<p>The sfc package provides an important functions sfc() to compute
the substance flow with the input files &mdash; &quot;data&quot; and &quot;model&quot;.
If sample.size is set more than 1, uncertainty analysis will be
executed while the distributions and parameters are supplied in
the file &quot;data&quot;.
</p>

<hr>
<h2 id='sfc'>Substance Flow Computation</h2><span id='topic+sfc'></span>

<h3>Description</h3>

<p><code>sfc</code> is the function for computing the substance flow with
the input file &quot;data&quot; and &quot;model&quot;, and furtherly analyzing the
uncertainty of the computing results which are propagated from
the activity data and parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sfc(data, model, sample.size = 1, rand.seed = NULL, check = TRUE,
  inner = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sfc_+3A_data">data</code></td>
<td>
<p>a path for a &quot;.csv&quot; file or a data frame which contains
the basic data for substance flow computation. The details of
<code>data</code> are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="sfc_+3A_model">model</code></td>
<td>
<p>a path for a text file or a string vector which contains
the formulas for substance flow computation. The details of <code>model</code>
specification are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="sfc_+3A_sample.size">sample.size</code></td>
<td>
<p>a single value, interpreted as an integer. The
details of <code>sample.size</code> are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="sfc_+3A_rand.seed">rand.seed</code></td>
<td>
<p>a single value, interpreted as an integer or NULL,
which is the same with <code>seed</code> in <code><a href="base.html#topic+set.seed">set.seed</a></code>.</p>
</td></tr>
<tr><td><code id="sfc_+3A_check">check</code></td>
<td>
<p>logical. If FALSE, the summary of uncertainty analysis
will use all the samples. IF TRUE, they only use the valid samples.
The details of <code>check</code> are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="sfc_+3A_inner">inner</code></td>
<td>
<p>logical. IF TRUE, the intermediate results will be returnd,
such as the input samples and the results for each sample.</p>
</td></tr>
<tr><td><code id="sfc_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to both <code><a href="utils.html#topic+read.csv">read.csv</a></code>
and <code><a href="base.html#topic+scan">scan</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two important inputs in <code>sfc</code> function: <code>data</code>
and <code>model</code>. &quot;data&quot; is a table in the form of &quot;.csv&quot; which includes
a line of the header and the other lines of the specific data. The header
can be divided into two categories: special fields and general fields.
Special fields represent the fields which are meaningful for computation,
while general fields only describe each row in details which will not be
used in computation, such as the description of the concept or unit of a
variable. So general fields are not as necessary as special fields. Special
fields can also be divided into two parts: fixed fields and flexible fields.
Fixed fields contains: NAME, DATA, TIME, SITE and DIST. Flexible fields
contains: P1, P2, P3, ... and C1, C2, C3, ... NAME means the variable name.
DATA means the variable value. TIME means the specific time while SITE means
the specific place where the variable observed. DIST is a character of
distribution in <code><a href="stats.html#topic+Distributions">Distributions</a></code>, such as &quot;norm&quot;, &quot;unif&quot;, etc.
P1, P2, P3, ... are the distribution parameters which are flexible because
different distribution has different number or meaning of parameters.
C1, C2, C3, ... are supplementary fields for other distinguished information
like TIME and SITE. All the letters of field names are in the capital form
to distinguish with the normal R variables or functions.
</p>
<p>&quot;model&quot; is a special R code fragment which only contains flow computation
expressions, like &quot;PF[i, j, ] = DX * PX&quot; or &quot;PF[i, j, ] &lt;- DX * PX&quot;. Here,
&quot;i&quot; is the start node and &quot;j&quot; is the end node. &quot;DX&quot; and &quot;PX&quot; represent
activity data and parameters, respectively. They also correspond to the
&quot;NAME&quot; field in the &quot;data&quot; file. &quot;PF[i, j, ]&quot; is an array which means the
flow from &quot;i&quot; to &quot;j&quot;, while &quot;PF&quot; is the default flow name. If you do not
like coding, this package provides another alternative: to write model as
into a &quot;.csv&quot; file. This file contains four critical fields: NAME, START,
END and FUN. They are required fields while you can add other optional fields
to make the model more readable freely. The NAME field is used to define
flow label, e.g. &quot;PF_01&quot; labels &quot;PF[i, j, ]&quot;. The START and END field are
used to define the start node &quot;i&quot; and the end node &quot;j&quot; in &quot;PF[i, j, ]&quot;.
The last one, &quot;FUN&quot; is used to define the formula to calculate the flow,
such as the righthand expression &quot;DX * PX&quot;. To keep the code easy and simple,
some auxiliary functions are supplied: <code>p</code>, <code>comp0</code>, <code>suma</code>
and <code>rnone</code>. <code>p</code> is used to keep flow positive while the negative
value will be set zero. <code>comp0</code> is used to change the value near zero
to be zero. <code>suma</code> is used to sum an array at the margin <code>m</code>.
<code>rnone</code> is used to sample the same value.
</p>
<p>If <code>sample.size</code> are greater than 1, the uncertainty of substance flow
computation result, i.e. &quot;PF[i, j, ]&quot;, will be evaluated. However, we
will still compute the scenario when <code>sample.size</code> = 1, which
represent the expected scenario (or most valid scenario), to compare with
each result of each sample. If the sign of each flow are the same, the
sample are valid, otherwise are invalid. So the <code>sample.size</code> in
the result list is the valid sample size. To trigger the above comparation,
<code>check</code> should be set TRUE.
</p>


<h3>Value</h3>

<p><code>sfc</code> returns a list which contains four objects: <code>result</code>,
<code>sample.size</code>, <code>sample</code> and <code>inner.result</code>. <code>result</code>
is a data frame of substance flow computation result. <code>sample.size</code>
is the sample size of valid samples. <code>sample</code> is the data frame of
the input samples. <code>inner.result</code> is the data frame of substance flow
computation result for each sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(sfc)

## model as txt
data &lt;- system.file("extdata", "data_utf8.csv", package = "sfc")
model &lt;- system.file("extdata", "model_utf8.txt", package = "sfc")
sfc(data, model, sample.size = 100, fileEncoding = "UTF-8")

## model as csv
data &lt;- system.file("extdata", "data_utf8.csv", package = "sfc")
model &lt;- system.file("extdata", "model_utf8.csv", package = "sfc")
sfc(data, model, fileEncoding = "UTF-8")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
