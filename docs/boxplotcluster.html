<!DOCTYPE html><html><head><title>Help for package boxplotcluster</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {boxplotcluster}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boxplotcluster'><p>Boxplot Cluster Function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Clustering Method Based on Boxplot Statistics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Following Arroyo-Maté-Roque (2006), the function calculates the distance between rows or columns of the dataset using the generalized Minkowski metric as described by Ichino-Yaguchi (1994). The distance measure gives more weight to differences between quartiles than to differences between extremes, making it less sensitive to outliers. Further,the function calculates the silhouette width (Rousseeuw 1987) for different numbers of clusters and selects the number of clusters that maximizes the average silhouette width, unless a specific number of clusters is provided by the user. The approach implemented in this package is based on the following publications: Rousseeuw (1987) &lt;<a href="https://doi.org/10.1016%2F0377-0427%2887%2990125-7">doi:10.1016/0377-0427(87)90125-7</a>&gt;; Ichino-Yaguchi (1994) &lt;<a href="https://doi.org/10.1109%2F21.286391">doi:10.1109/21.286391</a>&gt;; Arroyo-Maté-Roque (2006) &lt;<a href="https://doi.org/10.1007%2F3-540-34416-0_7">doi:10.1007/3-540-34416-0_7</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cluster (&ge; 2.1.4), graphics (&ge; 4.0.0), grDevices (&ge; 4.0.0),
stats (&ge; 4.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-06 18:01:01 UTC; gianmarcoalberti</td>
</tr>
<tr>
<td>Author:</td>
<td>Gianmarco Alberti [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gianmarco Alberti &lt;gianmarcoalberti@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-06 18:30:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='boxplotcluster'>Boxplot Cluster Function</h2><span id='topic+boxplotcluster'></span>

<h3>Description</h3>

<p>The function <code>boxplotcluster</code> implements a special clustering method
based on boxplot statistics. Following Arroyo-Maté-Roque (2006), the function calculates
the distance between rows or columns of the dataset using the generalized Minkowski metric as described
by Ichino and Yaguchi (1994). The distance measure gives more weight to differences between
quartiles than to differences between extremes, making it less sensitive to outliers. Further,
the function calculates the silhouette width for different numbers of clusters (Rousseeuw 1987)
and selects the number of clusters that maximizes the average silhouette width
(unless a specific number of clusters is provided by the user).<br />
Visit this <a href="https://drive.google.com/file/d/1Qb9r8amiSa1OMmCx3ngpeXAGT7kebInq/view?usp=share_link">LINK</a> to access the package's vignette.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxplotcluster(
  x,
  target.var = NULL,
  group.var = NULL,
  calc.type = "columns",
  aggl.meth = "ward.D2",
  part = NULL,
  silh.col = TRUE,
  cex.dndr.lab = 0.75,
  cex.sil.lab = 0.75,
  oneplot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxplotcluster_+3A_x">x</code></td>
<td>
<p>A dataframe representing the input dataset (see below and the <code>Details</code> section).</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_target.var">target.var</code></td>
<td>
<p>A character vector specifying the name of the numerical variable in the input dataset that
will be used for analysis. If the input dataset is in <code>wide</code> format, this can be left as default (<code>NULL</code>). If the dataset is
in <code>long</code> format, this parameter has to indicate the variable containing the data values that will
be grouped by the different levels of the variable fed via the <code>group.var</code> parameter.</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_group.var">group.var</code></td>
<td>
<p>A character vector specifying the grouping variable. It can be left as default (<code>NULL</code>) if the
input dataset is in <code>wide</code> format.</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_calc.type">calc.type</code></td>
<td>
<p>A string specifying the units to be clustered if the input dataset is in wide format (either <code>columns</code> or <code>rows</code>; the former is the default).</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_aggl.meth">aggl.meth</code></td>
<td>
<p>A string specifying the agglomeration method to be used in hierarchical
clustering. Defaults to &quot;ward.D2&quot;. For other methods see <code><a href="stats.html#topic+hclust">hclust</a></code>.</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_part">part</code></td>
<td>
<p>An optional integer specifying the desired number of clusters. If not provided,
the function selects the number of clusters that maximises the average silhouette width.</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_silh.col">silh.col</code></td>
<td>
<p>A logical value, which takes <code>TRUE</code> (default) or <code>FALSE</code> if the user wants to give colour to the
silhouette plot reflecting the cluster partition.</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_cex.dndr.lab">cex.dndr.lab</code></td>
<td>
<p>A numeric specifying the character expansion factor for the labels in the
dendrogram plot. Defaults to 0.75.</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_cex.sil.lab">cex.sil.lab</code></td>
<td>
<p>A numeric specifying the character expansion factor for the labels in the
silhouette plot. Defaults to 0.75.</p>
</td></tr>
<tr><td><code id="boxplotcluster_+3A_oneplot">oneplot</code></td>
<td>
<p>A logical value, which takes <code>TRUE</code> (default) or <code>FALSE</code> if the user wants or does not want the plots to be visualised
in a single window.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first calculates the pairwise distance between each unit of the input dataset
using the Ichino-Yaguchi dissimilarity measure (equations 7 and 8 in Arroyo-Maté-Roque (2006)).
The distance between A and B is defined as:<br />
</p>
<p><code class="reqn">(0.5 * (abs(m1 - m2) + 2 * abs(q1 - q2) + 2 * abs(Me1 - Me2) + 2 * abs(Q1 - Q2) + abs(M1 - M2))) /4</code><br />
</p>
<p>where<br />
</p>
<p>m1 &lt;- min(A)<br />
m2 &lt;- min(B)<br />
q1 &lt;- quantile(A, probs = 0.25)<br />
q2 &lt;- quantile(B, probs = 0.25)<br />
Q1 &lt;- quantile(A, probs = 0.75)<br />
Q2 &lt;- quantile(B, probs = 0.75)<br />
M1 &lt;- max(A)<br />
M2 &lt;- max(B)<br />
Me1 &lt;- median(A)<br />
Me2 &lt;- median(B)<br />
</p>
<p>The distance matrix is then used to perform a hierarchical clustering. Also, the function calculates the
silhouette width for different numbers of clusters and selects the number of clusters
that maximises the average silhouette width (unless a specific number of clusters is provided by the user).<br />
</p>
<p>The silhouette method allows to measure how 'good' is the selected cluster solution. If the parameter <code>part</code>
is left empty (default), an optimal cluster solution is obtained. The optimal partition is selected via an iterative
procedure which identifies at which cluster solution the highest average silhouette width is achieved.
If a user-defined partition is needed, the user can input the desired number of clusters using the parameter <code>part</code>.
In either case, an additional plot is returned besides the cluster dendrogram and the silhouette plot; it displays a
scatterplot in which the cluster solution (x-axis) is plotted against the average silhouette width (y-axis).
A black dot represents the partition selected either by the iterative procedure or by the user.<br />
</p>
<p>In summary, the function generates a series of plots to visualise the results:<br />
</p>
<p>(a) boxplots colored by cluster membership,<br />
(b) a dendrogram (where clusters are indicated by rectangles whose color is consistent with the color assigned to the
boxplot in the previous plot),<br />
(c) a silhouette plot (with optional by-cluster colours), and<br />
(d) a plot of the average silhouette width vs. the number of clusters.<br />
</p>
<p>The silhouette plot is obtained via the <code>silhouette()</code> function out from the <code>cluster</code> package.
For a detailed description of the silhouette plot, its rationale, and its interpretation, see Rousseeuw 1987.
</p>
<p>Input dataset format:<br />
When the dataset is in <code>wide</code> format, each row corresponds to a distinct unit, and each column corresponds
to a different variable. In this format, it is typically assumed that all units have the same number of observations.
The element representing the units (either rows or columns) will be clustered.<br />
</p>
<p>When the dataset is in <code>long</code> format, it consists of rows representing individual observations. One column indicates
the variable name (grouping variable) and another column contains the measurements values, or viceversa. If the input dataset
comes in this format, the units to be clustered are created by grouping the observations (i.e., rows of the
dataframe) by <code>group.var</code>. If the input dataset is in <code>long</code> format, groups can feature a different number of observations.<br />
</p>
<p>For actual examples of both formats, see the <code>Examples</code> section below.
</p>


<h3>Value</h3>

<p>The function returns a list storing the following components
</p>

<ul>
<li><p><code>distance.matrix:</code> distance matrix reporting the distance values.
</p>
</li>
<li><p><code>units.by.cluster:</code> a list of the input dataset's units, grouped by cluster membership.
</p>
</li>
<li><p><code>avr.silh.width.by.n.of.clusters:</code> average silhouette width by number of clusters.
</p>
</li>
<li><p><code>partition.silh.data:</code> silhouette data for the selected partition.
</p>
</li></ul>



<h3>References</h3>

<p>Arroyo, J., Maté, C., &amp; Roque, A. M-S. (2006). Hierarchical Clustering for Boxplot Variables.
In Studies in Classification, Data Analysis, and Knowledge Organization (pp. 59–66).
Springer Berlin Heidelberg.
</p>
<p>Ichino, M., &amp; Yaguchi, H. (1994). Generalized Minkowski Metrics for Mixed
Feature-Type Data Analysis. IEEE Transactions on Systems, Man, and Cybernetics, 24(4), 698-708.
</p>
<p>Rousseeuw, P J. (1987). Silhouettes: A graphical aid to the interpretation and validation of cluster analysis,
Journal of Computational and Applied Mathematics 20, 53-65.
</p>


<h3>See Also</h3>

<p><code><a href="cluster.html#topic+silhouette">silhouette</a></code>, <code><a href="stats.html#topic+hclust">hclust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## EXAMPLE 1

# Create a toy dataset in WIDE format
df &lt;- data.frame(
a = rnorm(30, mean = 30, sd = 5),
b = rnorm(30, mean = 40, sd = 5),
c = rnorm(30, mean = 20, sd = 5),
d = rnorm(30, mean = 25, sd = 5),
e = rnorm(30, mean = 50, sd = 5),
f = rnorm(30, mean = 10, sd = 5),
g = rnorm(30, mean = 100, sd = 5),
h = rnorm(30, mean = 20, sd = 5),
i = rnorm(30, mean = 40, sd = 5),
l = rnorm(30, mean = 35, sd = 5),
m = rnorm(30, mean = 35, sd = 5),
n = rnorm(30, mean = 70, sd = 5),
o = rnorm(30, mean = 20, sd = 5),
p = rnorm(30, mean = 70, sd = 5),
q = rnorm(30, mean = 90, sd = 5)
)

# Run the function
result &lt;- boxplotcluster(df)

# Same as above, but selecting a 4-cluster solution
result &lt;- boxplotcluster(df, part=4)

# Same as above, but the rows are clustered
result &lt;- boxplotcluster(df, calc.type="rows", part=4)



## EXAMPLE 2
# Create a toy dataset in WIDE format, representing archaeological stone
# flake length (cm) by raw material

df &lt;- data.frame(
Basalt = c(7.0, 7.0, 7.7, 8.2, 10.3, 10.3, 10.3, 10.8, 11.0, 13.0, 13.9, 14.6, 1.0),
Chert = c(2.9, 4.8, 5.3, 5.8, 5.8, 6.2, 6.5, 7.7, 7.7, 7.9, 8.9, 9.6, 2.0),
Obsidian = c(2.2, 2.4, 3.1, 4.3, 5.0, 5.5, 5.8, 6.0, 6.2, 7.2, 7.4, 7.7, 2.0),
Quartzite = c(5.5, 5.5, 7.0, 7.4, 7.7, 7.9, 8.6, 8.9, 9.4, 9.6, 10.6, 10.8, 1.0),
Granite = c(4.0, 4.5, 6.0, 6.8, 7.0, 7.8, 8.1, 8.4, 9.0, 10.0, 10.5, 11.0, 1.0),
Sandstone = c(3.0, 3.2, 4.0, 4.5, 4.9, 5.2, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 1.0),
Limestone = c(3.5, 4.0, 4.8, 5.2, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 1.5),
Slate = c(2.0, 2.4, 3.0, 3.6, 4.0, 4.4, 5.0, 5.6, 6.0, 6.4, 7.0, 7.6, 1.2)
)

# Run the function to cluster the columns (default); cluster solution is
# selected by the iterative method (default)

result &lt;- boxplotcluster(df)



## EXAMPLE 3
#  Create a toy dataset in LONG format

n_units &lt;- 20
n_groups &lt;- 10
measurements_per_group &lt;- 4

long_data &lt;- data.frame(
SubjectID = rep(paste0("Unit", 1:n_units), each = n_groups * measurements_per_group),
Grouping_var = rep(rep(paste0("M", 1:n_groups), each = measurements_per_group), n_units),
Value = runif(n_units * n_groups * measurements_per_group))

#  Run the analysis, specifying the target variable and the grouping variable,
# and selecting a 3-cluster solution
result &lt;- boxplotcluster(long_data, target.var = "Value", group.var = "Grouping_var", part=3)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
