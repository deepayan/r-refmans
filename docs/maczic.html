<!DOCTYPE html><html><head><title>Help for package maczic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {maczic}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#maczic'><p>maczic: Mediation Analysis for Count and Zero-inflated Count Data.</p></a></li>
<li><a href='#maczic_power'><p>Power Calculation for Mediation Analysis with Count and Zero-Inflated</p>
Count Data</a></li>
<li><a href='#mediate_iv'><p>Mediation Analysis for Count and Zero-Inflated Count Data Using Instrumental</p>
Variable Method</a></li>
<li><a href='#mediate_zi'><p>Mediation Analysis for Count and Zero-Inflated Count Data</p></a></li>
<li><a href='#mediate_zi_vcoef'><p>Mediation Sensitivity Analysis for Count and Zero-Inflated Count Data with</p>
a Post-Treatment Confounder</a></li>
<li><a href='#midvd_bt100'><p>Example Data for mediate_zi_vcoef, plot_sensitivity and mediate_iv Functions</p></a></li>
<li><a href='#plot_sensitivity'><p>Plot Sensitivity Graph</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mediation Analysis for Count and Zero-Inflated Count Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Nancy Cheng, Zijian Guo, Jing Cheng</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nancy Cheng &lt;Nancy.Cheng@ucsf.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), MASS, pscl, graphics</td>
</tr>
<tr>
<td>Imports:</td>
<td>sandwich, survival, stats, mediation, emplik, BB, mathjaxr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>SuppDists</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>mathjaxr</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs causal mediation analysis for count and zero-inflated
    count data without or with a post-treatment confounder; calculates power
    to detect prespecified causal mediation effects, direct effects, and 
    total effects; performs sensitivity analysis when there is a treatment-
    induced mediator-outcome confounder as described by Cheng, J., Cheng, N.F., 
    Guo, Z., Gregorich, S., Ismail, A.I., Gansky, S.A. (2018) 
    &lt;<a href="https://doi.org/10.1177%2F0962280216686131">doi:10.1177/0962280216686131</a>&gt;. Implements Instrumental Variable (IV) 
    method to estimate the controlled (natural) direct and mediation effects, 
    and compute the bootstrap Confidence Intervals as described by Guo, Z., 
    Small, D.S., Gansky, S.A., Cheng, J. (2018) &lt;<a href="https://doi.org/10.1111%2Frssc.12233">doi:10.1111/rssc.12233</a>&gt;. This 
    software was made possible by Grant R03DE028410 from the National 
    Institute of Dental and Craniofacial Research, a component of the National 
    Institutes of Health.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-11 19:40:54 UTC; NCheng</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-11 21:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='maczic'>maczic: Mediation Analysis for Count and Zero-inflated Count Data.</h2><span id='topic+maczic'></span><span id='topic+maczic-package'></span>

<h3>Description</h3>

<p>Performs causal mediation analysis for count and zero-inflated count data;
calculates power of causal mediation effects, direct effects, total effects;
implements Instrumental Variable (IV) method to estimate the controlled
(natural) direct and mediation effect, and the bootstrap CIs; calculates
power of controlled (natural) direct and mediation effect using IV method;
performs sensitivity analysis when there is a treatment-induced
mediator-outcome confounder by varing coefficient of treatment in the
confounder model and plots sensitivity graph.
</p>

<hr>
<h2 id='maczic_power'>Power Calculation for Mediation Analysis with Count and Zero-Inflated
Count Data</h2><span id='topic+maczic_power'></span>

<h3>Description</h3>

<p>'maczic_power' computes powers to detect average causal mediation effects
(indirect effect), average direct effects, and total effect. This function
uses simulations of 3 optional covariates (binary, normal, and
multinomial), mediator (can be binary or continuous), and outcome (can be
Normal, Poisson, Negative Binomial, zero-inflated Poisson/Negative Binomial)
based on user-specified parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maczic_power(
  nsim,
  nsp,
  mtype,
  boot = FALSE,
  sims = 1000,
  conf.level = 0.95,
  ydist,
  size = 1,
  ymax,
  lpct0 = 0,
  hpct0 = 100,
  px1,
  am,
  bm,
  e1m,
  e2m,
  e3m,
  ag,
  bg,
  gg,
  e1g,
  e2g,
  e3g,
  delta = 0,
  ag2 = 0,
  bg2 = 0,
  gg2 = 0,
  e1g2 = 0,
  e2g2 = 0,
  e3g2 = 0,
  delta2 = 0,
  digits = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maczic_power_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_nsp">nsp</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_mtype">mtype</code></td>
<td>
<p>Type of mediator, either 'binary' or 'continuous'.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_boot">boot</code></td>
<td>
<p>A logical value. if 'FALSE' a quasi-Bayesian approximation is
used for confidence intervals; if 'TRUE' nonparametric bootstrap will be
used. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_sims">sims</code></td>
<td>
<p>Number of Monte Carlo draws for nonparametric bootstrap or
quasi-Bayesian approximation. Default is 1000.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of the returned two-sided confidence intervals.
The default value, 0.95, is to return the 2.5 and 97.5 percentiles of the
simulated quantities.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_ydist">ydist</code></td>
<td>
<p>Outcome distribution. Can be 'poisson', 'negbin', 'zip', 'zinb',
or 'normal'.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_size">size</code></td>
<td>
<p>Dispersion parameter for negative binomial outcome distribution.
Default is 1. It's ignored for other outcome distribution.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_ymax">ymax</code></td>
<td>
<p>Maximum value of outcome allowed.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_lpct0">lpct0</code></td>
<td>
<p>Low bound for percent of zeros in outcome. Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_hpct0">hpct0</code></td>
<td>
<p>High bound for percent of zeros in outcome. Default is 100.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_px1">px1</code></td>
<td>
<p>Probability of the binary covariate being 1.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_am">am</code></td>
<td>
<p>User-specified value for the intercept in the mediator model.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_bm">bm</code></td>
<td>
<p>User-specified value for the treatment coefficient in the mediator
model.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e1m">e1m</code></td>
<td>
<p>User-specified value for the coefficient of the binary covariate
variable in the mediator model.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e2m">e2m</code></td>
<td>
<p>User-specified value for the coefficient of the continuous
covariate variable in the mediator model.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e3m">e3m</code></td>
<td>
<p>User-specified value for the coefficient of the multinomial
covariate variable in the mediator model.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_ag">ag</code></td>
<td>
<p>User-specified value for the intercept in the outcome model or in
the count model of zero-inflated Poisson/Negative Binomial outcome.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_bg">bg</code></td>
<td>
<p>User-specified value for the treatment coefficient in the outcome
model or in the count model of zero-inflated Poisson/Negative Binomial
outcome.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_gg">gg</code></td>
<td>
<p>User-specified value for the mediator coefficient in the outcome
model or in the count model of zero-inflated Poisson/Negative Binomial
outcome.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e1g">e1g</code></td>
<td>
<p>User-specified value for the coefficient of the binary covariate
variable in the outcome model or in the count model of zero-inflated
Poisson/Negative Binomial outcome.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e2g">e2g</code></td>
<td>
<p>User-specified value for the coefficient of the continuous
covariate variable in the outcome model or in the count model of
zero-inflated Poisson/Negative Binomial outcome.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e3g">e3g</code></td>
<td>
<p>User-specified value for the coefficient of the multinomial
covariate variable in the outcome model or in the count model of
zero-inflated Poisson/Negative Binomial outcome.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_delta">delta</code></td>
<td>
<p>User-specified value for the treatment-by-mediator interaction
coefficient in the outcome model or in the count model of zero-inflated
Poisson/Negative Binomial outcome model. Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_ag2">ag2</code></td>
<td>
<p>User-specified value for the intercept in the zero-inflation
model of zero-inflated Poisson/Negative Binomial outcome. Note that this
argument along with the following argument bg2, gg2, e1g2, e2g2, e3g2 and
delta2 only apply to zero-inflated Poisson/Negative Binomial outcome.
Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_bg2">bg2</code></td>
<td>
<p>User-specified value for the treatment coefficient in the
zero-inflation model of zero-inflated Poisson/Negative Binomial outcome.
Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_gg2">gg2</code></td>
<td>
<p>User-specified value for the mediator coefficient in the
zero-inflation model of zero-inflated Poisson/Negative Binomial outcome.
Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e1g2">e1g2</code></td>
<td>
<p>User-specified value for the coefficient of the binary covariate
variable in the zero-inflation model of zero-inflated Poisson/Negative
Binomial outcome. Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e2g2">e2g2</code></td>
<td>
<p>User-specified value for the coefficient of the continuous
covariate variable in the zero-inflation model of zero-inflated
Poisson/Negative Binomial outcome. Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_e3g2">e3g2</code></td>
<td>
<p>User-specified value for the coefficient of the multinomial
covariate variable in the zero-inflation model of zero-inflated
Poisson/Negative Binomial outcome. Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_delta2">delta2</code></td>
<td>
<p>User-specified value for the coefficient of
treatment-by-mediator interaction in the zero-inflation model of
zero-inflated Poisson/Negative Binomial outcome. Default is 0.</p>
</td></tr>
<tr><td><code id="maczic_power_+3A_digits">digits</code></td>
<td>
<p>Integer indicating the number of decimal places to round
the values to be returned. Default is 3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>maczic_power</code> returns a data frame with the following
components and prints them out in a matrix format:
</p>
<table>
<tr><td><code>te.d0</code>, <code>te.d1</code></td>
<td>
<p>average true mediation effects under the control and
treatment conditions.</p>
</td></tr>
<tr><td><code>te.z0</code>, <code>te.z1</code></td>
<td>
<p>average true direct effects under the control and
treatment conditions.</p>
</td></tr>
<tr><td><code>te.tau</code></td>
<td>
<p>average true total effect.</p>
</td></tr>
<tr><td><code>ee.d0.rej</code>, <code>ee.d1.rej</code></td>
<td>
<p>power to detect mediation effects under the
control and treatment conditions.</p>
</td></tr>
<tr><td><code>ee.z0.rej</code>, <code>ee.z1.rej</code></td>
<td>
<p>power to detect direct effects under the
control and treatment conditions.</p>
</td></tr>
<tr><td><code>ee.tau.rej</code></td>
<td>
<p>power to detect total effect.</p>
</td></tr>
<tr><td><code>mean.y.z0</code></td>
<td>
<p>mean outcome in control in the simulated data, not
available if outcome is normal.</p>
</td></tr>
<tr><td><code>mean.y.z1</code></td>
<td>
<p>mean outcome in treatment in the simulated data, not
available if outcome is normal.</p>
</td></tr>
<tr><td><code>mean.y.gt0.z0</code></td>
<td>
<p>mean non-zero outcome in control in the simulated
data, not available if outcome is normal.</p>
</td></tr>
<tr><td><code>mean.y.gt0.z1</code></td>
<td>
<p>mean non-zero outcome in treatment in the simulated
data, not available if outcome is normal</p>
</td></tr>
<tr><td><code>pct0.y.z0</code></td>
<td>
<p>mean percent zero outcome in control in the simulated
data, not available if outcome is normal.</p>
</td></tr>
<tr><td><code>pct0.y.z1</code></td>
<td>
<p>mean percent zero outcome in treatment in the simulated
data, not available if outcome is normal.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nancy Cheng,
<a href="mailto:Nancy.Cheng@ucsf.edu">Nancy.Cheng@ucsf.edu</a>; Jing Cheng,
<a href="mailto:Jing.Cheng@ucsf.edu">Jing.Cheng@ucsf.edu</a>.
</p>


<h3>References</h3>

<p>Cheng, J., Cheng, N.F., Guo, Z., Gregorich, S., Ismail, A.I.,
Gansky, S.A (2018) Mediation analysis for count and zero-inflated count
data. Statistical Methods in Medical Research. 27(9):2756-2774.
</p>
<p>Tingley, D., Yamamoto, T., Hirose, K., Imai, K. and Keele, L.
(2014). &quot;mediation: R package for Causal Mediation Analysis&quot;, Journal of
Statistical Software, Vol. 59, No. 5, pp. 1-38.
</p>
<p>Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2011). Unpacking the
Black Box of Causality: Learning about Causal Mechanisms from Experimental
and Observational Studies, American Political Science Review, Vol. 105, No.
4 (November), pp. 765-789.
</p>
<p>Imai, K., Keele, L. and Tingley, D. (2010) A General Approach to Causal
Mediation Analysis, Psychological Methods, Vol. 15, No. 4 (December), pp.
309-334.
</p>
<p>Imai, K., Keele, L. and Yamamoto, T. (2010) Identification, Inference, and
Sensitivity Analysis for Causal Mediation Effects, Statistical Science,
Vol. 25, No. 1 (February), pp. 51-71.
</p>
<p>Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2009) &quot;Causal Mediation
Analysis Using R&quot; in Advances in Social Science Research Using R, ed. H. D.
Vinod New York: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mediate_zi">mediate_zi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For illustration purposes a small number of simulations are used
# Example 1: simulate Poisson outcome with sample size 100, binary mediator
# and 2 covariate (binary and normal) variables
posOut &lt;- maczic_power(nsim = 8, nsp = 100,  mtype = 'binary',
                       sims = 40, ydist = "Poisson", ymax = 60,
                       px1 = 0.5, am = 0.2, bm = 0.5,
                       e1m = 0.1, e2m = 0.1, e3m = 0,
                       ag = 0.1, bg = 0.3, gg = 1,
                       e1g = 0.5, e2g = -0.2, e3g = 0, delta = 0.1)

# Example 2: simulate zero-inflated Poisson outcome with sample size 80,
# continuous mediator and 1 normal covariate variable
zipOut &lt;-maczic_power(nsim = 5, nsp = 80, mtype = 'continuous',
                       sims=30, ydist = "zip", ymax = 88, hpct0 = 60,
                       px1 = 0.5, am = 0.1, bm = 1,
                       e1m = 0, e2m = 0.2, e3m = 0,
                       ag = 0.6, bg = 0.6, gg = 0.2, e1g = 0, e2g = -0.2,
                       e3g = 0, ag2 = -0.7, bg2 = 0.2, gg2 = 0.1,
                       e2g2 = 0.1, delta2 = 0.15)

</code></pre>

<hr>
<h2 id='mediate_iv'>Mediation Analysis for Count and Zero-Inflated Count Data Using Instrumental
Variable Method</h2><span id='topic+mediate_iv'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> 'mediate_iv' is used to estimate controlled or natural
direct effect ratio, indirect (mediation) effect ratio for count and
zero-inflated count data using Instrumental Variable (IV) method
described in Guo, Z., Small, D.S., Gansky, S.A., Cheng, J. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mediate_iv(
  y,
  z,
  m,
  zm.int = FALSE,
  ydist = "poisson",
  mtype = "binary",
  x.IV,
  x.nonIV = NULL,
  tol = 1e-05,
  n.init = 3,
  control = list(),
  conf.level = 0.95,
  sims = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mediate_iv_+3A_y">y</code></td>
<td>
<p>Outcome variable.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_z">z</code></td>
<td>
<p>Treatment variable.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_m">m</code></td>
<td>
<p>Mediator variable.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_zm.int">zm.int</code></td>
<td>
<p>A logical value. if 'FALSE' the interaction of treatment
by mediator will not be included in the outcome model; if 'TRUE' the interaction
will be included in the outcome model. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_ydist">ydist</code></td>
<td>
<p>A character string indicating outcome distribution which will
be used to fit for getting the initial parameter estimates. Can only take
one of the these three values - 'poisson', 'negbin', or 'neyman type a'
Default is 'poisson'. Use 'neyman type a' for zero-inflated outcomes.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_mtype">mtype</code></td>
<td>
<p>A character string indicating mediator type, either 'binary'
or 'continuous'. Default is 'binary'.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_x.iv">x.IV</code></td>
<td>
<p>Specifies baseline variable(s) to construct Instrumental Variable(s),
Use <code>cbind()</code> for 2 or more IVs.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_x.noniv">x.nonIV</code></td>
<td>
<p>Specifies baseline variable(s) that are not used to construct
Instrumental Variable(s) as covariates. Use <code>cbind()</code> for 2 or more non
IVs. Default is NULL.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_tol">tol</code></td>
<td>
<p>Numeric tolerance value for parameter convergence. When the square
root of sum of squared difference between two consecutive set of optimized
parameters less than <code>tol</code>, then the convergence is reached.
Default is 1e-5.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_n.init">n.init</code></td>
<td>
<p>Number of set of initial parameter values. Default is 3.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_control">control</code></td>
<td>
<p>A list of parameters governing the nonlinear optimization
algorithm behavior (to minimize the profile empirical log-likelihood).
This list is the same as that for <code>BBoptim()</code>, which is a wrapper
for <code>spg()</code>. <code>control</code> default is
<code>list(maxit = 1500, M = c(50, 10), ftol=1e-10, gtol = 1e-05,
 maxfeval = 10000, maximize = FALSE, trace = FALSE, triter = 10,
 eps = 1e-07, checkGrad=NULL)</code>.  See <code>spg</code> for more details.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of the returned two-sided bootstrap confidence
intervals. The default value, 0.95, is to return the 2.5 and 97.5
percentiles of the simulated quantities.</p>
</td></tr>
<tr><td><code id="mediate_iv_+3A_sims">sims</code></td>
<td>
<p>Number of Monte Carlo draws for nonparametric bootstrap.
Default is 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'mediate_iv' is to estimate the controlled and natural direct and
indirect ratios of randomized treatment around and through mediators when
there is unmeasured confounding. This function considers count and
zero-inflated count outcomes, and binary and continuous mediators. The
estimation uses an instrumental variable approach with empirical
likelihood and estimating equations, where no parametric assumption is
needed for the outcome distribution.
</p>
<p><em>Controlled effect ratio</em>
</p>
<p>Given the generalized linear model for the expected potential outcomes:
\[f[E(Y(z,m)|x,u)] = \beta_0 + \beta_zz + \beta_mm + \beta_xx + u,\]
where \(f\) is a log-link function, \(\beta_0\) is the intercept,
\(z\) is the treatment, \(m\) is pre-specified mediator value, \(x\)
are baseline covariates, \(\beta_z\), \(\beta_m\), \(\beta_x\) are
their corresponding coefficients, \(u\) are unmeasured confounders and
\(Y(z,m)\) is the potential outcome under treatment \(z\) and mediator
\(m\).
Then the controlled direct effect ratio when the treatment changes from
\(z^\ast\) to \(z\) while keeping the mediator at \(m\):
</p>
\[\frac{E[Y(z,m)|x,u]}{E[Y(z^\ast,m)|x,u]} = \exp[\beta_z(z-z^\ast)]\]
<p>and the controlled indirect effect ratio when the mediator changes from
\(m^\ast\) to \(m\) while keeping the treatment at \(z\):
\[\frac{E[Y(z,m)|x,u]}{E[Y(z,m^\ast)|x,u]} = \exp[\beta_m(m-m^\ast)]\]
</p>
<p><em>Natural effect ratio</em>
</p>
<p>Given a generalized linear model for the expected potential outcomes and
a model for the mediator:
\[f[E(Y(z,M^{z^\ast}|x,u))] = \beta_0 + \beta_zz + \beta_mM^{z^\ast} + \beta_xx
   + u,\]
where \(f\) is a log-link function, \(M^{z^\ast}\) is the potential
mediator under treatment \(z^\ast\), and \(Y(z,M^{z^\ast})\) is
the potential outcome under treatment \(z\) and potential mediator
\(M^{z^\ast}\)
\[h[E(M^{z^\ast}|x,u)] = \alpha_0 + \alpha_zz^\ast + \alpha_xx +
  \alpha_{IV}z^\ast x^{IV} + u,\]
where \(h\) is an identity function for continuous mediators and logit
function for binary mediators; \(\alpha_{IV}\) is the coefficient for
instrumental variables \(x^{IV}\), \(z^\ast x^{IV}\), interaction of randomized
treatment and instrumental variables, and \(M^z\) is the potential mediator
under treatment \(z^\ast\).
Then the natural direct effect ratio is:
\[\frac{E[Y(z,M^{z^\ast})|x,u]}{E[Y(z^\ast,M^{z^\ast}|x,u]} = \exp[\beta_z(z-z^\ast)].\]
And the natural indirect effect ratio with a continuous mediator is:
\[\frac{E[Y(z,M^z)|x,u]}{E[Y(z,M^{z^\ast})|x,u]} = \exp[\beta_m\alpha_z(z-z^\ast)
 + \beta_m\alpha_{IV}x^{IV}(z-z^\ast)].\]
The natural indirect effect ratio with a binary mediator is:
\[\frac{E[Y(z,M^z)|x,u]}{E[Y(z,M^{z^\ast})|x,u]}
  = \frac{P(M^z = 1|x,u)\exp(\beta_m) + P(M^z = 0|x, u)}
  {P(M^{z^\ast} = 1|x,u) \exp(\beta_m) + P(M^{z^\ast} = 0|x, u)}. \]
</p>
<p>The parameters are estimated by the maximized empirical likelihood
estimates, which are solutions to the estimating equations that maximizes
the empirical likelihood. See details in Guo, Z., Small, D.S., Gansky,
S.A., Cheng, J. (2018).
</p>


<h3>Value</h3>

<p><code>mediate_iv</code> returns a list with the following components and
prints them out in a matrix format:
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>parameter estimates from optimized profile empirical
log-likelihood.</p>
</td></tr>
<tr><td><code>ter</code>, <code>ter.ci</code></td>
<td>
<p>point estimate for total effect ratio
and its bootstrap confidence interval.</p>
</td></tr>
</table>
<p>If the interaction between treatment and mediator is not specified, ie,
zm.int=FALSE, a list of additional components are:
</p>
<table>
<tr><td><code>der</code>, <code>der.ci</code></td>
<td>
<p>point estimate for controlled direct effect ratio and
its bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>der.nat</code>, <code>der.nat.ci</code></td>
<td>
<p>point estimate for natural direct effect
ratio and its bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>ier</code>, <code>ier.ci</code></td>
<td>
<p>point estimate for controlled indirect effect ratio
and its bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>ier.nat</code>, <code>ier.nat.ci</code></td>
<td>
<p>point estimate for natural indirect effect ratio
and its bootstrap confidence interval; They are only applicable to
continuous mediator.</p>
</td></tr>
</table>
<p>If the interaction between treatment and mediator is specified, ie,
zm.int=TRUE, which is only supported for binary mediator, a list of
additional components are:
</p>
<table>
<tr><td><code>der.m0</code>, <code>der.m0.ci</code></td>
<td>
<p>point estimate for controlled direct effect ratio
when m = 0 and its bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>der.m1</code>, <code>der.m1.ci</code></td>
<td>
<p>point estimate for controlled direct effect ratio
when m = 1 and its bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>der.nat.m0</code>, <code>der.nat.m0.ci</code></td>
<td>
<p>point estimate for natural direct effect
ratio when m = 0 and its bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>der.nat.m1</code>, <code>der.nat.m1.ci</code></td>
<td>
<p>point estimate for natural direct effect
ratio when m = 1 and its bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>ier.z0</code>, <code>ier.z0.ci</code></td>
<td>
<p>point estimate for controlled indirect effect
ratio when z = 0 and its bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>ier.z1</code>, <code>ier.z1.ci</code></td>
<td>
<p>point estimate for controlled indirect effect
ratio when z = 1 and its bootstrap confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nancy Cheng,
<a href="mailto:Nancy.Cheng@ucsf.edu">Nancy.Cheng@ucsf.edu</a>; Zijian Guo,
<a href="mailto:zijguo@stat.rutgers.edu">zijguo@stat.rutgers.edu</a>; Jing Cheng,
<a href="mailto:Jing.Cheng@ucsf.edu">Jing.Cheng@ucsf.edu</a>.
</p>


<h3>References</h3>

<p>Guo, Z., Small, D.S., Gansky, S.A., Cheng, J. (2018), Mediation analysis
for count and zero-inflated count data without sequential ignorability
and its application in dental studies. Journal of the Royal Statistical
Society, Series C.; 67(2):371-394.
</p>
<p>Ismail AI, Ondersma S, Willem Jedele JM, et al. (2011) Evaluation of
a brief tailored motivational intervention to prevent early childhood
caries.
Community Dentistry and Oral Epidemiology 39: 433–448.
</p>


<h3>See Also</h3>

<p><code><a href="emplik.html#topic+el.test">el.test</a></code>, <code><a href="BB.html#topic+BBoptim">BBoptim</a></code>, <code><a href="BB.html#topic+spg">spg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For illustration purposes a small number of bootstrap iterations are used
data("midvd_bt100")
# The outcome is Poisson distribution
ee &lt;- mediate_iv(y = midvd_bt100$Untreated_W3,
                 z = midvd_bt100$intervention,
                 m = midvd_bt100$PBrush_6, ydist = "poisson",
                 mtype = "binary", x.IV = midvd_bt100$BrushTimes_W2,
                 tol = 0.5, n.init = 1,
                 control = list(maxit = 15, ftol = 0.5, gtol = 0.5,
                                trace = FALSE),
                 sims = 3)

</code></pre>

<hr>
<h2 id='mediate_zi'>Mediation Analysis for Count and Zero-Inflated Count Data</h2><span id='topic+mediate_zi'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> 'mediate_zi' is modified from the <code>mediate</code> function in
<code>mediation</code> package (version 4.0.1) with the new feature
added to handle Zero-inflated count outcomes including Zero-inflated
Poisson and Zero-inflated Negative Binomial outcomes. This function is used
to estimate various quantities for causal mediation analysis, including
average causal mediation effects  (ACME) or indirect effect, average direct
effects (ADE), proportions mediated, and total effect. The Usage, Argument,
Value, and Details of this function are the same as <code>mediate()</code> in
<code>mediation</code> package version 4.0.1 (see below) except for the description
of the 'model.y' argument, which has class 'zeroinfl' added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mediate_zi(
  model.m,
  model.y,
  sims = 1000,
  boot = FALSE,
  treat = "treat.name",
  mediator = "med.name",
  covariates = NULL,
  outcome = NULL,
  control = NULL,
  conf.level = 0.95,
  control.value = 0,
  treat.value = 1,
  long = TRUE,
  dropobs = FALSE,
  robustSE = FALSE,
  cluster = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mediate_zi_+3A_model.m">model.m</code></td>
<td>
<p>A fitted model object for mediator.  Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'rq', or 'survreg'.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_model.y">model.y</code></td>
<td>
<p>A fitted model object for outcome.  Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'vglm', 'rq', 'survreg',
or 'zeroinfl'</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_sims">sims</code></td>
<td>
<p>Number of Monte Carlo draws for nonparametric bootstrap or
quasi-Bayesian approximation.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_boot">boot</code></td>
<td>
<p>A logical value. if 'FALSE' a quasi-Bayesian approximation is
used for confidence intervals; if 'TRUE' nonparametric bootstrap will be
used. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_treat">treat</code></td>
<td>
<p>A character string indicating the name of the treatment variable
used in the models.  The treatment can be either binary (integer or a
two-valued factor) or continuous (numeric).</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_mediator">mediator</code></td>
<td>
<p>A character string indicating the name of the mediator
variable used in the models.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_covariates">covariates</code></td>
<td>
<p>A list or data frame containing values for a subset of the
pre-treatment covariates in 'model.m' and 'model.y'. If provided, the
function will return the estimates conditional on those covariate values.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_outcome">outcome</code></td>
<td>
<p>A character string indicating the name of the outcome variable
in &lsquo;model.y&rsquo;. Only necessary if 'model.y' is of class 'survreg'; otherwise
ignored.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_control">control</code></td>
<td>
<p>A character string indicating the name of the control group
indicator. Only relevant if 'model.y' is of class 'gam'. If provided, 'd0',
'z0' and 'n0' are allowed to differ from 'd1', 'z1' and 'n1', respectively.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of the returned two-sided confidence intervals.
Default is to return the 2.5 and 97.5 percentiles of the simulated
quantities.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_control.value">control.value</code></td>
<td>
<p>Value of the treatment variable used as the control
condition. Default is 0.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_treat.value">treat.value</code></td>
<td>
<p>Value of the treatment variable used as the treatment
condition. Default is 1.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_long">long</code></td>
<td>
<p>A logical value. If 'TRUE', the output will contain the entire
sets of simulation draws of the the average causal mediation effects,
direct effects, proportions mediated, and total effect. Default is 'TRUE'.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_dropobs">dropobs</code></td>
<td>
<p>A logical value indicating the behavior when the model frames
of 'model.m' and 'model.y' (and the 'cluster' variable if included) are
composed of different observations. If 'TRUE', models will be re-fitted
using common data rows. If 'FALSE', error is returned. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_robustse">robustSE</code></td>
<td>
<p>A logical value. If 'TRUE', heteroskedasticity-consistent
standard errors will be used in quasi-Bayesian simulations. Ignored if
'boot' is 'TRUE' or neither 'model.m' nor 'model.y' has a method for
<code>vcovHC</code> in the <code>sandwich</code> package. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_cluster">cluster</code></td>
<td>
<p>A variable indicating clusters for standard errors. Note that
this should be a vector of cluster indicators itself, not a character
string for the name of the variable.</p>
</td></tr>
<tr><td><code id="mediate_zi_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>vcovHC</code> in the <code>sandwich</code>
package: typically the 'type' argument, which is ignored if 'robustSE' is
'FALSE'. Arguments to the <code>boot</code> in the <code>boot</code> package may also
be passed, e.g. 'parallel' and 'ncpus'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the workhorse function for estimating causal mediation
effects for a variety of data types. The average causal mediation effect
(ACME) represents the expected difference in the potential outcome when the
mediator took the value that would realize under the treatment condition as
opposed to the control condition, while the treatment status itself is held
constant. That is,
\[\delta(t) \ = \ E[Y(t, M(t_1)) - Y(t, M(t_0))],\]
where \(t, t_1, t_0\) are particular values of the treatment
\(T\) such that \(t_1 \neq t_0\), \(M(t)\) is the potential
mediator, and \(Y(t,m)\) is the potential outcome variable. The average
direct effect (ADE) is defined similarly as,
\[\zeta(t) \ = \ E[Y(t_1, M(t)) - Y(t_0, M(t))],\]
which represents the expected difference in the potential outcome when the
treatment is changed but the mediator is held constant at the value that
would realize if the treatment equals \(t\). The two quantities on
average add up to the total effect of the treatment on the outcome,
\(\tau\). See the references for more details.
</p>
<p>When both the mediator model ('model.m') and outcome model ('model.y') are
normal linear regressions, the results will be identical to the usual LSEM
method by Baron and Kenny (1986).  The function can, however, accommodate
other data types including binary, ordered and count outcomes and mediators
as well as censored outcomes.  Variables can also be modeled
nonparametrically, semiparametrically, or using quantile regression.
</p>
<p>If it is desired that inference be made conditional on specific values of
the pre-treatment covariates included in the model, the &lsquo;covariates&rsquo;
argument can be used to set those values as a list or data frame. The list
may contain either the entire set or any strict subset of the covariates in
the model; in the latter case, the effects will be averaged over the other
covariates. The &lsquo;covariates&rsquo; argument will be particularly useful when the
models contain interactions between the covariates and the treatment and/or
mediator (known as &ldquo;moderated mediation&rdquo;).
</p>
<p>The prior weights in the mediator and outcome models are taken as sampling
weights and the estimated effects will be weighted averages when non-NULL
weights are used in fitting 'model.m' and 'model.y'. This will be useful
when data does not come from a simple random sample, for example.
</p>
<p>As of version 4.0, the mediator model can be of either 'lm', 'glm' (or
&lsquo;bayesglm&rsquo;), 'polr' (or &lsquo;bayespolr&rsquo;), 'gam', 'rq', or &lsquo;survreg&rsquo; class
corresponding respectively to the linear regression models,
generalized linear models, ordered response models, generalized additive
models, quantile regression models, or parametric duration models. For
binary response models, the 'mediator' must be a
numeric variable with values 0 or 1 as opposed to a factor.
Quasi-likelihood-based inferences are not allowed for the mediator model
because the functional form must be exactly specified for the estimation
algorithm to work.  The 'binomial' family can only be used for binary
response mediators and cannot be used for multiple-trial responses.  This
is due to conflicts between how the latter type of models are implemented
in <code><a href="stats.html#topic+glm">glm</a></code> and how 'mediate' is currently written.
</p>
<p>For the outcome model, the censored regression model fitted via package
<code>VGAM</code> (of class 'vglm' with 'family@vfamily' equal to &quot;tobit&quot;) can be
used in addition to the models listed above for the mediator.  The
'mediate' function is not compatible with censored regression models fitted
via other packages.  When the quantile regression is used for the outcome
model ('rq'), the estimated quantities are quantile causal mediation
effects, quantile direct effects and etc., instead of the average effects.
If the outcome model is of class 'survreg', the name of the outcome
variable must be explicitly supplied in the &lsquo;outcome&rsquo; argument. This is due
to the fact that 'survreg' objects do not contain that information in an
easily extractable form. It should also be noted that for
<code><a href="survival.html#topic+survreg">survreg</a></code> models, the <code><a href="survival.html#topic+Surv">Surv</a></code> function must be
directly used in the model formula in the call to the survreg function, and
that censoring types requiring more than two arguments to Surv (e.g.,
interval censoring) are not currently supported by 'mediate'.
</p>
<p>The quasi-Bayesian approximation (King et al. 2000) cannot be used if
'model.m' is of class 'rq' or 'gam', or if 'model.y' is of class 'gam',
'polr' or 'bayespolr'. In these cases, either an error message is returned
or use of the nonparametric bootstrap is forced. Users should note that use
of the nonparametric bootstrap often requires significant computing time,
especially when 'sims' is set to a large value.
</p>
<p>The 'control' argument must be provided when 'gam' is used for the outcome
model and user wants to allow ACME and ADE to vary as functions of the
treatment (i.e., to relax the &quot;no interaction&quot; assumption). Note that the
outcome model must be fitted via package <code><a href="mgcv.html#topic+mgcv">mgcv</a></code> with
appropriate formula using <code><a href="mgcv.html#topic+s">s</a></code> constructs (see Imai et al. 2009
in the references). For other model types, the interaction can be allowed
by including an interaction term between <i>T</i> and <i>M</i> in the linear
predictor of the outcome model. As of version 3.0, the 'INT' argument is
deprecated and the existence of the interaction term is automatically
detected (except for 'gam' outcome models).
</p>
<p>When the treatment variable is continuous or a factor with multiple levels,
user must specify the values of \(t_1\) and \(t_0\) using the
'treat.value' and 'control.value' arguments, respectively.  The value of
\(t\) in the above expressions is set to \(t_0\) for 'd0', 'z0',
etc. and to \(t_1\) for 'd1', 'z1', etc.
</p>


<h3>Value</h3>

<p><code>mediate</code> returns an object of class &quot;<code>mediate</code>&quot;, (or
&quot;<code>mediate.order</code>&quot; if the outcome model used is 'polr' or 'bayespolr'),
a list that contains the components listed below.  Some of these elements
are not available if 'long' is set to 'FALSE' by the user.
</p>
<p>The function <code>summary</code> (i.e., <code>summary.mediate</code>,
or <code>summary.mediate.order</code>) can be used to obtain a table of the
results.  The function <code>plot</code> (i.e., <code>plot.mediate</code>, or
<code>plot.mediate.order</code>) can be used to produce a plot of the estimated
average causal mediation, average direct, and total effects along with
their confidence intervals.
</p>
<table>
<tr><td><code>d0</code>, <code>d1</code></td>
<td>
<p>point estimates for average causal mediation effects under
the control and treatment conditions.</p>
</td></tr>
<tr><td><code>d0.ci</code>, <code>d1.ci</code></td>
<td>
<p>confidence intervals for average causal mediation
effects. The confidence level is set at the value specified in
'conf.level'.</p>
</td></tr>
<tr><td><code>d0.p</code>, <code>d1.p</code></td>
<td>
<p>two-sided p-values for average causal mediation effects.</p>
</td></tr>
<tr><td><code>d0.sims</code>, <code>d1.sims</code></td>
<td>
<p>vectors of length 'sims' containing simulation
draws of average causal mediation effects.</p>
</td></tr>
<tr><td><code>z0</code>, <code>z1</code></td>
<td>
<p>point estimates for average direct effect under the control
and treatment conditions.</p>
</td></tr>
<tr><td><code>z0.ci</code>, <code>z1.ci</code></td>
<td>
<p>confidence intervals for average direct effects.</p>
</td></tr>
<tr><td><code>z0.p</code>, <code>z1.p</code></td>
<td>
<p>two-sided p-values for average causal direct effects.</p>
</td></tr>
<tr><td><code>z0.sims</code>, <code>z1.sims</code></td>
<td>
<p>vectors of length 'sims' containing simulation
draws of average direct effects.</p>
</td></tr>
<tr><td><code>n0</code>, <code>n1</code></td>
<td>
<p>the &quot;proportions mediated&quot;, or the size of the average causal
mediation effects relative to the total effect.</p>
</td></tr>
<tr><td><code>n0.ci</code>, <code>n1.ci</code></td>
<td>
<p>confidence intervals for the proportions mediated.</p>
</td></tr>
<tr><td><code>n0.p</code>, <code>n1.p</code></td>
<td>
<p>two-sided p-values for proportions mediated.</p>
</td></tr>
<tr><td><code>n0.sims</code>, <code>n1.sims</code></td>
<td>
<p>vectors of length 'sims' containing simulation
draws of the proportions mediated.</p>
</td></tr>
<tr><td><code>tau.coef</code></td>
<td>
<p>point estimate for total effect.</p>
</td></tr>
<tr><td><code>tau.ci</code></td>
<td>
<p>confidence interval for total effect.</p>
</td></tr>
<tr><td><code>tau.p</code></td>
<td>
<p>two-sided p-values for total effect.</p>
</td></tr>
<tr><td><code>tau.sims</code></td>
<td>
<p>a vector of length 'sims' containing simulation draws of
the total effect.</p>
</td></tr>
<tr><td><code>d.avg</code>, <code>z.avg</code>, <code>n.avg</code></td>
<td>
<p>simple averages of d0 and d1, z0 and z1, n0 and
n1, respectively, which users may want to use as summary values when those
quantities differ.</p>
</td></tr>
<tr><td><code>d.avg.ci</code>, <code>z.avg.ci</code>, <code>n.avg.ci</code></td>
<td>
<p>confidence intervals for the above.</p>
</td></tr>
<tr><td><code>d.avg.p</code>, <code>z.avg.p</code>, <code>n.avg.p</code></td>
<td>
<p>two-sided p-values for the above.</p>
</td></tr>
<tr><td><code>d.avg.sims</code>, <code>z.avg.sims</code>, <code>n.avg.sims</code></td>
<td>
<p>vectors of length 'sims'
containing simulation draws of d.avg, z.avg and n.avg, respectively.</p>
</td></tr>
<tr><td><code>boot</code></td>
<td>
<p>logical, the 'boot' argument used. If 'FALSE' a quasi-Bayesian
approximation was used for confidence intervals; if 'TRUE' nonparametric
bootstrap was used</p>
</td></tr>
<tr><td><code>boot.ci.type</code></td>
<td>
<p>a character string 'perc' indicating percentile
bootstrap confidence intervals were estimated if the argument boot = TRUE</p>
</td></tr>
<tr><td><code>treat</code></td>
<td>
<p>a character string indicating the name of the 'treat' variable
used in the models</p>
</td></tr>
<tr><td><code>mediator</code></td>
<td>
<p>a character string indicating the name of the 'mediator'
variable used in the models</p>
</td></tr>
<tr><td><code>INT</code></td>
<td>
<p>a logical value indicating whether the model specification
allows the effects to differ between the treatment and control conditions.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>the confidence level used. </p>
</td></tr>
<tr><td><code>model.y</code></td>
<td>
<p>the outcome model used.</p>
</td></tr>
<tr><td><code>model.m</code></td>
<td>
<p>the mediator model used.</p>
</td></tr>
<tr><td><code>control.value</code></td>
<td>
<p>value of the treatment variable used as the control
condition.</p>
</td></tr>
<tr><td><code>treat.value</code></td>
<td>
<p>value of the treatment variable used as the treatment
condition.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>number of observations in the model frame for 'model.m' and
'model.y'. May differ from the numbers in the original models input to
'mediate' if 'dropobs' was 'TRUE'.</p>
</td></tr>
<tr><td><code>robustSE</code></td>
<td>
<p>&lsquo;TRUE&rsquo; or &lsquo;FALSE&rsquo;.</p>
</td></tr>
<tr><td><code>cluster</code></td>
<td>
<p>the clusters used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nancy Cheng,
<a href="mailto:Nancy.Cheng@ucsf.edu">Nancy.Cheng@ucsf.edu</a>; Jing Cheng,
<a href="mailto:Jing.Cheng@ucsf.edu">Jing.Cheng@ucsf.edu</a>.
</p>


<h3>References</h3>

<p>Cheng, J., Cheng, N.F., Guo, Z., Gregorich, S., Ismail, A.I.,
Gansky, S.A (2018) Mediation analysis for count and zero-inflated count
data. Statistical Methods in Medical Research. 27(9):2756-2774.
</p>
<p>Tingley, D., Yamamoto, T., Hirose, K., Imai, K. and Keele, L.
(2014). &quot;mediation: R package for Causal Mediation Analysis&quot;, Journal of
Statistical Software, Vol. 59, No. 5, pp. 1-38.
</p>
<p>Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2011). Unpacking the
Black Box of Causality: Learning about Causal Mechanisms from Experimental
and Observational Studies, American Political Science Review, Vol. 105, No.
4 (November), pp. 765-789.
</p>
<p>Imai, K., Keele, L. and Tingley, D. (2010) A General Approach to Causal
Mediation Analysis, Psychological Methods, Vol. 15, No. 4 (December), pp.
309-334.
</p>
<p>Imai, K., Keele, L. and Yamamoto, T. (2010) Identification, Inference, and
Sensitivity Analysis for Causal Mediation Effects, Statistical Science,
Vol. 25, No. 1 (February), pp. 51-71.
</p>
<p>Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2009) &quot;Causal Mediation
Analysis Using R&quot; in Advances in Social Science Research Using R, ed. H. D.
Vinod New York: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="mediation.html#topic+summary.mediate">summary.mediate</a></code>, <code><a href="mediation.html#topic+plot.mediate">plot.mediate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For illustration purposes a small number of simulations are used
# Example: Zero-inflated Count Outcome and Binary Mediator
# Generate example data
n &lt;- 50
# Generate binary treatment variable
z &lt;- rep(0, n)
z[sample(1:n, n/2)] &lt;- 1
# Generate binary covariate variable
x1 &lt;- rbinom(n, 1, p = 0.5)
# Generate continuous covariate variable
x2 &lt;- rnorm(n)
# Create binary mediator
m &lt;- c(1, 1, 0, 1, 1, 1, 1, 0, 1, 1,
       0, 1, 1, 1, 1, 0, 1, 0, 1, 0,
       1, 1, 0, 1, 0, 1, 1, 1, 1, 0,
       1, 1, 0, 1, 0, 1, 1, 0, 1, 1,
       0, 1, 1, 0, 0, 1, 1, 1, 0, 1)
# Create Zero-inflated Count Outcome
y &lt;- c(0, 7, 0, 0, 8, 0, 7, 3, 5, 0,
       5, 0, 0, 1, 10,0, 3, 4, 5, 7,
       9, 7, 0, 6, 2, 4, 0, 0, 0, 6,
       0, 11,0, 5, 6, 0, 0, 12,0, 0,
       13,6, 8, 6, 5, 0, 4, 0, 6, 8)
sdata &lt;- data.frame(z, x1, x2, m, y)
mFit &lt;- glm(m ~ z + x1 + x2, data = sdata, family = binomial)
# Fit with Zero-inflated Poisson model
yzipFit &lt;- zeroinfl(y ~ z + m + x1 + x2, data = sdata)
# Estimation via Quasi-Bayesian approximation
zipMA &lt;- mediate_zi(mFit, yzipFit, sims = 100, treat = "z", mediator = "m")
summary(zipMA)
# Estimation via bootstrap approximation
zipMA_bt &lt;- mediate_zi(mFit, yzipFit, sims = 100, boot = TRUE, treat = "z",
mediator = "m")
summary(zipMA_bt)

</code></pre>

<hr>
<h2 id='mediate_zi_vcoef'>Mediation Sensitivity Analysis for Count and Zero-Inflated Count Data with
a Post-Treatment Confounder</h2><span id='topic+mediate_zi_vcoef'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> 'mediate_zi_vcoef' is modified from <code>mediate_zi</code> function with 3
confounder-related parameters ('model.u', 'delta.beta.u', and 'confounder')
added. It is used to estimate causal mediation effects when there is a
treatment-induced mediator-outcome confounder, and the coefficient of treatment
in the confounder model is specified by users. Users can perform sensitivity
analysis with a range of specified coefficient values when there is a
post-treatment confounder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mediate_zi_vcoef(
  model.u,
  delta.beta.u,
  model.m,
  model.y,
  sims = 1000,
  boot = FALSE,
  treat = "treat.name",
  mediator = "med.name",
  confounder = "confd.name",
  covariates = NULL,
  outcome = NULL,
  control = NULL,
  conf.level = 0.95,
  control.value = 0,
  treat.value = 1,
  long = TRUE,
  dropobs = FALSE,
  robustSE = FALSE,
  cluster = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mediate_zi_vcoef_+3A_model.u">model.u</code></td>
<td>
<p>A fitted model object for confounder. Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'rq', or 'survreg'.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_delta.beta.u">delta.beta.u</code></td>
<td>
<p>Sensitivity parameter as difference from the estimated
treatment coefficient in the confounder model (model.u) based on the
observed data.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_model.m">model.m</code></td>
<td>
<p>A fitted model object for mediator.  Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'rq', or 'survreg'.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_model.y">model.y</code></td>
<td>
<p>A fitted model object for outcome.  Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'vglm', 'rq', 'survreg',
or 'zeroinfl'</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_sims">sims</code></td>
<td>
<p>Number of Monte Carlo draws for nonparametric bootstrap or
quasi-Bayesian approximation.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_boot">boot</code></td>
<td>
<p>A logical value. if 'FALSE' a quasi-Bayesian approximation is
used for confidence intervals; if 'TRUE' nonparametric bootstrap will be
used. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_treat">treat</code></td>
<td>
<p>A character string indicating the name of the treatment variable
used in the models.  The treatment can be either binary (integer or a
two-valued factor) or continuous (numeric).</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_mediator">mediator</code></td>
<td>
<p>A character string indicating the name of the mediator
variable used in the models.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_confounder">confounder</code></td>
<td>
<p>A character string indicating the name of the confounder
variable used in the models.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_covariates">covariates</code></td>
<td>
<p>A list or data frame containing values for a subset of the
pre-treatment covariates in 'model.m' and 'model.y'. If provided, the
function will return the estimates conditional on those covariate values.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_outcome">outcome</code></td>
<td>
<p>A character string indicating the name of the outcome variable
in &lsquo;model.y&rsquo;. Only necessary if 'model.y' is of class 'survreg'; otherwise
ignored.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_control">control</code></td>
<td>
<p>A character string indicating the name of the control group
indicator. Only relevant if 'model.y' is of class 'gam'. If provided, 'd0',
'z0' and 'n0' are allowed to differ from 'd1', 'z1' and 'n1', respectively.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of the returned two-sided confidence intervals.
Default is to return the 2.5 and 97.5 percentiles of the simulated
quantities.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_control.value">control.value</code></td>
<td>
<p>Value of the treatment variable used as the control
condition. Default is 0.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_treat.value">treat.value</code></td>
<td>
<p>Value of the treatment variable used as the treatment
condition. Default is 1.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_long">long</code></td>
<td>
<p>A logical value. If 'TRUE', the output will contain the entire
sets of simulation draws of the the average causal mediation effects,
direct effects, proportions mediated, and total effect. Default is 'TRUE'.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_dropobs">dropobs</code></td>
<td>
<p>A logical value indicating the behavior when the model frames
of 'model.m' and 'model.y' (and the 'cluster' variable if included) are
composed of different observations. If 'TRUE', models will be re-fitted
using common data rows. If 'FALSE', error is returned. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_robustse">robustSE</code></td>
<td>
<p>A logical value. If 'TRUE', heteroskedasticity-consistent
standard errors will be used in quasi-Bayesian simulations. Ignored if
'boot' is 'TRUE' or neither 'model.m' nor 'model.y' has a method for
<code>vcovHC</code> in the <code>sandwich</code> package. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_cluster">cluster</code></td>
<td>
<p>A variable indicating clusters for standard errors. Note that
this should be a vector of cluster indicators itself, not a character
string for the name of the variable.</p>
</td></tr>
<tr><td><code id="mediate_zi_vcoef_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>vcovHC</code> in the <code>sandwich</code>
package: typically the 'type' argument, which is ignored if 'robustSE' is
'FALSE'. Arguments to the <code>boot</code> in the <code>boot</code> package may also
be passed, e.g. 'parallel' and 'ncpus'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mediate_zi_vcoef</code> returns an object of class &quot;<code>mediate</code>&quot;, (or
&quot;<code>mediate.order</code>&quot; if the outcome model used is 'polr' or 'bayespolr'),
a list that contains the components listed below.  Some of these elements
are not available if 'long' is set to 'FALSE' by the user.
</p>
<p>The function <code>summary</code> (i.e., <code>summary.mediate</code>,
or <code>summary.mediate.order</code>) can be used to obtain a table of the
results.  The function <code>plot</code> (i.e., <code>plot.mediate</code>, or
<code>plot.mediate.order</code>) can be used to produce a plot of the estimated
average causal mediation, average direct, and total effects along with
their confidence intervals.
</p>
<table>
<tr><td><code>d0</code>, <code>d1</code></td>
<td>
<p>point estimates for average causal mediation effects under
the control and treatment conditions.</p>
</td></tr>
<tr><td><code>d0.ci</code>, <code>d1.ci</code></td>
<td>
<p>confidence intervals for average causal mediation
effects. The confidence level is set at the value specified in
'conf.level'.</p>
</td></tr>
<tr><td><code>d0.p</code>, <code>d1.p</code></td>
<td>
<p>two-sided p-values for average causal mediation effects.</p>
</td></tr>
<tr><td><code>d0.sims</code>, <code>d1.sims</code></td>
<td>
<p>vectors of length 'sims' containing simulation
draws of average causal mediation effects.</p>
</td></tr>
<tr><td><code>z0</code>, <code>z1</code></td>
<td>
<p>point estimates for average direct effect under the control
and treatment conditions.</p>
</td></tr>
<tr><td><code>z0.ci</code>, <code>z1.ci</code></td>
<td>
<p>confidence intervals for average direct effects.</p>
</td></tr>
<tr><td><code>z0.p</code>, <code>z1.p</code></td>
<td>
<p>two-sided p-values for average causal direct effects.</p>
</td></tr>
<tr><td><code>z0.sims</code>, <code>z1.sims</code></td>
<td>
<p>vectors of length 'sims' containing simulation
draws of average direct effects.</p>
</td></tr>
<tr><td><code>n0</code>, <code>n1</code></td>
<td>
<p>the &quot;proportions mediated&quot;, or the size of the average causal
mediation effects relative to the total effect.</p>
</td></tr>
<tr><td><code>n0.ci</code>, <code>n1.ci</code></td>
<td>
<p>confidence intervals for the proportions mediated.</p>
</td></tr>
<tr><td><code>n0.p</code>, <code>n1.p</code></td>
<td>
<p>two-sided p-values for proportions mediated.</p>
</td></tr>
<tr><td><code>n0.sims</code>, <code>n1.sims</code></td>
<td>
<p>vectors of length 'sims' containing simulation
draws of the proportions mediated.</p>
</td></tr>
<tr><td><code>tau.coef</code></td>
<td>
<p>point estimate for total effect.</p>
</td></tr>
<tr><td><code>tau.ci</code></td>
<td>
<p>confidence interval for total effect.</p>
</td></tr>
<tr><td><code>tau.p</code></td>
<td>
<p>two-sided p-values for total effect.</p>
</td></tr>
<tr><td><code>tau.sims</code></td>
<td>
<p>a vector of length 'sims' containing simulation draws of
the total effect.</p>
</td></tr>
<tr><td><code>d.avg</code>, <code>z.avg</code>, <code>n.avg</code></td>
<td>
<p>simple averages of d0 and d1, z0 and z1, n0 and
n1, respectively, which users may want to use as summary values when those
quantities differ.</p>
</td></tr>
<tr><td><code>d.avg.ci</code>, <code>z.avg.ci</code>, <code>n.avg.ci</code></td>
<td>
<p>confidence intervals for the above.</p>
</td></tr>
<tr><td><code>d.avg.p</code>, <code>z.avg.p</code>, <code>n.avg.p</code></td>
<td>
<p>two-sided p-values for the above.</p>
</td></tr>
<tr><td><code>d.avg.sims</code>, <code>z.avg.sims</code>, <code>n.avg.sims</code></td>
<td>
<p>vectors of length 'sims'
containing simulation draws of d.avg, z.avg and n.avg, respectively.</p>
</td></tr>
<tr><td><code>boot</code></td>
<td>
<p>logical, the 'boot' argument used. If 'FALSE' a quasi-Bayesian
approximation was used for confidence intervals; if 'TRUE' nonparametric
bootstrap was used</p>
</td></tr>
<tr><td><code>boot.ci.type</code></td>
<td>
<p>a character string 'perc' indicating percentile
bootstrap confidence intervals were estimated if the argument boot = TRUE</p>
</td></tr>
<tr><td><code>treat</code></td>
<td>
<p>a character string indicating the name of the 'treat' variable
used in the models.</p>
</td></tr>
<tr><td><code>mediator</code></td>
<td>
<p>a character string indicating the name of the 'mediator'
variable used in the models.</p>
</td></tr>
<tr><td><code>INT</code></td>
<td>
<p>a logical value indicating whether the model specification
allows the effects to differ between the treatment and control conditions.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>the confidence level used. </p>
</td></tr>
<tr><td><code>model.y</code></td>
<td>
<p>the outcome model used.</p>
</td></tr>
<tr><td><code>model.m</code></td>
<td>
<p>the mediator model used.</p>
</td></tr>
<tr><td><code>control.value</code></td>
<td>
<p>value of the treatment variable used as the control
condition.</p>
</td></tr>
<tr><td><code>treat.value</code></td>
<td>
<p>value of the treatment variable used as the treatment
condition.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>number of observations in the model frame for 'model.m' and
'model.y'. May differ from the numbers in the original models input to
'mediate' if 'dropobs' was 'TRUE'.</p>
</td></tr>
<tr><td><code>robustSE</code></td>
<td>
<p>&lsquo;TRUE&rsquo; or &lsquo;FALSE&rsquo;.</p>
</td></tr>
<tr><td><code>cluster</code></td>
<td>
<p>the clusters used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nancy Cheng,
<a href="mailto:Nancy.Cheng@ucsf.edu">Nancy.Cheng@ucsf.edu</a>; Jing Cheng,
<a href="mailto:Jing.Cheng@ucsf.edu">Jing.Cheng@ucsf.edu</a>.
</p>


<h3>References</h3>

<p>Cheng, J., Cheng, N.F., Guo, Z., Gregorich, S., Ismail, A.I.,
Gansky, S.A (2018) Mediation analysis for count and zero-inflated count
data. Statistical Methods in Medical Research. 27(9):2756-2774.
</p>
<p>Ismail AI, Ondersma S, Willem Jedele JM, et al. (2011) Evaluation of
a brief tailored motivational intervention to prevent early childhood caries.
Community Dentistry and Oral Epidemiology 39: 433–448.
</p>
<p>Tingley, D., Yamamoto, T., Hirose, K., Imai, K. and Keele, L.
(2014). &quot;mediation: R package for Causal Mediation Analysis&quot;, Journal of
Statistical Software, Vol. 59, No. 5, pp. 1-38.
</p>
<p>Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2011). Unpacking the
Black Box of Causality: Learning about Causal Mechanisms from Experimental
and Observational Studies, American Political Science Review, Vol. 105, No.
4 (November), pp. 765-789.
</p>
<p>Imai, K., Keele, L. and Tingley, D. (2010) A General Approach to Causal
Mediation Analysis, Psychological Methods, Vol. 15, No. 4 (December), pp.
309-334.
</p>
<p>Imai, K., Keele, L. and Yamamoto, T. (2010) Identification, Inference, and
Sensitivity Analysis for Causal Mediation Effects, Statistical Science,
Vol. 25, No. 1 (February), pp. 51-71.
</p>
<p>Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2009) &quot;Causal Mediation
Analysis Using R&quot; in Advances in Social Science Research Using R, ed. H. D.
Vinod New York: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_sensitivity">plot_sensitivity</a></code>, <code><a href="#topic+mediate_zi">mediate_zi</a></code>,
<code><a href="mediation.html#topic+summary.mediate">summary.mediate</a></code>, <code><a href="mediation.html#topic+plot.mediate">plot.mediate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("midvd_bt100")
uFit &lt;- glm (PDVisit_6 ~ intervention + BrushTimes_W2 + HealthyMeals_W2
                         + PDVisit_W2,
             family = 'binomial', data = midvd_bt100)
mFit &lt;- glm (PBrushBedt_6 ~ intervention + BrushTimes_W2 + HealthyMeals_W2
                            + PBrush_W2 + PDVisit_6,
             family = 'binomial', data = midvd_bt100)
yFit &lt;- zeroinfl(Untreated_W3 ~ intervention + PBrushBedt_6 + BrushTimes_W2
                                + HealthyMeals_W2 + PBrush_W2+ PDVisit_6,
                 data = midvd_bt100)
# For illustration purposes a small number of simulations are used
# Estimation via Quasi-Bayesian approximation
ee &lt;-mediate_zi_vcoef(uFit, delta.beta.u = 0.01, mFit, yFit, sims = 100,
                      treat = "intervention", mediator = "PBrushBedt_6",
                      confounder ="PDVisit_6")
summary(ee)

</code></pre>

<hr>
<h2 id='midvd_bt100'>Example Data for mediate_zi_vcoef, plot_sensitivity and mediate_iv Functions</h2><span id='topic+midvd_bt100'></span>

<h3>Description</h3>

<p>A bootstrap random subsample of the DDHP MI-DVD trial data used in Cheng, J.,
Cheng, N.F., Guo, Z., Gregorich, S., Ismail, A.I., Gansky, S.A. (2018).
In the trial, the enrolled families were examined at Wave 1 (randomization),
wave 2 (dental examination and study started, considered as baseline),
6-month follow up, and end of the study (wave 3, 2-year). This bootstrap
subsample data contain 100 rows and 9 columns with no missing values.
The data are provided only for illustrative purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>midvd_bt100
</code></pre>


<h3>Format</h3>

<p>A data frame containing the following variables:
</p>

<dl>
<dt>BrushTimes_W2:</dt><dd><p> Number of times child brushed per day in a typical
week measured at wave 2 (baseline).</p>
</dd>
<dt>HealthyMeals_W2:</dt><dd><p> A binary variable indicating whether caregivers
gave child healthy meals measured at wave 2 (baseline) (1=Yes, 0=No).</p>
</dd>
<dt>PBrush_W2:</dt><dd><p> A binary variable indicating whether caregivers made
sure child brushed 2 times per day measured at wave 2 (baseline) (1=Yes,
0=No).</p>
</dd>
<dt>PDVisit_W2:</dt><dd><p> A binary variable indicating whether caregiver makes
sure child sees dentists every 6 mos measured at wave 2 (baseline) (1=Yes,
0=No).</p>
</dd>
<dt>PDVisit_6:</dt><dd><p> A binary variable indicating whether caregiver makes
sure child sees dentists every 6 mos measured at 6-month follow up (1=Yes,
0=No).</p>
</dd>
<dt>PBrushBedt_6:</dt><dd><p> A binary variable indicating whether caregivers made
sure child brushes teeth at bedtime measured at 6-month follow up (1=Yes,
0=No).</p>
</dd>
<dt>PBrush_6:</dt><dd><p> A binary variable indicating whether caregivers made
sure child brushed 2 times per day measured at 6-month follow up (1=Yes,
0=No).</p>
</dd>
<dt>intervention:</dt><dd><p> A binary treatment variable (1=intervention
0=Control).</p>
</dd>
<dt>Untreated_W3:</dt><dd><p> The number of new untreated lesions measured at end
of the 2-year study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ismail AI, Ondersma S, Willem Jedele JM, et al. (2011) Evaluation of
a brief tailored motivational intervention to prevent early childhood caries.
Community Dentistry and Oral Epidemiology 39: 433–448.
</p>
<p>Cheng, J., Cheng, N.F., Guo, Z., Gregorich, S., Ismail, A.I.,
Gansky, S.A. (2018) Mediation analysis for count and zero-inflated count
data. Statistical Methods in Medical Research. 27(9):2756-2774.
</p>

<hr>
<h2 id='plot_sensitivity'>Plot Sensitivity Graph</h2><span id='topic+plot_sensitivity'></span>

<h3>Description</h3>

<p>'plot_sensitivity' performs sensitivity analysis when there is a treatment-
induced mediator-outcome confounder by varying coefficient of treatment in
the confounder model and plots sensitivity graph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sensitivity(
  model.u,
  n.beta.u = 10,
  model.m,
  model.y,
  sims = 1000,
  boot = FALSE,
  confounder = "confd.name",
  treat = "treat.name",
  mediator = "med.name",
  covariates = NULL,
  outcome = NULL,
  digits = 3,
  xlab = "Beta.u",
  ylab = "Effect",
  xlim = NULL,
  ylim = NULL,
  main = NULL,
  type = "l",
  col = c("black", "black", "black"),
  pch = NULL,
  lty = c(1, 2, 3),
  legend.x,
  legend.y = NULL,
  legend.inset = 0.05,
  legend = c("Direct Effect", "Mediation Effect", "Total Effect"),
  legend.horiz = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_sensitivity_+3A_model.u">model.u</code></td>
<td>
<p>A fitted model object for confounder. Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'rq', or 'survreg'.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_n.beta.u">n.beta.u</code></td>
<td>
<p>Number of varying coefficient of treatment in the confounder
model. This number is adjusted as n.beta.u + 1 if n.beta.u is an even
number.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_model.m">model.m</code></td>
<td>
<p>A fitted model object for mediator. Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'rq', or 'survreg'.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_model.y">model.y</code></td>
<td>
<p>A fitted model object for outcome. Can be of class 'lm',
'polr', 'bayespolr', 'glm', 'bayesglm', 'gam', 'vglm', 'rq', 'survreg',
or 'zeroinfl'.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_sims">sims</code></td>
<td>
<p>Number of Monte Carlo draws for quasi-Bayesian approximation.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_boot">boot</code></td>
<td>
<p>A logical value. if 'FALSE' a quasi-Bayesian approximation is
used for confidence intervals; if 'TRUE' nonparametric bootstrap will be
used. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_confounder">confounder</code></td>
<td>
<p>A character string indicating the name of the confounder
variable used in the models.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_treat">treat</code></td>
<td>
<p>A character string indicating the name of the treatment
variable used in the models.  The treatment can be either binary (integer
or a two-valued factor) or continuous (numeric).</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_mediator">mediator</code></td>
<td>
<p>A character string indicating the name of the mediator
variable used in the models.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_covariates">covariates</code></td>
<td>
<p>A list or data frame containing values for a subset of the
pre-treatment covariates in 'model.m' and 'model.y'. If provided, the
function will return the estimates conditional on those covariate values.
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_outcome">outcome</code></td>
<td>
<p>A character string indicating the name of the outcome
variable in &lsquo;model.y&rsquo;. Only necessary if 'model.y' is of class 'survreg';
otherwise ignored.Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_digits">digits</code></td>
<td>
<p>integer indicating the number of decimal places to round
the values to be returned. Default is 3.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_xlab">xlab</code>, <code id="plot_sensitivity_+3A_ylab">ylab</code></td>
<td>
<p>Labels for x and y axes, as in <code><a href="base.html#topic+plot">plot</a></code>.
Default xlab = &quot;Beta.u&quot;, ylab = &quot;Effect&quot;.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_xlim">xlim</code>, <code id="plot_sensitivity_+3A_ylim">ylim</code></td>
<td>
<p>Ranges of x and y axes, as in <code><a href="base.html#topic+plot">plot</a></code>.
The default value, NULL, indicates that the range of the finite values to be
plotted should be used.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_main">main</code></td>
<td>
<p>A main title for the plot, as in <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_type">type</code></td>
<td>
<p>A character string (length 1 vector) or vector of 1-character
strings indicating the type of plot for 3 columns of y, as in
<code><a href="base.html#topic+plot">plot</a></code>. Default is 'l' for lines.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_col">col</code></td>
<td>
<p>A vector of strings indicating the colors for 3 lines of y.
Default is (&quot;black&quot;,&quot;black&quot;,&quot;black&quot;).</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_pch">pch</code></td>
<td>
<p>A vector of plotting characters or symbols, as in
<code><a href="base.html#topic+plot">plot</a></code>. Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_lty">lty</code></td>
<td>
<p>A vector of line types, as in <code><a href="base.html#topic+plot">plot</a></code>. Default is
c(1,2,3).</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_legend.x">legend.x</code>, <code id="plot_sensitivity_+3A_legend.y">legend.y</code></td>
<td>
<p>The x and y co-ordinates to be used to position
the legend, see x, y in <code><a href="graphics.html#topic+legend">legend</a></code>. Default legend.y = NULL.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_legend.inset">legend.inset</code></td>
<td>
<p>Inset distance(s) from the margins as a fraction of the
plot region when legend is placed by keyword, as <code>inset</code> in
<code><a href="graphics.html#topic+legend">legend</a></code>. Default is 0.05.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_legend">legend</code></td>
<td>
<p>A character or expression vector of 3 to appear in the
legend, as in <code><a href="graphics.html#topic+legend">legend</a></code>. Default is c(&quot;Direct Effect&quot;,
&quot;Mediation Effect&quot;, &quot;Total Effect&quot;)</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_legend.horiz">legend.horiz</code></td>
<td>
<p>A logical value. If TRUE, set the legend horizontally
Default is FALSE, which sets the legend vertically.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the estimated coefficient of treatment in the
fitted confounder model with observed data (see Cheng et al 2018) as the
middle point (mid.beta.u), and calculates 1 unit change in the coefficient
as |2*mid.beta.u/3/(n-1)| where n = n.beta.u if n.beta.u is an odd number
and n = n.beta.u+1 if n.beta.u is an even number, and n.beta.u is the
number of varying coefficient of treatment specified by users.
<code><a href="#topic+mediate_zi_vcoef">mediate_zi_vcoef</a></code> is then used to estimate average causal
mediation effects (indirect effect), average direct effects, and total
effect for each value of the treatment coefficient in the confounder
model. The function prints all the effect estimates, and produces the
sensitivity graph.
</p>


<h3>Value</h3>

<p><code>plot_sensitivity</code> produces sensitivity graph and returns an
object of data frame with the following columns:
</p>
<table>
<tr><td><code>beta.u</code></td>
<td>
<p>coefficient of treatment in the confounder model.</p>
</td></tr>
<tr><td><code>d0</code>, <code>d1</code></td>
<td>
<p>point estimates for average causal mediation effects under
the control and treatment conditions.</p>
</td></tr>
<tr><td><code>z0</code>, <code>z1</code></td>
<td>
<p>point estimates for average direct effect under the control
and treatment conditions.</p>
</td></tr>
<tr><td><code>d.avg</code>, <code>z.avg</code></td>
<td>
<p>simple averages of d0 and d1, z0 and z1, respectively.</p>
</td></tr>
<tr><td><code>tau.coef</code></td>
<td>
<p>point estimate for total effect.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nancy Cheng,
<a href="mailto:Nancy.Cheng@ucsf.edu">Nancy.Cheng@ucsf.edu</a>; Jing Cheng,
<a href="mailto:Jing.Cheng@ucsf.edu">Jing.Cheng@ucsf.edu</a>.
</p>


<h3>References</h3>

<p>Cheng, J., Cheng, N.F., Guo, Z., Gregorich, S., Ismail, A.I.,
Gansky, S.A (2018) Mediation analysis for count and zero-inflated count
data. Statistical Methods in Medical Research. 27(9):2756-2774.
</p>
<p>Ismail AI, Ondersma S, Willem Jedele JM, et al. (2011) Evaluation of
a brief tailored motivational intervention to prevent early childhood
Community Dentistry and Oral Epidemiology 39: 433–448.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mediate_zi_vcoef">mediate_zi_vcoef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("midvd_bt100")
uFit &lt;- glm(PDVisit_6 ~ intervention + BrushTimes_W2 + HealthyMeals_W2
                        + PDVisit_W2,
            family = 'binomial', data = midvd_bt100)
mFit &lt;- glm(PBrushBedt_6 ~ intervention + BrushTimes_W2 + HealthyMeals_W2
                           + PBrush_W2 + PDVisit_6,
            family = 'binomial', data = midvd_bt100)
yFit &lt;- zeroinfl(Untreated_W3 ~ intervention + PBrushBedt_6 + BrushTimes_W2
                                + HealthyMeals_W2 + PBrush_W2 + PDVisit_6,
                 data = midvd_bt100)
# For illustration purposes a small number of simulations are used
plot_sensitivity(uFit, n.beta.u = 5, mFit, yFit, sims = 25,
                 treat = "intervention", mediator = "PBrushBedt_6",
                 confounder = "PDVisit_6",
                 main = "Effects on the number of new untreated cavities at 2 years",
                 legend.x = "right")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
