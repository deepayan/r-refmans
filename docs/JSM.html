<!DOCTYPE html><html><head><title>Help for package JSM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {JSM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aids'><p>ddI versus ddC in HIV-infected Patients</p></a></li>
<li><a href='#confint'><p>Obtain Confidence Intervals for Joint Model Parameters</p></a></li>
<li><a href='#dataPreprocess'><p>Preprocess Data to Be Fed into Joint Models</p></a></li>
<li><a href='#epilepsy'>
<p>CBZ versus LTG in Epilepsy Patients</p></a></li>
<li><a href='#fitted'><p>Extract Fitted Values for Joint Models</p></a></li>
<li><a href='#jmodelMult'><p>Semiparametric Joint Models for Survival and Longitudinal Data with Nonparametric Multiplicative Random Effects</p></a></li>
<li><a href='#jmodelMultObject'><p>Fitted jmodelMult Object</p></a></li>
<li><a href='#jmodelTM'><p>Semiparametric Joint Models for Survival and Longitudinal Data</p></a></li>
<li><a href='#jmodelTMObject'><p>Fitted jmodelTM Object</p></a></li>
<li><a href='#liver'>
<p>Prednisone versus Placebo in Liver Cirrhosis Patients</p></a></li>
<li><a href='#liver.long'>
<p>Prednisone versus Placebo in Liver Cirrhosis Patients - Longitudinal Data</p></a></li>
<li><a href='#liver.surv'>
<p>Prednisone versus Placebo in Liver Cirrhosis Patients - Survival Data</p></a></li>
<li><a href='#pbc'>
<p>Mayo Clinic Primary Biliary Cirrhosis Data</p></a></li>
<li><a href='#ranef'><p>Extract Random Effects for Joint Models</p></a></li>
<li><a href='#residuals'><p>Extract Residuals for Joint Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Semiparametric Joint Modeling of Survival and Longitudinal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-07-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Cong Xu, Pantelis Z. Hadjipantelis and Jane-Ling Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cong Xu &lt;helenxu1112@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood estimation for the semiparametric joint modeling of survival and longitudinal data. Refer to the Journal of Statistical Software article: &lt;<a href="https://doi.org/10.18637%2Fjss.v093.i02">doi:10.18637/jss.v093.i02</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.5)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), nlme, splines, statmod, survival</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-22 02:37:14 UTC; congxu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-03 22:22:30 UTC</td>
</tr>
</table>
<hr>
<h2 id='aids'>ddI versus ddC in HIV-infected Patients</h2><span id='topic+aids'></span>

<h3>Description</h3>

<p>A randomized clinical trial in which both survival and longitudinal data were collected to compare the efficacy and 
safety of two antiretroviral drugs, namely <code>ddI</code> (didanosine) and <code>ddC</code> (zalcitabine), in treating HIV-infected patients intolerant or failing zidovudine (AZT) therapy.
</p>


<h3>Format</h3>

<p>A data frame with 1405 observations on the following 12 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>patient ID, there are 467 patients in total.</p>
</dd>
<dt><code>Time</code></dt><dd><p>survival time, i.e. time to death or censoring.</p>
</dd>
<dt><code>death</code></dt><dd><p>death indicator: 0 denotes censoring; 1 denotes death.</p>
</dd>
<dt><code>obstime</code></dt><dd><p>time points at which the longitudinal measurements, i.e. CD4 cell counts, are recorded.</p>
</dd>
<dt><code>CD4</code></dt><dd><p>CD4 cell counts measured at <code>obstime</code>.</p>
</dd>
<dt><code>drug</code></dt><dd><p>drug indicator with two levels: <code>ddI</code> and <code>ddC</code>.</p>
</dd>
<dt><code>gender</code></dt><dd><p>gender indicator with two levels: <code>male</code> and <code>female</code>.</p>
</dd>
<dt><code>prevDiag</code></dt><dd><p>AIDS diagnosis at study entry indicator with two levels: <code>AIDS</code> and <code>noAIDS</code>.</p>
</dd>
<dt><code>AZT</code></dt><dd><p>AZT intolerance/failure indicator with two levels: <code>intolerance</code> and <code>failure</code>.</p>
</dd>
<dt><code>start</code></dt><dd><p>same with <code>obstime</code>, starting time of the interval which contains the time of the CD4 cell count measurement.</p>
</dd>
<dt><code>stop</code></dt><dd><p>ending time of the interval which contains the time of the CD4 cell count measurement.</p>
</dd>
<dt><code>event</code></dt><dd><p>event indicator suggesting whether the event-of-interest, i.e. death, happens in the interval given by <code>start</code> and <code>stop</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Goldman, A., Carlin, B., Crane, L., Launer, C., Korvick, J., Deyton, L. and Abrams, D. (1996) Response of CD4+ and
clinical consequences to treatment using ddI or ddC in patients with advanced HIV infection. <em>Journal of Acquired
Immune Deficiency Syndromes and Human Retrovirology</em> <b>11</b>, 161&ndash;169.
</p>


<h3>References</h3>

<p>Guo, X. and Carlin, B. (2004) Separate and joint modeling of longitudinal and event time data using standard
computer packages. <em>The American Statistician</em> <b>58</b>, 16&ndash;24.
</p>
<p>Xu, C., Baines, P. D. and Wang, J. L. (2014) Standard error estimation using the EM algorithm for the joint modeling of survival and longitudinal data. <em>Biostatistics</em> <b>15</b>, 731&ndash;744
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(aids)
</code></pre>

<hr>
<h2 id='confint'>Obtain Confidence Intervals for Joint Model Parameters</h2><span id='topic+confint.jmodelTM'></span><span id='topic+confint.jmodelMult'></span>

<h3>Description</h3>

<p><code>confint</code> is a generic function which computes confidence intervals for parameters in models fitted by <code>jmodelTM()</code> or <code>jmodelMult()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jmodelTM'
confint(object, parm, level = 0.95, ...)
## S3 method for class 'jmodelMult'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>jmodelTM</code> or <code>jmodelMult</code>.</p>
</td></tr>
<tr><td><code id="confint_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals. As currently implemented, always give confidence intervals for all regression coefficients.</p>
</td></tr>
<tr><td><code id="confint_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint_+3A_...">...</code></td>
<td>
<p>additional arguments required. None is used in this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list consists of the following components:
</p>
<table>
<tr><td><code>infoLong</code></td>
<td>
<p>a matrix with columns giving parameter estimates as well as their lower and upper confidence limits for the regression parameters of the longitudinal process. </p>
</td></tr>
<tr><td><code>infoSurv</code></td>
<td>
<p>a matrix with columns giving parameter estimates as well as their lower and upper confidence limits for the regression parameters of the survival process.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>the confidence level used in computing the confidence limits.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fitLME &lt;- lme(proth ~ Trt * obstime, random = ~ 1 | ID, data = liver)
fitCOX &lt;- coxph(Surv(start, stop, event) ~ Trt, data = liver, x = TRUE)
fitJT.ph &lt;- jmodelTM(fitLME, fitCOX, liver, timeVarY = 'obstime')

# 95% confidence intervals for the joint model parameters
confint(fitJT.ph)

## End(Not run)
</code></pre>

<hr>
<h2 id='dataPreprocess'>Preprocess Data to Be Fed into Joint Models</h2><span id='topic+dataPreprocess'></span>

<h3>Description</h3>

<p><code>dataPreprocess</code> is a function to preprocess data to be used in fitting joint models. Suppose the situation is that 
the longitudinal measurements are recorded in a data frame with one row per measurment and the survival information 
are recorded in another data frame with one row per subject. This function merges the two data frames by subject identification 
and generate three new columns: <code>start</code>, <code>stop</code>, <code>event</code>. See <b>Value</b>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataPreprocess(long, surv, id.col, long.time.col, surv.time.col, surv.event.col, 
               surv.event.indicator = list(censored = 0, event = 1), suffix = ".join")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataPreprocess_+3A_long">long</code></td>
<td>
<p>a data frame for the longitudinal data, one row per measurment, with subject identification, time of measurement, and longitudinal measurements, etc.</p>
</td></tr>
<tr><td><code id="dataPreprocess_+3A_surv">surv</code></td>
<td>
<p>a data frame for the survival data, one row per subject, with subject identification (column name should match that in <code>long</code>), possibly censored time-to-event, and event indicator (normally 0=censored, 1=event), etc.</p>
</td></tr>
<tr><td><code id="dataPreprocess_+3A_id.col">id.col</code></td>
<td>
<p>a <code>character</code> string specifying the subject identification column in both <code>long</code> and <code>surv</code>.</p>
</td></tr>
<tr><td><code id="dataPreprocess_+3A_long.time.col">long.time.col</code></td>
<td>
<p>a <code>character</code> string specifying the time of measurement column in <code>long</code>.</p>
</td></tr>
<tr><td><code id="dataPreprocess_+3A_surv.time.col">surv.time.col</code></td>
<td>
<p>a <code>character</code> string specifying the possibly censored time-to-event column in <code>surv</code>.</p>
</td></tr>
<tr><td><code id="dataPreprocess_+3A_surv.event.col">surv.event.col</code></td>
<td>
<p>a <code>character</code> string specifying the event status column in <code>surv</code>.</p>
</td></tr>
<tr><td><code id="dataPreprocess_+3A_surv.event.indicator">surv.event.indicator</code></td>
<td>
<p>a <code>list</code> specifying the values in column <code>surv.event.col</code> corresponding to censored and event status.</p>
</td></tr>
<tr><td><code id="dataPreprocess_+3A_suffix">suffix</code></td>
<td>
<p>a optional <code>character</code> string specifying the suffix to be added to the <code>start</code>, <code>stop</code>, <code>event</code> columns in case  <code>long</code> or <code>surv</code> already have columns with these names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame merging <code>long</code> and <code>surv</code> by subject identification, with one row per longitudinal measurment, 
and generate three new columns: <code>start</code>, <code>stop</code>, <code>event</code> (column names are added with suffix specified by <code>suffix</code>:
</p>

<dl>
<dt><code>start</code></dt><dd><p>starting time of the interval which contains the time of the longitudinal measurements.</p>
</dd>
<dt><code>stop</code></dt><dd><p>ending time of the interval which contains the time of the longitudinal measurements.</p>
</dd>
<dt><code>event</code></dt><dd><p>event indicator suggesting whether the event-of-interest, e.g. death, happens in the interval given by <code>start</code> and <code>stop</code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>1. If <code>long</code> and <code>surv</code> have columns sharing the same column names, the columns from <code>long</code> and <code>surv</code> would be named with suffixes &quot;.long&quot; and &quot;.surv&quot;, respectively, in the output data frame.
2. The time of measurement of the longitudinal measurements and possibly censored time-to-event should be recorded consistently for each subject, i.e. time 0 means the same time point for the longitudinal and survival measurements. 
</p>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
liver.join &lt;- dataPreprocess(liver.long, liver.surv, 'ID', 'obstime', 'Time', 'death')

## End(Not run)
</code></pre>

<hr>
<h2 id='epilepsy'>
CBZ versus LTG in Epilepsy Patients
</h2><span id='topic+epilepsy'></span>

<h3>Description</h3>

<p>A randomised control trial, the SANAD (standard and new antiepileptic drugs) study, in which both survival and longitudinal data were collected to investigate the effect of drug titration on the relative effects of two antiepileptic drugs, namely <code>CBZ</code> (carbamazepine, a standard drug) and <code>LTG</code> (lamotrigine, a new drug), on treatment failure. Treatment failure, i.e. withdrawal of the randomized drug, is the event of interest. Two main reasons for withdrawal are unacceptable adverse effects (UAE) and inadequate seizure control (ISC).
</p>


<h3>Format</h3>

<p>A data frame with 2797 observations on the following 16 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>patient ID, there are 605 patients in total.</p>
</dd>
<dt><code>Time</code></dt><dd><p>survival time, i.e. time to withdrawal or censoring.</p>
</dd>
<dt><code>withdraw</code></dt><dd><p>withdrawal indicator: 0 denotes censoring; 1 denotes withdrawal.</p>
</dd>
<dt><code>withdrawUAE</code></dt><dd><p>withdrawal due to UAE indicator: 1 denotes withdrawal due to UAE; 0 otherwise.</p>
</dd>
<dt><code>withdrawISC</code></dt><dd><p>withdrawal due to ISC indicator: 1 denotes withdrawal due to ISC; 0 otherwise.</p>
</dd>
<dt><code>obstime</code></dt><dd><p>time points at which the longitudinal measurements, i.e. the dose, are recorded.</p>
</dd>
<dt><code>dose</code></dt><dd><p>calibrated dose measured at <code>obstime</code>.</p>
</dd>
<dt><code>drug</code></dt><dd><p>drug indicator with two levels: <code>CBZ</code> and <code>LTG</code>.</p>
</dd>
<dt><code>age</code></dt><dd><p>age of patient at study entry.</p>
</dd>
<dt><code>gender</code></dt><dd><p>gender indicator with two levels: <code>male</code> and <code>female</code>.</p>
</dd>
<dt><code>disab</code></dt><dd><p>learning disability indicator with two levels: <code>No</code> and <code>Yes</code>.</p>
</dd>
<dt><code>start</code></dt><dd><p>same with <code>obstime</code>, starting time of the interval which contains the time of the dose measurement.</p>
</dd>
<dt><code>stop</code></dt><dd><p>ending time of the interval which contains the time of the dose measurement.</p>
</dd>
<dt><code>event</code></dt><dd><p>event indicator suggesting whether the event-of-interest, i.e. withdrawal, happens in the interval given by <code>start</code> and <code>stop</code>.</p>
</dd>
<dt><code>eventUAE</code></dt><dd><p>event indicator suggesting whether the event-of-interest, i.e. withdrawal due to UAE, happens in the interval given by <code>start</code> and <code>stop</code>.</p>
</dd>
<dt><code>eventISC</code></dt><dd><p>event indicator suggesting whether the event-of-interest, i.e. withdrawal due to ISC, happens in the interval given by <code>start</code> and <code>stop</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Marson, A. G., AI-Kharusi, A. M., Alwaidh, M., Appleton, R., Baker, G. A., Chadwick, D. W., Cramp, C., Cockerell, O. C. Cooper, P. N., Doughty, J. et al. (2007) The SANAD study of effectiveness of carbamazepine, gabapentin, lamotrigine, oxcarbazepine, or topiramate for treatment of partial epilepsy: an unblinded randomised controlled trial. <em>The Lancet</em> <b>369</b>, 1000&ndash;1015.
</p>


<h3>References</h3>

<p>Williamson P. R., Kolamunnage-Dona R., Philipson P. and Marson A. G. (2008) Joint modelling of longitudinal and competing risks data. <em>Statistics in Medicine</em> <b>27</b>, 6426&ndash;6438.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(epilepsy)
</code></pre>

<hr>
<h2 id='fitted'>Extract Fitted Values for Joint Models</h2><span id='topic+fitted.jmodelTM'></span><span id='topic+fitted.jmodelMult'></span>

<h3>Description</h3>

<p><code>fitted</code> is a generic function which extracts fitted values from objects returned by <code>jmodelTM()</code> or <code>jmodelMult()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jmodelTM'
fitted(object, process = c("Longitudinal", "Survival"), 
        type = c("Marginal", "Conditional"), ...)
## S3 method for class 'jmodelMult'
fitted(object, process = c("Longitudinal", "Survival"), 
        type = c("Marginal", "Conditional"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>jmodelTM</code> or <code>jmodelMult</code>.</p>
</td></tr>
<tr><td><code id="fitted_+3A_process">process</code></td>
<td>
<p>for which process the fitted values are calculated, i.e. the longitudinal or the survival process.</p>
</td></tr>
<tr><td><code id="fitted_+3A_type">type</code></td>
<td>
<p>what type of fitted values to calculate for each process. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="fitted_+3A_...">...</code></td>
<td>
<p>additional arguments required. None is used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We have implemented the fitted value calculation for <code>process = "Longitudinal"</code> but not for <code>process = "Survival"</code> yet as they are not well defined under the joint modeling setting. There are two types of fitted values depending on whether to compute the values conditional on the random effects. With <code>type = "Marginal"</code>, the fitted values are <code class="reqn">\mathbf{X}_i^\top(t)\boldsymbol\beta</code> for objects returned by <code>jmodelTM()</code> and <code class="reqn">\mathbf{B}^\top(t)\boldsymbol\gamma</code> for objects returned by <code>jmodelMult()</code>. With <code>type = "Conditional"</code>, the fitted values are <code class="reqn">\mathbf{X}_i^\top(t)\boldsymbol\beta + \mathbf{Z}_i^\top(t)\mathbf{b}_i</code> for objects returned by <code>jmodelTM()</code> and <code class="reqn">b_i\times\mathbf{B}^\top(t)\boldsymbol\gamma</code> for objects returned by <code>jmodelMult()</code>.
</p>


<h3>Value</h3>

<p>A numeric vector of fitted values.
</p>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fitLME &lt;- lme(proth ~ Trt * obstime, random = ~ 1 | ID, data = liver)
fitCOX &lt;- coxph(Surv(start, stop, event) ~ Trt, data = liver, x = TRUE)
fitJT.ph &lt;- jmodelTM(fitLME, fitCOX, liver, timeVarY = 'obstime')

# fitted values for the longitudinal process
fitted(fitJT.ph, type = "Conditional")

## End(Not run)
</code></pre>

<hr>
<h2 id='jmodelMult'>Semiparametric Joint Models for Survival and Longitudinal Data with Nonparametric Multiplicative Random Effects</h2><span id='topic+jmodelMult'></span>

<h3>Description</h3>

<p>This function applies a maximum likelihood approach to fit the semiparametric joint models of survival and normal
longitudinal data. The survival model is assumed to come from a class of transformation models, including the Cox
proportional hazards model and the proportional odds model as special cases. The longitudinal process is modeled by  
nonparametric multiplicative random effects (NMRE) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jmodelMult(fitLME, fitCOX, data, model = 1, rho = 0, timeVarY = NULL, 
           timeVarT = NULL, control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jmodelMult_+3A_fitlme">fitLME</code></td>
<td>
<p>an object inheriting from class <code>lme</code> representing a fitted nonparametric multiplicative random effects model. See <b>Details</b> and <b>Note</b> and <b>Examples</b>.</p>
</td></tr>
<tr><td><code id="jmodelMult_+3A_fitcox">fitCOX</code></td>
<td>
<p>an object inheriting from class <code>coxph</code> representing a fitted Cox proportional hazards regression model. Specifying <code>x = TRUE</code> is required in the call to <code>coxph()</code> to include the design matrix in the object fit. See <b>Note</b>.</p>
</td></tr>
<tr><td><code id="jmodelMult_+3A_data">data</code></td>
<td>
<p>a data.frame containing all the variables included in the joint modeling. See <b>Note</b>.</p>
</td></tr>
<tr><td><code id="jmodelMult_+3A_model">model</code></td>
<td>
<p>an indicator specifying the dependency between the survival and longitudinal outcomes. Default is 1. See 
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="jmodelMult_+3A_rho">rho</code></td>
<td>
<p>a nonnegative real number specifying the transformation model you would like to fit. Default is 0, i.e. the Cox proportional hazards model. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="jmodelMult_+3A_timevary">timeVarY</code></td>
<td>
<p>a character string indicating the time variable in the NMRE model. See <b>Examples</b>.</p>
</td></tr>
<tr><td><code id="jmodelMult_+3A_timevart">timeVarT</code></td>
<td>
<p>a character string indicating the time variable in the <code>coxph</code> object. Normally it is <code>NULL</code>. See <b>Note</b> and <b>Examples</b>.</p>
</td></tr>
<tr><td><code id="jmodelMult_+3A_control">control</code></td>
<td>
<p>a list of control values for the estimation algorithm with components:
</p>

<dl>
<dt>tol.P</dt><dd><p>tolerance value for convergence in the parameters with default value 1e-03. See <b>Details</b>.</p>
</dd>
<dt>tol.L</dt><dd><p>tolerance value for convergence in the log-likelihood with default value 1e-06. See <b>Details</b>.</p>
</dd>
<dt>max.iter</dt><dd><p>the maximum number of EM iterations with default value 250.</p>
</dd>
<dt>SE.method</dt><dd><p>a character string specifying the standard error estimation method. Default is <code>"PRES"</code>. See <b>Details</b> and <b>Note</b>.</p>
</dd>
<dt>delta</dt><dd><p>a positive value used for numerical differentiation in the <code>SE.method</code>. Default is 1e-05 if <code>"PRES"</code> is used and 1e-03 otherwise. See <b>Details</b>.</p>
</dd>
<dt>nknot</dt><dd><p>the number of Gauss-Hermite quadrature knots used to approximate the integrals over the random effects. Under the nonparametric multiplicative random effects model, there are only one-dimensional integrations and the default for <code>nknot</code> is 11.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="jmodelMult_+3A_...">...</code></td>
<td>
<p>additional options to be passed to the <code>control</code> argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>jmodelMult</code> function fits joint models for survival and longitudinal data. Nonparametric multiplicative random effects models (NMRE) are assumed for the longitudinal processes. With the Cox proportional hazards model and the proportional odds model as special cases, a general class of transformation models are assumed for the survival processes. The baseline hazard functions are left unspecified, i.e. no parametric forms are assumed, thus leading to semiparametric models. For detailed model formulation, please refer to Xu, Hadjipantelis and Wang (2017). 
</p>
<p>The longitudinal model (NMRE) is written as </p>
<p style="text-align: center;"><code class="reqn">Y_i(t)=\mu_i(t) + \varepsilon_i(t) = b_i\times\mathbf{B}^\top(t)\boldsymbol\gamma + \varepsilon_i(t),</code>
</p>
<p> where <code class="reqn">\mathbf{B}(t)=(B_1(t), \cdots, B_L(t))</code> is a vector of B-spline basis functions and <code class="reqn">b_i</code> is a random effect <code class="reqn">\sim\mathcal{N}(1, \sigma_b^2)</code>. Note that we also allow the inclusion of baseline covariates as columns of <code class="reqn">\mathbf{B}(t)</code>. If <code>model = 1</code>, then the linear predictor for the survival model is expressed as </p>
<p style="text-align: center;"><code class="reqn">\eta(t) = \mathbf{W}_i^\top(t)\boldsymbol\phi + \alpha\mu_i(t),</code>
</p>
<p> indicating that the entire longitudinal process (free of error) enters the survival model as a covariate. If other values are assigned to the <code>model</code> argument, the linear predictor for the surival model is then expressed as </p>
<p style="text-align: center;"><code class="reqn">\eta(t) = \mathbf{W}_i^\top(t)\boldsymbol\phi + \alpha b_i,</code>
</p>
<p> suggesting that the survival and longitudinal models only share the same random effect.
</p>
<p>The survival model is written as </p>
<p style="text-align: center;"><code class="reqn">\Lambda(t|\eta(t)) = G\left[\int_0^t\exp\{\eta(s)\}d\Lambda_0(s)\right],</code>
</p>
<p> where <code class="reqn">G(x) = \log(1 + \rho x) / \rho</code> with <code class="reqn">\rho \geq 0</code> is the class of logarithmic transfomrations. If <code>rho = 0</code>, then <code class="reqn">G(x) = x</code>, yielding the Cox proportional hazards model. If <code>rho = 1</code>, then <code class="reqn">G(x) = \log(1 + x)</code>, yielding the proportional odds model. Users could assign any nonnegative real value to <code>rho</code>.
</p>
<p>An expectation-maximization (EM) algorithm is implemented to obtain parameter estimates. The convergence criterion is either of (i) <code class="reqn">\max \{ | \boldsymbol\theta^{(t)} - \boldsymbol\theta^{(t - 1)} | / ( | \boldsymbol\theta^{(t - 1)} | + .Machine\$double.eps \times 2 ) \} &lt; tol.P</code>, or (ii) <code class="reqn">| L(\boldsymbol\theta^{(t)}) - L(\boldsymbol\theta^{(t - 1)})| / ( | L(\theta^{(t - 1)}) | + .Machine\$double.eps \times 2 ) &lt; tol.L</code>, is satisfied. Here <code class="reqn">\boldsymbol\theta^{(t)}</code> and <code class="reqn">\boldsymbol\theta^{(t-1)}</code> are the vector of parameter estimates at the <code class="reqn">t</code>-th and <code class="reqn">(t-1)</code>-th EM iterations, respectively; <code class="reqn">L(\boldsymbol\theta)</code> is the value of the log-likelihood function evaluated at <code class="reqn">\boldsymbol\theta</code>. Users could specify the tolerance values <code>tol.P</code> and <code>tol.L</code> through the <code>control</code> argument.
</p>
<p>For standard error estimation for the parameter estimates, three methods are provided, namely <code>"PRES"</code>, <code>"PFDS"</code> and <code>"PLFD"</code> (detailed information are referred to Xu, Baines and Wang (2014)). In the <code>control</code> argument, if <code>SE.method = "PRES"</code>, numerically differentiating the profile Fisher score vector with Richardson extrapolation is applied; if <code>SE.method = "PFDS"</code>, numerically differentiating the profile Fisher score vector with forward difference is applied; if <code>SE.method = "PLFD"</code>, numerially (second) differentiating the profile likelihood with forward difference is applied. Generally, numerically differentiating a function <code class="reqn">f(x)</code> (an arbitrary function) with forward difference is expressed as </p>
<p style="text-align: center;"><code class="reqn">f^\prime(x) = \frac{f(x + \delta) - f(x)}{\delta},</code>
</p>
<p> and that with Richardson extrapolation is expressed as </p>
<p style="text-align: center;"><code class="reqn">f^\prime(x) = \frac{f(x - 2\delta) - 8f(x - \delta) + 8f(x + \delta) - f(x + 2\delta)}{12\delta}.</code>
</p>
<p> Users could specify the value of <code class="reqn">\delta</code> through the <code>delta</code> item in the <code>control</code> argument.
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+jmodelMultObject">jmodelMultObject</a></code> for the components of the fit.
</p>


<h3>Note</h3>

<p>1. To fit a nonparametric multiplicative random effects model, the fixed effect in the <code>fitLME</code> object should be a matrix of B-spline basis functions (an object from the <code>bs</code> function) with the possibility of including baseline covariates and the random effect should only include a random intercept. In the <code>bs</code> function, it is a good practice to specify the boundary knots through the <code>Boundary.knots</code> argument, where the upper boundary knot is typically the longest follow-up time among all subjects. See <b>Examples</b>.
</p>
<p>2. Currently, <code>jmodelMult()</code> could only handle the <code>fitLME</code> object with a simple random-effects structure (only the <code>pdDiag()</code> class). Moreover, the within-group correlation and heteroscedasticity structures in the <code>fitLME</code> object (i.e. the <code>correlation</code> and <code>weights</code> argument of <code>lme()</code>) are ignored.
</p>
<p>3. The <code>data</code> argument in <code>jmodelMult()</code>, <code>lme()</code> and <code>coxph()</code> should be the same data frame.
</p>
<p>4. For the <code>fitCOX</code> object, only the <code class="reqn">W_i(t)</code> in the linear predictor <code class="reqn">\eta(t)</code> for the survial model (see <b>Details</b>) should be involved in the <code>formula</code> argument of <code>coxph{}</code>. Since <code>coxph()</code> uses the same data frame as <code>lme()</code> does, a time-dependent Cox model must be fitted by <code>coxph()</code> although <code class="reqn">W_i(t)</code> may only contain time-independent covariates. See <b>Examples</b>.
</p>
<p>5. If <code class="reqn">W_i(t)</code> in the linear predictor <code class="reqn">\eta(t)</code> for the survial model (see <b>Details</b>) does involve time-dependent covariate, then <code>timeVarT</code> must specify the name of the time variable involved (see <b>Examples</b>).
</p>
<p>6. The standard error estimates are obtained by numerical approximations which is naturally subject to numerical errors. Therefore, in extreme cases, there may be <code>NA</code> values for part of the standard error estimates.
</p>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
Pantelis Z. Hadjipantelis <a href="mailto:pantelis@ucdavis.edu">pantelis@ucdavis.edu</a>
</p>


<h3>References</h3>

<p>Dabrowska, D. M. and Doksun K. A. (1988) Partial Likelihood in Transformation Models with Censored Data. <em>Scandinavian Journal of Statistics</em> <b>15</b>, 1&ndash;23.
</p>
<p>Ding, J. and Wang, J. L. (2008) Modeling longitudinal data with nonparametric multiplicative random effects jointly with survival data. <em>Biometrics</em> <b>64</b>, 546&ndash;556.
</p>
<p>Tsiatis, A. A. and Davidian, M. (2004) Joint modeling of longitudinal and time-to-event data: an overview. 
<em>Statistica Sinica</em> <b>14</b>, 809&ndash;834.
</p>
<p>Xu, C., Baines, P. D. and Wang, J. L. (2014) Standard error estimation using the EM algorithm for the joint modeling of survival and longitudinal data. <em>Biostatistics</em> <b>15</b>, 731&ndash;744
</p>
<p>Xu, C., Hadjipantelis, P. Z. and Wang, J. L. (2020) Semiparametric joint modeling of survival and longitudinal data: the R package JSM. <em>Journal of Statistical Software</em> &lt;doi:10.18637/jss.v093.i02&gt;.
</p>
<p>Zeng, D. and Lin, D. (2007) Maximum likelihood estimation in semiparametric regression models with censored data. <em>Journal of the Royal Statistical Society: Series B</em> <b>69</b>, 507&ndash;564.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jmodelMultObject">jmodelMultObject</a></code>,
<code><a href="nlme.html#topic+lme">lme</a></code>,
<code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="survival.html#topic+Surv">Surv</a></code>,
<code><a href="splines.html#topic+bs">bs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># linear mixed-effects model fit where the fixed effect is modeled by 
# quadratic B-splie basis with no internal knots
fitLME &lt;- lme(log(serBilir) ~ bs(obstime, degree = 2, Boundary.knots = c(0, 15)), 
              random = ~ 1 | ID, data = pbc)
# Cox proportional hazards model fit with a single time-independent covariate
fitCOX &lt;- coxph(Surv(start, stop, event) ~ drug, data = pbc, x = TRUE)

# joint model fit which assumes the Cox proportional hazards model for the survival process 
# and NMRE for the longitudinal process. Use 'max.iter = 25', 'nknot = 3' and 
# the 'PFDS' method to calculate standard error estimates as a quick toy example 
fitJTMult.ph &lt;- jmodelMult(fitLME, fitCOX, pbc, timeVarY = "obstime", 
                           control = list(SE.method = 'PFDS', max.iter = 25, nknot = 3))
summary(fitJTMult.ph)

## Not run: 
# joint model fit with the default control
fitJTMult.ph2 &lt;- jmodelMult(fitLME, fitCOX, pbc, timeVarY = "obstime")
summary(fitJTMult.ph2)
# joint model fit where the survival and longitudinal processes only share 
# the same random effect
fitJTMult.ph3 &lt;- jmodelMult(fitLME, fitCOX, pbc, model = 2, timeVarY = "obstime")
summary(fitJTMult.ph3)

# joint model fit which assumes the proportional odds model for the survival process 
# and NMRE model for the longitudinal process
fitJTMult.po &lt;- jmodelMult(fitLME, fitCOX, pbc, rho = 1, timeVarY = "obstime")
summary(fitJTMult.po)
# joint model fit where the survival and longitudinal processes only share 
# the same random effect
fitJTMult.po2 &lt;- jmodelMult(fitLME, fitCOX, pbc, model = 2, rho = 1, timeVarY = "obstime")
summary(fitJTMult.po2)

# allow baseline covariates in the NMRE model for the longitudinal process
fitLME2 &lt;- lme(log(serBilir) ~ drug + bs(obstime, degree = 2, Boundary.knots = c(0, 15)), 
               random = ~1 | ID, data = pbc)
fitJTMult.ph4 &lt;- jmodelMult(fitLME2, fitCOX, pbc, timeVarY = "obstime")
summary(fitJTMult.ph4)

# Cox proportional hazards model fit with a time-dependent covariate
fitCOX2 &lt;- coxph(Surv(start, stop, event) ~ drug + as.numeric(drug) : obstime, 
                 data = pbc, x = TRUE)
# joint model fit in which \code{timeVarT} must be specified
fitJTMult.ph5 &lt;- jmodelMult(fitLME, fitCOX2, pbc, timeVarY = "obstime", timeVarT = 'obstime', 
                            control = list(max.iter = 300))
summary(fitJTMult.ph5)

## End(Not run)
</code></pre>

<hr>
<h2 id='jmodelMultObject'>Fitted jmodelMult Object</h2><span id='topic+jmodelMultObject'></span>

<h3>Description</h3>

<p>An object returned by the <code>jmodelMult</code> function, inheriting from class <code>jmodelMult</code> and representing a fitted joint model for survival and longitudinal data. Objects of this class have methods for the generic functions <code>AIC</code>, <code>BIC</code>, <code>logLik</code>, <code>print</code>, <code>summary</code>, and <code>vcov</code>.
</p>


<h3>Value</h3>

<p>The following components must be included in a legitimate <code>jmodelMult</code> object.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a list with the estimated parameters. The list is consist of the following components:</p>
</td></tr>
</table>

<dl>
<dt>gamma</dt><dd><p>the vector of estimated coefficients for the B-spline basis functions in the nonparametric multiplicative random effects model.</p>
</dd>
<dt>phi</dt><dd><p>the vector of estimated coefficients for the covariates other than the covariate associated with the longitudinal process in the survival model.</p>
</dd>
<dt>alpha</dt><dd><p>the estimated coefficient for the covariate associated with the longitudinal process in the survival model.</p>
</dd>
<dt>Ysigma</dt><dd><p>the estimated measurement error standard deviation for the linear mixed-effects model.</p>
</dd>
<dt>Bsigma</dt><dd><p>the estimated variance-covariance matrix of the random effects.</p>
</dd>
<dt>lamb</dt><dd><p>a numeric matrix with two columns: the first column contains the unique observed survival times in ascending order; the second column contains the corresponding estimated baseline hazard values.</p>
</dd>
</dl>

<table>
<tr><td><code>Vcov</code></td>
<td>
<p>the variance-covariance matrix evaluated at the estimated parameter values.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>the log-likelihood (the joint likelihood) value.</p>
</td></tr>
<tr><td><code>est.bi</code></td>
<td>
<p>the estimated values for the random effects</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>a list containing an image of the <code>jmodelTM</code> call that produced the object.</p>
</td></tr>
<tr><td><code>numIter</code></td>
<td>
<p>the number of iterations used in the EM algorithm.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>the convergence indicator: if <code>"failure"</code>, usually more iterations are required.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>the value of the <code>control</code> argument passed to <code>jmodelTM</code>.</p>
</td></tr>
<tr><td><code>time.SE</code></td>
<td>
<p>the CPU time used to compute the standard error estimates, i.e. the time use to compute the variance-covariance matrix for the parameter estimates.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>the total number of repeated measurements for the longitudinal outcome.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of sample units.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>the censoring indicator: 0 denotes censored survival time; 1 denotes observed survival time.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>the transformation parameter used for the survival model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
Pantelis Z. Hadjipantelis <a href="mailto:pantelis@ucdavis.edu">pantelis@ucdavis.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jmodelMult">jmodelMult</a></code>
</p>

<hr>
<h2 id='jmodelTM'>Semiparametric Joint Models for Survival and Longitudinal Data</h2><span id='topic+jmodelTM'></span>

<h3>Description</h3>

<p>This function applies a maximum likelihood approach to fit the semiparametric joint models of survival and normal
longitudinal data. The survival model is assumed to come from a class of transformation models, including the Cox
proportional hazards model and the proportional odds model as special cases. The longitudinal process is modeled by  
liner mixed-effects models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jmodelTM(fitLME, fitCOX, data, model = 1, rho = 0, timeVarY = NULL, 
         timeVarT = NULL, control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jmodelTM_+3A_fitlme">fitLME</code></td>
<td>
<p>an object inheriting from class <code>lme</code> representing a fitted linear mixed-effects model. See <b>Note</b>.</p>
</td></tr>
<tr><td><code id="jmodelTM_+3A_fitcox">fitCOX</code></td>
<td>
<p>an object inheriting from class <code>coxph</code> representing a fitted Cox proportional hazards regression model. Specifying <code>x = TRUE</code> is required in the call to <code>coxph()</code> to include the design matrix in the object fit. See <b>Note</b>.</p>
</td></tr>
<tr><td><code id="jmodelTM_+3A_data">data</code></td>
<td>
<p>a data.frame containing all the variables included in the joint modeling. See <b>Note</b>.</p>
</td></tr>
<tr><td><code id="jmodelTM_+3A_model">model</code></td>
<td>
<p>an indicator specifying the dependency between the survival and longitudinal outcomes. Default is 1. See 
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="jmodelTM_+3A_rho">rho</code></td>
<td>
<p>a nonnegative real number specifying the transformation model you would like to fit. Default is 0, i.e. the Cox proportional hazards model. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="jmodelTM_+3A_timevary">timeVarY</code></td>
<td>
<p>a character string indicating the time variable in the linear mixed-effects model. See <b>Examples</b>.</p>
</td></tr>
<tr><td><code id="jmodelTM_+3A_timevart">timeVarT</code></td>
<td>
<p>a character string indicating the time variable in the <code>coxph</code> object. Normally it is <code>NULL</code>. See <b>Note</b> and <b>Examples</b>.</p>
</td></tr>
<tr><td><code id="jmodelTM_+3A_control">control</code></td>
<td>
<p>a list of control values for the estimation algorithm with components:
</p>

<dl>
<dt>tol.P</dt><dd><p>tolerance value for convergence in the parameters with default value 1e-03. See <b>Details</b>.</p>
</dd>
<dt>tol.L</dt><dd><p>tolerance value for convergence in the log-likelihood with default value 1e-06. See <b>Details</b>.</p>
</dd>
<dt>max.iter</dt><dd><p>the maximum number of EM iterations with default value 250.</p>
</dd>
<dt>SE.method</dt><dd><p>a character string specifying the standard error estimation method. Default is <code>"PRES"</code>. See <b>Details</b> and <b>Note</b>.</p>
</dd>
<dt>delta</dt><dd><p>a positive value used for numerical differentiation in the <code>SE.method</code>. Default is 1e-05 if <code>"PRES"</code> is used and 1e-03 otherwise. See <b>Details</b>.</p>
</dd>
<dt>nknot</dt><dd><p>the number of Gauss-Hermite quadrature knots used to approximate the integrals over the random effects. Default is 9 and 7 for one- and two-dimensional integration, respectively, and 5 for those with higher dimensions.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="jmodelTM_+3A_...">...</code></td>
<td>
<p>additional options to be passed to the <code>control</code> argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>jmodelTM</code> function fits joint models for survival and longitudinal data. Linear mixed-effects models are assumed for the longitudinal processes. With the Cox proportional hazards model and the proportional odds model as special cases, a general class of transformation models are assumed for the survival processes. The baseline hazard functions are left unspecified, i.e. no parametric forms are assumed, thus leading to semiparametric models. For detailed model formulation, please refer to Xu, Baines and Wang (2014). 
</p>
<p>The longitudinal model is written as </p>
<p style="text-align: center;"><code class="reqn">Y_i(t)=\mu_i(t) + \varepsilon_i(t) = \mathbf{X}_i^\top(t)\boldsymbol\beta + \mathbf{Z}_i^\top(t)\mathbf{b}_i + \varepsilon_i(t).</code>
</p>
<p>, then the linear predictor for the survival model is expressed as </p>
<p style="text-align: center;"><code class="reqn">\eta(t) = \mathbf{W}_i^\top(t)\boldsymbol\phi + \alpha\mu_i(t),</code>
</p>
<p> indicating that the entire longitudinal process (free of error) enters the survival model as a covariate. If other values are assigned to the <code>model</code> argument, the linear predictor for the surival model is then expressed as </p>
<p style="text-align: center;"><code class="reqn">\eta(t) = \mathbf{W}_i^\top(t)\boldsymbol\phi + \alpha\mathbf{Z}_i^\top(t)\mathbf{b}_i,</code>
</p>
<p> suggesting that the survival and longitudinal models only share the same random effects.
</p>
<p>The survival model is written as </p>
<p style="text-align: center;"><code class="reqn">\Lambda(t|\eta(t)) = G\left[\int_0^t\exp{\eta(s)}d\Lambda_0(s)\right],</code>
</p>
<p> where <code class="reqn">G(x) = \log(1 + \rho x) / \rho</code> with <code class="reqn">\rho \geq 0</code> is the class of logarithmic transfomrations. If <code>rho = 0</code>, then <code class="reqn">G(x) = x</code>, yielding the Cox proportional hazards model. If <code>rho = 1</code>, then <code class="reqn">G(x) = \log(1 + x)</code>, yielding the proportional odds model. Users could assign any nonnegative real value to <code>rho</code>. 
</p>
<p>An expectation-maximization (EM) algorithm is implemented to obtain parameter estimates. The convergence criterion is either of (i) <code class="reqn">\max \{ | \boldsymbol\theta^{(t)} - \boldsymbol\theta^{(t - 1)} | / ( | \boldsymbol\theta^{(t - 1)} | + .Machine\$double.eps \times 2 ) \} &lt; tol.P</code>, or (ii) <code class="reqn">| L(\boldsymbol\theta^{(t)}) - L(\boldsymbol\theta^{(t - 1)})| / ( | L(\theta^{(t - 1)}) | + .Machine\$double.eps \times 2 ) &lt; tol.L</code>, is satisfied. Here <code class="reqn">\boldsymbol\theta^{(t)}</code> and <code class="reqn">\boldsymbol\theta^{(t-1)}</code> are the vector of parameter estimates at the <code class="reqn">t</code>-th and <code class="reqn">(t-1)</code>-th EM iterations, respectively; <code class="reqn">L(\boldsymbol\theta)</code> is the value of the log-likelihood function evaluated at <code class="reqn">\boldsymbol\theta</code>. Users could specify the tolerance values <code>tol.P</code> and <code>tol.L</code> through the <code>control</code> argument.
</p>
<p>For standard error estimation for the parameter estimates, three methods are provided, namely <code>"PRES"</code>, <code>"PFDS"</code> and <code>"PLFD"</code> (detailed information are referred to Xu, Baines and Wang (2014)). In the <code>control</code> argument, if <code>SE.method = "PRES"</code>, numerically differentiating the profile Fisher score vector with Richardson extrapolation is applied; if <code>SE.method = "PFDS"</code>, numerically differentiating the profile Fisher score vector with forward difference is applied; if <code>SE.method = "PLFD"</code>, numerially (second) differentiating the profile likelihood with forward difference is applied. Generally, numerically differentiating a function <code class="reqn">f(x)</code> (an arbitrary function) with forward difference is expressed as </p>
<p style="text-align: center;"><code class="reqn">f^\prime(x) = \frac{f(x + \delta) - f(x)}{\delta},</code>
</p>
<p> and that with Richardson extrapolation is expressed as </p>
<p style="text-align: center;"><code class="reqn">f^\prime(x) = \frac{f(x - 2\delta) - 8f(x - \delta) + 8f(x + \delta) - f(x + 2\delta)}{12\delta}.</code>
</p>
<p> Users could specify the value of <code class="reqn">\delta</code> through the <code>delta</code> item in the <code>control</code> argument.
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+jmodelTMObject">jmodelTMObject</a></code> for the components of the fit.
</p>


<h3>Note</h3>

<p>1. Currently, <code>jmodelTM()</code> could only handle the <code>fitLME</code> object with a simple random-effects structure (only the <code>pdDiag()</code> class). Moreover, the within-group correlation and heteroscedasticity structures in the <code>fitLME</code> object (i.e. the <code>correlation</code> and <code>weights</code> argument of <code>lme()</code>) are ignored.
</p>
<p>2. The <code>data</code> argument in <code>jmodelTM()</code>, <code>lme()</code> and <code>coxph()</code> should be the same data frame.
</p>
<p>3. For the <code>fitCOX</code> object, only the <code class="reqn">W_i(t)</code> in the linear predictor <code class="reqn">\eta(t)</code> for the survial model (see <b>Details</b>) should be involved in the <code>formula</code> argument of <code>coxph{}</code>. Since <code>coxph()</code> uses the same data frame as <code>lme()</code> does, a time-dependent Cox model must be fitted by <code>coxph()</code> although <code class="reqn">W_i(t)</code> may only contain time-independent covariates. See <b>Examples</b>.
</p>
<p>4. If <code class="reqn">W_i(t)</code> in the linear predictor <code class="reqn">\eta(t)</code> for the survial model (see <b>Details</b>) does involve time-dependent covariate, then <code>timeVarT</code> must specify the name of the time variable involved. See <b>Examples</b>.
</p>
<p>5. The standard error estimates are obtained by numerical approximations which is naturally subject to numerical errors. Therefore, in extreme cases, there may be <code>NA</code> values for part of the standard error estimates.
</p>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
Pantelis Z. Hadjipantelis <a href="mailto:pantelis@ucdavis.edu">pantelis@ucdavis.edu</a>
</p>


<h3>References</h3>

<p>Dabrowska, D. M. and Doksun K. A. (1988) Partial Likelihood in Transformation Models with Censored Data. <em>Scandinavian Journal of Statistics</em> <b>15</b>, 1&ndash;23.
</p>
<p>Tsiatis, A. A. and Davidian, M. (2004) Joint modeling of longitudinal and time-to-event data: an overview. <em>Statistica Sinica</em> <b>14</b>, 809&ndash;834.
</p>
<p>Wulfsohn, M. S. and Tsiatis, A. A. (1997) A joint model for survival and longitudinal data measured with error. <em>Biometrics</em> <b>53</b>, 330&ndash;339.
</p>
<p>Xu, C., Baines, P. D. and Wang, J. L. (2014) Standard error estimation using the EM algorithm for the joint modeling of survival and longitudinal data. <em>Biostatistics</em> <b>15</b>, 731&ndash;744.
</p>
<p>Xu, C., Hadjipantelis, P. Z. and Wang, J. L. (2020) Semiparametric joint modeling of survival and longitudinal data: the R package JSM. <em>Journal of Statistical Software</em> &lt;doi:10.18637/jss.v093.i02&gt;.
</p>
<p>Zeng, D. and Lin, D. (2007) Maximum likelihood estimation in semiparametric regression models with censored data. <em>Journal of the Royal Statistical Society: Series B</em> <b>69</b>, 507&ndash;564.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jmodelTMObject">jmodelTMObject</a></code>,
<code><a href="nlme.html#topic+lme">lme</a></code>,
<code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="survival.html#topic+Surv">Surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># linear mixed-effects model fit with random intercept
fitLME &lt;- lme(sqrt(CD4) ~ obstime + I(obstime ^ 2) + drug : obstime + drug : I(obstime ^ 2), 
              random = ~ 1 | ID, data = aids)
# Cox proportional hazards model fit with a single time-independent covariate
fitCOX &lt;- coxph(Surv(start, stop, event) ~ drug, data = aids, x = TRUE)

# joint model fit which assumes the Cox proportional hazards model for the survival process
# Use 'max.iter = 5', 'nknot = 3' and the 'PFDS' method to calculate standard 
# error estimates as a quick toy example 
fitJT.ph &lt;- jmodelTM(fitLME, fitCOX, aids, timeVarY = 'obstime', 
                     control = list(SE.method = 'PFDS', max.iter = 5, nknot = 3))
summary(fitJT.ph)

## Not run: 
# joint model fit with the default control
fitJT.ph2 &lt;- jmodelTM(fitLME, fitCOX, aids, timeVarY = 'obstime')
summary(fitJT.ph2)
# joint model fit where the survival and longitudinal processes only share 
# the same random effect
fitJT.ph3 &lt;- jmodelTM(fitLME, fitCOX, aids, model = 2, timeVarY = 'obstime')
summary(fitJT.ph3)

# joint model fit which assumes the proportional odds model for the survival process
fitJT.po &lt;- jmodelTM(fitLME, fitCOX, aids, rho = 1, timeVarY = 'obstime')
summary(fitJT.po)
# joint model fit where the survival and longitudinal processes only share 
# the same random effect
fitJT.po2 &lt;- jmodelTM(fitLME, fitCOX, aids, model = 2, rho = 1, timeVarY = 'obstime')
summary(fitJT.po2)

# linear mixed-effects model fit with random intercept and random slope
fitLME2 &lt;- lme(sqrt(CD4) ~ drug + obstime + I(obstime ^ 2) + drug : obstime + 
               drug : I(obstime ^2), random = ~ obstime | ID, data = aids)
# Cox proportional hazards model fit with a time-dependent covariate
fitCOX2 &lt;- coxph(Surv(start, stop, event) ~ drug + as.numeric(drug) : obstime, 
                 data = aids, x = TRUE)
# joint model fit in which \code{timeVarT} must be specified
fitJT.ph4 &lt;- jmodelTM(fitLME2, fitCOX2, aids, timeVarY = 'obstime', timeVarT = 'obstime')
summary(fitJT.ph4)

## End(Not run)
</code></pre>

<hr>
<h2 id='jmodelTMObject'>Fitted jmodelTM Object</h2><span id='topic+jmodelTMObject'></span>

<h3>Description</h3>

<p>An object returned by the <code>jmodelTM</code> function, inheriting from class <code>jmodelTM</code> and representing a fitted joint model for survival and longitudinal data. Objects of this class have methods for the generic functions <code>AIC</code>, <code>BIC</code>, <code>logLik</code>, <code>print</code>, <code>summary</code>, and <code>vcov</code>.
</p>


<h3>Value</h3>

<p>The following components must be included in a legitimate <code>jmodelTM</code> object.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a list with the estimated parameters. The list is consist of the following components:</p>
</td></tr>
</table>

<dl>
<dt>beta</dt><dd><p>the vector of estimated coefficients for the fixed effects in the linear mixed-effects model.</p>
</dd>
<dt>phi</dt><dd><p>the vector of estimated coefficients for the covariates other than the covariate associated with the longitudinal process in the survival model.</p>
</dd>
<dt>alpha</dt><dd><p>the estimated coefficient for the covariate associated with the longitudinal process in the survival model.</p>
</dd>
<dt>Ysigma</dt><dd><p>the estimated measurement error standard deviation for the linear mixed-effects model.</p>
</dd>
<dt>BSigma</dt><dd><p>the estimated variance-covariance matrix of the random effects.</p>
</dd>
<dt>lamb</dt><dd><p>a numeric matrix with two columns: the first column contains the unique observed survival times in ascending order; the second column contains the corresponding estimated baseline hazard values.</p>
</dd>
</dl>

<table>
<tr><td><code>Vcov</code></td>
<td>
<p>the variance-covariance matrix evaluated at the estimated parameter values.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>the log-likelihood (the joint likelihood) value.</p>
</td></tr>
<tr><td><code>est.bi</code></td>
<td>
<p>the estimated values for the random effects</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>a list containing an image of the <code>jmodelTM</code> call that produced the object.</p>
</td></tr>
<tr><td><code>numIter</code></td>
<td>
<p>the number of iterations used in the EM algorithm.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>the convergence indicator: if <code>"failure"</code>, usually more iterations are required.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>the value of the <code>control</code> argument passed to <code>jmodelTM</code>.</p>
</td></tr>
<tr><td><code>time.SE</code></td>
<td>
<p>the CPU time used to compute the standard error estimates, i.e. the time use to compute the variance-covariance matrix for the parameter estimates.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>the total number of repeated measurements for the longitudinal outcome.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of sample units.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>the censoring indicator: 0 denotes censored survival time; 1 denotes observed survival time.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>the transformation parameter used for the survival model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
Pantelis Z. Hadjipantelis <a href="mailto:pantelis@ucdavis.edu">pantelis@ucdavis.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jmodelTM">jmodelTM</a></code>
</p>

<hr>
<h2 id='liver'>
Prednisone versus Placebo in Liver Cirrhosis Patients
</h2><span id='topic+liver'></span>

<h3>Description</h3>

<p>A randomized control trial in which both survival and longitudinal data were collected to examine the development of prothrombin index over time and its relationship with the survival outcome. 488 patients were randomly allocated to prednisone (251) or placebo (237) and followed until death or end of the study.
</p>


<h3>Format</h3>

<p>A data frame with 2968 observations on the following 9 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>patient ID, there are 488 patients in total.</p>
</dd>
<dt><code>Time</code></dt><dd><p>survival time, i.e. time to death or censoring.</p>
</dd>
<dt><code>death</code></dt><dd><p>death indicator: 0 denotes censoring; 1 denotes death.</p>
</dd>
<dt><code>obstime</code></dt><dd><p>time points at which the longitudinal measurements, i.e. prothrombin index, are recorded.</p>
</dd>
<dt><code>proth</code></dt><dd><p>prothrombin index measured at <code>obstime</code>.</p>
</dd>
<dt><code>Trt</code></dt><dd><p>treatment indicator with two levels: <code>placebo</code> and <code>prednisone</code>.</p>
</dd>
<dt><code>start</code></dt><dd><p>same with <code>obstime</code>, starting time of the interval which contains the time of the prothrombin index measurement.</p>
</dd>
<dt><code>stop</code></dt><dd><p>ending time of the interval which contains the time of the prothrombin index measurement.</p>
</dd>
<dt><code>event</code></dt><dd><p>event indicator suggesting whether the event-of-interest, i.e. death, happens in the interval given by <code>start</code> and <code>stop</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Andersen, P. K., Borgan O., Gill, R. D. and Kieding, N. (1993) <em>Statistical Models Based on Counting Processes</em>. New York: Springer.
</p>


<h3>References</h3>

<p>Henderson, R., Diggle, P. and Dobson, A. (2002) Identification and efficacy of longitudinal markers for survival. <em>Biostatistics</em> <b>3</b>, 33&ndash;50
</p>


<h3>See Also</h3>

<p><code><a href="#topic+liver.long">liver.long</a></code>,
<code><a href="#topic+liver.surv">liver.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(liver)
</code></pre>

<hr>
<h2 id='liver.long'>
Prednisone versus Placebo in Liver Cirrhosis Patients - Longitudinal Data
</h2><span id='topic+liver.long'></span>

<h3>Description</h3>

<p>A randomized control trial in which both survival and longitudinal data were collected to examine the development of prothrombin index over time and its relationship with the survival outcome. 488 patients were randomly allocated to prednisone (251) or placebo (237) and followed until death or end of the study. <code>liver.long</code> only contains the longitudinal data of the trial, with one row per prothrombin index measurement.
</p>


<h3>Format</h3>

<p>A data frame with 2968 observations on the following 3 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>patient ID, there are 488 patients in total.</p>
</dd>
<dt><code>obstime</code></dt><dd><p>time points at which the longitudinal measurements, i.e. prothrombin index, are recorded.</p>
</dd>
<dt><code>proth</code></dt><dd><p>prothrombin index measured at <code>obstime</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Andersen, P. K., Borgan O., Gill, R. D. and Kieding, N. (1993) <em>Statistical Models Based on Counting Processes</em>. New York: Springer.
</p>


<h3>References</h3>

<p>Henderson, R., Diggle, P. and Dobson, A. (2002) Identification and efficacy of longitudinal markers for survival. <em>Biostatistics</em> <b>3</b>, 33&ndash;50
</p>


<h3>See Also</h3>

<p><code><a href="#topic+liver">liver</a></code>,
<code><a href="#topic+liver.surv">liver.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(liver.long)
</code></pre>

<hr>
<h2 id='liver.surv'>
Prednisone versus Placebo in Liver Cirrhosis Patients - Survival Data
</h2><span id='topic+liver.surv'></span>

<h3>Description</h3>

<p>A randomized control trial in which both survival and longitudinal data were collected to examine the development of prothrombin index over time and its relationship with the survival outcome. 488 patients were randomly allocated to prednisone (251) or placebo (237) and followed until death or end of the study. <code>liver.surv</code> only contains the survival data of the trial, with one row per patient.
</p>


<h3>Format</h3>

<p>A data frame with 488 observations on the following 4 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>patient ID, there are 488 patients in total.</p>
</dd>
<dt><code>Time</code></dt><dd><p>survival time, i.e. time to death or censoring.</p>
</dd>
<dt><code>death</code></dt><dd><p>death indicator: 0 denotes censoring; 1 denotes death.</p>
</dd>
<dt><code>Trt</code></dt><dd><p>treatment indicator with two levels: <code>placebo</code> and <code>prednisone</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Andersen, P. K., Borgan O., Gill, R. D. and Kieding, N. (1993) <em>Statistical Models Based on Counting Processes</em>. New York: Springer.
</p>


<h3>References</h3>

<p>Henderson, R., Diggle, P. and Dobson, A. (2002) Identification and efficacy of longitudinal markers for survival. <em>Biostatistics</em> <b>3</b>, 33&ndash;50
</p>


<h3>See Also</h3>

<p><code><a href="#topic+liver">liver</a></code>,
<code><a href="#topic+liver.long">liver.long</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(liver.surv)
</code></pre>

<hr>
<h2 id='pbc'>
Mayo Clinic Primary Biliary Cirrhosis Data
</h2><span id='topic+pbc'></span>

<h3>Description</h3>

<p>A randomized control trial from Mayo Clinic in which both survival and longitudinal data were collected from 1974 to 1984 to study the progression of primary biliary cirrhosis.
</p>


<h3>Format</h3>

<p>A data frame with 1945 observations on the following 16 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>patient ID, there are 312 patients in total.</p>
</dd>
<dt><code>Time</code></dt><dd><p>survival time (in years), i.e. time to death, transplantion or censoring.</p>
</dd>
<dt><code>death</code></dt><dd><p>death indicator: 0 denotes transplantion or censoring; 1 denotes death.</p>
</dd>
<dt><code>obstime</code></dt><dd><p>time points at which the longitudinal measurements, e.g. serum bilirubin, albumin and alkaline phosphatase, are recorded.</p>
</dd>
<dt><code>serBilir</code></dt><dd><p>serum bilirubin measured at <code>obstime</code> (mg/dl).</p>
</dd>
<dt><code>albumin</code></dt><dd><p>albumin measured at <code>obstime</code> (gm/dl).</p>
</dd>
<dt><code>alkaline</code></dt><dd><p>alkaline phosphatase measured at <code>obstime</code> (U/litter).</p>
</dd>
<dt><code>platelets</code></dt><dd><p>platelets per cubic measured at <code>obstime</code> (ml/1000).</p>
</dd>
<dt><code>drug</code></dt><dd><p>drug indicator with two levels: <code>placebo</code> and <code>D-penicil</code>.</p>
</dd>
<dt><code>age</code></dt><dd><p>age of patient at study entry.</p>
</dd>
<dt><code>gender</code></dt><dd><p>gender indicator with two levels: <code>male</code> and <code>female</code>.</p>
</dd>
<dt><code>ascites</code></dt><dd><p>ascites indicator with two levels: <code>No</code> and <code>Yes</code>.</p>
</dd>
<dt><code>hepatom</code></dt><dd><p>hepatomegaly indicator with two levels: <code>No</code> and <code>Yes</code>.</p>
</dd>
<dt><code>start</code></dt><dd><p>same with <code>obstime</code>, starting time of the interval which contains the time of the logitudinal measurements.</p>
</dd>
<dt><code>stop</code></dt><dd><p>ending time of the interval which contains the time of the longitudinal measurements.</p>
</dd>
<dt><code>event</code></dt><dd><p>event indicator suggesting whether the event-of-interest, i.e. death, happens in the interval given by <code>start</code> and <code>stop</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://lib.stat.cmu.edu/datasets/pbcseq">http://lib.stat.cmu.edu/datasets/pbcseq</a>
</p>
<p>Fleming, T. and Harrington, D. (1991) <em>Counting Processes and Survival Analysis</em>. Wiley, New York.
</p>


<h3>References</h3>

<p>Murtaugh, P. A., Dickson, E. R., Van Dam, G. M., Malincho, M., Grambsch, P. M., Langworthy, A. L., and Gips, C. H. (1994) Primary biliary cirrhosis: Prediction of short-term survival based on repeated patient visits. <em>Hepatology</em> <b>20</b>, 126&ndash;134.
</p>
<p>Therneau, T. and Grambsch, P. (2000) <em>Modeling Survival Data: Extending the Cox Model</em>. New York: Springer.
</p>
<p>Ding, J. and Wang, J. L. (2008) Modeling longitudinal data with nonparametric multiplicative random effects jointly with survival data. <em>Biometrics</em> <b>64</b>, 546&ndash;556.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(pbc)
</code></pre>

<hr>
<h2 id='ranef'>Extract Random Effects for Joint Models</h2><span id='topic+ranef.jmodelTM'></span><span id='topic+ranef.jmodelMult'></span>

<h3>Description</h3>

<p><code>ranef</code> is a generic function which extracts random effects from objects returned by <code>jmodelTM()</code> or <code>jmodelMult()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jmodelTM'
ranef(object, ...)
## S3 method for class 'jmodelMult'
ranef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>jmodelTM</code> or <code>jmodelMult</code>.</p>
</td></tr>
<tr><td><code id="ranef_+3A_...">...</code></td>
<td>
<p>additional arguments required. None is used in this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix with rows denoting the subjects and columns the random effects. 
</p>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fitLME &lt;- lme(proth ~ Trt * obstime, random = ~ 1 | ID, data = liver)
fitCOX &lt;- coxph(Surv(start, stop, event) ~ Trt, data = liver, x = TRUE)
fitJT.ph &lt;- jmodelTM(fitLME, fitCOX, liver, timeVarY = 'obstime')

# random effect for the joint model
ranef(fitJT.ph)

## End(Not run)
</code></pre>

<hr>
<h2 id='residuals'>Extract Residuals for Joint Models</h2><span id='topic+residuals.jmodelTM'></span><span id='topic+residuals.jmodelMult'></span>

<h3>Description</h3>

<p><code>residuals</code> is a generic function which extracts residuals from objects returned by <code>jmodelTM()</code> or <code>jmodelMult()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jmodelTM'
residuals(object, process = c("Longitudinal", "Survival"), 
            type = c("Marginal", "Conditional", "Standardized-Marginal", 
            "Standardized-Conditional"), ...)
## S3 method for class 'jmodelMult'
residuals(object, process = c("Longitudinal", "Survival"), 
            type = c("Marginal", "Conditional", "Standardized-Marginal", 
            "Standardized-Conditional"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>jmodelTM</code> or <code>jmodelMult</code>.</p>
</td></tr>
<tr><td><code id="residuals_+3A_process">process</code></td>
<td>
<p>for which process the residuals are calculated, i.e. the longitudinal or the survival process.</p>
</td></tr>
<tr><td><code id="residuals_+3A_type">type</code></td>
<td>
<p>what type of residuals to calculate for each process. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="residuals_+3A_...">...</code></td>
<td>
<p>additional arguments required. None is used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We have implemented the residual calculation for <code>process = "Longitudinal"</code> but not for <code>process = "Survival"</code> yet as they are not well defined under the joint modeling setting. There are four types of residuals depending on whether to compute the values conditional on the random effects and whether to standardize the residuals. Please refer to Nobre and Single (2007) for details. 
</p>
<p>With <code>type = "Marginal"</code>, the residuals are <code class="reqn">\varepsilon_{ij} = Y_{ij} - \mathbf{X}_{ij}^\top\boldsymbol\beta</code> for objects returned by <code>jmodelTM()</code> and <code class="reqn">\varepsilon_{ij} = Y_{ij} - \mathbf{B}^\top(t_{ij})\boldsymbol\gamma</code> for objects returned by <code>jmodelMult()</code>. With <code>type = "Conditional"</code>, the residuals are <code class="reqn">\varepsilon_{ij} = Y_{ij} - \mathbf{X}_{ij}^\top\boldsymbol\beta - \mathbf{Z}_{ij}^\top\mathbf{b}_i</code> for objects returned by <code>jmodelTM()</code> and <code class="reqn">\varepsilon_{ij} = Y_{ij} - b_i\times\mathbf{B}^\top(t_{ij})\boldsymbol\gamma</code> for objects returned by <code>jmodelMult()</code>. If <code>type = "Standardized-Marginal"</code> or <code>type = "Standardized-Conditional"</code>, the above defined residuals are divided by the estimated standard deviation of the corresponding error term.
</p>


<h3>Value</h3>

<p>A numerc vector of residual values.
</p>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:helenxu1112@gmail.com">helenxu1112@gmail.com</a>
</p>


<h3>References</h3>

<p>Nobre, J. S. and Singer, J. M. (2007) Residuals analysis for linear mixed models. <em>Biometrical Jounral</em> <b>49</b>(6), 863&ndash;875.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitted.jmodelTM">fitted.jmodelTM</a></code>, 
<code><a href="#topic+fitted.jmodelMult">fitted.jmodelMult</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fitLME &lt;- lme(proth ~ Trt * obstime, random = ~ 1 | ID, data = liver)
fitCOX &lt;- coxph(Surv(start, stop, event) ~ Trt, data = liver, x = TRUE)
fitJT.ph &lt;- jmodelTM(fitLME, fitCOX, liver, timeVarY = 'obstime')

# residuals for the longitudinal process
residuals(fitJT.ph, type = "Standardized-Conditional")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
