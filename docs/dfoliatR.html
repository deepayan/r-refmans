<!DOCTYPE html><html><head><title>Help for package dfoliatR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dfoliatR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as_defol'><p>Cast data frame to list-like <code>defol</code> object</p></a></li>
<li><a href='#as_obr'><p>Cast data frame to list-like <code>obr</code> object</p></a></li>
<li><a href='#as.defol'><p>Alias to <code>as_defol()</code></p></a></li>
<li><a href='#as.obr'><p>Alias to <code>as_obr()</code></p></a></li>
<li><a href='#defol'><p>Constructor for S3 defol class</p></a></li>
<li><a href='#defol_stats'><p>Descriptive statistics for defoliation trees</p></a></li>
<li><a href='#defoliate_trees'><p>Identify defoliation events in host trees</p></a></li>
<li><a href='#dmj_defol'><p>Demi John dfol object</p></a></li>
<li><a href='#dmj_h'><p>Demi John Douglas-fir</p></a></li>
<li><a href='#dmj_nh'><p>Demi John area ponderosa pine</p></a></li>
<li><a href='#dmj_obr'><p>Demi John outbreak object</p></a></li>
<li><a href='#efk_defol'><p>East Fork defol object</p></a></li>
<li><a href='#efk_h'><p>East Fork Jemez River Douglas-fir</p></a></li>
<li><a href='#efk_nh'><p>Baca ponderosa pine chronology</p></a></li>
<li><a href='#efk_obr'><p>East Fork outbreak object</p></a></li>
<li><a href='#get_defol_events'><p>Defoliation event list</p></a></li>
<li><a href='#gsi'><p>Calculate the growth suppression index</p></a></li>
<li><a href='#id_defoliation'><p>Identify defoliation events in a host series</p></a></li>
<li><a href='#is.defol'><p>Check if object is tree-level defoliation object: <code>defol</code></p></a></li>
<li><a href='#is.obr'><p>Check if object is outbreak, meaning site-level outbreak object</p></a></li>
<li><a href='#obr'><p>Constructor for an <code>obr</code> object.</p></a></li>
<li><a href='#outbreak'><p>Composite defoliation series to determine outbreak events</p></a></li>
<li><a href='#outbreak_stats'><p>Outbreak statistics</p></a></li>
<li><a href='#plot_defol'><p>Produce a Gantt plot of individual tree-ring series to show defoliation</p>
events in time</a></li>
<li><a href='#plot_outbreak'><p>Produce a stacked plot to present composited, site-level insect outbreak</p>
chronologies</a></li>
<li><a href='#plot.defol'><p>Plot a <code>defol</code> object</p></a></li>
<li><a href='#sample_depth'><p>Calculate the sample depth of a defol object</p></a></li>
<li><a href='#series_names'><p>Extract series names from a defol object</p></a></li>
<li><a href='#stack_defoliation'><p>Stack a defoliation list</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Detection and Analysis of Insect Defoliation Signals in Tree
Rings</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to identify, quantify, analyze, and visualize growth
    suppression events in tree rings that are often produced by insect
    defoliation. Described in Guiterman et al. (2020) &lt;<a href="https://doi.org/10.1016%2Fj.dendro.2020.125750">doi:10.1016/j.dendro.2020.125750</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://chguiterman.github.io/dfoliatR/">https://chguiterman.github.io/dfoliatR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/chguiterman/dfoliatR/issues">https://github.com/chguiterman/dfoliatR/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, vdiffr, knitr, rmarkdown</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplR, dplyr, forcats, ggplot2, ggpubr, magrittr, purrr, rlang,
stats, tidyr, glue, tibble</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-09 20:01:53 UTC; chris</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris Guiterman <a href="https://orcid.org/0000-0002-9706-9332"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ann Lynch <a href="https://orcid.org/0000-0002-8043-3855"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Jodi Axelson <a href="https://orcid.org/0000-0002-1799-6364"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris Guiterman &lt;christopher.guiterman@noaa.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-09 22:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as_defol'>Cast data frame to list-like <code>defol</code> object</h2><span id='topic+as_defol'></span>

<h3>Description</h3>

<p>Cast data frame to list-like <code>defol</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_defol(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_defol_+3A_x">x</code></td>
<td>
<p>A data frame or list-like object to cast. Must have named elements
for &quot;year&quot;, &quot;series&quot;, &quot;gsi&quot;, &quot;ngsi&quot;, and &quot;defol_status&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> cast to a <code>defol</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmj_defol)
example_data &lt;- as.data.frame(dmj_defol)
is.defol(example_data)
back_to_defol &lt;- as_defol(example_data)
is.defol(back_to_defol)

</code></pre>

<hr>
<h2 id='as_obr'>Cast data frame to list-like <code>obr</code> object</h2><span id='topic+as_obr'></span>

<h3>Description</h3>

<p>Cast data frame to list-like <code>obr</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_obr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_obr_+3A_x">x</code></td>
<td>
<p>A data frame or list-like object to cast. Must have named elements
for &quot;year&quot;, &quot;samp_depth&quot;, &quot;num_defol&quot;, &quot;perc_defol&quot;, &quot;num_max_defol&quot;,
&quot;perc_max_defol&quot;, &quot;mean_gsi&quot;, &quot;mean_ngsi&quot;, &quot;outbreak_status&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> cast to an <code>obr</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmj_obr)
example_data &lt;- as.data.frame(dmj_obr)
is.obr(example_data)
back_to_obr &lt;- as_obr(example_data)
is.obr(back_to_obr)

</code></pre>

<hr>
<h2 id='as.defol'>Alias to <code><a href="#topic+as_defol">as_defol()</a></code></h2><span id='topic+as.defol'></span>

<h3>Description</h3>

<p>Alias to <code><a href="#topic+as_defol">as_defol()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.defol(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.defol_+3A_x">x</code></td>
<td>
<p>A data frame or list-like object to cast. Must have named elements
for &quot;year&quot;, &quot;series&quot;, &quot;gsi&quot;, &quot;ngsi&quot;, and &quot;defol_status&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> cast to a <code>defol</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmj_defol)
example_data &lt;- as.data.frame(dmj_defol)
is.defol(example_data)
back_to_defol &lt;- as_defol(example_data)
is.defol(back_to_defol)

</code></pre>

<hr>
<h2 id='as.obr'>Alias to <code><a href="#topic+as_obr">as_obr()</a></code></h2><span id='topic+as.obr'></span>

<h3>Description</h3>

<p>Alias to <code><a href="#topic+as_obr">as_obr()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.obr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.obr_+3A_x">x</code></td>
<td>
<p>A data frame or list-like object to cast. Must have named elements
for &quot;year&quot;, &quot;samp_depth&quot;, &quot;num_defol&quot;, &quot;perc_defol&quot;, &quot;num_max_defol&quot;,
&quot;perc_max_defol&quot;, &quot;mean_gsi&quot;, &quot;mean_ngsi&quot;, &quot;outbreak_status&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> cast to an <code>obr</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmj_obr)
example_data &lt;- as.data.frame(dmj_obr)
is.obr(example_data)
back_to_obr &lt;- as_obr(example_data)
is.obr(back_to_obr)

</code></pre>

<hr>
<h2 id='defol'>Constructor for S3 defol class</h2><span id='topic+defol'></span>

<h3>Description</h3>

<p>Constructor for S3 defol class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defol(year, series, gsi, ngsi, defol_status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="defol_+3A_year">year</code></td>
<td>
<p>An n-length integer vector of observation years</p>
</td></tr>
<tr><td><code id="defol_+3A_series">series</code></td>
<td>
<p>An n-length factor or character vector of series names</p>
</td></tr>
<tr><td><code id="defol_+3A_gsi">gsi</code></td>
<td>
<p>An n-length numeric vector of growth suppression index, such as
calculated by <code><a href="#topic+gsi">gsi()</a></code></p>
</td></tr>
<tr><td><code id="defol_+3A_ngsi">ngsi</code></td>
<td>
<p>An n-length numeric vector of normalized gsi, such as calculated
by <code><a href="#topic+gsi">gsi()</a></code>.</p>
</td></tr>
<tr><td><code id="defol_+3A_defol_status">defol_status</code></td>
<td>
<p>An n-length factor or character vector denoting the
defoliation event status of each year. This uses a controlled vocabulary,
see <code>dfoliatR:::make_defol_status</code> for possible values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tree-level <code>defol</code> object
</p>

<hr>
<h2 id='defol_stats'>Descriptive statistics for defoliation trees</h2><span id='topic+defol_stats'></span>

<h3>Description</h3>

<p>Descriptive statistics for defoliation trees
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defol_stats(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="defol_stats_+3A_x">x</code></td>
<td>
<p>A defol object after running <code><a href="#topic+defoliate_trees">defoliate_trees()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing tree/series-level statistics.
</p>


<h3>Note</h3>

<p>If series-end-events are present, they are omitted from calculations of
total event years and mean duration.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dmj_defol")
defol_stats(dmj_defol)


</code></pre>

<hr>
<h2 id='defoliate_trees'>Identify defoliation events in host trees</h2><span id='topic+defoliate_trees'></span>

<h3>Description</h3>

<p><code><a href="#topic+defoliate_trees">defoliate_trees()</a></code> is the starting point for most analyses of insect
defoliation signals preserved in the growth patterns of trees. It requires
individual-tree standardized measurements from potential host trees and a
tree-ring chronology from a nearby non-host species. First,
<code><a href="#topic+defoliate_trees">defoliate_trees()</a></code> combines these tree-ring indices by calling <code><a href="#topic+gsi">gsi()</a></code> to
perform a &quot;correction&quot; of the host-tree indices to remove the climatic
influences on tree growth as represented by the non-host chronology. This
should isolate a disturbance-related signal. Second, <code><a href="#topic+defoliate_trees">defoliate_trees()</a></code>, runs
<code><a href="#topic+id_defoliation">id_defoliation()</a></code>, which completes a runs analyses to evaluate sequences of
negative departures in the host tree growth series (<code>ngsi</code>) for potential
defoliation events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defoliate_trees(
  host_tree,
  nonhost_chron = NULL,
  duration_years = 8,
  max_reduction = -1.28,
  bridge_events = FALSE,
  series_end_event = FALSE,
  list_output = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="defoliate_trees_+3A_host_tree">host_tree</code></td>
<td>
<p>A <code>dplR::rwl</code> object containing the tree-level growth series
for all host trees to be compared to the non-host chronology.</p>
</td></tr>
<tr><td><code id="defoliate_trees_+3A_nonhost_chron">nonhost_chron</code></td>
<td>
<p>A <code>dplR::rwl</code> object containing a single non-host
chronology. If blank, defoliation events will be inferred on the host_tree
series as provided. It is incumbent on the user to ensure the host_tree
series are properly prepared for analyses when there is no nonhost_chron
provided.</p>
</td></tr>
<tr><td><code id="defoliate_trees_+3A_duration_years">duration_years</code></td>
<td>
<p>The minimum length of time in which the tree is
considered to be in defoliation.</p>
</td></tr>
<tr><td><code id="defoliate_trees_+3A_max_reduction">max_reduction</code></td>
<td>
<p>The minimum value of <code>ngsi</code> required to be considered a
defoliation event. If a sequence of negative ngsi values does not reach
this threshold, the potential event is rejected. Defaults to -1.28.</p>
</td></tr>
<tr><td><code id="defoliate_trees_+3A_bridge_events">bridge_events</code></td>
<td>
<p>Binary, defaults to <code>FALSE</code>. This option allows for
successive events that are separated by a single year to be bridged and
become one event. It should be used cautiously and closely evaluated to
ensure the likelihood that the two (or more) events are actually one long
event.</p>
</td></tr>
<tr><td><code id="defoliate_trees_+3A_series_end_event">series_end_event</code></td>
<td>
<p>Binary, defaults to <code>FALSE</code>. This option allows the
user to identify an event occurring at the time of sampling as a
defoliation event, regardless of duration. Including it will help to
quantify periodicity and extent of an outbreak. This should only be used if
the user has direct knowledge of an ongoing defoliation event when the
trees were sampled.</p>
</td></tr>
<tr><td><code id="defoliate_trees_+3A_list_output">list_output</code></td>
<td>
<p>Defaults to <code>FALSE</code>. This option is to output a long list
object containing a separate data.frame for each series in <code>host_tree</code> that
includes the input series and the <code>nonhost_chron</code>, the corrected series, and
the character string identifying the defoliation events.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>By default this returns a long-form data frame of tree-level growth
suppression indices and identified defoliation events. If <code>list_output = TRUE</code>, it returns a list object with each element containing a data.frame
rwl object of the host and non-host series, plus the outputs from <code><a href="#topic+gsi">gsi()</a></code>.
The list object is useful for assessing the effects of running <code><a href="#topic+gsi">gsi()</a></code> on
the host and nonhost data.
</p>


<h3>Note</h3>

<p>Other functions in <code>dfoliatR</code>, like <code><a href="#topic+outbreak">outbreak()</a></code> and <code><a href="#topic+plot_defol">plot_defol()</a></code>,
require a long-form data frame identifiable as a <code><a href="#topic+defol">defol()</a></code> object. Selecting
<code>list_output = TRUE</code> will trigger errors in running other functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load host and non-host data
data("dmj_h") # Host trees
data("dmj_nh") # Non-host chronology

dmj_defol &lt;- defoliate_trees(dmj_h, dmj_nh)


</code></pre>

<hr>
<h2 id='dmj_defol'>Demi John dfol object</h2><span id='topic+dmj_defol'></span>

<h3>Description</h3>

<p>Produced by running <code>defoliate_trees(dmj_h, dmj_nh, series_end_events=TRUE)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmj_defol
</code></pre>


<h3>Format</h3>

<p>A <code>defol</code> object with 4267 rows and 5 columns
</p>

<hr>
<h2 id='dmj_h'>Demi John Douglas-fir</h2><span id='topic+dmj_h'></span>

<h3>Description</h3>

<p>Western spruce budworm host series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmj_h
</code></pre>


<h3>Format</h3>

<p>An <code>rwl</code> object with 17 tree-level series, standardized in ARSTAN.
Dates range from 1620-1997.
</p>

<hr>
<h2 id='dmj_nh'>Demi John area ponderosa pine</h2><span id='topic+dmj_nh'></span>

<h3>Description</h3>

<p>Non-host pair to Demi John Douglas-fir <code>dmj_h</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmj_nh
</code></pre>


<h3>Format</h3>

<p>An <code>rwl</code> object with 1 series, 1675-1997.
</p>

<hr>
<h2 id='dmj_obr'>Demi John outbreak object</h2><span id='topic+dmj_obr'></span>

<h3>Description</h3>

<p>Produced by running <code>outbreak(dmj_defol)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmj_obr
</code></pre>


<h3>Format</h3>

<p>An object of class <code>obr</code> (inherits from <code>data.frame</code>) with 323 rows and 9 columns.
</p>


<h3>Details</h3>

<p>@format An <code>outbreak</code> object with 323 rows and 9 columns
</p>

<hr>
<h2 id='efk_defol'>East Fork defol object</h2><span id='topic+efk_defol'></span>

<h3>Description</h3>

<p>Produced by running <code>defoliate_trees(efk_h, efk_nh, series_end_event = TRUE)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>efk_defol
</code></pre>


<h3>Format</h3>

<p>A <code>defol</code> object with 5142 rows and 5 columns
</p>

<hr>
<h2 id='efk_h'>East Fork Jemez River Douglas-fir</h2><span id='topic+efk_h'></span>

<h3>Description</h3>

<p>Western spruce budworm host series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>efk_h
</code></pre>


<h3>Format</h3>

<p>An <code>rwl</code> object with 37 tree-level series, standardized in ARSTAN.
Dates range from 1776-1987.
</p>


<h3>References</h3>

<p>Swetnam, T.W., Lynch, A.M., 1993. Multicentury, Regional-Scale
Patterns of Western Spruce Budworm Outbreaks. Ecological Monographs 63,
399–424. https://doi.org/10.2307/2937153
</p>

<hr>
<h2 id='efk_nh'>Baca ponderosa pine chronology</h2><span id='topic+efk_nh'></span>

<h3>Description</h3>

<p>Non-host pair chronology for East Fork Douglas-fir <code>efk_h</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>efk_nh
</code></pre>


<h3>Format</h3>

<p>An <code>rwl</code> chronology object with 1 series, 1612-1987. Standardized in
ARSTAN.
</p>


<h3>Source</h3>

<p><a href="https://www.ncei.noaa.gov/access/paleo-search/study/5068">https://www.ncei.noaa.gov/access/paleo-search/study/5068</a>
</p>


<h3>References</h3>

<p>Swetnam, T.W., Lynch, A.M., 1993. Multicentury, Regional-Scale
Patterns of Western Spruce Budworm Outbreaks. Ecological Monographs 63,
399–424. https://doi.org/10.2307/2937153
</p>

<hr>
<h2 id='efk_obr'>East Fork outbreak object</h2><span id='topic+efk_obr'></span>

<h3>Description</h3>

<p>Produced by running <code>outbreak(efk_defol)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>efk_obr
</code></pre>


<h3>Format</h3>

<p>An <code>outbreak</code> object with 221 rows and 9 columns
</p>

<hr>
<h2 id='get_defol_events'>Defoliation event list</h2><span id='topic+get_defol_events'></span>

<h3>Description</h3>

<p>Defoliation event list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_defol_events(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_defol_events_+3A_x">x</code></td>
<td>
<p>a <code>defol</code> object</p>
</td></tr>
</table>

<hr>
<h2 id='gsi'>Calculate the growth suppression index</h2><span id='topic+gsi'></span>

<h3>Description</h3>

<p>This function removes the nonhost growth signal from a host tree-ring series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gsi(input_series)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gsi_+3A_input_series">input_series</code></td>
<td>
<p>A <code>dplr::rwl</code> object with the host tree series as the
first column and the non-host chronology as the second. Years should be the
row names. This is specifically created by <code><a href="#topic+defoliate_trees">defoliate_trees()</a></code> and
passed to <code><a href="#topic+gsi">gsi()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The growth suppression index (GSI) is referred to as the &quot;corrected&quot;
series in OUTBREAK. It is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">GSI(i) = H(i) - (NH(i) - mean(NH)) sd(H)/sd(NH)</code>
</p>

<p>where H and NH are the host and nonhost tree-ring series as standardized
index values; i is the year, and the functions <code><a href="base.html#topic+mean">mean()</a></code> and <code><a href="stats.html#topic+sd">sd()</a></code> are
applied to the common period.
</p>
<p><code><a href="#topic+gsi">gsi()</a></code> will rarely be run directly by a user. It is called from
<code><a href="#topic+defoliate_trees">defoliate_trees()</a></code>.
</p>


<h3>Value</h3>

<p>A data frame with the two input columns (host and nonhost series) and
3 added columns:
</p>
 <ol>
<li><p> The mean/sd adjusted non-host chronology, </p>
</li>
<li><p> The
growth suppression index (&quot;gsi&quot;) of the host series after subtraction of
the adjusted nonhost chronology, </p>
</li>
<li><p> The normalized growth suppression
index (&quot;ngsi&quot;) generated by applying <code><a href="base.html#topic+scale">scale()</a></code> to the gsi. </p>
</li></ol>


<hr>
<h2 id='id_defoliation'>Identify defoliation events in a host series</h2><span id='topic+id_defoliation'></span>

<h3>Description</h3>

<p>After calculating the growth suppression index in <code><a href="#topic+gsi">gsi()</a></code>, <code><a href="#topic+id_defoliation">id_defoliation()</a></code>
performs a runs analysis on the normalized growth suppression index, or
<code>ngsi</code>, in which sequences of negative departures are assessed as possible
defoliation events. <code><a href="#topic+id_defoliation">id_defoliation()</a></code> is the workhorse for
<code><a href="#topic+defoliate_trees">defoliate_trees()</a></code>, performing much of the necessary criteria evaluation
used in OUTBREAK. The defaults for most parameters originate from OUTBREAK.
Two new features distinguish the <code>dfoliatR</code> version: bridging events that
occur in close sequence and allowing for the recent end of a series to be
evaluated for defoliation regardless of the event duration. See parameter
specifics for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>id_defoliation(
  input_series,
  duration_years = 8,
  max_reduction = -1.28,
  bridge_events = FALSE,
  series_end_event = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="id_defoliation_+3A_input_series">input_series</code></td>
<td>
<p>A data frame with 5 columns, as generated by <code><a href="#topic+gsi">gsi()</a></code>.</p>
</td></tr>
<tr><td><code id="id_defoliation_+3A_duration_years">duration_years</code></td>
<td>
<p>The minimum length of time in which the tree is
considered to be in defoliation.</p>
</td></tr>
<tr><td><code id="id_defoliation_+3A_max_reduction">max_reduction</code></td>
<td>
<p>The minimum value of <code>ngsi</code> required to be considered a
defoliation event. If a sequence of negative ngsi values does not reach
this threshold, the potential event is rejected. Defaults to -1.28.</p>
</td></tr>
<tr><td><code id="id_defoliation_+3A_bridge_events">bridge_events</code></td>
<td>
<p>Binary, defaults to <code>FALSE</code>. This option allows for
successive events that are separated by a single year to be bridged and
become one event. It should be used cautiously and closely evaluated to
ensure the likelihood that the two (or more) events are actually one long
event.</p>
</td></tr>
<tr><td><code id="id_defoliation_+3A_series_end_event">series_end_event</code></td>
<td>
<p>Binary, defaults to <code>FALSE</code>. This option allows the
user to identify an event occurring at the time of sampling as a
defoliation event, regardless of duration. Including it will help to
quantify periodicity and extent of an outbreak. This should only be used if
the user has direct knowledge of an ongoing defoliation event when the
trees were sampled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>After performing runs analyses, the function adds a column to the
input data frame that distinguishes years of defoliation and the maximum
defoliation year (ie. the year the greatest negative growth departure
within the event).
</p>


<h3>Note</h3>

<p><code><a href="#topic+id_defoliation">id_defoliation()</a></code> is called by <code><a href="#topic+defoliate_trees">defoliate_trees()</a></code>. It might only be
used by the user for troubleshooting.
</p>

<hr>
<h2 id='is.defol'>Check if object is tree-level defoliation object: <code>defol</code></h2><span id='topic+is.defol'></span>

<h3>Description</h3>

<p>Check if object is tree-level defoliation object: <code>defol</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.defol(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.defol_+3A_x">x</code></td>
<td>
<p>Any R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean indicating whether <code>x</code> is a defol object.
</p>

<hr>
<h2 id='is.obr'>Check if object is outbreak, meaning site-level outbreak object</h2><span id='topic+is.obr'></span>

<h3>Description</h3>

<p>Check if object is outbreak, meaning site-level outbreak object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.obr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.obr_+3A_x">x</code></td>
<td>
<p>Any R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean indicating whether <code>x</code> is an outbreak object.
</p>

<hr>
<h2 id='obr'>Constructor for an <code>obr</code> object.</h2><span id='topic+obr'></span>

<h3>Description</h3>

<p>Constructor for an <code>obr</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obr(
  year,
  samp_depth,
  num_defol,
  perc_defol,
  num_max_defol,
  perc_max_defol,
  mean_gsi,
  mean_ngsi,
  outbreak_status
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="obr_+3A_year">year</code></td>
<td>
<p>An n-length numeric vector of observed years.</p>
</td></tr>
<tr><td><code id="obr_+3A_samp_depth">samp_depth</code></td>
<td>
<p>An n-length numeric vector of the number of trees.</p>
</td></tr>
<tr><td><code id="obr_+3A_num_defol">num_defol</code></td>
<td>
<p>An n-length numeric vector of the number of trees
experiencing defoliation.</p>
</td></tr>
<tr><td><code id="obr_+3A_perc_defol">perc_defol</code></td>
<td>
<p>An n-length numeric vector of the percent of trees
experiencing defoliation.</p>
</td></tr>
<tr><td><code id="obr_+3A_num_max_defol">num_max_defol</code></td>
<td>
<p>An n-length numeric vector of the number of trees
experiencing their maximum level of defoliation (i.e., their most extreme
negative growth departure).</p>
</td></tr>
<tr><td><code id="obr_+3A_perc_max_defol">perc_max_defol</code></td>
<td>
<p>An n-length numeric vector of the percent of trees
experiencing their maximum level of defoliation (i.e., their most extreme
negative growth departure).</p>
</td></tr>
<tr><td><code id="obr_+3A_mean_gsi">mean_gsi</code></td>
<td>
<p>An n-length numeric vector of the average growth suppression
index across all observed trees.</p>
</td></tr>
<tr><td><code id="obr_+3A_mean_ngsi">mean_ngsi</code></td>
<td>
<p>An n-length numeric vector of the average normalized
(scaled) growth suppression index.</p>
</td></tr>
<tr><td><code id="obr_+3A_outbreak_status">outbreak_status</code></td>
<td>
<p>An n-length factor or character vector that identified
whether that year surpasses the designated thresholds for an &quot;outbreak
event&quot;. Threshold criteria are provided in <code><a href="#topic+outbreak">outbreak()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>obr</code> object with columns matching the input variables.
</p>

<hr>
<h2 id='outbreak'>Composite defoliation series to determine outbreak events</h2><span id='topic+outbreak'></span>

<h3>Description</h3>

<p><code><a href="#topic+outbreak">outbreak()</a></code> takes a <code>defol</code> object from
<code><a href="#topic+defoliate_trees">defoliate_trees()</a></code> and composites it into a site-level object.
Function parameters allow the user to filter the tree-level series in various
ways to optimize thresholds of what constitutes an &quot;outbreak&quot; level event
recorded by the host trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outbreak(x, filter_perc = 25, filter_min_series = 3, filter_min_defol = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outbreak_+3A_x">x</code></td>
<td>
<p>a defol object</p>
</td></tr>
<tr><td><code id="outbreak_+3A_filter_perc">filter_perc</code></td>
<td>
<p>the minimum percentage of defoliated trees to be
considered an outbreak. Default is 25 percent.</p>
</td></tr>
<tr><td><code id="outbreak_+3A_filter_min_series">filter_min_series</code></td>
<td>
<p>The minimum number of trees required for an outbreak
event. Default is 3 trees.</p>
</td></tr>
<tr><td><code id="outbreak_+3A_filter_min_defol">filter_min_defol</code></td>
<td>
<p>The minimum number of trees recording a defoliation
event. Default is 1 tree.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame <code>obr</code> object for the site that includes all trees in the
host <code>defol</code> object. Columns in the <code>obr</code> include:
</p>
 <ol>
<li> <p><code>year</code> for every year in the set of host trees, </p>
</li>
<li>
<p><code>num_defol</code> the number of trees recording a defoliation event, </p>
</li>
<li>
<p><code>percent_defol</code> the percent of trees recording a defoliation, </p>
</li>
<li>
<p><code>num_max_defol</code> the number of trees recording a maximum growth suppression
(or peak of that event on that tree), </p>
</li>
<li> <p><code>perc_max_defol</code> the percent of
trees at maximum defoliation, </p>
</li>
<li> <p><code>mean_gsi</code> the average of all trees
growth suppression index (<code>gsi</code>), </p>
</li>
<li> <p><code>mean_ngsi</code> the average of all
trees normalized growth suppression index (<code>ngsi</code>), </p>
</li>
<li> <p><code>outbreak_status</code>
whether that year constitutes an outbreak based on the filters applied to
the function.</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data("dmj_defol")
head(outbreak(dmj_defol))

</code></pre>

<hr>
<h2 id='outbreak_stats'>Outbreak statistics</h2><span id='topic+outbreak_stats'></span>

<h3>Description</h3>

<p>Summary statistics for inferred outbreaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outbreak_stats(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outbreak_stats_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+obr">obr</a> object after running <code><a href="#topic+outbreak">outbreak()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with descriptive statistics for each outbreak event
determined by <code><a href="#topic+outbreak">outbreak()</a></code>, including: </p>
 <ul>
<li><p>&quot;start&quot; &ndash; first year
of outbreak </p>
</li>
<li><p>&quot;end&quot; &ndash; last year of outbreak </p>
</li>
<li><p>&quot;duration&quot; &ndash;
length of outbreak (in years) </p>
</li>
<li><p>&quot;n_df_start&quot; &ndash; number of trees
defoliated at the start </p>
</li>
<li><p>&quot;perc_df_start&quot; &ndash; percent of trees
defoliated at the start </p>
</li>
<li><p>&quot;max_df_obr&quot; &ndash; maximum number of trees in
the outbreak during a single year </p>
</li>
<li><p>&quot;yr_max_df&quot; &ndash; year with the
maximum number of trees defoliated </p>
</li>
<li><p>&quot;yr_min_ngsi&quot; &ndash; year with the
lowest mean normalized growth suppression index (NGSI) </p>
</li>
<li><p>&quot;min_gsi&quot; &ndash;
minimum growth suppression index </p>
</li>
<li><p>&quot;min_ngsi&quot; &ndash; minimum normalized
gsi </p>
</li></ul>



<h3>Note</h3>

<p>Certain statistics will be set to <code>NA</code> for the final
outbreak event if there was an ongoing defoliation event (in which
<code>series_end_event = TRUE</code> in <code><a href="#topic+defoliate_trees">defoliate_trees()</a></code>). This is because the end
of the outbreak remains unknown, so statistics such as duration cannot be
calculated. Statistics pertaining to the start of the event are provided.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dmj_obr")
outbreak_stats(dmj_obr)

</code></pre>

<hr>
<h2 id='plot_defol'>Produce a Gantt plot of individual tree-ring series to show defoliation
events in time</h2><span id='topic+plot_defol'></span>

<h3>Description</h3>

<p>Produce a Gantt plot of individual tree-ring series to show defoliation
events in time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_defol(x, breaks)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_defol_+3A_x">x</code></td>
<td>
<p>a <code>defol</code> object produced by <code><a href="#topic+defoliate_trees">defoliate_trees()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_defol_+3A_breaks">breaks</code></td>
<td>
<p>a vector length two providing threshold (negative) <code>ngsi</code>
values to separate minor, moderate, and severe defoliation events. If
blank, the mean and 1st quartile are used.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("dmj_defol")
plot_defol(dmj_defol)

## Change the values severity classes
plot_defol(dmj_defol, breaks = c(-1.0, -0.5))

</code></pre>

<hr>
<h2 id='plot_outbreak'>Produce a stacked plot to present composited, site-level insect outbreak
chronologies</h2><span id='topic+plot_outbreak'></span>

<h3>Description</h3>

<p>Produce a stacked plot to present composited, site-level insect outbreak
chronologies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_outbreak(x, disp_index = c("GSI", "NGSI"), label_defol = "% defoliated")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_outbreak_+3A_x">x</code></td>
<td>
<p>an 'obr' object produced by <code><a href="#topic+outbreak">outbreak()</a></code></p>
</td></tr>
<tr><td><code id="plot_outbreak_+3A_disp_index">disp_index</code></td>
<td>
<p>Identify the timeseries index to plot. Defaults to <code>NGSI</code>,
the average normalized growth suppression index for the site. The only
other option is <code>GSI</code>, the average growth suppression index.</p>
</td></tr>
<tr><td><code id="plot_outbreak_+3A_label_defol">label_defol</code></td>
<td>
<p>Allows users to change the bottom tile of the printed
ouput to read what they'd like. Defaults to &quot;% defoliated&quot;</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmj_obr)
plot_outbreak(dmj_obr)

# Change middle panel display from the default "NGSI" to "GSI"
plot_outbreak(dmj_obr, disp_index = "GSI")

</code></pre>

<hr>
<h2 id='plot.defol'>Plot a <code>defol</code> object</h2><span id='topic+plot.defol'></span>

<h3>Description</h3>

<p>Plot a <code>defol</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'defol'
plot(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.defol_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="#topic+plot_defol">plot_defol()</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='sample_depth'>Calculate the sample depth of a defol object</h2><span id='topic+sample_depth'></span>

<h3>Description</h3>

<p>Calculate the sample depth of a defol object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_depth(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_depth_+3A_x">x</code></td>
<td>
<p>A <code>defol</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame containing the years and number of trees
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dmj_defol")
head(sample_depth(dmj_defol))

</code></pre>

<hr>
<h2 id='series_names'>Extract series names from a defol object</h2><span id='topic+series_names'></span>

<h3>Description</h3>

<p>Extract series names from a defol object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>series_names(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="series_names_+3A_x">x</code></td>
<td>
<p>a defol object</p>
</td></tr>
</table>

<hr>
<h2 id='stack_defoliation'>Stack a defoliation list</h2><span id='topic+stack_defoliation'></span>

<h3>Description</h3>

<p>Stack a defoliation list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stack_defoliation(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stack_defoliation_+3A_x">x</code></td>
<td>
<p>a list object created by <code><a href="#topic+defoliate_trees">defoliate_trees()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a defol object (long-format data frame)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
