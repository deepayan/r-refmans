<!DOCTYPE html><html><head><title>Help for package lpridge</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lpridge}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lpepa'><p>Local polynomial regression fitting with Epanechnikov weights</p></a></li>
<li><a href='#lpridge'><p>Local polynomial regression fitting with ridging</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-07</td>
</tr>
<tr>
<td>Title:</td>
<td>Local Polynomial (Ridge) Regression</td>
</tr>
<tr>
<td>Author:</td>
<td>Burkhardt Seifert &lt;seifert@ifspm.unizh.ch&gt; (S original);
	Packaged for R by Martin Maechler</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Maechler &lt;maechler@stat.math.ethz.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Local Polynomial Regression with Ridging.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://curves-etc.r-forge.r-project.org/">https://curves-etc.r-forge.r-project.org/</a>,
<a href="https://r-forge.r-project.org/R/?group_id=846">https://r-forge.r-project.org/R/?group_id=846</a>,
<a href="https://r-forge.r-project.org/scm/viewvc.php/pkg/lpridge/?root=curves-etc">https://r-forge.r-project.org/scm/viewvc.php/pkg/lpridge/?root=curves-etc</a>,
svn://svn.r-forge.r-project.org/svnroot/curves-etc/pkg/lpridge</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://r-forge.r-project.org/R/?group_id=846">https://r-forge.r-project.org/R/?group_id=846</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-07 16:01:07 UTC; maechler</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-08 13:00:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='lpepa'>Local polynomial regression fitting with Epanechnikov weights</h2><span id='topic+lpepa'></span>

<h3>Description</h3>

<p>Fast and stable algorithm for nonparametric estimation of regression
functions and their derivatives via <b>l</b>ocal <b>p</b>olynomials with
<b>Epa</b>nechnikov weight function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lpepa(x, y, bandwidth, deriv = 0, n.out = 200, x.out = NULL,
      order = deriv+1, mnew = 100, var = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lpepa_+3A_x">x</code></td>
<td>
<p>vector of design points, not necessarily ordered.</p>
</td></tr>
<tr><td><code id="lpepa_+3A_y">y</code></td>
<td>
<p>vector of observations of the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="lpepa_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth(s) for nonparametric estimation.  Either a
number or a vector of the same length as <code>x.out</code>.</p>
</td></tr>
<tr><td><code id="lpepa_+3A_deriv">deriv</code></td>
<td>
<p>order of derivative of the regression function to be
estimated; defaults to <code>deriv = 0</code>.</p>
</td></tr>
<tr><td><code id="lpepa_+3A_n.out">n.out</code></td>
<td>
<p>number of output design points where the function has to
be estimated.  The default is <code>n.out=200</code>.</p>
</td></tr>
<tr><td><code id="lpepa_+3A_x.out">x.out</code></td>
<td>
<p>vector of output design points where the function has to
be estimated.  The default value is an equidistant grid of <code>n.out</code>
points from min(x) to max(x).</p>
</td></tr>
<tr><td><code id="lpepa_+3A_order">order</code></td>
<td>
<p>integer, order of the polynomial used for local
polynomials.  Must be <code class="reqn">\le 10</code> and defaults to
<code>order = deriv+1</code>.</p>
</td></tr>
<tr><td><code id="lpepa_+3A_mnew">mnew</code></td>
<td>
<p>integer forcing to restart the algorithm after <code>mnew</code>
updating steps.
The default is <code>mnew = 100</code>.  For <code>mnew = 1</code> you get a numerically
&ldquo;super-stable&rdquo; algorithm (see reference SBE&amp;G below).</p>
</td></tr>
<tr><td><code id="lpepa_+3A_var">var</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the variance of the estimator
proportional to the residual variance is computed (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details are described in the first reference SBE&amp;G (1994)
below.  In S&amp;G, a bad finite sample behaviour of local polynomials
for random designs was found.
For practical use, we therefore propose local polynomial regression
fitting with ridging, as implemented in the function
<code><a href="#topic+lpridge">lpridge</a></code>.  In <code>lpepa</code>, several parameters described
in SBE&amp;G are fixed either in the fortran
routine or in the <span class="rlang"><b>R</b></span>-function.  There, you find comments how to change them.
</p>

<p>For <code>var=TRUE</code>, the variance of the estimator proportional to the
residual variance is computed, i.e., the exact finite sample variance of the
regression estimator is <code>var(est) = est.var * sigma^2</code>.
</p>


<h3>Value</h3>

<p>a list including used parameters and estimator.
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>vector of ordered design points.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>vector of observations ordered according to x.</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>vector of bandwidths actually used for nonparametric
estimation.</p>
</td></tr>
<tr><td><code>deriv</code></td>
<td>
<p>order of derivative of the regression function estimated.</p>
</td></tr>
<tr><td><code>x.out</code></td>
<td>
<p>vector of ordered output design points.</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>order of the polynomial used for local polynomials.</p>
</td></tr>
<tr><td><code>mnew</code></td>
<td>
<p>force to restart the algorithm after mnew updating steps.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>logical flag: whether the variance of the estimator was computed.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>estimator of the derivative of order deriv of the
regression function.</p>
</td></tr>
<tr><td><code>est.var</code></td>
<td>
<p>estimator of the variance of est (proportional to
residual variance).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Originally available from <a href="https://www.ebpi.uzh.ch/">
Biostats, University of Zurich</a> under &lsquo;<span class="file">Manuscripts</span>&rsquo;, but no longer.


</p>
<p>- Numerical stability and computational speed:
<br />
B. Seifert, M. Brockmann, J. Engel and T. Gasser (1994)
Fast algorithms for nonparametric curve estimation.
<em>J. Computational and Graphical Statistics</em> <b>3</b>, 192&ndash;213.
</p>
<p>- Statistical properties:
<br />
Seifert, B. and Gasser, T. (1996)
Finite sample variance of local polynomials: Analysis and solutions.
<em>J. American Statistical Association</em> <b>91</b>(433), 267&ndash;275.
</p>
<p>Seifert, B. and Gasser, T. (2000)
Data adaptive ridging in local polynomial
regression.  <em>J. Computational and Graphical Statistics</em> <b>9</b>,
338&ndash;360.
</p>
<p>Seifert, B. and Gasser, T. (1998)
Ridging Methods in Local Polynomial Regression.
in: S. Weisberg (ed), <em>Dimension Reduction, Computational Complexity,
and Information</em>, Vol.<b>30</b> of Computing Science &amp; Statistics,
Interface Foundation of North America, 467&ndash;476.
</p>
<p>Seifert, B. and Gasser, T. (1998)
Local polynomial smoothing.
in: <em>Encyclopedia of Statistical Sciences</em>,
Update Vol.<b>2</b>, Wiley, 367&ndash;372.
</p>
<p>Seifert, B., and Gasser, T. (1996)
Variance properties of local polynomials and ensuing
modifications. in: <em>Statistical Theory and Computational Aspects
of Smoothing</em>, W. HÃ¤rdle, M. G. Schimek (eds), Physica, 50&ndash;127.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lpridge">lpridge</a></code>, and also <code><a href="stats.html#topic+lowess">lowess</a></code> and
<code><a href="stats.html#topic+loess">loess</a></code> which do local linear and quadratic regression
quite a bit differently.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cars)
attach(cars)

epa.sd &lt;- lpepa(speed,dist, bandw=5)		# local polynomials

plot(speed, dist, main = "data(cars) &amp; lp epanechnikov regression")
lines(epa.sd$x.out, epa.sd$est,  col="red")
lines(lowess(speed,dist, f= .5), col="orange")
detach()
</code></pre>

<hr>
<h2 id='lpridge'>Local polynomial regression fitting with ridging</h2><span id='topic+lpridge'></span>

<h3>Description</h3>

<p>Fast and stable algorithm for nonparametric estimation of regression
functions and their derivatives via local polynomials and local
polynomial ridge regression with polynomial weight functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lpridge(x, y, bandwidth, deriv=0, n.out=200, x.out=NULL,
	order = NULL, ridge = NULL, weight = "epa", mnew = 100,
	var = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lpridge_+3A_x">x</code></td>
<td>
<p>vector of design points, not necessarily ordered.</p>
</td></tr>
<tr><td><code id="lpridge_+3A_y">y</code></td>
<td>
<p>vector of observations of the same length as x.</p>
</td></tr>
<tr><td><code id="lpridge_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth for nonparametric estimation.  Either a
number or a vector of the same length as x.out. </p>
</td></tr>
<tr><td><code id="lpridge_+3A_deriv">deriv</code></td>
<td>
<p>order of derivative of the regression function to be
estimated; default is 0.</p>
</td></tr>
<tr><td><code id="lpridge_+3A_n.out">n.out</code></td>
<td>
<p>number of output design points at which to evaluate the
estimator; defaults to 200.</p>
</td></tr>
<tr><td><code id="lpridge_+3A_x.out">x.out</code></td>
<td>
<p>vector of output design points at which to evaluate the
estimator;  By default, an equidistant grid of <code>n.out</code>
points from <code>min(x)</code> to <code>max(x)</code>.</p>
</td></tr>
<tr><td><code id="lpridge_+3A_order">order</code></td>
<td>
<p>order of the polynomial used for local polynomials. The
default value is <code>deriv + 1</code>.</p>
</td></tr>
<tr><td><code id="lpridge_+3A_ridge">ridge</code></td>
<td>
<p>ridging parameter.  The default value performs a slight
ridging (see &quot;Details&quot;).  <code>ridge = 0</code> leads to the local polynomial
estimator without ridging.</p>
</td></tr>
<tr><td><code id="lpridge_+3A_weight">weight</code></td>
<td>
<p>kernel weight function.  The default value is
weight = &quot;epa&quot; for Epanechnikov weights.  Other weights are &quot;bi&quot; for
biweights (square of &quot;epa&quot;) and &quot;tri&quot; for triweights (cube of
&quot;epa&quot;).  If weight is a vector, it is interpreted as vector of
coefficients of the polynomial weight function.  Thus, weight = &quot;epa&quot;
is equivalent to weight = c(1,0,-1).</p>
</td></tr>
<tr><td><code id="lpridge_+3A_mnew">mnew</code></td>
<td>
<p>force to restart the algorithm after mnew updating
steps.  The default value is mnew = 100.  For <code>mnew = 1</code> you get a
numerically &quot;super-stable&quot; algorithm (see reference SBE&amp;G below).</p>
</td></tr>
<tr><td><code id="lpridge_+3A_var">var</code></td>
<td>
<p>logical flag: if TRUE, the variance of the estimator
proportional to the residual variance is computed (see &quot;Details&quot; below).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>described in the reference SBE&amp;G below.  Several parameters
described there are fixed either in the fortran routine or in the
<span class="rlang"><b>R</b></span>-function.  There, you find comments how to change them.
</p>
<p>In S&amp;G, a bad finite sample behavior of local polynomials for random
design was found, and ridging of the estimator was proposed.  In
<code>lpridge()</code>, we use a ridging matrix corresponding to the smoothness
assumption <em>&ldquo;The squared difference of the derivative of order
deriv of the regression function at the point of estimation and the
weighted mean of design points is bounded by the residual variance
divided by the ridge parameter.&rdquo;</em>
</p>
<p>Thus, without any smoothness assumption, <code>ridge = 0</code> would be
appropriate, and for a nearly constant derivative of order
<code>deriv</code>, a ridge parameter going to infinity behaves well.  For
equidistant design, ridging influences the estimator only at the
boundary.  Asymptotically, the influence of any non-increasing ridge
parameter vanishes.
</p>
<p>So far, our experience with the choice of a ridging parameter is
limited.  Therefore we have chosen a default value which performs a
slight modification of the local polynomial estimator (with
denotations <code class="reqn">h =</code> <code>bandwidth</code>, <code class="reqn">d =</code> <code>deriv</code>, and
where <code class="reqn">n_0</code> = <code>length(x)*mean(bandwidth)/diff(range(x))</code>
is a mean number of observations in a smoothing interval):
</p>
<p style="text-align: center;"><code class="reqn">ridge = 5\sqrt{n_0} h^{2d} / ((2d+3)(2d+5))</code>
</p>

<p>For <code>var=TRUE</code>, the variance of the estimator proportional to the
residual variance is computed, i.e., the exact finite sample variance of the
regression estimator is <code>var(est) = est.var * sigma^2</code>.
</p>


<h3>Value</h3>

<p>a list including used parameters and estimator.
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>vector of ordered design points.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>vector of observations ordered according to x.</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>vector of bandwidths actually used for nonparametric
estimation.</p>
</td></tr>
<tr><td><code>deriv</code></td>
<td>
<p>order of derivative of the regression function estimated.</p>
</td></tr>
<tr><td><code>x.out</code></td>
<td>
<p>vector of ordered output design points.</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>order of the polynomial used for local polynomials.</p>
</td></tr>
<tr><td><code>ridge</code></td>
<td>
<p>ridging parameter used.</p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>vector of coefficients of the kernel weight function.</p>
</td></tr>
<tr><td><code>mnew</code></td>
<td>
<p>force to restart the algorithm after mnew updating steps. </p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>logical flag: whether the variance of the estimator was computed.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>estimator of the derivative of order deriv of the
regression function.</p>
</td></tr>
<tr><td><code>est.var</code></td>
<td>
<p>estimator of the variance of est (proportional to
residual variance).</p>
</td></tr>
</table>


<h3>References</h3>

<p>The same as for <code><a href="#topic+lpepa">lpepa</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cars)
attach(cars)
plot(speed, dist, main = "data(cars) &amp; lpRIDGE Regression")


myfit &lt;- lpridge(speed,dist,bandw = 5, ridge=0)		# local polynomials
lines(myfit$x.out,myfit$est,col=2)

myridge &lt;- lpridge(speed,dist,bandw = 5)		# local pol. ridge
lines(myridge$x.out,myridge$est,col=3)
mtext("bandw = 5")
legend(5,120, c("ridge = 0", "default ridging"), col = 2:3, lty = 1)
detach()
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
