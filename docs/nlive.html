<!DOCTYPE html><html><head><title>Help for package nlive</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlive}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dataCog'><p>Made-up longitudinal data on global cognition before death</p></a></li>
<li><a href='#nlive'><p>Automated Estimation of Sigmoidal and Piecewise Linear Mixed Models</p></a></li>
<li><a href='#nlive.inspect'><p>Generation of key plots for a longitudinal variable of interest</p></a></li>
<li><a href='#nlive.pmma'><p>Automated Estimation of the Piecewise Linear Mixed Model with Abrupt Change</p></a></li>
<li><a href='#nlive.pmms'><p>Automated Estimation of the Piecewise Linear Mixed Model with Smooth Change</p></a></li>
<li><a href='#nlive.smm'><p>Automated Estimation of the Sigmoidal Mixed Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Automated Estimation of Sigmoidal and Piecewise Linear Mixed
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maude Wagner &lt;maude_wagner@rush.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of relatively complex nonlinear mixed-effects models, including the Sigmoidal Mixed Model and the Piecewise Linear Mixed Model with abrupt or smooth transition, through a single intuitive line of code and with automated generation of starting values. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MaudeWagner/nlive">https://github.com/MaudeWagner/nlive</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MaudeWagner/nlive/issues">https://github.com/MaudeWagner/nlive/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, nlraa, sqldf, ggplot2, graphics, lcmm, saemix, Rmisc,
sitar, stats, knitr, fastDummies</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, MASS, survival, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-26 00:36:54 UTC; mwagner4</td>
</tr>
<tr>
<td>Author:</td>
<td>Maude Wagner <a href="https://orcid.org/0000-0002-1834-3218"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ana W. Capuano [aut],
  Emmanuelle Comets [ctb]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-26 20:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='dataCog'>Made-up longitudinal data on global cognition before death</h2><span id='topic+dataCog'></span>

<h3>Description</h3>

<p>The dataCog contains 1200 individuals with one line per visit. Repeated measures of global cognition (cognition) were collected over a maximum period of 30 years. Information on the age at death is also provided (ageDeath, ageDeath90).
</p>


<h3>Format</h3>

<p>A data frame with 11867 observations over 1200 subjects and 5 variables: </p>

<dl>
<dt>ID</dt><dd><p>subject identification number</p>
</dd>
<dt>time</dt><dd><p>the retrospective (negative) time before death (in years)</p>
</dd>
<dt>cognition</dt><dd><p>composite score of global cognition</p>
</dd>
<dt>ageDeath</dt><dd><p>age at death (in years)</p>
</dd>
<dt>ageDeath90</dt><dd><p>age at death centered by the mean</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
summary(dataCog)

</code></pre>

<hr>
<h2 id='nlive'>Automated Estimation of Sigmoidal and Piecewise Linear Mixed Models</h2><span id='topic+nlive'></span>

<h3>Description</h3>

<p>The nlive() function allows to fit a Sigmoidal Mixed Model with 4 parameters, a Piecewise Linear Mixed Model
with abrupt change, or a Piecewise Linear Mixed Model with a smooth polynomial transition in the context of
longitudinal Gaussian outcomes. This function was designed to be
intuitive enough to the less sophisticated users, while using recent developments such as the
stochastic approximation expectation-maximization (SAEM) algorithm for efficient estimation. It was
designed to optimize the initial values of the main parameters and help
interpretation of the output by providing different features such as annotated outputs and graphs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlive(
  model,
  dataset,
  ID,
  outcome,
  time,
  predictor.all = NULL,
  predictor.par1 = NULL,
  predictor.par2 = NULL,
  predictor.par3 = NULL,
  predictor.par4 = NULL,
  start = NULL,
  plot.xlabel = NULL,
  plot.ylabel = NULL,
  traj.marg = FALSE,
  traj.marg.group = NULL,
  spag.plot.title = NULL,
  traj.marg.title = NULL,
  traj.marg.group.title = NULL,
  traj.marg.group.val = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlive_+3A_model">model</code></td>
<td>
<p>indicator of the model to fit (1=Sigmoidal Mixed Model, 2=Piecewise Mixed Model with abrupt change, 3=Piecewise Mixed Model with smooth transition)</p>
</td></tr>
<tr><td><code id="nlive_+3A_dataset">dataset</code></td>
<td>
<p>data frame containing the variables ID, outcome, time, predictor.all, and predictor.par1 to predictor.par4.</p>
</td></tr>
<tr><td><code id="nlive_+3A_id">ID</code></td>
<td>
<p>name of the variable representing the grouping structure specified with &quot; (e.g., &quot;ID&quot; representing the unique identifier of participants).</p>
</td></tr>
<tr><td><code id="nlive_+3A_outcome">outcome</code></td>
<td>
<p>name of the time-varying variable representing the longitudinal outcome specified with &quot; (e.g., &quot;outcome&quot;).</p>
</td></tr>
<tr><td><code id="nlive_+3A_time">time</code></td>
<td>
<p>name of the variable representing the timescale specified with &quot; (e.g., &quot;time&quot;), which can be negative or positive.</p>
</td></tr>
<tr><td><code id="nlive_+3A_predictor.all">predictor.all</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the four main parameters of the model of interest will be adjusted to (e.g. predictor.all=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive_+3A_predictor.par1">predictor.par1</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the first main parameter of the model of interest will be adjusted to (e.g. predictor.all=c(&quot;X1&quot;,&quot;X2&quot;)). For model 1, the first parameter = last level. For models 2 and 3, first parameter = intercept. Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive_+3A_predictor.par2">predictor.par2</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the second main parameter of the model of interest will be adjusted to (e.g. predictor.all=c(&quot;X1&quot;,&quot;X2&quot;)). For model 1, the second parameter = initial level. For models 2 and 3, second parameter = slope before the change-point. Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive_+3A_predictor.par3">predictor.par3</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the third main parameter of the model of interest will be adjusted to (e.g. predictor.all=c(&quot;X1&quot;,&quot;X2&quot;). For model 1, the third parameter = midpoint. For models 2 and 3, third parameter = slope after the change-point. Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive_+3A_predictor.par4">predictor.par4</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the fourth main parameter of the model of interest will be adjusted to (e.g. predictor.all=c(&quot;X1&quot;,&quot;X2&quot;)). For model 1, the fourth parameter is the Hill slope. For models 2 and 3, the fourth parameter is the changepoint. Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive_+3A_start">start</code></td>
<td>
<p>optional vector to override the specification of the four initial values for the main parameters. For model 1, the values must be included in the following order: last level, initial level, midpoint, Hill slope. For models 2 and 3, the values must be included in the following order: intercept, slope before the changepoint, slope after the changepoint, changepoint. Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive_+3A_plot.xlabel">plot.xlabel</code></td>
<td>
<p>optional text for the title of the x-axis of all plots</p>
</td></tr>
<tr><td><code id="nlive_+3A_plot.ylabel">plot.ylabel</code></td>
<td>
<p>optional text for the title of the y-axis of all plots</p>
</td></tr>
<tr><td><code id="nlive_+3A_traj.marg">traj.marg</code></td>
<td>
<p>optional logical indicating if the marginal estimated trajectory should be plotted for the most common profile of covariates, if any. Default to FALSE.</p>
</td></tr>
<tr><td><code id="nlive_+3A_traj.marg.group">traj.marg.group</code></td>
<td>
<p>optional name of the grouping variable listed in one of the predictor arguments to plot and contrast the estimated marginal trajectories between two specific groups, specified with &quot; (e.g., traj.marg.group=&quot;X1&quot;). If the variable is binary, the trajectories are contrasted between the two groups of interest. If the variable is continuous, the 10th and 90th percentile values will automatically be considered. The default value is NULL.</p>
</td></tr>
<tr><td><code id="nlive_+3A_spag.plot.title">spag.plot.title</code></td>
<td>
<p>optional text for the title of the spaghetti plot</p>
</td></tr>
<tr><td><code id="nlive_+3A_traj.marg.title">traj.marg.title</code></td>
<td>
<p>optional text for the title of the marginal estimated trajectory</p>
</td></tr>
<tr><td><code id="nlive_+3A_traj.marg.group.title">traj.marg.group.title</code></td>
<td>
<p>optional text for the title of the marginal estimated trajectories contrasted between groups</p>
</td></tr>
<tr><td><code id="nlive_+3A_traj.marg.group.val">traj.marg.group.val</code></td>
<td>
<p>optional vector that can be used when <em>traj.marg.group</em> receives a quantitative variable and that allows to manually specify two percentile values to be considered for contrasting the traj.marg.group. The two values must be between 0 and 1 (e.g., traj.marg.group.val=c(0.2,0.8); for percentiles 20th and 80th). Default to 10th and 90th percentiles (i.e., traj.marg.group.val=c(0.1,0.9)).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>CAUTIONS REGARDING THE USE OF THE FUNCTION
</p>
<p>traj.marg: if &quot;TRUE&quot;, this argument automatically plots the estimated marginal trajectories of the longitudinal outcome
for the most common profile of covariates, if any (i.e., ref &quot;1&quot; for binary variables and mean values for continuous variables).
Thus, users must ensure that continuous variables are centered on the mean.
</p>


<h3>Value</h3>

<p>An object of class SaemixObject (from the existing <em>saemix</em> R package) containing the results of
the fit of the data by the non-linear mixed <em>model</em> of interest. The <em>nlive</em> function automatically provides
(i) a spaghetti plot of the observed outcome for 70 randomly selected statistical units in the dataset and
(ii) the standard <em>saemix</em> output, including the fixed effects estimates, the variance of random effects,
and Likelihood of the fitted <em>model</em>. The outputs are printed on the terminal and the numerical and
graphical outputs are stored in a directory.
</p>


<h3>Author(s)</h3>

<p>Maude Wagner, Ana W. Capuano, Emmanuelle Comets
</p>
<p><a href="mailto:maude_wagner@rush.edu">maude_wagner@rush.edu</a>
</p>


<h3>References</h3>

<p>Capuano AW, Wagner M. nlive: an R package to facilitate the application of the sigmoidal and random changepoint mixed models. BMC Medical Research Methodology. 2023;23(1):257.
van den Hout A, Muniz-Terrera G, Matthews F. Smooth random change point models. Statistics in Medicine. 2011;30(6):599-610.
Comets E, Lavenu A, Lavielle MM. Parameter estimation in nonlinear mixed effect models using saemix, an R implementation of the SAEM algorithm. Journal of Statistical Software. 2017;80(3):1-41.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlive.smm">nlive.smm</a></code>, <code><a href="#topic+nlive.pmma">nlive.pmma</a></code>, <code><a href="#topic+nlive.pmms">nlive.pmms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#### Fitting a sigmoidal mixed model - with no covariate
## Not run: 
head(dataCog)
requireNamespace('nlraa')
smm.fit = nlive(model=1, dataset=dataCog, ID="ID", outcome="cognition", time="time")

## End(Not run)

#### plot(smm.fit): diagnostic plots to assess the goodness-of-fit of smm.fit
#### psi(smm.fit): estimates of individual parameters

#### Fitting a piecewise mixed model with abrupt change - with no covariate
## Not run: 
pmm.abrupt.fit = nlive(model=2, dataset=dataCog, ID="ID", outcome="cognition", time="time")

## End(Not run)
#### plot(pmm.abrupt.fit): diagnostic plots to assess the goodness-of-fit of pmm.abrupt.fit
#### psi(pmm.abrupt.fit): estimates of individual parameters


#### Fitting a piecewise mixed model with smooth change - with all parameters
#### adjusted for ageDeath90. Here, the nlive() function will also provide a
#### plot of the estimated marginal trajectory in the whole study sample.
## Not run: 
pmm.smooth.fit = nlive(model=3, dataset=dataCog, ID="ID", outcome="cognition", time="time",
predictor.all = c("ageDeath90"), traj.marg = TRUE)

## End(Not run)
#### plot(pmm.smooth.fit): diagnostic plots to assess the goodness-of-fit of the model
#### psi(pmm.smooth.fit): estimates of individual parameters


</code></pre>

<hr>
<h2 id='nlive.inspect'>Generation of key plots for a longitudinal variable of interest</h2><span id='topic+nlive.inspect'></span>

<h3>Description</h3>

<p>The nlive.inspect() function allows to generate basic graphs to describe the longitudinal observed
measures of a variable of interest in the dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlive.inspect(
  dataset,
  ID,
  variable,
  time,
  plot.xlabel = NULL,
  plot.ylabel = NULL,
  spag.plot.title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlive.inspect_+3A_dataset">dataset</code></td>
<td>
<p>data frame containing the ID, variable, and time.</p>
</td></tr>
<tr><td><code id="nlive.inspect_+3A_id">ID</code></td>
<td>
<p>name of the variable representing the grouping structure specified with &quot; (e.g., &quot;ID&quot; representing the unique identifier of participants).</p>
</td></tr>
<tr><td><code id="nlive.inspect_+3A_variable">variable</code></td>
<td>
<p>name of the time-varying variable of interest specified with &quot; (e.g., &quot;variable&quot;).</p>
</td></tr>
<tr><td><code id="nlive.inspect_+3A_time">time</code></td>
<td>
<p>name of the variable representing the timescale specified with &quot; (e.g., &quot;time&quot;). Can be negative or positive.</p>
</td></tr>
<tr><td><code id="nlive.inspect_+3A_plot.xlabel">plot.xlabel</code></td>
<td>
<p>optional text for the title of the x-axis of all plots.</p>
</td></tr>
<tr><td><code id="nlive.inspect_+3A_plot.ylabel">plot.ylabel</code></td>
<td>
<p>optional text for the title of the y-axis of all plots.</p>
</td></tr>
<tr><td><code id="nlive.inspect_+3A_spag.plot.title">spag.plot.title</code></td>
<td>
<p>optional text for the title of the spaghetti plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <em>nlive.inspect</em> function automatically provides
(i) an histogram of all the repeated measures of the variable available over time,
(ii) a spaghetti plot of the longitudinal observed variable for 70 randomly selected statistical units,
(iii) repeated boxplots of the longitudinal observed variable for each time unit.
The outputs are printed on the terminal and the numerical and graphical outputs are stored in a directory
</p>


<h3>Author(s)</h3>

<p>Maude Wagner, Ana W. Capuano, Emmanuelle Comets
</p>
<p><a href="mailto:maude_wagner@rush.edu">maude_wagner@rush.edu</a>
</p>


<h3>References</h3>

<p>Capuano AW, Wagner M. nlive: an R package to facilitate the application of the sigmoidal and random changepoint mixed models. BMC Medical Research Methodology. 2023;23(1):257.
Hadley Wickham (2016). ggplot2: elegant graphics for data analysis. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
nlive.inspect(dataset=dataCog, ID="ID", variable="cognition", time="time")

## End(Not run)

</code></pre>

<hr>
<h2 id='nlive.pmma'>Automated Estimation of the Piecewise Linear Mixed Model with Abrupt Change</h2><span id='topic+nlive.pmma'></span>

<h3>Description</h3>

<p>The nlive.pmma() function allows to fit a Piecewise Linear Mixed Models with abrupt
change in the context of longitudinal Gaussian outcomes. This function was designed to
be intuitive enough to the less sophisticated users, while using recent developments such
as the stochastic approximation expectation-maximization (SAEM) algorithm for efficient
estimation. It was designed to optimize the initial values of the main parameters and help
interpretation of the output by providing different features such as annotated outputs and
graphs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlive.pmma(
  dataset,
  ID,
  outcome,
  time,
  var.all = NULL,
  var.last.level = NULL,
  var.slope1 = NULL,
  var.slope2 = NULL,
  var.changepoint = NULL,
  start = NULL,
  plot.xlabel = NULL,
  plot.ylabel = NULL,
  traj.marg = FALSE,
  traj.marg.group = NULL,
  traj.marg.title = NULL,
  traj.marg.group.title = NULL,
  traj.marg.group.val = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlive.pmma_+3A_dataset">dataset</code></td>
<td>
<p>data frame containing the variables ID, outcome, time, var.all, and all other var. arguments.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_id">ID</code></td>
<td>
<p>name of the variable representing the grouping structure specified with &quot; (e.g., &quot;ID&quot; representing the unique identifier of participants).</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_outcome">outcome</code></td>
<td>
<p>name of the time-varying variable representing the longitudinal outcome specified with &quot; (e.g., &quot;outcome&quot;).</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_time">time</code></td>
<td>
<p>name of the variable representing the timescale specified with &quot; (e.g., &quot;time&quot;), which can be negative or positive.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_var.all">var.all</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the four main parameters of the model will be adjusted to (e.g. var.all=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_var.last.level">var.last.level</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the last level parameter of the model of interest will be adjusted to (e.g. var.last.level=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_var.slope1">var.slope1</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the slope1 (before changepoint) parameter of the model of interest will be adjusted to (e.g. var.slope1=c(&quot;X1&quot;,&quot;X2&quot;). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_var.slope2">var.slope2</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the slope2 (after changepoint) parameter of the model of interest will be adjusted to (e.g. var.slope2=c(&quot;X1&quot;,&quot;X2&quot;). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_var.changepoint">var.changepoint</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the changepoint parameter of the model of interest will be adjusted to (e.g. var.changepoint=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_start">start</code></td>
<td>
<p>optional vector to override the specification of the four initial values for the main parameters - values must be included in the following order: intercept, slope before the changepoint, slope after the changepoint, changepoint. Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_plot.xlabel">plot.xlabel</code></td>
<td>
<p>optional text for the title of the x-axis of all plots.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_plot.ylabel">plot.ylabel</code></td>
<td>
<p>optional text for the title of the y-axis of all plots.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_traj.marg">traj.marg</code></td>
<td>
<p>optional logical indicating if the marginal estimated trajectory should be plotted for the most common profile of covariates, if any. Default to FALSE.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_traj.marg.group">traj.marg.group</code></td>
<td>
<p>optional name of the grouping variable listed in one of the predictor arguments to plot and contrast the estimated marginal trajectories between two specific groups, specified with &quot; (e.g., traj.marg.group=&quot;X1&quot;). If the variable is binary, the trajectories are contrasted between the two groups of interest. If the variable is continuous, the 10th and 90th percentile values will automatically be considered. The default value is NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_traj.marg.title">traj.marg.title</code></td>
<td>
<p>optional text for the title of the marginal estimated trajectory</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_traj.marg.group.title">traj.marg.group.title</code></td>
<td>
<p>optional text for the title of the marginal estimated trajectories contrasted between groups</p>
</td></tr>
<tr><td><code id="nlive.pmma_+3A_traj.marg.group.val">traj.marg.group.val</code></td>
<td>
<p>optional vector that can be used when <em>traj.marg.group</em> receives a quantitative variable and that allows to manually specify two percentile values to be considered for contrasting the traj.marg.group. The two values must be between 0 and 1 (e.g., traj.marg.group.val=c(0.2,0.8); for percentiles 20th and 80th). Default to 10th and 90th percentiles (i.e., traj.marg.group.val=c(0.1,0.9)).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>CAUTIONS REGARDING THE USE OF THE FUNCTION
</p>
<p>traj.marg: if &quot;TRUE&quot;, this argument automatically plots the estimated marginal trajectories of the longitudinal outcome
for the most common profile of covariates, if any (i.e., ref &quot;1&quot; for binary variables and mean values for continuous variables).
Thus, users must ensure that continuous variables are centered on the mean.
</p>


<h3>Value</h3>

<p>An object of class SaemixObject (from the existing <em>saemix</em> R package)
containing the results of the fit of the data by the PMM-abrupt. The <em>nlive.pmma</em> function
automatically provides the standard saemix output, including the fixed effects estimates,
the variance of random effects, and Likelihood of the fitted model. The outputs are printed
on the terminal and the numerical and graphical outputs are stored in a directory.
</p>


<h3>Author(s)</h3>

<p>Maude Wagner, Ana W. Capuano, Emmanuelle Comets
</p>
<p><a href="mailto:maude_wagner@rush.edu">maude_wagner@rush.edu</a>
</p>


<h3>References</h3>

<p>Capuano AW, Wagner M. nlive: an R package to facilitate the application of the sigmoidal and random changepoint mixed models. BMC Medical Research Methodology. 2023;23(1):257.
van den Hout A, Muniz-Terrera G, Matthews F. Smooth random change point models. Statistics in Medicine. 2011;30(6):599-610.
Comets E, Lavenu A, Lavielle MM. Parameter estimation in nonlinear mixed effect models using saemix, an R implementation of the SAEM algorithm. Journal of Statistical Software. 2017;80(3):1-41.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#### Fitting a piecewise mixed model with abrupt change - with no covariate
## Not run: 
head(dataCog)
pmm.abrupt.fit = nlive.pmma(dataset=dataCog, ID="ID", outcome="cognition", time="time")

## End(Not run)
#### plot(pmm.abrupt.fit): diagnostic plots to assess the goodness-of-fit of pmm.abrupt.fit
#### psi(pmm.abrupt.fit): estimates of individual parameters


</code></pre>

<hr>
<h2 id='nlive.pmms'>Automated Estimation of the Piecewise Linear Mixed Model with Smooth Change</h2><span id='topic+nlive.pmms'></span>

<h3>Description</h3>

<p>The nlive.pmms() function allows to fit a Piecewise Linear Mixed Models with smooth change in the context of
longitudinal Gaussian outcomes. This function was designed to be
intuitive enough to the less sophisticated users, while using recent developments such as the
stochastic approximation expectation-maximization (SAEM) algorithm for efficient estimation. It was
designed to optimize the initial values of the main parameters and help
interpretation of the output by providing different features such as annotated outputs and graphs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlive.pmms(
  dataset,
  ID,
  outcome,
  time,
  var.all = NULL,
  var.last.level = NULL,
  var.slope1 = NULL,
  var.slope2 = NULL,
  var.changepoint = NULL,
  start = NULL,
  plot.xlabel = NULL,
  plot.ylabel = NULL,
  traj.marg = FALSE,
  traj.marg.group = NULL,
  traj.marg.title = NULL,
  traj.marg.group.title = NULL,
  traj.marg.group.val = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlive.pmms_+3A_dataset">dataset</code></td>
<td>
<p>data frame containing the variables ID, outcome, time, var.all, and all other var. arguments.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_id">ID</code></td>
<td>
<p>name of the variable representing the grouping structure specified with &quot; (e.g., &quot;ID&quot; representing the unique identifier of participants).</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_outcome">outcome</code></td>
<td>
<p>name of the time-varying variable representing the longitudinal outcome specified with &quot; (e.g., &quot;outcome&quot;).</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_time">time</code></td>
<td>
<p>name of the variable representing the timescale specified with &quot; (e.g., &quot;time&quot;), which can be negative or positive.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_var.all">var.all</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the four main parameters of the model will be adjusted to (e.g. var.all=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_var.last.level">var.last.level</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the last level parameter of the model of interest will be adjusted to (e.g. var.last.level=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_var.slope1">var.slope1</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the slope1 (before changepoint) parameter of the model of interest will be adjusted to (e.g. var.slope1=c(&quot;X1&quot;,&quot;X2&quot;). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_var.slope2">var.slope2</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the slope2 (after changepoint) parameter of the model of interest will be adjusted to (e.g. var.slope2=c(&quot;X1&quot;,&quot;X2&quot;). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_var.changepoint">var.changepoint</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the changepoint parameter of the model of interest will be adjusted to (e.g. var.changepoint=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_start">start</code></td>
<td>
<p>optional vector to override the specification of the four initial values for the main parameters - values must be included in the following order: intercept, slope before the changepoint, slope after the changepoint, changepoint. Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_plot.xlabel">plot.xlabel</code></td>
<td>
<p>optional text for the title of the x-axis of all plots</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_plot.ylabel">plot.ylabel</code></td>
<td>
<p>optional text for the title of the y-axis of all plots</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_traj.marg">traj.marg</code></td>
<td>
<p>optional logical indicating if the marginal estimated trajectory should be plotted for the most common profile of covariates, if any. Default to FALSE.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_traj.marg.group">traj.marg.group</code></td>
<td>
<p>optional name of the grouping variable listed in one of the predictor arguments to plot and contrast the estimated marginal trajectories between two specific groups, specified with &quot; (e.g., traj.marg.group=&quot;X1&quot;). If the variable is binary, the trajectories are contrasted between the two groups of interest. If the variable is continuous, the 10th and 90th percentile values will automatically be considered. The default value is NULL.</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_traj.marg.title">traj.marg.title</code></td>
<td>
<p>optional text for the title of the marginal estimated trajectory</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_traj.marg.group.title">traj.marg.group.title</code></td>
<td>
<p>optional text for the title of the marginal estimated trajectories contrasted between groups</p>
</td></tr>
<tr><td><code id="nlive.pmms_+3A_traj.marg.group.val">traj.marg.group.val</code></td>
<td>
<p>optional vector that can be used when <em>traj.marg.group</em> receives a quantitative variable and that allows to manually specify two percentile values to be considered for contrasting the traj.marg.group. The two values must be between 0 and 1 (e.g., traj.marg.group.val=c(0.2,0.8); for percentiles 20th and 80th). Default to 10th and 90th percentiles (i.e., traj.marg.group.val=c(0.1,0.9)).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>CAUTIONS REGARDING THE USE OF THE FUNCTION
</p>
<p>traj.marg: if &quot;TRUE&quot;, this argument automatically plots the estimated marginal trajectories of the longitudinal outcome
for the most common profile of covariates, if any (i.e., ref &quot;1&quot; for binary variables and mean values for continuous variables).
Thus, users must ensure that continuous variables are centered on the mean.
</p>


<h3>Value</h3>

<p>An object of class SaemixObject (from the existing <em>saemix</em> R package)
containing the results of the fit of the data by the PMM-smooth. The <em>nlive.pmms</em> function
automatically provides the standard saemix output, including the fixed effects estimates,
the variance of random effects, and Likelihood of the fitted model. The outputs are printed
on the terminal and the numerical and graphical outputs are stored in a directory.
</p>


<h3>Author(s)</h3>

<p>Maude Wagner, Ana W. Capuano, Emmanuelle Comets
</p>
<p><a href="mailto:maude_wagner@rush.edu">maude_wagner@rush.edu</a>
</p>


<h3>References</h3>

<p>Capuano AW, Wagner M. nlive: an R package to facilitate the application of the sigmoidal and random changepoint mixed models. BMC Medical Research Methodology. 2023;23(1):257.
van den Hout A, Muniz-Terrera G, Matthews F. Smooth random change point models. Statistics in Medicine. 2011;30(6):599-610.
Comets E, Lavenu A, Lavielle MM. Parameter estimation in nonlinear mixed effect models using saemix, an R implementation of the SAEM algorithm. Journal of Statistical Software. 2017;80(3):1-41.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#### Fitting a piecewise mixed model with abrupt change - with no covariate
## Not run: 
head(dataCog)
pmm.smooth.fit = nlive.pmms(dataset=dataCog, ID="ID", outcome="cognition", time="time")

## End(Not run)
#### plot(pmm.smooth.fit): diagnostic plots to assess the goodness-of-fit of pmm.smooth.fit
#### psi(pmm.smooth.fit): estimates of individual parameters


</code></pre>

<hr>
<h2 id='nlive.smm'>Automated Estimation of the Sigmoidal Mixed Model</h2><span id='topic+nlive.smm'></span>

<h3>Description</h3>

<p>The <em>nlive.smm()</em> function allows to fit a Sigmoidal Mixed Model with 4 parameters in the
context of longitudinal Gaussian outcomes. This function was designed to be intuitive enough
to the less sophisticated users, while using recent developments such as the stochastic
approximation expectation-maximization (SAEM) algorithm for efficient estimation.
It was designed to optimize the initial values of the main parameters and help interpretation
of the output by providing different features such as annotated outputs and graphs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlive.smm(
  dataset,
  ID,
  outcome,
  time,
  var.all = NULL,
  var.first.level = NULL,
  var.last.level = NULL,
  var.midpoint = NULL,
  var.Hslope = NULL,
  start = NULL,
  plot.xlabel = NULL,
  plot.ylabel = NULL,
  traj.marg = FALSE,
  traj.marg.group = NULL,
  traj.marg.title = NULL,
  traj.marg.group.title = NULL,
  traj.marg.group.val = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlive.smm_+3A_dataset">dataset</code></td>
<td>
<p>data frame containing the variables ID, outcome, time, var.all, and all other var. arguments.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_id">ID</code></td>
<td>
<p>name of the variable representing the grouping structure specified with &quot; (e.g., &quot;ID&quot; representing the unique identifier of participants).</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_outcome">outcome</code></td>
<td>
<p>name of the time-varying variable representing the longitudinal outcome specified with &quot; (e.g., &quot;outcome&quot;).</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_time">time</code></td>
<td>
<p>name of the variable representing the timescale specified with &quot; (e.g., &quot;time&quot;), which can be negative or positive.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_var.all">var.all</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the four main parameters of the model will be adjusted to (e.g. var.all=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_var.first.level">var.first.level</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the first level parameter of the model  will be adjusted to (e.g. var.first.level=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_var.last.level">var.last.level</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the last level parameter of the model of interest will be adjusted to (e.g. var.last.level=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_var.midpoint">var.midpoint</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the third main parameter of the model of interest will be adjusted to (e.g. var.midpoint=c(&quot;X1&quot;,&quot;X2&quot;). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_var.hslope">var.Hslope</code></td>
<td>
<p>optional vector indicating the name of the variable(s) that the fourth main parameter of the model of interest will be adjusted to (e.g. var.Hslope=c(&quot;X1&quot;,&quot;X2&quot;)). Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_start">start</code></td>
<td>
<p>optional vector to override the specification of the four initial values for the main parameters - values must be included in the following order: last level, initial level, midpoint, Hill slope. Default to NULL.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_plot.xlabel">plot.xlabel</code></td>
<td>
<p>optional text for the title of the x-axis of all plots</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_plot.ylabel">plot.ylabel</code></td>
<td>
<p>optional text for the title of the y-axis of all plots</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_traj.marg">traj.marg</code></td>
<td>
<p>optional logical indicating if the marginal estimated trajectory should be plotted for the most common profile of covariates, if any. Default to FALSE.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_traj.marg.group">traj.marg.group</code></td>
<td>
<p>optional name of the grouping variable listed in one of the predictor arguments to plot and contrast the estimated marginal trajectories between two specific groups, specified with &quot; (e.g., traj.marg.group=&quot;X1&quot;). If the variable is binary, the trajectories are contrasted between the two groups of interest. If the variable is continuous, the 10th and 90th percentile values will automatically be considered. The default value is NULL.</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_traj.marg.title">traj.marg.title</code></td>
<td>
<p>optional text for the title of the marginal estimated trajectory</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_traj.marg.group.title">traj.marg.group.title</code></td>
<td>
<p>optional text for the title of the marginal estimated trajectories contrasted between groups</p>
</td></tr>
<tr><td><code id="nlive.smm_+3A_traj.marg.group.val">traj.marg.group.val</code></td>
<td>
<p>optional vector that can be used when <em>traj.marg.group</em> receives a quantitative variable and that allows to manually specify two percentile values to be considered for contrasting the traj.marg.group. The two values must be between 0 and 1 (e.g., traj.marg.group.val=c(0.2,0.8); for percentiles 20th and 80th). Default to 10th and 90th percentiles (i.e., traj.marg.group.val=c(0.1,0.9)).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>CAUTIONS REGARDING THE USE OF THE FUNCTION
</p>
<p>traj.marg: if &quot;TRUE&quot;, this argument automatically plots the estimated marginal trajectories of the longitudinal outcome
for the most common profile of covariates, if any (i.e., ref &quot;1&quot; for binary variables and mean values for continuous variables).
Thus, users must ensure that continuous variables are centered on the mean.
</p>


<h3>Value</h3>

<p>An object of class SaemixObject (from the existing <em>saemix</em> R package)
containing the results of the fit of the data by the SMM. The <em>nlive.smm</em> function
automatically provides the standard saemix output, including the fixed effects estimates,
the variance of random effects, and Likelihood of the fitted model. The outputs are printed
on the terminal and the numerical and graphical outputs are stored in a directory.
</p>


<h3>Author(s)</h3>

<p>Maude Wagner, Ana W. Capuano, Emmanuelle Comets
</p>
<p><a href="mailto:maude_wagner@rush.edu">maude_wagner@rush.edu</a>
</p>


<h3>References</h3>

<p>Capuano AW, Wagner M. nlive: an R package to facilitate the application of the sigmoidal and random changepoint mixed models. BMC Medical Research Methodology. 2023;23(1):257.
van den Hout A, Muniz-Terrera G, Matthews F. Smooth random change point models. Statistics in Medicine. 2011;30(6):599-610.
Comets E, Lavenu A, Lavielle MM. Parameter estimation in nonlinear mixed effect models using saemix, an R implementation of the SAEM algorithm. Journal of Statistical Software. 2017;80(3):1-41.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#### Fitting a sigmoidal mixed model - with no covariate
## Not run: 
head(dataCog)
requireNamespace('nlraa')
smm.fit = nlive.smm(dataset=dataCog, ID="ID", outcome="cognition", time="time")

## End(Not run)
#### plot(smm.fit): diagnostic plots to assess the goodness-of-fit of smm.fit
#### psi(smm.fit): estimates of individual parameters


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
