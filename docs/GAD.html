<!DOCTYPE html><html><head><title>Help for package GAD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GAD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GAD-package'><p>GAD: Analysis of Variance from General Principles</p></a></li>
<li><a href='#as.fixed'><p>Encodes a vector as a &quot;fixed factor&quot;</p></a></li>
<li><a href='#as.random'><p>Encodes a vector as a &quot;random factor&quot;</p></a></li>
<li><a href='#C.test'><p>Cochran's C test of homogeneity of variances</p></a></li>
<li><a href='#comp.var'><p>Components of variation</p></a></li>
<li><a href='#crabs'><p>Distribution patterns of the crab <em>Ucides cordatus</em> at different spatial scales</p></a></li>
<li><a href='#estimates'><p>Estimates of an analysis of variance design</p></a></li>
<li><a href='#gad'><p>General analysis of variance design</p></a></li>
<li><a href='#is.fixed'><p>Check if a factor is fixed</p></a></li>
<li><a href='#is.random'><p>Check if a factor is random</p></a></li>
<li><a href='#pooling'><p>Post-hoc pooling</p></a></li>
<li><a href='#rats'><p>Glycogen content of rat livers</p></a></li>
<li><a href='#rohlf95'><p>Mosquitos' wing data colleted by Rohlf and cited in Sokal &amp; Rohlf (1995)</p></a></li>
<li><a href='#snails'><p>Growth rates of snails on large boulders on different rock shores</p></a></li>
<li><a href='#snk.test'><p>Student-Newman-Keuls (SNK) procedure</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Analysis of Variance from General Principles</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>matrixStats</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of complex ANOVA models with any combination of orthogonal/nested and fixed/random factors, as described by Underwood (1997). There are two restrictions: (i) data must be balanced; (ii) fixed nested factors are not allowed. Homogeneity of variances is checked using Cochran's C test and 'a posteriori' comparisons of means are done using Student-Newman-Keuls (SNK) procedure. For those terms with no denominator in the F-ratio calculation, pooled mean squares and quasi F-ratios are provided. Magnitute of effects are assessed by components of variation.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-01 15:05:37 UTC; sandrini</td>
</tr>
<tr>
<td>Author:</td>
<td>Leonardo Sandrini-Neto
    <a href="https://orcid.org/0000-0003-4086-6741"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Eliandro Gilbert [aut],
  Maurício Camargo <a href="https://orcid.org/0000-0002-8827-1176"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leonardo Sandrini-Neto &lt;leonardosandrini@ufpr.br&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-01 23:24:57 UTC</td>
</tr>
</table>
<hr>
<h2 id='GAD-package'>GAD: Analysis of Variance from General Principles</h2><span id='topic+GAD'></span><span id='topic+GAD-package'></span>

<h3>Description</h3>

<p>Analysis of complex ANOVA models with any combination of orthogonal/nested and fixed/random factors, as described by Underwood (1997). There are two restrictions: (i) data must be balanced; (ii) fixed nested factors are not allowed. Homogeneity of variances is checked using Cochran's C test and 'a posteriori' comparisons of means are done using Student-Newman-Keuls (SNK) procedure. For those terms with no denominator in the F-ratio calculation, pooled mean squares and quasi F-ratios are provided. Magnitute of effects are assessed by components of variation.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Leonardo Sandrini-Neto <a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a> (<a href="https://orcid.org/0000-0003-4086-6741">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Eliandro Gilbert <a href="mailto:eliandrogilbert@gmail.com">eliandrogilbert@gmail.com</a>
</p>
</li>
<li><p> Maurício Camargo <a href="mailto:mauricio.camargo@furg.br">mauricio.camargo@furg.br</a> (<a href="https://orcid.org/0000-0002-8827-1176">ORCID</a>)
</p>
</li></ul>


<hr>
<h2 id='as.fixed'>Encodes a vector as a &quot;fixed factor&quot;</h2><span id='topic+as.fixed'></span>

<h3>Description</h3>

<p>Assigns a class <code>"fixed"</code> to a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.fixed(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.fixed_+3A_x">x</code></td>
<td>
<p>a vector of data, usually a nominal variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function works the same way as <code><a href="base.html#topic+as.factor">as.factor</a></code>, but assigns an additional class informing that it is a fixed factor.
</p>


<h3>Value</h3>

<p>Function <code>as.fixed</code> returns an object of class <code>"factor"</code> and <code>"fixed"</code>.
</p>


<h3>Author(s)</h3>

<p>Leonardo Sandrini-Neto (<a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.random">as.random</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(rohlf95)
CG &lt;- as.fixed(rohlf95$cages)
MQ &lt;- as.random(rohlf95$mosquito)
class(CG)
class(MQ)
</code></pre>

<hr>
<h2 id='as.random'>Encodes a vector as a &quot;random factor&quot;</h2><span id='topic+as.random'></span>

<h3>Description</h3>

<p>Assigns a class <code>"random"</code> to a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.random(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.random_+3A_x">x</code></td>
<td>
<p>a vector of data, usually a nominal variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function works the same way as <code><a href="base.html#topic+as.factor">as.factor</a></code>, but assigns an additional class informing that it is a random factor.
</p>


<h3>Value</h3>

<p>Function <code>as.random</code> returns an object of class <code>"factor"</code> and <code>"random"</code>.
</p>


<h3>Author(s)</h3>

<p>Leonardo Sandrini-Neto (<a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.fixed">as.fixed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(rohlf95)
CG &lt;- as.fixed(rohlf95$cages)
MQ &lt;- as.random(rohlf95$mosquito)
class(CG)
class(MQ)
</code></pre>

<hr>
<h2 id='C.test'>Cochran's C test of homogeneity of variances</h2><span id='topic+C.test'></span>

<h3>Description</h3>

<p>Performs a Cochran's test of the null hypothesis that the largest variance in several sampled variances are the same.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C.test(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="C.test_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+lm">lm</a></code>&quot;, containing the specified design.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic is a ratio that relates the largest variance to the sum of the sampled variances.
</p>


<h3>Value</h3>

<p>A list of class htest containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>Cochran's C test statistic</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>The p-value of the test</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>A character string describing the alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The character string Cochran test of homogeneity of variances</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>A character string giving the name of the lm object</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>Sample estimates of variances</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Sandrini-Neto (<a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gad">gad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(rohlf95)
CG &lt;- as.fixed(rohlf95$cages)
MQ &lt;- as.random(rohlf95$mosquito)
model &lt;- lm(wing ~ CG + MQ%in%CG, data = rohlf95)
C.test(model)
</code></pre>

<hr>
<h2 id='comp.var'>Components of variation</h2><span id='topic+comp.var'></span>

<h3>Description</h3>

<p>This function calculates components of variation for fixed and random factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.var(object, anova.tab = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp.var_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+lm">lm</a></code>&quot;, containing the specified design with random and/or fixed factors.</p>
</td></tr>
<tr><td><code id="comp.var_+3A_anova.tab">anova.tab</code></td>
<td>
<p>an object containing the results returned by <code>gad</code> or <code>pooling</code> functions. See examples below.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This function calculates components of variation for any combination of orthogonal/nested and fixed/random factors. For pooled terms,
<code>comp.var</code> function seeks for the denominator of the removed term and keep its type (fixed or random). <br />
</p>
<p>Note that there are differences on the interpretation of the results between fixed and random factors. For fixed factors, the components of
variation calculated are just the sum of squares divided by the degrees of freedom and the hypothesis only concern those levels that were
included in the model. On the other hand, for random factors the components of variation calculated are truly variance components and are
interpretable as measures of variability of a population of levels, which are randomly sampled. However, for most of studies that aims to
compare the amount of variation attributed to each term, the estimates of components of variation for both fixed and random factors are important
and directly comparable (Anderson et al., 2008). <br />
</p>
<p>Eventually, the estimates of components of variation for some terms in the model can be negative. The term in question generally has a large p-value
and its estimative is usually set to zero, since a negative estimate is illogical. An alternative to this problem is remove the term using
<code><a href="#topic+pooling">pooling</a></code> function and re-analyse the model (Fletcher and Underwood, 2002).

</p>


<h3>Value</h3>


<p>A list of length 2, containing the mean squares estimates (<code>$mse</code>) and the table of components of variation (<code>$comp.var</code>) for the model. <br />
</p>
<p>The <code>$comp.var</code> table contains four columns: “Type” shows whether terms are fixed or random; “Estimate” shows the estimate of component of variation
(in squared units); “Square root” shows the square root of the “Estimate” column (original unit); and “Percentage” shows the percentage of variability
attributable to each term (both fixed and random factors).

</p>


<h3>Author(s)</h3>

<p>Eliandro Gilbert (<a href="mailto:eliandrogilbert@gmail.com">eliandrogilbert@gmail.com</a>)
</p>


<h3>References</h3>

<p>Anderson, M.J., Gorley, R.N., Clarke, K.R. 2008. <em>PERMANOVA+ for PRIMER</em>: Guide to Software and Statistical Methods. PRIMER-E: Plymouth, UK.
</p>
<p>Fletcher, D.J., Underwood, A.J. 2002. How to cope with negative estimates of components of variance in ecological field studies. Journal of Experimental Marine Biology and Ecology 273, 89-95.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gad">gad</a></code>, <code><a href="#topic+pooling">pooling</a></code>, <code><a href="#topic+estimates">estimates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(crabs)
head(crabs)

Re &lt;- as.random(crabs$Region)   # random factor
Lo &lt;- as.random(crabs$Location) # random factor nested in Region
Si &lt;- as.random(crabs$Site)     # random factor nested in Location

model &lt;- lm(Density ~ Re + Lo%in%Re + Si%in%Lo%in%Re, data = crabs)

C.test(model)                     # Checking homogeneity of variances
estimates(model)                  # Checking model structure
model.tab &lt;- gad(model)           # Storing the result of ANOVA on a new object
model.tab                         # Checking ANOVA results
comp.var(model, anova.tab = model.tab) # Calculating the components of variations
</code></pre>

<hr>
<h2 id='crabs'>Distribution patterns of the crab <em>Ucides cordatus</em> at different spatial scales</h2><span id='topic+crabs'></span>

<h3>Description</h3>

<p>Distribution patterns of the mangrove crab <em>Ucides cordatus</em> were assessed
at four levels of spatial hierarchy (from meters to tens of km) using a nested
ANOVA and variance components measures. The design included four spatial scales
of variation: regions (10s km), locations (km), sites (10s m), and quadrats (m).
Three regions tens of kilometers apart were sampled across the Paranagua Bay
salinity-energy gradient. Within each region, three locations
(1.5 - 3.5 km apart from each other) were randomly chosen. In each location,
three sites of 10 x 10 m were randomized, and within these, five quadrats
of 2 x 2 m were sampled (Sandrini-Neto and Lana, 2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(crabs)
</code></pre>


<h3>Format</h3>

<p>A data frame with 135 rows and 6 variables
</p>


<h3>Details</h3>


<ul>
<li><p> Region: a random factor with three levels (<code>R1, R2, R3</code>)
</p>
</li>
<li><p> Location: a random factor with three levels (<code>L1, L2, L3</code>) nested in Region
</p>
</li>
<li><p> Site: a random factor with three levels (<code>S1, S2, S3</code>) nested in Location
</p>
</li>
<li><p> Quadrat: sample size
</p>
</li>
<li><p> Crabs: response variable; number of crabs per quadrat
</p>
</li>
<li><p> Density: response variable; number of crabs per square meter
</p>
</li></ul>



<h3>References</h3>

<p>Sandrini-Neto, L., Lana, P.C. 2012. Distribution patterns of the crab <em>Ucides cordatus</em> (Brachyura, Ucididae) at different spatial scales in subtropical mangroves of Paranagua Bay (southern Brazil). Helgoland Marine Research 66, 167-174.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(crabs)
crabs
</code></pre>

<hr>
<h2 id='estimates'>Estimates of an analysis of variance design</h2><span id='topic+estimates'></span>

<h3>Description</h3>

<p>This function is used to construct the mean squares estimates of an ANOVA design, considering the complications imposed by nested/orthogonal and fixed/random factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimates(object, quasi.f = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimates_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+lm">lm</a></code>&quot;, containing the specified design with random and/or fixed factors.</p>
</td></tr>
<tr><td><code id="estimates_+3A_quasi.f">quasi.f</code></td>
<td>
<p>logical, indicating whether to use quasi F-ratio when there is no single error term appropriate in the analysis. Default to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Determines what each mean square estimates in an ANOVA design by a set of procedures originally described by Cornfield and Tukey (1956). This version is a modification proposed by Underwood (1997), which does not allow for the use of fixed nested factors. The steps involve the construction of a table of multipliers with a row for each source of variation and a column for each term in the model that is not an interaction. The mean square estimates for each source of variation is obtained by determining which components belong to each mean square and what is their magnitude. This enables the recognition of appropriate F-ratios.
</p>


<h3>Value</h3>

<p>A list containing the table of multipliers (<code>$tm</code>), the mean squares estimates (<code>$mse</code>) and the F-ratio versus (<code>$f.versus</code>) for the model.
</p>


<h3>Author(s)</h3>

<p>Leonardo Sandrini-Neto (<a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a>)
</p>
<p>Eliandro Gilbert (<a href="mailto:eliandrogilbert@gmail.com">eliandrogilbert@gmail.com</a>)
</p>


<h3>References</h3>

<p>Cornfield, J., Tukey, J.W. 1956. Average values of mean squares in factorials. Annals of Mathematical Statistics 27, 907-949.
</p>
<p>Underwood, A.J. 1997. <em>Experiments in Ecology</em>: Their Logical Design and Interpretation Using Analysis of Variance. Cambridge University Press, Cambridge.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gad">gad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
library(GAD)
data(rohlf95)
CG &lt;- as.fixed(rohlf95$cages)
MQ &lt;- as.random(rohlf95$mosquito)
model &lt;- lm(wing ~ CG + MQ%in%CG, data = rohlf95)
estimates(model)

# Example 2
data(rats)
names(rats)
TR &lt;- as.fixed(rats$treat)
RA &lt;- as.random(rats$rat)
LI &lt;- as.random(rats$liver)
model2 &lt;- lm(glycog ~ TR + RA%in%TR + LI%in%RA%in%TR, data = rats)
estimates(model2)

# Example 3
data(snails)
O &lt;- as.random(snails$origin)
S &lt;- as.random(snails$shore)
B &lt;- as.random(snails$boulder)
C &lt;- as.random(snails$cage)
model3 &lt;- lm(growth ~ O + S + O*S + B%in%S + O*(B%in%S) + C%in%(O*(B%in%S)), data = snails)
estimates(model3) # 'no test' for shore
estimates(model3, quasi.f = TRUE) # suitable test for shore
</code></pre>

<hr>
<h2 id='gad'>General analysis of variance design</h2><span id='topic+gad'></span>

<h3>Description</h3>

<p>Fits a general ANOVA design with any combination of orthogonal/nested and fixed/random factors through function <code><a href="#topic+estimates">estimates</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gad(object, quasi.f = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gad_+3A_object">object</code></td>
<td>
<p>an object of class lm, containing the specified design with random and/or fixed factors.</p>
</td></tr>
<tr><td><code id="gad_+3A_quasi.f">quasi.f</code></td>
<td>
<p>logical, indicating whether to use quasi F-ratio when there is no single error term appropriate in the analysis. Default to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>gad</code> returns an analysis of variance table using <code><a href="#topic+estimates">estimates</a></code> to identify the appropriate F-ratios and consequently p-values for any complex model of orthogonal or nested, fixed or random factors as described by Underwood(1997).
</p>


<h3>Value</h3>

<p>A &quot;<code>list</code>&quot; containing an object of class <code>"anova"</code> inheriting from class <code>"data.frame"</code>.
</p>


<h3>Author(s)</h3>

<p>Leonardo Sandrini-Neto (<a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a>)
</p>


<h3>References</h3>

<p>Underwood, A.J. 1997. <em>Experiments in Ecology</em>: Their Logical Design and Interpretation Using Analysis of Variance. Cambridge University Press, Cambridge.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estimates">estimates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
library(GAD)
data(rohlf95)
CG &lt;- as.fixed(rohlf95$cages)
MQ &lt;- as.random(rohlf95$mosquito)
model &lt;- lm(wing ~ CG + MQ%in%CG, data = rohlf95)
model.tab &lt;- gad(model)
model.tab

# Example 2
data(rats)
TR &lt;- as.fixed(rats$treat)
RA &lt;- as.random(rats$rat)
LI &lt;- as.random(rats$liver)
model2 &lt;- lm(glycog ~ TR + RA%in%TR + LI%in%RA%in%TR, data = rats)
model2.tab &lt;- gad(model2)
model2.tab

# Example 3
data(snails)
O &lt;- as.random(snails$origin)
S &lt;- as.random(snails$shore)
B &lt;- as.random(snails$boulder)
C &lt;- as.random(snails$cage)
model3 &lt;- lm(growth ~ O + S + O*S + B%in%S + O*(B%in%S) + C%in%(O*(B%in%S)), data = snails)
model3.tab &lt;- gad(model3)
model3.tab # 'no test' for shore
model3.tab2 &lt;- gad(model3, quasi.f = TRUE)
model3.tab2 # suitable test for shore
</code></pre>

<hr>
<h2 id='is.fixed'>Check if a factor is fixed</h2><span id='topic+is.fixed'></span>

<h3>Description</h3>

<p>This function works the same way as <code><a href="base.html#topic+is.factor">is.factor</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.fixed(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.fixed_+3A_x">x</code></td>
<td>
<p>a vector of data, usually a nominal variable encoded as a <code>"fixed factor"</code> using <code><a href="#topic+as.fixed">as.fixed</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>is.fixed</code> returns <code>TRUE</code> or <code>FALSE</code> depending on whether its argument is a fixed factor or not.
</p>


<h3>Author(s)</h3>

<p>Leonardo Sandrini-Neto (<a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is.random">is.random</a></code>, <code><a href="#topic+as.fixed">as.fixed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(rohlf95)
CG &lt;- as.fixed(rohlf95$cages)
MQ &lt;- as.random(rohlf95$mosquito)
is.fixed(CG)
is.random(MQ)
</code></pre>

<hr>
<h2 id='is.random'>Check if a factor is random</h2><span id='topic+is.random'></span>

<h3>Description</h3>

<p>This function works the same way as <code><a href="base.html#topic+is.factor">is.factor</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.random(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.random_+3A_x">x</code></td>
<td>
<p>a vector of data, usually a nominal variable encoded as a <code>"random factor"</code> using <code><a href="#topic+as.random">as.random</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>is.random</code> returns <code>TRUE</code> or <code>FALSE</code> depending on whether its argument is a random factor or not.
</p>


<h3>Author(s)</h3>

<p>Leonardo Sandrini-Neto (<a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is.fixed">is.fixed</a></code>, <code><a href="#topic+as.random">as.random</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(rohlf95)
CG &lt;- as.fixed(rohlf95$cages)
MQ &lt;- as.random(rohlf95$mosquito)
is.fixed(CG)
is.random(MQ)
</code></pre>

<hr>
<h2 id='pooling'>Post-hoc pooling</h2><span id='topic+pooling'></span>

<h3>Description</h3>

<p>Performs a <em>post-hoc</em> pooling by combining or completely excluding terms from linear models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pooling(object, term = NULL, method = "pool", anova.tab = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pooling_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+lm">lm</a></code>&quot;, containing the specified design with random and/or fixed factors.</p>
</td></tr>
<tr><td><code id="pooling_+3A_term">term</code></td>
<td>
<p>the term which will be removed from model.</p>
</td></tr>
<tr><td><code id="pooling_+3A_method">method</code></td>
<td>
<p>method for removing a term from the model. Could be <code>method = "eliminate"</code> for completely exclude the term from model,
or <code>method = "pool"</code> for pool the selected term with its appropriated F-ratio. Default to <code>method = "pool"</code>.</p>
</td></tr>
<tr><td><code id="pooling_+3A_anova.tab">anova.tab</code></td>
<td>
<p>an object containing the results returned by <code>gad</code> or <code>pooling</code> functions. See examples below.</p>
</td></tr>
</table>


<h3>Details</h3>


<p><em>Post-hoc</em> pooling is a procedure to remove terms from a model. It might be done by several reasons:
(i) lack of evidence against the null hypothesis of that term; (ii) a negative estimate of that term's component of variation (Fletcher and Underwood, 2002);
(iii) the hypothesis of interest can not be tested until some terms are excluded from the model (Anderson et al., 2008).
According to literature the term's p-value should exceed 0.25 before removing it (Underwood, 1997).<br />
</p>
<p>There are two different methods to remove a term from the model, determinated by <code>method</code> argument. When <code>method = "eliminate"</code>
the chosen term is completely excluded from the model and its sum of squares and degrees of freedom are pooled with the residual sum of squares and
degrees of freedom, as if the selected term had never been part of the model. When <code>method = "pool"</code> the chosen term's sum of squares and
degrees of freedom are pooled with its denominator's sum of squares and degrees of freedom. The removal of terms using <code>method = "pool"</code> will be
appropriated for most of situations (Anderson et al., 2008).<br />
</p>
<p>Note that removing a term has consequences for the construction of F-ratios (or quasi F-ratios), p-values and the estimation of components for the
remaining terms, so should be done wisely. When there is more than one term which might be removed from the model (which p-value exceed 0.25), it is
recommended to begin with the one having the smallest mean square (Anderson et. al, 2008).<br />
</p>
<p>Function <code>pooling</code> removes one term at once. After the removal of the term of interest, one should re-assess whether or not more terms should be
removed. If it is the case, the output of <code>pooling</code> function should be stored in a new object and the function should be run again, using this new
object in the <code>data</code> argument. This can be done successively. The way of <code>pooling</code> function does the analysis, step-by-step and storing the result
in a new object at each step, gives the user total control of what happens and makes it easier return to the previous results.

</p>


<h3>Value</h3>

<p>A list of length 4, containing the table of pooled terms (<code>$pool.table</code>), the mean squares estimates (<code>$mse</code>),
the F-ratio versus (<code>$f.versus</code>) and the result of the analysis of variance (<code>$anova</code>).
</p>


<h3>Author(s)</h3>

<p>Eliandro Gilbert (<a href="mailto:eliandrogilbert@gmail.com">eliandrogilbert@gmail.com</a>)
</p>


<h3>References</h3>

<p>Anderson, M.J., Gorley, R.N., Clarke, K.R. 2008. <em>PERMANOVA+ for PRIMER</em>: Guide to Software and Statistical Methods. PRIMER-E: Plymouth, UK.
</p>
<p>Fletcher, D.J., Underwood, A.J. 2002. How to cope with negative estimates of components of variance in ecological field studies. Journal of Experimental Marine Biology and Ecology 273, 89-95.
</p>
<p>Underwood, A.J. 1997. <em>Experiments in Ecology</em>: Their Logical Design and Interpretation Using Analysis of Variance. Cambridge University Press, Cambridge.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estimates">estimates</a></code>, <code><a href="#topic+gad">gad</a></code>, <code><a href="#topic+comp.var">comp.var</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(snails)
O &lt;- as.random(snails$origin)   # a random factor
S &lt;- as.random(snails$shore)    # a random factor orthogonal to origin
B &lt;- as.random(snails$boulder)  # a random factor nested in shore
C &lt;- as.random(snails$cage)     # a random factor nested in the combination of boulder and origin

model &lt;- lm(growth ~ O + S + O*S + B%in%S + O*(B%in%S) + C%in%(O*(B%in%S)),data = snails)
estimates(model, quasi.f = FALSE)  # 'no test' for shore
gad(model, quasi.f = FALSE)        # no results for shore term
estimates(model, quasi.f = TRUE)   # suitable test for shore
gad(model, quasi.f = TRUE)         # test result for shore

# An alternative of using linear combinations of mean squares is the pooling function.
model.tab &lt;- gad(model, quasi.f = FALSE) # stores the result of ANOVA on a new object
pooling(model, term = "S:B", method = "pool", anova.tab = model.tab)      # pooling terms
pooling(model, term = "S:B", method = "eliminate", anova.tab = model.tab) # or eliminating terms
</code></pre>

<hr>
<h2 id='rats'>Glycogen content of rat livers</h2><span id='topic+rats'></span>

<h3>Description</h3>

<p>Duplicate readings were made on each of three preparations of rat livers
from each of two rats for three different treatments (Sokal &amp; Rohlf, 1995).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rats)
</code></pre>


<h3>Format</h3>

<p>A data frame with 36 rows and 4 variables
</p>


<h3>Details</h3>


<ul>
<li><p> treat: a fixed factor with three levels
</p>
</li>
<li><p> rat: a random factor with two levels nested in treat
</p>
</li>
<li><p> liver: sample size
</p>
</li>
<li><p> glycog: response variable
</p>
</li></ul>



<h3>References</h3>

<p>Sokal, R.R., Rohlf, F.J. 1995. <em>Biometry</em>: The Principles and Practice of Statistics in Biological Research. 3rd Edition. W.H. Freeman and Co., New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(rats)
rats
</code></pre>

<hr>
<h2 id='rohlf95'>Mosquitos' wing data colleted by Rohlf and cited in Sokal &amp; Rohlf (1995)</h2><span id='topic+rohlf95'></span>

<h3>Description</h3>

<p>Three different types of cage are tested on the growth of <em>Aedes intrudens</em>, a kind of
mosquito pupae. In each one, four mosquitos are added and its wings measured twice. There are
24 observations (3 cages x 4 jars x 2 measures).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rohlf95)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 4 variables
</p>


<h3>Details</h3>


<ul>
<li><p> cages: a fixed factor with three levels (<code>cage 1, cage2, cage3</code>)
</p>
</li>
<li><p> mosquito: a random factor with four levels (<code>m1, m2, m3, m4</code>) nested in cages
</p>
</li>
<li><p> measure: sample size
</p>
</li>
<li><p> wing: response variable
</p>
</li></ul>



<h3>References</h3>

<p>Sokal, R.R., Rohlf, F.J. 1995. <em>Biometry</em>: The Principles and Practice of Statistics in Biological Research. 3rd Edition. W.H. Freeman and Co., New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(rohlf95)
rohlf95
</code></pre>

<hr>
<h2 id='snails'>Growth rates of snails on large boulders on different rock shores</h2><span id='topic+snails'></span>

<h3>Description</h3>

<p>This design was extracted from Underwood (1997), but data are artificial.
Snails were transplanted from origin to different shores. Several boulders
were used on each shore. Cages with snails of each origin on each boulder
were replicated. All factors (origin, shore, boulder and cage) are random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(snails)
</code></pre>


<h3>Format</h3>

<p>A data frame with 240 rows and 6 variables
</p>


<h3>Details</h3>


<ul>
<li><p> origin: a random factor with two levels (<code>O1, O2</code>)
</p>
</li>
<li><p> shore: a random factor with four levels (<code>S1, S2, S3, S4</code>) orthogonal to origin
</p>
</li>
<li><p> boulder: a random factor with three levels (<code>B1, B2, B3</code>) nested in shore
</p>
</li>
<li><p> cage: a random factor with two levels (<code>C1, C2</code>) nested in the combination of boulder and origin
</p>
</li>
<li><p> replicate: sample size
</p>
</li>
<li><p> growth: response variable
</p>
</li></ul>



<h3>References</h3>

<p>Underwood, A.J. 1997. <em>Experiments in Ecology</em>: Their Logical Design and Interpretation Using Analysis of Variance. Cambridge University Press, Cambridge.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)
data(snails)
snails
</code></pre>

<hr>
<h2 id='snk.test'>Student-Newman-Keuls (SNK) procedure</h2><span id='topic+snk.test'></span>

<h3>Description</h3>

<p>This function performs a SNK post-hoc test of means on the factors of a chosen term of the model, comparing among levels of one factor within each level of other factor or combination of factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>snk.test(object, term = NULL, among = NULL, within = NULL, anova.tab = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="snk.test_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+lm">lm</a></code>&quot; containing the specified design.</p>
</td></tr>
<tr><td><code id="snk.test_+3A_term">term</code></td>
<td>
<p>term of the model to be analysed. Argument <code>term</code> can be a main effect, an interaction or a nested factor, which must be specified using &quot;quotes&quot;. Use <code><a href="#topic+estimates">estimates</a></code> to see the right form to inform it. See examples below.</p>
</td></tr>
<tr><td><code id="snk.test_+3A_among">among</code></td>
<td>
<p>specifies the factor which levels will be compared among. Need to be specified if the term to be analysed envolves more than one factor.</p>
</td></tr>
<tr><td><code id="snk.test_+3A_within">within</code></td>
<td>
<p>specifies the factor or combination of factors that will be compared within level among.</p>
</td></tr>
<tr><td><code id="snk.test_+3A_anova.tab">anova.tab</code></td>
<td>
<p>an object containing the results returned by <code><a href="#topic+gad">gad</a></code> or <code><a href="#topic+pooling">pooling</a></code> functions. See examples below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>SNK is a stepwise procedure for hypothesis testing. First the sample means are sorted, then the pairwise studentized range (q) is calculated by dividing the differences between means by the standard error, which is based upon the average variance of the two samples.
</p>


<h3>Value</h3>

<p>A list containing the standard error, the degrees of freedom and pairwise comparisons among levels of one factor within each level of other(s) factor(s).
</p>


<h3>Author(s)</h3>

<p>Maurício Camargo (<a href="mailto:mauricio.camargo@furg.br">mauricio.camargo@furg.br</a>)
</p>
<p>Eliandro Gilbert (<a href="mailto:eliandrogilbert@gmail.com">eliandrogilbert@gmail.com</a>)
</p>
<p>Leonardo Sandrini-Neto (<a href="mailto:leonardosandrini@ufpr.br">leonardosandrini@ufpr.br</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gad">gad</a></code>, <code><a href="#topic+estimates">estimates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GAD)

# Example 1
data(rohlf95)
CG &lt;- as.fixed(rohlf95$cages)     # a fixed factor
MQ &lt;- as.random(rohlf95$mosquito) # a random factor nested in cages

model &lt;- lm(wing ~ CG + CG%in%MQ, data = rohlf95)
model.tab &lt;- gad(model) # storing ANOVA table in an object
model.tab               # checking ANOVA results
estimates(model)        # checking model structure

# Comparison among levels of mosquito ("MQ") within each level of cage ("CG")
snk.test(model, term = "CG:MQ", among = "CG", within = "MQ", anova.tab = model.tab)

# Example 2
data(snails)
O &lt;- as.random(snails$origin)   # a random factor
S &lt;- as.random(snails$shore)    # a random factor orthogonal to origin
B &lt;- as.random(snails$boulder)  # a random factor nested in shore
C &lt;- as.random(snails$cage)     # a random factor nested in the combination of boulder and origin
model2 &lt;- lm(growth ~ O + S + O*S + B%in%S + O*(B%in%S) + C%in%(O*(B%in%S)), data = snails)
model2.tab &lt;- gad(model2, quasi.f = FALSE) # storing ANOVA table in an object
model2.tab                                 # checking ANOVA results
estimates(model2, quasi.f = FALSE)         # checking model structure

# Comparison among levels of "origin"
snk.test(model2, term = "O", anova.tab = model2.tab)
# Comparison among levels of "shore" within each level of "origin"
snk.test(model2, term = "O:S", among = "S", within = "O", anova.tab = model2.tab)
# If term "O:S:B" were significant, we could try
snk.test(model2, term = "O:S:B", among = "B", within = "O:S", anova.tab = model2.tab)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
