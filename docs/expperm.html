<!DOCTYPE html><html><head><title>Help for package expperm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {expperm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#A'><p>A small random matrix</p></a></li>
<li><a href='#BG'><p>The Brualdi-Gibson method for computing an expected permutation matrix</p></a></li>
<li><a href='#BG_cpp'><p>The Brualdi-Gibson method for computing an expected permutation matrix using C++</p></a></li>
<li><a href='#brute'><p>Brute-force calculation of an expected permutation matrix</p></a></li>
<li><a href='#brute_cpp'><p>Brute-force calculation of an expected permutation matrix using C++</p></a></li>
<li><a href='#df1'><p>A small data frame of simulated records</p></a></li>
<li><a href='#df2'><p>A (second) small data frame of simulated records</p></a></li>
<li><a href='#expperm-package'><p>Computing Expectations and Marginal Likelihoods for Permutations</p></a></li>
<li><a href='#is.tridiagonal'><p>Checking a matrix is tridiagonal</p></a></li>
<li><a href='#ryser'><p>The Ryser method for computing an expected permutation matrix</p></a></li>
<li><a href='#ryser_cpp'><p>The Ryser method for computing an expected permutation matrix using C++</p></a></li>
<li><a href='#sink'><p>A variational approximation of an expected permutation matrix</p></a></li>
<li><a href='#sink_cpp'><p>A variational approximation of an expected permutation matrix using C++</p></a></li>
<li><a href='#triA'><p>A small random tridiagonal matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Computing Expectations and Marginal Likelihoods for Permutations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-05-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Ben Powell</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ben Powell &lt;ben.powell@york.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of functions for computing expected permutation matrices given a matrix of likelihoods for each individual assignment. It has been written to accompany the forthcoming paper 'Computing expectations and marginal likelihoods for permutations'. Publication details will be updated as soon as they are finalized.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.1)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-28 17:26:38 UTC; ben</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-28 21:03:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='A'>A small random matrix</h2><span id='topic+A'></span>

<h3>Description</h3>

<p>A small random matrix used only to demonstrate the package's algorithms in the <code>examples</code> sections of the package documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>A
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> with 7 rows and 7 columns.</p>

<hr>
<h2 id='BG'>The Brualdi-Gibson method for computing an expected permutation matrix</h2><span id='topic+BG'></span>

<h3>Description</h3>

<p>Computes the expected permutation matrix and marginal likelihood from a tridiagonal matrix of assignment likelihoods using the Brualdi-Gibson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BG(A, return.permanent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BG_+3A_a">A</code></td>
<td>
<p>A tridiagonal matrix of assignment likelihoods.</p>
</td></tr>
<tr><td><code id="BG_+3A_return.permanent">return.permanent</code></td>
<td>
<p>A logical value indicating whether the function should also return the permanent of <code>A</code>, which is then added to the output as an attribute.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>E(P)</code>, the expected permutation matrix corresponding to <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(triA)
BG(triA)
</code></pre>

<hr>
<h2 id='BG_cpp'>The Brualdi-Gibson method for computing an expected permutation matrix using C++</h2><span id='topic+BG_cpp'></span>

<h3>Description</h3>

<p>Computes the expected permutation matrix and marginal likelihood from a tridiagonal matrix of assignment likelihoods using the Brualdi-Gibson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BG_cpp(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BG_cpp_+3A_a">A</code></td>
<td>
<p>A tridiagonal matrix of assignment likelihoods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>E(P)</code>, the expected permutation matrix corresponding to <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(triA)
BG_cpp(triA)
</code></pre>

<hr>
<h2 id='brute'>Brute-force calculation of an expected permutation matrix</h2><span id='topic+brute'></span>

<h3>Description</h3>

<p>Computes an expected permutation matrix and marginal likelihood from a matrix of assignment likelihoods. The function literally enumerates all permutations so will be impractial for matrices with more than 10 rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brute(A, return.permanent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brute_+3A_a">A</code></td>
<td>
<p>A matrix of assignment likelihoods.</p>
</td></tr>
<tr><td><code id="brute_+3A_return.permanent">return.permanent</code></td>
<td>
<p>A logical value indicating whether the function should also return the permanent of <code>A</code>, which is then added to the output as an attribute.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>E(P)</code>, the expected permutation matrix corresponding to <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(A)
brute(A)
</code></pre>

<hr>
<h2 id='brute_cpp'>Brute-force calculation of an expected permutation matrix using C++</h2><span id='topic+brute_cpp'></span>

<h3>Description</h3>

<p>Computes an expected permutation matrix and marginal likelihood from a matrix of assignment likelihoods. The function literally enumerates all permutations so will be impractial for matrices with more than 10 rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brute_cpp(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brute_cpp_+3A_a">A</code></td>
<td>
<p>A matrix of assignment likelihoods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>E(P)</code>, the expected permutation matrix corresponding to <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(A)
brute_cpp(A)
</code></pre>

<hr>
<h2 id='df1'>A small data frame of simulated records</h2><span id='topic+df1'></span>

<h3>Description</h3>

<p>A small data frame of simulated records as might be found in a population census. This data is used to demonstrate the package's algorithms in a more realistic setting. It also allows for reproduction of the example towards the end of the paper that accompanies this package. The data is a subset of a larger set simulated by of P. McLeod, R. Heasman and I. Forbes of the UK's Office for National Statistics. At the time of publication this data is available at https://ec.europa.eu/eurostat/cros/content/job-training_en. The example below shows how we could compute a distance matrix for the records in dataframes <code>df1</code> and <code>df2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df1
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 18 rows and 3 columns.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(stringdist)
D&lt;-matrix(,n,n)
for(i in 1:n){for(j in 1:n){
 D[i,j]&lt;-stringdist(df1$PERNAME1[i],df2$PERNAME1[j]) + 
  stringdist(df1$PERNAME2[i],df2$PERNAME2[j],method="dl") + 
  stringdist(df1$DOB_YEAR[i],df2$DOB_Y#' EAR[j],method="dl")
}}

## End(Not run)
</code></pre>

<hr>
<h2 id='df2'>A (second) small data frame of simulated records</h2><span id='topic+df2'></span>

<h3>Description</h3>

<p>A small data frame of simulated records as might be found in a population census. This data is used to demonstrate the package's algorithms in a more realistic setting. It also allows for reproduction of the example towards the end of the paper that accompanies this package. The data is a subset of a larger set simulated by of P. McLeod, R. Heasman and I. Forbes of the UK's Office for National Statistics. At the time of publication this data is available at https://ec.europa.eu/eurostat/cros/content/job-training_en.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 18 rows and 3 columns.</p>

<hr>
<h2 id='expperm-package'>Computing Expectations and Marginal Likelihoods for Permutations</h2><span id='topic+expperm-package'></span><span id='topic+expperm'></span>

<h3>Description</h3>

<p>A set of functions for computing expected permutation matrices given a matrix of likelihoods for each individual assignment. It has been written to accompany the forthcoming paper 'Computing expectations and marginal likelihoods for permutations'. Publication details will be updated as soon as they are finalized.</p>


<h3>Details</h3>

<p>The DESCRIPTION file: </p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> expperm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Computing Expectations and Marginal Likelihoods for Permutations</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-05-23</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Ben Powell</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Ben Powell &lt;ben.powell@york.ac.uk&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> A set of functions for computing expected permutation matrices given a matrix of likelihoods for each individual assignment. It has been written to accompany the forthcoming paper 'Computing expectations and marginal likelihoods for permutations'. Publication details will be updated as soon as they are finalized.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 2.10)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Rcpp (&gt;= 1.0.1)</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> Rcpp</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> true</td>
</tr>
<tr>
 <td style="text-align: left;">
RoxygenNote: </td><td style="text-align: left;"> 6.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> testthat</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
A                       A small random matrix
BG                      The Brualdi-Gibson method for computing an
                        expected permutation matrix
BG_cpp                  The Brualdi-Gibson method for computing an
                        expected permutation matrix using C++
brute                   Brute-force calculation of an expected
                        permutation matrix
brute_cpp               Brute-force calculation of an expected
                        permutation matrix using C++
df1                     A small data frame of simulated records
df2                     A (second) small data frame of simulated
                        records
expperm-package         Computing Expectations and Marginal Likelihoods
                        for Permutations
is.tridiagonal          Checking a matrix is tridiagonal
ryser                   The Ryser method for computing an expected
                        permutation matrix
ryser_cpp               The Ryser method for computing an expected
                        permutation matrix using C++
sink                    A variational approximation of an expected
                        permutation matrix
sink_cpp                A variational approximation of an expected
                        permutation matrix using C++
triA                    A small random tridiagonal matrix
</pre>
<p>The package serves primarily to demonstrate the algorithms described in the accompanying paper, which is currently under review.
</p>
<p>We include versions, which are as similar as reasonably possible, of algorithms written in both R and C++. The R code is intended to facilitate testing, modification and re-use of the code while the C++ code is intended to implement the algorithms most efficiently for application to real problems.
</p>


<h3>Author(s)</h3>

<p>Ben Powell
</p>
<p>Maintainer: Ben Powell &lt;ben.powell@york.ac.uk&gt;
</p>


<h3>References</h3>

<p>Powell B., Smith P.A. (2019). &quot;Computing expectations and marginal likelihoods for permutations.&quot; (In Submission).
</p>

<hr>
<h2 id='is.tridiagonal'>Checking a matrix is tridiagonal</h2><span id='topic+is.tridiagonal'></span>

<h3>Description</h3>

<p>A function for checking whether a matrix is tridiagonal. The check is used before attempting to apply the BG method for computing the permanent, since the method is only applicable to tridiagonal matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.tridiagonal(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.tridiagonal_+3A_a">A</code></td>
<td>
<p>A matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical variable. <code>TRUE</code> if the <code>A</code> is tridiagonal, <code>FALSE</code> otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(A)
is.tridiagonal(A)
data(triA)
is.tridiagonal(triA)
</code></pre>

<hr>
<h2 id='ryser'>The Ryser method for computing an expected permutation matrix</h2><span id='topic+ryser'></span>

<h3>Description</h3>

<p>Computes the expected permutation matrix and marginal likelihood from a matrix of assignment likelihoods using the Ryser method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ryser(A, return.permanent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ryser_+3A_a">A</code></td>
<td>
<p>A matrix of assignment likelihoods.</p>
</td></tr>
<tr><td><code id="ryser_+3A_return.permanent">return.permanent</code></td>
<td>
<p>A logical value indicating whether the function should also return the permanent of <code>A</code>, which is then added to the output as an attribute.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>E(P)</code>, the expected permutation matrix corresponding to <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(A)
ryser(A)
</code></pre>

<hr>
<h2 id='ryser_cpp'>The Ryser method for computing an expected permutation matrix using C++</h2><span id='topic+ryser_cpp'></span>

<h3>Description</h3>

<p>Computes the expected permutation matrix and marginal likelihood from a matrix of assignment likelihoods using the Ryser algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ryser_cpp(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ryser_cpp_+3A_a">A</code></td>
<td>
<p>A matrix of assignment likelihoods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>E(P)</code>, the expected permutation matrix corresponding to <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(A)
ryser_cpp(A)
</code></pre>

<hr>
<h2 id='sink'>A variational approximation of an expected permutation matrix</h2><span id='topic+sink'></span>

<h3>Description</h3>

<p>Computes an approximate expected permutation matrix and marginal likelihood from a matrix of assignment likelihoods. The approximation minimizes a constrained KL divergence from the likelihood, and is computed via the repeated renormalization of the input's rows and columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sink(A, maxit = 99, return.permanent.bound = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sink_+3A_a">A</code></td>
<td>
<p>A matrix of assignment likelihoods.</p>
</td></tr>
<tr><td><code id="sink_+3A_maxit">maxit</code></td>
<td>
<p>An integer specifying the maximum number of steps used in the optimization.</p>
</td></tr>
<tr><td><code id="sink_+3A_return.permanent.bound">return.permanent.bound</code></td>
<td>
<p>A logical value indicating whether the function should also return an upper bound on the permanent of <code>A</code>, which is then added to the output as an attribute.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>E(P)</code>, the expected permutation matrix corresponding to <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(A)
sink(A)
</code></pre>

<hr>
<h2 id='sink_cpp'>A variational approximation of an expected permutation matrix using C++</h2><span id='topic+sink_cpp'></span>

<h3>Description</h3>

<p>Computes an approximate expected permutation matrix and marginal likelihood from a matrix of assignment likelihoods. The approximation minimizes a constrained KL divergence from the likelihood, and is computed via the repeated renormalization of the input's rows and columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sink_cpp(A, maxit = 99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sink_cpp_+3A_a">A</code></td>
<td>
<p>A matrix of assignment likelihoods.</p>
</td></tr>
<tr><td><code id="sink_cpp_+3A_maxit">maxit</code></td>
<td>
<p>An integer specifying the maximum number of steps used in the optimization.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>E(P)</code>, the expected permutation matrix corresponding to <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(A)
sink_cpp(A)
</code></pre>

<hr>
<h2 id='triA'>A small random tridiagonal matrix</h2><span id='topic+triA'></span>

<h3>Description</h3>

<p>A small random tridiagonal matrix used only to demonstrate the package's algorithms in the <code>examples</code> sections of the package documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triA
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> with 7 rows and 7 columns.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
