<!DOCTYPE html><html><head><title>Help for package RVIpkg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RVIpkg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Ave_func'><p>Optimizing data from UK Biobank</p></a></li>
<li><a href='#data'><p>Simulated volumes of subcortical structures</p></a></li>
<li><a href='#EP.GM'><p>Expected patterns of gray matter</p></a></li>
<li><a href='#EP.Subcortical'><p>Expected patterns of subcortical</p></a></li>
<li><a href='#EP.WM'><p>Expected patterns of white matter</p></a></li>
<li><a href='#RVI_func'><p>Regional Vulnerability Index</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Regional Vulnerability Index</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>The Regional Vulnerability Index (RVI), a statistical measure of brain structural abnormality, quantifies an individual's similarity to the expected pattern (effect size) of deficits in schizophrenia (Kochunov P, Fan F, Ryan MC, et al. (2020) &lt;<a href="https://doi.org/10.1002%2Fhbm.25045">doi:10.1002/hbm.25045</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-12 14:54:17 UTC; sigao</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Si Gao &lt;sgao@som.umaryland.edu&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Si Gao [aut, cre, dtc] (RVIpkg method development, code development,
    maintenance, data collection),
  Peter Kochunov [aut, dtc, cph, fnd] (RVIpkg concept, method
    development, data collection and funding),
  Kathryn Hatch [ctb, dtc] (RVIpkg testing and data collection),
  Yizhou Ma [ctb, dtc] (RVIpkg testing, method development and data
    collection),
  Fatima Talib [ctb] (RVIpkg testing and method)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-12 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Ave_func'>Optimizing data from UK Biobank</h2><span id='topic+Ave_func'></span>

<h3>Description</h3>

<p>The Ave_func() can optimize data from UK Biobank(UKB). It will rename field IDs of regional neuroimaging traits to abbreviation names, and then average data of left and right
hemispheres of the same field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ave_func(resp.range, type = "all", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ave_func_+3A_resp.range">resp.range</code></td>
<td>
<p>a numeric vector specifying column range of regional neuroimaging traits.</p>
</td></tr>
<tr><td><code id="Ave_func_+3A_type">type</code></td>
<td>
<p>a character string specifying data types of regional neuroimaging traits(i.e. All traits(type='all'), White matter(type='WM'),Gray matter(type='GM') or Subcortical(type='Subcortical'))</p>
</td></tr>
<tr><td><code id="Ave_func_+3A_data">data</code></td>
<td>
<p>a data frame contains regional neuroimaging traits with field IDs from UKBB. Default(type='all')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe of regional neuroimaging traits with abbreviated field names.
</p>


<h3>Note</h3>

<p>The Ave_func() function is developed at the Maryland Psychiatric Research Center, Department of Psychiatry,
University of Maryland School of Medicine. This project is supported by NIH R01 EB015611 grant. Please cite our funding if
you use this software.
</p>


<h3>References</h3>

<p>Kochunov P, Fan F, Ryan MC, et al. Translating ENIGMA schizophrenia findings using the regional vulnerability index: Association
with cognition, symptoms, and disease trajectory (2020). Hum Brain Mapp. 2020;10.1002/hbm.25045. <a href="https://doi.org/10.1002/hbm.25045">doi:10.1002/hbm.25045</a>
</p>
<p>R Core Team (2020). R: A language and environment for statistical computing. R
Foundation for Statistical Computing, Vienna, Austria. URL
https://www.R-project.org/.
</p>

<hr>
<h2 id='data'>Simulated volumes of subcortical structures</h2><span id='topic+data'></span>

<h3>Description</h3>

<p>Simulated volumes of subcortical structures of Schizophrenia spectrum disorder are used as an example for this function.
You can calculate RVI for this dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data
</code></pre>


<h3>Format</h3>

<p>A data frame with 196 rows and 12 variables:
</p>

<dl>
<dt>ID</dt><dd><p>subjects' ID</p>
</dd>
<dt>DX</dt><dd><p>indicators of control group</p>
</dd>
<dt>Age</dt><dd><p>subjects' age</p>
</dd>
<dt>Sex</dt><dd><p>subjects' gehder</p>
</dd>
<dt>Lateral.Ventricle</dt><dd><p>simulated volumes of lateral Ventricle</p>
</dd>
<dt>Thalamus</dt><dd><p>simulated volumes of Thalamus</p>
</dd>
<dt>Caudate</dt><dd><p>simulated volumes of Caudate</p>
</dd>
<dt>Putamen</dt><dd><p>simulated volumes of Putamen</p>
</dd>
<dt>Pallidum</dt><dd><p>simulated volumes of Pallidum</p>
</dd>
<dt>Hippocampus</dt><dd><p>simulated volumes of Hippocampus</p>
</dd>
<dt>Amygdala</dt><dd><p>simulated volumes of Amygdala</p>
</dd>
<dt>Left.Accumbens.area</dt><dd><p>simulated volumes of left Accumbens</p>
</dd>
</dl>



<h3>Source</h3>

<p>The 'data' dataset is from Maryland Psychiatric Research Center, Department of Psychiatry, University of Maryland School of Medicine.
</p>

<hr>
<h2 id='EP.GM'>Expected patterns of gray matter</h2><span id='topic+EP.GM'></span>

<h3>Description</h3>

<p>the expected patterns of gray matter in schizophrenia derived from large-scale meta-analyses by the ENIGMA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EP.GM
</code></pre>


<h3>Format</h3>

<p>A data frame with 33 rows and 13 variables:
</p>

<dl>
<dt>GM</dt><dd><p>grey matter thickness</p>
</dd>
<dt>SSD</dt><dd><p>the expected pattern of Schizophrenia Spectrum Disorder (<a href="https://doi.org/10.1016/j.biopsych.2018.04.023">doi:10.1016/j.biopsych.2018.04.023</a> table S4a)</p>
</dd>
<dt>MDD</dt><dd><p>the expected pattern of Major Depressive Disorder (<a href="https://doi.org/10.1038/mp.2016.60">doi:10.1038/mp.2016.60</a> table 1)</p>
</dd>
<dt>AD_ADNI</dt><dd><p>the expected pattern of Alzheimer's Disease (<a href="https://doi.org/10.1016/j.nicl.2021.102574">doi:10.1016/j.nicl.2021.102574</a> table S1)</p>
</dd>
<dt>AD_ADNIOSYRIX</dt><dd><p>the expected pattern of Alzheimer's Disease Neuroimaging Initiative + OSIRIX</p>
</dd>
<dt>BD</dt><dd><p>the expected pattern of Bipolar Disorder (<a href="https://doi.org/10.1038/mp.2017.73">doi:10.1038/mp.2017.73</a> table 1)</p>
</dd>
<dt>PD</dt><dd><p>the expected pattern of Parkinson's disease</p>
</dd>
<dt>Diabetes</dt><dd><p>the expected pattern of Diabetes</p>
</dd>
<dt>HighBP</dt><dd><p>the expected pattern of Hypertension</p>
</dd>
<dt>HighLipids</dt><dd><p>the expected pattern of Hyperlipidemia</p>
</dd>
<dt>MET</dt><dd><p>the expected pattern of Metabolic diseases (Diabetes, Hypertension and Hyperlipidemia)</p>
</dd>
<dt>DS_22q</dt><dd><p>the expected pattern of 22q11.2 deletion syndrome (<a href="https://doi.org/10.1038/s41380-018-0078-5">doi:10.1038/s41380-018-0078-5</a> table S10a)</p>
</dd>
<dt>Suicide</dt><dd><p>the expected pattern of suicidal ideation (<a href="https://doi.org/10.1101/2021.09.27.21264068">doi:10.1101/2021.09.27.21264068</a> table S8)</p>
</dd>
</dl>



<h3>Source</h3>

<p>The 'EP.GM' pattern is from Maryland Psychiatric Research Center, Department of Psychiatry, University of Maryland School of Medicine.
</p>

<hr>
<h2 id='EP.Subcortical'>Expected patterns of subcortical</h2><span id='topic+EP.Subcortical'></span>

<h3>Description</h3>

<p>the expected patterns of subcortical in schizophrenia derived from large-scale meta-analyses by the ENIGMA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EP.Subcortical
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 13 variables:
</p>

<dl>
<dt>Subcortical</dt><dd><p>subcortical grey matter volume</p>
</dd>
<dt>SSD</dt><dd><p>the expected pattern of Schizophrenia Spectrum Disorder (<a href="https://doi.org/10.1038/mp.2015.63">doi:10.1038/mp.2015.63</a> table 1)</p>
</dd>
<dt>MDD</dt><dd><p>the expected pattern of Major Depressive Disorder (<a href="https://doi.org/10.1038/mp.2015.69">doi:10.1038/mp.2015.69</a> table 1)</p>
</dd>
<dt>AD_ADNI</dt><dd><p>the expected pattern of Alzheimer's Disease (<a href="https://doi.org/10.1016/j.nicl.2021.102574">doi:10.1016/j.nicl.2021.102574</a>  table S1)</p>
</dd>
<dt>AD_ADNIOSYRIX</dt><dd><p>the expected pattern of Alzheimer's Disease Neuroimaging Initiative + OSIRIX</p>
</dd>
<dt>BD</dt><dd><p>the expected pattern of Bipolar Disorder (<a href="https://doi.org/10.1038/mp.2015.227">doi:10.1038/mp.2015.227</a> table 1)</p>
</dd>
<dt>PD</dt><dd><p>the expected pattern of Parkinson's disease</p>
</dd>
<dt>Diabetes</dt><dd><p>the expected pattern of Diabetes</p>
</dd>
<dt>HighBP</dt><dd><p>the expected pattern of Hypertension)</p>
</dd>
<dt>HighLipids</dt><dd><p>the expected pattern of Hyperlipidemia</p>
</dd>
<dt>MET</dt><dd><p>the expected pattern of Metabolic diseases (Diabetes, Hypertension and Hyperlipidemia)</p>
</dd>
<dt>DS_22q</dt><dd><p>the expected pattern of 22q11.2 deletion syndrome (<a href="https://doi.org/10.1176/appi.ajp.2019.19060583">doi:10.1176/appi.ajp.2019.19060583</a> table S14a)</p>
</dd>
<dt>Suicide</dt><dd><p>the expected pattern of suicidal ideation (<a href="https://doi.org/10.1101/2021.09.27.21264068">doi:10.1101/2021.09.27.21264068</a> table S8)</p>
</dd>
</dl>



<h3>Source</h3>

<p>The 'EP.Subcortical' pattern is from Maryland Psychiatric Research Center, Department of Psychiatry, University of Maryland School of Medicine.
</p>

<hr>
<h2 id='EP.WM'>Expected patterns of white matter</h2><span id='topic+EP.WM'></span>

<h3>Description</h3>

<p>the expected patterns of white matter in schizophrenia derived from large-scale meta-analyses by the ENIGMA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EP.WM
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 14 variables:
</p>

<dl>
<dt>WM</dt><dd><p>white matter fractional anisotropy</p>
</dd>
<dt>SSD</dt><dd><p>the expected pattern of Schizophrenia Spectrum Disorder (<a href="https://doi.org/10.1038/mp.2017.170">doi:10.1038/mp.2017.170</a> table 1; <a href="https://doi.org/10.1002/hbm.24998">doi:10.1002/hbm.24998</a> table 2)</p>
</dd>
<dt>MDD</dt><dd><p>the expected pattern of Major Depressive Disorder (<a href="https://doi.org/10.1038/s41380-019-0477-2">doi:10.1038/s41380-019-0477-2</a> Table S4; <a href="https://doi.org/10.1002/hbm.24998">doi:10.1002/hbm.24998</a> table 2)</p>
</dd>
<dt>AD_ADNI</dt><dd><p>the expected pattern of Alzheimer's Disease (<a href="https://doi.org/10.1016/j.nicl.2021.102574">doi:10.1016/j.nicl.2021.102574</a> table S1)</p>
</dd>
<dt>AD_ADNIOSYRIX</dt><dd><p>the expected pattern of Alzheimer's Disease Neuroimaging Initiative + OSIRIX</p>
</dd>
<dt>BD</dt><dd><p>the expected pattern of Bipolar Disorder (<a href="https://doi.org/10.1002/hbm.24998">doi:10.1002/hbm.24998</a> table 2)</p>
</dd>
<dt>Diabetes</dt><dd><p>the expected pattern of Diabetes</p>
</dd>
<dt>HighBP</dt><dd><p>the expected pattern of Hypertension</p>
</dd>
<dt>HighLipids</dt><dd><p>the expected pattern of Hyperlipidemia</p>
</dd>
<dt>MET</dt><dd><p>the expected pattern of Metabolic diseases (diabetes, hypertension and hyperlipidemia)</p>
</dd>
<dt>DS_22q</dt><dd><p>the expected pattern of 22q11.2 deletion syndrome (<a href="https://doi.org/10.1002/hbm.24998">doi:10.1002/hbm.24998</a> table 2; <a href="https://doi.org/10.1038/s41380-019-0450-0">doi:10.1038/s41380-019-0450-0</a> table S6)</p>
</dd>
<dt>PTSD</dt><dd><p>the expected pattern of Post-traumatic stress disorder (<a href="https://doi.org/10.1002/hbm.24998">doi:10.1002/hbm.24998</a> table 2)</p>
</dd>
<dt>TBI</dt><dd><p>the expected pattern of Traumatic brain injury (<a href="https://doi.org/10.1002/hbm.24998">doi:10.1002/hbm.24998</a> table 2)</p>
</dd>
<dt>OCD</dt><dd><p>the expected pattern of Obsessive-compulsive disorder (<a href="https://doi.org/10.1002/hbm.24998">doi:10.1002/hbm.24998</a> table 2)</p>
</dd>
</dl>



<h3>Source</h3>

<p>The 'EP.WM' pattern is from Maryland Psychiatric Research Center, Department of Psychiatry, University of Maryland School of Medicine.
</p>

<hr>
<h2 id='RVI_func'>Regional Vulnerability Index</h2><span id='topic+RVI_func'></span>

<h3>Description</h3>

<p>The Regional Vulnerability Index (RVI), a statistical measure of brain structural abnormality, quantifies an individual’s similarity to the expected pattern
(effect size) of deficits seen in schizophrenia derived from large-scale meta-analyses by the ENIGMA consortium. This package outputs the inverse-normal
transformed (INT) residuals, z-normalized INT residuals, RVI and Alignment Vulnerability Index (AVI).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RVI_func(
  ID,
  DXcontrol,
  covariates = NULL,
  resp.range,
  EP,
  sign = FALSE,
  fisherZ = FALSE,
  data
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RVI_func_+3A_id">ID</code></td>
<td>
<p>a column name of subject IDs in data.</p>
</td></tr>
<tr><td><code id="RVI_func_+3A_dxcontrol">DXcontrol</code></td>
<td>
<p>a character string specifying control subset(i.e. DXcontrol='DX==0'or DXcontrol='DX==&quot;CN&quot;'). Mean and standard deviation of z-normalization
should be calculated in healthy controls.</p>
</td></tr>
<tr><td><code id="RVI_func_+3A_covariates">covariates</code></td>
<td>
<p>an optional character vector specifying column names of covariates (i.e. Age, Sex). If covariates=NULL (the default), residuals will not be
adjusted for any covariate. If covariates are specified (i.e. covariates=c('Age','Sex')), residuals will be adjusted for covariates.</p>
</td></tr>
<tr><td><code id="RVI_func_+3A_resp.range">resp.range</code></td>
<td>
<p>a numeric vector specifying column indices of regional neuroimaging traits.</p>
</td></tr>
<tr><td><code id="RVI_func_+3A_ep">EP</code></td>
<td>
<p>a numeric vector specifying an expected pattern of regional neuroimaging traits. The expected patterns(EP.WM, EP.GM and EP.Subcortical) for white matter
fractional anisotropy (FA), cortical matter thickness and subcortical volume are included in the package (Note: If you use an expected pattern, you need to make
sure the order of regional neuroimaging traits in your data match up the corresponding order of the expected pattern). The patterns can be extract in the package
(i.e. RVIpkg::EP.WM$SSD, RVIpkg::EP.WM$MDD, RVIpkg::EP.WM$AD, RVIpkg::EP.WM$BD ,RVIpkg::EP.WM$PD .etc.). They were developed using neuroimaging data of UK Biobank (UKBB).</p>
</td></tr>
<tr><td><code id="RVI_func_+3A_sign">sign</code></td>
<td>
<p>a logical value indicating whether the AVI use signs from RVI.</p>
</td></tr>
<tr><td><code id="RVI_func_+3A_fisherz">fisherZ</code></td>
<td>
<p>a logical value indicating whether the result should generate fisher-z transformed RVI.</p>
</td></tr>
<tr><td><code id="RVI_func_+3A_data">data</code></td>
<td>
<p>a data frame contains a column of subject IDs, a column of controls, columns of covariates, columns of responses.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The RVI is developed as a simple measure of agreement between an individual's pattern of regional neuroimaging traits and the expected pattern of schizophrenia.
First, all observations of each regional neuroimaging trait are regressed out optional covariates using linear regression, and then residuals are extracted from
the model after removing effects of the optional covariates. The optional covariates could be age, sex, intracranial brain volume and/or .etc in the data. After
that the residuals are inverse-normal transformed based on residuals' ranks, and then the INT residuals are z-normalized/standardized using mean and standard
deviation of healthy controls to get z-normalized INT residuals. For each subject, the RVI is then calculated as a Pearson correlation coefficient between the
z-normalized INT residuals of the traits and corresponding expected pattern of the traits and the AVI is the dot product of the z-normalized INT residuals of the
traits and corresponding expected pattern of the traits. These expected patterns include cortical thickness, subcortical volume, and white matter FA for mental
illnesses and metabolic diseases.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>i.norm.resid</code></td>
<td>
<p>INT residuals</p>
</td></tr>
<tr><td><code>z.norm.resid</code></td>
<td>
<p>z-normalized/standardized INT residuals</p>
</td></tr>
<tr><td><code>RVI</code></td>
<td>
<p>RVI: the Pearson correlation coefficient between the z-normalized INT residuals and corresponding expected pattern;
AVI: the dot product of the z-normalized INT residuals and corresponding expected pattern;
RVI.fisherz: Fisher z-transformed RVI
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The RVI_func() function is developed at the Maryland Psychiatric Research Center, Department of Psychiatry,
University of Maryland School of Medicine. This project is supported by NIH R01 EB015611 grant. Please cite our funding if
you use this software.
</p>


<h3>References</h3>

<p>Kochunov P, Fan F, Ryan MC, et al. Translating ENIGMA schizophrenia findings using the regional vulnerability index: Association
with cognition, symptoms, and disease trajectory (2020). Hum Brain Mapp. 2020;10.1002/hbm.25045. <a href="https://doi.org/10.1002/hbm.25045">doi:10.1002/hbm.25045</a>
</p>
<p>R Core Team (2020). R: A language and environment for statistical computing. R
Foundation for Statistical Computing, Vienna, Austria. URL
https://www.R-project.org/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>EP1 &lt;- c(-0.37,0.31,-0.02,-0.08,-0.21,0.46,0.31,0.25)
RVI1 &lt;- RVI_func(ID='ID', DXcontrol='DX==0', covariates=c('Age','Sex'), resp.range=c(5:12),
EP=EP1, data=RVIpkg::data)
RVI2 &lt;- RVI_func(ID='ID', DXcontrol='DX==0', covariates=NULL, resp.range=c(5:12),
EP=EP1, data=RVIpkg::data)
EP2 &lt;- RVIpkg::EP.Subcortical$SSD
RVI3 &lt;- RVI_func(ID='ID', DXcontrol='DX==0', covariates=c('Age','Sex'), resp.range=c(5:12),
EP=EP2, data=RVIpkg::data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
