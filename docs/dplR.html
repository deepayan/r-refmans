<!DOCTYPE html><html lang="en"><head><title>Help for package dplR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dplR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dplR-package'>
<p>Dendrochronology Program Library in <span class="rlang"><b>R</b></span></p></a></li>
<li><a href='#ads'><p>Age-Dependent Spline</p></a></li>
<li><a href='#anos1'><p>Rothenburg Tree Ring Widths</p></a></li>
<li><a href='#as.rwl'><p> as.rwl</p></a></li>
<li><a href='#bai.in'><p> Basal Area Increment (Inside Out)</p></a></li>
<li><a href='#bai.out'><p> Basal Area Increment (Outside In)</p></a></li>
<li><a href='#bakker'>
<p>Basal Area Increment (Bakker)</p></a></li>
<li><a href='#ca533'><p>Campito Mountain Tree Ring Widths</p></a></li>
<li><a href='#cana157'><p>Twisted Tree Heartrot Hill Standard Chronology</p></a></li>
<li><a href='#caps'><p> Cook and Peters Smoothing Spline with User-Specified Rigidity and Frequency Cutoff</p></a></li>
<li><a href='#ccf.series.rwl'><p> Cross-Correlation between a Series and a Master Chronology</p></a></li>
<li><a href='#chron'><p>Build Mean Value Chronology</p></a></li>
<li><a href='#chron.ars'><p>Build ARSTAN Chronology</p></a></li>
<li><a href='#chron.ci'><p>Build Mean Value Chronology with Confidence Intervals</p></a></li>
<li><a href='#chron.stabilized'><p>Build Mean Value Chronology with Stabilized Variance</p></a></li>
<li><a href='#cms'><p> C-Method Standardization</p></a></li>
<li><a href='#co021'><p>Schulman Old Tree No. 1, Mesa Verde</p></a></li>
<li><a href='#combine.rwl'><p> Combine Tree-Ring Data Sets</p></a></li>
<li><a href='#common.interval'><p>Common Interval</p></a></li>
<li><a href='#corr.rwl.seg'><p> Compute Correlations between Series</p></a></li>
<li><a href='#corr.series.seg'><p> Compute Correlation between a Series and a Master Chronology</p></a></li>
<li><a href='#csv2rwl'><p> Read Ring Width File from CSV</p></a></li>
<li><a href='#detrend'><p> Detrend Multiple Ring-Width Series Simultaneously</p></a></li>
<li><a href='#detrend.series'><p> Detrend a Ring-Width Series</p></a></li>
<li><a href='#dplR-defunct'>
<p>Defunct functions in dplR</p></a></li>
<li><a href='#fill.internal.NA'><p>Fill Internal NA</p></a></li>
<li><a href='#gini.coef'><p> Calculate the Gini Coefficient</p></a></li>
<li><a href='#glk'><p> Calculate Gleichl√§ufigkeit</p></a></li>
<li><a href='#gp.d2pith'><p> Ponderosa Pine Distance to Pith Corresponding to <code>gp.rwl</code></p></a></li>
<li><a href='#gp.dbh'><p> Ponderosa Pine Stem Diameters and Bark Thickness (<code>gp.rwl</code>)</p></a></li>
<li><a href='#gp.po'><p> Ponderosa Pine Pith Offsets Corresponding to <code>gp.rwl</code></p></a></li>
<li><a href='#gp.rwl'><p> Ponderosa Pine Ring Widths from Gus Pearson Natural Area</p></a></li>
<li><a href='#hanning'><p> Hanning Filter</p></a></li>
<li><a href='#i.detrend'><p> Interactively Detrend Multiple Ring-Width Series</p></a></li>
<li><a href='#i.detrend.series'><p> Interactively Detrend a Ring-Width Series</p></a></li>
<li><a href='#insert.ring'><p> Edit a Ring-Width Series</p></a></li>
<li><a href='#interseries.cor'><p> Individual Series Correlation Against a Master Chronology</p></a></li>
<li><a href='#latexDate'>
<p>Date Conversion to Character in LaTeX Format</p></a></li>
<li><a href='#latexify'>
<p>Convert Character Strings for Use with LaTeX</p></a></li>
<li><a href='#morlet'><p> Perform a Continuous Morlet Wavelet Transform</p></a></li>
<li><a href='#net'>
<p>Calculate NET</p></a></li>
<li><a href='#nm046'><p>Los Alamos Tree Ring Widths</p></a></li>
<li><a href='#pass.filt'><p> Low-pass, high-pass, band-pass, and stop-pass filtering</p></a></li>
<li><a href='#plot.crn'><p> Plot a Tree-Ring Chronology</p></a></li>
<li><a href='#plot.crs'>
<p>Plotting crs Objects</p></a></li>
<li><a href='#plot.rwl'>
<p>Plotting Rwl Objects</p></a></li>
<li><a href='#po.to.wc'>
<p>Convert Pith Offset to Wood Completeness</p></a></li>
<li><a href='#pointer'><p> Calculates Pointer Years from a Group of Ring-Width Series</p></a></li>
<li><a href='#powt'><p>Power Transformation of Tree-Ring Data</p></a></li>
<li><a href='#print.redfit'>
<p>Printing Redfit Results</p></a></li>
<li><a href='#print.rwl.report'><p>Do some reporting on a RWL object</p></a></li>
<li><a href='#rasterPlot'>
<p>Add Raster Elements to Plot</p></a></li>
<li><a href='#rcs'><p> Regional Curve Standardization</p></a></li>
<li><a href='#read.compact'><p> Read <abbr><span class="acronym">DPL</span></abbr> Compact Format Ring Width File</p></a></li>
<li><a href='#read.crn'><p> Read Tucson Format Chronology File</p></a></li>
<li><a href='#read.fh'><p> Read Heidelberg Format Ring Width File</p></a></li>
<li><a href='#read.ids'><p> Read Site-Tree-Core <abbr><span class="acronym">ID</span></abbr>s</p></a></li>
<li><a href='#read.rwl'><p> Read Ring Width File</p></a></li>
<li><a href='#read.tridas'><p> Read Tree Ring Data Standard (TRiDaS) File</p></a></li>
<li><a href='#read.tucson'><p> Read Tucson Format Ring Width File</p></a></li>
<li><a href='#redfit'>
<p>Red-Noise Spectra of Time-Series</p></a></li>
<li><a href='#rwi.stats.running'><p> (Running Window) Statistics on Detrended Ring-Width Series</p></a></li>
<li><a href='#rwl.report'><p>Do some reporting on a RWL object</p></a></li>
<li><a href='#rwl.stats'><p> Calculate Descriptive Summary Statistics on Ring-Width Series</p></a></li>
<li><a href='#sea'><p> Superposed Epoch Analysis</p></a></li>
<li><a href='#seg.plot'><p> Segment Plot</p></a></li>
<li><a href='#sens1'><p> Calculate Mean Sensitivity</p></a></li>
<li><a href='#sens2'><p> Calculate Mean Sensitivity on Series with a Trend</p></a></li>
<li><a href='#series.rwl.plot'><p> Plot Series and a Master</p></a></li>
<li><a href='#sgc'><p>Synchronous Growth Changes</p></a></li>
<li><a href='#skel.plot'><p> Skeleton Plot</p></a></li>
<li><a href='#spag.plot'><p> Spaghetti Plot</p></a></li>
<li><a href='#ssf'><p> Simple Signal Free Standardization</p></a></li>
<li><a href='#sss'><p> Subsample Signal Strength</p></a></li>
<li><a href='#strip.rwl'><p>Chronology Stripping by <abbr><span class="acronym">EPS</span></abbr></p></a></li>
<li><a href='#tbrm'><p> Calculate Tukey's Biweight Robust Mean</p></a></li>
<li><a href='#time.rwl'>
<p>Retrieve or set the time values for rwl and crn objects</p></a></li>
<li><a href='#treeMean'><p>Calculate mean across cores in a tree</p></a></li>
<li><a href='#tridas.vocabulary'>
<p>Browse and Check Standard TRiDaS Vocabulary</p></a></li>
<li><a href='#uuid.gen'>
<p><abbr><span class="acronym">UUID</span></abbr> Generator</p></a></li>
<li><a href='#wa082'><p>Hurricane Ridge, Pacific silver fir</p></a></li>
<li><a href='#wavelet.plot'><p> Plot a Continuous Wavelet Transform</p></a></li>
<li><a href='#wc.to.po'>
<p>Convert Wood Completeness to Pith Offset</p></a></li>
<li><a href='#write.compact'><p> Write <abbr><span class="acronym">DPL</span></abbr> Compact Format Ring Width File</p></a></li>
<li><a href='#write.crn'><p> Write Tucson Format Chronology File</p></a></li>
<li><a href='#write.rwl'><p> Write Chronology File</p></a></li>
<li><a href='#write.tridas'><p> Write Tree Ring Data Standard (TRiDaS) file</p></a></li>
<li><a href='#write.tucson'><p> Write Tucson Format Chronology File</p></a></li>
<li><a href='#xdate.floater'><p> Crossdate an undated series</p></a></li>
<li><a href='#xskel.ccf.plot'><p> Skeleton Plot for Series and Master with Cross Correlation</p></a></li>
<li><a href='#xskel.plot'><p> Skeleton Plot for Series and Master</p></a></li>
<li><a href='#zof.anc'><p> Ancillary Data Corresponding to <code>zof.rwl</code></p></a></li>
<li><a href='#zof.rwl'><p> European Beech Ring Widths from Zofingen, Switzerland</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dendrochronology Program Library in R</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7.8</td>
</tr>
<tr>
<td>Copyright:</td>
<td>Authors and file inst/COPYRIGHTS</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, grid, stats, utils, lattice (&ge; 0.13-6),
Matrix (&ge; 1.0-3), digest (&ge; 0.2.3), matrixStats (&ge; 0.50.2),
png (&ge; 0.1-2), R.utils (&ge; 1.32.1), stringi (&ge; 0.2-3),
stringr (&ge; 0.4), XML (&ge; 2.1-0), signal, boot, lme4, lifecycle</td>
</tr>
<tr>
<td>Suggests:</td>
<td>Cairo (&ge; 1.5-0), dichromat (&ge; 1.2-3), foreach, forecast (&ge;
3.6), gmp (&ge; 0.5-5), iterators, knitr, RColorBrewer,
rmarkdown, testthat (&ge; 0.8), tikzDevice, waveslim</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform tree-ring analyses such as detrending, chronology
        building, and cross dating.  Read and write standard file formats
        used in dendrochronology.</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/OpenDendro/dplR">https://github.com/OpenDendro/dplR</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-30 01:42:40 UTC; andybunn</td>
</tr>
<tr>
<td>Author:</td>
<td>Andy Bunn [aut, cph, cre, trl],
  Mikko Korpela [aut, cph, trl],
  Franco Biondi [aut, cph],
  Filipe Campelo [aut, cph],
  Stefan Klesse [aut, cph],
  Pierre M√©rian [aut, cph],
  Fares Qeadan [aut, cph],
  Christian Zang [aut, cph],
  Allan Buras [ctb],
  Alice Cecile [ctb],
  Manfred Mudelsee [ctb],
  Michael Schulz [ctb],
  David Frank [ctb],
  Ronald Visser [ctb],
  Ed Cook [ctb],
  Kevin Anchukaitis [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andy Bunn &lt;bunna@wwu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-30 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dplR-package'>
Dendrochronology Program Library in <span class="rlang"><b>R</b></span>
</h2><span id='topic+dplR-package'></span><span id='topic+dplR'></span>

<h3>Description</h3>

<p>This package contains functions for performing some standard tree-ring
analyses.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> dplR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> <abbr><span class="acronym">GPL</span></abbr> (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><em>Main Functions</em>
</p>

<dl>
<dt><code><a href="#topic+read.rwl">read.rwl</a></code></dt><dd><p> reads rwl files </p>
</dd>
<dt><code><a href="#topic+detrend">detrend</a></code></dt><dd><p> detrends raw ring widths </p>
</dd>
<dt><code><a href="#topic+chron">chron</a></code></dt><dd><p> builds chronologies </p>
</dd>
<dt><code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code></dt><dd><p> crossdating function </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Bunn <a href="mailto:andy.bunn@wwu.edu">andy.bunn@wwu.edu</a> with major additions from Mikko
Korpela and other significant contributions from Franco Biondi, Filipe
Campelo, Pierre M√©rian, Fares Qeadan and Christian
Zang.  Function <code><a href="#topic+redfit">redfit</a></code> is an improved translation of
program REDFIT which is original work of Manfred Mudelsee and Michael
Schulz.  Jacob Cecile contributed a bug fix to
<code><a href="#topic+detrend.series">detrend.series</a></code>.  Allan Buras came up with the revised
formula of <code><a href="#topic+glk">glk</a></code> in dplR &gt;= 1.6.1.
</p>


<h3>References</h3>

<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Fritts, H. C. (2001) <em>Tree Rings and Climate</em>.
Blackburn.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-1-930665-39-2.
</p>

<hr>
<h2 id='ads'>Age-Dependent Spline</h2><span id='topic+ads'></span>

<h3>Description</h3>

<p>Applies an age-dependent smoothing spline to <code><var>y</var></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ads(y, nyrs0 = 50, pos.slope = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ads_+3A_y">y</code></td>
<td>
<p> a <code>numeric</code> vector, typically a tree-ring series. </p>
</td></tr>
<tr><td><code id="ads_+3A_nyrs0">nyrs0</code></td>
<td>
<p> a number greater than one, affecting the rigidity of the
initial spline.  A larger <code><var>nyrs0</var></code> produces a more 
rigid spline.</p>
</td></tr>
<tr><td><code id="ads_+3A_pos.slope">pos.slope</code></td>
<td>
<p> a <code>logical</code> flag.  Will allow for a positive
slope at the end of fitted value. If <code>FALSE</code> the
line will be horizontal. See details. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This implements the age-dependent smoothing spline similar to that described by Melvin (2004). In this implementation a cubic smoothing spline (<code><a href="#topic+caps">caps</a></code>) is fit to <code><var>y</var></code> with an initial stiffness of <code><var>nyrs0</var></code>. For each succesive measurement, the siffness is incremented by that ring index. This results in a spline is <code><var>nyrs0</var></code> flexible at the start of the series and grows progressively stiffer. This can help capture the initial fast growth of a juvinielle tree with a flexible spline that then progresses to a stiffer spline that can better model the constant growth commonly found in mature trees. In its details, the cubic smoothing spline follows the Cook and Peters (1981) spline with a 50% frequency cutoff. See Cook and Kairiukstis (1990) for more information.
</p>
<p>The default setting for <code><var>nyrs0</var></code> is 50 years which is approprite for trees with a classic growth model but a value of 10 or 20 might be more appropriate for a Hugershoff-like initial increase in growth. Cook (pers comm) suggests a value of 20 for RCS.
</p>
<p>If <code><var>pos.slope</var></code> is TRUE, the function will attempt to prevent a postive slope at the end of the series. In some cases when <code><var>ads</var></code> is used for detrending, a postive slope can be considered considered biologically unlikely. In those cases, the user can contrain the positive slope in the slpine. This works by calculating the spline and taking the first difference. Then the function finds the last (outside) index where the spline changes slope and fixes the spline values from the that point to the end. Finally the spline is rerun along this contrained curve. See examples for details. The wisdom of contraining the slope in this manner depends very much on expert knowledge of the system.
</p>


<h3>Value</h3>

<p>A filtered vector.
</p>


<h3>Author(s)</h3>

<p>Fortran code provided by Ed Cook. Ported and adapted for dplR by Andy Bunn.
</p>


<h3>References</h3>

<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of Dendrochronology: Applications in the Environmental Sciences</em>. Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Melvin, T. M. (2004) <em>Historical Growth Rates and Changing Climatic Sensitivity of Boreal Conifers</em>. PhD Thesis, Climatic Research Unit, School of Environmental Sciences, University of East Anglia.
</p>
<p>Cook, E. R. and Peters, K. (1981) The Smoothing Spline: A New Approach to Standardizing Forest Interior Tree-Ring Width Series for Dendroclimatic Studies. Tree-Ring Bulletin, 41, 45-53.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+caps">caps</a></code>, <code><a href="#topic+detrend">detrend</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a curve
data(co021)
aSeries &lt;- na.omit(co021$`641114`)
plot(aSeries,type="l",col="grey50")
lines(ads(y = aSeries),col="blue",lwd=2)

# show an artificial series with a Hugershoff-like curve.
a &lt;- 0.5
b &lt;- 1
g &lt;- 0.1
d &lt;- 0.25

n &lt;- 300
x &lt;- 1:n
y &lt;- I(a*x^b*exp(-g*x)+d)
# add some noise
y &lt;- y + runif(n=length(y),min = 0,max = 0.5)
# Plot with two different splines.
plot(y,type="l",col="grey50")
lines(ads(y,50),col="darkgreen",lwd=2) # bad
lines(ads(y,10),col="darkblue",lwd=2) # good

# now repeat with a positive slope to constrain
y &lt;- I(a*x^b*exp(-g*x)+d)
y[251:300] &lt;- y[251:300] + seq(0,0.25,length.out=50)
y &lt;- y + runif(n=length(y),min = 0,max = 0.5)
plot(y,type="l",col="grey50")
lines(ads(y,10),col="darkgreen",lwd=2) #bad?
lines(ads(y,10,pos.slope=FALSE),col="darkgreen",lwd=2,lty="dashed")
</code></pre>

<hr>
<h2 id='anos1'>Rothenburg Tree Ring Widths</h2><span id='topic+anos1'></span>

<h3>Description</h3>

<p>This data set gives the raw ring widths for Norway spruce <em>Picea
abies</em> at Rothenburg ob der Tauber, Bavaria, Germany.  There are 20
series from 10 trees.  Data set was created using
<code><a href="#topic+read.rwl">read.rwl</a></code> and saved to an .rda file using
<code><a href="base.html#topic+save">save</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(anos1)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 20 tree-ring series from 10 trees
in columns and 98 years in rows.  The correct stc mask for use with
<code><a href="#topic+read.ids">read.ids</a></code> is <code>c(5, 2, 1)</code>.</p>


<h3>References</h3>

<p>Zang, C. (2010) <em>Growth reaction of temperate forest tree species
to summer drought ‚Äì a multispecies tree-ring network
approach</em>.  Ph.D. thesis, Technische Universit√§t
M√ºnchen.
</p>

<hr>
<h2 id='as.rwl'> as.rwl </h2><span id='topic+as.rwl'></span>

<h3>Description</h3>

<p>Attempts to turn its argument into a rwl object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.rwl(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.rwl_+3A_x">x</code></td>
<td>
<p> a <code>data.frame</code> or <code>matrix</code> with series as columns and years as rows </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This tries to coerce <code>x</code> into class <code>c("rwl","data.frame")</code>. Failable.
</p>


<h3>Value</h3>

<p>An object of class <code>c("rwl", "data.frame")</code> with the series in
columns and the years as rows.  The series <abbr><span class="acronym">ID</span></abbr>s are the
column names and the years are the row names.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(stats)
library(utils)
## Toy
n &lt;- 100
## Make a data.frame that is tree-ring like
base.series &lt;- 0.75 + exp(-0.2 * 1:n)
foo &lt;- data.frame(x1 = base.series + abs(rnorm(n, 0, 0.25)),
                  x2 = base.series + abs(rnorm(n, 0, 0.25)),
                  x3 = base.series + abs(rnorm(n, 0, 0.25)),
                  x4 = base.series + abs(rnorm(n, 0, 0.25)),
                  x5 = base.series + abs(rnorm(n, 0, 0.25)),
                  x6 = base.series + abs(rnorm(n, 0, 0.25)))
# coerce to rwl and use plot and summary methods
foo &lt;- as.rwl(foo)
class(foo)
plot(foo, plot.type="spag")
summary(foo)
</code></pre>

<hr>
<h2 id='bai.in'> Basal Area Increment (Inside Out) </h2><span id='topic+bai.in'></span>

<h3>Description</h3>

<p>Convert multiple ring-width series to basal area increment (i.e., ring
area) going from the pith to the bark.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bai.in(rwl, d2pith = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bai.in_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> </p>
</td></tr>
<tr><td><code id="bai.in_+3A_d2pith">d2pith</code></td>
<td>
<p> an optional <code>data.frame</code> containing two variables.  If
present, then variable one (<code>series</code> in the example below)
gives the series <abbr><span class="acronym">ID</span></abbr> as either <code>characters</code> or
<code>factors</code>.  These must exactly match
<code>colnames(<var>rwl</var>)</code>.  Variable two (<code><var>d2pith</var></code> in
the example below) gives the distance from the innermost measured
ring to the pith of the tree in mm.  If <code><var>d2pith</var></code> is
<code>NULL</code> then the distance to pith is assumed to be zero for each
series (column) in <code><var>rwl</var></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This converts ring-width series (mm) to ring-area series (mm squared)
(aka basal area increments) based on the distance between the
innermost measured ring and the pith of the tree.  It is related to
<code><a href="#topic+bai.out">bai.out</a></code>, which calculates each ring area starting from
the outside of the tree and working inward.  Both methods assume a
circular cross section (Biondi 1999).  See the references below for
further details.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the ring areas for each series with
column names, row names and dimensions of <code><var>rwl</var></code>.
</p>


<h3>Note</h3>

<p> DendroLab website: <a href="https://dendrolaborg.wordpress.com/">https://dendrolaborg.wordpress.com/</a> </p>


<h3>Author(s)</h3>

<p> Code by Andy Bunn based on work from DendroLab, University of
Nevada Reno, <abbr><span class="acronym">USA</span></abbr>.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Biondi, F. (1999) Comparing tree-ring chronologies and repeated timber
inventories as forest monitoring tools.  <em>Ecological
Applications</em>, <b>9</b>(1), 216‚Äì227.
</p>
<p>Biondi, F. and Qeadan, F. (2008) A theory-driven approach to tree-ring
standardization: Defining the biological trend from expected basal area
increment.  <em>Tree-Ring Research</em>, <b>64</b>(2), 81‚Äì96.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bai.out">bai.out</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(stats)
library(utils)
## Toy
n &lt;- 100
## Make three fake tree-ring series to show that these funcs work on rwl objects
base.series &lt;- 0.75 + exp(-0.2 * 1:n)
rwl &lt;- data.frame(x1 = base.series + abs(rnorm(n, 0, 0.05)),
                  x2 = base.series + abs(rnorm(n, 0, 0.05)),
                  x3 = base.series + abs(rnorm(n, 0, 0.05)))

## The inside out method
foo &lt;- bai.in(rwl = rwl)
## The outside in method
bar &lt;- bai.out(rwl = rwl)

## Identical
head(bar)
head(foo)

## Use gp data
data(gp.rwl)
data(gp.d2pith)
foo &lt;- bai.in(rwl = gp.rwl, d2pith = gp.d2pith)
foo.crn &lt;- chron(foo)
yrs &lt;- time(foo.crn)
plot(yrs, foo.crn[, 1], type = "n",
     xlab = "Year", ylab = expression(mm^2))
lines(yrs, foo.crn[, 1], col = "grey", lty = "dashed")
lines(yrs, caps(foo.crn[, 1], nyrs = 32), col = "red", lwd = 2)
</code></pre>

<hr>
<h2 id='bai.out'> Basal Area Increment (Outside In) </h2><span id='topic+bai.out'></span>

<h3>Description</h3>

<p>Convert multiple ring-width series to basal area increment (i.e., ring
area) going from the bark to the pith.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bai.out(rwl, diam = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bai.out_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> </p>
</td></tr>
<tr><td><code id="bai.out_+3A_diam">diam</code></td>
<td>
<p> an optional <code>data.frame</code> containing two variables.
If present, variable one (<code><var>series</var></code> in the example below)
gives the series <abbr><span class="acronym">ID</span></abbr> as either <code>character</code>s or
<code>factor</code>s.  These must exactly match
<code>colnames(<var>rwl</var>)</code>.  Variable two (<code><var>diam</var></code> in the
example below) gives the diameter of the tree (in mm) up to the
outermost ring (e.g., the diameter of the tree where the core was
taken minus the thickness of the bark).  If <code><var>diam</var></code> is
<code>NULL</code> then the diameter is taken as twice the sum of the
widths for each series (column) in <code><var>rwl</var></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This converts ring-width series (mm) to ring-area series (mm squared)
(aka basal area increments) based on the diameter of the tree and the
width of each ring moving towards the pith of the tree.  It is related
to <code><a href="#topic+bai.in">bai.in</a></code>, which calculates each ring area starting from
the inside of the tree and working outward.  Both methods assume a
circular cross section (Biondi 1999).  See the references below for
further details.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the ring areas for each series with
column names, row names and dimensions of <code><var>rwl</var></code>.
</p>


<h3>Note</h3>

<p> DendroLab website: <a href="https://dendrolaborg.wordpress.com/">https://dendrolaborg.wordpress.com/</a> </p>


<h3>Author(s)</h3>

<p> Code by Andy Bunn based on work from DendroLab, University of
Nevada Reno, <abbr><span class="acronym">USA</span></abbr>.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Biondi, F. (1999) Comparing tree-ring chronologies and repeated timber
inventories as forest monitoring tools.  <em>Ecological
Applications</em>, <b>9</b>(1), 216‚Äì227.
</p>
<p>Biondi, F. and Qeadan, F. (2008) A theory-driven approach to tree-ring
standardization: Defining the biological trend from expected basal area
increment.  <em>Tree-Ring Research</em>, <b>64</b>(2), 81‚Äì96.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bai.in">bai.in</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
## Not run: 
library(stats)
## Toy
n &lt;- 100
## Make three fake tree-ring series to show that these funcs work on rwl objects
base.series &lt;- 0.75 + exp(-0.2 * 1:n)
rwl &lt;- data.frame(x1 = base.series + abs(rnorm(n, 0, 0.05)),
                  x2 = base.series + abs(rnorm(n, 0, 0.05)),
                  x3 = base.series + abs(rnorm(n, 0, 0.05)))

## The inside out method
foo &lt;- bai.in(rwl = rwl)
## The outside in method
bar &lt;- bai.out(rwl = rwl)

## Identical
head(bar)
head(foo)

## End(Not run)
## Use gp data
data(gp.rwl)
data(gp.dbh)
## dbh (minus the bark) from cm to mm 
gp.dbh2 &lt;- gp.dbh[, 1:2]
gp.dbh2[, 2] &lt;- (gp.dbh[, 2] - gp.dbh[, 3]) * 10
bar &lt;- bai.out(rwl = gp.rwl, diam = gp.dbh2)
bar.crn &lt;- chron(bar)
yrs &lt;- time(bar.crn)
plot(yrs, bar.crn[, 1], type = "n",
     xlab = "Year", ylab = expression(mm^2))
lines(yrs, bar.crn[, 1], col = "grey", lty = "dashed")
lines(yrs, caps(bar.crn[, 1], nyrs = 32), col = "red", lwd = 2)
</code></pre>

<hr>
<h2 id='bakker'>
Basal Area Increment (Bakker)
</h2><span id='topic+bakker'></span>

<h3>Description</h3>

<p>Convert multiple ring-width series to basal area increment (i.e., ring area) following the proportional method of Bakker (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  bakker(rwl, ancillary)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bakker_+3A_rwl">rwl</code></td>
<td>
<p>a <code>data.frame</code> with series as columns and years as rows such as that produced by <code>read.rwl</code></p>
</td></tr>
<tr><td><code id="bakker_+3A_ancillary">ancillary</code></td>
<td>
<p>A <code>data.frame</code> containing four columns. Column one (series in the example below) gives the series ID as either characters or factors. These must exactly match colnames(rwl). Column two (<code>PO</code>) gives the number of rings estimated to be missing to the pith. Column three (<code>d2pith</code>) gives the estimated distance to the pith (mm). Column four (<code>diam</code>) gives the diameter at breast height (DBH) in cm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This converts ring-width series (mm) to ring-area series (mm squared) (aka basal area increments) based on the diameter of the tree, the missing distance to the pith and the missing number of rings to the pith, following the proportional method for reconstructing historical tree diameters by Bakker (2005).
It prevents <code><a href="#topic+bai.out">bai.out</a></code> transformations from producing negative increments when the sum of all ring widths in a series is larger than DBH/2. It prevents <code><a href="#topic+bai.in">bai.in</a></code> transformations from producing too small values when the sum of all ring widths in a series is smaller than DBH/2.
</p>


<h3>Value</h3>

<p>A list containing the following objects:
</p>
<table role = "presentation">
<tr><td><code>DBHhist_raw</code></td>
<td>
<p><code>data.frame</code> with the reconstructed diameter for each series with column names, row names and dimensions of rwl.</p>
</td></tr>
<tr><td><code>baiBakker_raw</code></td>
<td>
<p><code>data.frame</code> with the basal area increments for each series with column names, row names and dimensions of rwl.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Code by Stefan Klesse. Adapted for dplR by Andy Bunn.
</p>


<h3>References</h3>

<p>Bakker, J.D., 2005. A new, proportional method for reconstructing historical tree diameters. Canadian Journal of Forest Research 35, 2515‚Äì2520. https://doi.org/10.1139/x05-136
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
data(zof.rwl)
data(zof.anc)
zof.bakker &lt;- bakker(rwl = zof.rwl,ancillary = zof.anc)
zof.bai &lt;- zof.bakker$baiBakker_raw

# first series bai
yrs &lt;- time(zof.rwl)
plot(yrs,zof.bai[,1],type="l",
     xlab="Year",
     ylab=expression(BAI~(mm^2)),
     main = colnames(zof.bai)[1])
  
</code></pre>

<hr>
<h2 id='ca533'>Campito Mountain Tree Ring Widths</h2><span id='topic+ca533'></span>

<h3>Description</h3>

<p>This data set gives the raw ring widths for bristlecone pine
<em>Pinus longaeva</em> at Campito Mountain in California,
<abbr><span class="acronym">USA</span></abbr>.  There are 34 series.  Data set was created using
<code><a href="#topic+read.rwl">read.rwl</a></code> and saved to an .rda file using
<code><a href="base.html#topic+save">save</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ca533)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 34 tree-ring series in columns and 1358
years in rows.
</p>


<h3>Source</h3>

<p>International tree-ring data bank, Accessed on 20-April-2021 at
<a href="https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/usa/ca533.rwl">https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/usa/ca533.rwl</a>
</p>


<h3>References</h3>

<p>Graybill, D. A. and LaMarche, Jr., V. C. (1983) Campito Mountain Data
Set.  <abbr><span class="acronym">IGBP</span></abbr> <abbr><span class="acronym">PAGES</span></abbr>/World Data Center for
Paleoclimatology Data Contribution Series 1983-CA533.RWL.
<abbr><span class="acronym">NOAA</span></abbr>/<abbr><span class="acronym">NCDC</span></abbr> Paleoclimatology Program, Boulder,
Colorado, <abbr><span class="acronym">USA</span></abbr>.
</p>

<hr>
<h2 id='cana157'>Twisted Tree Heartrot Hill Standard Chronology</h2><span id='topic+cana157'></span>

<h3>Description</h3>

<p>This data set gives the standard chronology for white spruce
<em>Picea glauca</em> at Twisted Tree Heartrot Hill in Yukon,
Canada.  Data set was created using <code><a href="#topic+read.crn">read.crn</a></code> and saved to
an .rda file using <code><a href="base.html#topic+save">save</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cana157)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing the standard chronology in column one
and the sample depth in column two.  There are 463 years
(1530‚Äì1992) in the rows.
</p>


<h3>Source</h3>

<p>International tree-ring data bank, Accessed on 20-April-2021 at
<a href="https://www.ncei.noaa.gov/pub/data/paleo/treering/chronologies/northamerica/canada/cana157.crn">https://www.ncei.noaa.gov/pub/data/paleo/treering/chronologies/northamerica/canada/cana157.crn</a>
</p>


<h3>References</h3>

<p>Jacoby, G., D‚ÄôArrigo, R. and Buckley, B. (1992) Twisted Tree
Heartrot Hill Data Set.  <abbr><span class="acronym">IGBP</span></abbr> <abbr><span class="acronym">PAGES</span></abbr>/World Data
Center for Paleoclimatology Data Contribution Series 1992-CANA157.CRN.
<abbr><span class="acronym">NOAA</span></abbr>/<abbr><span class="acronym">NCDC</span></abbr> Paleoclimatology Program, Boulder,
Colorado, <abbr><span class="acronym">USA</span></abbr>.
</p>

<hr>
<h2 id='caps'> Cook and Peters Smoothing Spline with User-Specified Rigidity and Frequency Cutoff </h2><span id='topic+caps'></span>

<h3>Description</h3>

<p>Applies a smoothing spline to <code><var>y</var></code> with rigidity determined
by two parameters: frequency response <code><var>f</var></code> at a wavelength
of <code><var>nyrs</var></code> years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caps(y, nyrs = 32, f = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="caps_+3A_y">y</code></td>
<td>
<p> a <code>numeric</code> vector, typically a tree-ring series. </p>
</td></tr>
<tr><td><code id="caps_+3A_nyrs">nyrs</code></td>
<td>
<p> a number greater than zero, affecting the rigidity of the spline.  If <code>nyrs</code> is between zero and one it will be treated as percentage of the length of the series. E.g., a value of 0.667 would 0.667 * length(y) or what is often called a 2/3 spline in the tree-ring literature. When <code><var>f</var></code> is kept constant, a larger <code><var>nyrs</var></code> produces a more rigid spline.</p>
</td></tr>
<tr><td><code id="caps_+3A_f">f</code></td>
<td>
<p> a number between 0 and 1 giving the frequency response at a wavelength of <code><var>nyrs</var></code> years.  When <code><var>nyrs</var></code> is kept constant, a smaller <code><var>f</var></code> produces a more rigid spline: At one extreme, <code><var>f</var> = 0</code> causes the function to return the least-squares straight line fit to the data.  At the other extreme, as <code><var>f</var></code> approaches 1 the result approaches the natural spline, i.e. the function outputs <code><var>y</var></code>. The default value is 0.5 and shouldn't be changed without a good reason.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This applies the classic smoothing spline from Cook and Peters (1981). The rigidity of the spline has a frequency response of 50% at a wavelength of <code><var>nyrs</var></code>. The references, of course, have more information.
</p>
<p>This function was introduced to <code><var>dplR</var></code> in version 1.7.3 and replaces the now defunct <code><var>ffcsaps</var></code>. Where <code><var>ffcsaps</var></code> was written entirely in R, <code><var>caps</var></code> is a wrapper for a Fortran subroutine from Ed Cook's ARSTAN program that is thousands of times faster.
</p>
<p>The default value of <code><var>nyrs</var></code> was changed to 32 from 2/3 length of <code><var>y</var></code> in version 1.7.8 based on a suggestion from Klesse (2021).
</p>
<p>Note: <code><var>caps</var></code> returns <code>NA</code> if there are any <code>NA</code> values in <code>y</code>. See examples.
</p>


<h3>Value</h3>

<p>A filtered vector.
</p>


<h3>Author(s)</h3>

<p>Fotran code provided by Ed Cook and adapted for dplR by Andy Bunn.
</p>


<h3>References</h3>

<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Cook, E. R. and Peters, K. (1981) The Smoothing Spline: A New Approach to Standardizing Forest Interior Tree-Ring Width Series for Dendroclimatic Studies. Tree-Ring Bulletin, 41, 45-53.
</p>
<p>Klesse, S. (2021) Critical Note on the Application of the &quot;Two-Third&quot;&quot; Spline. Dendrochronologia Volume 65: 125786
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ads">ads</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)

## Use first series from the Mesa Verde data set
data(co021)
series &lt;- co021[, 1]
series &lt;- series[!is.na(series)]
plot(series, type = "l", ylab = "Ring Width (mm)", col = "grey")
lines(caps(series, nyrs = 10), col = "red", lwd = 2)
lines(caps(series, nyrs = 100), col = "green", lwd = 2)
# A 2/3 spline, the default, 462.6667 yrs here
lines(caps(series), col = "blue", lwd = 2)
legend("topright",
       c("Series", "nyrs=10", "nyrs=100",
         paste("Default nyrs (", floor(length(series) * 2/3), ")", sep="")),
       fill=c("grey", "red", "green", "blue"))


## Note behavior when NA is encountered and
## take appropriate measures as demonstrated above
y &lt;- c(NA,NA,rnorm(100))
caps(y)

</code></pre>

<hr>
<h2 id='ccf.series.rwl'> Cross-Correlation between a Series and a Master Chronology </h2><span id='topic+ccf.series.rwl'></span>

<h3>Description</h3>

<p>Computes cross-correlations between a tree-ring series and a master
chronology built from a rwl object at user-specified lags and segments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccf.series.rwl(rwl, series, series.yrs = as.numeric(names(series)),
               seg.length = 50, bin.floor = 100, n = NULL,
               prewhiten = TRUE, biweight = TRUE, pcrit = 0.05,
               lag.max = 5, make.plot = TRUE,
               floor.plus1 = FALSE, series.x = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ccf.series.rwl_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as rows
such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_series">series</code></td>
<td>
<p> a <code>numeric</code> or <code>character</code> vector.  Usually a
tree-ring series.  If the length of the value is 1, the
corresponding column of <code><var>rwl</var></code> is selected (by name or
position) as the series and ignored when building the master
chronology.  Otherwise, the value must be <code>numeric</code>. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_series.yrs">series.yrs</code></td>
<td>
<p> a <code>numeric</code> vector giving the years of
<code><var>series</var></code>.  Defaults to
<code>as.numeric(names(<var>series</var>))</code>.  Ignored if
<code><var>series</var></code> is an index to a column of <code><var>rwl</var></code>. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_seg.length">seg.length</code></td>
<td>
<p> an even integral value giving length of segments in
years (e.g., 20, 50, 100 years). </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_bin.floor">bin.floor</code></td>
<td>
<p> a non-negative integral value giving the base for
locating the first segment (e.g., 1600, 1700, 1800
<abbr><span class="acronym">AD</span></abbr>).  Typically 0, 10, 50, 100, etc. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length
for the <code><a href="#topic+hanning">hanning</a></code> filter used for removal of low
frequency variation. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_pcrit">pcrit</code></td>
<td>
<p> a number between 0 and 1 giving the critical value for the
correlation test. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_lag.max">lag.max</code></td>
<td>
<p> an integral value giving the maximum lag at which to
calculate the <code><a href="stats.html#topic+ccf">ccf</a></code>. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_make.plot">make.plot</code></td>
<td>
 <p><code>logical</code> flag indicating whether to make a
plot. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_floor.plus1">floor.plus1</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code>, one year is
added to the base location of the first segment (e.g., 1601, 1701,
1801 <abbr><span class="acronym">AD</span></abbr>). </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_series.x">series.x</code></td>
<td>
 <p><code>logical</code> flag indicating whether to make the <code>series</code>
the <code>x</code> argument to <code><a href="stats.html#topic+ccf">ccf</a></code>. See Details. </p>
</td></tr>
<tr><td><code id="ccf.series.rwl_+3A_...">...</code></td>
<td>
<p> other arguments passed to plot. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the cross-correlation function between a
tree-ring series and a master chronology built from <code><var>rwl</var></code>
looking at correlations lagged positively and negatively using
<code><a href="stats.html#topic+ccf">ccf</a></code> at overlapping segments set by
<code><var>seg.length</var></code>.  For instance, with <code><var>lag.max</var></code> set
to 5, cross-correlations would be calculated at for each segment with
the master lagged at <code><var>k</var> = -5:5</code> years.
</p>
<p>The cross correlations are calculated calling
<code><a href="stats.html#topic+ccf">ccf</a></code> as <br />
<code>ccf(x=master, y=series, lag.max=lag.max, plot=FALSE)</code> if <code>series.x</code> is 
<code>FALSE</code> and as <code>ccf(x=series, y=master, lag.max=lag.max, plot=FALSE)</code> if 
<code>series.x</code> is <code>TRUE</code>.  This argument was introduced in dplR version 1.7.0.
Different users have different expectations about how missing or extra rings are 
notated. If <code>switch.x = FALSE</code> the behavior will be like COFECHA where a missing 
ring in a series produces a negative lag in the plot rather than a positive lag.
</p>
<p>Correlations are calculated for the first segment, then the
second segment and so on.  Correlations are only calculated for segments with
complete overlap with the master chronology.
</p>
<p>Each series (including those in the <code><var>rwl</var></code> object) is
optionally detrended as the residuals from a <code><a href="#topic+hanning">hanning</a></code>
filter with weight <code><var>n</var></code>.  The filter is not applied if
<code><var>n</var></code> is <code>NULL</code>.  Detrending can also be done via
prewhitening where the residuals of an <code><a href="stats.html#topic+ar">ar</a></code> model are
added to each series mean.  This is the default.  The master chronology
is computed as the mean of the <code><var>rwl</var></code> object using
<code><a href="#topic+tbrm">tbrm</a></code> if <code><var>biweight</var></code> is <code>TRUE</code> and
<code>rowMeans</code> if not.  Note that detrending typically changes the
length of the series. E.g., a <code><a href="#topic+hanning">hanning</a></code> filter will
shorten the series on either end by <code>floor(<var>n</var>/2)</code>.  The
prewhitening default will change the series length based on the
<code><a href="stats.html#topic+ar">ar</a></code> model fit.  The effects of detrending can be seen with
<code><a href="#topic+series.rwl.plot">series.rwl.plot</a></code>.
</p>


<h3>Value</h3>

<p>A <code>list</code> containing matrices <code><var>ccf</var></code> and
<code><var>bins</var></code>.  Matrix <code><var>ccf</var></code> contains the correlations
between the series and the master chronology at the lags window given
by <code><var>lag.max</var></code>.  Matrix <code><var>bins</var></code> contains the years
encapsulated by each bin.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p> Bunn, A. G. (2010) Statistical and visual crossdating 
in R using the dplR library.  <em>Dendrochronologia</em>,
<b>28</b>(4), 251‚Äì258.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code>, <code><a href="#topic+corr.series.seg">corr.series.seg</a></code>,
<code><a href="#topic+skel.plot">skel.plot</a></code>, <code><a href="#topic+series.rwl.plot">series.rwl.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
dat &lt;- co021
## Create a missing ring by deleting a year of growth in a random series
flagged &lt;- dat$"641143"
flagged &lt;- c(NA, flagged[-325])
names(flagged) &lt;- rownames(dat)
dat$"641143" &lt;- NULL
ccf.100 &lt;- ccf.series.rwl(rwl = dat, series = flagged, seg.length = 100)
## Not run: 
flagged2 &lt;- co021$"641143"
names(flagged2) &lt;- rownames(dat)
ccf.100.1 &lt;- ccf.series.rwl(rwl = dat, seg.length = 100,
                            series = flagged2)
## Select series by name or column position
ccf.100.2 &lt;- ccf.series.rwl(rwl = co021, seg.length = 100,
                            series = "641143")
ccf.100.3 &lt;- ccf.series.rwl(rwl = co021, seg.length = 100,
                            series = which(colnames(co021) == "641143"))
identical(ccf.100.1, ccf.100.2) # TRUE
identical(ccf.100.2, ccf.100.3) # TRUE

## End(Not run)
</code></pre>

<hr>
<h2 id='chron'>Build Mean Value Chronology</h2><span id='topic+chron'></span>

<h3>Description</h3>

<p>This function builds a mean value chronology, typically from a
<code>data.frame</code> of detrended ring widths as produced by
<code><a href="#topic+detrend">detrend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chron(x, biweight = TRUE, prewhiten = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chron_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> of (usually detrended) ring widths with
<code>rownames(<var>x</var>)</code> containing years and <code>colnames(x)</code>
containing each series <abbr><span class="acronym">ID</span></abbr> such as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code></p>
</td></tr>
<tr><td><code id="chron_+3A_biweight">biweight</code></td>
<td>
<p><code>logical</code> flag.  If <abbr><span class="acronym">TRUE</span></abbr> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a>.</code></p>
</td></tr>
<tr><td><code id="chron_+3A_prewhiten">prewhiten</code></td>
<td>
<p><code>logical</code> flag.  If <abbr><span class="acronym">TRUE</span></abbr> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code> prior to averaging.</p>
</td></tr>
<tr><td><code id="chron_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="stats.html#topic+ar">ar</a></code> when
<code>prewhiten</code> is <code>TRUE</code>.  For example, use <code>aic</code>
and <code>order.max</code> to control the order of the AR model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This either averages the rows of the <code>data.frame</code> using a mean or
a robust mean (the so-called standard chronology) or can do so from
the residuals of an AR process (the residual chronology).
</p>
<p>Note that the residual chronology in this function will return different
values than the residual chronology from <code><a href="#topic+chron.ars">chron.ars</a></code> which uses
a slightly different method for determining AR order.
</p>


<h3>Value</h3>

<p>An object of of class <code>crn</code> and <code>data.frame</code> with the standard chronology, residual chronology (if prewhitening was performed), and the sample depth. The years are stored as row numbers.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Fritts, H. C. (2001) <em>Tree Rings and Climate</em>.  Blackburn.
<abbr><span class="acronym">ISBN-13</span></abbr>: 978-1-930665-39-2.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code>, <code><a href="#topic+detrend">detrend</a></code>,
<code><a href="stats.html#topic+ar">ar</a></code>, <code><a href="#topic+crn.plot">crn.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
ca533.crn &lt;- chron(ca533.rwi)
plot(ca533.crn,xlab="Year",ylab="RWI")
## With residual chron
ca533.crn2 &lt;- chron(ca533.rwi, prewhiten = TRUE)
plot(ca533.crn2,xlab="Year",ylab="RWI")
</code></pre>

<hr>
<h2 id='chron.ars'>Build ARSTAN Chronology</h2><span id='topic+chron.ars'></span>

<h3>Description</h3>

<p>This function builds three varieties of the mean-value chronology, including 
the ARSTAN chronology, typically from a
<code>data.frame</code> of detrended ring widths as produced by
<code><a href="#topic+detrend">detrend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chron.ars(x, biweight=TRUE, maxLag=10, firstAICmin=TRUE, 
  verbose=TRUE, prewhitenMethod=c("ar.yw","arima.CSS-ML"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chron.ars_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> of (usually detrended) ring widths with
<code>rownames(<var>x</var>)</code> containing years and <code>colnames(x)</code>
containing each series <abbr><span class="acronym">ID</span></abbr> such as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code></p>
</td></tr>
<tr><td><code id="chron.ars_+3A_biweight">biweight</code></td>
<td>
<p><code>logical</code> flag.  If <abbr><span class="acronym">TRUE</span></abbr> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a>.</code></p>
</td></tr>
<tr><td><code id="chron.ars_+3A_maxlag">maxLag</code></td>
<td>
<p>an <code>integer</code> giving the maximum lag to consider in the AR pooling.</p>
</td></tr>
<tr><td><code id="chron.ars_+3A_firstaicmin">firstAICmin</code></td>
<td>
<p><code>logical</code> flag.  If <abbr><span class="acronym">TRUE</span></abbr> the final AR order is
elected using the first AIC minimum otherwise the order is selected by the 
overall minimum.</p>
</td></tr>
<tr><td><code id="chron.ars_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> flag.  If <abbr><span class="acronym">TRUE</span></abbr> the function prints 
information from the AR modeling to the screen.</p>
</td></tr>
<tr><td><code id="chron.ars_+3A_prewhitenmethod">prewhitenMethod</code></td>
<td>
<p> a <code>character</code> vector to determine the AR model 
fitting. See details below.  Possible values are either &quot;ar.yw&quot; or 
&quot;arima.CSS-ML&quot;. Can be abbreviated. Defaults to &quot;ar.yw&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This produces three mean-value chronologies: standard, residual, and ARSTAN. Users unfamiliar with the concept behind the ARSTAN method should look to Cook (1985) for background and inspiration.
</p>
<p>The standard chronology is the (biweight) mean value across rows and identical to <code><a href="#topic+chron">chron</a></code>. 
</p>
<p>The residual chronology is the prewhitened chronology as described by Cook  (1985) and uses uses multivariate autoregressive modeling to determine the order of the AR process. It's important to note that residual chronology produced here is different than the simple residual chronology produced by <code><a href="#topic+chron">chron</a></code> which returns the residuals of an AR process using a naive call to <code><a href="stats.html#topic+ar">ar</a></code>.  But in practice the results will be similar. For more on the residual chronology in this function, see pp. 153-154 in Cook's 1985 dissertation. 
</p>
<p>The ARSTAN chronology  builds on the residual chronology but returns a re-whitened chronology where the pooled AR coefficients from the multivariate autoregressive modeling are reintroduced. See references for details.
</p>
<p>The order of the AR model is selected from the pooled AR coefficients by AIC using either the first (local) AIC minimum otherwise or the overall minimum considering the maximum lag (argument <code>maxLag</code>).
</p>
<p>Once the AR order is determined an AR(p) model is fit using either <code><a href="stats.html#topic+ar">ar</a></code> via the Yule-Walker method or by <code><a href="stats.html#topic+arima">arima</a></code> via conditional-sum-of-squares to find starting values, then maximum likelihood. It is possible that the model will not converge in which case a warning is produced. The AR fitting is determined via <code>prewhitenMethod</code> and defaults to using <code><a href="stats.html#topic+ar">ar</a></code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the standard, residual, and ARSTAN chronologies. The sample depth is also included.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn with contributions from Kevin Achukaitis and Ed Cook.
Much of the function is a port of Cook's FORTRAN code. </p>


<h3>References</h3>

<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Cook, E. R. (1985). A Time Series Analysis Approach to Tree Ring 
Standardization. PhD thesis, The University of Arizona.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+chron">chron</a></code>, <code><a href="#topic+crn.plot">crn.plot</a></code>,
<code><a href="stats.html#topic+ar">ar</a></code>, <code><a href="stats.html#topic+arima">arima</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
data(co021)
co021.rwi &lt;- detrend(rwl = co021, method = "AgeDepSpline")
co021.crn &lt;- chron.ars(co021.rwi)
plot(co021.crn,xlab="Year",ylab="RWI",add.spline=TRUE,nyrs=20)
cor(co021.crn)
</code></pre>

<hr>
<h2 id='chron.ci'>Build Mean Value Chronology with Confidence Intervals</h2><span id='topic+chron.ci'></span>

<h3>Description</h3>

<p>This function builds a mean value chronology with bootstrapped confidence 
intervals, typically from a <code>data.frame</code> of detrended ring widths as produced by
<code><a href="#topic+detrend">detrend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chron.ci(x, biweight=TRUE, conf=0.95, R=100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chron.ci_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> of (usually detrended) ring widths with
<code>rownames(<var>x</var>)</code> containing years and <code>colnames(x)</code>
containing each series <abbr><span class="acronym">ID</span></abbr> such as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code></p>
</td></tr>
<tr><td><code id="chron.ci_+3A_biweight">biweight</code></td>
<td>
<p><code>logical</code> flag.  If <abbr><span class="acronym">TRUE</span></abbr> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a>.</code></p>
</td></tr>
<tr><td><code id="chron.ci_+3A_conf">conf</code></td>
<td>
<p><code>numeric</code>. A scalar for the confidence level.</p>
</td></tr>
<tr><td><code id="chron.ci_+3A_r">R</code></td>
<td>
<p><code>integer</code>. The number of bootstrap replicates. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This either averages the rows of the <code>data.frame</code> using a mean or
a robust mean (the so-called standard chronology) and calculates boostrapped confidence intervals using the normal approximation. The function will fail if there are any rows in <code>x</code> that contain only one sample and in practice there should be several samples in a row. One of the guiding principles of bootstrapping is that the population is to the sample as the sample is to the bootstrap samples.
</p>


<h3>Value</h3>

<p>An object of of class <code>data.frame</code> with the standard chronology, the upper and lower confidence interval, and the sample depth. The years are stored as row numbers.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code>, <code><a href="#topic+detrend">detrend</a></code>,
<code><a href="boot.html#topic+boot">boot</a></code>, <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
data(wa082)
# truncate to a sample depth of five
wa082Trunc &lt;- wa082[rowSums(!is.na(wa082))&gt;4,]
# detrend
wa082RWI &lt;- detrend(wa082Trunc, method="AgeDepSpline")
# bootstrap the chronology and
wa082Crn &lt;- chron.ci(wa082RWI, biweight = TRUE, R = 100, conf = 0.99)
head(wa082Crn)
# plot (this is so much easier in ggplot!)
wa082Crn$yrs &lt;- time(wa082Crn)
xx &lt;- c(wa082Crn$yrs,rev(wa082Crn$yrs))
yy &lt;- c(wa082Crn$lowerCI,rev(wa082Crn$upperCI))
plot(wa082Crn$yrs,wa082Crn$std,type="n",ylim=range(yy),
     ylab="RWI",xlab="Year",main="Chronology with CI")
polygon(x=xx,y=yy,col = "grey",border = NA)
lines(wa082Crn$yrs,wa082Crn$std)
</code></pre>

<hr>
<h2 id='chron.stabilized'>Build Mean Value Chronology with Stabilized Variance</h2><span id='topic+chron.stabilized'></span>

<h3>Description</h3>

<p>This function builds a variance stabilized mean-value chronology, typically from a
<code>data.frame</code> of detrended ring widths as produced by
<code><a href="#topic+detrend">detrend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chron.stabilized(x, winLength, biweight = TRUE, running.rbar = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chron.stabilized_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> of ring widths with
<code>rownames(<var>x</var>)</code> containing years and <code>colnames(x)</code>
containing each series <abbr><span class="acronym">ID</span></abbr> such as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code></p>
</td></tr>
<tr><td><code id="chron.stabilized_+3A_winlength">winLength</code></td>
<td>
<p>a odd <code>integer</code> specifying the window length.</p>
</td></tr>
<tr><td><code id="chron.stabilized_+3A_biweight">biweight</code></td>
<td>
<p><code>logical</code> flag.  If <abbr><span class="acronym">TRUE</span></abbr> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a>.</code></p>
</td></tr>
<tr><td><code id="chron.stabilized_+3A_running.rbar">running.rbar</code></td>
<td>
<p><code>logical</code> flag.  If <abbr><span class="acronym">TRUE</span></abbr> the running interseries correlation is returned as well. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variance of a mean chronology depends on the variance of the individual samples, the number of series averaged together, and their interseries correlation (Wigley et al. 1984). As the number of series commonly decreases towards the beginning of a chronology averaging introduces changes in variance that are a solely an effect of changes in sample depth.
</p>
<p>Additionally, time-dependent changes in interseries correlation can cause artificial variance changes of the final mean chronology. The function <code>chron.stabilized</code> accounts for both temporal changes in the interseries correlation and sample depth to produce a mean value chronology with stabilized variance.
</p>
<p>The basic correction centers around the use of the effective independent sample size, <code>Neff</code>, which considers sample replication and mean interseries correlation between the samples at every time. This is defined as: <code>Neff = n(t) / 1+(n(t)-1)rbar(t)</code>
</p>
<p>where <code>n(t)</code> is the number of series at time <code>t</code>, and <code>rbar</code> is the interseries correlation (see <code><a href="#topic+interseries.cor">interseries.cor</a></code>). Multiplication of the mean time series with the square root of <code>Neff</code> at every time <code>t</code> theoretically results in variance that is independent of sample size. In the limiting cases, when the <code>rbar</code> is zero or unity, <code>Neff</code> obtains values of the true sample size and unity, respectively.
</p>


<h3>Value</h3>

<p>An object of of class <code>crn</code> and <code>data.frame</code> with the variance stabilized chronology, running interseries correlation ('if <code>running.bar=TRUE</code>), and the sample depth.
</p>


<h3>Author(s)</h3>

<p> Original code by David Frank and adapted for dplR by Stefan Klesse. Patched and improved by Andy Bunn. 
</p>


<h3>References</h3>

<p>Frank, D, Esper, J, Cook, E, (2006) <em>On variance adjustments in tree-ring chronology development</em>. Tree rings in archaeology, climatology and ecology, TRACE 4, 56‚Äì66
</p>
<p>Frank, D, Esper, J, Cook, E, (2007) <em>Adjustment for proxy number and coherence in a large-scale temperature reconstruction</em>. Geophysical Research Letters 34
</p>
<p>Wigley, T, Briffa K, Jones P (1984) <em>On the Average Value of Correlated Time Series, with Applications in Dendroclimatology and Hydrometeorology</em>. J. Climate Appl. Meteor., 23, 201‚Äì213
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+chron">chron</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
data(co021)
co021.rwi &lt;- detrend(co021,method = "Spline")
co021.crn &lt;- chron(co021.rwi)
co021.crn2 &lt;- chron.stabilized(co021.rwi,
                                winLength=101,
                                biweight = TRUE,
                                running.rbar = FALSE)
yrs &lt;- time(co021)
plot(yrs,co021.crn$std,type="l",col="grey")
lines(yrs,co021.crn2$adj.crn,col="red")
</code></pre>

<hr>
<h2 id='cms'> C-Method Standardization </h2><span id='topic+cms'></span>

<h3>Description</h3>

<p>Detrend multiple ring-width series simultaneously using the C-method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cms(rwl, po, c.hat.t = FALSE, c.hat.i = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cms_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> </p>
</td></tr>
<tr><td><code id="cms_+3A_po">po</code></td>
<td>
<p> a <code>data.frame</code> containing two variables.  Variable one
(<code><var>series</var></code> in the example below) gives the series
<abbr><span class="acronym">ID</span></abbr> as either <code>character</code>s or <code>factor</code>s.  These
must exactly match <code>colnames(<var>rwl</var>)</code>.  Variable two
(<code><var>pith.offset</var></code> in the example below) must be integral
values and give the years from the beginning of the core to the pith
(or center) of the tree. </p>
</td></tr>
<tr><td><code id="cms_+3A_c.hat.t">c.hat.t</code></td>
<td>
<p> a <code>logical</code> indicating whether to export the
C-curves for each tree by biological age. </p>
</td></tr>
<tr><td><code id="cms_+3A_c.hat.i">c.hat.i</code></td>
<td>
<p> a <code>logical</code> indicating whether to export the
expected ring widths for each series. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method detrends and standardizes tree-ring series by calculating
a growth curve based on constant annual basal area increment.  The
method is based on the &ldquo;assumption that constant growth is
expressed by a constant basal area increment distributed over a
growing surface&rdquo; (Biondi and Qeadan 2008).  The detrending is the
estimation and removal of the tree‚Äôs natural biological
growth trend.  The standardization is done by dividing each series by
the growth trend to produce units in the dimensionless ring-width
index (<abbr><span class="acronym">RWI</span></abbr>).
</p>
<p>This attempts to remove the low frequency variability that is due to
biological or stand effects.
</p>
<p>See the reference below for further details.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the dimensionless and detrended
ring-width indices with column names, row names and dimensions of
<code><var>rwl</var></code> if <code><var>c.hat.t</var></code> is <code>FALSE</code> and
<code><var>c.hat.i</var></code> is <code>FALSE</code>.
</p>
<p>Otherwise a <code>list</code> of length 2 or 3 containing the <abbr><span class="acronym">RWI</span></abbr>
<code>data.frame</code>, a <code>data.frame</code> containing the C-curves for
each tree (<code><var>c.hat.t</var></code>), and/or a vector containing the
C-values for each tree (<code><var>c.hat.i</var></code>) depending on the output
flags.  See Eq. 12 in Biondi and Qeadan (2008) for more detail on
<code><var>c.hat.t</var></code>, and <code><var>c.hat.i</var></code>.
</p>


<h3>Note</h3>

<p> DendroLab website: <a href="https://dendrolaborg.wordpress.com/">https://dendrolaborg.wordpress.com/</a> </p>


<h3>Author(s)</h3>

<p>Code provided by DendroLab based on programming by F. Qeadan and
F. Biondi, University of Nevada Reno, <abbr><span class="acronym">USA</span></abbr> and adapted for
dplR by Andy Bunn.  Patched and improved by Mikko Korpela.
</p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) A theory-driven approach to tree-ring
standardization: Defining the biological trend from expected basal area
increment.  <em>Tree-Ring Research</em>, <b>64</b>(2), 81‚Äì96.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+detrend">detrend</a></code>, <code><a href="#topic+chron">chron</a></code>, <code><a href="#topic+rcs">rcs</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
data(gp.rwl)
data(gp.po)
gp.rwi &lt;- cms(rwl = gp.rwl, po = gp.po)
gp.crn &lt;- chron(gp.rwi)
crn.plot(gp.crn, add.spline = TRUE)
## c.hat
gp.rwi &lt;- cms(rwl = gp.rwl, po = gp.po, c.hat.t = TRUE, c.hat.i = TRUE)
dotchart(gp.rwi$c.hat.i, ylab = "Series", xlab = expression(hat(c)[i]))
tmp &lt;- gp.rwi$c.hat.t
plot(tmp[, 1], type = "n", ylim = range(tmp, na.rm = TRUE),
     xlab = "Cambial Age", ylab = expression(hat(c)[t]))
apply(tmp, 2, lines)
</code></pre>

<hr>
<h2 id='co021'>Schulman Old Tree No. 1, Mesa Verde</h2><span id='topic+co021'></span>

<h3>Description</h3>

<p>This data set gives the raw ring widths for Douglas fir
<em>Pseudotsuga menziesii</em> at Mesa Verde in Colorado, <abbr><span class="acronym">USA</span></abbr>.
There are 35 series.  Data set was created using <code><a href="#topic+read.rwl">read.rwl</a></code>
and saved to an .rda file using <code><a href="base.html#topic+save">save</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(co021)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 35 tree-ring series in columns and 788
years in rows.
</p>


<h3>Source</h3>

<p>International tree-ring data bank, Accessed on 20-April-2021 at
<a href="https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/usa/co021.rwl">https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/usa/co021.rwl</a>
</p>


<h3>References</h3>

<p>Schulman, E. (1963) Schulman Old Tree No. 1 Data Set.  <abbr><span class="acronym">IGBP</span></abbr>
<abbr><span class="acronym">PAGES</span></abbr>/World Data Center for Paleoclimatology Data
Contribution Series 1983-CO021.RWL.  <abbr><span class="acronym">NOAA</span></abbr>/<abbr><span class="acronym">NCDC</span></abbr>
Paleoclimatology Program, Boulder, Colorado, <abbr><span class="acronym">USA</span></abbr>.
</p>

<hr>
<h2 id='combine.rwl'> Combine Tree-Ring Data Sets </h2><span id='topic+combine.rwl'></span>

<h3>Description</h3>

<p> This function combines any number of <code>data.frames</code> of
tree-ring data into one <code>data.frame</code>.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>combine.rwl(x, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine.rwl_+3A_x">x</code></td>
<td>
<p> either a <code>data.frame</code> to be combined with
<code><var>y</var></code>, or a <code>list</code> of <code>data.frame</code>s to be
combined. </p>
</td></tr> <tr><td><code id="combine.rwl_+3A_y">y</code></td>
<td>
<p>a <code>data.frame</code> to be combined with
<code>data.frame</code> <code><var>x</var></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The sequence of years in each <code>data.frame</code> must be
increasing and continuous.  The output produced by the function
also fulfills this condition.  If the input is differently formatted,
the result will be wrong.</p>


<h3>Value</h3>

<p>An object of class <code>c("rwl", "data.frame")</code> with the series in 
columns and the years as
rows.  The keycodes are the column names and the years are the row
names. </p>


<h3>Author(s)</h3>

<p> Christian Zang.  Patched by Mikko Korpela. </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
data(co021)
combi1 &lt;- combine.rwl(list(ca533, co021))
## or alternatively for data.frames to combine
combi2 &lt;- combine.rwl(ca533, co021)
identical(combi1, combi2) # TRUE
</code></pre>

<hr>
<h2 id='common.interval'>Common Interval</h2><span id='topic+common.interval'></span>

<h3>Description</h3>

<p>This function finds the common interval on a set of tree-ring widths
such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>common.interval(rwl, type=c("series", "years", "both"),
                make.plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="common.interval_+3A_rwl">rwl</code></td>
<td>
<p>a <code>data.frame</code> of ring widths with
<code>rownames(<var>x</var>)</code> containing years and <code>colnames(<var>x</var>)</code>
containing each series <abbr><span class="acronym">ID</span></abbr> such as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code></p>
</td></tr>
<tr><td><code id="common.interval_+3A_type">type</code></td>
<td>
<p>a <code>character</code> string of
<code>"series"</code>, <code>"years"</code>, or <code>"both"</code>.  Argument
matching is performed. </p>
</td></tr>
<tr><td><code id="common.interval_+3A_make.plot">make.plot</code></td>
<td>
<p>a <code>logical</code> indicating if a plot should be drawn </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This trims an <code>rwl</code> object to a common interval that maximizes
the number of series (<code>type="series"</code>), the number of years
(<code>type="years"</code>), or a compromise between the two
(<code>type="both"</code>).  A modified <code><a href="#topic+seg.plot">seg.plot</a></code> can be drawn
as well.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with <code>colnames(<var>x</var>)</code> and
<code>rownames(<var>x</var>)</code>.
</p>


<h3>Author(s)</h3>

<p> Filipe Campelo, Andy Bunn and Mikko Korpela </p>


<h3>See Also</h3>

 <p><code><a href="#topic+seg.plot">seg.plot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
co021.s &lt;- common.interval(co021, type="series", make.plot=TRUE)
co021.y &lt;- common.interval(co021, type="years", make.plot=TRUE)
co021.b &lt;- common.interval(co021, type="both", make.plot=TRUE)

dim(co021)
dim.s &lt;- dim(co021.s)
dim.s       # the highest number of series
prod(dim.s) #   (33 series x 288 years = 9504)
dim.y &lt;- dim(co021.y)
dim.y       # the highest number of years
prod(dim.y) #   (27 series x 458 years = 12366)
dim.b &lt;- dim(co021.b)
dim.b       # compromise solution
prod(dim.b) #   (28 series x 435 years = 12180)
</code></pre>

<hr>
<h2 id='corr.rwl.seg'> Compute Correlations between Series </h2><span id='topic+corr.rwl.seg'></span>

<h3>Description</h3>

<p>Computes the correlation between each tree-ring series in a rwl object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr.rwl.seg(rwl, seg.length = 50, bin.floor = 100, n = NULL,
             prewhiten = TRUE, pcrit = 0.05, biweight = TRUE,
             method = c("spearman", "pearson","kendall"),
             make.plot = TRUE, label.cex = 1, floor.plus1 = FALSE,
             master = NULL,
             master.yrs = as.numeric(if (is.null(dim(master))) {
                              names(master)
                          } else {
                              rownames(master)
                          }),
             ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr.rwl.seg_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_seg.length">seg.length</code></td>
<td>
<p> an even integral value giving length of segments in
years (e.g., 20, 50, 100 years). </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_bin.floor">bin.floor</code></td>
<td>
<p> a non-negative integral value giving the base for
locating the first segment (e.g., 1600, 1700, 1800
<abbr><span class="acronym">AD</span></abbr>).  Typically 0, 10, 50, 100, etc. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length
for the <code><a href="#topic+hanning">hanning</a></code> filter used for removal of low
frequency variation. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_pcrit">pcrit</code></td>
<td>
<p> a number between 0 and 1 giving the critical value for
the correlation test. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_method">method</code></td>
<td>
<p>Can be either <code>"pearson"</code>, <code>"kendall"</code>, or
<code>"spearman"</code> which indicates the correlation coefficient to be
used.  Defaults to <code>"spearman"</code>.  See <code><a href="stats.html#topic+cor.test">cor.test</a></code>. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_make.plot">make.plot</code></td>
<td>
 <p><code>logical flag</code> indicating whether to make a
plot. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_label.cex">label.cex</code></td>
<td>
 <p><code>numeric</code> scalar for the series labels on the
plot.  Passed to <code><var>axis.cex</var></code> in <code><a href="graphics.html#topic+axis">axis</a></code>. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_floor.plus1">floor.plus1</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code>, one year is
added to the base location of the first segment (e.g., 1601, 1701,
1801 <abbr><span class="acronym">AD</span></abbr>). </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_master">master</code></td>
<td>
 <p><code>NULL</code>, a <code>numeric</code> <code>vector</code> or a
<code>matrix</code>-like object of <code>numeric</code> values, including a
<code>data.frame</code>.  If <code>NULL</code>, a number of master chronologies,
one for each series in <code><var>rwl</var></code>, is built from
<code><var>rwl</var></code> using the leave-one-out principle.  If a
<code>vector</code>, the function uses this as the master chronology.  If
a <code>matrix</code> or <code>data.frame</code>, this object is used for
building the master chronology (no leave-one-out). </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_master.yrs">master.yrs</code></td>
<td>
<p> a <code>numeric</code> vector giving the years of
<code><var>series</var></code>.  Defaults to <code>names</code> or <code>rownames</code> of 
<code><var>master</var></code> coerced to <code>numeric</code> type. </p>
</td></tr>
<tr><td><code id="corr.rwl.seg_+3A_...">...</code></td>
<td>
<p> other arguments passed to plot. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates correlation serially between each tree-ring
series and a master chronology built from all the other series in the
<code><var>rwl</var></code> object (leave-one-out principle).  Optionally, the
user may give a <code><var>master</var></code> chronology (a <code>vector</code>) as an
argument.  In the latter case, the same master chronology is used for
all the series in the <code><var>rwl</var></code> object.  The user can also
choose to give a <code><var>master</var></code> <code>data.frame</code> (series as
columns, years as rows), from which a single master chronology is
built.
</p>
<p>Correlations are done for each segment of the series where segments
are lagged by half the segment length (e.g., 100-year segments would
be overlapped by 50-years).  The first segment is placed according to
<code><var>bin.floor</var></code>.  The minimum bin year is calculated as
<code>ceiling(<var>min.yr</var>/<var>bin.floor</var>)*<var>bin.floor</var></code> where
<code><var>min.yr</var></code> is the first year in either the <code><var>rwl</var></code>
object or the user-specified <code><var>master</var></code> chronology, whichever
is smaller.  For example if the first year is 626 and
<code><var>bin.floor</var></code> is 100 then the first bin would start in 700.
If <code><var>bin.floor</var></code> is 10 then the first bin would start in 630.
</p>
<p>Correlations are calculated for the first segment, then the second
segment and so on.  Correlations are only calculated for segments with
complete overlap with the master chronology.  For now, correlations are
Spearman‚Äôs rho calculated via <code><a href="stats.html#topic+cor.test">cor.test</a></code> using
<code>method = "spearman"</code>.
</p>
<p>Each series (including those in the rwl object) is optionally
detrended as the residuals from a <code><a href="#topic+hanning">hanning</a></code> filter with
weight <code><var>n</var></code>.  The filter is not applied if <code><var>n</var></code> is
<code>NULL</code>.  Detrending can also be done via prewhitening where the
residuals of an <code><a href="stats.html#topic+ar">ar</a></code> model are added to each series
mean.  This is the default.  The master chronology is computed as the
mean of the <code><var>rwl</var></code> object using <code><a href="#topic+tbrm">tbrm</a></code> if
<code><var>biweight</var></code> is <code>TRUE</code> and <code>rowMeans</code> if not.  Note
that detrending can change the length of the series.  E.g., a
<code><a href="#topic+hanning">hanning</a></code> filter will shorten the series on either end by
<code>floor(<var>n</var>/2)</code>.  The prewhitening default will change the
series length based on the <code><a href="stats.html#topic+ar">ar</a></code> model fit.  The effects of
detrending can be seen with <code><a href="#topic+series.rwl.plot">series.rwl.plot</a></code>.
</p>
<p>The function is typically invoked to produce a plot where each segment
for each series is colored by its correlation to the master
chronology.  Green segments are those that do not overlap completely
with the width of the bin.  Blue segments are those that correlate
above the user-specified critical value.  Red segments are those that
correlate below the user-specified critical value and might indicate a
dating problem.
</p>


<h3>Value</h3>

<p>A <code>list</code> containing matrices <code><var>spearman.rho</var></code>,
<code><var>p.val</var></code>, <code><var>overall</var></code>, <code><var>bins</var></code>,  
<code><var>rwi</var></code>, vector <code><var>avg.seg.rho</var></code>,
numeric <code><var>seg.lag</var></code>, <code><var>seg.length</var></code>, <code><var>pcrit</var></code>, 
<code><var>label.cex</var></code>.  An additional <code>character</code>
<code><var>flags</var></code> is also returned if any segments fall below the
critical value.  Matrix <code><var>spearman.rho</var></code> contains the
correlations for each series by bin.  Matrix <code><var>p.val</var></code>
contains the p-values on the correlation for each series by
bin.  Matrix <code><var>overall</var></code> contains the average correlation and
p-value for each series.  Matrix <code><var>bins</var></code> contains the years
encapsulated by each bin.  The vector <code><var>avg.seg.rho</var></code>
contains the average correlation for each bin. Matrix <code><var>rwi</var></code>
contains the detrended rwl data, the numerics <code><var>seg.lag</var></code>, 
<code><var>seg.length</var></code>, <code><var>pcrit</var></code>, <code><var>label.cex</var></code> 
are from the oroginal call and used to pass into <code><var>plot.crs</var></code>. 
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

<p><code><a href="#topic+corr.series.seg">corr.series.seg</a></code>, <code><a href="#topic+skel.plot">skel.plot</a></code>,
<code><a href="#topic+series.rwl.plot">series.rwl.plot</a></code>, <code><a href="#topic+ccf.series.rwl">ccf.series.rwl</a></code>,
<code><a href="#topic+plot.crs">plot.crs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
crs &lt;- corr.rwl.seg(co021, seg.length = 100, label.cex = 1.25)
names(crs)
## Average correlation and p-value for the first few series
head(crs$overall)
## Average correlation for each bin
crs$avg.seg.rho
</code></pre>

<hr>
<h2 id='corr.series.seg'> Compute Correlation between a Series and a Master Chronology </h2><span id='topic+corr.series.seg'></span>

<h3>Description</h3>

<p>Compute correlation between a tree-ring series and a master chronology by
segment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr.series.seg(rwl, series, series.yrs = as.numeric(names(series)),
                seg.length = 50, bin.floor = 100, n = NULL,
                prewhiten = TRUE, biweight = TRUE, 
                method = c("spearman", "pearson","kendall"),
                pcrit = 0.05,
                make.plot = TRUE, floor.plus1 = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr.series.seg_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_series">series</code></td>
<td>
<p> a <code>numeric</code> or <code>character</code> vector.  Usually a
tree-ring series.  If the length of the value is 1, the
corresponding column of <code><var>rwl</var></code> is selected (by name or
position) as the series and ignored when building the master
chronology.  Otherwise, the value must be <code>numeric</code>. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_series.yrs">series.yrs</code></td>
<td>
<p> a <code>numeric</code> vector giving the years of
<code><var>series</var></code>.  Defaults to
<code>as.numeric(names(<var>series</var>))</code>.  Ignored if
<code><var>series</var></code> is an index to a column of <code><var>rwl</var></code>. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_seg.length">seg.length</code></td>
<td>
<p> an even integral value giving length of segments in
years (e.g., 20, 50, 100 years). </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_bin.floor">bin.floor</code></td>
<td>
<p> a non-negative integral value giving the base for
locating the first segment (e.g., 1600, 1700, 1800
<abbr><span class="acronym">AD</span></abbr>).  Typically 0, 10, 50, 100, etc. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length
for the <code><a href="#topic+hanning">hanning</a></code> filter used for removal of low
frequency variation. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_method">method</code></td>
<td>
<p>Can be either <code>"pearson"</code>, <code>"kendall"</code>, or
<code>"spearman"</code> which indicates the correlation coefficient to be
used.  Defaults to <code>"spearman"</code>.  See <code><a href="stats.html#topic+cor.test">cor.test</a></code>. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_pcrit">pcrit</code></td>
<td>
<p> a number between 0 and 1 giving the critical value for
the correlation test. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_make.plot">make.plot</code></td>
<td>
 <p><code>logical</code> flag indicating whether to make a
plot. </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_floor.plus1">floor.plus1</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code>, one year is
added to the base location of the first segment (e.g., 1601, 1701,
1801 <abbr><span class="acronym">AD</span></abbr>). </p>
</td></tr>
<tr><td><code id="corr.series.seg_+3A_...">...</code></td>
<td>
<p> other arguments passed to plot. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the correlation between a tree-ring series and a
master chronology built from a rwl object.  Correlations are done by
segment (see below) and with a moving correlation with length equal to
the <code><var>seg.length</var></code>.  The function is typically invoked to
produce a plot.
</p>


<h3>Value</h3>

<p>A <code>list</code> containing matrices <code><var>bins</var></code>,
<code><var>moving.rho</var></code>, and vectors <code><var>spearman.rho</var></code>,
<code><var>p.val</var></code>, and <code><var>overall</var></code>.
</p>
<p>Matrix <code><var>bins</var></code> contains the years encapsulated by each bin
(segments).  Matrix <code><var>moving.rho</var></code> contains the moving
correlation and p-value for a moving average equal to
<code><var>seg.length</var></code>.  Vector <code><var>spearman.rho</var></code> contains
the correlations by bin and <code><var>p.val</var></code> contains
the p-values.  Vector <code><var>overall</var></code> contains the average
correlation and p-value.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

<p><code><a href="#topic+corr.series.seg">corr.series.seg</a></code>, <code><a href="#topic+skel.plot">skel.plot</a></code>,
<code><a href="#topic+series.rwl.plot">series.rwl.plot</a></code>, <code><a href="#topic+ccf.series.rwl">ccf.series.rwl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
dat &lt;- co021
## Create a missing ring by deleting a year of growth in a random series
flagged &lt;- dat$"641143"
flagged &lt;- c(NA, flagged[-325])
names(flagged) &lt;- rownames(dat)
dat$"641143" &lt;- NULL
seg.100 &lt;- corr.series.seg(rwl = dat, series = flagged,
                           seg.length = 100, biweight = FALSE)
## Not run: 
flagged2 &lt;- co021$"641143"
names(flagged2) &lt;- rownames(dat)
seg.100.1 &lt;- corr.series.seg(rwl=dat, seg.length=100, biweight=FALSE,
                             series = flagged2)
## Select series by name or column position
seg.100.2 &lt;- corr.series.seg(rwl=co021, seg.length=100, biweight=FALSE,
                             series = "641143")
seg.100.3 &lt;- corr.series.seg(rwl=co021, seg.length=100, biweight=FALSE,
                             series = which(colnames(co021) == "641143"))
identical(seg.100.1, seg.100.2) # TRUE
identical(seg.100.2, seg.100.3) # TRUE

## End(Not run)
</code></pre>

<hr>
<h2 id='csv2rwl'> Read Ring Width File from CSV </h2><span id='topic+csv2rwl'></span>

<h3>Description</h3>

<p>This function reads in a file of ring widths (.rwl) from a text file with comma separated values (csv).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csv2rwl(fname,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csv2rwl_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
csv file. </p>
</td></tr>
<tr><td><code id="csv2rwl_+3A_...">...</code></td>
<td>
<p> other arguments passed to <code><a href="utils.html#topic+read.table">read.table</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple wrapper to <code><a href="utils.html#topic+read.table">read.table</a></code> that reads in a text file with ring-width data in &quot;spreadsheet&quot; format. I.e., with series in columns and the the years as rows. The first column should contain the years and each subsequent column should contain a tree-ring series. The series names should be in the first row of the file. The deafult for <code><a href="base.html#topic+NA">NA</a></code> values are empty cells or as the character string <code>"NA"</code> but can also be set using the <code>na.strings</code> argument passed to <code><a href="utils.html#topic+read.table">read.table</a></code>. E.g.,:
</p>

<table>
<tr>
 <td style="text-align: left;">
Year </td><td style="text-align: left;"> Ser1A </td><td style="text-align: left;"> Ser1B </td><td style="text-align: left;"> Ser2A </td><td style="text-align: left;"> Ser2B</td>
</tr>
<tr>
 <td style="text-align: left;">
1901 </td><td style="text-align: left;"> NA </td><td style="text-align: left;"> 0.45 </td><td style="text-align: left;"> 0.43 </td><td style="text-align: left;"> 0.24</td>
</tr>
<tr>
 <td style="text-align: left;">
1902 </td><td style="text-align: left;"> NA </td><td style="text-align: left;"> 0.05 </td><td style="text-align: left;">  0.00 </td><td style="text-align: left;"> 0.07</td>
</tr>
<tr>
 <td style="text-align: left;">
1903 </td><td style="text-align: left;"> 0.17 </td><td style="text-align: left;"> 0.46 </td><td style="text-align: left;"> 0.03 </td><td style="text-align: left;"> 0.21</td>
</tr>
<tr>
 <td style="text-align: left;">
1904 </td><td style="text-align: left;"> 0.28 </td><td style="text-align: left;"> 0.21 </td><td style="text-align: left;"> 0.54 </td><td style="text-align: left;"> 0.41</td>
</tr>
<tr>
 <td style="text-align: left;">
1905 </td><td style="text-align: left;"> 0.29 </td><td style="text-align: left;"> 0.85 </td><td style="text-align: left;"> 0.17 </td><td style="text-align: left;"> 0.76</td>
</tr>
<tr>
 <td style="text-align: left;">
1906 </td><td style="text-align: left;"> 0.56 </td><td style="text-align: left;"> 0.64 </td><td style="text-align: left;"> 0.56 </td><td style="text-align: left;"> 0.31</td>
</tr>
<tr>
 <td style="text-align: left;">
1907 </td><td style="text-align: left;"> 1.12 </td><td style="text-align: left;"> 1.06 </td><td style="text-align: left;"> 0.99 </td><td style="text-align: left;"> 0.83</td>
</tr>
<tr>
 <td style="text-align: left;">
etc...
</td>
</tr>

</table>

<p>Note that this is a rudimentary convenience function that isn't doing anything sophisticated. It reads in a file, assigns the years to the row names and sets the class of the object to <code>c("rwl","data.frame")</code> which allows <code>dplR</code> to recognize it. 
</p>
<p>Although arguments can be passed to <code><a href="utils.html#topic+read.table">read.table</a></code>, this is not designed to be a  flexible function. As is the philosophy with <code>dplR</code>, modifying the code is easy should the user wish to read in a different style of text file (e.g., tab delimited). Typing <code>csv2rwl</code> at the <code>R</code> prompt will get the user started. 
</p>


<h3>Value</h3>

<p>Function returns an object of class
<code>c("rwl", "data.frame")</code> with the series in columns and the years
as rows.  The series <abbr><span class="acronym">ID</span></abbr>s are the column names and the years
are the row names.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn </p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code>, <code><a href="utils.html#topic+read.table">read.table</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
# write out a rwl file in a format that csv2rwl will understand
tm &lt;- time(ca533)
foo &lt;- data.frame(tm,ca533)
# this is the temp file where foo will be written
tmpName &lt;- tempfile()
write.csv(foo,file=tmpName,row.names=FALSE)
# read it back in using csv2rwl
bar &lt;- csv2rwl(tmpName)
# check to see if identical
identical(ca533,bar)
# delete temp file
unlink(tmpName)
</code></pre>

<hr>
<h2 id='detrend'> Detrend Multiple Ring-Width Series Simultaneously </h2><span id='topic+detrend'></span>

<h3>Description</h3>

<p>This is a wrapper for <code><a href="#topic+detrend.series">detrend.series</a></code> to detrend many
ring-width series at once.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detrend(rwl, y.name = names(rwl), make.plot = FALSE,
        method = c("Spline", "ModNegExp", "Mean", "Ar", "Friedman",
                   "ModHugershoff", "AgeDepSpline"),
        nyrs = NULL, f = 0.5, pos.slope = FALSE,
        constrain.nls = c("never", "when.fail", "always"),
        verbose = FALSE, return.info = FALSE,
        wt, span = "cv", bass = 0, difference = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detrend_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> </p>
</td></tr>
<tr><td><code id="detrend_+3A_y.name">y.name</code></td>
<td>
<p> a <code>character</code> vector of
<code>length(ncol(<var>rwl</var>))</code> that gives the <abbr><span class="acronym">ID</span></abbr> of each
series.  Defaults to the column names of <code><var>rwl</var></code>. </p>
</td></tr>
<tr><td><code id="detrend_+3A_make.plot">make.plot</code></td>
<td>
<p> a <code>logical</code> flag.  Makes plots of the raw data
and detrended data if <code>TRUE</code>.  See details below. </p>
</td></tr>
<tr><td><code id="detrend_+3A_method">method</code></td>
<td>
<p> a <code>character</code> vector to determine the detrending
methods.  See details below.  Possible values are all subsets of<br />
<code>c("Spline", "ModNegExp", "Mean", "Ar", "Friedman", "ModHugershoff",
    "AgeDepSpline")</code>.
Defaults to using all the available methods.</p>
</td></tr>
<tr><td><code id="detrend_+3A_nyrs">nyrs</code></td>
<td>
<p> a number giving the rigidity of the smoothing spline,
defaults to 0.67 of series length if <code><var>nyrs</var></code> is
<code>NULL</code>. </p>
</td></tr>
<tr><td><code id="detrend_+3A_f">f</code></td>
<td>
<p> a number between 0 and 1 giving the frequency response or
wavelength cutoff.  Defaults to 0.5. </p>
</td></tr>
<tr><td><code id="detrend_+3A_pos.slope">pos.slope</code></td>
<td>
<p> a <code>logical</code> flag.  Will allow for a positive
slope to be used in method <code>"ModNegExp"</code> and <code>"ModHugershoff"</code>.  
If <code>FALSE</code> the
line will be horizontal. </p>
</td></tr>
<tr><td><code id="detrend_+3A_constrain.nls">constrain.nls</code></td>
<td>
<p> a <code>character</code> string which controls
the constraints of the <code>"ModNegExp"</code> model and the 
<code>"ModHugershoff"</code>.  See 
<code><a href="#topic+detrend.series">detrend.series</a></code> for further details. </p>
</td></tr>
<tr><td><code id="detrend_+3A_verbose">verbose</code></td>
<td>
 <p><code>logical</code>.  Write out details? </p>
</td></tr>
<tr><td><code id="detrend_+3A_return.info">return.info</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>, details
about models and data will be added to the return value.  See
&lsquo;Value&rsquo;. </p>
</td></tr>
<tr><td><code id="detrend_+3A_wt">wt</code></td>
<td>
<p> a <code>numeric</code> vector of case weights for method
<code>"Friedman"</code>. The default means equals weights. </p>
</td></tr>
<tr><td><code id="detrend_+3A_span">span</code></td>
<td>
<p> a <code>numeric</code> value controlling method
<code>"Friedman"</code>, or <code>"cv"</code> (default) for automatic choice by
cross-validation. See <code><a href="stats.html#topic+supsmu">supsmu</a></code>. </p>
</td></tr>
<tr><td><code id="detrend_+3A_bass">bass</code></td>
<td>
<p> a <code>numeric</code> value controlling the smoothness of the
fitted curve in method <code>"Friedman"</code>. See <code><a href="stats.html#topic+supsmu">supsmu</a></code>. </p>
</td></tr>
<tr><td><code id="detrend_+3A_difference">difference</code></td>
<td>
<p> a <code>logical</code> flag.  Compute residuals by substraction if TRUE, otherwise use division. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+detrend.series">detrend.series</a></code> for details on detrending
methods.  Setting <code><var>make.plot</var> = TRUE</code> will cause plots of
each series to be produced.  These could be saved using
<code><a href="grDevices.html#topic+Devices">Devices</a></code> if desired.
</p>


<h3>Value</h3>

<p>If one detrending method is used, a <code>data.frame</code> containing the
dimensionless detrended ring widths with column names, row names and
dimensions of <code><var>rwl</var></code>.  If more methods are used, a list with
<code>ncol(<var>rwl</var>)</code> elements each containing a <code>data.frame</code>
with the detrended ring widths in each column.
</p>
<p>If <code><var>return.info</var></code> is <code>TRUE</code>, the return value is a
<code>list</code> with four parts:
</p>
<table role = "presentation">
<tr><td><code>series</code></td>
<td>
<p> the main result described above (<code>data.frame</code> or
list of data.frames) </p>
</td></tr>
<tr><td><code>curves</code></td>
<td>
<p> the curve or line used to detrend <code>series</code>. Either a <code>data.frame</code> or a list of data.frames. </p>
</td></tr>
<tr><td><code>model.info</code></td>
<td>
<p> Information about the models corresponding to each
output series.  A <code>list</code> with one element for each column of
<code><var>rwl</var></code>.  See <code><a href="#topic+detrend.series">detrend.series</a></code> (&lsquo;Value&rsquo;,
<var>model.info</var>) for a description of the contents. </p>
</td></tr>
<tr><td><code>data.info</code></td>
<td>
<p> Information about the input series.  A <code>list</code>
with one element for each column of <code><var>rwl</var></code>.  See
<code><a href="#topic+detrend.series">detrend.series</a></code> (&lsquo;Value&rsquo;, <var>data.info</var>). </p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function uses the <code><a href="foreach.html#topic+foreach">foreach</a></code> looping
construct with the <code><a href="foreach.html#topic+foreach">%dopar%</a></code> operator.
For parallel computing and a potential speedup, a parallel backend
must be registered before running the function.  If
<code><var>verbose</var></code> is <code>TRUE</code>, parallel computation is disabled.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+detrend.series">detrend.series</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
## Detrend using modified exponential decay. Returns a data.frame
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
## Detrend using splines and compute
## residuals via subtraction
ca533.rwi &lt;- detrend(rwl = ca533, method = "Spline",
                     difference = TRUE)

## Detrend using modified Hugershoff curve and return info on the model
## fits. Returns a list with: series, curves, modelinfo and data.info
data(co021)
co021.rwi &lt;- detrend(rwl = co021, method = "ModHugershoff",
                     return.info=TRUE)

## Not run: 
library(grDevices)
## Detrend using all methods. Returns a list
ca533.rwi &lt;- detrend(rwl = ca533)
## Save a pdf of all series
fname &lt;- tempfile(fileext=".pdf")
print(fname) # tempfile used for output
pdf(fname)
ca533.rwi &lt;- detrend(rwl = ca533, method = c("Spline", "ModNegExp"),
                     make.plot = TRUE)
dev.off()

unlink(fname) # remove the file

## End(Not run)
</code></pre>

<hr>
<h2 id='detrend.series'> Detrend a Ring-Width Series </h2><span id='topic+detrend.series'></span>

<h3>Description</h3>

<p>Detrend a tree-ring series by one of two methods, a smoothing spline or
a statistical model.  The series and fits are plotted by default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detrend.series(y, y.name = "", make.plot = TRUE,
               method = c("Spline", "ModNegExp", "Mean", 
               "Ar", "Friedman", "ModHugershoff","AgeDepSpline"),
               nyrs = NULL, f = 0.5, pos.slope = FALSE,
               constrain.nls = c("never", "when.fail", "always"),
               verbose = FALSE, return.info = FALSE,
               wt, span = "cv", bass = 0, difference = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detrend.series_+3A_y">y</code></td>
<td>
<p> a <code>numeric</code> vector.  Usually a tree-ring series. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_y.name">y.name</code></td>
<td>
<p> an optional <code>character</code> vector to name the series
for plotting purposes. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_make.plot">make.plot</code></td>
<td>
<p> a <code>logical</code> flag.  Makes plots of the raw data
and detrended data if <code>TRUE</code>. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_method">method</code></td>
<td>
<p> a <code>character</code> vector to determine the detrending
methods.  See details below.  Possible values are all subsets of<br />
<code>c("Spline", "ModNegExp", "Mean", "Ar", "Friedman", "ModHugershoff",
    "AgeDepSpline")</code>.
Defaults to using all the available methods.</p>
</td></tr>
<tr><td><code id="detrend.series_+3A_nyrs">nyrs</code></td>
<td>
<p> a number controlling the smoothness of the
fitted curve in methods. See Details.</p>
</td></tr>
<tr><td><code id="detrend.series_+3A_f">f</code></td>
<td>
<p> a number between 0 and 1 giving the frequency response or
wavelength cutoff in method <code>"Spline"</code>.  Defaults to 0.5. 
See <code><a href="#topic+caps">caps</a></code>.</p>
</td></tr>
<tr><td><code id="detrend.series_+3A_pos.slope">pos.slope</code></td>
<td>
<p> a <code>logical</code> flag.  Will allow for a positive
slope to be used in method <code>"ModNegExp"</code> or <code>"AgeDepSpline"</code>.  
If <code>FALSE</code> the
line will be horizontal. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_constrain.nls">constrain.nls</code></td>
<td>
<p> a <code>character</code> string which controls
the constraints of the <code>"ModNegExp"</code> model and and the 
<code>"ModHugershoff"</code> model which are fit using nonlinear least-squares 
via <code><a href="stats.html#topic+nls">nls</a></code>.  The value is an
answer to the question: When should the parameters of the <code><a href="stats.html#topic+nls">nls</a></code>
function be constrained?  The options are
<code>"never"</code>: do not constrain (the default), <code>"when.fail"</code>:
only compute the constrained solution if the unconstrained fit
contains other than positive values, and <code>"always"</code>: return the
constrained solution, even if the unconstrained one would have been
valid.  See &lsquo;Details&rsquo;. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_verbose">verbose</code></td>
<td>
<p> a <code>logical</code> flag.  Write out details to the screen? </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_return.info">return.info</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>, details
about models and data will be added to the return value.  See
&lsquo;Value&rsquo;. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_wt">wt</code></td>
<td>
<p> a <code>numeric</code> vector of case weights for method
<code>"Friedman"</code>. The default means equals weights. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_span">span</code></td>
<td>
<p> a <code>numeric</code> value controlling method
<code>"Friedman"</code>, or <code>"cv"</code> (default) for automatic choice by
cross-validation. See <code><a href="stats.html#topic+supsmu">supsmu</a></code>. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_bass">bass</code></td>
<td>
<p> a <code>numeric</code> value controlling the smoothness of the
fitted curve in method <code>"Friedman"</code>. See <code><a href="stats.html#topic+supsmu">supsmu</a></code>. </p>
</td></tr>
<tr><td><code id="detrend.series_+3A_difference">difference</code></td>
<td>
<p> a <code>logical</code> flag.  Compute residuals by subtraction if TRUE, otherwise use division. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This detrends and standardizes a tree-ring series.  The detrending is the estimation and removal of the tree‚Äôs natural biological growth trend.  The default standardization is done by dividing each series by the growth trend to produce units in the dimensionless ring-width index (<abbr><span class="acronym">RWI</span></abbr>).  If <code>difference</code> is TRUE, the index is calculated by subtraction. Values of zero (typically missing rings) in <code>y</code> are set to 0.001. 
</p>
<p>There are currently seven methods available for
detrending although more are certainly possible.  The methods
implemented are an age-dependent spline via <code><a href="#topic+ads">ads</a></code> 
(<code><var>method</var> = "AgeDepSpline"</code>), the residuals of an AR model
(<code><var>method</var> = "Ar"</code>), Friedman's Super Smoother 
(<code><var>method</var> = "Friedman"</code>), a simple horizontal line
(<code><var>method</var> = "Mean"</code>),  or a modified Hugershoff
curve (<code><var>method</var> = "ModHugershoff"</code>), a modified negative exponential
curve (<code><var>method</var> = "ModNegExp"</code>), and a smoothing spline via <code><a href="#topic+caps">caps</a></code> (<code><var>method</var> = "Spline"</code>).
</p>
<p>The <code>"AgeDepSpline"</code> approach uses an age-dependent spline with an initial
stiffness of 50 (<code><var>nyrs</var>=50</code>). See <code><a href="#topic+ads">ads</a></code>. If some of the fitted 
values are not positive then method <code>"Mean"</code> is used. However, this is
extremely unlikely.
</p>
<p>The <code>"Ar"</code> approach is also known as prewhitening where the detrended 
series is the residuals of an <code><a href="stats.html#topic+ar">ar</a></code> model divided by the
mean of those residuals to yield a series with white noise and a mean of one.
This method removes all but the high frequency variation in the series
and should only be used as such.
</p>
<p>The <code>"Friedman"</code> approach uses Friedman‚Äôs &lsquo;super
smoother&rsquo; as implemented in <code><a href="stats.html#topic+supsmu">supsmu</a></code>.  The parameters
<code><var>wt</var></code>, <code><var>span</var></code> and <code><var>bass</var></code> can be
adjusted, but <code><var>periodic</var></code> is always set to <code>FALSE</code>. If some of 
the fitted values are not positive then method <code>"Mean"</code> is used.
</p>
<p>The <code>"Mean"</code> approach fits a horizontal line using the mean of
the series.  This method is the fallback solution in cases where the
<code>"Spline"</code> or the linear fit (also a fallback solution itself)
contains zeros or negative values, which would lead to invalid
ring-width indices.
</p>
<p>The <code>"ModHugershoff"</code> approach attempts to fit a Hugershoff
model of biological growth of the form <code class="reqn">f(t) = a t^b e^{-g t} + d</code>, where the argument of the function is time, using
<code><a href="stats.html#topic+nls">nls</a></code>.  See Fritts (2001) for details about the
parameters.  Option <code><var>constrain.nls</var></code> gives a
possibility to constrain the parameters of the modified negative
exponential function.  If the constraints are enabled, the nonlinear
optimization algorithm is instructed to keep the parameters in the
following ranges: <code class="reqn">a \ge 0</code>, <code class="reqn">b \ge 0</code> and
<code class="reqn">d \ge 0</code>.  The default is to not constrain the parameters
(<code><var>constrain.nls</var> = "never"</code>) for  <code><a href="stats.html#topic+nls">nls</a></code> but
warn the user when the parameters go out of range.
</p>
<p>If a suitable nonlinear model cannot be fit
(function is non-decreasing or some values are not positive) then a
linear model is fit.  That linear model can have a positive slope
unless <code><var>pos.slope</var></code> is <code>FALSE</code> in which case method
<code>"Mean"</code> is used.
</p>
<p>The <code>"ModNegExp"</code> approach attempts to fit a classic nonlinear
model of biological growth of the form <code class="reqn">f(t) = a e^{b t} + k</code>, where the argument of the function is time, using
<code><a href="stats.html#topic+nls">nls</a></code>.  See Fritts (2001) for details about the
parameters.  Option <code><var>constrain.nls</var></code> gives a
possibility to constrain the parameters of the modified negative
exponential function.  If the constraints are enabled, the nonlinear
optimization algorithm is instructed to keep the parameters in the
following ranges: <code class="reqn">a \ge 0</code>, <code class="reqn">b \le 0</code> and
<code class="reqn">k \ge 0</code>.  The default is to not constrain the parameters
(<code><var>constrain.nls</var> = "never"</code>) for  <code><a href="stats.html#topic+nls">nls</a></code> but
warn the user when the parameters go out of range.
</p>
<p>If a suitable nonlinear model cannot be fit
(function is non-decreasing or some values are not positive) then a
linear model is fit.  That linear model can have a positive slope
unless <code><var>pos.slope</var></code> is <code>FALSE</code> in which case method
<code>"Mean"</code> is used.
</p>
<p>The <code>"Spline"</code> approach uses a spline where the frequency
response is 0.50 at a wavelength of 0.67 * &ldquo;series length in
years&rdquo;, unless specified differently using <code><var>nyrs</var></code> and
<code><var>f</var></code> in the function <code><a href="#topic+caps">caps</a></code>. If some of the fitted 
values are not positive then method <code>"Mean"</code> is used.
</p>
<p>These methods are chosen because they are commonly used in
dendrochronology.  There is a rich literature on detrending
and many researchers are particularly skeptical of the use of the 
classic nonlinear model of biological growth (<code class="reqn">f(t) = a e^{b t} + k</code>) for detrending.  It is, of course, up to the 
user to determine the best detrending method for their data.
</p>
<p>Note that the user receives a warning if a series has negative values in the  
fitted curve. This happens fairly commonly with with the &lsquo;Ar&rsquo; method 
on high-order data. It happens less often with method &lsquo;Spline&rsquo; but
isn't unheard of (see &lsquo;Examples&rsquo;). If this happens, users should look
carefully at their data before continuing. Automating detrending and not 
evaluating each series individually is folly. Remember, frustration over 
detrending is the number one cause of dendros going to live as hermits in 
the tallgrass prairie, where there are no trees to worry about.  
</p>
<p>See the references below for further details on detrending. It's a dark art.
</p>


<h3>Value</h3>

<p>If several methods are used, returns a <code>data.frame</code> containing
the detrended series (<code><var>y</var></code>) according to the methods used.
The columns are named and ordered to match <code><var>method</var></code>.  If
only one method is selected, returns a vector.
</p>
<p>If <code><var>return.info</var></code> is <code>TRUE</code>, the return value is a
<code>list</code> with four parts:
</p>
<table role = "presentation">
<tr><td><code>series</code></td>
<td>
<p> the main result described above (<code>data.frame</code> or
vector) </p>
</td></tr>
<tr><td><code>curves</code></td>
<td>
<p> the curve or line used to detrend <code>series</code>. Either a <code>data.frame</code> or vector. </p>
</td></tr>
<tr><td><code>model.info</code></td>
<td>
<p> Information about the models corresponding to each
output series.  Whereas <code><var>series</var></code> may return a vector,
<code><var>model.info</var></code> is always a list where each top level
element corresponds to one selected method.  Also these elements are
named and arranged according to the methods selected.  Each element
is a list with some of the following sub-elements, depending on
which detrending method was actually used:
</p>

<dl>
<dt>n.zeros</dt><dd><p> See <code>"data.info"</code> below.  Always present. </p>
</dd>
<dt>zero.years</dt><dd><p> See <code>"data.info"</code>.  Always present. </p>
</dd>
<dt>method</dt><dd><p> The method actually used for detrending.  One of
<code>"Mean"</code>, <code>"Line"</code>, <code>"ModNegExp"</code>,
<code>"Spline"</code> or <code>"Ar"</code>.  Always present. </p>
</dd>
<dt>mean</dt><dd><p> Mean of the input series, missing values removed.
Only for method <code>"Mean"</code>. </p>
</dd>
<dt>coefs</dt><dd><p> Coefficients of the model.  Methods <code>"Line"</code>
and <code>"ModNegExp"</code>.</p>
</dd>
<dt>formula</dt><dd><p> The <code>"ModNegExp"</code> <code><a href="stats.html#topic+formula">formula</a></code>. </p>
</dd>
<dt>is.constrained</dt><dd><p> A <code>logical</code> flag indicating whether
the parameters of the <code>"ModNegExp"</code> model were
constrained.  Only interesting when argument
<code><var>constrain.nls</var></code> is set to <code>"when.fail"</code>. </p>
</dd>
<dt>nyrs</dt><dd><p> The value of <code><var>nyrs</var></code> used for
<code><a href="#topic+caps">caps</a></code>. For methods <code>"Spline"</code> and
<code>"AgeDepSpline"</code>. </p>
</dd>
<dt>order</dt><dd><p> The order of the autoregressive model, selected by
AIC (Akaike information criterion).  Only for method
<code>"Ar"</code>. </p>
</dd>
<dt>ar</dt><dd><p> The autoregressive coefficients used by method
<code>"Ar"</code>.  A <code>numeric</code> vector ordered by increasing
lag. </p>
</dd>
</dl>

</td></tr>
<tr><td><code>data.info</code></td>
<td>
<p> Information about the input series: number
(<code>"n.zeros"</code>) and location (<code>"zero.years"</code>) of zero
values.  If the locations are in a <code>character</code> vector, they are
years.  Otherwise they are indices to the input series. </p>
</td></tr>
<tr><td><code>dirtDog</code></td>
<td>
<p> A logical flag indicating whether the requested method resulted in neagtive values for the curve fit, what Cook's ARSTAN called a Dirty Dog. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela.  A bug fix
related to negative output values is based on work by Alice Cecile. </p>


<h3>References</h3>

<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Fritts, H. C. (2001) <em>Tree Rings and Climate</em>.
Blackburn.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-1-930665-39-2.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+detrend">detrend</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)
library(utils)
## Use series CAM011 from the Campito data set
data(ca533)
series &lt;- ca533[, "CAM011"]
names(series) &lt;- rownames(ca533)
# defaults to all six methods
series.rwi &lt;- detrend.series(y = series, y.name = "CAM011", verbose=TRUE)
# see plot with three methods
series.rwi &lt;- detrend.series(y = series, y.name = "CAM011",
                             method=c("Spline", "ModNegExp","Friedman"),
                             difference=TRUE)
# see plot with two methods
# interesting to note difference from ~200 to 250 years 
# in terms of what happens to low frequency growth
series.rwi &lt;- detrend.series(y = series, y.name = "CAM011",
                             method=c("Spline", "ModNegExp"))
# see plot with just one method and change the spline
# stiffness to 50 years (which is not neccesarily a good choice!)
series.rwi &lt;- detrend.series(y = series, y.name = "CAM011",
                             method="Spline",nyrs=50)
                             
# note that method "Ar" doesn't get plotted in first panel
# since this approach doesn't approximate a growth curve.
series.rwi &lt;- detrend.series(y = series, y.name = "CAM011",
                             method="Ar")
                             
# note the difference between ModNegExp and ModHugershoff at the 
# start of the series. Also notice how curves, etc. are returned
# via return.info
data(co021)
series &lt;- co021[, 4]
names(series) &lt;- rownames(co021)
series.rwi &lt;- detrend.series(y = series, y.name = names(co021)[4],
                             method=c("ModNegExp", "ModHugershoff"),
                             verbose = TRUE, return.info = TRUE, 
                             make.plot = TRUE)
                             
# A dirty dog.
# In the case of method=="Spline" the function carries-on
# and applies method=="Mean" as an alternative. 
data(nm046)
series &lt;- nm046[,8]
names(series) &lt;- rownames(nm046)
series.rwi &lt;- detrend.series(y = series, y.name = names(nm046)[8],
                             method="Spline",
                             make.plot = FALSE)

</code></pre>

<hr>
<h2 id='dplR-defunct'>
Defunct functions in dplR
</h2><span id='topic+dplR-defunct'></span><span id='topic+plotRings'></span><span id='topic+ffcsaps'></span>

<h3>Description</h3>

<p>These are functions no longer included in dplR
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Function: </td><td style="text-align: left;"> plotRings</td>
</tr>
<tr>
 <td style="text-align: left;">
    Function: </td><td style="text-align: left;"> ffcsaps, use <code><a href="#topic+caps">caps</a></code> instead</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<hr>
<h2 id='fill.internal.NA'>Fill Internal NA</h2><span id='topic+fill.internal.NA'></span>

<h3>Description</h3>

<p>This function fills internal <code>NA</code> values (i.e., those with numeric data
above and below a small data gap) in each column of a
<code>data.frame</code> such as a data set of ring widths as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill.internal.NA(x, fill = c("Mean", "Spline", "Linear"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill.internal.NA_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> of ring widths with
<code>row.names(<var>x</var>)</code> containing years and <code>names(<var>x</var>)</code>
containing each series <abbr><span class="acronym">ID</span></abbr> such as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code></p>
</td></tr>
<tr><td><code id="fill.internal.NA_+3A_fill">fill</code></td>
<td>
<p>a <code>numeric</code> value (e.g., <code>0</code>) or a <code>character</code> string of
<code>"Mean"</code>, <code>"Spline"</code>, or <code>"Linear"</code>.  Defaults to <code>"Mean"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are occasionally data gaps within a tree-ring series.  Some of
the functions in dplR will fail
when an internal <code>NA</code> is encountered (e.g. <code><a href="#topic+caps">caps</a></code>).  This
function fills internal <code>NA</code> values with either a given numeric value
(e.g., <code>0</code>) or through crude imputation.  The latter can be calculated as 
the mean of the series (<code>fill="Mean"</code>) or calculated by fitting a cubic spline
(<code>fill="Spline"</code>) using the <code><a href="stats.html#topic+spline">spline</a></code> function or calculated
by linear approximation (<code>fill="Linear"</code>) using the function
<code><a href="stats.html#topic+approx">approx</a></code>.
</p>
<p>Editorial: Having internal <code>NA</code> in a tree-ring series is
often bad practice and filling those values should be done with
caution.  For instance, some users code missing rings as <code>NA</code>
instead of <code>0</code>.  And missing values (i.e., <code>NA</code>) are
sometimes present in maximum latewood density data when the rings are
small.  A common, but not recommended, practice is to leave stretches
of <code>NA</code> values in places where it has been impossible to
accurately measure rings (perhaps because of a break in the core).  It
is often better to treat that core as two separate series (e.g., &quot;01A&quot;
and &quot;01B&quot; rather than have internal <code>NA</code> values.  As with all
processing, the analyst should make a decision based on their
experience with the wood and not rely on software to make a choice for
them!
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with <code>colnames(<var>x</var>)</code> and
<code>rownames(<var>x</var>)</code>.  Internal <code>NA</code>s
filled as above.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+spline">spline</a></code>, <code><a href="stats.html#topic+approx">approx</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(stats)
foo &lt;- data.frame(x1=c(rnorm(5), NA, NA, rnorm(3)),
                  x2=c(rnorm(10)),
                  x3=c(NA, NA, rnorm(3), NA, rnorm(4)),
                  x4=c(NA, NA, rnorm(3), NA, rnorm(3), NA),
                  x5=c(NA, NA, rnorm(8)),
                  x6=c(NA, rnorm(9)),
                  x7=c(NA, rnorm(5), NA, rnorm(3)),
                  x8=c(rnorm(8), NA, NA),
                  x9=c(rnorm(5), NA, rnorm(3), NA))
row.names(foo) &lt;- 1901:1910
class(foo) &lt;- c("rwl","data.frame")
fill.internal.NA(foo, fill=0)

bar &lt;- fill.internal.NA(foo, fill="Spline")
baz &lt;- fill.internal.NA(foo, fill="Linear")

## note differences in method "Spline" vs. "Linear"
yrs &lt;- time(foo)
plot(yrs, foo$x7, type="b", lwd=3)
lines(yrs, bar$x7, col="red", lwd=2)
lines(yrs, baz$x7, col="green", lwd=1)

</code></pre>

<hr>
<h2 id='gini.coef'> Calculate the Gini Coefficient   </h2><span id='topic+gini.coef'></span>

<h3>Description</h3>

<p>This function calculates the Gini coefficient on raw or detrended
ring-width series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gini.coef(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gini.coef_+3A_x">x</code></td>
<td>
<p> a <code>numeric</code> vector </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates the Gini coefficient of inequality which is used as an
all-lag measure of diversity in tree-ring records ‚Äì typically detrended
series.  Lower values indicate lower diversity.  The use of the Gini
coefficient in dendrochronology is described by Biondi and Qeadan (2008).
See Handcock and Morris (1999) for more information.  
</p>


<h3>Value</h3>

<p> the Gini coefficient.
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela, based on original by Andy Bunn </p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) Inequality in Paleorecords.
<em>Ecology</em>, <b>89</b>(4), 1056‚Äì1067.
</p>
<p>Handcock, M. S. and Morris, M. (1999) <em>Relative Distribution
Methods in the Social Sciences</em>.  Springer.  <abbr><span class="acronym">ISBN</span></abbr>:
0-387-98778-9.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rwl.stats">rwl.stats</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
ca533.crn &lt;- chron(ca533.rwi)
gini.coef(ca533.crn)
</code></pre>

<hr>
<h2 id='glk'> Calculate Gleichl√§ufigkeit </h2><span id='topic+glk'></span><span id='topic+glk.legacy'></span>

<h3>Description</h3>

<p>This function calculates the Gleichl√§ufigkeit and related measures for a given set of tree-ring records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  glk(x, overlap = 50, prob = TRUE)
  glk.legacy(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glk_+3A_x">x</code></td>
<td>
<p> a <code>data.frame</code> of tree-ring data with records in
columns, and years as rows.</p>
</td></tr>
<tr><td><code id="glk_+3A_overlap">overlap</code></td>
<td>
<p> integer value with minimal length of overlapping growth changes (compared number of tree rings - 1). Comparisons with less overlap are not compared.</p>
</td></tr>
<tr><td><code id="glk_+3A_prob">prob</code></td>
<td>
<p>if <code>TRUE</code> then the probability of exceedence of the Gleichl√§ufigkeit will be calculated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Gleichl√§ufigkeit is a classical agreement test based on sign tests (Eckstein and Bauch, 1969). This function implements Gleichl√§ufigkeit as the pairwise comparison of all records in data set. This vectorized implementation is faster than the previous version and follows the original definition (Huber 1942), instead of the incorrect interpretation that has been used in the past (Schweingruber 1988, see Buras/Wilmking 2015 for the correction). 
</p>
<p>The probability of exceedence (p) for the Gleichl√§ufigkeit expresses the chance that the Gleichl√§ufigkeit is incorrect. The observed value of the Gleichl√§ufigkeit is converted to a z-score and based on the standard normal curve the probability of exceedence is calculated. The result is a matrix of all p-values (Jansma 1995, 60-61, see also Visser 2020).
</p>
<p>Note that prior to dplR version 1.7.2, <code>glk</code> did not have the <code>overlap</code> or <code>prob</code> and returned a <code>matrix</code> with just the Gleichl√§ufigkeit for all possible combinations of records. That function can still be accessed via <code>glk.legacy</code>.
</p>


<h3>Value</h3>

<p>The funtions returns a named <code>list</code> of two or three matrices  (p_mat is optional if <code>prob = TRUE</code>):
</p>

<ol>
<li><p> glk_mat: <code>matrix</code> with Gleichl√§ufigkeit
</p>
</li>
<li><p> overlap: <code>matrix</code> with number of overlapping growth changes.This is the number of overlapping years minus one.
</p>
</li>
<li><p> p_mat: <code>matrix</code> of all probabilities of exceedence for all observed Gleichl√§ufigkeit values.
</p>
</li></ol>

<p>The matrices can be extracted from the list by selecting the name or index number. If two curves have less than 3 years of overlap, Gleichl√§ufigkeit cannot be computed, and <code>NA</code> is returned.
To calculate the global glk of the dataset <code>mean(x$glk_mat, na.rm = TRUE)</code>.
</p>


<h3>Author(s)</h3>

<p> Christian Zang.  Patched and improved by Mikko Korpela.
Improved by Allan Buras. Further improved and expanded by Ronald Visser and Andy Bunn</p>


<h3>References</h3>

<p>Buras, A. and Wilmking, M. (2015) Correcting the calculation of Gleichl√§ufigkeit, <em>Dendrochronologia</em> <b>34</b>, 29-30. DOI: https://doi.org/10.1016/j.dendro.2015.03.003
</p>
<p>Eckstein, D. and Bauch, J. (1969) Beitrag zur Rationalisierung eines dendrochronologischen Verfahrens und zur Analyse seiner Aussagesicherheit. <em>Forstwissenschaftliches Centralblatt</em>, <b>88</b>(1), 230-250.
</p>
<p>Huber, B. (1943) √úber die Sicherheit jahrringchronologischer Datierung. <em>Holz als Roh- und Werkstoff</em> <b>6</b>, 263-268. DOI: https://doi.org/10.1007/BF02603303
</p>
<p>Jansma, E., 1995. <em>RemembeRINGs; The development and application of local and regional tree-ring chronologies of oak for the purposes of archaeological and historical research in the Netherlands</em>, Nederlandse Archeologische Rapporten 19, Rijksdienst voor het Oudheidkundig Bodemonderzoek, Amersfoort
</p>
<p>Schweingruber, F. H. (1988) <em>Tree rings: basics and applications of dendrochronology</em>, Kluwer Academic Publishers, Dordrecht, Netherlands, 276 p.
</p>
<p>Visser, R.M. (2020) On the similarity of tree-ring patterns: Assessing the influence of semi-synchronous growth changes on the Gleichl√§ufigkeit for big tree-ring data sets,<em>Archaeometry</em>, <b>63</b>, 204-215 DOI: https://doi.org/10.1111/arcm.12600
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sgc">sgc</a></code> <code>sgc</code> is an alternative for <code>glk</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
  data(ca533)
  ca533.glklist &lt;- glk(ca533)
  ca533.glk_mat &lt;- ca533.glklist$glk_mat
  # calculating the mean GLK including self-similarities
  mean(ca533.glk_mat, na.rm = TRUE) 
  # calculating the mean GLK excluding self-similarities
  mean(ca533.glk_mat[upper.tri(ca533.glk_mat)], na.rm = TRUE) 

</code></pre>

<hr>
<h2 id='gp.d2pith'> Ponderosa Pine Distance to Pith Corresponding to <code><a href="#topic+gp.rwl">gp.rwl</a></code> </h2><span id='topic+gp.d2pith'></span>

<h3>Description</h3>

<p>This data set gives the distance to pith for each series (in mm) that
matches the ring widths for <code><a href="#topic+gp.rwl">gp.rwl</a></code> ‚Äì a data set of
ponderosa pine (<em>Pinus ponderosa</em>) from the Gus Pearson Natural
Area (<abbr><span class="acronym">GPNA</span></abbr>) in northern Arizona, <abbr><span class="acronym">USA</span></abbr>.  Data are
further described by Biondi and Qeadan (2008) and references therein.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gp.d2pith)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing series <abbr><span class="acronym">ID</span></abbr>s in column 1
(<code><var>series</var></code>) and the distance (in mm) from the innermost ring
to the pith of the tree (<code><var>d2pith</var></code>).  This can be used
together with the ring widths to calculate the area of each ring.
</p>


<h3>Source</h3>

<p>DendroLab, University of Nevada Reno, <abbr><span class="acronym">USA</span></abbr>.
<a href="https://dendrolaborg.wordpress.com/">https://dendrolaborg.wordpress.com/</a>
</p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) A theory-driven approach to tree-ring
standardization: Defining the biological trend from expected basal area
increment.  <em>Tree-Ring Research</em>, <b>64</b>(2), 81‚Äì96.
</p>

<hr>
<h2 id='gp.dbh'> Ponderosa Pine Stem Diameters and Bark Thickness (<code><a href="#topic+gp.rwl">gp.rwl</a></code>) </h2><span id='topic+gp.dbh'></span>

<h3>Description</h3>

<p>This data set gives the diameter at breast height for each series that
matches the series in <code><a href="#topic+gp.rwl">gp.rwl</a></code> ‚Äì a data set of ponderosa
pine (<em>Pinus ponderosa</em>) from the Gus Pearson Natural Area
(<abbr><span class="acronym">GPNA</span></abbr>) in northern Arizona, <abbr><span class="acronym">USA</span></abbr>.  Data are further
described by Biondi and Qeadan (2008) and references therein.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gp.dbh)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing series <abbr><span class="acronym">ID</span></abbr>s in column 1
(<code><var>series</var></code>), tree diameter (in cm) at breast height
(<code><var>dbh</var></code>), and the bark thickness (in cm).  This can be used
together with the ring widths to calculate the area of each ring.
</p>


<h3>Source</h3>

<p>DendroLab, University of Nevada Reno, <abbr><span class="acronym">USA</span></abbr>.
<a href="https://dendrolaborg.wordpress.com/">https://dendrolaborg.wordpress.com/</a>
</p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) A theory-driven approach to tree-ring
standardization: Defining the biological trend from expected basal area
increment.  <em>Tree-Ring Research</em>, <b>64</b>(2), 81‚Äì96.
</p>

<hr>
<h2 id='gp.po'> Ponderosa Pine Pith Offsets Corresponding to <code><a href="#topic+gp.rwl">gp.rwl</a></code> </h2><span id='topic+gp.po'></span>

<h3>Description</h3>

<p>This data set gives the pith offsets that match the ring widths for
<code><a href="#topic+gp.rwl">gp.rwl</a></code> ‚Äì a data set of ponderosa pine (<em>Pinus
ponderosa</em>) from the Gus Pearson Natural Area (<abbr><span class="acronym">GPNA</span></abbr>) in
northern Arizona, <abbr><span class="acronym">USA</span></abbr>.  Data are further described by Biondi
and Qeadan (2008) and references therein.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gp.po)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing series <abbr><span class="acronym">ID</span></abbr>s in column 1
(<code><var>series</var></code>) and the number of years between the beginning of
that series in <code><a href="#topic+gp.rwl">gp.rwl</a></code> and the pith of the tree
(<code><var>pith.offset</var></code>).  This can be used together with the ring
widths to calculate the cambial age of each ring.
</p>


<h3>Source</h3>

<p>DendroLab, University of Nevada Reno, <abbr><span class="acronym">USA</span></abbr>.
<a href="https://dendrolaborg.wordpress.com/">https://dendrolaborg.wordpress.com/</a>
</p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) A theory-driven approach to tree-ring
standardization: Defining the biological trend from expected basal area
increment.  <em>Tree-Ring Research</em>, <b>64</b>(2), 81‚Äì96.
</p>

<hr>
<h2 id='gp.rwl'> Ponderosa Pine Ring Widths from Gus Pearson Natural Area </h2><span id='topic+gp.rwl'></span>

<h3>Description</h3>

<p>This data set includes ring-width measurements for ponderosa pine
(<em>Pinus ponderosa</em>) increment cores collected at the Gus Pearson
Natural Area (<abbr><span class="acronym">GPNA</span></abbr>) in northern Arizona,
<abbr><span class="acronym">USA</span></abbr>.  There are 58 series from 29 trees (2 cores per
tree).  Data are further described by Biondi and Qeadan (2008) and
references therein.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gp.rwl)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 58 ring-width series in columns and 421
years in rows.
</p>


<h3>Source</h3>

<p>DendroLab, University of Nevada Reno, <abbr><span class="acronym">USA</span></abbr>.
<a href="https://dendrolaborg.wordpress.com/">https://dendrolaborg.wordpress.com/</a>
</p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) A theory-driven approach to tree-ring
standardization: Defining the biological trend from expected basal area
increment.  <em>Tree-Ring Research</em>, <b>64</b>(2), 81‚Äì96.
</p>

<hr>
<h2 id='hanning'> Hanning Filter </h2><span id='topic+hanning'></span>

<h3>Description</h3>

<p>Applies a Hanning filter of length <code><var>n</var></code> to <code><var>x</var></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hanning(x, n = 7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hanning_+3A_x">x</code></td>
<td>
<p> a vector </p>
</td></tr>
<tr><td><code id="hanning_+3A_n">n</code></td>
<td>
<p> length of the Hanning filter, defaults to 7 </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This applies a low frequency Hanning (a.k.a. Hann) filter to
<code><var>x</var></code> with weight set to <code><var>n</var></code>.
</p>


<h3>Value</h3>

<p>A filtered vector.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Oppenheim, A. V., Schafer, R. W., and Buck, J. R. (1999) <em>
Discrete-Time Signal Processing</em>.  Prentice-Hall, 2nd edition.
<abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-13-754920-7.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+filter">filter</a> </code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
data(ca533)
yrs &lt;- time(ca533)
y &lt;- ca533[, 1]
not.na &lt;- !is.na(y)
yrs &lt;- yrs[not.na]
y &lt;- y[not.na]
plot(yrs, y, xlab = "Years", ylab = "Series1 (mm)",
     type = "l", col = "grey")
lines(yrs, hanning(y, n = 9), col = "red", lwd = 2)
lines(yrs, hanning(y, n = 21), col = "blue", lwd = 2)
legend("topright", c("Series", "n=9", "n=21"),
       fill=c("grey", "red", "blue"))
</code></pre>

<hr>
<h2 id='i.detrend'> Interactively Detrend Multiple Ring-Width Series </h2><span id='topic+i.detrend'></span>

<h3>Description</h3>

<p>Interactively detrend multiple tree-ring series by one of two methods, a
smoothing spline or a statistical model.  This is a wrapper for
<code><a href="#topic+detrend.series">detrend.series</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>i.detrend(rwl, y.name = names(rwl), nyrs = NULL, f = 0.5,
          pos.slope = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="i.detrend_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> or
<code><a href="#topic+ca533">ca533</a></code> </p>
</td></tr>
<tr><td><code id="i.detrend_+3A_y.name">y.name</code></td>
<td>
<p> a <code>character</code> vector of length
<code>ncol(<var>rwl</var>)</code> that gives the <abbr><span class="acronym">ID</span></abbr> of each
series.  Defaults to the column names of <code><var>rwl</var></code>. </p>
</td></tr>
<tr><td><code id="i.detrend_+3A_nyrs">nyrs</code></td>
<td>
<p> a number giving the rigidity of the smoothing spline,
defaults to 0.67 of series length if <code><var>nyrs</var></code> is
<code>NULL</code>. </p>
</td></tr>
<tr><td><code id="i.detrend_+3A_f">f</code></td>
<td>
<p> a number between 0 and 1 giving the frequency response or
wavelength cutoff.  Defaults to 0.5. </p>
</td></tr>
<tr><td><code id="i.detrend_+3A_pos.slope">pos.slope</code></td>
<td>
<p> a <code>logical</code> flag.  Will allow for a positive
slope to be used in method <code>"ModNegExp"</code>.  If <code>FALSE</code> the
line will be horizontal. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows a user to choose detrending curves based on plots
that are produced by <code><a href="#topic+detrend.series">detrend.series</a></code> for which it is
essentially a wrapper.  The user enters their choice of detrended
method via keyboard at a prompt for each ring width series in
<code><var>rwl</var></code>.  See <code><a href="#topic+detrend.series">detrend.series</a></code> for examples and
details on the detrending methods.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing each detrended series according to the
method used as columns and rownames set to
<code>colnames(<var>y</var>)</code>.  These are typically years.  Plots are also
produced as the user chooses the detrending methods through keyboard
input.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn </p>


<h3>See Also</h3>

 <p><code><a href="#topic+detrend.series">detrend.series</a></code> </p>

<hr>
<h2 id='i.detrend.series'> Interactively Detrend a Ring-Width Series </h2><span id='topic+i.detrend.series'></span>

<h3>Description</h3>

<p>Interactively detrend a tree-ring series by one of three methods, a
smoothing spline, a linear model, or the mean.  This is a wrapper for
<code><a href="#topic+detrend.series">detrend.series</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>i.detrend.series(y, y.name = NULL, nyrs = NULL, f = 0.5,
                 pos.slope = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="i.detrend.series_+3A_y">y</code></td>
<td>
<p> a <code>numeric</code> vector.  Usually a tree-ring series. </p>
</td></tr>
<tr><td><code id="i.detrend.series_+3A_y.name">y.name</code></td>
<td>
<p> an optional <code>character</code> vector to name the series
for plotting purposes. </p>
</td></tr>
<tr><td><code id="i.detrend.series_+3A_nyrs">nyrs</code></td>
<td>
<p> a number giving the rigidity of the smoothing spline,
defaults to 0.67 of series length if <code><var>nyrs</var></code> is
<code>NULL</code>. </p>
</td></tr>
<tr><td><code id="i.detrend.series_+3A_f">f</code></td>
<td>
<p> a number between 0 and 1 giving the frequency response or
wavelength cutoff.  Defaults to 0.5. </p>
</td></tr>
<tr><td><code id="i.detrend.series_+3A_pos.slope">pos.slope</code></td>
<td>
<p> a <code>logical</code> flag.  Will allow for a positive
slope to be used in method <code>"ModNegExp"</code>.  If <code>FALSE</code> the
line will be horizontal. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows a user to choose a detrending method based on a
plot that is produced by <code><a href="#topic+detrend.series">detrend.series</a></code> for which it is
essentially a wrapper.  The user enters their choice of detrended
method via keyboard at a prompt.  See <code><a href="#topic+detrend.series">detrend.series</a></code> for
examples and details on the detrending methods.
</p>


<h3>Value</h3>

<p>A vector containing the detrended series (<code><var>y</var></code>) according to
the method used with names set to <code>colnames(<var>y</var>)</code>.  These are
typically years.  A plot is also produced and the user chooses a method
through keyboard input.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+detrend.series">detrend.series</a></code> </p>

<hr>
<h2 id='insert.ring'> Edit a Ring-Width Series </h2><span id='topic+insert.ring'></span><span id='topic+delete.ring'></span>

<h3>Description</h3>

<p>Insert or delete rings from a ring-width series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert.ring(rw.vec,rw.vec.yrs=as.numeric(names(rw.vec)),
            year,ring.value=mean(rw.vec,na.rm=TRUE),
            fix.last=TRUE,fix.length=TRUE)
delete.ring(rw.vec,rw.vec.yrs=as.numeric(names(rw.vec)),
            year,fix.last=TRUE,fix.length=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insert.ring_+3A_rw.vec">rw.vec</code></td>
<td>
<p> a vector of data </p>
</td></tr>
<tr><td><code id="insert.ring_+3A_rw.vec.yrs">rw.vec.yrs</code></td>
<td>
<p> the years for <code>rw.vec</code> as <code>names</code> </p>
</td></tr>
<tr><td><code id="insert.ring_+3A_year">year</code></td>
<td>
<p> the year to add or delete </p>
</td></tr>
<tr><td><code id="insert.ring_+3A_ring.value">ring.value</code></td>
<td>
<p> the value to add </p>
</td></tr>
<tr><td><code id="insert.ring_+3A_fix.last">fix.last</code></td>
<td>
<p> logical.  If TRUE the last year of the series
is fixed and the first year changes.</p>
</td></tr>
<tr><td><code id="insert.ring_+3A_fix.length">fix.length</code></td>
<td>
<p> logical.  If TRUE the length of the output will be the 
length of the input.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simple editing of ring widths.
</p>


<h3>Value</h3>

<p>A named vector.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+dplR">dplR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(gp.rwl)
dat &lt;- gp.rwl
# insert a value of zero for the year 1950 in series 50A
# fix the last year of growth and maintain the length of the series
tmp &lt;- insert.ring(rw.vec=dat$"50A",rw.vec.yrs = time(dat),
                   year=1950,ring.value=0,fix.length = TRUE)
# with fix.length=TRUE this can be merged back into the rwl object:
data.frame(dat$"50A",tmp)
dat$"50A" &lt;- tmp

# note that if fix.last = FALSE and fix.length = FALSE inserting a ring causes the
# ending year of the series to be pushed forward and the length of the output to
# be longer than the original series.
tmp &lt;- insert.ring(rw.vec=dat$"50A",rw.vec.yrs = time(dat),
                   year=1950,ring.value=0, fix.last = FALSE, 
                   fix.length = FALSE)
# with fix.length=FALSE this can't be merged back into the rwl object the
# same way as above
tail(tmp)
length(tmp)
nrow(dat)

# the same logic applies to deleting rings.
dat &lt;- gp.rwl
# delete the year 1950 in series 50A
# fix the last year of growth and maintain the length of the series
tmp &lt;- delete.ring(rw.vec=dat$"50A",rw.vec.yrs = time(dat),
                   year=1950,fix.last = TRUE, fix.length = TRUE)
# with fix.length=TRUE this can be merged back into the rwl object:
data.frame(dat$"50A",tmp)
dat$"50A" &lt;- tmp

# note that if fix.last = FALSE and fix.length = FALSE inserting a ring causes the
# ending year of the series to be pushed forward and the length of the output to
# be longer than the original series.
tmp &lt;- delete.ring(rw.vec=dat$"50A", rw.vec.yrs = time(dat),
                   year=1950, fix.last = FALSE, 
                   fix.length = FALSE)
# with fix.length=FALSE this can't be merged back into the rwl object the
# same way as above
tail(tmp)
length(tmp)
nrow(dat)
</code></pre>

<hr>
<h2 id='interseries.cor'> Individual Series Correlation Against a Master Chronology </h2><span id='topic+interseries.cor'></span>

<h3>Description</h3>

<p>This function calculates the correlation between a series and a master
chronology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  interseries.cor(rwl,n=NULL,prewhiten=TRUE,biweight=TRUE,
    method = c("spearman", "pearson", "kendall"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interseries.cor_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="interseries.cor_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length
for the <code><a href="#topic+hanning">hanning</a></code> filter used for removal of low
frequency variation. </p>
</td></tr>
<tr><td><code id="interseries.cor_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="interseries.cor_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>.</p>
</td></tr>
<tr><td><code id="interseries.cor_+3A_method">method</code></td>
<td>
<p>Can be either <code>"pearson"</code>, <code>"kendall"</code>, or
<code>"spearman"</code> which indicates the correlation coefficient to be
used.  Defaults to <code>"spearman"</code>.  See <code><a href="stats.html#topic+cor.test">cor.test</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates correlation serially between each tree-ring
series and a master chronology built from all the other series in the
<code><var>rwl</var></code> object (leave-one-out principle).
</p>
<p>Each series in the rwl object is optionally
detrended as the residuals from a <code><a href="#topic+hanning">hanning</a></code> filter with
weight <code><var>n</var></code>.  The filter is not applied if <code><var>n</var></code> is
<code>NULL</code>.  Detrending can also be done via prewhitening where the
residuals of an <code><a href="stats.html#topic+ar">ar</a></code> model are added to each series
mean.  This is the default.  The master chronology is computed as the
mean of the <code><var>rwl</var></code> object using <code><a href="#topic+tbrm">tbrm</a></code> if
<code><var>biweight</var></code> is <code>TRUE</code> and <code>rowMeans</code> if not.  Note
that detrending can change the length of the series.  E.g., a
<code><a href="#topic+hanning">hanning</a></code> filter will shorten the series on either end by
<code>floor(<var>n</var>/2)</code>.  The prewhitening default will change the
series length based on the <code><a href="stats.html#topic+ar">ar</a></code> model fit.  The effects of
detrending can be seen with <code><a href="#topic+series.rwl.plot">series.rwl.plot</a></code>.
</p>
<p>This function produces the same output of the <code><var>overall</var></code> portion of 
<code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code>.  The mean correlation value given is sometimes 
referred to as the &ldquo;overall interseries correlation&rdquo; or the &ldquo;COFECHA 
interseries correlation&rdquo;.  This output differs from the <code>rbar</code> 
statistics given by <code><a href="#topic+rwi.stats">rwi.stats</a></code> in that <code>rbar</code> is 
the average pairwise correlation between series where this is the 
correlation between a series and a master chronology.
</p>


<h3>Value</h3>

<p> a <code>data.frame</code> with correlation values and p-values given from
<code><a href="stats.html#topic+cor.test">cor.test</a></code>
</p>


<h3>Author(s)</h3>

<p> Andy Bunn, patched and improved by Mikko Korpela  </p>


<h3>See Also</h3>

 <p><code><a href="#topic+rwl.stats">rwl.stats</a></code>, <code><a href="#topic+rwi.stats">rwi.stats</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(gp.rwl)
foo &lt;- interseries.cor(gp.rwl)
# compare to: 
# corr.rwl.seg(rwl=gp.rwl,make.plot=FALSE)$overall
# using pearson's r
foo &lt;- interseries.cor(gp.rwl,method="pearson")

# two measures of interseries correlation
# compare interseries.cor to rbar from rwi.stats
gp.ids &lt;- read.ids(gp.rwl, stc = c(0, 2, 1))
bar &lt;- rwi.stats(gp.rwl, gp.ids, prewhiten=TRUE)
bar$rbar.eff
mean(foo[,1])

</code></pre>

<hr>
<h2 id='latexDate'>
Date Conversion to Character in LaTeX Format
</h2><span id='topic+latexDate'></span>

<h3>Description</h3>

<p>This is a simple convenience function that returns a date in the
format used by &lsquo;<span class="samp">&#8288;\today&#8288;</span>&rsquo; in LaTeX.  A possible use case is fixing
the date shown in a vignette at weaving time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latexDate(x = Sys.Date(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="latexDate_+3A_x">x</code></td>
<td>
<p> any object for which an <code>as.POSIXlt</code> method exists.
Defaults to the current date. </p>
</td></tr>
<tr><td><code id="latexDate_+3A_...">...</code></td>
<td>
<p> other arguments to <code>as.POSIXlt</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character</code> vector
</p>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>Examples</h3>

<pre><code class='language-R'>latexDate()                              # today
latexDate(Sys.Date() + 5)                # today + 5 days
latexDate(c("2013-12-06", "2014-09-19")) # fixed dates
## [1] "December 6, 2013"   "September 19, 2014"
latexDate(5*60*60*24, origin=Sys.Date()) # today + 5 days
</code></pre>

<hr>
<h2 id='latexify'>
Convert Character Strings for Use with LaTeX
</h2><span id='topic+latexify'></span>

<h3>Description</h3>

<p>Some characters cannot be entered directly into a LaTeX document.
This function converts the input <code>character</code> vector to a form
suitable for inclusion in a LaTeX document in text mode.  It can be
used together with &lsquo;<span class="samp">&#8288;\Sexpr&#8288;</span>&rsquo; in vignettes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latexify(x, doublebackslash = TRUE, dashdash = TRUE,
         quotes = c("straight", "curved"),
         packages = c("fontenc", "textcomp"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="latexify_+3A_x">x</code></td>
<td>
<p> a <code>character</code> vector </p>
</td></tr>
<tr><td><code id="latexify_+3A_doublebackslash">doublebackslash</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>,
backslashes in the output are doubled.  It seems that Sweave needs
<code>TRUE</code> and knitr <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="latexify_+3A_dashdash">dashdash</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code> (the default),
consecutive dashes (&ldquo;-&rdquo;) in the input will be rendered as
separate characters.  If <code>FALSE</code>, they will not be given any
special treatment, which will usually mean that two dashes are
rendered as an en dash and three dashes make an em dash. </p>
</td></tr>
<tr><td><code id="latexify_+3A_quotes">quotes</code></td>
<td>
<p> a <code>character</code> string specifying how single and
double quotes (<abbr><span class="acronym">ASCII</span></abbr> codes 39 and 34) and stand-alone
grave accents (<abbr><span class="acronym">ASCII</span></abbr> code 96) in the input are treated.
The default is to use straight quotes and the proper symbol for the
grave accent.  The other option is to use curved right side
(closing) quotes, and let LaTeX convert the grave accent to opening
curved quotes.  Straight double quotes are not available in the
default OT1 font encoding of LaTeX.  Straight single quotes and the
grave accent symbol require the &ldquo;textcomp&rdquo; package.  See
<code><var>packages</var></code>. </p>
</td></tr>
<tr><td><code id="latexify_+3A_packages">packages</code></td>
<td>
<p> a <code>character</code> vector specifying the LaTeX
packages allowed.  The use of some symbols in LaTeX requires
commands or characters made available by an add-on package.  If a
package required for a given character is not marked as available, a
fallback solution is silently used.  For example, curved quotes may
be used instead of straight quotes.  The supported packages are
<code>"eurosym"</code> (not used by default), <code>"fontenc"</code> and
<code>"textcomp"</code>.  Including <code>"fontenc"</code> in the vector means
that some other encoding than OT1 is going to be used.  Note that
straight quotes are an exception in the sense that a reasonable
substitute (curved quotes) is available.  In many other cases,
<code>"textcomp"</code> and <code>"fontenc"</code> are silently assumed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is intended for use with unformatted inline text.
Newlines, tabs and other whitespace characters (<code>"[:space:]"</code> in
<a href="base.html#topic+regex">regex</a>) are converted to spaces.  Control characters
(<code>"[:cntrl:]"</code>) that are not whitespace are removed.  Other more
or less special characters in the <abbr><span class="acronym">ASCII</span></abbr> set are &lsquo;{&rsquo;,
&lsquo;}&rsquo;, &lsquo;\&rsquo;, &lsquo;#&rsquo;, &lsquo;$&rsquo;, &lsquo;%&rsquo;,
&lsquo;^&rsquo;, &lsquo;&amp;&rsquo;, &lsquo;_&rsquo;, &lsquo;~&rsquo;, double quote,
&lsquo;/&rsquo;, single quote, &lsquo;&lt;&rsquo;, &lsquo;&gt;&rsquo;, &lsquo;|&rsquo;, grave
and &lsquo;-&rsquo;.  They are converted to the corresponding LaTeX
commands.  Some of the conversions are affected by user options,
e.g. <code><var>dashdash</var></code>.
</p>
<p>Before applying the substitutions described above, input elements with
<code><a href="base.html#topic+Encoding">Encoding</a></code> set to <code>"bytes"</code> are printed and the
output is stored using <code><a href="R.utils.html#topic+captureOutput">captureOutput</a></code>.  The result of
this intermediate stage is <abbr><span class="acronym">ASCII</span></abbr> text where some characters
are shown as their byte codes using a hexadecimal pair prefixed with
<code>"\x"</code>.  This set includes tabs, newlines and control
characters.  The substitutions are then applied to the intermediate
result.
</p>
<p>The quoting functions <code><a href="base.html#topic+sQuote">sQuote</a></code> and <code><a href="base.html#topic+dQuote">dQuote</a></code>
may use non-<abbr><span class="acronym">ASCII</span></abbr> quote characters, depending on the locale.
Also these quotes are converted to LaTeX commands.  This means that
the quoting functions are safe to use with any LaTeX input encoding.
Similarly, some other non-<abbr><span class="acronym">ASCII</span></abbr> characters, e.g. letters,
currency symbols, punctuation marks and diacritics, are converted to
commands.
</p>
<p>Adding <code>"eurosym"</code> to <code><var>packages</var></code> enables the use of the
euro sign as provided by the <code>"eurosym"</code> package (&lsquo;<span class="samp">&#8288;\euro&#8288;</span>&rsquo;).
</p>
<p>The result is converted to UTF-8 encoding, Normalization Form C (NFC).
Note that this function will not add any non-<abbr><span class="acronym">ASCII</span></abbr>
characters that were not already present in the input.  On the
contrary, some non-<abbr><span class="acronym">ASCII</span></abbr> characters, e.g. all characters in
the <code>"latin1"</code> (<abbr><span class="acronym">ISO</span></abbr>-8859-1) <code><a href="base.html#topic+Encoding">Encoding</a></code>
(character set), are removed when converted to LaTeX commands.  Any
remaining non-<abbr><span class="acronym">ASCII</span></abbr> character has a good chance of working
when the document is processed with XeTeX or LuaTeX, but the Unicode
support available with pdfTeX is limited.
</p>
<p>Assuming that &lsquo;<span class="samp">&#8288;pdflatex&#8288;</span>&rsquo; is used for compilation, suggested
package loading commands in the document preamble are: </p>
<pre>\usepackage[T1]{fontenc}    % no '"' in OT1 font encoding
\usepackage{textcomp}       % some symbols e.g. straight single quote
\usepackage[utf8]{inputenx} % UTF-8 input encoding
\input{ix-utf8enc.dfu}      % more supported characters</pre>


<h3>Value</h3>

<p>A <code>character</code> vector
</p>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>References</h3>

<p>INRIA.  Tralics: a LaTeX to XML translator, HTML documentation of all
TeX commands.  <a href="https://www-sop.inria.fr/marelle/tralics/">https://www-sop.inria.fr/marelle/tralics/</a>.
</p>
<p>Levitt, N., Persch, C., and Unicode, Inc. (2013) GNOME Character Map,
application version 3.10.1.
</p>
<p>Mittelbach, F., Goossens, M., Braams, J., Carlisle, D., and
Rowley, C. (2004) <em>The LaTeX Companion</em>.  Addison-Wesley,
second edition.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-201-36299-2.
</p>
<p>Pakin, S. (2009) The Comprehensive LaTeX Symbol
List.  <a href="https://www.ctan.org/tex-archive/info/symbols/comprehensive">https://www.ctan.org/tex-archive/info/symbols/comprehensive</a>.
</p>
<p>The Unicode Consortium.  The Unicode Standard.
<a href="https://home.unicode.org/">https://home.unicode.org/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 &lt;- "clich\xe9\nma\xf1ana"
Encoding(x1) &lt;- "latin1"
x1
x2 &lt;- x1
Encoding(x2) &lt;- "bytes"
x2
x3 &lt;- enc2utf8(x1)
testStrings &lt;-
    c("different     kinds\nof\tspace",
      "control\a characters \ftoo",
      "{braces} and \\backslash",
      '#various$ %other^ &amp;characters_ ~escaped"/coded',
      x1,
      x2,
      x3)
latexStrings &lt;- latexify(testStrings, doublebackslash = FALSE)
## All should be "unknown"
Encoding(latexStrings)
cat(latexStrings, sep="\n")
## Input encoding does not matter
identical(latexStrings[5], latexStrings[7])
</code></pre>

<hr>
<h2 id='morlet'> Perform a Continuous Morlet Wavelet Transform </h2><span id='topic+morlet'></span>

<h3>Description</h3>

<p>This function performs a continuous wavelet transform on a time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morlet(y1, x1 = seq_along(y1), p2 = NULL, dj = 0.25, siglvl = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="morlet_+3A_y1">y1</code></td>
<td>
<p><code>numeric</code> vector.  Series to be transformed.</p>
</td></tr>
<tr><td><code id="morlet_+3A_x1">x1</code></td>
<td>
<p><code>numeric</code>.  A vector of values giving the years for the
plot.  Must be the same length as <code>length(<var>y1</var>)</code>.</p>
</td></tr>
<tr><td><code id="morlet_+3A_p2">p2</code></td>
<td>
<p><code>numeric</code>.  The number of power of two to be computed
for the wavelet transform.  Calculated from length of <code><var>y1</var></code>
if <code>NULL</code>. </p>
</td></tr>
<tr><td><code id="morlet_+3A_dj">dj</code></td>
<td>
<p><code>numeric</code>.  Sub-octaves per octave calculated.</p>
</td></tr>
<tr><td><code id="morlet_+3A_siglvl">siglvl</code></td>
<td>
<p><code>numeric</code>.  Level for the significance test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This performs a continuous wavelet transform of a time series.  This
function is typically invoked with <code><a href="#topic+wavelet.plot">wavelet.plot</a></code>.
</p>


<h3>Value</h3>

<p>A <code>list</code> containing:
</p>
<table role = "presentation">
<tr><td><code>y</code></td>
<td>
<p><code>numeric</code>.  The original time series.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p><code>numeric</code>.  The time values.</p>
</td></tr>
<tr><td><code>wave</code></td>
<td>
<p><code>complex</code>.  The wavelet transform.</p>
</td></tr>
<tr><td><code>coi</code></td>
<td>
<p><code>numeric</code>.  The cone of influence.</p>
</td></tr>
<tr><td><code>period</code></td>
<td>
<p><code>numeric</code>.  The period.</p>
</td></tr>
<tr><td><code>Scale</code></td>
<td>
<p><code>numeric</code>.  The scale.</p>
</td></tr>
<tr><td><code>Signif</code></td>
<td>
<p><code>numeric</code>.  The significant values.</p>
</td></tr>
<tr><td><code>Power</code></td>
<td>
<p><code>numeric</code>.  The squared power.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> This is a port of Torrence‚Äôs <abbr><span class="acronym">IDL</span></abbr> code,
which can be accessed through the
<a href="https://web.archive.org/web/20141216211516/https://paos.colorado.edu/research/wavelets/software.html">Internet Archive Wayback Machine</a>.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Torrence, C. and Compo, G. P. (1998) A practical guide to wavelet
analysis.  <em>Bulletin of the American Meteorological Society</em>,
<b>79</b>(1), 61‚Äì78.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+wavelet.plot">wavelet.plot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
ca533.crn &lt;- chron(ca533.rwi, prewhiten = FALSE)
Years &lt;- time(ca533.crn)
CAMstd &lt;- ca533.crn[, 1]
out.wave &lt;- morlet(y1 = CAMstd, x1 = Years, dj = 0.1, siglvl = 0.99)
</code></pre>

<hr>
<h2 id='net'>
Calculate NET
</h2><span id='topic+net'></span>

<h3>Description</h3>

<p>Computes the <code class="reqn">\mathit{NET}</code> parameter for a set of tree-ring
records or other time-series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>net(x, weights = c(v = 1, g = 1))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="net_+3A_x">x</code></td>
<td>

<p>A <code>matrix</code> or <code>data.frame</code> with at least two rows and two
columns containing <code>numeric</code> data.  The rows should represent a
sequence of sampling points with uniform intervals (e.g. a range of
years), but this is not checked.  Each column is a time-series
spanning either the whole time range or a part of it.
</p>
</td></tr>
<tr><td><code id="net_+3A_weights">weights</code></td>
<td>

<p>A <code>numeric</code> vector with two elements.  Normally, variation
(<code>"v"</code>) and Gegenl√§ufigkeit
(<code>"g"</code>) contribute to NET with equal weight.  It is possible to
use different weights by setting them here.  The names of the vector
are matched to <code>c("v", "g")</code> (see &lsquo;Examples&rsquo;).  If no
names are given, the first element is the weight of variation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the <code class="reqn">\mathit{NET}</code> parameter (Esper et
al., 2001).  The overall <code class="reqn">\mathit{NET}</code> is an average of all
(non-<code>NA</code>) yearly values <code class="reqn">\mathit{NET_j}</code>, which are
computed as follows:
</p>
<p style="text-align: center;"><code class="reqn">\mathit{NET_j}=v_j+(1-G_j)</code>
</p>

<p>The yearly variation <code class="reqn">v_j</code> is the standard deviation of the
measurements of a single year divided by their mean.
Gegenl√§ufigkeit <code class="reqn">1-G_j</code> is based
on one definition of Gleichl√§ufigkeit
<code class="reqn">G_j</code>, similar to but not the same as what <code><a href="#topic+glk">glk</a></code>
computes.  Particularly, in the formula used by this function (Esper
et al., 2001), simultaneous zero differences in two series are not
counted as a synchronous change.
</p>
<p>The weights of <code class="reqn">v_j</code> and <code class="reqn">1-G_j</code> in the sum can
be adjusted with the argument <code><var>weights</var></code> (see above).  As a
rather extreme example, it is possible to isolate variation or
Gegenl√§ufigkeit by setting one of the weights
to zero (see &lsquo;Examples&rsquo;).
</p>


<h3>Value</h3>

<p>A <code>list</code> with the following components, in the same order as
described here:
</p>
<table role = "presentation">
<tr><td><code>all</code></td>
<td>
<p>a <code>numeric</code> vector containing
<code class="reqn">\mathit{NET_j}</code>.  Row names of <code><var>x</var></code> (if any)
are copied here. </p>
</td></tr>
<tr><td><code>average</code></td>
<td>
<p>a <code>numeric</code> value <code class="reqn">\mathit{NET}</code>, the
average of the <code>"all"</code> vector (<code>NA</code> values removed). </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>References</h3>

<p>Esper, J., Neuwirth, B., and Treydte, K. (2001) A new parameter to
evaluate temporal signal strength of tree-ring chronologies.
<em>Dendrochronologia</em>, <b>19</b>(1), 93‚Äì102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
ca533.net &lt;- net(ca533.rwi)
tail(ca533.net$all)
ca533.net$average
## Not run: 
## Isolate the components of NET
ca533.v &lt;- net(ca533.rwi, weights=c(v=1,0))
ca533.g &lt;- net(ca533.rwi, weights=c(g=1,0))

## End(Not run)
</code></pre>

<hr>
<h2 id='nm046'>Los Alamos Tree Ring Widths</h2><span id='topic+nm046'></span>

<h3>Description</h3>

<p>This data set gives the raw ring widths for Douglas fir
<em>Pseudotsuga menziesii</em> near Los Alamos New Mexico,
<abbr><span class="acronym">USA</span></abbr>.  There are 8 series.  Data set was created using
<code><a href="#topic+read.rwl">read.rwl</a></code> and saved to an .rda file using
<code><a href="base.html#topic+save">save</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nm046)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 8 tree-ring series in columns and 289
years in rows.
</p>


<h3>Source</h3>

<p>International tree-ring data bank, Accessed on 20-April-2021 at
<a href="https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/usa/nm046.rwl">https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/usa/nm046.rwl</a>
</p>


<h3>References</h3>

<p>O'Brien, D (2002) Los Alamos Data
Set.  <abbr><span class="acronym">IGBP</span></abbr> <abbr><span class="acronym">PAGES</span></abbr>/World Data Center for
Paleoclimatology Data Contribution Series 2002-NM046.RWL.
<abbr><span class="acronym">NOAA</span></abbr>/<abbr><span class="acronym">NCDC</span></abbr> Paleoclimatology Program, Boulder,
Colorado, <abbr><span class="acronym">USA</span></abbr>.
</p>

<hr>
<h2 id='pass.filt'> Low-pass, high-pass, band-pass, and stop-pass filtering </h2><span id='topic+pass.filt'></span>

<h3>Description</h3>

<p>Applies low-pass, high-pass, band-pass, or stop-pass filtering to <code><var>y</var></code> with frequencies (or periods) supplied by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pass.filt(y, W, type = c("low", "high", "stop", "pass"),
          method = c("Butterworth", "ChebyshevI"),
          n = 4, Rp = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pass.filt_+3A_y">y</code></td>
<td>
<p> a <code>numeric</code> vector, typically a tree-ring series. </p>
</td></tr>
<tr><td><code id="pass.filt_+3A_w">W</code></td>
<td>
<p> a <code>numeric</code> vector giving frequency or period of the
filter. See details. </p>
</td></tr>
<tr><td><code id="pass.filt_+3A_type">type</code></td>
<td>
<p> a <code>character</code> giving the type of filter. Values can
be &quot;low&quot;, &quot;high&quot;, &quot;stop&quot;, or &quot;pass&quot; for low-pass, high-pass,
band-pass, or stop-pass filters. Defaults to &quot;low&quot;. </p>
</td></tr>
<tr><td><code id="pass.filt_+3A_method">method</code></td>
<td>
<p> a <code>character</code> specifying indicating whether to use
a Butterworth (default) or a type I Chebyshev filter.</p>
</td></tr>
<tr><td><code id="pass.filt_+3A_n">n</code></td>
<td>
<p> a <code>numeric</code> value giving the order of the
filter. Larger numbers create steeper fall off.</p>
</td></tr>
<tr><td><code id="pass.filt_+3A_rp">Rp</code></td>
<td>
<p> a <code>numeric</code> value giving the dB for the passband ripple. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function applies either a Butterworth or a Chebyshev type I filter of order <code><var>n</var></code> to a signal and is nothing more than a wrapper for  functions in the <code>signal</code> package. The filters are designed via <code><a href="signal.html#topic+butter">butter</a></code> and <code><a href="signal.html#topic+cheby1">cheby1</a></code>. The filter is applied via <code><a href="signal.html#topic+filtfilt">filtfilt</a></code>. 
</p>
<p>The input data (<code>y</code>) has the mean value subtracted and is then padded via reflection at the start and the end to a distance of twice the maximum period. The padded data and the filter are passed to <code><a href="signal.html#topic+filtfilt">filtfilt</a></code> after which the data are unpadded and returned afer the mean is added back. 
</p>
<p>The argumement <code><var>W</var></code> can be given in either frequency between 0 and 0.5 or, for convenience, period (minimum value of 2). For low-pass and high-pass filters, <code><var>W</var></code> must have a length of one. For low-pass and high-pass filters <code><var>W</var></code> must be a two-element vector (<code>c(low, high)</code>) specifying the lower and upper boundaries of the filter. 
</p>
<p>Because this is just a wrapper for casual use with tree-ring data the frequencies and periods assume a sampling frequency of one. Users are encouraged to build their own filters using the <code>signal</code> package.
</p>


<h3>Value</h3>

 
<p>A filtered vector. 
</p>


<h3>Author(s)</h3>

<p>Andy Bunn. Patched and improved by Mikko Korpela.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+hanning">hanning</a></code>, <code><a href="#topic+detrend">detrend</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data("co021")
x &lt;- na.omit(co021[, 1])

# 20-year low-pass filter -- note freq is passed in
bSm &lt;- pass.filt(x, W=0.05, type="low", method="Butterworth")
cSm &lt;- pass.filt(x, W=0.05, type="low", method="ChebyshevI")
plot(x, type="l", col="grey")
lines(bSm, col="red")
lines(cSm, col="blue")

# 20-year high-pass filter -- note period is passed in
bSm &lt;- pass.filt(x, W=20, type="high")
plot(x, type="l", col="grey")
lines(bSm, col="red")

# 20 to 100-year band-pass filter -- note freqs are passed in
bSm &lt;- pass.filt(x, W=c(0.01, 0.05), type="pass")
cSm &lt;- pass.filt(x, W=c(0.01, 0.05), type="pass", method="ChebyshevI")
plot(x, type="l", col="grey")
lines(bSm, col="red")
lines(cSm, col="blue")

# 20 to 100-year stop-pass filter -- note periods are passed in
cSm &lt;- pass.filt(x, W=c(20, 100), type="stop", method="ChebyshevI")
plot(x, type="l", col="grey")
lines(cSm, col="red")
</code></pre>

<hr>
<h2 id='plot.crn'> Plot a Tree-Ring Chronology </h2><span id='topic+plot.crn'></span><span id='topic+crn.plot'></span>

<h3>Description</h3>

<p>This function makes a default plot of a tree-ring chronology from a
<code>data.frame</code> of the type produced by <code><a href="#topic+chron">chron</a></code>, 
<code><a href="#topic+chron.ars">chron.ars</a></code>, <code><a href="#topic+chron.stabilized">chron.stabilized</a></code>, <code><a href="#topic+ssf">ssf</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'crn'
plot(x, add.spline = FALSE, nyrs = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.crn_+3A_x">x</code></td>
<td>
<p> a <code>data.frame</code> of <code>class{crn}</code>.e.g., as produced by
<code><a href="#topic+chron">chron</a></code>, <code><a href="#topic+chron.ars">chron.ars</a></code>, <code><a href="#topic+chron.stabilized">chron.stabilized</a></code>, 
<code><a href="#topic+ssf">ssf</a></code>. </p>
</td></tr>
<tr><td><code id="plot.crn_+3A_add.spline">add.spline</code></td>
<td>
<p> a <code>logical</code> flag.  Will add a line with a
smoothing spline using <code><a href="#topic+caps">caps</a> </code> </p>
</td></tr>
<tr><td><code id="plot.crn_+3A_nyrs">nyrs</code></td>
<td>
<p> a number giving the rigidity of the smoothing spline.
Defaults to 1/3 times the length of the first chronology if
<code><var>nyrs</var></code> is <code>NULL</code> </p>
</td></tr>
<tr><td><code id="plot.crn_+3A_...">...</code></td>
<td>
<p> Additional arguments to pass to <code><a href="base.html#topic+plot">plot</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This makes a crude plot of one or more tree-ring chronologies.
</p>


<h3>Value</h3>

<p>None.  Invoked for side effect (plot).
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+chron">chron</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
data(wa082)
# Truncate the RW data to a sample depth at least 5
wa082Trunc &lt;- wa082[rowSums(!is.na(wa082))&gt;4,]
# Detrend with age-dependent spline
wa082RWI &lt;- detrend(wa082Trunc,method = "AgeDep")
# make several chronologies
wa082CRN1 &lt;- chron(wa082RWI)
wa082CRN2 &lt;- chron.stabilized(wa082RWI,
                              winLength=51,
                              biweight = TRUE,
                              running.rbar = TRUE)
wa082CRN3 &lt;- chron.ars(wa082RWI)
wa082CRN4 &lt;- ssf(wa082Trunc)

# and plot
plot.crn(wa082CRN1,add.spline = TRUE,nyrs=20)
plot.crn(wa082CRN2,add.spline = TRUE,nyrs=20)
plot(wa082CRN3,add.spline = TRUE,nyrs=20)
plot(wa082CRN4,add.spline = TRUE,nyrs=20)

# a custom crn
foo &lt;- data.frame(wa082CRN1,sfc=wa082CRN4$sfc)
foo &lt;- foo[,c(1,3,2)]
class(foo) &lt;- c("crn","data.frame")
plot.crn(foo,add.spline = TRUE,nyrs=20)

</code></pre>

<hr>
<h2 id='plot.crs'>
Plotting crs Objects
</h2><span id='topic+plot.crs'></span>

<h3>Description</h3>

<p>Plots objects returned from <code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'crs'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.crs_+3A_x">x</code></td>
<td>
<p> An object of class <code>"crs"</code>.  </p>
</td></tr>
<tr><td><code id="plot.crs_+3A_...">...</code></td>
<td>
<p> Additional arguments passed to <code><a href="base.html#topic+plot">plot</a></code>  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  A plot is produced.
</p>


<h3>Author(s)</h3>

<p>Andy Bunn
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
data(co021)
foo &lt;- corr.rwl.seg(co021, make.plot = FALSE)
plot(foo)
</code></pre>

<hr>
<h2 id='plot.rwl'>
Plotting Rwl Objects
</h2><span id='topic+plot.rwl'></span>

<h3>Description</h3>

<p>Plots rwl objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rwl'
plot(x, plot.type=c("seg","spag"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.rwl_+3A_x">x</code></td>
<td>
<p> An object of class <code>"rwl"</code>.  </p>
</td></tr>
<tr><td><code id="plot.rwl_+3A_plot.type">plot.type</code></td>
<td>
<p> Character.  Type &quot;seg&quot; calls <code><a href="#topic+seg.plot">seg.plot</a></code> 
while &quot;spag&quot; calls <code><a href="#topic+spag.plot">spag.plot</a></code> </p>
</td></tr>
<tr><td><code id="plot.rwl_+3A_...">...</code></td>
<td>
<p> Additional arguments for each <code>type</code>  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  A plot is produced.
</p>


<h3>Author(s)</h3>

<p>Andy Bunn
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.rwl">read.rwl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
data(co021)
plot(co021, plot.type="seg")
plot(co021, plot.type="spag")
plot(co021, plot.type="spag", zfac=2)
</code></pre>

<hr>
<h2 id='po.to.wc'>
Convert Pith Offset to Wood Completeness
</h2><span id='topic+po.to.wc'></span>

<h3>Description</h3>

<p>This function creates a partial wood completeness data structure based
on pith offset data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.to.wc(po)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.to.wc_+3A_po">po</code></td>
<td>

<p>A <code>data.frame</code> containing two variables.  Variable one
(<code><var>series</var></code>) gives the series <abbr><span class="acronym">ID</span></abbr> as either
<code>character</code>s or <code>factor</code>s.  Variable two
(<code><var>pith.offset</var></code>) contains integral values and gives the
years from the beginning of the core to the pith (or center) of the
tree.  The minimum value is 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code><var>pith.offset</var> - 1</code> as the number of missing heartwood
rings.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing one variable of wood completeness data:
<code><var>n.missing.heartwood</var></code> (<code>integer</code> type).  This can be
used as input to <code><a href="#topic+write.tridas">write.tridas</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wc.to.po">wc.to.po</a></code>, <code><a href="#topic+rcs">rcs</a></code>, <code><a href="#topic+write.tridas">write.tridas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(utils)
data(gp.po)
all(wc.to.po(po.to.wc(gp.po)) == gp.po)

## End(Not run)
</code></pre>

<hr>
<h2 id='pointer'> Calculates Pointer Years from a Group of Ring-Width Series </h2><span id='topic+pointer'></span>

<h3>Description</h3>

<p>This function calculates pointer years on a <code>data.frame</code> of
ring-width series using the Becker algorithm.  The pointer years are
computed with adjustable thresholds of relative radial growth
variation and number of series displaying similar growth pattern
(i.e. positive or negative variations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointer(rwl, rgv.thresh = 10, nseries.thresh = 75, round.decimals = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pointer_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with ring-width series as columns and
years as rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="pointer_+3A_rgv.thresh">rgv.thresh</code></td>
<td>
<p> a <code>numeric</code> giving the minimum absolute
relative radial growth variation (in percentage) above which the
growth change from the year <em>t-1</em> to <em>t</em> is considered as
significant.  Must be &gt; 0.  Values &gt; 100 are possible but highly
unusual.  See references.  Defaults to 10. </p>
</td></tr>
<tr><td><code id="pointer_+3A_nseries.thresh">nseries.thresh</code></td>
<td>
<p> a <code>numeric</code> giving the minimum percentage
of series displaying significant relative radial growth variations
of a same sign above which the year <code><var>t</var></code> is considered as
a pointer year.  Positive significant variations will results in a
positive pointer year, negative ones in a negative pointer year.
This number ranges from 1 to 100.  Defaults to 75. </p>
</td></tr>
<tr><td><code id="pointer_+3A_round.decimals">round.decimals</code></td>
<td>
<p> an <code>integer</code> indicating the number of
decimal places to be used for outputs.  This number must be
positive.  Defaults to 2. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates pointer years from ring-width series for each year
<code><var>t</var></code> of the time period covered by the series using the
Becker algorithm.  This algorithm is based on, first, the calculation
of the individual relative radial growth variation by comparison of
ring-width of year <code><var>t</var></code> to that of year <code><var>t</var>-1</code> for
each series, and second, the inter-series comparison of both sign and
magnitude of these variations.
</p>
<p>For example, if <code><var>rgv.thresh</var></code> and
<code><var>nseries.thresh</var></code> are set at 10 and 75 respectively, pointer
years will be defined as those years when at least 75% of the series
present an absolute relative radial growth variation higher than 10%.
</p>
<p>Users unfamiliar with the Becker algorithm should refer to Becker et
al. (1994) and M√©rian and Lebourgeois (2011) for further
details.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the following columns (each row
corresponds to one position of the window):
</p>
<table role = "presentation">
<tr><td><code>Year</code></td>
<td>
<p> Considered year (t).</p>
</td></tr>
<tr><td><code>Nb.series</code></td>
<td>
<p> Number of available series.</p>
</td></tr>
<tr><td><code>Perc.pos</code></td>
<td>
<p> Percentage of series displaying a significant
positive radial growth variation.</p>
</td></tr>
<tr><td><code>Perc.neg</code></td>
<td>
<p> Percentage of series displaying a significant
negative radial growth variation.</p>
</td></tr>
<tr><td><code>Nature</code></td>
<td>
<p> Number indicating whether the year is a positive
pointer year (1), a negative pointer year (-1) or a regular year
(0).</p>
</td></tr>
<tr><td><code>RGV_mean</code></td>
<td>
<p> Mean radial growth variations over the available
series.</p>
</td></tr>
<tr><td><code>RGV_sd</code></td>
<td>
<p> Standard deviation of the radial growth variations over
the available series. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Pierre M√©rian.  Improved by Mikko Korpela and Andy
Bunn. </p>


<h3>References</h3>

 
<p>Becker, M., Nieminen, T. M., and G√©r√©mia, F. (1994)
Short-term variations and long-term changes in oak productivity in
northeastern France ‚Äì the role of climate and atmospheric
CO2.  <em>Annals of Forest Science</em>, <b>51</b>(5),
477‚Äì492.
</p>
<p>M√©rian, P. and Lebourgeois, F. (2011) Size-mediated
climate‚Äìgrowth relationships in temperate forests: A multi-species
analysis.  <em>Forest Ecology and Management</em>,
<b>261</b>(8), 1382‚Äì1391.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+skel.plot">skel.plot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Pointer years calculation on ring-width series. Returns a data.frame.
library(utils)
data(gp.rwl)
py &lt;- pointer(rwl=gp.rwl, rgv.thresh=10, nseries.thresh=75,
              round.decimals=2)
tail(py)
</code></pre>

<hr>
<h2 id='powt'>Power Transformation of Tree-Ring Data</h2><span id='topic+powt'></span>

<h3>Description</h3>

<p>Power transformation of tree-ring width.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powt(rwl, method = "universal", rescale = FALSE,
     return.power=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powt_+3A_rwl">rwl</code></td>
<td>
<p>a <code>data.frame</code>, typically of raw tree-ring widths series, such 
as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> or <code><a href="#topic+read.fh">read.fh</a></code></p>
</td></tr>
<tr><td><code id="powt_+3A_method">method</code></td>
<td>
<p> a <code>character</code> vector to determine the transform
method.  See details below.  Possible values are either &quot;universal&quot; or 
&quot;cook.&quot; Pattern matching is used.</p>
</td></tr>
<tr><td><code id="powt_+3A_rescale">rescale</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then each transformed 
series is rescaled to have the orginal mean and standard deviation of the 
input data. See details. </p>
</td></tr>
<tr><td><code id="powt_+3A_return.power">return.power</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then the power 
estimate(s) is returned. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>In dendrochronology, ring width series are sometimes power transformed to 
address heteroscedasticity. 
</p>
<p>The classic procedure used by <code>method="cook"</code> 
is a variance stabilization technique implemented after
Cook &amp; Peters (1997): for each series a linear model is fitted on the
logs of level and spread, where level is defined as the local mean
<code class="reqn">M_t = \left(R_t + R_{t-1}\right)/2</code> with
ring widths R, and spread S is the local standard deviation defined as
<code class="reqn">S_t = \left|R_t - R_{t-1}\right|</code>.  The
regression coefficient b from a linear model  
<code class="reqn">\log S = k + b \log M</code> is then used for the 
power transform <code class="reqn">\star{R}_t = R_t^{1-b}</code>.
</p>
<p>The procedure above is modified with <code>method="universal"</code> where all samples 
are used simultaneously in a linear mixed-effects model with time (year)
as a random effect: <code>lmer(log S ~ log M + (1|year)</code>. This &quot;universal&quot; or 
&quot;signal free&quot; approach accounts for the common year effect across all of the 
series in <code>rwl</code> and should address that not every year has the same 
change in environmental conditions to the previous year. 
</p>
<p>The <code>rescale</code> argument will return the series with a mean and standard
deviation that matches the input data. While this is a common convention,
users should note that this can produce negative values which can be confusing
if thought of as &quot;ring widths.&quot;
</p>


<h3>Value</h3>

<p>Either an object of class <code>c("rwl", "data.frame")</code> containing the 
power transformed ring width series with the series in columns and the years 
as rows or in the case of a single series, a possibly named vector of the same. 
With class <code>rwl</code>, the series <abbr><span class="acronym">ID</span></abbr>s are the column names and the 
years are the row names.
</p>
<p>If <code>return.power=TRUE</code> the returned 
object is a <code>list</code> containing the power transformed data and a 
<code>numeric</code> with the power estimate(s) used to transform the data.
</p>


<h3>Author(s)</h3>

<p>Christian Zang implemented the Cook and Peters method. Stefan Klesse conceived
and wrote the universal method. Patched and improved by Mikko Korpela and 
Andy Bunn.
</p>


<h3>References</h3>

<p>Cook, E. R. and Peters, K. (1997) Calculating unbiased
tree-ring indices for the study of climatic and environmental
change.  <em>The Holocene</em>, <b>7</b>(3), 361‚Äì370.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(zof.rwl)
powtUniversal &lt;- powt(zof.rwl, method = "universal")
powtCook &lt;- powt(zof.rwl, method = "cook")

op &lt;- par(no.readonly = TRUE)
par(mfcol = c(1, 3))
hist(summary(zof.rwl)$skew,
     breaks = seq(-2.25,2.25,by=0.25),
     main="Raw Data",xlab="Skew")
hist(summary(powtUniversal)$skew,
     breaks = seq(-2.25,2.25,by=0.25),
     main="Universal POWT",xlab="Skew")
hist(summary(powtCook)$skew,
     breaks = seq(-2.25,2.25,by=0.25),
     main="Cook POWT",xlab="Skew")
par(op) # restore graphical parameters
</code></pre>

<hr>
<h2 id='print.redfit'>
Printing Redfit Results
</h2><span id='topic+print.redfit'></span>

<h3>Description</h3>

<p>Print information contained in or derived from a redfit object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'redfit'
print(x, digits = NULL, csv.out = FALSE, do.table = FALSE,
      prefix = "", row.names = FALSE, file = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.redfit_+3A_x">x</code></td>
<td>
<p> An object of class <code>"redfit"</code>.  </p>
</td></tr>
<tr><td><code id="print.redfit_+3A_digits">digits</code></td>
<td>
<p> Specifies the desired number of significant digits in
the output.  The argument is passed to <code><a href="base.html#topic+format">format</a></code> and
<code><a href="base.html#topic+print.data.frame">print.data.frame</a></code>.  A positive integral value or
<code>NULL</code>.  If <code>NULL</code>, the value in <code>options("digits")</code>
is used. </p>
</td></tr>
<tr><td><code id="print.redfit_+3A_csv.out">csv.out</code></td>
<td>
<p> A <code>logical</code> flag.  If <code>TRUE</code>, writes a
large, comma-separated table of information.  The table contains one
row for each frequency.  If <code>FALSE</code>, writes a few summary
numbers instead.  See &lsquo;Details&rsquo;. </p>
</td></tr>
<tr><td><code id="print.redfit_+3A_do.table">do.table</code></td>
<td>
<p> A <code>logical</code> flag.  If <code>TRUE</code>, the large
information table is also printed when <code>csv.out</code> is
<code>FALSE</code>, although not in a comma-separated format but with
<code>print.data.frame</code>.  </p>
</td></tr>
<tr><td><code id="print.redfit_+3A_prefix">prefix</code></td>
<td>
<p> A prefix to be used on every output line except the
large information table.  REDFIT (see <code>References</code>) uses
<code>"# "</code>.  </p>
</td></tr>
<tr><td><code id="print.redfit_+3A_row.names">row.names</code></td>
<td>
<p> A <code>logical</code> flag enabling or disabling
automatic row names from the large information table, or a
<code>character</code> vector of names.  In any case, the table will
contain frequency as the first column. </p>
</td></tr>
<tr><td><code id="print.redfit_+3A_file">file</code></td>
<td>
<p> A writable connection or a character string naming a
file.  Used for setting the output destination when
<code><var>csv.out</var></code> is <code>TRUE</code>.  The default is to write the
comma-separated table to the console.  </p>
</td></tr>
<tr><td><code id="print.redfit_+3A_...">...</code></td>
<td>
<p> Arguments to <code>write.csv</code>.  Used when
<code><var>csv.out</var></code> is <code>TRUE</code>.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns <code><var>x</var></code>.
</p>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>References</h3>

<p>This function is based on the Fortran program
<a href="https://www.marum.de/Prof.-Dr.-michael-schulz.html">REDFIT</a>,
which is in the public domain.
</p>
<p>Schulz, M. and Mudelsee, M. (2002) REDFIT: estimating red-noise
spectra directly from unevenly spaced paleoclimatic time series.
<em>Computers &amp; Geosciences</em>, <b>28</b>(3), 421‚Äì426.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+redfit">redfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
tm &lt;- time(ca533)
x &lt;- ca533[[1]]
idx &lt;- which(!is.na(x))
redf &lt;- redfit(x[idx], tm[idx], "time",
               nsim = 100, iwin = 0, ofac = 1, n50 = 1)
print(redf)
fname &lt;- tempfile(fileext=".csv")
print(fname) # tempfile used for output
print(redf, csv.out = TRUE, file = fname)
redftable &lt;- read.csv(fname)
unlink(fname) # remove the file
</code></pre>

<hr>
<h2 id='print.rwl.report'>Do some reporting on a RWL object</h2><span id='topic+print.rwl.report'></span>

<h3>Description</h3>

<p>This function prints the results of <code><a href="#topic+rwl.report">rwl.report</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rwl.report'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.rwl.report_+3A_x">x</code></td>
<td>
<p>a <code>list</code> from <code><a href="#topic+rwl.report">rwl.report</a></code></p>
</td></tr>
<tr><td><code id="print.rwl.report_+3A_...">...</code></td>
<td>
<p>not implemented</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function formats the <code>list</code> from <code><a href="#topic+rwl.report">rwl.report</a></code> for the 
user to have a summary report of the number of series, the mean length
of all the series, the first year, last year, the mean first-order 
autocorrelation (via <code><a href="#topic+summary.rwl">summary.rwl</a></code>), the mean interseries 
correlation (via <code><a href="#topic+interseries.cor">interseries.cor</a></code>), the years where a series has 
a missing ring (zero), internal NA, or a very small ring (&lt;0.005). 
</p>


<h3>Value</h3>

<p>Invisible
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+rwl.report">rwl.report</a></code>, <code><a href="#topic+summary.rwl">summary.rwl</a></code>,
<code><a href="#topic+interseries.cor">interseries.cor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("gp.rwl")
rwl.report(gp.rwl)
foo &lt;- gp.rwl
foo[177,1] &lt;- NA 
foo[177:180,3] &lt;- NA 
foo[185,4] &lt;- 0.001 
rwl.report(foo)
</code></pre>

<hr>
<h2 id='rasterPlot'>
Add Raster Elements to Plot
</h2><span id='topic+rasterPlot'></span>

<h3>Description</h3>

<p>This function takes plotting commands and uses a temporary
bitmap graphics device to capture their output.  The
resulting raster image is drawn in the plot or figure region of the
active high-level plot.  A new plot is started if one does not exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterPlot(expr, res = 150, region = c("plot", "figure"), antialias,
           bg = "transparent", interpolate = TRUE, draw = TRUE,
           Cairo = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rasterPlot_+3A_expr">expr</code></td>
<td>

<p>Low-level plotting commands (<code>lines</code>, <code>points</code>,
<code>text</code>, ...) representing elements to be added to the
current plot.  A <code><a href="base.html#topic+call">call</a></code> or an <code><a href="base.html#topic+expression">expression</a></code>.
</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_res">res</code></td>
<td>

<p>Resolution in points per inch (ppi).  A numeric value.  Suggested
values for different types of display media are given in
<code><a href="tools.html#topic+compactPDF">compactPDF</a></code>.  For example, the default 150 ppi
corresponds to &ldquo;ebook&rdquo; quality.
</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_region">region</code></td>
<td>

<p>The function can draw in the <code>"plot"</code> region or the
<code>"figure"</code> region which also includes <code>"mar"</code> margins (see
<code><a href="graphics.html#topic+par">par</a></code>).  If the drawing commands in <code><var>expr</var></code>
contain no material for the margins, the default <code>"plot"</code> is
optimal.  Plotting in the outer margins (<code>"oma"</code> in
<code><a href="graphics.html#topic+par">par</a></code>) is not supported.
</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_antialias">antialias</code></td>
<td>

<p>Antialiasing argument passed to <code><a href="grDevices.html#topic+png">png</a></code>.  The default
(missing argument) is probably good for line plots but
<code>"none"</code> is preferred for images in which color signifies value
of data.  Unused if a <code><a href="Cairo.html#topic+Cairo">Cairo</a></code> device is used instead of
<code>png</code>.
</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_bg">bg</code></td>
<td>

<p>Background color of the raster plot, an argument passed to
the bitmap device.  If the default <code>"transparent"</code> does not
work, try <code>"white"</code> or another color.  Note that a
non-transparent background will mask any previous content in the
figure or plot region, depending on the value of <code><var>region</var></code>.
</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_interpolate">interpolate</code></td>
<td>

<p>Argument passed to <code><a href="graphics.html#topic+rasterImage">rasterImage</a></code>.  A <code>logical</code>
flag.  The default is <code>TRUE</code>: use linear interpolation.
Analogously to <code><var>antialias</var></code>, <code>FALSE</code> is preferred
when color maps to value.
</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_draw">draw</code></td>
<td>

<p>A <code>logical</code> flag.  Draw the results (<code>TRUE</code>, the default)
or return an image object (<code>FALSE</code>)?
</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_cairo">Cairo</code></td>
<td>

<p>A <code>logical</code> flag.  <code>TRUE</code> for preferring a
<code><a href="Cairo.html#topic+Cairo">Cairo</a></code> to <code><a href="grDevices.html#topic+png">png</a></code> as the bitmap device,
<code>FALSE</code> (the default) for the opposite.  If the preferred
device cannot be used, the other one will be tried.
</p>
</td></tr>
<tr><td><code id="rasterPlot_+3A_...">...</code></td>
<td>

<p>Other arguments to <code><a href="grDevices.html#topic+png">png</a></code> or <code><a href="Cairo.html#topic+Cairo">Cairo</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The appropriate graphical parameters of the current graphics device
are copied to the temporary bitmap device.  Therefore the
appearance of the raster contents should be almost the same as when
directly drawn.
</p>
<p>The call or expression <code><var>expr</var></code> is evaluated in the
environment of the caller.
</p>
<p>It is possible that the raster contents will maintain a constant size
when the graphics device is resized.  If resizing works, however, the
image may become distorted.  For example, circle symbols will turn
into ellipses if the width to height ratio is not maintained (see
&lsquo;Examples&rsquo;).  This is in contrast to a standard plot in a
display graphics device, e.g. <code><a href="grDevices.html#topic+x11">x11</a></code>, where text and
symbols maintain their size when the device is resized.
</p>


<h3>Value</h3>

<p>If <code><var>draw</var></code> is <code>TRUE</code>, there is no return value.  The
function is used for the side effects.
</p>
<p>If <code><var>draw</var></code> is <code>FALSE</code>, an object of class
<code>"nativeRaster"</code> is returned.  The object can be used as input
for <code><a href="graphics.html#topic+rasterImage">rasterImage</a></code> or <code><a href="grid.html#topic+grid.raster">grid.raster</a></code>.  See
<code><a href="png.html#topic+readPNG">readPNG</a></code>.  If no bitmap device is available
(see &lsquo;Note&rsquo;), <code>NULL</code> is returned.
</p>


<h3>Note</h3>


<ul>
<li><p>The graphics device used for the output must have support for
including raster images.  See <code>"rasterImage"</code> in
<code><a href="grDevices.html#topic+dev.capabilities">dev.capabilities</a></code>.
</p>
</li>
<li><p>The <span class="rlang"><b>R</b></span> build must have a functional <code><a href="grDevices.html#topic+png">png</a></code> device,
which requires one of the following <code><a href="base.html#topic+capabilities">capabilities</a></code>:
<code>"png"</code>, <code>"aqua"</code> or <code>"cairo"</code>.  Alternatively, a
<code><a href="Cairo.html#topic+Cairo">Cairo</a></code> device from package Cairo must be
available with <code><a href="Cairo.html#topic+Cairo.capabilities">Cairo.capabilities</a></code>
<code>"raster"</code> or <code>"png"</code>.
</p>
</li></ul>

<p>If either of these requirements is not met, at least one
<code><a href="base.html#topic+message">message</a></code> is generated and the function reverts to regular
plotting.  The <code><var>bg</var></code> argument is then handled by drawing a
filled rectangle.  Also <code><var>region</var></code> is honored, but the other
settings do not apply.
</p>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(stats)

## Picture with various graphical elements
x &lt;- 1:100
y0 &lt;- quote(sin(pi * x / 20) + x / 100 + rnorm(100, 0, 0.2))
y &lt;- eval(y0)
ylab &lt;- deparse(y0)
spl &lt;- smooth.spline(y)
plot(x, y, type = "n", axes = FALSE, ylab = ylab)
usr &lt;- par("usr")
xrange &lt;- usr[2] - usr[1]
xsize &lt;- xrange * 0.4
nsteps &lt;- 8
xmar &lt;- xsize / 20
yrange &lt;- usr[4] - usr[3]
ysize &lt;- yrange / 20
ymar &lt;- 0.5 * ysize
X &lt;- seq(usr[1] + xmar, by = xsize / nsteps, length.out = nsteps + 1)
xleft &lt;- X[-(nsteps + 1)]
xright &lt;- X[-1]
pin &lt;- par("pin")
maxrad &lt;- xsize / 3 * min(1, pin[2] / pin[1])
nrad &lt;- 16
minrad &lt;- maxrad / nrad
Rad &lt;- seq(maxrad, by = (minrad - maxrad) / (nrad - 1), length.out=nrad)
xmar2 &lt;- xmar + maxrad
ymar2 &lt;- (xmar2 / xrange) * pin[1] / pin[2] * yrange
expr &lt;- quote({
    rect(xleft, usr[4] - 1.5 * ysize, xright, usr[4] - ymar,
         col = rainbow(8), border = NA)
    symbols(rep(usr[2] - xmar2, nrad), rep(usr[3] + ymar2, nrad),
            circles = Rad, inches = FALSE, add = TRUE, fg = NA,
            bg = gray.colors(nrad + 1, 1, 0)[-1])
    points(y)
    lines(spl)
})
rasterPlot(expr, res = 50)
box()
axis(1)
axis(2)

## The same picture with higher resolution but no antialiasing
plot(y, type = "n", axes = FALSE, ann = FALSE)
## No content in margin, but region = "figure" and bg = "white"
## paints margin white
rasterPlot(expr, antialias = "none", interpolate = FALSE,
           region = "figure", bg = "white")
## Draw box, axes, labels
parnew &lt;- par(new = TRUE)
plot(x, y, type = "n", ylab = ylab)
par(parnew)

## Draw plot(1:5) with adjusted margins and additional axes.  Some parts
## are drawn with rasterPlot, others normally.  Resize to see stretching.
op &lt;- par(no.readonly = TRUE)
par(mar = c(5.1, 4.1, 2.1, 2.1))
plot(1:5, type = "n", axes = FALSE, ann = FALSE)
expr2 &lt;- quote({
    points(c(2, 4), c(2, 4))
    axis(2)
    axis(3)
})
rasterPlot(expr2, region = "figure", bg = "white")
points(c(1, 3, 5), c(1, 3, 5))
box()
axis(1)
axis(4)
title(xlab = "Index", ylab = "1:5")
par(op)
</code></pre>

<hr>
<h2 id='rcs'> Regional Curve Standardization </h2><span id='topic+rcs'></span>

<h3>Description</h3>

  
<p>Detrend multiple ring-width series simultaneously using a regional
curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcs(rwl, po, nyrs = NULL, f = 0.5, biweight = TRUE, ratios = TRUE,
    rc.out = FALSE, make.plot = TRUE, ..., rc.in = NULL, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rcs_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> </p>
</td></tr>
<tr><td><code id="rcs_+3A_po">po</code></td>
<td>
<p> a <code>data.frame</code> containing two variables.  Variable one
(<code><var>series</var></code> in the example below) gives the series
<abbr><span class="acronym">ID</span></abbr> as either <code>character</code>s or <code>factor</code>s.  These
must exactly match <code>colnames(<var>rwl</var>)</code>.  Variable two
(<code><var>pith.offset</var></code> in the example below) must be integral
values and give the years from the beginning of the core to the pith
(or center) of the tree.  The minimum value is 1. </p>
</td></tr>
<tr><td><code id="rcs_+3A_nyrs">nyrs</code></td>
<td>
<p> a number giving the rigidity of the smoothing spline,
defaults to 0.1 of length of the maximum cambial age (i.e., the
length of the regional curve) if <code><var>nyrs</var></code> is <code>NULL</code>. </p>
</td></tr>
<tr><td><code id="rcs_+3A_f">f</code></td>
<td>
<p> a number between 0 and 1 giving the frequency response or
wavelength cutoff.  Defaults to 0.5. </p>
</td></tr>
<tr><td><code id="rcs_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>. </p>
</td></tr>
<tr><td><code id="rcs_+3A_ratios">ratios</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> (the default) then
indices are calculated by division, if <code>FALSE</code> indices are
calculated by subtraction. </p>
</td></tr>
<tr><td><code id="rcs_+3A_rc.out">rc.out</code></td>
<td>
 <p><code>logical</code> flag.  Returns the regional curve along
with the ring-width indices if <code>TRUE</code>. </p>
</td></tr>
<tr><td><code id="rcs_+3A_make.plot">make.plot</code></td>
<td>
 <p><code>logical</code> flag.  Makes plots of the raw data and
regional curve if <code>TRUE</code>. </p>
</td></tr>
<tr><td><code id="rcs_+3A_...">...</code></td>
<td>
<p> other arguments passed to
<code><a href="graphics.html#topic+plot">plot</a></code>. </p>
</td></tr>
<tr><td><code id="rcs_+3A_rc.in">rc.in</code></td>
<td>
<p> for internal use. </p>
</td></tr>
<tr><td><code id="rcs_+3A_check">check</code></td>
<td>
<p> a <code>logical</code> flag. Bypass input checks by setting
this to <code>FALSE</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method detrends and standardizes tree-ring series by calculating
an age-related growth curve specific to the <code><var>rwl</var></code>.  The
detrending is the estimation and removal of the tree‚Äôs natural
biological growth trend.  The standardization is done by either
dividing each series by the growth trend or subtracting the growth
trend from each series to produce units in the dimensionless
ring-width index (<abbr><span class="acronym">RWI</span></abbr>).  The option to produce indices by
subtraction is intended to be used on series that have been subject to
variance stabilization (e.g., using <code><a href="#topic+powt">powt</a></code>).
</p>
<p>The spline approach uses an n-year spline where the frequency response
is 0.50 at a wavelength of 10 percent of the maximum cambial age
unless specified differently using <code><var>nyrs</var></code> and
<code><var>f</var></code> in the function <code><a href="#topic+caps">caps</a></code>.
</p>
<p>This attempts to remove the low frequency variability that is due to
biological or stand effects.  See the references below for further
details on detrending in general, and Biondi and Qeadan (2008) for an
explanation of <abbr><span class="acronym">RCS</span></abbr>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the dimensionless and detrended
ring-width indices with column names, row names and dimensions of
<code><var>rwl</var></code>.  If <code><var>rc.out</var></code> is <code>TRUE</code> then a
<code>list</code> will be returned with a <code>data.frame</code> containing the
detrended ring widths as above and a <code>vector</code> containing the
regional curve.
</p>


<h3>Note</h3>

<p> DendroLab website: <a href="https://dendrolaborg.wordpress.com/">https://dendrolaborg.wordpress.com/</a> </p>


<h3>Author(s)</h3>

<p>Code provided by DendroLab based on programming by F. Qeadan and
F. Biondi, University of Nevada Reno, <abbr><span class="acronym">USA</span></abbr> and adapted for
dplR by Andy Bunn.  Patched and improved by Mikko Korpela.
</p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) A theory-driven approach to tree-ring
standardization: Defining the biological trend from expected basal area
increment.  <em>Tree-Ring Research</em>, <b>64</b>(2), 81‚Äì96.
</p>
<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Fritts, H. C. (2001) <em>Tree Rings and Climate</em>.
Blackburn.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-1-930665-39-2.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+detrend">detrend</a></code>, <code><a href="#topic+chron">chron</a></code>, <code><a href="#topic+cms">cms</a></code>,
<code><a href="#topic+caps">caps</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(gp.rwl)
data(gp.po)
gp.rwi &lt;- rcs(rwl = gp.rwl, po = gp.po, biweight = TRUE,
              rc.out = TRUE, make.plot = FALSE)
str(gp.rwi)
gp.rwi &lt;- rcs(rwl = gp.rwl, po = gp.po, biweight = TRUE,
              make.plot = TRUE, main = "Regional Curve")
</code></pre>

<hr>
<h2 id='read.compact'> Read <abbr><span class="acronym">DPL</span></abbr> Compact Format Ring Width File </h2><span id='topic+read.compact'></span>

<h3>Description</h3>

  
<p>This function reads in a <abbr><span class="acronym">DPL</span></abbr> compact format file of ring
widths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.compact(fname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.compact_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
rwl file. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should be able to read files written by the
Dendrochronology Program Library (<abbr><span class="acronym">DPL</span></abbr>) in its compact
format.
</p>


<h3>Value</h3>

<p>An object of class <code>c("rwl", "data.frame")</code> with the series in
columns and the years as rows.  The series <abbr><span class="acronym">ID</span></abbr>s are the
column names and the years are the row names.
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela </p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code>, <code><a href="#topic+read.tucson">read.tucson</a></code>,
<code><a href="#topic+read.tridas">read.tridas</a></code>, <code><a href="#topic+read.fh">read.fh</a></code>,
<code><a href="#topic+write.compact">write.compact</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(co021)
fname &lt;- write.compact(rwl.df = co021,
                       fname = tempfile(fileext=".rwl"),
                       append = FALSE, prec = 0.001)
foo &lt;- read.compact(fname)
str(foo)
str(co021)
all.equal(foo,co021)
unlink(fname)

## End(Not run)
</code></pre>

<hr>
<h2 id='read.crn'> Read Tucson Format Chronology File </h2><span id='topic+read.crn'></span>

<h3>Description</h3>

<p>This function reads in a Tucson (decadal) format file of tree-ring
chronologies (.crn).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.crn(fname, header = NULL, encoding = getOption("encoding"),
         long = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.crn_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
crn file. </p>
</td></tr>
<tr><td><code id="read.crn_+3A_header">header</code></td>
<td>
 <p><code>logical</code> flag indicating whether the file has a
header.  If <code>NULL</code> then the function will attempt to determine
if a header exists </p>
</td></tr>
<tr><td><code id="read.crn_+3A_encoding">encoding</code></td>
<td>
<p>the name of the encoding to be used when reading the
crn file.  Usually the default value will work, but a crn file
written in a non-default encoding may crash the function.  In that
case, identifying the encoding and specifying it here should fix the
problem.  Examples of popular encodings available on many systems
are <code>"ASCII"</code>, <code>"UTF-8"</code>, and <code>"latin1"</code> alias
<code>"ISO-8859-1"</code>.  See the help of <code><a href="base.html#topic+file">file</a></code>.</p>
</td></tr>
<tr><td><code id="read.crn_+3A_long">long</code></td>
<td>
 <p><code>logical</code> flag indicating whether to automatically
detect when an input file uses more than 4 characters for the decade.
If <code>FALSE</code>, the function assumes 6 characters are used for the
site <abbr><span class="acronym">ID</span></abbr> and 4 characters for the decade, which is the
standard. If <code>TRUE</code> (the default), long records may work. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This reads in a standard crn file as defined according to the
standards of the <abbr><span class="acronym">ITRDB</span></abbr> at
<a href="https://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt">https://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt</a>.  Despite the
standards at the <abbr><span class="acronym">ITRDB</span></abbr>, this occasionally fails due to
formatting problems.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with each chronology in columns and the years as
rows.  The chronology <abbr><span class="acronym">ID</span></abbr>s are the column names and the years
are the row names.  If the file includes sample depth that is included
as the last column (<code><var>samp.depth</var></code>).  The output class is
class &quot;crn&quot; and &quot;data.frame&quot;
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>

<hr>
<h2 id='read.fh'> Read Heidelberg Format Ring Width File </h2><span id='topic+read.fh'></span>

<h3>Description</h3>

<p>This function reads in a Heidelberg (block or column) format file of
ring widths (.fh).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.fh(fname, BC_correction = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.fh_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the fh
file. </p>
</td></tr>
<tr><td><code id="read.fh_+3A_bc_correction">BC_correction</code></td>
<td>
<p> a <code>logical</code>. If TRUE the correction moves BC-dates one year forward. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This reads in a fh-file with ring widths in blocks (decadal format) or
in columns (e.g., as with comment flags) as used by TSAP program.
Chronologies or half-chronos in fh-format are not supported.
</p>


<h3>Value</h3>

<p>An object of class <code>c("rwl", "data.frame")</code> with the series in
columns and the years as rows.  The keycodes are the column names and
the years are the row names.  Depending on metadata available in the
input file, the following attributes may be present in the
<code>data.frame</code>:
</p>
<table role = "presentation">
<tr><td><code>ids</code></td>
<td>
<p>A <code>data.frame</code> identifying the series.  Always contains
columns <code>"tree"</code> and <code>"core"</code>, may contain columns
<code>"site"</code>, <code>"radius"</code>, and <code>"stemDisk"</code>.  All
columns are <code>numeric</code>.</p>
</td></tr>
<tr><td><code>po</code></td>
<td>
<p>A <code>data.frame</code> containing pith offsets, formatted for
use in <code><a href="#topic+rcs">rcs</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Christian Zang.  New features and patches by Mikko Korpela and Ronald Visser. </p>


<h3>References</h3>

<p> Rinn, F. (2003) <em>TSAP-Win User Reference Manual.</em>
Rinntech, Heidelberg.  <a href="https://rinntech.info/products/tsap-win/">https://rinntech.info/products/tsap-win/</a>.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code> </p>

<hr>
<h2 id='read.ids'> Read Site-Tree-Core <abbr><span class="acronym">ID</span></abbr>s </h2><span id='topic+read.ids'></span><span id='topic+autoread.ids'></span>

<h3>Description</h3>

<p>These functions try to read site, tree, and core <abbr><span class="acronym">ID</span></abbr>s from a
rwl <code>data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.ids(rwl, stc = c(3, 2, 3), ignore.site.case = FALSE,
         ignore.case = FALSE, fix.typos = FALSE, typo.ratio = 5,
         use.cor = TRUE)

autoread.ids(rwl, ignore.site.case = TRUE, ignore.case = "auto",
             fix.typos = TRUE, typo.ratio = 5, use.cor = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.ids_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> or
<code><a href="#topic+ca533">ca533</a></code> </p>
</td></tr>
<tr><td><code id="read.ids_+3A_stc">stc</code></td>
<td>
<p> a vector of three integral values or character string
&quot;auto&quot;.  The numbers indicate the number of characters to split the
site code (<code><var>stc</var>[1]</code>), the tree <abbr><span class="acronym">ID</span></abbr>s
(<code><var>stc</var>[2]</code>), and the core <abbr><span class="acronym">ID</span></abbr>s
(<code><var>stc</var>[3]</code>).  Defaults to <code>c(3, 2, 3)</code>.  If &quot;auto&quot;,
tries to automatically determine the split locations.  See Details
for further information. </p>
</td></tr>
<tr><td><code id="read.ids_+3A_use.cor">use.cor</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code> and
<code><var>stc</var> is "auto"</code>, correlation clustering may be used for
determining the length of the tree and core parts.  See Details. </p>
</td></tr>
</table>
<p>The following parameters affect the handling of suspected typing
errors.  Some have different default values in <code>read.ids</code> and
<code>autoread.ids</code>.
</p>
<table role = "presentation">
<tr><td><code id="read.ids_+3A_ignore.site.case">ignore.site.case</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>, the
function does not distinguish between upper case and lower case
letters in the site part of the series names. </p>
</td></tr>
<tr><td><code id="read.ids_+3A_ignore.case">ignore.case</code></td>
<td>
<p> a <code>logical</code> flag or &quot;auto&quot;.  If <code>TRUE</code>,
the function does not distinguish between upper case and lower case
letters in the tree / core part of the series names.  The default in
<code>read.ids</code> is <code>FALSE</code>, i.e. the difference matters.  The
default in <code>read.ids</code> is <code>"auto"</code>, which means that the
function tries to be smart with respect to case sensitivity.  In
<code>"auto"</code> mode, the function generally ignores case differences,
unless doing so would result in additional duplicate combinations of
tree and core <abbr><span class="acronym">ID</span></abbr>s.  Also, when in <code>"auto"</code> mode and
<code><var>stc</var></code> is <code>"auto"</code>, case sensitivity is used in
highly heuristic ways when deciding the boundary between the site
part and the tree part in uncertain cases. </p>
</td></tr>
<tr><td><code id="read.ids_+3A_fix.typos">fix.typos</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>, the function
will try to detect and fix typing errors. </p>
</td></tr>
<tr><td><code id="read.ids_+3A_typo.ratio">typo.ratio</code></td>
<td>
<p> a <code>numeric</code> value larger than <code>1</code>,
affecting the eagerness of the function to fix typing errors.  The
default is 5.  See Details. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because dendrochronologists often take more than one core per tree, it
is occasionally useful to calculate within vs. between tree variance.
The International Tree Ring Data Bank (<abbr><span class="acronym">ITRDB</span></abbr>) allows the
first eight characters in an rwl file for series <abbr><span class="acronym">ID</span></abbr>s but
these are often shorter.  Typically the creators of rwl files use a
logical labeling method that can allow the user to determine the tree
and core <abbr><span class="acronym">ID</span></abbr> from the label.
</p>
<p>Argument <code><var>stc</var></code> tells how each series separate into site,
tree, and core <abbr><span class="acronym">ID</span></abbr>s.  For instance a series code might be
<code>"ABC011"</code> indicating site <code>"ABC"</code>, tree 1, core 1.  If this
format is consistent then the <code><var>stc</var></code> mask would be
<code>c(3, 2, 3)</code> allowing up to three characters for the core
<abbr><span class="acronym">ID</span></abbr> (i.e., pad to the right).  If it is not possible to
define the scheme (and often it is not possible to machine read
<abbr><span class="acronym">ID</span></abbr>s), then the output <code>data.frame</code> can be built
manually.  See Value for format.
</p>
<p>The function <code>autoread.ids</code> is a wrapper to <code>read.ids</code> with
<code>stc="auto"</code>, i.e. automatic detection of the site / tree / core
scheme, and different default values of some parameters.  In automatic
mode, the names in the same <code><var>rwl</var></code> can even follow different
site / tree / core schemes.  As there are numerous possible encoding
schemes for naming measurement series, the function cannot always
produce the correct result.
</p>
<p>With <code>stc="auto"</code>, the site part can be one of the following.
</p>

<ul>
<li><p> In names mostly consisting of numbers, the longest common
prefix is the site part
</p>
</li>
<li><p> Alphanumeric site part ending with alphabet, when followed by
numbers and alphabets
</p>
</li>
<li><p> Alphabetic site part (quite complicated actual
definition).  Setting <code><var>ignore.case</var></code> to <code>"auto"</code>
allows the function to try to guess when a case change in the middle
of a sequence of alphabets signifies a boundary between the site
part and the tree part.
</p>
</li>
<li><p> The characters before the first sequence of space /
punctuation characters in a name that contains at least two such
sequences </p>
</li></ul>
<p> These descriptions are somewhat general, and the details
can be found in regular expressions inside the function.  If a name
does not match any of the descriptions, it is matched against a
previously found site part, starting from the longest.
</p>
<p>The following <abbr><span class="acronym">ID</span></abbr> schemes are detected and supported in the
tree / core part.  The detection is done per site. </p>

<ul>
<li><p> Numbers in tree part, core part starts with something else
</p>
</li>
<li><p> Alphabets in tree part, core part starts with something else
</p>
</li>
<li><p> Alphabets, either tree part all lower case and core part all
upper case or vice versa.  For this to work,
<code><var>ignore.case</var></code> must be set to <code>"auto"</code> or
<code>FALSE</code>.
</p>
</li>
<li><p> All digits.  In this case, the number of characters belonging
to the tree and core parts is detected with one of the following
methods. </p>

<ul>
<li><p> If numeric tree parts were found before, it is assumed that
the core part is missing (one core per tree).
</p>
</li>
<li><p> It the series are numbered continuously, one core per tree
is assumed.
</p>
</li>
<li><p> Otherwise, try to find a core part as the suffix so that the
cores are numbered continuously.
</p>
</li></ul>
<p> If none of the above fits, the tree / core split of the all-digit
names will be decided with the methods described further down the
list, or finally with the fallback mechanism.
</p>
</li>
<li><p> The combined tree / core part is empty or one character.
In this case, the core part is assumed to be missing.
</p>
</li>
<li><p> Tree and core parts separated by a punctuation or white space
character
</p>
</li></ul>
<p> If the split of a tree / core part cannot be found with any of the
methods described above, the prefix of the string is matched against a
previously found tree part, starting from the longest.  The fallback
mechanism for the still undecided tree / core parts is one of the
following.  The first one is used if <code><var>use.cor</var></code> is
<code>TRUE</code>, number two if it is <code>FALSE</code>.
</p>

<ol>
<li><p> Pairwise correlation coefficients are computed between all
remaining series.  Pairs of series with above median correlation
are flagged as similar, and the other pairs are flagged as
dissimilar.  Each possible number of characters (minimum 1) is
considered for the share of the tree <abbr><span class="acronym">ID</span></abbr>.  The
corresponding unique would-be tree <abbr><span class="acronym">ID</span></abbr>s determine a set of
clusterings where one cluster is formed by all the measurement
series of a single tree.  For each clustering (allocation of
characters), an agreement score is computed.  The agreement score is
defined as the sum of the number of similar pairs with matching
cluster number and the number of dissimilar pairs with non-matching
cluster number.  The number of characters with the maximum agreement
is chosen.
</p>
</li>
<li><p> If the majority of the names in the site use <var>k</var>
characters for the tree part, that number is chosen.  Otherwise, one
core per tree is assumed.  Parameter <code><var>typo.ratio</var></code> has a
double meaning as it also defines what is meant by majority here: at
least <code><var>typo.ratio</var> / (<var>typo.ratio</var> + 1) *
    <var>n.tot</var></code>, where <var>n.tot</var> is the number of names in the site.
</p>
</li></ol>
<p> In both fallback mechanisms, the number of characters allocated for
the tree part will be increased until all trees have a non-zero
<abbr><span class="acronym">ID</span></abbr> or there are no more characters.
</p>
<p>Suspected typing errors will be fixed by the function if
<code><var>fix.typos</var></code> is <code>TRUE</code>.  The parameter
<code><var>typo.ratio</var></code> affects the eagerness to fix typos, i.e. the
number of counterexamples required to declare a typo.  The following
main typo fixing mechanisms are implemented: </p>

<dl>
<dt> Site <abbr><span class="acronym">ID</span></abbr>s. </dt><dd><p> If a rare site string resembles an at
least <code><var>typo.ratio</var></code> times more frequent alternative, and
if fixing it would not create any name collisions, make the fix.
The alternative string must be unique, or if there is more than
one alternative, it is enough if only one of them is a look-alike
string.  Any kind of substitution in one character place is
allowed if the alternative string has the same length as the
original string.  The alternative string can be one character
longer or one character shorter than the original string, but only
if it involves interpreting one digit as the look-alike alphabet
or vice versa.  There are requirements to how long a site string
must be in order to be eligible for replacement / typo fixing,
i.e. cannot be shortened to zero length, cannot change the only
character of a site string.  The parameters
<code><var>ignore.case</var></code> and <code><var>ignore.site.case</var></code> have
some effect on this typo fixing mechanism. </p>
</dd>
<dt> Tree and core <abbr><span class="acronym">ID</span></abbr>s. </dt><dd><p> If all tree / core parts of a
site have the same length, each character position is inspected
individually.  If the characters in the <var>i</var>:th position are
predominantly digits (alphabets), any alphabets (digits) are
changed to the corresponding look-alike digit (alphabet) if there
is one.  The look-alike groups are {0, O, o}, {1, I, i}, {5,
S, s} and {6, G}.  The parameter <code><var>typo.ratio</var></code>
determines the decision threshold of interpreting the type of each
character position as alphabet (digit): the ratio of alphabets
(digits) to the total number of characters must be at least
<code><var>typo.ratio</var> / (<var>typo.ratio</var> + 1)</code>.  If a name
differs from the majority type in more than one character
position, it is not fixed.  Also, no fixes are performed if any of
them would cause a possible monotonic order of numeric prefixes to
break. </p>
</dd>
</dl>

<p>The function attempts to convert the tree and core substrings to
integral values.  When this succeeds, the converted values are copied
to the output without modification.  When non-integral substrings are
observed, each unique tree is assigned a unique integral value.  The
same applies to cores within a tree, but there are some subtleties
with respect to the handling of duplicates.  Substrings are sorted
before assigning the <code>numeric</code> <abbr><span class="acronym">ID</span></abbr>s.
</p>
<p>The order of columns in <code><var>rwl</var></code>, in most cases, does not
affect the tree and core <abbr><span class="acronym">ID</span></abbr>s assigned to each series.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with column one named <code>"tree"</code> giving an
<abbr><span class="acronym">ID</span></abbr> for each tree and column two named <code>"core"</code> giving
an <abbr><span class="acronym">ID</span></abbr> for each core.  The original series <abbr><span class="acronym">ID</span></abbr>s are
copied from rwl as rownames.  The order of the rows in the output
matches the order of the series in <code><var>rwl</var></code>.  If more than one
site is detected, an additional third column named <code>"site"</code> will
contain a site <abbr><span class="acronym">ID</span></abbr>.  All columns have integral valued
<code>numeric</code> values.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn (original version) and Mikko Korpela (patches,
<code><var>stc</var>="auto"</code>, <code><var>fix.typos</var></code>, etc.). </p>


<h3>See Also</h3>

 <p><code><a href="#topic+rwi.stats">rwi.stats</a></code>, <code><a href="#topic+read.rwl">read.rwl</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
read.ids(ca533, stc = c(3, 2, 3))
autoread.ids(ca533)
</code></pre>

<hr>
<h2 id='read.rwl'> Read Ring Width File </h2><span id='topic+read.rwl'></span>

<h3>Description</h3>

<p>This function reads in a file of ring widths (.rwl) in one of the
available formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.rwl(fname,
         format = c("auto", "tucson", "compact", "tridas", "heidelberg", "csv"),
         ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.rwl_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
rwl file. </p>
</td></tr>
<tr><td><code id="read.rwl_+3A_format">format</code></td>
<td>
<p> a <code>character</code> vector giving the format.  This must
be <code>"auto"</code> (rough automatic detection), <code>"tucson"</code>,
<code>"compact"</code>, <code>"tridas"</code>, <code>"heidelberg"</code> or <code>"csv"</code>.  Automatic
format detection is the default but failable. </p>
</td></tr>
<tr><td><code id="read.rwl_+3A_...">...</code></td>
<td>
<p> arguments specific to the function implementing the
operation for the chosen format. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple wrapper to the functions actually implementing the
read operation.
</p>


<h3>Value</h3>

<p>If a <code>"tucson"</code>, <code>"compact"</code>, <code>"heidelberg"</code>, <code>"csv"</code> file is
read (even through <code>"auto"</code>), returns an object of class
<code>c("rwl", "data.frame")</code> with the series in columns and the years
as rows.  The series <abbr><span class="acronym">ID</span></abbr>s are the column names and the years
are the row names.
</p>
<p>If a <code>"tridas"</code> file is read (even through <code>"auto"</code>),
returns a list of results.  See <code><a href="#topic+read.tridas">read.tridas</a></code> for more
information.
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela </p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.tucson">read.tucson</a></code>, <code><a href="#topic+read.compact">read.compact</a></code>,
<code><a href="#topic+read.tridas">read.tridas</a></code>, <code><a href="#topic+read.fh">read.fh</a></code>, <code><a href="#topic+csv2rwl">csv2rwl</a></code>, 
<code><a href="#topic+write.rwl">write.rwl</a></code> </p>

<hr>
<h2 id='read.tridas'> Read Tree Ring Data Standard (TRiDaS) File </h2><span id='topic+read.tridas'></span>

<h3>Description</h3>

<p> This function reads in a TRiDaS format <abbr><span class="acronym">XML</span></abbr> file.
Measurements, derived series and various kinds of metadata are
supported. </p>


<h3>Usage</h3>

<pre><code class='language-R'>read.tridas(fname, ids.from.titles = FALSE,
            ids.from.identifiers = TRUE, combine.series = TRUE,
            trim.whitespace = TRUE, warn.units = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.tridas_+3A_fname">fname</code></td>
<td>
 <p><code>character</code> vector giving the file name of the
TRiDaS file. </p>
</td></tr>
<tr><td><code id="read.tridas_+3A_ids.from.titles">ids.from.titles</code></td>
<td>
 <p><code>logical</code> flag indicating whether to
override the (tree, core, radius, measurement) structure imposed by
the element hierarchy (element, sample, radius, measurementSeries)
of the file.  If <code>TRUE</code>, measurement series will be rearranged
by matching titles in the file at the aforementioned four levels of
the hierarchy.  Defaults to <code>FALSE</code>, i.e. the element hierarchy
of the file will be used. </p>
</td></tr>
<tr><td><code id="read.tridas_+3A_ids.from.identifiers">ids.from.identifiers</code></td>
<td>
 <p><code>logical</code> flag indicating whether to
(partially) override the element hierarchy of the file.  If
<code>TRUE</code>, measurement series will be grouped according to
matching identifiers at the measurementSeries level, where
identifiers are available.  The changes caused by this option are
applied on top of the structure imposed by the file or computed from
matching titles if <code><var>ids.from.titles</var> == TRUE</code>.  Defaults
to <code>TRUE</code>. </p>
</td></tr>
<tr><td><code id="read.tridas_+3A_combine.series">combine.series</code></td>
<td>
 <p><code>logical</code> flag indicating whether to
combine two or more measurement series with the same set of (tree,
core, radius, measurement) <abbr><span class="acronym">ID</span></abbr> numbers.  Each set of
combined measurement series will be represented by one column of a
resulting <code>data.frame</code>.  Overlapping years of combined series do not
produce a warning.  If several data points are available for a given
year, the function chooses one in a rather arbitrary manner.  This
option can only have effect when <code><var>ids.from.titles</var> ||
      <var>ids.from.identifiers</var></code>. </p>
</td></tr>
<tr><td><code id="read.tridas_+3A_trim.whitespace">trim.whitespace</code></td>
<td>
 <p><code>logical</code> flag indicating whether to
replace repeated white spaces in the text content of the file with
only one space.  Defaults to <code>TRUE</code>, i.e. excess white space
will be trimmed from the text. </p>
</td></tr>
<tr><td><code id="read.tridas_+3A_warn.units">warn.units</code></td>
<td>
 <p><code>logical</code> flag indicating whether to warn
about unitless measurements and &ldquo;strange&rdquo; units.  The
function expects measurements in units that can be converted to
millimetres.  Defaults to <code>TRUE</code>: warnings will be given.  For
example, density measurements will trigger warnings, which can be
disabled by setting this option to <code>FALSE</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Tree Ring Data Standard (TRiDaS) is described in Jansma et. al
(2010).  
</p>
<p>The parameters used for rearranging (<code><var>ids.from.titles</var></code>,
<code><var>ids.from.identifiers</var></code>) and combining
(<code><var>combine.series</var></code>) measurement series only affect the four
lowest levels of document structure: element, sample, radius,
measurementSeries.  Series are not reorganized or combined at the
upper structural levels (project, object).
</p>


<h3>Value</h3>

<p>A list with a variable number of components according to the contents
of the input file.  The possible list components are:
</p>
<table role = "presentation">
<tr><td><code>measurements</code></td>
<td>
<p>A <code>data.frame</code> or a list of <code>data.frame</code>s with
the series in columns and the years as rows.  Contains measurements
(&lsquo;<span class="samp">&#8288;&lt;measurementSeries&gt;&#8288;</span>&rsquo;) with known years.  The series
<abbr><span class="acronym">ID</span></abbr>s are the column names and the years are the row
names.  The series <abbr><span class="acronym">ID</span></abbr>s are derived from &lsquo;<span class="samp">&#8288;&lt;title&gt;&#8288;</span>&rsquo;
elements in the input file.  Each unique combination of
&lsquo;<span class="samp">&#8288;&lt;project&gt;&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;&lt;unit&gt;&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;&lt;taxon&gt;&#8288;</span>&rsquo;,
and &lsquo;<span class="samp">&#8288;&lt;variable&gt;&#8288;</span>&rsquo; gets a separate <code>data.frame</code>. </p>
</td></tr>
<tr><td><code>ids</code></td>
<td>
<p>A <code>data.frame</code> or a list of <code>data.frame</code>s with columns
named <code>"tree"</code>, <code>"core"</code>, <code>"radius"</code>, and
<code>"measurement"</code>, together giving a unique <code>numeric</code> <abbr><span class="acronym">ID</span></abbr>
for each column of the <code>data.frame</code>(s) in
<code><var>measurements</var></code>.
</p>
<p>If <code>!<var>combine.series</var> &amp;&amp; (<var>ids.from.titles</var> || <var>ids.from.identifiers</var>)</code>, some rows may be non-unique. </p>
</td></tr>
<tr><td><code>titles</code></td>
<td>
<p>A <code>data.frame</code> or a list of <code>data.frame</code>s with
columns named <code>"tree"</code>, <code>"core"</code>, <code>"radius"</code>, and
<code>"measurement"</code>, containing the &lsquo;<span class="samp">&#8288;&lt;title&gt;&#8288;</span>&rsquo; hierarchy of
each column of the <code>data.frame</code>(s) in <code><var>measurements</var></code>. </p>
</td></tr>
<tr><td><code>wood.completeness</code></td>
<td>
<p>A <code>data.frame</code> or a list of <code>data.frame</code>s
containing wood completeness information.  Column names are a subset
of the following, almost self-explanatory set:
<code>"pith.presence"</code>, <code>"heartwood.presence"</code>,
<code>"sapwood.presence"</code>,<br />
<code>"last.ring.presence"</code>, <code>"last.ring.details"</code>,
<code>"bark.presence"</code>,<br />
<code>"n.sapwood"</code>, <code>"n.missing.heartwood"</code>,
<code>"n.missing.sapwood"</code>,<br />
<code>"missing.heartwood.foundation"</code>,
<code>"missing.sapwood.foundation"</code>,<br />
<code>"n.unmeasured.inner"</code>, <code>"n.unmeasured.outer"</code>. </p>
</td></tr>
<tr><td><code>unit</code></td>
<td>
<p>A <code>character</code> vector giving the unit of the
measurements.  Length equals the number of <code>data.frame</code>s in
<code><var>measurements</var></code>. </p>
</td></tr>
<tr><td><code>project.id</code></td>
<td>
<p>A <code>numeric</code> vector giving the project
<abbr><span class="acronym">ID</span></abbr>, i.e. the position of the corresponding
&lsquo;<span class="samp">&#8288;&lt;project&gt;&#8288;</span>&rsquo; element), of the measurements in each
<code>data.frame</code> in <code><var>measurements</var></code>.  Length equals the
number of <code>data.frame</code>s. </p>
</td></tr>
<tr><td><code>project.title</code></td>
<td>
<p>A <code>character</code> vector giving the title of the
project of each <code>data.frame</code> in <code><var>measurements</var></code>.
Length equals the number of <code>data.frame</code>s. </p>
</td></tr>
<tr><td><code>site.id</code></td>
<td>
<p>A <code>data.frame</code> giving the site <abbr><span class="acronym">ID</span></abbr>
(position of &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; element(s) within a &lsquo;<span class="samp">&#8288;&lt;project&gt;&#8288;</span>&rsquo;)
of each <code>data.frame</code> in <code><var>measurements</var></code>.  May have
several columns to reflect the possibly nested &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo;
elements. </p>
</td></tr>
<tr><td><code>site.title</code></td>
<td>
<p>A <code>data.frame</code> giving the site
(&lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo;) title of each <code>data.frame</code> in
<code><var>measurements</var></code>.  May have several columns to reflect the
possibly nested &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; elements. </p>
</td></tr>
<tr><td><code>taxon</code></td>
<td>
<p>A <code>data.frame</code> showing the taxonomic name for each
<code>data.frame</code> in <code><var>measurements</var></code>.  Contains some of
the following columns: <code>"text"</code>, <code>"lang"</code>,
<code>"normal"</code>, <code>"normalId"</code>, <code>"normalStd"</code>.  The first
two are a free-form name and its language, and the rest are related
to a normalized name. </p>
</td></tr>
<tr><td><code>variable</code></td>
<td>
<p>A <code>data.frame</code> showing the measured variable of
each <code>data.frame</code> in <code><var>measurements</var></code>.  Contains some
of the following columns: <code>"text"</code>, <code>"lang"</code>,
<code>"normal"</code>, <code>"normalId"</code>, <code>"normalStd"</code>,
<code>"normalTridas"</code>.  The first two are a free-form name and its
language, and the rest are related to a normalized name. </p>
</td></tr>
<tr><td><code>undated</code></td>
<td>
<p>A <code>list</code> of measurements with unknown years,
together with metadata.  Elements are a subset of the following:
</p>

<dl>
<dt>data</dt><dd><p>A <code>numeric</code> vector or a list of such vectors
containing measurement series </p>
</dd>
<dt>unit</dt><dd><p>A <code>character</code> vector giving the unit of the
measurements.  Length equals the number of measurement series in
<code><var>undated</var>$<var>data</var></code> </p>
</dd>
<dt>ids</dt><dd><p>A <code>data.frame</code> with columns named <code>"tree"</code>,
<code>"core"</code>, <code>"radius"</code>, and <code>"measurement"</code>,
together giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr> for each measurement
series in <code><var>undated</var>$<var>data</var></code>.  The rows are
guaranteed to be unique only when comparing measurement series
with the same <code><var>project.id</var></code> and <code><var>site.id</var></code>,
but not if <code><var>ids.from.titles</var> ||
          <var>ids.from.identifiers</var></code>. </p>
</dd>
<dt>titles</dt><dd><p>A <code>data.frame</code> with columns named
<code>"tree"</code>, <code>"core"</code>, <code>"radius"</code>, and
<code>"measurement"</code>, containing the &lsquo;<span class="samp">&#8288;&lt;title&gt;&#8288;</span>&rsquo; hierarchy of
each measurement series in <code><var>undated</var>$<var>data</var></code> </p>
</dd>
<dt>project.id</dt><dd><p>A <code>numeric</code> vector giving the project
<abbr><span class="acronym">ID</span></abbr> of each measurement series in
<code><var>undated</var>$<var>data</var></code> </p>
</dd>
<dt>project.title</dt><dd><p>A <code>character</code> vector giving the project
title of each measurement series in
<code><var>undated</var>$<var>data</var></code> </p>
</dd>
<dt>site.id</dt><dd><p>A <code>data.frame</code> giving the site <abbr><span class="acronym">ID</span></abbr> of
each measurement series in <code><var>undated</var>$<var>data</var></code> </p>
</dd>
<dt>site.title</dt><dd><p>A <code>data.frame</code> giving the site title of
each measurement series in <code><var>undated</var>$<var>data</var></code> </p>
</dd>
<dt>variable</dt><dd><p>A <code>data.frame</code> containing the variable of
each measurement series in <code><var>undated</var>$<var>data</var></code> </p>
</dd>
<dt>taxon</dt><dd><p>A <code>data.frame</code> containing taxonomic names of
each measurement series in <code><var>undated</var>$<var>data</var></code> </p>
</dd>
<dt>wood.completeness</dt><dd><p>A <code>data.frame</code> containing wood
completeness information of each measurement series in
<code><var>undated</var>$<var>data</var></code> </p>
</dd>
</dl>

</td></tr>
<tr><td><code>derived</code></td>
<td>
<p>A <code>list</code> of calculated series of values, together
with metadata.  Elements are a subset of the following:
</p>

<dl>
<dt>data</dt><dd><p>A <code>numeric</code> vector or a list of such vectors
containing calculated series of values.</p>
</dd>
<dt>link</dt><dd><p>A <code>list</code> of <code>data.frame</code>s, one for each
series in <code><var>derived</var>$<var>data</var></code>, giving links to the
measurements used to form the corresponding derived series.
Each <code>data.frame</code> has a subset of the following columns:
<code>"idRef"</code> (reference to a series in the same file),
<code>"xLink"</code> (<abbr><span class="acronym">URI</span></abbr>), <code>"identifier"</code>, and
<code>"domain"</code> (identifier and its domain, not necessarily in
the same file).</p>
</dd>
<dt>project.id</dt><dd><p>A <code>numeric</code> vector giving the project
<abbr><span class="acronym">ID</span></abbr> of each derived series in
<code><var>derived</var>$<var>data</var></code></p>
</dd>
<dt>id</dt><dd><p>A <code>numeric</code> vector giving the <abbr><span class="acronym">ID</span></abbr> (order
of appearance in the project) of each derived series in
<code><var>derived</var>$<var>data</var></code></p>
</dd>
<dt>title</dt><dd><p>A <code>character</code> vector giving the title of each
derived series in <code><var>derived</var>$<var>data</var></code></p>
</dd>
<dt>project.title</dt><dd><p>A <code>character</code> vector giving the project
title of each derived series in <code><var>derived</var>$<var>data</var></code></p>
</dd>
<dt>unit</dt><dd><p>A <code>character</code> vector giving the unit of the
derived series.  Length equals the number of series in
<code><var>derived</var>$<var>data</var></code>.</p>
</dd>
<dt>standardizing.method</dt><dd><p>A <code>character</code> vector giving the
standardizing method of the derived series.  Length equals the
number of series in <code><var>derived</var>$<var>data</var></code>.</p>
</dd>
<dt>variable</dt><dd><p>A <code>data.frame</code> containing the variable of
each series in <code><var>derived</var>$<var>data</var></code></p>
</dd>
</dl>

</td></tr>
<tr><td><code>type</code></td>
<td>
<p>A <code>data.frame</code> containing the type of various
entities, and metadata related to each &lsquo;<span class="samp">&#8288;type&#8288;</span>&rsquo; element.
Contents are <code>NA</code> where the metadata is not applicable (e.g.,
no <code><var>tree.id</var></code> when the &lsquo;<span class="samp">&#8288;type&#8288;</span>&rsquo; element refers to a
project).  Columns are a subset of the following:
</p>

<dl>
<dt>text</dt><dd><p>The text of the &lsquo;<span class="samp">&#8288;type&#8288;</span>&rsquo; element</p>
</dd>
<dt>lang</dt><dd><p>The language of the text</p>
</dd>
<dt>normal</dt><dd><p>The normalized name of the type</p>
</dd>
<dt>normalId</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> value of the type in the standard
dictionary</p>
</dd>
<dt>normalStd</dt><dd><p>The name of the standard</p>
</dd>
<dt>project.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the project</p>
</dd>
<dt>site.id</dt><dd><p>One or more columns with this prefix, depending on
the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
<abbr><span class="acronym">ID</span></abbr> of the site where the &lsquo;<span class="samp">&#8288;&lt;type&gt;&#8288;</span>&rsquo; element
appeared.</p>
</dd>
<dt>tree.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the tree</p>
</dd>
<dt>core.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the core</p>
</dd>
<dt>derived.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the derived series</p>
</dd>
<dt>project.title</dt><dd><p>The title of the project</p>
</dd>
<dt>site.title</dt><dd><p>One or more columns with this prefix, depending
on the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
title of the site where the &lsquo;<span class="samp">&#8288;&lt;type&gt;&#8288;</span>&rsquo; element appeared.</p>
</dd>
<dt>tree.title</dt><dd><p>The title of the tree</p>
</dd>
<dt>core.title</dt><dd><p>The title of the core</p>
</dd>
<dt>derived.title</dt><dd><p>The title of the derived series</p>
</dd>
</dl>

</td></tr>
<tr><td><code>comments</code></td>
<td>
<p>A <code>data.frame</code> containing comments to various
entities, and metadata related to each &lsquo;<span class="samp">&#8288;comments&#8288;</span>&rsquo; element.
Contents are <code>NA</code> where the metadata is not applicable.  Columns
are a subset of the following:
</p>

<dl>
<dt>text</dt><dd><p>The text of the &lsquo;<span class="samp">&#8288;comments&#8288;</span>&rsquo; element</p>
</dd>
<dt>project.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the project</p>
</dd>
<dt>site.id</dt><dd><p>One or more columns with this prefix, depending on
the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
<abbr><span class="acronym">ID</span></abbr> of the site.</p>
</dd>
<dt>tree.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the tree</p>
</dd>
<dt>core.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the core</p>
</dd>
<dt>radius.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the radius</p>
</dd>
<dt>measurement.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the measurement series</p>
</dd>
<dt>derived.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the derived series</p>
</dd>
<dt>project.title</dt><dd><p>The title of the project</p>
</dd>
<dt>site.title</dt><dd><p>One or more columns with this prefix, depending
on the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
title of the site.</p>
</dd>
<dt>tree.title</dt><dd><p>The title of the tree</p>
</dd>
<dt>core.title</dt><dd><p>The title of the core</p>
</dd>
<dt>radius.title</dt><dd><p>The title of the radius</p>
</dd>
<dt>measurement.title</dt><dd><p>The title of the measurement series</p>
</dd>
<dt>derived.title</dt><dd><p>The title of the derived series</p>
</dd>
</dl>

</td></tr>
<tr><td><code>identifier</code></td>
<td>
<p>A <code>data.frame</code> containing identifiers of
various entities, and metadata related to each &lsquo;<span class="samp">&#8288;identifier&#8288;</span>&rsquo;
element.  Contents are <code>NA</code> where the metadata is not
applicable.  Columns are a subset of the following:
</p>

<dl>
<dt>text</dt><dd><p>The text of the &lsquo;<span class="samp">&#8288;identifier&#8288;</span>&rsquo; element</p>
</dd>
<dt>domain</dt><dd><p>The domain which the identifier is applicable to</p>
</dd>
<dt>project.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the project</p>
</dd>
<dt>site.id</dt><dd><p>One or more columns with this prefix, depending on
the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
<abbr><span class="acronym">ID</span></abbr> of the site.</p>
</dd>
<dt>tree.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the tree</p>
</dd>
<dt>core.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the core</p>
</dd>
<dt>radius.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the radius</p>
</dd>
<dt>measurement.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the measurement series</p>
</dd>
<dt>derived.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the derived series</p>
</dd>
<dt>project.title</dt><dd><p>The title of the project</p>
</dd>
<dt>site.title</dt><dd><p>One or more columns with this prefix, depending
on the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
title of the site.</p>
</dd>
<dt>tree.title</dt><dd><p>The title of the tree</p>
</dd>
<dt>core.title</dt><dd><p>The title of the core</p>
</dd>
<dt>radius.title</dt><dd><p>The title of the radius</p>
</dd>
<dt>measurement.title</dt><dd><p>The title of the measurement series</p>
</dd>
<dt>derived.title</dt><dd><p>The title of the derived series</p>
</dd>
</dl>

</td></tr>
<tr><td><code>remark</code></td>
<td>
<p>A <code>list</code> of remarks concerning individual measured
or derived values, with some of the following items:
</p>

<dl>
<dt>measurements</dt><dd><p>Remarks related to measurements with a known
year.  A <code>data.frame</code> with the following columns:
</p>

<dl>
<dt>text</dt><dd><p>The remark</p>
</dd>
<dt>frame</dt><dd><p>Index to a <code>data.frame</code> in
<code><var>measurements</var></code></p>
</dd>
<dt>row</dt><dd><p>Index to a row of the <code>data.frame</code></p>
</dd>
<dt>col</dt><dd><p>Index to a column of the <code>data.frame</code></p>
</dd>
</dl>

</dd>
<dt>undated</dt><dd><p>Remarks related to measurements without a known
year.  A <code>data.frame</code> with the following columns:
</p>

<dl>
<dt>text</dt><dd><p>The remark</p>
</dd>
<dt>series</dt><dd><p>Index to a series in
<code><var>undated</var>$<var>data</var></code></p>
</dd>
<dt>idx</dt><dd><p>Index to a value in the series</p>
</dd>
</dl>

</dd>
<dt>derived</dt><dd><p>Remarks related to derived values.  A
<code>data.frame</code> with the following columns:
</p>

<dl>
<dt>text</dt><dd><p>The remark</p>
</dd>
<dt>series</dt><dd><p>Index to a series in
<code><var>derived</var>$<var>data</var></code></p>
</dd>
<dt>idx</dt><dd><p>Index to a value in the series</p>
</dd>
</dl>

</dd>
</dl>

</td></tr>
<tr><td><code>laboratory</code></td>
<td>
<p>A <code>data.frame</code> or a <code>list</code> of
<code>data.frame</code>s with one item per project.  Each
<code>data.frame</code> contains information about the research
laboratories involved in the project.  Columns are a subset of the
following:
</p>

<dl>
<dt>name</dt><dd><p>Name of the laboratory</p>
</dd>
<dt>acronym</dt><dd><p>Acronym of the name</p>
</dd>
<dt>identifier</dt><dd><p>Identifier</p>
</dd>
<dt>domain</dt><dd><p>Domain which the identifier is applicable to</p>
</dd>
<dt>addressLine1</dt><dd><p>Address</p>
</dd>
<dt>addressLine2</dt><dd><p>Another address line</p>
</dd>
<dt>cityOrTown</dt><dd><p>City or town</p>
</dd>
<dt>stateProvinceRegion</dt><dd><p>State, province or region</p>
</dd>
<dt>postalCode</dt><dd><p>Postal code</p>
</dd>
<dt>country</dt><dd><p>Country</p>
</dd>
</dl>

</td></tr>
<tr><td><code>research</code></td>
<td>
<p>A <code>data.frame</code> or a <code>list</code> of
<code>data.frame</code>s with one item per project.  Each
<code>data.frame</code> contains information about the systems in which
the research project is registered.  Columns are the following:
</p>

<dl>
<dt>identifier</dt><dd><p>Identifier</p>
</dd>
<dt>domain</dt><dd><p>Domain which the identifier is applicable to</p>
</dd>
<dt>description</dt><dd><p>General description</p>
</dd>
</dl>

</td></tr>
<tr><td><code>altitude</code></td>
<td>
<p>A <code>data.frame</code> containing the altitude of
trees.  Columns are the following:
</p>

<dl>
<dt>metres</dt><dd><p>The altitude in metres</p>
</dd>
<dt>project.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the project</p>
</dd>
<dt>site.id</dt><dd><p>One or more columns with this prefix, depending on
the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
<abbr><span class="acronym">ID</span></abbr> of the site.</p>
</dd>
<dt>tree.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the tree</p>
</dd>
<dt>project.title</dt><dd><p>The title of the project</p>
</dd>
<dt>site.title</dt><dd><p>One or more columns with this prefix, depending
on the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
title of the site.</p>
</dd>
<dt>tree.title</dt><dd><p>The title of the tree</p>
</dd>
</dl>

</td></tr>
<tr><td><code>preferred</code></td>
<td>
<p>A <code>data.frame</code> containing links to preferred
measurement series.  Columns are a subset of the following:
</p>

<dl>
<dt>idRef</dt><dd><p>Reference to a series in the same file</p>
</dd>
<dt>xLink</dt><dd><p><abbr><span class="acronym">URI</span></abbr></p>
</dd>
<dt>identifier</dt><dd><p>Identifier of a series not necessarily in the
same file</p>
</dd>
<dt>domain</dt><dd><p>Domain which the identifier is applicable to</p>
</dd>
<dt>project.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the project</p>
</dd>
<dt>site.id</dt><dd><p>One or more columns with this prefix, depending on
the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives the
<abbr><span class="acronym">ID</span></abbr> of the site.</p>
</dd>
<dt>tree.id</dt><dd><p>The <abbr><span class="acronym">ID</span></abbr> of the tree</p>
</dd>
<dt>project.title</dt><dd><p>The title of the project</p>
</dd>
<dt>site.title</dt><dd><p>One or more columns with this prefix, depending on
the maximum depth of the &lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo; hierarchy.  Gives
the title of the site.</p>
</dd>
<dt>tree.title</dt><dd><p>The title of the tree</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Note</h3>

<p> This is an early version of the function.  Bugs are likely to
exist, and parameters and return values are subject to change.  Not
all metadata defined in the TRiDaS specification is supported &ndash;
unsupported elements are quietly ignored. </p>


<h3>Author(s)</h3>

<p> Mikko Korpela </p>


<h3>References</h3>

<p>Jansma, E., Brewer, P. W., and Zandhuis, I. (2010) TRiDaS 1.1: The
tree-ring data standard.  <em>Dendrochronologia</em>, <b>28</b>(2),
99&ndash;130.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code>, <code><a href="#topic+read.tucson">read.tucson</a></code>,
<code><a href="#topic+read.compact">read.compact</a></code>, <code><a href="#topic+read.fh">read.fh</a></code>,
<code><a href="#topic+write.tridas">write.tridas</a></code> </p>

<hr>
<h2 id='read.tucson'> Read Tucson Format Ring Width File </h2><span id='topic+read.tucson'></span>

<h3>Description</h3>

<p>This function reads in a Tucson (decadal) format file of ring widths (.rwl).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.tucson(fname, header = NULL, long = FALSE,
            encoding = getOption("encoding"), 
            edge.zeros = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.tucson_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
rwl file. </p>
</td></tr>
<tr><td><code id="read.tucson_+3A_header">header</code></td>
<td>
 <p><code>logical</code> flag indicating whether the file has a
header.  If <code>NULL</code> then the function will attempt to determine
if a header exists. </p>
</td></tr>
<tr><td><code id="read.tucson_+3A_long">long</code></td>
<td>
 <p><code>logical</code> flag indicating whether dates in file span
0 <abbr><span class="acronym">CE</span></abbr> and therefore use negative numbers.  If <code>TRUE</code>
only the first 7 characters can be used for series <abbr><span class="acronym">ID</span></abbr>s.
If <code>FALSE</code> then series <abbr><span class="acronym">ID</span></abbr>s can be up to 8
characters. </p>
</td></tr>
<tr><td><code id="read.tucson_+3A_encoding">encoding</code></td>
<td>
<p> the name of the encoding to be used when reading the
rwl file.  Usually the default value will work, but an rwl file
written in a non-default encoding may crash the function.  In that
case, identifying the encoding and specifying it here should fix the
problem.  Examples of popular encodings available on many systems
are <code>"ASCII"</code>, <code>"UTF-8"</code>, and <code>"latin1"</code> alias
<code>"ISO-8859-1"</code>.  See the help of <code><a href="base.html#topic+file">file</a></code>. </p>
</td></tr>
<tr><td><code id="read.tucson_+3A_edge.zeros">edge.zeros</code></td>
<td>
 <p><code>logical</code> flag indicating whether leading or
trailing zeros in series will be preserved (when the flag is
<code>TRUE</code>, the default) or discarded, i.e. marked as <code>NA</code>
(when <code>FALSE</code>). </p>
</td></tr>
<tr><td><code id="read.tucson_+3A_verbose">verbose</code></td>
<td>
 <p><code>logical</code> flag, print info on data. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This reads in a standard rwl file as defined according to the
standards of the <abbr><span class="acronym">ITRDB</span></abbr> at
<a href="https://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt">https://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt</a>.  Despite the
standards at the <abbr><span class="acronym">ITRDB</span></abbr>, this occasionally fails due to
formatting problems.
</p>


<h3>Value</h3>

<p>An object of class <code>c("rwl", "data.frame")</code> with the series in
columns and the years as rows.  The series <abbr><span class="acronym">ID</span></abbr>s are the
column names and the years are the row names.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and greatly improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code>, <code><a href="#topic+read.compact">read.compact</a></code>,
<code><a href="#topic+read.tridas">read.tridas</a></code>, <code><a href="#topic+read.fh">read.fh</a></code>,
<code><a href="#topic+write.tucson">write.tucson</a></code> </p>

<hr>
<h2 id='redfit'>
Red-Noise Spectra of Time-Series
</h2><span id='topic+redfit'></span><span id='topic+runcrit'></span>

<h3>Description</h3>

<p>Estimate red-noise spectra from a possibly unevenly spaced time-series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redfit(x, t, tType = c("time", "age"), nsim = 1000, mctest = TRUE,
       ofac = 4, hifac = 1, n50 = 3, rhopre = NULL,
       p = c(0.10, 0.05, 0.02), iwin = 2,
       txOrdered = FALSE, verbose = FALSE, seed = NULL,
       maxTime = 10, nLimit = 10000)

runcrit(n, p = c(0.10, 0.05, 0.02), maxTime = 10, nLimit = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="redfit_+3A_x">x</code></td>
<td>
<p> a <code>numeric</code> vector representing a possibly unevenly
spaced time-series.  </p>
</td></tr>
<tr><td><code id="redfit_+3A_t">t</code></td>
<td>
<p> a <code>numeric</code> vector of times or ages corresponding to
<code><var>x</var></code>.  If missing, this is set to an evenly spaced
increasing integer sequence (1, 2, ...) along <code><var>x</var></code>.
See <code><var>txOrdered</var></code>. </p>
</td></tr>
<tr><td><code id="redfit_+3A_ttype">tType</code></td>
<td>
<p> a <code>character</code> string indicating the type of the
<code><var>t</var></code> vector: either times or ages.  </p>
</td></tr>
<tr><td><code id="redfit_+3A_nsim">nsim</code></td>
<td>
<p> a <code>numeric</code> value giving the number of simulated AR1
spectra to compute.  </p>
</td></tr>
<tr><td><code id="redfit_+3A_mctest">mctest</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>, performs a
Monte Carlo test for computing red noise false-alarm levels.  In
that case, the result list will contain non-<code>NULL</code> elements
<code>"ci80"</code>, <code>"ci90"</code>, <code>"ci95"</code> and <code>"ci99"</code>.  </p>
</td></tr>
<tr><td><code id="redfit_+3A_ofac">ofac</code></td>
<td>
<p> oversampling factor for Lomb-Scargle Fourier transform.
A <code>numeric</code> value. </p>
</td></tr>
<tr><td><code id="redfit_+3A_hifac">hifac</code></td>
<td>
<p> maximum frequency to analyze relative to the Nyquist
frequency.  A <code>numeric</code> value. </p>
</td></tr>
<tr><td><code id="redfit_+3A_n50">n50</code></td>
<td>
<p> number of segments.  The segments overlap by about 50
percent. </p>
</td></tr>
<tr><td><code id="redfit_+3A_rhopre">rhopre</code></td>
<td>
<p> a <code>numeric</code> value giving the prescribed
autocorrelation coefficient.  If <code>NULL</code> or negative, the
autocorrelation coefficient will be estimated from the data. </p>
</td></tr>
<tr><td><code id="redfit_+3A_p">p</code></td>
<td>
<p> a <code>numeric</code> or <code><a href="gmp.html#topic+bigrational">bigq</a></code> (if
package <code>"gmp"</code> is installed) vector of significance levels for
a statistical test considering the number of runs in a sequence.
See &lsquo;Details&rsquo;. </p>
</td></tr>
<tr><td><code id="redfit_+3A_iwin">iwin</code></td>
<td>
<p> the type of window used for scaling the values of each
segment of data.  A <code>numeric</code> value or one of
<code>"rectangular"</code>, <code>"welch i"</code>, <code>"hanning"</code>,
<code>"triangular"</code> and <code>"blackman-harris"</code>.  Integers
<code>0:4</code> correspond to the character values, in this order.  The
default <code><var>iwin</var> = 2</code> corresponds to the <code>"hanning"</code>
window. </p>
</td></tr>
<tr><td><code id="redfit_+3A_txordered">txOrdered</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>, it is
assumed that <code><var>t</var></code> is in ascending order without
duplicates.  If <code>FALSE</code> (the default), <code><var>t</var></code> will be
sorted and <code><var>x</var></code> reordered accordingly.  Values of
<code><var>x</var></code> at identical values of <code><var>t</var></code> are averaged.
If duplicates are found, the non-duplicated <code><var>t</var></code> and
averaged <code><var>x</var></code> will be included in the return value of the
function.  </p>
</td></tr>
<tr><td><code id="redfit_+3A_verbose">verbose</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>, the function
prints some information while operating.  </p>
</td></tr>
<tr><td><code id="redfit_+3A_seed">seed</code></td>
<td>
<p> a value to be given to <code>set.seed</code> at the start of
the function.  The value is also recorded in the list returned.  If
not <code>NULL</code>, this can be used for reproducible results.  </p>
</td></tr>
<tr><td><code id="redfit_+3A_maxtime">maxTime</code></td>
<td>
<p> a <code>numeric</code> value giving the approximate maximum
time in seconds to use for computing the exact acceptance regions of
the number of runs test.  See also <code><var>nLimit</var></code>. </p>
</td></tr>
<tr><td><code id="redfit_+3A_nlimit">nLimit</code></td>
<td>
<p> a <code>numeric</code> value giving the maximum
<code><var>n</var></code> for which <code>runcrit</code> will try to compute an exact
solution to the acceptance regions of the number of runs test.
Precomputed solutions may exist for larger <code><var>n</var></code>).  This
limit is in place because a part of the exact solution always needs
to be computed in order to roughly estimate the total time and
whether it would exceed <code><var>maxTime</var></code>.  If
<code><var>nLimit</var></code> is very large, <code><var>maxTime</var></code> may be
(greatly) exceeded while computing the aforementioned part of the
exact solution. </p>
</td></tr>
<tr><td><code id="redfit_+3A_n">n</code></td>
<td>
<p> an integral value giving the length of the sequence in the
number of runs test. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>redfit</code> computes the spectrum of a possibly unevenly
sampled time-series by using the Lomb-Scargle Fourier transform.  The
spectrum is bias-corrected using spectra computed from simulated AR1
series and the theoretical AR1 spectrum.
</p>
<p>The function duplicates the functionality of program REDFIT by Schulz
and Mudelsee.  See the manual of that program for more information.
The results of this function should be very close to REDFIT.  However,
some changes have been made:
</p>

<ul>
<li><p> More precision is used in some constants and computations.
</p>
</li>
<li><p> All the data are used: the last segment always contains the
last pair of (<var>t</var>, <var>x</var>).  There may be small differences
between <code>redfit</code> and REDFIT with respect to the number of
points per segment and the overlap of consecutive segments.
</p>
</li>
<li><p> The critical values of the runs test (see the description of
<code>runcrit</code> below) differ between <code>redfit</code> and REDFIT.  The
approximate equations in REDFIT produce values quite far off from
the exact values when the number of frequencies is large.
</p>
</li>
<li><p> The user can select the significance levels of the runs test.
</p>
</li>
<li><p> Most of the window functions have been adjusted.
</p>
</li>
<li><p> 6 dB bandwidths have been computed for discrete-time windows.
</p>
</li></ul>

<p>Function <code>runcrit</code> computes the limits of the acceptance region
of a number of runs test: assuming a sequence of <code><var>n</var></code> i.i.d.
discrete random variables with two possible values <var>a</var> and <var>b</var>
of equal probability (0.5), we are examining the distribution of the
number of runs.  A run is an uninterrupted sequence of only <var>a</var> or
only <var>b</var>.  The minimum number of runs is 1 (a sequence with only
<var>a</var> or only <var>b</var>) while the maximum number is <code><var>n</var></code>
(alternating <var>a</var> and <var>b</var>).  See Bradley, p. 253‚Äì254,
259‚Äì263.  The function is also called from <code>redfit</code>;
see <code><var>rcnt</var></code> in &lsquo;Value&rsquo; for the interpretation.  In
this case the arguments <code><var>p</var></code>, <code><var>maxTime</var></code> and
<code><var>nLimit</var></code> are passed from <code>redfit</code> to <code>runcrit</code>,
and <code><var>n</var></code> is the number of output frequencies.
</p>
<p>The results of <code>runcrit</code> have been essentially precomputed for
some values of <code><var>p</var></code> and <code><var>n</var></code>.  If a precomputed
result is not found and <code><var>n</var></code> is not too large
(<code><var>nLimit</var></code>, <code><var>maxTime</var></code>), the exact results are
computed on-demand.  Otherwise, or if package <code>"gmp"</code> is not
installed, the normal distribution is used for approximation.
</p>


<h3>Value</h3>

<p>Function <code>runcrit</code> returns a <code>list</code> containing
<code><var>rcritlo</var></code>, <code><var>rcrithi</var></code> and <code><var>rcritexact</var></code>
(see below).  Function <code>redfit</code> returns a <code>list</code> with the
following elements:
</p>
<table role = "presentation">
<tr><td><code>varx</code></td>
<td>
<p> variance of <code><var>x</var></code> estimated from its spectrum.
A <code>numeric</code> value. </p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p> average autocorrelation coefficient, either estimated
from the data or prescribed (<code><var>rhopre</var></code>).  A <code>numeric</code>
value. </p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p> the time scale of an AR1 process corresponding to
<code><var>rho</var></code>.  A <code>numeric</code> value.  </p>
</td></tr>
<tr><td><code>rcnt</code></td>
<td>
<p> a <code>numeric</code> value giving the number of runs to be
used for a statistical test studying the difference between a
theoretical AR1 spectrum and the bias-corrected spectrum estimated
from the data.  Null hypothesis: the two spectra agree, i.e. the
probability of either being larger than the other is 0.5 at every
point.  Requires that <code><var>iwin</var> == 0</code> (<code>"rectangular"</code>),
<code><var>ofac</var> == 1</code> and <code><var>n50</var> == 1</code>.  Otherwise the
test is not performed and <var>rcnt</var> is <code>NULL</code>.  </p>
</td></tr>
<tr><td><code>rcritlo</code></td>
<td>
<p> a <code>numeric</code> vector of critical low values for
the number of runs, i.e. the lowest value for accepting the null
hypothesis at each level of significance <code><var>p</var></code>.  When
returned from <code>redfit</code>, <code>NULL</code> when <code><var>rcnt</var></code> is
<code>NULL</code>. </p>
</td></tr>
<tr><td><code>rcrithi</code></td>
<td>
<p> a <code>numeric</code> vector of critical high values for
the number of runs, i.e. the highest value for accepting the null
hypothesis at each level of significance <code><var>p</var></code>.  When
returned from <code>redfit</code>, <code>NULL</code> when <code><var>rcnt</var></code> is
<code>NULL</code>. </p>
</td></tr>
<tr><td><code>rcritexact</code></td>
<td>
<p> a <code>logical</code> vector specifying whether each
pair of <code><var>rcritlo</var></code> and <code><var>rcrithi</var></code> are exact
values (<code>TRUE</code>) or approximated from a normal distribution
(<code>FALSE</code>).  When returned from <code>redfit</code>, <code>NULL</code> when
<code><var>rcnt</var></code> is <code>NULL</code>. </p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p> the frequencies used.  A <code>numeric</code> vector.  The
other numeric vectors have the same length, i.e. one value for each
frequency studied. </p>
</td></tr>
<tr><td><code>gxx</code></td>
<td>
<p> estimated spectrum of the data (<var>t</var>, <var>x</var>).  A
<code>numeric</code> vector.  </p>
</td></tr>
<tr><td><code>gxxc</code></td>
<td>
<p> red noise corrected spectrum of the data.  A
<code>numeric</code> vector.  </p>
</td></tr>
<tr><td><code>grravg</code></td>
<td>
<p> average AR1 spectrum over <code><var>nsim</var></code>
simulations.  A <code>numeric</code> vector. </p>
</td></tr>
<tr><td><code>gredth</code></td>
<td>
<p> theoretical AR1 spectrum.  A <code>numeric</code> vector.  </p>
</td></tr>
<tr><td><code>corr</code></td>
<td>
<p> a <code>numeric</code> vector containing the by-frequency
correction: <code><var>gxxc</var></code> equals <code><var>gxx</var></code> divided by
<code><var>corr</var></code> (or multiplied by the inverse correction).  Also
used for computing <code><var>ci80</var></code>, <code><var>ci90</var></code>,
<code><var>ci95</var></code> and <code><var>ci99</var></code>. </p>
</td></tr>
<tr><td><code>ci80</code></td>
<td>
<p> a <code>numeric</code> vector containing the bias-corrected
80th percentile (by frequency) red noise spectrum.  Only if
<code><var>mctest</var></code> is <code>TRUE</code>. </p>
</td></tr>
<tr><td><code>ci90</code></td>
<td>
<p> a <code>numeric</code> vector containing the 90th percentile
red noise spectrum. </p>
</td></tr>
<tr><td><code>ci95</code></td>
<td>
<p> 95th percentile red noise spectrum. </p>
</td></tr>
<tr><td><code>ci99</code></td>
<td>
<p> 99th percentile red noise spectrum. </p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call to the function.  See <code><a href="base.html#topic+match.call">match.call</a></code>.</p>
</td></tr>
<tr><td><code>params</code></td>
<td>

<p>A <code>list</code> with the following items:
</p>

<dl>
<dt>np </dt><dd><p> number of points in the data.  </p>
</dd>
<dt>nseg </dt><dd><p> number of points in each segment.  </p>
</dd>
<dt>nfreq </dt><dd><p> number of frequencies in the results.  </p>
</dd>
<dt>avgdt </dt><dd><p> average sampling interval.  </p>
</dd>
<dt>df </dt><dd><p> difference between consecutive frequencies.  </p>
</dd>
<dt>fnyq </dt><dd><p> average Nyquist frequency.  </p>
</dd>
<dt>n50 </dt><dd><p> value of the <code><var>n50</var></code> argument.  </p>
</dd>
<dt>ofac </dt><dd><p> value of the <code><var>ofac</var></code> argument.  </p>
</dd>
<dt>hifac </dt><dd><p> value of the <code><var>hifac</var></code> argument.  </p>
</dd>
<dt>segskip </dt><dd><p> the ideal, non-rounded difference between
starting indices of consecutive segments.  </p>
</dd>
<dt>iwin </dt><dd><p> value of the <code><var>iwin</var></code> argument.  If a
<code>character</code> value was used, this contains the corresponding
number used internally. </p>
</dd>
<dt>nsim </dt><dd><p> value of the <code><var>nsim</var></code> argument.  </p>
</dd>
<dt>mctest </dt><dd><p> value of the <code><var>mctest</var></code> argument.  </p>
</dd>
<dt>rhopre </dt><dd><p> value of the <code><var>rhopre</var></code> argument.  </p>
</dd>
</dl>

</td></tr>
<tr><td><code>vers</code></td>
<td>
<p>version of dplR.  See <code><a href="utils.html#topic+packageVersion">packageVersion</a></code>.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p> value of the <code><var>seed</var></code> argument.  </p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p> if duplicated values of <code><var>t</var></code> are given, the
non-duplicated <code>numeric</code> time or age vector (see
<code><var>tType</var></code>) is returned here.  Otherwise <code>NULL</code>.  See
<code><var>txOrdered</var></code>. </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> if duplicated values of <code><var>t</var></code> are given, the
averaged <code>numeric</code> data vector is returned here.  Otherwise
<code>NULL</code>. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikko Korpela.  Examples by Andy Bunn.
</p>


<h3>References</h3>

<p>Function <code>redfit</code> is based on the Fortran program
<a href="https://www.marum.de/Prof.-Dr.-michael-schulz.html">REDFIT</a>
(version 3.8e), which is in the public domain.
</p>
<p>Bradley, J. V. (1968) <em>Distribution-Free Statistical
Tests</em>.  Prentice-Hall.
</p>
<p>Schulz, M. and Mudelsee, M. (2002) REDFIT: estimating red-noise
spectra directly from unevenly spaced paleoclimatic time series.
<em>Computers &amp; Geosciences</em>, <b>28</b>(3), 421‚Äì426.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.redfit">print.redfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a simulated tree-ring width series that has a red-noise
# background ar1=phi and sd=sigma and an embedded signal with 
# a period of 10 and an amplitude of have the rednoise sd.
library(graphics)
library(stats)
runif(1)
rs &lt;- .Random.seed
set.seed(123)
nyrs &lt;- 500
yrs &lt;- 1:nyrs

# Here is an ar1 time series with a mean of 2mm,
# an ar1 of phi, and sd of sigma
phi &lt;- 0.7
sigma &lt;- 0.3
sigma0 &lt;- sqrt((1 - phi^2) * sigma^2)
x &lt;- arima.sim(list(ar = phi), n = nyrs, sd = sigma0) + 2

# Here is a sine wave at f=0.1 to add in with an amplitude
# equal to half the sd of the red noise background
per &lt;- 10
amp &lt;- sigma0 / 2
wav &lt;- amp * sin(2 * pi / per * yrs)

# Add them together so we have signal and noise
x &lt;- x + wav

# Here is the redfit spec
redf.x &lt;- redfit(x, nsim = 500)

# Acceptance region of number of runs test
# (not useful with default arguments of redfit())
runcrit(length(redf.x[["freq"]]))

op &lt;- par(no.readonly = TRUE) # Save to reset on exit
par(tcl = 0.5, mar = rep(2.2, 4), mgp = c(1.1, 0.1, 0))

plot(redf.x[["freq"]], redf.x[["gxxc"]],
     ylim = range(redf.x[["ci99"]], redf.x[["gxxc"]]),
     type = "n", ylab = "Spectrum", xlab = "Frequency (1/yr)",
     axes = FALSE)
grid()
lines(redf.x[["freq"]], redf.x[["gxxc"]], col = "#1B9E77")
lines(redf.x[["freq"]], redf.x[["ci99"]], col = "#D95F02")
lines(redf.x[["freq"]], redf.x[["ci95"]], col = "#7570B3")
lines(redf.x[["freq"]], redf.x[["ci90"]], col = "#E7298A")
freqs &lt;- pretty(redf.x[["freq"]])
pers &lt;- round(1 / freqs, 2)
axis(1, at = freqs, labels = TRUE)
axis(3, at = freqs, labels = pers)
mtext(text = "Period (yr)", side = 3, line = 1.1)
axis(2); axis(4)
legend("topright", c("x", "CI99", "CI95", "CI90"), lwd = 2,
       col = c("#1B9E77", "#D95F02", "#7570B3", "#E7298A"),
       bg = "white")
box()

## Not run: 
# Second example with tree-ring data
# Note the long-term low-freq signal in the data. E.g.,
# crn.plot(cana157)

library(utils)
data(cana157)
yrs &lt;- time(cana157)
x &lt;- cana157[, 1]
redf.x &lt;- redfit(x, nsim = 1000)

plot(redf.x[["freq"]], redf.x[["gxxc"]],
     ylim = range(redf.x[["ci99"]], redf.x[["gxxc"]]),
     type = "n", ylab = "Spectrum", xlab = "Frequency (1/yr)",
     axes = FALSE)
grid()
lines(redf.x[["freq"]], redf.x[["gxxc"]], col = "#1B9E77")
lines(redf.x[["freq"]], redf.x[["ci99"]], col = "#D95F02")
lines(redf.x[["freq"]], redf.x[["ci95"]], col = "#7570B3")
lines(redf.x[["freq"]], redf.x[["ci90"]], col = "#E7298A")
freqs &lt;- pretty(redf.x[["freq"]])
pers &lt;- round(1 / freqs, 2)
axis(1, at = freqs, labels = TRUE)
axis(3, at = freqs, labels = pers)
mtext(text = "Period (yr)", side = 3, line = 1.1)
axis(2); axis(4)
legend("topright", c("x", "CI99", "CI95", "CI90"), lwd = 2,
       col = c("#1B9E77", "#D95F02", "#7570B3", "#E7298A"),
       bg = "white")
box()
par(op)

## End(Not run)
.Random.seed &lt;- rs
</code></pre>

<hr>
<h2 id='rwi.stats.running'> (Running Window) Statistics on Detrended Ring-Width Series </h2><span id='topic+rwi.stats.running'></span><span id='topic+rwi.stats'></span><span id='topic+rwi.stats.legacy'></span>

<h3>Description</h3>

<p>These functions calculate descriptive statistics on a
<code>data.frame</code> of (usually) ring-width indices.  The statistics are
optionally computed in a running window with adjustable length and
overlap.  The data can be filtered so that the comparisons are made to
on just high-frequency data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rwi.stats.running(rwi, ids = NULL, period = c("max", "common"),
                  method = c("spearman", "pearson","kendall"),
                  prewhiten=FALSE,n=NULL,
                  running.window = TRUE,
                  window.length = min(50, nrow(rwi)),
                  window.overlap = floor(window.length / 2),
                  first.start = NULL,
                  min.corr.overlap = min(30, window.length),
                  round.decimals = 3,
                  zero.is.missing = TRUE)

rwi.stats(rwi, ids=NULL, period=c("max", "common"), 
          method = c("spearman", "pearson","kendall"), ...)

rwi.stats.legacy(rwi, ids=NULL, period=c("max", "common"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rwi.stats.running_+3A_rwi">rwi</code></td>
<td>
<p> a <code>data.frame</code> with detrended and standardized ring
width indices as columns and years as rows such as that produced by
<code><a href="#topic+detrend">detrend</a></code>. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_ids">ids</code></td>
<td>
<p> an optional <code>data.frame</code> with column one named
<code>"tree"</code> giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr> for each tree and
column two named <code>"core"</code> giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr>
for each core.  Defaults to one core per tree as<br />
<code>data.frame(tree=1:ncol(<var>rwi</var>), core=rep(1, ncol(<var>rwi</var>)))</code>. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_period">period</code></td>
<td>
<p> a <code>character</code> string, either <code>"common"</code> or
<code>"max"</code> indicating whether correlations should be limited to
complete observations over the period common to all cores (i.e. rows
common to all samples) or the maximum pairwise overlap.  Defaults
to <code>"max"</code>. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_method">method</code></td>
<td>
<p>Can be either <code>"pearson"</code>, <code>"kendall"</code>, or
<code>"spearman"</code> which indicates the correlation coefficient to be
used.  Defaults to <code>"spearman"</code>.  See <code><a href="stats.html#topic+cor">cor</a></code>. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length
for the <code><a href="#topic+hanning">hanning</a></code> filter used for removal of low
frequency variation. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_running.window">running.window</code></td>
<td>
 <p><code>logical</code> flag indicating whether to use a
running window (<code>TRUE</code>, the default) or to ignore the other
window parameters and effectively use one window covering all years
(<code>FALSE</code>). </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_window.length">window.length</code></td>
<td>
 <p><code>numeric</code> value indicating the length of
the running window in years.  The default is 50 years or the number
of years (rows) in <code><var>rwi</var></code>, whichever is smaller. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_window.overlap">window.overlap</code></td>
<td>
 <p><code>numeric</code> value indicating the overlap of
consecutive window positions, i.e. the number of common years.  The
default is half of the window length, rounded down. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_first.start">first.start</code></td>
<td>
<p> an optional <code>numeric</code> value setting the
position of the first window.  Must be a value between <code>1</code> and
<code><var>n.years</var>-<var>window.length</var>+1</code>, where
<code><var>n.years</var></code> is the number of years in <code><var>rwi</var></code>.  The
default value <code>NULL</code> lets the function make the decision using
some heuristic rules. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_min.corr.overlap">min.corr.overlap</code></td>
<td>
 <p><code>numeric</code> value setting the minimum
number of common years in any pair of ring-width series required for
their correlation to be included in the calculations.  Smaller
overlaps are considered to yield unreliable correlation values which
are ignored.  Defaults to the minimum of 30 and the length of the
window.  One way to lift the restriction and include all correlations
is to set <code><var>min.corr.overlap</var> = 0</code>. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_round.decimals">round.decimals</code></td>
<td>
<p> non-negative integer <code>numeric</code> value
setting the desired number of decimal places in the results.  Use
<code>NA</code>, <code>NULL</code> or a negative number for no rounding. </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_zero.is.missing">zero.is.missing</code></td>
<td>
 <p><code>logical</code> flag indicating whether to
treat zeros as missing values (<code>TRUE</code>, the default) or to
include them in computation (<code>FALSE</code>).  </p>
</td></tr>
<tr><td><code id="rwi.stats.running_+3A_...">...</code></td>
<td>
<p> arguments passed on to <code>rwi.stats.running</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates a variety of descriptive statistics commonly used in
dendrochronology.
</p>
<p>The function <code>rwi.stats</code> is a wrapper that calls
<code>rwi.stats.running</code> with <code><var>running.window</var> = FALSE</code>.
The results may differ from those prior to dplR 1.5.3, where the
former <code>rwi.stats</code> (now renamed to <code>rwi.stats.legacy</code>) was
replaced with a call to <code>rwi.stats.running</code>.
</p>
<p>For correctly calculating the statistics on within and between series
variability, an appropriate mask (parameter <code><var>ids</var></code>) must be
provided that identifies each series with a tree as it is common for
dendrochronologists to take more than one core per tree.  The function
<code><a href="#topic+read.ids">read.ids</a></code> is helpful for creating a mask based on the
series <abbr><span class="acronym">ID</span></abbr>.
</p>
<p>If <code><var>ids</var></code> has duplicate tree/core combinations, the
corresponding series are averaged before any statistics are computed.
The value of the parameter <code><var>zero.is.missing</var></code> is relevant in
the averaging: <code>TRUE</code> ensures that zeros don‚Äôt
contribute to the average.  The default value of
<code><var>zero.is.missing</var></code> is <code>TRUE</code>.  The default prior to
dplR 1.5.3 was <code>FALSE</code>.  If the parameter is set to <code>FALSE</code>,
the user will be warned in case zeros are present.  Duplicate
tree/core combinations are not detected by <code>rwi.stats.legacy</code>.
</p>
<p>Row names of <code><var>ids</var></code> may be used for matching the
<abbr><span class="acronym">ID</span></abbr>s with series in <code><var>rwi</var></code>.  In this case, the
number of rows in <code><var>ids</var></code> is allowed to exceed the number of
series.  If some names of <code><var>rwi</var></code> are missing from the row
names of <code><var>ids</var></code>, the rows of <code><var>ids</var></code> are assumed to
be in the same order as the columns of <code><var>rwi</var></code>, and the
dimensions must match.  The latter is also the way that
<code>rwi.stats.legacy</code> handles <code><var>ids</var></code>, i.e. names are
ignored and dimensions must match.
</p>
<p>Note that <code>period = "common"</code> can produce <code>NaN</code> for many of
the stats if there is no common overlap period among the cores.  This
happens especially in chronologies with floating subfossil samples
(e.g., <code><a href="#topic+ca533">ca533</a></code>).
</p>
<p>Some of the statistics are specific to dendrochronology (e.g., the
effective number of cores or the expressed population signal).  Users
unfamiliar with these should see Cook and Kairiukstis (1990) and
Fritts (2001) for further details for computational details on the
output.  The signal-to-noise ratio is calculated following Cook and 
Pederson (2011).
</p>
<p>Note that Buras (2017) cautions against using the expressed population signal as a statistic to determine the whether a chronology correctly represents the population signal of a data set. He reccomends the use of subsample signal strength (<code><a href="#topic+sss">sss</a></code>) over EPS.
</p>
<p>If desired, the <code><var>rwi</var></code> can be filtered in the same manner
as the family of cross-dating functions using <code><var>prewhiten</var></code> and
<code><var>n</var></code>.  See the help page for <code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code> for
more details.
</p>


<h3>Value</h3>

<p> A <code>data.frame</code> containing the following columns (each row
corresponds to one position of the window):
</p>
<table role = "presentation">
<tr><td><code>start.year</code></td>
<td>
<p>the first year in the window.  Not returned if
<code>running.window</code> is <code>FALSE</code> or called as
<code>rwi.stats</code> or <code>rwi.stats.legacy</code>.</p>
</td></tr>
<tr><td><code>mid.year</code></td>
<td>
<p>the middle year in the window, rounded down.  Not
returned if <code>running.window</code> is <code>FALSE</code> or called as
<code>rwi.stats</code> or <code>rwi.stats.legacy</code>.</p>
</td></tr>
<tr><td><code>end.year</code></td>
<td>
<p>the last year in the window.  Not returned if
<code>running.window</code> is <code>FALSE</code> or called as
<code>rwi.stats</code> or <code>rwi.stats.legacy</code>.</p>
</td></tr>
<tr><td><code>n.cores</code></td>
<td>
<p>the number of cores</p>
</td></tr>
<tr><td><code>n.trees</code></td>
<td>
<p>the number of trees</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the average number of trees (for each year, a tree needs at
least one non-<code>NA</code> core in order to be counted).  Not returned
in the results of <code>rwi.stats.legacy</code></p>
</td></tr>
<tr><td><code>n.tot</code></td>
<td>
<p>total number of correlations calculated as
<code><var>n.wt</var> + <var>n.bt</var></code>.
</p>
<p>Equal to <code><var>n.cores</var> * (<var>n.cores</var>-1)/2</code> if there is
overlap between all samples </p>
</td></tr>
<tr><td><code>n.wt</code></td>
<td>
<p>number of within-tree correlations computed</p>
</td></tr>
<tr><td><code>n.bt</code></td>
<td>
<p>number of between-tree correlations computed</p>
</td></tr>
<tr><td><code>rbar.tot</code></td>
<td>
<p>the mean of all the correlations between different 
cores</p>
</td></tr>
<tr><td><code>rbar.wt</code></td>
<td>
<p>the mean of the correlations between series from the
same tree over all trees</p>
</td></tr>
<tr><td><code>rbar.bt</code></td>
<td>
<p>the mean interseries correlation between all series
from different trees</p>
</td></tr>
<tr><td><code>c.eff</code></td>
<td>
<p>the effective number of cores (takes into account the
number of within-tree correlations in each tree)</p>
</td></tr>
<tr><td><code>rbar.eff</code></td>
<td>
<p>the effective signal calculated as
<code><var>rbar.bt</var> / (<var>rbar.wt</var> + (1-<var>rbar.wt</var>) / <var>c.eff</var>) </code></p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>the expressed population signal calculated using the average
number of trees as<br />
<code><var>n</var> * <var>rbar.eff</var> / ((<var>n</var> - 1) * <var>rbar.eff</var> + 1)</code> </p>
</td></tr>
<tr><td><code>snr</code></td>
<td>
<p>the signal to noise ratio calculated using the average
number of trees as<br />
<code><var>n</var> * <var>rbar.eff</var> / (1-<var>rbar.eff</var>)</code> </p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function uses the <code><a href="foreach.html#topic+foreach">foreach</a></code> looping
construct with the <code><a href="foreach.html#topic+foreach">%dopar%</a></code> operator.
For parallel computing and a potential speedup, a parallel backend
must be registered before running the function.
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela, based on <code><a href="#topic+rwi.stats.legacy">rwi.stats.legacy</a></code> by Andy
Bunn </p>


<h3>References</h3>

<p>Buras, A. (2017) A comment on the Expressed Population Signal. Dendrochronologia 44:130-132. 
</p>
<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Cook, E. R. and Pederson, N. (2011) Uncertainty, Emergence, and
Statistics in Dendrochronology.  In Hughes, M. K., Swetnam, T. W., and
Diaz, H. F., editors, <em>Dendroclimatology: Progress and
Prospects</em>, pages 77‚Äì112.  Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>:
978-1-4020-4010-8.
</p>
<p>Fritts, H. C. (2001) <em>Tree Rings and Climate</em>.  Blackburn.
<abbr><span class="acronym">ISBN-13</span></abbr>: 978-1-930665-39-2.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+detrend">detrend</a></code>, <code><a href="stats.html#topic+cor">cor</a></code>,
<code><a href="#topic+read.ids">read.ids</a></code>, <code><a href="#topic+rwi.stats">rwi.stats</a></code>,
<code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(gp.rwl)
data(gp.po)
gp.rwi &lt;- cms(rwl = gp.rwl, po = gp.po)
gp.ids &lt;- read.ids(gp.rwl, stc = c(0, 2, 1))
# On a running window
rwi.stats.running(gp.rwi, gp.ids)
## With no running window (i.e. running.window = FALSE)
rwi.stats(gp.rwi, gp.ids)
## Restrict to common overlap (in this case 1899 to 1987)
rwi.stats(gp.rwi, gp.ids, period="common")
rwi.stats.legacy(gp.rwi, gp.ids) # rwi.stats prior to dplR 1.5.3

</code></pre>

<hr>
<h2 id='rwl.report'>Do some reporting on a RWL object</h2><span id='topic+rwl.report'></span>

<h3>Description</h3>

<p>This function generates a small report on a <code>rwl</code> (or <code>rwi</code>) object
that gives the user some basic information on the data including the number of
series, the span of the data, the mean interseries correlation, the number of
missing rings (zeros), internal <code>NA</code> values, and rings that are very small,
or very large.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rwl.report(rwl,small.thresh=NA,big.thresh=NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rwl.report_+3A_rwl">rwl</code></td>
<td>
<p>a <code>data.frame</code> of ring widths with
<code>rownames(<var>x</var>)</code> containing years and <code>colnames(x)</code>
containing each series <abbr><span class="acronym">ID</span></abbr> such as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code></p>
</td></tr>
<tr><td><code id="rwl.report_+3A_small.thresh">small.thresh</code></td>
<td>
<p>a <code>numeric</code> value for the threshold value that will cause
small rings to be listed. If values is <code>NA</code> this will be omitted.</p>
</td></tr>
<tr><td><code id="rwl.report_+3A_big.thresh">big.thresh</code></td>
<td>
<p>a <code>numeric</code> value for the threshold value that will cause
large rings to be listed. If values is <code>NA</code> this will be omitted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This generates information about a <code>rwl</code> object including the number of series, the mean length of all the series, the first year, last year, the mean first-order  autocorrelation (via <code><a href="#topic+summary.rwl">summary.rwl</a></code>), the mean interseries  correlation (via <code><a href="#topic+interseries.cor">interseries.cor</a></code>), the years where a series has a missing ring (zero), internal NA, very small ring, very large rings, etc.  
</p>
<p>This output of this function is not typically meant for the user to access but has a <code>print</code> method for the user.
</p>


<h3>Value</h3>

<p>A <code>list</code> with elements containing descriptive information on the <code>rwl</code> object. Specifically:
</p>
<table role = "presentation">
<tr><td><code>small.thresh</code></td>
<td>
<p>a <code>numeric</code> value passed in.</p>
</td></tr>
<tr><td><code>big.thresh</code></td>
<td>
<p>a <code>numeric</code> value passed in.</p>
</td></tr>
<tr><td><code>nSeries</code></td>
<td>
<p>a <code>numeric</code> value with the number of series.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a <code>numeric</code> value with the total number of rings.</p>
</td></tr>
<tr><td><code>meanSegLength</code></td>
<td>
<p>a <code>numeric</code> with the mean segment length.</p>
</td></tr>
<tr><td><code>firstYear</code></td>
<td>
<p>a <code>numeric</code> with the first year.</p>
</td></tr>
<tr><td><code>lastYear</code></td>
<td>
<p>a <code>numeric</code> with the last year.</p>
</td></tr>
<tr><td><code>meanAR1</code></td>
<td>
<p>a <code>numeric</code> with the mean AR1 value of all series.</p>
</td></tr>
<tr><td><code>sdAR1</code></td>
<td>
<p>a <code>numeric</code> with the standard deviation of the AR1 values of all series.</p>
</td></tr>
<tr><td><code>unconnected</code></td>
<td>
<p>a <code>logical</code> indicating if there are rows (years) with all NA values.</p>
</td></tr>
<tr><td><code>unconnectedYrs</code></td>
<td>
<p>a <code>numeric</code> vector with unconnceted years.</p>
</td></tr>
<tr><td><code>nZeros</code></td>
<td>
<p>a <code>numeric</code> with number of zeros in the data. </p>
</td></tr>
<tr><td><code>zeros</code></td>
<td>
<p> a <code>list</code> containing series and years with zeros or a <code>numeric</code> of 0.</p>
</td></tr>
<tr><td><code>allZeroYears</code></td>
<td>
<p>a <code>numeric</code> indicating rows (years) with all zero values. </p>
</td></tr>
<tr><td><code>consecutiveZeros</code></td>
<td>
<p> a <code>list</code> containing series and years with consecuative zeros or a <code>numeric</code> of 0. </p>
</td></tr>
<tr><td><code>meanInterSeriesCor</code></td>
<td>
<p>a <code>numeric</code> with the mean interseries correlation.</p>
</td></tr>
<tr><td><code>sdInterSeriesCor</code></td>
<td>
<p>a <code>numeric</code> with the standard deviation of the interseries correlations.</p>
</td></tr>
<tr><td><code>internalNAs</code></td>
<td>
<p>a <code>list</code> containing series and years with internal NA values or a <code>numeric</code> of 0.</p>
</td></tr>
<tr><td><code>smallRings</code></td>
<td>
<p>a <code>list</code> containing series and years with small rings or a <code>numeric</code> of 0.</p>
</td></tr>
<tr><td><code>bigRings</code></td>
<td>
<p>a <code>list</code> containing series and years with small rings or a <code>numeric</code> of 0.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code>, <code><a href="#topic+summary.rwl">summary.rwl</a></code>,
<code><a href="#topic+interseries.cor">interseries.cor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("gp.rwl")
rwl.report(rwl = gp.rwl)
# list very small (smallest 1pct) of rings as well
one.pct &lt;- quantile(gp.rwl[gp.rwl != 0], na.rm=TRUE, probs=0.01)
rwl.report(rwl = gp.rwl, small.thresh = one.pct)
</code></pre>

<hr>
<h2 id='rwl.stats'> Calculate Descriptive Summary Statistics on Ring-Width Series </h2><span id='topic+rwl.stats'></span><span id='topic+summary.rwl'></span>

<h3>Description</h3>

<p>This function calculates descriptive statistics on a <code>rwl</code> object
of raw or detrended ring-width series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rwl.stats(rwl)

## S3 method for class 'rwl'
summary(object, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rwl.stats_+3A_rwl">rwl</code>, <code id="rwl.stats_+3A_object">object</code></td>
<td>
<p> a <code>rwl</code> object with (usually) raw ring-width series
as columns and years as rows such as that produced by
<code><a href="#topic+read.rwl">read.rwl</a></code>.  It is sometimes desirable to run this on
detrended (e.g., rwi) data. </p>
</td></tr>
<tr><td><code id="rwl.stats_+3A_...">...</code></td>
<td>
<p> Additional arguments from the generic function.  These
are silently ignored. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates a variety of descriptive statistics commonly used in
dendrochronology (see below).  Users unfamiliar with these should see
Cook and Kairiukstis (1990) and Fritts (2001) for further details.
</p>
<p>The <code><a href="base.html#topic+summary">summary</a></code> method for class <code>"rwl"</code> is a wrapper
for <code>rwl.stats</code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing descriptive stats on each
<code>"series"</code>.  These are the first and last year of the series as
well as the length of the series (<code>"first"</code>, <code>"last"</code>,
<code>"year"</code>).  The mean, median, standard deviation are given
(<code>"mean"</code>, <code>"median"</code>, <code>"stdev"</code>) as are the skewness,
the excess kurtosis (calculated as Pearson‚Äôs kurtosis minus 3), the Gini 
coefficient, and first order
autocorrelation (<code>"skew"</code>, <code>"kurtosis"</code>, <code>"<a href="#topic+gini.coef">gini.coef</a>"</code>, 
<code>"ar1"</code>).
</p>
<p>Note that prior to version 1.6.8, two measures of sensitivity were also included. However mean sensitivity is not a robust statistic that should rarely, if ever, be used (Bunn et al. 2013). Those sensitivity functions (<code>"<a href="#topic+sens1">sens1</a>"</code> and <code>"<a href="#topic+sens2">sens2</a>"</code>) are still available for continuity. Users should consider the coef of variation in lieu of mean sensitivity.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Slightly improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Bunn, A. G., Jansma, E., Korpela, M., Westfall, R. D., and Baldwin,
J. (2013) Using simulations and data to evaluate mean sensitivity
(<code class="reqn">\zeta</code>) as a useful statistic in dendrochronology.
<em>Dendrochronologia</em>, <b>31</b>(3), 250‚Äì254.
</p>
<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Fritts, H. C. (2001) <em>Tree Rings and Climate</em>.  Blackburn.
<abbr><span class="acronym">ISBN-13</span></abbr>: 978-1-930665-39-2.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rwi.stats">rwi.stats</a></code>, <code><a href="#topic+read.rwl">read.rwl</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
rwl.stats(ca533)
summary(ca533)
</code></pre>

<hr>
<h2 id='sea'> Superposed Epoch Analysis </h2><span id='topic+sea'></span>

<h3>Description</h3>

<p>This function calculates the significance of the departure from the
mean for a given set of key event years and lagged years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sea(x, key, lag = 5, resample = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sea_+3A_x">x</code></td>
<td>
<p> a chronology <code>data.frame</code> of ring-width indices (such
as produced by <a href="#topic+chron">chron</a>)</p>
</td></tr>
<tr><td><code id="sea_+3A_key">key</code></td>
<td>
<p> a vector specifying the key event years for the superposed
epoch</p>
</td></tr>
<tr><td><code id="sea_+3A_lag">lag</code></td>
<td>
<p> an integral value defining the number of lagged years </p>
</td></tr>
<tr><td><code id="sea_+3A_resample">resample</code></td>
<td>
<p> an integral value specifying the number of bootstrap
sample for calculation of confidence intervals</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Superposed epoch analysis (SEA) is used to test the significance of a mean
tree growth response to certain events (such as droughts).  Departures
from the mean <abbr><span class="acronym">RWI</span></abbr> values for the specified years prior to
each event year, the event year, and the specified years immediately
after each event are averaged to a superposed epoch.  To determine if
<abbr><span class="acronym">RWI</span></abbr> for these years was significantly different from
randomly selected sets of <code><var>lag</var>+1</code> other years, bootstrap
resampling is used to randomly select sets of <code><var>lag</var>+1</code> years
from the data set and to estimate significances for the departures
from the mean <abbr><span class="acronym">RWI</span></abbr>.
</p>
<p>SEA computation is based on scaled <abbr><span class="acronym">RWI</span></abbr> values, and
95%-confidence intervals are computed for the scaled values for each
year in the superposed epoch.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with
</p>
<table role = "presentation">
<tr><td><code>lag</code></td>
<td>
<p>the lagged years,</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>the superposed epoch, i.e. the scaled mean <abbr><span class="acronym">RWI</span></abbr> for
the event years,</p>
</td></tr>
<tr><td><code>se.unscaled</code></td>
<td>
<p>the unscaled superposed epoch, i.e. the mean
<abbr><span class="acronym">RWI</span></abbr> for the event years,</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>significance of the departure from the chrono‚Äôs mean
<abbr><span class="acronym">RWI</span></abbr>,</p>
</td></tr>
<tr><td><code>ci.95.lower</code></td>
<td>
<p>lower 95% confidence band,</p>
</td></tr>
<tr><td><code>ci.95.upper</code></td>
<td>
<p>upper 95% confidence band,</p>
</td></tr>
<tr><td><code>ci.99.lower</code></td>
<td>
<p>lower 99% confidence band,</p>
</td></tr>
<tr><td><code>ci.99.upper</code></td>
<td>
<p>upper 99% confidence band.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Christian Zang.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Lough, J. M. and Fritts, H. C. (1987) An assessment of the possible
effects of volcanic eruptions on North American climate using
tree-ring data, 1602 to 1900 <abbr><span class="acronym">AD</span></abbr>.  <em>Climatic Change</em>,
<b>10</b>(3), 219‚Äì239.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(utils)
data(cana157)
event.years &lt;- c(1631, 1742, 1845)
cana157.sea &lt;- sea(cana157, event.years)
foo &lt;- cana157.sea$se.unscaled
names(foo) &lt;- cana157.sea$lag
barplot(foo, col = ifelse(cana157.sea$p &lt; 0.05, "grey30", "grey75"), 
        ylab = "RWI", xlab = "Superposed Epoch")
</code></pre>

<hr>
<h2 id='seg.plot'> Segment Plot </h2><span id='topic+seg.plot'></span>

<h3>Description</h3>

<p>Makes a segment plot of tree-ring data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seg.plot(rwl, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seg.plot_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="seg.plot_+3A_...">...</code></td>
<td>
<p> arguments to be passed to plot. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This makes a simple plot of the length of each series in a tree-ring
data set.
</p>


<h3>Value</h3>

<p>None.  This function is invoked for its side effect, which is to
produce a plot.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+spag.plot">spag.plot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
seg.plot(co021)
</code></pre>

<hr>
<h2 id='sens1'> Calculate Mean Sensitivity  </h2><span id='topic+sens1'></span>

<h3>Description</h3>

<p>This function calculates mean sensitivity of a detrended ring-width
series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  sens1(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sens1_+3A_x">x</code></td>
<td>
<p> a <code>numeric</code> vector containing the series </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates mean sensitivity according to Eq. 1 in Biondi and
Qeadan (2008).  This is the standard measure of sensitivity in
dendrochronology and is typically calculated on detrended series.
However, note that mean sensitivity is not a robust statistic and 
should rarely, if ever, be used (Bunn et al. 2013).
</p>


<h3>Value</h3>

<p> the mean sensitivity.
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela, based on original by Andy Bunn </p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) Inequality in Paleorecords.
<em>Ecology</em>, <b>89</b>(4), 1056‚Äì1067.
</p>
<p>Bunn, A. G., Jansma, E., Korpela, M., Westfall, R. D., and Baldwin,
J. (2013) Using simulations and data to evaluate mean sensitivity
(<code class="reqn">\zeta</code>) as a useful statistic in dendrochronology.
<em>Dendrochronologia</em>, <b>31</b>(3), 250‚Äì254.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+sens2">sens2</a></code>, <code><a href="#topic+rwl.stats">rwl.stats</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
sens1(ca533.rwi[, 1])
</code></pre>

<hr>
<h2 id='sens2'> Calculate Mean Sensitivity on Series with a Trend </h2><span id='topic+sens2'></span>

<h3>Description</h3>

<p>This function calculates mean sensitivity of a raw or detrended
ring-width series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  sens2(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sens2_+3A_x">x</code></td>
<td>
<p> a <code>numeric</code> vector containing the series </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates mean sensitivity according to Eq. 2 in Biondi and
Qeadan (2008).  This is a measure of sensitivity in dendrochronology
that is typically used in the presence of a trend.  However, note 
that mean sensitivity is not a robust statistic and should rarely, 
if ever, be used (Bunn et al. 2013).
</p>


<h3>Value</h3>

<p> the mean sensitivity.
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela, based on original by Andy Bunn </p>


<h3>References</h3>

<p>Biondi, F. and Qeadan, F. (2008) Inequality in Paleorecords.
<em>Ecology</em>, <b>89</b>(4), 1056‚Äì1067.
</p>
<p>Bunn, A. G., Jansma, E., Korpela, M., Westfall, R. D., and Baldwin,
J. (2013) Using simulations and data to evaluate mean sensitivity
(<code class="reqn">\zeta</code>) as a useful statistic in dendrochronology.
<em>Dendrochronologia</em>, <b>31</b>(3), 250‚Äì254.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+sens1">sens1</a></code>, <code><a href="#topic+rwl.stats">rwl.stats</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
sens2(ca533.rwi[, 1])
</code></pre>

<hr>
<h2 id='series.rwl.plot'> Plot Series and a Master </h2><span id='topic+series.rwl.plot'></span>

<h3>Description</h3>

<p>Plots a tree-ring series with a master chronology and displays
their fit, segments, and detrending options in support of the
cross-dating functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>series.rwl.plot(rwl, series, series.yrs = as.numeric(names(series)),
                seg.length = 100, bin.floor = 100, n = NULL,
                prewhiten = TRUE, biweight = TRUE, floor.plus1 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="series.rwl.plot_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as rows
such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="series.rwl.plot_+3A_series">series</code></td>
<td>
<p> a <code>numeric</code> or <code>character</code> vector.  Usually a
tree-ring series.  If the length of the value is 1, the
corresponding column of <code><var>rwl</var></code> is selected (by name or
position) as the series and ignored when building the master
chronology.  Otherwise, the value must be <code>numeric</code>. </p>
</td></tr>
<tr><td><code id="series.rwl.plot_+3A_series.yrs">series.yrs</code></td>
<td>
<p> a <code>numeric</code> vector giving the years of
<code><var>series</var></code>.  Defaults to
<code>as.numeric(names(<var>series</var>))</code>.  Ignored if
<code><var>series</var></code> is an index to a column of <code><var>rwl</var></code>. </p>
</td></tr>
<tr><td><code id="series.rwl.plot_+3A_seg.length">seg.length</code></td>
<td>
<p> an even integral value giving length of segments in
years (e.g., 20, 50, 100 years). </p>
</td></tr>
<tr><td><code id="series.rwl.plot_+3A_bin.floor">bin.floor</code></td>
<td>
<p> a non-negative integral value giving the base for
locating the first segment (e.g., 1600, 1700, 1800
<abbr><span class="acronym">AD</span></abbr>).  Typically 0, 10, 50, 100, etc. </p>
</td></tr>
<tr><td><code id="series.rwl.plot_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length
for the <code><a href="#topic+hanning">hanning</a></code> filter used for removal of low
frequency variation. </p>
</td></tr>
<tr><td><code id="series.rwl.plot_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="series.rwl.plot_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>. </p>
</td></tr>
<tr><td><code id="series.rwl.plot_+3A_floor.plus1">floor.plus1</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code>, one year is
added to the base location of the first segment (e.g., 1601, 1701,
1801 <abbr><span class="acronym">AD</span></abbr>). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is typically invoked to produce four plots showing the
effect of the detrending options <code><var>n</var></code> and
<code><var>prewhiten</var></code> and the binning options <code><var>seg.length</var></code>
and <code><var>bin.floor</var></code>.
</p>

<dl>
<dt>Plot 1</dt><dd><p>Time series plot of the filtered series and the
master</p>
</dd>
<dt>Plot 2</dt><dd><p>Scatterplot of series vs. master</p>
</dd>
<dt>Plot 3</dt><dd><p>Segments that would be used in the other cross-dating
functions (e.g., <code><a href="#topic+corr.series.seg">corr.series.seg</a></code>)</p>
</dd>
<dt>Plot 4</dt><dd><p>Text giving the detrending options and the time span
of the raw and filtered series and master</p>
</dd>
</dl>

<p>The series and master are returned as well.
</p>
<p>See help pages for  <code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code>,
<code><a href="#topic+corr.series.seg">corr.series.seg</a></code>, and  <code><a href="#topic+ccf.series.rwl">ccf.series.rwl</a></code> for
more information on these arguments.
</p>


<h3>Value</h3>

<p>A <code>list</code> containing the filtered vectors <code><var>series</var></code> and
<code><var>master</var></code>.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

<p><code><a href="#topic+corr.rwl.seg">corr.rwl.seg</a></code>, <code><a href="#topic+corr.series.seg">corr.series.seg</a></code>,
<code><a href="#topic+ccf.series.rwl">ccf.series.rwl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
foo &lt;- series.rwl.plot(rwl = co021, series = "646244", seg.length = 100,
                       n = 5)
## note effect of n on first year in the series
foo &lt;- series.rwl.plot(rwl = co021, series = "646244", seg.length = 100,
                       n = 13, prewhiten = FALSE)
bar &lt;- series.rwl.plot(rwl = co021, series = "646244", seg.length = 100,
                       n = 7, prewhiten = FALSE)
head(foo$series)
head(bar$series)
</code></pre>

<hr>
<h2 id='sgc'>Synchronous Growth Changes </h2><span id='topic+sgc'></span>

<h3>Description</h3>

<p>This function calculates the synchronous growth changes (sgc), semi synchronous growth changes (ssgc) and the length of the compared overlap for a given set of tree-ring records. Optionally the probability of exceedence is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  sgc(x,overlap = 50, prob = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sgc_+3A_x">x</code></td>
<td>
<p> a <code>data.frame</code> of tree-ring data with records in columns, and years as rows. </p>
</td></tr>
<tr><td><code id="sgc_+3A_overlap">overlap</code></td>
<td>
<p> integer value with minimal length of overlapping growth changes (compared number of tree rings - 1). Comparisons with less overlap are not compared.</p>
</td></tr>
<tr><td><code id="sgc_+3A_prob">prob</code></td>
<td>
<p>if <code>TRUE</code> then the probability of exceedence of the sgc will be calculated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sgc is a non parametric test based on sign tests.The synchronous growth changes (sgc) and semi synchronous growth changes (ssgc) are meant to replace the Gleichl√§ufigkeit (<code><a href="#topic+glk">glk()</a></code>), since the Gleichl√§ufigkeit can be (strongly) influenced by years when one of the compared series shows no growth change. The sgc gives a better description of the similarity (Visser, 2020). The ssgc gives the percentage years that one of the compared series shows no growth change. This function implements sgc and ssgc as the vectorized pairwise comparison of all records in data set. 
</p>
<p>The probability of exceedence (p) for the sgc expresses the chance that the sgc is incorrect. The observed value of the sgc is converted to a z-score and based on the standard normal curve the probability of exceedence is calculated (Visser 2020). The result is a matrix of all p-values.
</p>


<h3>Value</h3>

<p>A <code>list</code> with three or four matrices (p_mat is optional if <code>prob = TRUE</code>):
</p>

<ol>
<li><p> sgc_mat: <code>matrix</code> with synchronous growth changes (sgc) for all possible combinations of records
</p>
</li>
<li><p> ssgc_mat: <code>matrix</code> with semi-synchronous growth changes (ssgc) for all possible combinations of records
</p>
</li>
<li><p> overlap: <code>matrix</code> with number of overlapping growth changes.This is the number of overlapping years minus one.
</p>
</li>
<li><p> p_mat: <code>matrix</code> of all probabilities of exceedence for all observed sgc values.
</p>
</li></ol>

<p>The matrices can be extracted from the list by selecting the name or the index number. Comparisons are only compared if the overlap is above the set theshold and if no threshold is set, this defaults to 50 years.If no comparison can be compared, <code>NA</code> is returned.
</p>
<p>To calculate the global sgc of the dataset (assuming <code>x.sgc &lt;- sgc(x)</code>: <code>mean(x.sgc$sgc_mat, na.rm = TRUE))</code>. For the global ssgc use: <code>mean(x.sgc$ssgc_mat, na.rm = TRUE)</code>.
</p>


<h3>Author(s)</h3>

<p> Ronald Visser</p>


<h3>References</h3>

<p>Visser, R.M. (2020) On the similarity of tree-ring patterns: Assessing the influence of semi-synchronous growth changes on the Gleichl√§ufigkeit for big tree-ring data sets,<em>Archaeometry</em>, <b>63</b>, 204-215 DOI: https://doi.org/10.1111/arcm.12600
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glk">glk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library(dplR)
  data(ca533)
  ca533.sgclist &lt;- sgc(ca533)
  mean(ca533.sgclist$sgc_mat, na.rm = TRUE)
  mean(ca533.sgclist$ssgc_mat, na.rm = TRUE)
</code></pre>

<hr>
<h2 id='skel.plot'> Skeleton Plot </h2><span id='topic+skel.plot'></span>

<h3>Description</h3>

<p>Automatically generates a skeleton plot of tree-ring data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skel.plot(rw.vec, yr.vec = NULL, sname = "", filt.weight = 9,
          dat.out = FALSE, master = FALSE, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skel.plot_+3A_rw.vec">rw.vec</code></td>
<td>
<p> a <code>numeric</code> vector of a tree-ring chronology or
series </p>
</td></tr>
<tr><td><code id="skel.plot_+3A_yr.vec">yr.vec</code></td>
<td>
<p> optional <code>numeric</code> vector giving years for the
tree-ring data </p>
</td></tr>
<tr><td><code id="skel.plot_+3A_sname">sname</code></td>
<td>
<p> an optional <code>character</code> string giving the
<abbr><span class="acronym">ID</span></abbr> for the data.  The width of the string, often identical
to the number of characters, must be less than 8. </p>
</td></tr>
<tr><td><code id="skel.plot_+3A_filt.weight">filt.weight</code></td>
<td>
<p> filter length for the Hanning filter, defaults to 9 </p>
</td></tr>
<tr><td><code id="skel.plot_+3A_dat.out">dat.out</code></td>
<td>
 <p><code>logical</code> flag indicating whether to return a
<code>data.frame</code> containing the data. </p>
</td></tr>
<tr><td><code id="skel.plot_+3A_master">master</code></td>
<td>
 <p><code>logical</code> flag indicating whether to make the plot
with the segments inverted to ease pattern matching.  If <code>TRUE</code>
the segments will be plotted from the top down and the labels on the
x axes will be on the bottom. </p>
</td></tr>
<tr><td><code id="skel.plot_+3A_plot">plot</code></td>
<td>
 <p><code>logical</code> flag indicating whether to make a plot. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This makes a skeleton plot ‚Äì a plot that gives the relative growth for
year <code><var>t</var></code> relative to years <code><var>t</var>-1</code> and
<code><var>t</var>+1</code>.  Note that this plot is a standard plot in
dendrochronology and typically made by hand for visually cross-dating
series.  This type of plot might be confusing to those not accustomed
to visual cross-dating.  See references for more information.  The
implementation is based on Meko‚Äôs (2002) skeleton plotting approach.
</p>
<p>The skeleton plot is made by calculating departures from high
frequency growth for each year by comparing year <code><var>t</var></code> to the
surrounding three years
(<code><var>t</var>-1</code>,<code><var>t</var></code>,<code><var>t</var>+1</code>).  Low frequency
variation is removed using a <code><a href="#topic+hanning">hanning</a></code> filter.  Relative
growth is scaled from one to ten but only values greater than three
are plotted.  This function‚Äôs primary effect is to create plot with
absolute units that can be printed and compared to other plots.  Here,
anomalous growth is plotted on a 2mm grid and up to 120 years are
plotted on a single row with a maximum of 7 rows (840 years).  These
plots are designed to be plotted on standard paper using an
appropriate <code>device</code>, e.g., <code>postscript</code> with defaults or to
<code>pdf</code> with plot width and height to accommodate a landscape plot,
e.g., <code><var>width</var> = 10</code>, <code><var>height</var> = 7.5</code>,
<code><var>paper</var> = "USr"</code>.  These plots are designed to be printable
and cut into strips to align long series.  Statistical cross-dating is
possible if the data are output but more easily done using the functions
<code><a href="#topic+xskel.plot">xskel.plot</a></code> and <code><a href="#topic+xskel.ccf.plot">xskel.ccf.plot</a></code>.
</p>


<h3>Value</h3>

<p>This function is invoked primarily for its side effect, which is to
produce a plot.  If <code><var>dat.out</var></code> is <code>TRUE</code> then a
<code>data.frame</code> is returned with the years and height of the
skeleton plot segments as columns.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Stokes, M. A. and Smiley, T. L. (1968) <em>An Introduction to
Tree-Ring Dating</em>.  The University of Arizona Press.
<abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-8165-1680-3.
</p>
<p>Sheppard, P. R. (2002) Crossdating Tree Rings Using Skeleton Plotting.
<a href="https://www.ltrr.arizona.edu/skeletonplot/introcrossdate.htm">https://www.ltrr.arizona.edu/skeletonplot/introcrossdate.htm</a>.
</p>
<p>Meko, D. (2002) Tree-Ring MATLAB Toolbox.
<a href="https://www.mathworks.com/matlabcentral/">https://www.mathworks.com/matlabcentral/</a>.
</p>


<h3>See Also</h3>

  <p><code><a href="grDevices.html#topic+Devices">Devices</a></code>, <code><a href="#topic+hanning">hanning</a></code>,
<code><a href="#topic+xskel.plot">xskel.plot</a></code>, <code><a href="#topic+xskel.ccf.plot">xskel.ccf.plot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
x &lt;- co021[,33]
x.yrs &lt;- time(co021)
x.name &lt;- colnames(co021)[33]
## On a raw ring width series - undated
skel.plot(x)
## On a raw ring width series - dated with names
skel.plot(x, yr.vec = x.yrs, sname = x.name, master = TRUE)
## Not run: 
library(grDevices)
## Try cross-dating
y &lt;- co021[, 11]
y.yrs &lt;- time(co021)
y.name &lt;- colnames(co021)[11]

## send to postscript - 3 pages total
fname1 &lt;- tempfile(fileext=".ps")
print(fname1) # tempfile used for PS output
postscript(fname1)
## "Master series" with correct calendar dates
skel.plot(x, yr.vec = x.yrs, sname = x.name, master = TRUE)
## Undated series, try to align with last plot
skel.plot(y)
## Here's the answer...
skel.plot(y, yr.vec = y.yrs, sname = y.name)
dev.off()

unlink(fname1) # remove the PS file

## alternatively send to pdf
fname2 &lt;- tempfile(fileext=".pdf")
print(fname2) # tempfile used for PDF output
pdf(fname2, width = 10, height = 7.5, paper = "USr")
skel.plot(x, yr.vec = x.yrs, sname = x.name, master = TRUE)
skel.plot(y)
skel.plot(y, yr.vec = y.yrs, sname = y.name)
dev.off()

unlink(fname2) # remove the PDF file

## End(Not run)
</code></pre>

<hr>
<h2 id='spag.plot'> Spaghetti Plot </h2><span id='topic+spag.plot'></span>

<h3>Description</h3>

<p>Makes a spaghetti plot of tree-ring data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spag.plot(rwl, zfac = 1, useRaster = FALSE, res = 150, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spag.plot_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="spag.plot_+3A_zfac">zfac</code></td>
<td>
<p> a multiplier for <code><var>rwl</var></code> to enhance clarity when
plotting. </p>
</td></tr>
<tr><td><code id="spag.plot_+3A_useraster">useRaster</code></td>
<td>
<p>A <code>logical</code> flag.  If <code>TRUE</code>, the tree-ring
series are drawn as a raster image.  Other parts of the plot are
not affected.  Other choices are <code>NA</code> (automatic) and
<code>FALSE</code> (use vector graphics, the default).  See
<code><a href="#topic+wavelet.plot">wavelet.plot</a></code>.  </p>
</td></tr>
<tr><td><code id="spag.plot_+3A_res">res</code></td>
<td>
<p>A <code>numeric</code> vector of length 1.  The resolution
(pixels per inch) of the tree-ring series when a raster image is
used. </p>
</td></tr>
<tr><td><code id="spag.plot_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <code><a href="graphics.html#topic+lines">lines</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This makes a simple plot of each series in a tree-ring data set.  Each
series is centered first by subtracting the column mean using
<code><a href="base.html#topic+scale">scale</a></code>.  The plot can be grossly tuned with
<code><var>zfac</var></code> which is a multiplier to <code><var>rwl</var></code> before
plotting and centering.
</p>


<h3>Value</h3>

<p>None.  This function is invoked for its side effect, which is to
produce a plot.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+seg.plot">seg.plot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
plot(co021,plot.type = "spag")
spag.plot(co021, zfac = 2)
</code></pre>

<hr>
<h2 id='ssf'> Simple Signal Free Standardization </h2><span id='topic+ssf'></span>

<h3>Description</h3>

<p>A simple implentation of the signal-free chronology
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssf(rwl, 
    method="Spline", 
    nyrs = NULL, 
    difference = FALSE,
    max.iterations = 25, 
    mad.threshold = 5e-4,
    recode.zeros = FALSE,
    return.info = FALSE, 
    verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ssf_+3A_rwl">rwl</code></td>
<td>
<p> a <code>rwl</code> object with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. See &lsquo;Details&rsquo;. </p>
</td></tr>
<tr><td><code id="ssf_+3A_method">method</code></td>
<td>
<p> a <code>character</code> vector to determine the detrending
method.  See &lsquo;Details&rsquo; below.  Possible values are <br /> <code>c("Spline", "AgeDepSpline")</code>.</p>
</td></tr>
<tr><td><code id="ssf_+3A_nyrs">nyrs</code></td>
<td>
<p> a number controlling the smoothness of the
fitted curve in methods. See &lsquo;Details&rsquo; in <code><a href="#topic+detrend.series">detrend.series</a></code>.</p>
</td></tr>
<tr><td><code id="ssf_+3A_difference">difference</code></td>
<td>
<p> a <code>logical</code> flag.  Compute residuals by subtraction 
if TRUE, otherwise use division. See &lsquo;Details&rsquo; 
in <code><a href="#topic+detrend.series">detrend.series</a></code> </p>
</td></tr>
<tr><td><code id="ssf_+3A_max.iterations">max.iterations</code></td>
<td>
<p> a <code>numeric</code>. The maximum number of iterations to be used in the fitting process. See &lsquo;Details&rsquo;. </p>
</td></tr>
<tr><td><code id="ssf_+3A_mad.threshold">mad.threshold</code></td>
<td>
<p> a <code>numeric</code>. The median absolute difference threshold used for a stopping criteria. See &lsquo;Details&rsquo;. </p>
</td></tr>
<tr><td><code id="ssf_+3A_recode.zeros">recode.zeros</code></td>
<td>
<p> a <code>logical</code> flag.  Replace values of zero in <code>rwl</code> with 0.001 if TRUE. </p>
</td></tr>
<tr><td><code id="ssf_+3A_return.info">return.info</code></td>
<td>
<p> a <code>logical</code> flag.  If <code>TRUE</code>, details
about models and data will be added to the return value.  See
&lsquo;Value&rsquo;. </p>
</td></tr>
<tr><td><code id="ssf_+3A_verbose">verbose</code></td>
<td>
<p> a <code>logical</code> flag.  Write out details to the screen? </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a simple signal-free chronology that loosely follows the procedures laid out on p75 of Melvin and Briffa (2008). This function is a lighter version of that procedure and users who want more control and refinement should look to the CRUST program decried in Melvin and Briffa (2014). These steps are described in more detail in <a href="https://opendendro.github.io/dplR-workshop/">Learning to Love R</a>.
</p>
 
<ol>
<li><p> Detrend each series using the selected method, calculate RWI by division (or subtraction), and create an initial mean-value chronology.
</p>
</li>
<li><p> Create signal-free measurements by dividing (or subtracting) each series of measurements by the chronology. If <code>return.info</code> is invoked these are returned in <code>sfRW_Array</code>.
</p>
</li>
<li><p> Rescale the signal-free measurements to their original mean. If <code>return.info</code> is invoked these are returned in <code>sfRWRescaled_Array</code>.
</p>
</li>
<li><p> If the sample depth is one, replace signal-free measurements with original measurements.
</p>
</li>
<li><p> Fit curves to signal free measurements.If <code>return.info</code> is invoked these are returned in <code>sfRWRescaledCurves_Array</code>.
</p>
</li>
<li><p> Get new growth indicies by dividing (or subtracting) the original measurements by curves in the last step. If <code>return.info</code> is invoked these are returned in <code>sfRWI_Array</code>.
</p>
</li>
<li><p> Create a mean-value chronology using the indicies from the prior step. If <code>return.info</code> is invoked these are returned in <code>sfCrn_Mat</code>.
</p>
</li>
<li><p> Repeat steps two through seven up to <code>maxIter</code> or until the <code>madThreshold</code> is reached. The stopping criteria is determined using the absolute difference between filtered chronologies generated in interation k and k-1. This is done with the residuals of a high-pass filter on the chronology using a cubic smoothing spline (<code><a href="#topic+caps">caps</a></code>) with the stiffness set as the median of the segment lengths of series contributing to the chronology. The stopping threshold is calculated as the median absolute difference of the kth and kth-1 chronologies weighted by the normalized sample depth. If <code>return.info</code> is invoked the residual chronologies are returned in <code>hfCrnResids_Mat</code> and the median absolute differences are returns in <code>MAD_Vec</code>.
</p>
</li></ol>

<p>The input object (<code>rwl</code>) should be of <code>class</code> <code>rwl</code>. If it not, the function will attempt to coerce it using <code><a href="#topic+as.rwl">as.rwl</a></code> and a warning will be issued.
</p>
<p>See the references below for further details on detrending. It's a dark art.
</p>


<h3>Value</h3>

<p>An object of of class <code>crn</code> and <code>data.frame</code> with the signal-free chronology and the sample depth. The years are stored as row numbers.
</p>
<p>If <code>return.info</code> is <code>TRUE</code> a <code>list</code> containing ouptput by iteration (k): 
</p>
<table role = "presentation">
<tr><td><code>infoList</code></td>
<td>
<p> a <code>list</code> with information on the arguments used in the function call. </p>
</td></tr> 
<tr><td><code>k</code></td>
<td>
<p>a <code>numeric</code> containing the number of iterations. </p>
</td></tr>
<tr><td><code>ssfCrn</code></td>
<td>
<p> the signal-free chronology as above. </p>
</td></tr> 
<tr><td><code>sfRW_Array</code></td>
<td>
<p> an <code>array</code> of years by series by iteration (0:k) that holds the signal free measurements. The values in <code>sfRW_Array[,,1]</code> are what is used at the start of the iterative process (iteration 0) which here are the original data.</p>
</td></tr>     
<tr><td><code>sfRWRescaled_Array</code></td>
<td>
<p> an <code>array</code> of years by series by iteration (0:k) that holds the rescaled signal free measurements. The values in <code>sfRWRescaled_Array[,,1]</code> are what is used at the start of the iterative process (iteration 0) which here are the original data.</p>
</td></tr>     
<tr><td><code>sfRWRescaledCurves_Array</code></td>
<td>
<p> an <code>array</code> of years by series by iteration (0:k) that holds the rescaled signal free curve fits. The values in <code>sfRWRescaledCurves_Array[,,1]</code> are the curves used at the start of the iterative process (iteration 0).</p>
</td></tr>     
<tr><td><code>sfRWI_Array</code></td>
<td>
<p> an <code>array</code> of years by series by iteration (0:k) that holds the detrended signal free measurements. The values in <code>sfRWI_Array[,,1]</code> are the RWI values at the start of the iterative process (iteration 0).</p>
</td></tr>     
<tr><td><code>sfCrn_Mat</code></td>
<td>
<p> a <code>matrix</code> of years by iteration (0:k) that holds the calculated chronology. The values in <code>sfCrn_Mat[,1]</code> is the initial chronology from the start of the iterative process (iteration 0).</p>
</td></tr>     
<tr><td><code>hfCrn_Mat</code></td>
<td>
<p> a <code>matrix</code> of years by iteration (0:k) that holds the calculated high-frequency chronology. The values in <code>hfCrn_Mat[,1]</code> is the initial high-frequency chronology from the start of the iterative process (iteration 0).</p>
</td></tr>     
<tr><td><code>hfCrnResids_Mat</code></td>
<td>
<p> a <code>matrix</code> of years by k-1 that holds the differences between the kth and the kth-1 high frequency chronology residuals. </p>
</td></tr>   
<tr><td><code>MAD_out</code></td>
<td>
<p> a <code>vector</code> containing the median absolute difference between iteration k and k-1. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ed Cook provided Fortran code that was ported to R by Andy Bunn. </p>


<h3>References</h3>

<p>Melvin, TM, Briffa, KR (2008) A 'signal-free' approach to dendroclimatic standardisation. Dendrochronologia 26: 71‚Äì86 doi: 10.1016/j.dendro.2007.12.001
</p>
<p>Melvin T. M. and Briffa K.R. (2014a) CRUST: Software for the implementation of Regional Chronology Standardisation: Part 1. Signal-Free RCS. Dendrochronologia 32, 7-20, doi: 10.1016/j.dendro.2013.06.002
</p>
<p>Melvin T. M. and Briffa K.R. (2014b) CRUST: Software for the implementation of Regional Chronology Standardisation: Part 2. Further RCS options and recommendations. Dendrochronologia 32, 343-356, doi: 10.1016/j.dendro.2014.07.008
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+detrend">detrend</a></code>. <code><a href="#topic+chron">chron</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)
data(wa082)
wa082_SSF &lt;- ssf(wa082)
plot(wa082_SSF,add.spline=TRUE,nyrs=20)

wa082_SSF_Full &lt;- ssf(wa082,method = "AgeDepSpline", 
  difference = TRUE, return.info = TRUE)
plot(wa082_SSF_Full$ssfCrn,add.spline=TRUE,nyrs=20)

</code></pre>

<hr>
<h2 id='sss'> Subsample Signal Strength </h2><span id='topic+sss'></span>

<h3>Description</h3>

<p>Calculate subsample signal strength on a
<code>data.frame</code> of (usually) ring-width indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sss(rwi, ids = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sss_+3A_rwi">rwi</code></td>
<td>
<p> a <code>data.frame</code> with detrended and standardized ring
width indices as columns and years as rows such as that produced by
<code><a href="#topic+detrend">detrend</a></code>. </p>
</td></tr>
<tr><td><code id="sss_+3A_ids">ids</code></td>
<td>
<p> an optional <code>data.frame</code> with column one named
<code>"tree"</code> giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr> for each tree and
column two named <code>"core"</code> giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr>
for each core.  Defaults to one core per tree as<br />
<code>data.frame(tree=1:ncol(<var>rwi</var>), core=rep(1, ncol(<var>rwi</var>)))</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates subsample signal strength (sss) following equation 3.50 in Cook and Kairiukstis (1990) but using notation from Buras (2017) because writing the prime unicode symbol seems too difficult. The function calls <code><a href="#topic+rwi.stats">rwi.stats</a></code> and passes it the arguments <code>ids</code> and <code>prewhiten</code>. 
</p>
<p>To make better use of variation in growth within and between series, an appropriate mask (parameter <code><var>ids</var></code>) should be provided that identifies each series with a tree as it is common for dendrochronologists to take more than one core per tree.  The function <code><a href="#topic+read.ids">read.ids</a></code> is helpful for creating a mask based on the series <abbr><span class="acronym">ID</span></abbr>.
</p>
<p>Subsample signal strength is calculated as <code class="reqn">\frac{n[1+(N-1)\bar{r}]}{N[1+(n-1)\bar{r}]}</code> where <code>n</code> and <code>N</code> are the number of cores or trees in the subsample and sample respectively and <code>rbar</code> is mean interseries correlation. If there is only one core per tree <code>n</code> is the sample depth in a given year (<code>rowSums(!is.na(rwi))</code>), <code>N</code> is the number of cores (<code>n.cores</code> as given by <code><a href="#topic+rwi.stats">rwi.stats</a></code>), and <code>rbar</code> is the mean interseries correlation between all series (<code>r.bt</code> as given by <code><a href="#topic+rwi.stats">rwi.stats</a></code>). If there are multiple cores per tree <code>n</code> is the number of trees present in a given year, <code>N</code> is the number of trees (<code>n.trees</code> as given by <code><a href="#topic+rwi.stats">rwi.stats</a></code>), and <code>rbar</code> is the effective mean interseries correlation (<code>r.eff</code> as given by <code><a href="#topic+rwi.stats">rwi.stats</a></code>).
</p>
<p>Readers interested in the differences between subsample signal strength and the more commonly used (running) expressed population signal should look at Buras (2017) on the common misuse of the expressed population signal as well as Cook and Pederson (2011) for a more general approach to categorizing variability in tree-ring data.
</p>


<h3>Value</h3>

<p> A <code>numeric</code> containing the subsample signal strength that is the same as number if rows of<code>rwi</code>. 
</p>


<h3>Author(s)</h3>

<p>Andy Bunn. Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Buras, A. (2017) A comment on the Expressed Population Signal. Dendrochronologia 44:130-132. 
</p>
<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences</em>.
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Cook, E. R. and Pederson, N. (2011) Uncertainty, Emergence, and
Statistics in Dendrochronology.  In Hughes, M. K., Swetnam, T. W., and
Diaz, H. F., editors, <em>Dendroclimatology: Progress and
Prospects</em>, pages 77‚Äì112.  Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>:
978-1-4020-4010-8.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rwi.stats">rwi.stats</a></code>, <code><a href="#topic+read.ids">read.ids</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ca533)
ca533.rwi &lt;- detrend(ca533,method="Spline")
# assuming 1 core / tree
ca533.sss &lt;- sss(ca533.rwi)

ca533.ids &lt;- autoread.ids(ca533)
# done properly with &gt;=1 core / tree as per the ids
ca533.sss2 &lt;- sss(ca533.rwi,ca533.ids)

yr &lt;- time(ca533)
plot(yr,ca533.sss,type="l",ylim=c(0.4,1),
     col="darkblue",lwd=2,xlab="Year",ylab="SSS")
lines(yr,ca533.sss2,lty="dashed",
      col="darkgreen",lwd=2)

# Plot the chronology showing a potential cutoff year based on SSS
# (using sss2 with the correct series IDs to get &gt;=1 core / tree as per the ids)
ca533.crn &lt;- chron(ca533.rwi)
def.par &lt;- par(no.readonly=TRUE)
par(mar = c(2, 2, 2, 2), mgp = c(1.1, 0.1, 0), tcl = 0.25, xaxs='i')
plot(yr, ca533.crn[, 1], type = "n", xlab = "Year",
     ylab = "RWI", axes=FALSE)
cutoff &lt;- max(yr[ca533.sss2 &lt; 0.85])
xx &lt;- c(500, 500, cutoff, cutoff)
yy &lt;- c(-1, 3, 3, -1)
polygon(xx, yy, col = "grey80")
abline(h = 1, lwd = 1.5)
lines(yr, ca533.crn[, 1], col = "grey50")
lines(yr, caps(ca533.crn[, 1], nyrs = 32), col = "red", lwd = 2)
axis(1); axis(2); axis(3);
par(new = TRUE)
## Add SSS
plot(yr, ca533.sss2, type = "l", xlab = "", ylab = "",
     axes = FALSE, col = "blue")
abline(h=0.85,col="blue",lty="dashed")
axis(4, at = pretty(ca533.sss2))
mtext("SSS", side = 4, line = 1.1, lwd=1.5)
box()
par(def.par)

</code></pre>

<hr>
<h2 id='strip.rwl'>Chronology Stripping by <abbr><span class="acronym">EPS</span></abbr></h2><span id='topic+strip.rwl'></span>

<h3>Description</h3>

<p><abbr><span class="acronym">EPS</span></abbr>-based chronology stripping after Fowler &amp; Boswijk 2003.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strip.rwl(rwl, ids = NULL, verbose = FALSE, comp.plot = FALSE,
          legacy.eps = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strip.rwl_+3A_rwl">rwl</code></td>
<td>
<p>a <code>data.frame</code> of raw tree-ring widths series, such as
that produced by <code><a href="#topic+read.rwl">read.rwl</a></code> or <code><a href="#topic+read.fh">read.fh</a></code></p>
</td></tr>
<tr><td><code id="strip.rwl_+3A_ids">ids</code></td>
<td>
<p> an optional <code>data.frame</code> with column one named
<code>"tree"</code> giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr> for each tree and
column two named <code>"core"</code> giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr>
for each core.  This is passed on to <code><a href="#topic+rwi.stats">rwi.stats</a></code>.  See
its manual for the meaning of the default value <code>NULL</code> and more
information. </p>
</td></tr>
<tr><td><code id="strip.rwl_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> flag, indicating if the <abbr><span class="acronym">EPS</span></abbr>
calculated at each step and other details should be printed on the
console during the chronology stripping process</p>
</td></tr>
<tr><td><code id="strip.rwl_+3A_comp.plot">comp.plot</code></td>
<td>
<p><code>logical</code> flag, indicating if a diagnostic plot
with year-wise stripped and unstripped <abbr><span class="acronym">EPS</span></abbr> should be drawn
(see details below)</p>
</td></tr>
<tr><td><code id="strip.rwl_+3A_legacy.eps">legacy.eps</code></td>
<td>
<p><code>logical</code> flag, indicating if the <abbr><span class="acronym">EPS</span></abbr>
will be calculated with <code>rwi.stats</code> (<code>FALSE</code>, the default)
or <code>rwi.stats.legacy</code> (<code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <abbr><span class="acronym">EPS</span></abbr>-based chronology stripping is implemented after
Fowler &amp; Boswijk 2003: First, all series are standardized using a
double detrending procedure with splines and frequency cutoffs of 50%
at 20 and 200 years.  Then, <abbr><span class="acronym">EPS</span></abbr> is calculated for the
chronology including all (remaining) series.  In each iteration, the
algorithm calculates leave-one-out <abbr><span class="acronym">EPS</span></abbr> values, and the
series whose removal increases overall <abbr><span class="acronym">EPS</span></abbr> the most is
discarded.  This is repeated until no further increase in
<abbr><span class="acronym">EPS</span></abbr> is gained by discarding a single series.  The procedure
is then repeated in the opposite direction, i.e., the reinsertion of
each previously removed series into the <code>data.frame</code> is
considered.  In each iteration, the series (if any) whose reinsertion
increases <abbr><span class="acronym">EPS</span></abbr> the most is reinserted.  As a last step,
<abbr><span class="acronym">EPS</span></abbr> is calculated for each year of the stripped and original
chronology including all series.  If <code>comp.plot</code> is set to
<code>TRUE</code>, a diagnostic plot is shown for the year-wise comparison.
</p>
<p>When verbose output is chosen, the <abbr><span class="acronym">EPS</span></abbr> values for all
leave-one-out (or back-in) chronologies are reported.  If discarding
or re-inserting a single series leads to an improvement in
<abbr><span class="acronym">EPS</span></abbr>, this series is marked with an asterisk.
</p>


<h3>Value</h3>

<p>The functions returns a <code>data.frame</code> of raw tree-ring widths,
where series that do not contribute to an overall improvement in
<abbr><span class="acronym">EPS</span></abbr> are left out.
</p>


<h3>Author(s)</h3>

<p>Christian Zang.  Patched and improved by Mikko Korpela.
</p>


<h3>References</h3>

<p>Fowler, A. and Boswijk, G. (2003) Chronology stripping as a tool for
enhancing the statistical quality of tree-ring
chronologies. <em>Tree-Ring Research</em>, <b>59</b>(2), 53‚Äì62.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rwi.stats">rwi.stats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(anos1)
anos1.ids &lt;- read.ids(anos1, stc = c(4, 3, 1))
srwl &lt;- strip.rwl(anos1, ids = anos1.ids, verbose = TRUE)
tail(srwl)
</code></pre>

<hr>
<h2 id='tbrm'> Calculate Tukey's Biweight Robust Mean </h2><span id='topic+tbrm'></span>

<h3>Description</h3>

<p>This calculates a robust average that is unaffected by outliers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tbrm(x, C = 9)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tbrm_+3A_x">x</code></td>
<td>
<p> a <code>numeric</code> vector </p>
</td></tr>
<tr><td><code id="tbrm_+3A_c">C</code></td>
<td>
<p> a constant.  <code><var>C</var></code> is preassigned a value of 9
according to the Cook reference below but other values are
possible. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a one step computation that follows the Affy whitepaper below,
see page 22.  This function is called by <code><a href="#topic+chron">chron</a></code> to
calculate a robust mean.  <code><var>C</var></code> determines the point at which
outliers are given a weight of 0 and therefore do not contribute to
the calculation of the mean.  <code><var>C</var> = 9</code> sets values roughly
+/-6 standard deviations to 0.  <code><var>C</var> = 6</code> is also used in
tree-ring chronology development.  Cook and Kairiukstis (1990) have
further details.
</p>
<p>An exact summation algorithm (Shewchuk 1997) is used.  When some
assumptions about the rounding of floating point numbers and
conservative compiler optimizations hold, summation error is
completely avoided.  Whether the assumptions hold depends on the
platform, i.e. compiler and <abbr><span class="acronym">CPU</span></abbr>.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> mean.
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela </p>


<h3>References</h3>

<p>Statistical Algorithms Description Document, 2002, Affymetrix.
</p>
<p>Cook, E. R. and Kairiukstis, L. A., editors (1990) <em>Methods of
Dendrochronology: Applications in the Environmental Sciences.</em>
Springer.  <abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-7923-0586-6.
</p>
<p>Mosteller, F. and Tukey, J. W. (1977) <em>Data Analysis and
Regression: a second course in statistics</em>.  Addison-Wesley.
<abbr><span class="acronym">ISBN-13</span></abbr>: 978-0-201-04854-4.
</p>
<p>Shewchuk, J. R. (1997) Adaptive precision floating-point arithmetic
and fast robust geometric predicates.  <em>Discrete and
Computational Geometry</em>, <b>18</b>(3), 305‚Äì363.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+chron">chron</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)
library(utils)
foo &lt;- rnorm(100)
tbrm(foo)
mean(foo)

## Compare
data(co021)
co021.rwi &lt;- detrend(co021, method = "ModNegExp")
crn1 &lt;- apply(co021.rwi, 1, tbrm)
crn2 &lt;- chron(co021.rwi)
cor(crn1, crn2[, 1])
</code></pre>

<hr>
<h2 id='time.rwl'>
Retrieve or set the time values for rwl and crn objects
</h2><span id='topic+time.rwl'></span><span id='topic+time.crn'></span><span id='topic+time+3C-'></span><span id='topic+time+3C-.rwl'></span><span id='topic+time+3C-.crn'></span>

<h3>Description</h3>

<p>Retrieve or set the time values for rwl and crn objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rwl'
time(x, ...)
## S3 method for class 'crn'
time(x, ...)
time(x) &lt;- value

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="time.rwl_+3A_x">x</code></td>
<td>
<p> An object of class <code>"rwl"</code> or an aboject of class <code>"crn"</code>.  </p>
</td></tr>
<tr><td><code id="time.rwl_+3A_...">...</code></td>
<td>
<p> Not used.  </p>
</td></tr>
<tr><td><code id="time.rwl_+3A_value">value</code></td>
<td>
<p> A <code>numeric</code> vector to assign the time. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> vector of time (typically in years) for the object. This is done via <code>as.numeric(rownames(x))</code> but has been asked for by users so many times that it is being included as a function.
</p>


<h3>Author(s)</h3>

<p>Andy Bunn
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.rwl">read.rwl</a></code>
<code><a href="#topic+read.crn">read.crn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
# extract years
co021.yrs &lt;- time(co021)
# set years -- silly example
time(co021) &lt;- co021.yrs+100
</code></pre>

<hr>
<h2 id='treeMean'>Calculate mean across cores in a tree</h2><span id='topic+treeMean'></span>

<h3>Description</h3>

<p>This function calculates the mean value for each tree in a rwl or rwi object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treeMean(rwl, ids, na.rm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="treeMean_+3A_rwl">rwl</code></td>
<td>
<p>a <code>data.frame</code> of ring widths with
<code>rownames(<var>rwl</var>)</code> containing years and <code>colnames(rwl)</code>
containing each series <abbr><span class="acronym">ID</span></abbr> such as produced by
<code><a href="#topic+read.rwl">read.rwl</a></code></p>
</td></tr>
<tr><td><code id="treeMean_+3A_ids">ids</code></td>
<td>
<p> a <code>data.frame</code> with column one named
<code>"tree"</code> giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr> for each tree and
column two named <code>"core"</code> giving a <code>numeric</code> <abbr><span class="acronym">ID</span></abbr>
for each core. </p>
</td></tr>
<tr><td><code id="treeMean_+3A_na.rm">na.rm</code></td>
<td>
 <p><code>logical</code> passed to <code><a href="base.html#topic+rowMeans">rowMeans</a></code>. Should 
missing values be removed?</p>
</td></tr>    
</table>


<h3>Details</h3>

<p>This function averages together multiple cores to give a mean value of growth.
It is very common in dendrochronology to take more than one core per tree. In
those cases it is occassionally desirable to have an average of the cores.
This function merely loops through the <code>rwl</code> object and calculates the
<code><a href="base.html#topic+rowMeans">rowMeans</a></code> for each tree. If <code>na.rm=TRUE</code> trees with &gt;1 
sample will be averaged only over the period where the samples overlap. 
If FALSE the output can vary in the number of samples. See examples.
</p>


<h3>Value</h3>

<p>An object of class <code>c("rwl", "data.frame")</code> with the mean annual value 
for each tree.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn. Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.rwl">read.rwl</a></code>, <code><a href="#topic+read.ids">read.ids</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gp.rwl)
gp.ids &lt;- read.ids(gp.rwl, stc = c(0, 2, 1))

gp.treeMean &lt;- treeMean(gp.rwl, gp.ids)
gp.treeMean2 &lt;- treeMean(gp.rwl, gp.ids, na.rm=TRUE)

# look at an example of a single tree with different averaging periods
tree40 &lt;- data.frame(gp.rwl[, c("40A","40B")],
                     gp.treeMean[, "40", drop=FALSE],
                     gp.treeMean2[, "40", drop=FALSE])
names(tree40) &lt;- c("coreA", "coreB", "treeMean1", "treeMean2")
head(tree40,50)

data(ca533)
ca533.treeMean &lt;- treeMean(ca533, autoread.ids(ca533))
# plot using S3method for class "rwl"
plot(ca533.treeMean,plot.type="spag")

</code></pre>

<hr>
<h2 id='tridas.vocabulary'>
Browse and Check Standard TRiDaS Vocabulary
</h2><span id='topic+tridas.vocabulary'></span>

<h3>Description</h3>

<p>This function can be used to browse the TRiDaS vocabulary by category.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tridas.vocabulary(category = c("dating type", "measuring method",
                      "shape", "location type", "variable", "unit",
                      "remark", "dating suffix", "presence / absence",
                      "complex presence / absence", "certainty"),
                  idx = NA, term = NA, match.exact = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tridas.vocabulary_+3A_category">category</code></td>
<td>
<p>Vocabulary category as a <code>character</code> vector of
length one.  One of <code>"dating type"</code>, <code>"measuring method"</code>,
<code>"shape"</code>, <code>"location type"</code>, <code>"variable"</code>,
<code>"unit"</code>, <code>"remark"</code>, <code>"dating suffix"</code>, 
<code>"presence / absence"</code>, <code>"complex presence / absence"</code>,
<code>"certainty"</code>.  Partial matches are allowed.</p>
</td></tr>
<tr><td><code id="tridas.vocabulary_+3A_idx">idx</code></td>
<td>
<p>A <code>numeric</code> vector.  Index to the <code>character</code>
vector containing the vocabulary of the given category.</p>
</td></tr>
<tr><td><code id="tridas.vocabulary_+3A_term">term</code></td>
<td>
<p>A <code>character</code> vector.  One or more (partial) terms to
look for in the given category.</p>
</td></tr>
<tr><td><code id="tridas.vocabulary_+3A_match.exact">match.exact</code></td>
<td>
<p>A <code>logical</code> value.  If <code>TRUE</code>, partial
matching of <code><var>term</var></code> is not used.  Defaults to
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Tree Ring Data Standard (TRiDaS) is described in Jansma et. al
(2010).  
</p>
<p>The function has four usage modes:
</p>

<ol>
<li><p> When <code><var>idx</var></code> is given, returns item number
<code><var>idx</var></code> in the given <code><var>category</var></code>.  There may be
several numbers in <code><var>idx</var></code>, in which case multiple items
are returned.
</p>
</li>
<li><p> When <code><var>term</var></code> contains one or more items and
<code><var>match.exact</var></code> is <code>TRUE</code>, checks whether any of the
terms is an exact match in the given <code><var>category</var></code>
</p>
</li>
<li><p> When <code><var>term</var></code> contains one or more items and
<code><var>match.exact</var></code> is <code>FALSE</code>, expands partial matches of
the terms in the vocabulary of the given <code><var>category</var></code>
</p>
</li>
<li><p> When only <code><var>category</var></code> is given, returns the complete
vocabulary in the given <code><var>category</var></code>
</p>
</li></ol>



<h3>Value</h3>

<table role = "presentation">
<tr><td><code>In mode 1</code></td>
<td>
<p>A <code>character</code> vector, same length as in
<code><var>idx</var></code></p>
</td></tr>
<tr><td><code>In mode 2</code></td>
<td>
<p>A <code>logical</code> value</p>
</td></tr>
<tr><td><code>In mode 3</code></td>
<td>
<p>A <code>character</code> vector, same length as in
<code><var>term</var></code></p>
</td></tr>
<tr><td><code>In mode 4</code></td>
<td>
<p>A <code>character</code> vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>References</h3>

<p>Jansma, E., Brewer, P. W., and Zandhuis, I. (2010) TRiDaS 1.1: The
tree-ring data standard.  <em>Dendrochronologia</em>, <b>28</b>(2),
99&ndash;130.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.tridas">read.tridas</a></code>, <code><a href="#topic+write.tridas">write.tridas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Show all entries in category "measuring method"
tridas.vocabulary(category = "measuring")

## Show item number one in category "complex presence / absence"
tridas.vocabulary(category = "complex", idx = 1)

## Check whether "half section" exists in category "shape"
tridas.vocabulary(category = "shape", term = "half section",
                  match.exact = TRUE)

## Return unabbreviated matches to several queries in category "remark"
tridas.vocabulary(category = "remark",
                  term = c("trauma", "fire", "diffuse"))
</code></pre>

<hr>
<h2 id='uuid.gen'>
<abbr><span class="acronym">UUID</span></abbr> Generator
</h2><span id='topic+uuid.gen'></span>

<h3>Description</h3>

<p>Initializes and returns a generator of universally unique identifiers.
Use the returned function repeatedly for creating one or more
<abbr><span class="acronym">UUID</span></abbr>s, one per function call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uuid.gen(more.state = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uuid.gen_+3A_more.state">more.state</code></td>
<td>

<p>A <code>character</code> string for altering the state of the generator
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a function (closure) which generates
<abbr><span class="acronym">UUID</span></abbr>s.  The state of that anonymous function is set when
<code>uuid.gen</code> is called.  The state consists of the following:
</p>

<ul>
<li><p> System and user information (<code><a href="base.html#topic+Sys.info">Sys.info</a></code>)
</p>
</li>
<li> <p><span class="rlang"><b>R</b></span> version (<code><a href="base.html#topic+R.version">R.version</a></code>)
</p>
</li>
<li><p> Platform information (<code><a href="base.html#topic+.Platform">.Platform</a></code>)
</p>
</li>
<li><p> Working directory
</p>
</li>
<li><p> Process <abbr><span class="acronym">ID</span></abbr> of the <span class="rlang"><b>R</b></span> session
</p>
</li>
<li><p> Time when <code>uuid.gen</code> was called (precision of seconds or
finer)
</p>
</li>
<li><p> The text in parameter <code><var>more.state</var></code>
</p>
</li></ul>

<p>The Pseudo Random Number Generator of <span class="rlang"><b>R</b></span> (see
<code><a href="base.html#topic+.Random.seed">.Random.seed</a></code>) is used in the generation of
<abbr><span class="acronym">UUID</span></abbr>s.  No initialization of the <abbr><span class="acronym">PRNG</span></abbr> is done.
Tampering with the state of the <span class="rlang"><b>R</b></span> <abbr><span class="acronym">PRNG</span></abbr> while using a given
<abbr><span class="acronym">UUID</span></abbr> generator causes a risk of non-unique identifiers.
Particularly, setting the state of the <abbr><span class="acronym">PRNG</span></abbr> to the same
value before two calls to the <abbr><span class="acronym">UUID</span></abbr> generator guarantees two
identical identifiers.  If two <abbr><span class="acronym">UUID</span></abbr> generators have a
different state, it is <em>not</em> a problem to have the <abbr><span class="acronym">PRNG</span></abbr>
going through or starting from the same state with both generators.
</p>
<p>The user is responsible for selecting a <abbr><span class="acronym">PRNG</span></abbr> with a
reasonable number of randomness.  Usually, this doesn‚Äôt require any
action.  For example, any <abbr><span class="acronym">PRNG</span></abbr> algorithm available in <span class="rlang"><b>R</b></span>
works fine.  However, the uniqueness of <abbr><span class="acronym">UUID</span></abbr>s can be
destroyed by using a bad user-supplied <abbr><span class="acronym">PRNG</span></abbr>.
</p>
<p>The <abbr><span class="acronym">UUID</span></abbr>s produced by <code>uuid.gen</code> generators are Version
4 (random) with 122 random bits and 6 fixed bits.  The <abbr><span class="acronym">UUID</span></abbr>
is presented as a <code>character</code> string of 32 hexadecimal digits and
4 hyphens:
</p>
<p>&lsquo;<span class="samp">&#8288;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&#8288;</span>&rsquo;
</p>
<p>where <var>x</var> is any hexadecimal digit and <var>y</var> is one of
<code>"8"</code>, <code>"9"</code>, <code>"a"</code>, or <code>"b"</code>.  Each <var>x</var> and
<var>y</var> in the example is an independent variables (for all practical
purposes); subscripts are omitted for clarity.  The <abbr><span class="acronym">UUID</span></abbr>
generator gets 32 hex digits from the <abbr><span class="acronym">MD5</span></abbr> message digest
algorithm by feeding it a string consisting of the constant generator
state and 5 (pseudo) random numbers.  After that, the 6 bits are fixed
and the hyphens are added to form the final <abbr><span class="acronym">UUID</span></abbr>.
</p>


<h3>Value</h3>

<p>A parameterless function which returns a single <abbr><span class="acronym">UUID</span></abbr>
(<code>character</code> string)
</p>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>References</h3>

<p>Leach, P., Mealling, M., and Salz, R. (2005) A Universally Unique
IDentifier (<abbr><span class="acronym">UUID</span></abbr>) <abbr><span class="acronym">URN</span></abbr> namespace.  <abbr><span class="acronym">RFC</span></abbr>
4122, RFC Editor.  <a href="https://www.rfc-editor.org/rfc/rfc4122.txt">https://www.rfc-editor.org/rfc/rfc4122.txt</a>.
</p>


<h3>See Also</h3>

<p><code><a href="digest.html#topic+digest">digest</a></code>, <code><a href="base.html#topic+Random">Random</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Normal use
ug &lt;- uuid.gen()
uuids &lt;- character(100)
for(i in 1:100){
  uuids[i] &lt;- ug()
}
length(unique(uuids)) == 100 # TRUE, UUIDs are unique with high probability

## Do NOT do the following unless you want non-unique IDs
rs &lt;- .Random.seed
set.seed(0L)
id1 &lt;- ug()
set.seed(0L)
id2 &lt;- ug()
id1 != id2 # FALSE, The UUIDs are the same
.Random.seed &lt;- rs

## Strange usage pattern, but will probably produce unique IDs
ug1 &lt;- uuid.gen("1")
set.seed(0L)
id1 &lt;- ug1()
ug2 &lt;- uuid.gen("2")
set.seed(0L)
id2 &lt;- ug2()
id1 != id2 # TRUE, The UUIDs are different with high probability
.Random.seed &lt;- rs
</code></pre>

<hr>
<h2 id='wa082'>Hurricane Ridge, Pacific silver fir</h2><span id='topic+wa082'></span>

<h3>Description</h3>

<p>This data set gives the raw ring widths for Pacific silver fir
<em>Abies amabilis</em> at Hurricane Ridge in Washington, <abbr><span class="acronym">USA</span></abbr>.
There are 23 series.  Data set was created using <code><a href="#topic+read.rwl">read.rwl</a></code>
and saved to an .rda file using <code><a href="base.html#topic+save">save</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wa082)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 23 tree-ring series in columns and 286
years in rows.
</p>


<h3>Source</h3>

<p>International tree-ring data bank, Accessed on 20-April-2021 at
<a href="https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/usa/wa082.rwl">https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/usa/wa082.rwl</a>
</p>


<h3>References</h3>

<p>Schweingruber, F. (1983) Hurricane Ridge Data Set.  <abbr><span class="acronym">IGBP</span></abbr>
<abbr><span class="acronym">PAGES</span></abbr>/World Data Center for Paleoclimatology Data
Contribution Series 1983-wa082.RWL.  <abbr><span class="acronym">NOAA</span></abbr>/<abbr><span class="acronym">NCDC</span></abbr>
Paleoclimatology Program, Boulder, Colorado, <abbr><span class="acronym">USA</span></abbr>.
</p>

<hr>
<h2 id='wavelet.plot'> Plot a Continuous Wavelet Transform </h2><span id='topic+wavelet.plot'></span>

<h3>Description</h3>

<p>This function creates a <code>filled.contour</code> plot of a continuous
wavelet transform as output from <code><a href="#topic+morlet">morlet</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wavelet.plot(wave.list,
             wavelet.levels = quantile(wave.list$Power,
                                       probs = (0:10)/10),
             add.coi = TRUE, add.sig = TRUE,
             x.lab = gettext("Time", domain = "R-dplR"),
             period.lab = gettext("Period", domain = "R-dplR"),
             crn.lab = gettext("RWI", domain = "R-dplR"),
             key.cols = rev(rainbow(length(wavelet.levels)-1)),
             key.lab = parse(text=paste0("\"",
                                         gettext("Power",
                                                 domain="R-dplR"),
                                         "\"^2")),
             add.spline = FALSE, f = 0.5, nyrs = NULL,
             crn.col = "black", crn.lwd = 1,coi.col='black',
             crn.ylim = range(wave.list$y) * c(0.95, 1.05),
             side.by.side = FALSE,
             useRaster = FALSE, res = 150, reverse.y = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wavelet.plot_+3A_wave.list">wave.list</code></td>
<td>
<p>A <code>list</code>.  Output from <code><a href="#topic+morlet">morlet</a></code>.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_wavelet.levels">wavelet.levels</code></td>
<td>
<p>A <code>numeric</code> vector.  Values for levels of
the filled contours for the wavelet plot.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_add.coi">add.coi</code></td>
<td>
<p>A <code>logical</code> flag.  Add cone of influence?</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_add.sig">add.sig</code></td>
<td>
<p>A <code>logical</code> flag.  Add contour lines for significance?</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_x.lab">x.lab</code></td>
<td>
<p>X-axis label.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_period.lab">period.lab</code></td>
<td>
<p>Y-axis label for the wavelet plot.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_crn.lab">crn.lab</code></td>
<td>
<p>Y-axis label for the time-series plot.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_key.cols">key.cols</code></td>
<td>
<p>A vector of colors for the wavelets and the key.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_key.lab">key.lab</code></td>
<td>
<p>Label for key.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_add.spline">add.spline</code></td>
<td>
<p>A <code>logical</code> flag.  Add a spline to the
time-series plot using <code><a href="#topic+caps">caps</a></code>?. </p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_nyrs">nyrs</code></td>
<td>
<p> A number giving the rigidity of the smoothing spline,
defaults to 0.33 of series length if <code><var>nyrs</var></code> is
<code>NULL</code>. </p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_f">f</code></td>
<td>
<p> A number between 0 and 1 giving the frequency response or
wavelength cutoff for the smoothing spline.  Defaults to 0.5. </p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_crn.col">crn.col</code></td>
<td>
<p>Line color for the time-series plot.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_crn.lwd">crn.lwd</code></td>
<td>
<p>Line width for the time-series plot.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_coi.col">coi.col</code></td>
<td>
<p>Color for the COI if <code><var>add.coi</var></code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_crn.ylim">crn.ylim</code></td>
<td>
<p>Axis limits for the time-series plot.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_side.by.side">side.by.side</code></td>
<td>
<p>A <code>logical</code> flag.  Plots will be in one row if
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_useraster">useRaster</code></td>
<td>
<p>A <code>logical</code> flag.  If <code>TRUE</code>, the filled
contours are drawn as a raster image.  Other parts of the plot are
not affected.  <code>useRaster=TRUE</code> can be especially useful when a
<code>pdf</code> device is used: the size and complexity of the
<abbr><span class="acronym">PDF</span></abbr> file will probably be greatly reduced.  Setting this
to <code>TRUE</code> has negative effects when used with a bitmap
device such as <code>png</code>.  If <code>NA</code>, plotting of a raster image
will be attempted if and only if the name of the graphics device is
<code>"pdf"</code> or <code>"postscript"</code>.  The default is <code>FALSE</code>:
draw directly to the graphics device without using an intermediate
raster image.  </p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_res">res</code></td>
<td>
<p>A <code>numeric</code> vector of length 1.  The resolution
(pixels per inch) of the filled contours when a raster image is
used.  See <code><var>useRaster</var></code>.</p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_reverse.y">reverse.y</code></td>
<td>
<p>A <code>logical</code> flag.  If <code>TRUE</code>, the Y-axis
will be reversed, i.e. period increasing towards the bottom.  The
default is <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="wavelet.plot_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="#topic+rasterPlot">rasterPlot</a></code>.  Only
relevant when the filled contours are drawn as a raster image.  See
<code><var>useRaster</var></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This produces a plot of a continuous wavelet transform and plots the
original time series.  Contours are added for significance and a cone of
influence polygon can be added as well.  Anything within the cone of
influence should not be interpreted.
</p>
<p>The time series can be plotted with a smoothing spline as well.
</p>


<h3>Value</h3>

<p>None.  This function is invoked for its side effect, which is to produce a
plot.
</p>


<h3>Note</h3>

<p> The function <code>morlet</code> is a port of Torrence‚Äôs
<abbr><span class="acronym">IDL</span></abbr> code, which can be accessed through the
<a href="https://web.archive.org/web/20141216211516/https://paos.colorado.edu/research/wavelets/software.html">Internet Archive Wayback Machine</a>.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>References</h3>

<p>Torrence, C. and Compo, G. P. (1998) A practical guide to wavelet
analysis.  <em>Bulletin of the American Meteorological Society</em>,
<b>79</b>(1), 61‚Äì78.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+morlet">morlet</a></code>, <code><a href="#topic+caps">caps</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)
library(utils)
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
ca533.crn &lt;- chron(ca533.rwi, prewhiten = FALSE)
Years &lt;- time(ca533.crn)
CAMstd &lt;- ca533.crn[, 1]
out.wave &lt;- morlet(y1 = CAMstd, x1 = Years, p2 = 9, dj = 0.1,
                   siglvl = 0.99)
wavelet.plot(out.wave, useRaster = NA)
## Not run: 
# Alternative palette with better separation of colors
# via: rev(RColorBrewer::brewer.pal(10, "Spectral"))
specCols &lt;- c("#5E4FA2", "#3288BD", "#66C2A5", "#ABDDA4", "#E6F598", 
              "#FEE08B", "#FDAE61", "#F46D43", "#D53E4F", "#9E0142")
wavelet.plot(out.wave, key.cols=specCols,useRaster = NA)

# fewer colors
levs &lt;- quantile(out.wave$Power, probs = c(0, 0.5, 0.75, 0.9, 0.99))
wavelet.plot(out.wave, wavelet.levels = levs, add.sig = FALSE,
             key.cols = c("#FFFFFF", "#ABDDA4", "#FDAE61", "#D7191C"), useRaster = NA)
             
## End(Not run)
</code></pre>

<hr>
<h2 id='wc.to.po'>
Convert Wood Completeness to Pith Offset
</h2><span id='topic+wc.to.po'></span>

<h3>Description</h3>

<p>This function creates a pith offset data structure based on wood
completeness data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wc.to.po(wc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wc.to.po_+3A_wc">wc</code></td>
<td>

<p>A <code>data.frame</code> containing wood completeness data, as returned
by <code><a href="#topic+read.tridas">read.tridas</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the sum of the variables <code><var>n.missing.heartwood</var></code> and
<code><var>n.unmeasured.inner</var></code> in <code><var>wc</var></code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing two variables.  Variable one
(<code><var>series</var></code>) gives the series <abbr><span class="acronym">ID</span></abbr> as either
<code>character</code>s or <code>factor</code>s.  These match
<code>rownames(<var>wc</var>)</code>.  Variable two (<code><var>pith.offset</var></code>) is
of <code>integer</code> type and gives the years from the beginning of the
core to the pith (or center) of the tree.  The minimum value is 1.
</p>


<h3>Author(s)</h3>

<p>Mikko Korpela
</p>


<h3>See Also</h3>

<p><code><a href="#topic+po.to.wc">po.to.wc</a></code>, <code><a href="#topic+rcs">rcs</a></code>, <code><a href="#topic+read.tridas">read.tridas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(gp.po)
all(wc.to.po(po.to.wc(gp.po)) == gp.po)
</code></pre>

<hr>
<h2 id='write.compact'> Write <abbr><span class="acronym">DPL</span></abbr> Compact Format Ring Width File </h2><span id='topic+write.compact'></span>

<h3>Description</h3>

<p>This function writes a chronology to a <abbr><span class="acronym">DPL</span></abbr> compact format
file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.compact(rwl.df, fname, append = FALSE, prec = 0.01,
              mapping.fname = "", mapping.append = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.compact_+3A_rwl.df">rwl.df</code></td>
<td>
<p> a <code>data.frame</code> containing tree-ring ring widths
with the series in columns and the years as rows.  The series
<abbr><span class="acronym">ID</span></abbr>s are the column names and the years are the row
names.  This type of <code>data.frame</code> is produced by
<code><a href="#topic+read.rwl">read.rwl</a></code> and <code><a href="#topic+read.compact">read.compact</a></code>. </p>
</td></tr>  
<tr><td><code id="write.compact_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
rwl file. </p>
</td></tr>
<tr><td><code id="write.compact_+3A_append">append</code></td>
<td>
 <p><code>logical</code> flag indicating whether to append this
chronology to an existing file. </p>
</td></tr>
<tr><td><code id="write.compact_+3A_prec">prec</code></td>
<td>
 <p><code>numeric</code> indicating the precision of the output
file.  This must be equal to either 0.01 or 0.001 (units are in
mm). </p>
</td></tr>
<tr><td><code id="write.compact_+3A_mapping.fname">mapping.fname</code></td>
<td>
<p> a <code>character</code> vector of length one giving
the file name of an optional output file showing the mapping between
input and output series <abbr><span class="acronym">ID</span></abbr>s.  The mapping is only printed
for those <abbr><span class="acronym">ID</span></abbr>s that are transformed.  An empty name (the
default) disables output. </p>
</td></tr>
<tr><td><code id="write.compact_+3A_mapping.append">mapping.append</code></td>
<td>
 <p><code>logical</code> flag indicating whether to
append the description of the altered series <abbr><span class="acronym">ID</span></abbr>s to an
existing file.  The default is to create a new file. </p>
</td></tr>
<tr><td><code id="write.compact_+3A_...">...</code></td>
<td>
<p> Unknown arguments are accepted but not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output should be readable by the Dendrochronology Program Library
(<abbr><span class="acronym">DPL</span></abbr>) as a compact format file.
</p>
<p>In series <abbr><span class="acronym">ID</span></abbr>s, letters of the English alphabet and numbers
are allowed.  Other characters will be removed.  The length of the
<abbr><span class="acronym">ID</span></abbr>s is limited to about 50 characters, depending on the
length of the other items to be placed on the header lines of the
output file.  Longer <abbr><span class="acronym">ID</span></abbr>s will be truncated.  Also any
duplicate <abbr><span class="acronym">ID</span></abbr>s will be automatically edited so that only
unique <abbr><span class="acronym">ID</span></abbr>s exist.  If series <abbr><span class="acronym">ID</span></abbr>s are changed, one
or more warnings are shown.  In that case, the user may wish to print a
list of the renamings (see Arguments).
</p>


<h3>Value</h3>

<p><code><var>fname</var></code>
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela, based on write.tucson by Andy Bunn </p>


<h3>See Also</h3>

 <p><code><a href="#topic+write.rwl">write.rwl</a></code>, <code><a href="#topic+write.tucson">write.tucson</a></code>,
<code><a href="#topic+write.tridas">write.tridas</a></code>, <code><a href="#topic+read.compact">read.compact</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
fname &lt;- write.compact(rwl.df = co021,
                       fname = tempfile(fileext=".rwl"),
                       append = FALSE, prec = 0.001)
print(fname) # tempfile used for output

unlink(fname) # remove the file
</code></pre>

<hr>
<h2 id='write.crn'> Write Tucson Format Chronology File </h2><span id='topic+write.crn'></span>

<h3>Description</h3>

<p>This function writes a chronology to a Tucson (decadal) format file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.crn(crn, fname, header = NULL, append = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.crn_+3A_crn">crn</code></td>
<td>
<p> a <code>data.frame</code> containing a tree-ring chronology with
two columns of the type produced by <code><a href="#topic+chron">chron</a></code>.  The first
column contains the mean value chronology, the second column gives
the sample depth.  Years for the chronology are determined from the
row names.  The chronology <abbr><span class="acronym">ID</span></abbr> is determined from the first
column name.</p>
</td></tr>
<tr><td><code id="write.crn_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
crn file. </p>
</td></tr>
<tr><td><code id="write.crn_+3A_header">header</code></td>
<td>
<p> a <code>list</code> giving information for the header of the
file.  If <code>NULL</code> then no header information will be written. </p>
</td></tr>
<tr><td><code id="write.crn_+3A_append">append</code></td>
<td>
 <p><code>logical</code> flag indicating whether to append this
chronology to an existing file. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This writes a standard crn file as defined according to the standards
of the <abbr><span class="acronym">ITRDB</span></abbr> at
<a href="https://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt">https://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt</a>.  This is the
decadal or Tucson format.  It is an <abbr><span class="acronym">ASCII</span></abbr> file and machine
readable by the standard dendrochronology programs.  Header information
for the chronology can be written according to the International Tree
Ring Data Bank (<abbr><span class="acronym">ITRDB</span></abbr>) standard.  The header standard is not
very reliable however and should be thought of as experimental
here.  Do not try to write headers using dplR to submit to the
<abbr><span class="acronym">ITRDB</span></abbr>.  When submitting to the <abbr><span class="acronym">ITRDB</span></abbr>, you can enter
the metadata via their website.  If you insist however, the header
information is given as a <code>list</code> and must be formatted with the
following:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <em>Description</em> </td><td style="text-align: right;"> <em>Name</em> </td><td style="text-align: right;"> <em>Class</em> </td><td style="text-align: right;"> <em>Max Width</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
    Site <abbr><span class="acronym">ID</span></abbr> </td><td style="text-align: right;"> <code><var>site.id</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 6 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Site Name </td><td style="text-align: right;"> <code><var>site.name</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 52 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Species Code </td><td style="text-align: right;"> <code><var>spp.code</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 4 </td>
</tr>
<tr>
 <td style="text-align: left;">
    State or Country </td><td style="text-align: right;"> <code><var>state.country</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 13 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Species </td><td style="text-align: right;"> <code><var>spp</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 18 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Elevation </td><td style="text-align: right;"> <code><var>elev</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 5 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Latitude </td><td style="text-align: right;"> <code><var>lat</var></code> </td><td style="text-align: right;"> <code>character</code> or <code>numeric</code> </td><td style="text-align: right;"> 5 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Longitude </td><td style="text-align: right;"> <code><var>long</var></code> </td><td style="text-align: right;"> <code>character</code> or <code>numeric</code> </td><td style="text-align: right;"> 5 </td>
</tr>
<tr>
 <td style="text-align: left;">
    First Year </td><td style="text-align: right;"> <code><var>first.yr</var></code> </td><td style="text-align: right;"> <code>character</code> or <code>numeric</code> </td><td style="text-align: right;"> 4 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Last Year </td><td style="text-align: right;"> <code><var>last.yr</var></code> </td><td style="text-align: right;"> <code>character</code> or <code>numeric</code> </td><td style="text-align: right;"> 4 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Lead Investigator </td><td style="text-align: right;"> <code><var>lead.invs</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 63 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Completion Date </td><td style="text-align: right;"> <code><var>comp.date</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 8 </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>See examples for a correctly formatted header list.  If the width of
the fields is less than the max width, then the fields will be padded
to the right length when written.  Note that <code><var>lat</var></code> and
<code><var>long</var></code> are really <code><var>lat</var>*100</code> or
<code><var>long</var>*100</code> and given as integral values.  E.g., 37 degrees
30 minutes would be given as 3750.
</p>
<p>This function takes a single chronology with sample depth as
input.  This means that it will fail if given output from
<code><a href="#topic+chron">chron</a></code> where <code><var>prewhiten</var> == TRUE</code>.  However,
more than one chronology can be appended to the bottom of an existing
file (e.g., standard and residual) with a second call to
<code><a href="#topic+write.crn">write.crn</a></code>.  However, the <abbr><span class="acronym">ITRDB</span></abbr> recommends
saving and publishing only one chronology per file.  The examples
section shows how to circumvent this.  The output from this function
might be suitable for publication on the <abbr><span class="acronym">ITRDB</span></abbr> although the
header writing is clunky (see above) and rwl files are much better
than crn files in terms of usefulness on the <abbr><span class="acronym">ITRDB</span></abbr>.
</p>


<h3>Value</h3>

<p><code><var>fname</var></code>
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+chron">chron</a></code>, <code><a href="#topic+read.crn">read.crn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
ca533.crn &lt;- chron(ca533.rwi)
fname1 &lt;- write.crn(ca533.crn, tempfile(fileext=".crn"))
print(fname1) # tempfile used for output

## Put the standard and residual chronologies in a single file
## with ITRDB header info on top. Not recommended.
ca533.crn &lt;- chron(ca533.rwi, prewhiten = TRUE)
ca533.hdr &lt;- list(site.id = "CAM", site.name = "Campito Mountain",
                  spp.code = "PILO", state.country = "California",
                  spp = "Bristlecone Pine", elev = "3400M", lat = 3730,
                  long = -11813, first.yr = 626, last.yr = 1983,
                  lead.invs = "Donald A. Graybill, V.C. LaMarche, Jr.",
                  comp.date = "Nov1983")
fname2 &lt;- write.crn(ca533.crn[, -2], tempfile(fileext=".crn"),
                    header = ca533.hdr)
write.crn(ca533.crn[, -1], fname2, append = TRUE)
print(fname2) # tempfile used for output

unlink(c(fname1, fname2)) # remove the files
</code></pre>

<hr>
<h2 id='write.rwl'> Write Chronology File </h2><span id='topic+write.rwl'></span>

<h3>Description</h3>

<p>This function writes a chronology to a file in one of the available
formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.rwl(rwl.df, fname, format = c("tucson", "compact", "tridas"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.rwl_+3A_rwl.df">rwl.df</code></td>
<td>
<p> a <code>data.frame</code> containing tree-ring ring widths
with the series in columns and the years as rows.  The series
<abbr><span class="acronym">ID</span></abbr>s are the column names and the years are the row
names.  This type of <code>data.frame</code> is produced by
<code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="write.rwl_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
rwl file. </p>
</td></tr>
<tr><td><code id="write.rwl_+3A_format">format</code></td>
<td>
<p> a <code>character</code> vector giving the format.  This must
be <code>"tucson"</code>, <code>"compact"</code>, or <code>"tridas"</code>.  Tucson
format is the default. </p>
</td></tr>
<tr><td><code id="write.rwl_+3A_...">...</code></td>
<td>
<p> arguments specific to the function implementing the
operation for the chosen format. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple wrapper to the functions actually implementing the
write operation.
</p>


<h3>Value</h3>

<p><code><var>fname</var></code>
</p>


<h3>Author(s)</h3>

<p> Mikko Korpela </p>


<h3>See Also</h3>

 <p><code><a href="#topic+write.crn">write.crn</a></code>, <code><a href="#topic+write.tucson">write.tucson</a></code>,
<code><a href="#topic+write.compact">write.compact</a></code>, <code><a href="#topic+write.tridas">write.tridas</a></code>,
<code><a href="#topic+read.rwl">read.rwl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
co021.hdr &lt;- list(site.id = "CO021",
                  site.name = "SCHULMAN OLD TREE NO. 1, MESA VERDE",
                  spp.code = "PSME", state.country = "COLORADO",
                  spp = "DOUGLAS FIR", elev = 2103, lat = 3712,
                  long = -10830, first.yr = 1400, last.yr = 1963,
                  lead.invs = "E. SCHULMAN", comp.date = "")
fname &lt;- write.rwl(rwl.df = co021, fname = tempfile(fileext=".rwl"),
                   format = "tucson", header = co021.hdr,
                   append = FALSE, prec = 0.001)
print(fname) # tempfile used for output

unlink(fname) # remove the file
</code></pre>

<hr>
<h2 id='write.tridas'> Write Tree Ring Data Standard (TRiDaS) file </h2><span id='topic+write.tridas'></span>

<h3>Description</h3>

<p> This function writes measured or derived (standardized,
averaged) series of values to a TRiDaS format file.  Some metadata are
also supported. </p>


<h3>Usage</h3>

<pre><code class='language-R'>write.tridas(rwl.df = NULL, fname, crn = NULL, prec = NULL, ids = NULL,
    titles = NULL, crn.types = NULL, crn.titles = NULL,
    crn.units = NULL, tridas.measuring.method = NA,
    other.measuring.method = "unknown", sample.type = "core",
    wood.completeness = NULL, taxon = "",
    tridas.variable = "ring width", other.variable = NA,
    project.info = list(type = c("unknown"), description = NULL,
                        title = "", category = "", investigator = "",
                        period = ""),
    lab.info = data.frame(name = "", acronym = NA, identifier = NA,
                          domain = "", addressLine1 = NA,
                          addressLine2 = NA, cityOrTown = NA,
                          stateProvinceRegion = NA, postalCode = NA,
                          country = NA),
    research.info = data.frame(identifier = NULL, domain = NULL,
                               description = NULL),
    site.info = list(type = "unknown", description = NULL, title = ""),
    random.identifiers = FALSE, identifier.domain = lab.info$name[1],
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.tridas_+3A_rwl.df">rwl.df</code></td>
<td>
 <p><code>data.frame</code> containing tree-ring ring widths in
millimetres with the series in columns and the years as rows.  The
series <abbr><span class="acronym">ID</span></abbr>s are the column names and the years are the row
names.  This type of <code>data.frame</code> is produced by
<code><a href="#topic+read.tucson">read.tucson</a></code>, <code><a href="#topic+read.compact">read.compact</a></code> and
<code><a href="#topic+read.tridas">read.tridas</a></code>.  Defaults to <code>NULL</code>: no measurement
series are written. </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_fname">fname</code></td>
<td>
 <p><code>character</code> vector giving the file name of the rwl
file </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_crn">crn</code></td>
<td>
 <p><code>data.frame</code> or a list of <code>data.frame</code>s
containing tree-ring chronologies.  Accepts <code>data.frame</code>s of
the type produced by <code><a href="#topic+chron">chron</a></code>.  Additionally, allows
several chronologies per <code>data.frame</code>.  Any column of the
<code>data.frame</code>(s) with a name starting with <code>"samp.depth"</code>
is interpreted as a sample depth.  The rest of the columns are
interpreted as chronologies whose titles are determined from the
column names (optionally from parameter <code><var>crn.titles</var></code>).
Chronology columns and sample depth columns are paired in order so
that the first chronology gets the first sample depth column, second
chronology gets the second set of sample depths, etc.  If there are
less sample depth columns than chronologies, the sample depths are
recycled.  Defaults to <code>NULL</code>: no chronologies are written. </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_prec">prec</code></td>
<td>
<p> optional <code>numeric</code> indicating the rounding precision
of the output file when writing the data contained in
<code><var>rwl.df</var></code>.  Defaults to <code>NULL</code>: no rounding is done
and the measurements are written in (non-integer) millimetres.
Possible <code>numeric</code> values are 0.001, 0.01, 0.05, 0.1, 1, 10,
100 and 1000, which cause the data to be transformed to micrometres,
1/100th millimetres, 1/20th millimetres, 1/10 millimetres,
(millimetres), centimetres, decimetres or metres, respectively, and
then rounded to integral values.  Data rounded to decimetres are
written in centimetres (values always ending in zero).  Otherwise,
the matching unit is used in the file. </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_ids">ids</code></td>
<td>
<p> optional <code>data.frame</code> with column one named
<code>"tree"</code> giving the <code>numeric</code> <abbr><span class="acronym">ID</span></abbr> of the tree,
column two named <code>"core"</code> giving the <code>numeric</code>
<abbr><span class="acronym">ID</span></abbr> of the core, optional column three named
<code>"radius"</code> giving the <code>numeric</code> <abbr><span class="acronym">ID</span></abbr> of the
radius, and optional column four named <code>"measurement"</code> giving
the <code>numeric</code> <abbr><span class="acronym">ID</span></abbr> of the measurement.  If column
<code>"measurement"</code> exists, column <code>"radius"</code> must also exist.
Defaults to one core, radius and measurement per tree:</p>
<pre>
  data.frame(tree=1:n.col, core=rep(1,n.col),
             radius=rep(1,n.col), measurement=rep(1,n.col))</pre>
<p>where <code><var>n.col</var></code> is the number of columns in
<code><var>rwl.df</var></code>. </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_titles">titles</code></td>
<td>
<p> optional <code>data.frame</code> with column one named
<code>"tree"</code> giving the title of the tree, column two named
<code>"core"</code> giving the title of the core, column three named
<code>"radius"</code> giving the title of the radius, and column four
named <code>"measurement"</code> giving the title of the measurement.  By
default, <code><var>titles</var></code> is <code>NULL</code>, and the title hierarchy
is automatically created out of the column names of
<code><var>rwl.df</var></code>, taking <code><var>ids</var></code> into account. </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_crn.types">crn.types</code></td>
<td>
 <p><code>character</code> vector or a <code>list</code> of
<code>character</code> vectors giving the types of the derived series in
<code><var>crn</var></code>.  A single vector is interpreted as one type per
<code>data.frame</code> in <code><var>crn</var></code>, recycled if not long enough.
A list of vectors is interpreted as one list element per
<code>data.frame</code>.  In this case, the list is recycled to the
correct length.  After that, the vectors inside the list are
recycled to match the number of derived series in each
<code>data.frame</code> of <code><var>crn</var></code>.  The default is to write
empty &lsquo;<span class="samp">&#8288;&lt;type&gt;&#8288;</span>&rsquo; elements. </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_crn.titles">crn.titles</code></td>
<td>
<p> optional <code>character</code> vector or a <code>list</code>
of <code>character</code> vectors giving the titles of the derived series
in <code><var>crn</var></code>.  The interpretation is the same as with
<code><var>crn.types</var></code>, except that the default is to derive the
titles from the column names of <code><var>crn</var></code>.  Also <code>NA</code>
means that the column name is used.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_crn.units">crn.units</code></td>
<td>
<p> optional <code>character</code> vector or a <code>list</code> of
<code>character</code> vectors giving the units of the derived series in
<code><var>crn</var></code>.  The interpretation is the same as with
<code><var>crn.types</var></code>, except that the default is to mark the
series as &lsquo;<span class="samp">&#8288;&lt;unitless&gt;&#8288;</span>&rsquo;.  Also <code>NA</code> means
&lsquo;<span class="samp">&#8288;&lt;unitless&gt;&#8288;</span>&rsquo;.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_tridas.measuring.method">tridas.measuring.method</code></td>
<td>
 <p><code>character</code> vector giving the
measuring method used to acquire each series of <code><var>rwl.df</var></code>.
Partial matching is used to replace these with the complete terms in
<code><a href="#topic+tridas.vocabulary">tridas.vocabulary</a></code>.  If the vector is shorter than the
number of columns in <code><var>rwl.df</var></code>, it is recycled to the
correct length.  The default is to use the information in
<code><var>other.measuring.method</var></code> instead.  Also, <code>NA</code> in any
position of the vector means that the measuring method information
for that series is looked up in <code><var>other.measuring.method</var></code>.
</p>
</td></tr>
<tr><td><code id="write.tridas_+3A_other.measuring.method">other.measuring.method</code></td>
<td>
 <p><code>character</code> vector giving the
measuring method used to acquire each series of <code><var>rwl.df</var></code>.
In contrast to <code><var>tridas.measuring.method</var></code>, these are
free-form strings in English.  If the vector is shorter than the
number of columns in <code><var>rwl.df</var></code>, it is recycled to the
correct length.  The default value is <code>"unknown"</code>.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_sample.type">sample.type</code></td>
<td>
<p> optional <code>character</code> vector giving the type
of the samples, corresponding to <code>"core"</code> in <code><var>ids</var></code>.
The length of the vector, however, must match the number of columns
in <code><var>rwl.df</var></code>, or it is recycled to the correct length.  If
there are several measurements per sample, some elements of
<code><var>sample.type</var></code> are redundant.  The default is to use
<code>"core"</code> for all series.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_wood.completeness">wood.completeness</code></td>
<td>
<p> optional <code>data.frame</code> giving wood
completeness information for the measurement series in
<code><var>rwl.df</var></code>.  The number of rows must match the number of
columns in <code><var>rwl.df</var></code>.  The columns are expected to be a
subset of the following (descriptions almost directly quoted from
TRiDaS specification):
</p>

<dl>
<dt>n.unmeasured.inner</dt><dd><p>Field for recording whether there are
any rings at the inner (i.e. towards pith) edge of the sample
that have not been measured.  Typically used to note when rings
are too damaged to measure.  Non-negative integral value.</p>
</dd>
<dt>n.unmeasured.outer</dt><dd><p>Field for recording whether there are
any rings at the outer (i.e. towards bark) edge of the sample
that have not been measured.  Typically used to note when rings
are too damaged to measure.  Non-negative integral value.</p>
</dd>
<dt>pith.presence</dt><dd><p>Whether the pith is present or absent.
Each element must be a partial match with the contents of
category <code>"complex presence / absence"</code> in
<code><a href="#topic+tridas.vocabulary">tridas.vocabulary</a></code>.</p>
</dd>
<dt>heartwood.presence</dt><dd><p>Whether the outer (youngest) heartwood
is present and if so whether it is complete.
</p>
<p>Category <code>"complex presence / absence"</code> in
<code><a href="#topic+tridas.vocabulary">tridas.vocabulary</a></code>.</p>
</dd>
<dt>n.missing.heartwood</dt><dd><p>Estimated number of missing heartwood
rings to the pith.  Non-negative integral value.</p>
</dd>
<dt>missing.heartwood.foundation</dt><dd><p>Description of the way the
estimation of how many heartwood rings are missing was made and
what the certainty is.  Free-form string.</p>
</dd>
<dt>sapwood.presence</dt><dd><p>Whether the sapwood is present or not.
</p>
<p>Category <code>"complex presence / absence"</code>.</p>
</dd>
<dt>n.sapwood</dt><dd><p>Number of sapwood rings measured.  Non-negative
integral value.</p>
</dd>
<dt>last.ring.presence</dt><dd><p>Last ring under the bark is present or
absent.
</p>
<p>Category <code>"presence / absence"</code>.</p>
</dd>
<dt>last.ring.details</dt><dd><p>If the last ring under the bark is
present, include information about the completeness of this ring
and/or season of felling.  Free-form string.</p>
</dd>
<dt>n.missing.sapwood</dt><dd><p>Estimated number of missing sapwood rings
to the bark.  Non-negative integral value.</p>
</dd>
<dt>missing.sapwood.foundation</dt><dd><p>Description of the way the
estimation of how many sapwood rings are missing was made and
what the certainty is.  Free-form string.</p>
</dd>
<dt>bark.presence</dt><dd><p>Bark is present or absent.
</p>
<p>Category <code>"presence / absence"</code> in
<code><a href="#topic+tridas.vocabulary">tridas.vocabulary</a></code>.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="write.tridas_+3A_taxon">taxon</code></td>
<td>
 <p><code>character</code> string.  The most detailed taxonomic
name known for this element (species, genus, family etc).
Preferably from the <a href="https://www.catalogueoflife.org/">Catalogue
of Life</a> controlled vocabulary.  The same string is used for all of
<code><var>rwl.df</var></code>.  The default value is an empty string, but a
proper value should really be given.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_tridas.variable">tridas.variable</code></td>
<td>
 <p><code>character</code> string.  Measured variable
(ring width, earlywood, latewood etc) taken from the TRiDaS
controlled vocabulary (<code><a href="#topic+tridas.vocabulary">tridas.vocabulary</a></code>, category
<code>"variable"</code>).  The same string is used for all of
<code><var>rwl.df</var></code>.  Defaults to <code>"ring width"</code>.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_other.variable">other.variable</code></td>
<td>
 <p><code>character</code> string.  Measured variable as
a free-form string.  The same string is used for all of
<code><var>rwl.df</var></code>.  This is only used if
<code><var>tridas.variable</var></code> is <code>NA</code>.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_project.info">project.info</code></td>
<td>
 <p><code>list</code> containing information about the
project.  Elements are the following (includes quotes from the
TRiDaS specification):
</p>

<dl>
<dt>type</dt><dd><p><code>character</code> vector.  The type(s) of the project.
Defaults to <code>"unknown"</code>.</p>
</dd>
<dt>description</dt><dd><p><code>character</code> string.  A description of the
project.  Defaults to <code>NULL</code>: no description.</p>
</dd>
<dt>title</dt><dd><p><code>character</code> string.  The title of the project.
Defaults to an empty string.</p>
</dd>
<dt>category</dt><dd><p><code>character</code> string.  Category of research
this project falls into.  Defaults to an empty string.</p>
</dd>
<dt>investigator</dt><dd><p><code>character</code> string.  Principal
investigator of this project.  Defaults to an empty string.</p>
</dd>
<dt>period</dt><dd><p><code>character</code> string.  When the
dendrochronological project took place.  Could consist of a
start- and end-date.  If unknown it should be estimated.
Defaults to an empty string.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="write.tridas_+3A_lab.info">lab.info</code></td>
<td>
 <p><code>data.frame</code>. Information about the
dendrochronological research laboratories where this work was done.
One row per laboratory.  Defaults to one laboratory with an empty
name and no other information.  The columns are expected to be a
subset of the following:
</p>

<dl>
<dt>name</dt><dd><p>Name of the laboratory</p>
</dd>
<dt>acronym</dt><dd><p>Optional acronym of the laboratory</p>
</dd>
<dt>identifier</dt><dd><p>Optional identifier of the laboratory</p>
</dd>
<dt>domain</dt><dd><p>The domain which the identifier of the laboratory is
applicable to.  Could be the <abbr><span class="acronym">URL</span></abbr> of the
organization‚Äôs server or the name of the organization
as long as it is not ambiguous.</p>
</dd>
<dt>addressLine1</dt><dd><p>First address line</p>
</dd>
<dt>addressLine2</dt><dd><p>Second address line</p>
</dd>
<dt>cityOrTown</dt><dd><p>City or town</p>
</dd>
<dt>stateProvinceRegion</dt><dd><p>State, province or region</p>
</dd>
<dt>postalCode</dt><dd><p>Postal code.  Beware of ignored leading zeros
if these are given in <code>numeric</code> or <code>integer</code> type
values.  It is always safe to use <code>character</code> values.</p>
</dd>
<dt>country</dt><dd><p>Country</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="write.tridas_+3A_research.info">research.info</code></td>
<td>
<p> optional <code>data.frame</code> with information
about the systems in which the research project is
registered.  Columns are the following:
</p>

<dl>
<dt>identifier</dt><dd><p>Identifier</p>
</dd>
<dt>domain</dt><dd><p>Domain which the identifier is applicable to</p>
</dd>
<dt>description</dt><dd><p>General description</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="write.tridas_+3A_site.info">site.info</code></td>
<td>
 <p><code>list</code> containing information about the site
(&lsquo;<span class="samp">&#8288;&lt;object&gt;&#8288;</span>&rsquo;).  Elements are the following, and all are
<code>character</code> strings:
</p>

<dl>
<dt>type</dt><dd><p>Type of the site.  Defaults to <code>"unknown"</code>.</p>
</dd>
<dt>description</dt><dd><p>Description.  Defaults to no description.</p>
</dd>
<dt>title</dt><dd><p>Title of the site.  Defaults to an empty string.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="write.tridas_+3A_random.identifiers">random.identifiers</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code>,
unique random identifiers are created with <code><a href="#topic+uuid.gen">uuid.gen</a></code>
and attached to each &lsquo;<span class="samp">&#8288;&lt;project&gt;&#8288;</span>&rsquo; (one in the file),
&lsquo;<span class="samp">&#8288;object&#8288;</span>&rsquo; (site, one in the file), &lsquo;<span class="samp">&#8288;&lt;element&gt;&#8288;</span>&rsquo; (tree),
&lsquo;<span class="samp">&#8288;&lt;sample&gt;&#8288;</span>&rsquo; (core), &lsquo;<span class="samp">&#8288;&lt;radius&gt;&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;&lt;measurementSeries&gt;&#8288;</span>&rsquo;
(measurement) and &lsquo;<span class="samp">&#8288;&lt;derivedSeries&gt;&#8288;</span>&rsquo; element in the resulting
TRiDaS file.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_identifier.domain">identifier.domain</code></td>
<td>
 <p><code>character</code> string.  The domain which
the random identifiers are applicable to.  Could be the
<abbr><span class="acronym">URL</span></abbr> of the organization‚Äôs server or the name of the
organization as long as it is not ambiguous.  Defaults to the name
of the first laboratory in <code><var>lab.info</var></code>.  </p>
</td></tr>
<tr><td><code id="write.tridas_+3A_...">...</code></td>
<td>
<p> Unknown arguments are accepted but not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Tree Ring Data Standard (TRiDaS) is described in Jansma et. al
(2010).  
</p>


<h3>Value</h3>

 <p><code><var>fname</var></code> </p>


<h3>Note</h3>

<p> This is an early version of the function.  Bugs are likely to
exist, and parameters are subject to change.  </p>


<h3>Author(s)</h3>

<p> Mikko Korpela </p>


<h3>References</h3>

<p>Jansma, E., Brewer, P. W., and Zandhuis, I. (2010) TRiDaS 1.1: The
tree-ring data standard.  <em>Dendrochronologia</em>, <b>28</b>(2),
99&ndash;130.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+write.rwl">write.rwl</a></code>, <code><a href="#topic+write.tucson">write.tucson</a></code>,
<code><a href="#topic+write.compact">write.compact</a></code>, <code><a href="#topic+write.crn">write.crn</a></code>,
<code><a href="#topic+read.tridas">read.tridas</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
## Not run: 
## Write raw ring widths
data(co021)
fname1 &lt;- write.tridas(rwl.df = co021,
    fname = tempfile(fileext=".xml"), prec = 0.01,
    site.info = list(title = "Schulman old tree no. 1, Mesa Verde",
                     type = "unknown"),
    taxon = "Pseudotsuga menziesii var. menziesii (Mirb.) Franco",
    project.info = list(investigator = "E. Schulman",
                        title = "", category = "",
                        period = "", type = "unknown"))
print(fname1) # tempfile used for output

## Write mean value chronology of detrended ring widths
data(ca533)
ca533.rwi &lt;- detrend(rwl = ca533, method = "ModNegExp")
ca533.crn &lt;- chron(ca533.rwi, prewhiten = TRUE)
fname2 &lt;- write.tridas(crn = ca533.crn,
    fname = tempfile(fileext=".xml"),
    taxon = "Pinus longaeva D.K. Bailey",
    project.info =
        list(investigator = "Donald A. Graybill, V.C. LaMarche, Jr.",
             title = "Campito Mountain", category = "",
             period = "", type = "unknown"))
print(fname2) # tempfile used for output

unlink(c(fname1, fname2)) # remove the files

## End(Not run)
</code></pre>

<hr>
<h2 id='write.tucson'> Write Tucson Format Chronology File </h2><span id='topic+write.tucson'></span>

<h3>Description</h3>

<p>This function writes a chronology to a Tucson (decadal) format file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.tucson(rwl.df, fname, header = NULL, append = FALSE,
             prec = 0.01, mapping.fname = "", mapping.append = FALSE,
             long.names = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.tucson_+3A_rwl.df">rwl.df</code></td>
<td>
<p> a <code>data.frame</code> containing tree-ring ring widths
with the series in columns and the years as rows.  The series
<abbr><span class="acronym">ID</span></abbr>s are the column names and the years are the row
names.  This type of <code>data.frame</code> is produced by
<code><a href="#topic+read.rwl">read.rwl</a></code> and <code><a href="#topic+read.compact">read.compact</a></code>. </p>
</td></tr>
<tr><td><code id="write.tucson_+3A_fname">fname</code></td>
<td>
<p> a <code>character</code> vector giving the file name of the
rwl file. </p>
</td></tr>
<tr><td><code id="write.tucson_+3A_header">header</code></td>
<td>
<p> a <code>list</code> giving information for the header of the
file.  If <code>NULL</code> then no header information will be written. </p>
</td></tr>
<tr><td><code id="write.tucson_+3A_append">append</code></td>
<td>
 <p><code>logical</code> flag indicating whether to append this
chronology to an existing file.  The default is to create a new
file. </p>
</td></tr>
<tr><td><code id="write.tucson_+3A_prec">prec</code></td>
<td>
 <p><code>numeric</code> indicating the precision of the output
file.  This must be equal to either 0.01 or 0.001 (units are in
mm). </p>
</td></tr>
<tr><td><code id="write.tucson_+3A_mapping.fname">mapping.fname</code></td>
<td>
<p> a <code>character</code> vector of length one giving
the file name of an optional output file showing the mapping between
input and output series <abbr><span class="acronym">ID</span></abbr>s.  The mapping is only printed
for those <abbr><span class="acronym">ID</span></abbr>s that are transformed.  An empty name (the
default) disables output. </p>
</td></tr>
<tr><td><code id="write.tucson_+3A_mapping.append">mapping.append</code></td>
<td>
 <p><code>logical</code> flag indicating whether to
append the description of the altered series <abbr><span class="acronym">ID</span></abbr>s to an
existing file.  The default is to create a new file. </p>
</td></tr>
<tr><td><code id="write.tucson_+3A_long.names">long.names</code></td>
<td>
 <p><code>logical</code> flag indicating whether to allow
long series <abbr><span class="acronym">ID</span></abbr>s (7 or 8 characters) to be written to the
output.  The default is to only allow 6 characters. </p>
</td></tr>
<tr><td><code id="write.tucson_+3A_...">...</code></td>
<td>
<p> Unknown arguments are accepted but not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This writes a standard rwl file as defined according to the standards
of the <abbr><span class="acronym">ITRDB</span></abbr> at
<a href="https://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt">https://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt</a>.  This is the
decadal or Tucson format.  It is an <abbr><span class="acronym">ASCII</span></abbr> file and machine
readable by the standard dendrochronology programs.  Header information
for the rwl can be written according to the International Tree Ring
Data Bank (<abbr><span class="acronym">ITRDB</span></abbr>) standard.  The header standard is not very
reliable however and should be thought of as experimental here.  Do not
try to write headers using dplR to submit to the <abbr><span class="acronym">ITRDB</span></abbr>.  When
submitting to the <abbr><span class="acronym">ITRDB</span></abbr>, you can enter the metadata via
their website.  If you insist however, the header information is given
as a <code>list</code> and must be formatted with the following:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <em>Description</em> </td><td style="text-align: right;"> <em>Name</em> </td><td style="text-align: right;"> <em>Class</em> </td><td style="text-align: right;"> <em>Max Width</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
    Site <abbr><span class="acronym">ID</span></abbr> </td><td style="text-align: right;"> <code><var>site.id</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 5 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Site Name </td><td style="text-align: right;"> <code><var>site.name</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 52 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Species Code </td><td style="text-align: right;"> <code><var>spp.code</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 4 </td>
</tr>
<tr>
 <td style="text-align: left;">
    State or Country </td><td style="text-align: right;"> <code><var>state.country</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 13 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Species </td><td style="text-align: right;"> <code><var>spp</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 18 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Elevation </td><td style="text-align: right;"> <code><var>elev</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 5 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Latitude </td><td style="text-align: right;"> <code><var>lat</var></code> </td><td style="text-align: right;"> <code>character</code> or <code>numeric</code> </td><td style="text-align: right;"> 5 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Longitude </td><td style="text-align: right;"> <code><var>long</var></code> </td><td style="text-align: right;"> <code>character</code> or <code>numeric</code> </td><td style="text-align: right;"> 5 </td>
</tr>
<tr>
 <td style="text-align: left;">
    First Year </td><td style="text-align: right;"> <code><var>first.yr</var></code> </td><td style="text-align: right;"> <code>character</code> or <code>numeric</code> </td><td style="text-align: right;"> 4 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Last Year </td><td style="text-align: right;"> <code><var>last.yr</var></code> </td><td style="text-align: right;"> <code>character</code> or <code>numeric</code> </td><td style="text-align: right;"> 4 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Lead Investigator </td><td style="text-align: right;"> <code><var>lead.invs</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 63 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Completion Date </td><td style="text-align: right;"> <code><var>comp.date</var></code> </td><td style="text-align: right;"> <code>character</code> </td><td style="text-align: right;"> 8 </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>See examples for a correctly formatted header list.  If the width of
the fields is less than the max width, then the fields will be padded
to the right length when written.  Note that <code><var>lat</var></code> and
<code><var>long</var></code> are really <code><var>lat</var> * 100</code> or
<code><var>long</var> * 100</code> and given as integral values.  E.g., 37 degrees
30 minutes would be given as 3750.
</p>
<p>Series can be appended to the bottom of an existing file with a second
call to <code>write.tucson</code>.  The output from this file is suitable for
publication on the <abbr><span class="acronym">ITRDB</span></abbr>.
</p>
<p>The function is capable of altering excessively long and/or duplicate
series <abbr><span class="acronym">ID</span></abbr>s to fit the Tucson specification.  Additionally,
characters other than numbers or English letters will be removed.  If
series <abbr><span class="acronym">ID</span></abbr>s are changed, one or more warnings are shown.  In
that case, the user may wish to print a list of the renamings (see
Arguments).
</p>
<p>Setting <code><var>long.names</var> = TRUE</code> allows series <abbr><span class="acronym">ID</span></abbr>s to
be 8 characters long, or 7 in case there are year numbers using 5
characters.  Note that in the latter case the limit of 7 characters
applies to all <abbr><span class="acronym">ID</span></abbr>s, not just the one corresponding to the
series with long year numbers.  The default (<code><var>long.names</var> =
  FALSE</code>) is to allow 6 characters.  Long <abbr><span class="acronym">ID</span></abbr>s may cause
incompatibility with other software.
</p>


<h3>Value</h3>

<p><code><var>fname</var></code>
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+write.crn">write.crn</a></code>, <code><a href="#topic+read.tucson">read.tucson</a></code>,
<code><a href="#topic+write.rwl">write.rwl</a></code>, <code><a href="#topic+write.compact">write.compact</a></code>,
<code><a href="#topic+write.tridas">write.tridas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
co021.hdr &lt;- list(site.id = "CO021",
                  site.name = "SCHULMAN OLD TREE NO. 1, MESA VERDE",
                  spp.code = "PSME", state.country = "COLORADO",
                  spp = "DOUGLAS FIR", elev = "2103M", lat = 3712,
                  long = -10830, first.yr = 1400, last.yr = 1963,
                  lead.invs = "E. SCHULMAN", comp.date = "")
fname &lt;- write.tucson(rwl.df = co021, fname = tempfile(fileext=".rwl"),
                      header = co021.hdr, append = FALSE, prec = 0.001)
print(fname) # tempfile used for output

unlink(fname) # remove the file
</code></pre>

<hr>
<h2 id='xdate.floater'> Crossdate an undated series</h2><span id='topic+xdate.floater'></span>

<h3>Description</h3>

<p>Pulls an undated series through a dated rwl file in order to try to establish dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xdate.floater(rwl, series, series.name = "Unk", min.overlap = 50, n = NULL,
             prewhiten = TRUE, biweight = TRUE,
             method = c("spearman", "pearson","kendall"),
             make.plot = TRUE,return.rwl = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xdate.floater_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_series">series</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as
rows such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_series.name">series.name</code></td>
<td>
<p> a <code>character</code> giving a name for the series. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_min.overlap">min.overlap</code></td>
<td>
<p> number </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length
for the <code><a href="#topic+hanning">hanning</a></code> filter used for removal of low
frequency variation. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_method">method</code></td>
<td>
<p>Can be either <code>"pearson"</code>, <code>"kendall"</code>, or
<code>"spearman"</code> which indicates the correlation coefficient to be
used.  Defaults to <code>"spearman"</code>.  See <code><a href="stats.html#topic+cor.test">cor.test</a></code>. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_make.plot">make.plot</code></td>
<td>
 <p><code>logical flag</code> indicating whether to make a
plot. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_return.rwl">return.rwl</code></td>
<td>
 <p><code>logical flag</code> indicating whether to make a
plot. </p>
</td></tr>
<tr><td><code id="xdate.floater_+3A_verbose">verbose</code></td>
<td>
 <p><code>logical flag</code> indicating whether to print some results to screen. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This takes an undated series (a floater) and drags it along a dated <code>rwl</code> object in order to estabish possible dates for the series. This function is experimental and under development. It might change in future releases. 
</p>


<h3>Value</h3>

<p>By default a <code>data.frame</code> is returned with the first and last year of the period compared as well as the correlation, p-value, and number of observations. If <code>return.rwl</code> is <code>TRUE</code> then a list is returned with the <code>rwl</code> object as well as the <code>data.frame</code> with the correlation statistics.
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

<p><code><a href="#topic+corr.series.seg">corr.series.seg</a></code>, <code><a href="#topic+skel.plot">skel.plot</a></code>,
<code><a href="#topic+series.rwl.plot">series.rwl.plot</a></code>, <code><a href="#topic+ccf.series.rwl">ccf.series.rwl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
summary(co021)
foo &lt;- co021[,"645232"]
# 645232  1466 1659
bar &lt;- co021
bar$"645232" &lt;- NULL
out &lt;- xdate.floater(bar, foo, min.overlap = 50, series.name = "Undated")

foo &lt;- co021[,"646118"]
# 646118  1176 1400
bar &lt;- co021
bar$"646118" &lt;- NULL
out &lt;- xdate.floater(bar, foo, min.overlap = 100, series.name = "Undated")
# note that this can fail if a long overlap is needed. This produces the 
# wrong dates.
out &lt;- xdate.floater(bar, foo, min.overlap = 200, series.name = "Undated")
</code></pre>

<hr>
<h2 id='xskel.ccf.plot'> Skeleton Plot for Series and Master with Cross Correlation </h2><span id='topic+xskel.ccf.plot'></span>

<h3>Description</h3>

<p>...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xskel.ccf.plot(rwl, series, series.yrs = as.numeric(names(series)),
               win.start, win.width = 50, n = NULL,
               prewhiten = TRUE, biweight = TRUE, series.x=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xskel.ccf.plot_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as rows
such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="xskel.ccf.plot_+3A_series">series</code></td>
<td>
<p> a <code>numeric</code> or <code>character</code> vector.  Usually a
tree-ring series.  If the length of the value is 1, the
corresponding column of <code><var>rwl</var></code> is selected (by name or
position) as the series and ignored when building the master
chronology.  Otherwise, the value must be <code>numeric</code>. </p>
</td></tr>
<tr><td><code id="xskel.ccf.plot_+3A_series.yrs">series.yrs</code></td>
<td>
<p> a <code>numeric</code> vector giving the years of
<code><var>series</var></code>.  Defaults to
<code>as.numeric(names(<var>series</var>))</code>. </p>
</td></tr>
<tr><td><code id="xskel.ccf.plot_+3A_win.start">win.start</code></td>
<td>
<p> year to start window </p>
</td></tr>
<tr><td><code id="xskel.ccf.plot_+3A_win.width">win.width</code></td>
<td>
<p> an even integral value </p>
</td></tr> 
<tr><td><code id="xskel.ccf.plot_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length for the
<code><a href="#topic+hanning">hanning</a></code> filter used for removal of low frequency
variation. </p>
</td></tr>
<tr><td><code id="xskel.ccf.plot_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="xskel.ccf.plot_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>. </p>
</td></tr>
<tr><td><code id="xskel.ccf.plot_+3A_series.x">series.x</code></td>
<td>
 <p><code>logical</code> flag indicating whether to make the <code>series</code>
the <code>x</code> argument to <code><a href="stats.html#topic+ccf">ccf</a></code>. See Details. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a plot that is a mix of a skeleton plot and a
cross-correlation plot.  It‚Äôs used in crossdating.
</p>
<p>The top panel shows the normalized values for the master chronology
(bottom half) and the series (top half) in green.  The values are the
detrended and standardized data (e.g., RWI).
</p>
<p>Similarly, the black lines are a skeleton plot for the master and
series with the marker years annotated for the master on the bottom
axis and series on the top.  The text at the top of the figure gives
the correlation between the series and master (green bars) as well as
the percentage of agreement between the years of skeleton bars for the
series and master.  I.e., if all the black lines occur in the same
years the percentage would be 100%.
</p>
<p>The bottom panels show cross correlations for the first half (left)
and second half of the time series using function <code><a href="stats.html#topic+ccf">ccf</a></code>.
</p>
<p>The cross correlations are calculated calling
<code><a href="stats.html#topic+ccf">ccf</a></code> as <br />
<code>ccf(x=master, y=series, lag.max=lag.max, plot=FALSE)</code> if <code>series.x</code> is 
<code>FALSE</code> and as <code>ccf(x=series, y=master, lag.max=lag.max, plot=FALSE)</code> if 
<code>series.x</code> is <code>TRUE</code>.  This argument was introduced in dplR version 1.7.0.
Different users have different expectations about how missing or extra rings are notated. If <code>switch.x = FALSE</code> the behavior will be like COFECHA where a missing ring in a series produces a negative lag in the plot rather than a positive lag.
</p>
<p>The plot is built using the <a href="grid.html#topic+Grid">Grid</a> package which
allows for great flexibility in building complicated plots.  However,
these plots look best when they don‚Äôt cover too wide a range
of years (unless the plotting device is wider than is typical).  For
that reason the user will get a warning if <code><var>win.width</var></code> is
greater than 100 years.
</p>
<p>Old-school skeleton plots to print on paper are made with <code><a href="#topic+skel.plot">skel.plot</a></code>.
</p>


<h3>Value</h3>

<p>None.  Invoked for side effect (plot).
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+ccf">ccf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
dat &lt;- co021
#corrupt a series
bad.series &lt;- dat$"641143"
names(bad.series) &lt;- rownames(dat)
bad.series &lt;- delete.ring(bad.series,year=1825)
# good match
xskel.ccf.plot(rwl=dat,series=bad.series,win.start=1900,win.width=50)
# overlap missing ring
xskel.ccf.plot(rwl=dat,series=bad.series,win.start=1800,win.width=50)
</code></pre>

<hr>
<h2 id='xskel.plot'> Skeleton Plot for Series and Master </h2><span id='topic+xskel.plot'></span>

<h3>Description</h3>

<p>...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xskel.plot(rwl, series, series.yrs = as.numeric(names(series)),
           win.start, win.end = win.start+100, n = NULL, 
           prewhiten = TRUE, biweight = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xskel.plot_+3A_rwl">rwl</code></td>
<td>
<p> a <code>data.frame</code> with series as columns and years as rows
such as that produced by <code><a href="#topic+read.rwl">read.rwl</a></code>. </p>
</td></tr>
<tr><td><code id="xskel.plot_+3A_series">series</code></td>
<td>
<p> a <code>numeric</code> or <code>character</code> vector.  Usually a
tree-ring series.  If the length of the value is 1, the
corresponding column of <code><var>rwl</var></code> is selected (by name or
position) as the series and ignored when building the master
chronology.  Otherwise, the value must be <code>numeric</code>. </p>
</td></tr>
<tr><td><code id="xskel.plot_+3A_series.yrs">series.yrs</code></td>
<td>
<p> a <code>numeric</code> vector giving the years of
<code><var>series</var></code>.  Defaults to
<code>as.numeric(names(<var>series</var>))</code>. </p>
</td></tr>
<tr><td><code id="xskel.plot_+3A_win.start">win.start</code></td>
<td>
<p> year to start window </p>
</td></tr>
<tr><td><code id="xskel.plot_+3A_win.end">win.end</code></td>
<td>
<p> year to end window </p>
</td></tr> 
<tr><td><code id="xskel.plot_+3A_n">n</code></td>
<td>
 <p><code>NULL</code> or an integral value giving the filter length for the
<code><a href="#topic+hanning">hanning</a></code> filter used for removal of low frequency
variation. </p>
</td></tr>
<tr><td><code id="xskel.plot_+3A_prewhiten">prewhiten</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> each series is
whitened using <code><a href="stats.html#topic+ar">ar</a></code>. </p>
</td></tr>
<tr><td><code id="xskel.plot_+3A_biweight">biweight</code></td>
<td>
 <p><code>logical</code> flag.  If <code>TRUE</code> then a robust
mean is calculated using <code><a href="#topic+tbrm">tbrm</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a plot that is a mix of a skeleton plot and a
cross-correlation plot.  It‚Äôs used in crossdating.
</p>
<p>The top panel shows the normalized values for the master chronology
(bottom half) and the series (top half) in green.  The values are the
detrended and standardized data (e.g., RWI).
</p>
<p>Similarly, the black lines are a skeleton plot for the master and
series with the marker years annotated for the master on the bottom
axis and series on the top.  The text at the top of the figure gives
the correlation between the series and master (green bars) as well as
the percentage of agreement between the years of skeleton bars for the
series and master.  I.e., if all the black lines occur in the same
years the percentage would be 100%.
</p>
<p>The bottom panels show cross correlations for the first half (left)
and second half of the time series using function <code><a href="stats.html#topic+ccf">ccf</a></code> as
<code>ccf(x=series,y=master,lag.max=5)</code>.
</p>
<p>The plot is built using the <a href="grid.html#topic+Grid">Grid</a> package which
allows for great flexibility in building complicated plots.  However,
these plots look best when they don‚Äôt cover too wide a range
of years (unless the plotting device is wider than is typical).  For
that reason the user will get a warning if <code><var>win.width</var></code> is
greater than 100 years.
</p>
<p>Old-school skeleton plots to print on paper are made with <code><a href="#topic+skel.plot">skel.plot</a></code>.
</p>


<h3>Value</h3>

<p>None.  Invoked for side effect (plot).
</p>


<h3>Author(s)</h3>

<p> Andy Bunn.  Patched and improved by Mikko Korpela. </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+ccf">ccf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(utils)
data(co021)
dat &lt;- co021
#corrupt a series
bad.series &lt;- dat$"641143"
names(bad.series) &lt;- rownames(dat)
bad.series &lt;- delete.ring(bad.series,year=1825)
# good match
xskel.plot(rwl=dat,series=bad.series,win.start=1850)
# overlap missing ring
xskel.plot(rwl=dat,series=bad.series,win.start=1800)
</code></pre>

<hr>
<h2 id='zof.anc'> Ancillary Data Corresponding to <code><a href="#topic+zof.rwl">zof.rwl</a></code> </h2><span id='topic+zof.anc'></span>

<h3>Description</h3>

<p>This data set gives the pith offsets, distance to pith, and diameter that match the ring widths for <code><a href="#topic+zof.rwl">zof.rwl</a></code> ‚Äì a data set of European Beech (<em>Fagus sylvatica</em>) increment cores collected at the Zofingen in Switzerland.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(zof.anc)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing four columns. Column one gives the series ID. Column two (<code>PO</code>) gives the number of rings estimated to be missing to the pith. Column three (<code>d2pith</code>) gives the estimated distance to the pith (mm). Column four (<code>diam</code>) gives the diameter at breast height (DBH) in cm.
</p>


<h3>Source</h3>

<p>Contributed by Stefan Klesse
</p>


<h3>References</h3>

<p>Klesse, S., Babst, F., Lienert, S., Spahni, R., Joos, F., Bouriaud, O., Carrer, M., Filippo, A.D., Poulter, B., Trotsiuk, V., Wilson, R., Frank, D.C. (2018) A combined tree ring and vegetation model assessment of European forest growth sensitivity to interannual climate variability. <em>Global Biogeochemical Cycles</em> 32, 1226 &ndash; 1240.
</p>

<hr>
<h2 id='zof.rwl'> European Beech Ring Widths from Zofingen, Switzerland </h2><span id='topic+zof.rwl'></span>

<h3>Description</h3>

<p>This data set includes ring-width measurements for European Beech (<em>Fagus sylvatica</em>) increment cores collected at the Zofingen in Switzerland.  There are 61 series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(zof.rwl)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 61 ring-width series in columns and 156
years in rows.
</p>


<h3>Source</h3>

<p>Contributed by Stefan Klesse
</p>


<h3>References</h3>

<p>Klesse, S., Babst, F., Lienert, S., Spahni, R., Joos, F., Bouriaud, O., Carrer, M., Filippo, A.D., Poulter, B., Trotsiuk, V., Wilson, R., Frank, D.C. (2018) A combined tree ring and vegetation model assessment of European forest growth sensitivity to interannual climate variability. <em>Global Biogeochemical Cycles</em> 32, 1226 &ndash; 1240.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
