<!DOCTYPE html><html><head><title>Help for package infraFDTD.assist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {infraFDTD.assist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#infraFDTD.assist-package'>
<p>IO Help for infraFDTD Model</p></a></li>
<li><a href='#MakeSnapshotInfo'>
<p>First Step in Snapshot Conversion</p></a></li>
<li><a href='#MakeSnapshots'>
<p>Convert Binary Snapshot Output to PNGs</p></a></li>
<li><a href='#PrepFiles'>
<p>Generate Input Files for infraFDTD</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>IO Help for infraFDTD Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-10-30</td>
</tr>
<tr>
<td>Imports:</td>
<td>fields</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rNOMADS</td>
</tr>
<tr>
<td>Author:</td>
<td>Jake Anderson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jake Anderson &lt;ajakef@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Facilitates the generation of input files for infraFDTD and processes snapshot output. infraFDTD is a finite-difference model written by Keehoon Kim for simulating infrasound that considers topography and a 1-D atmosphere (see Kim et al., 2015 &lt;<a href="https://doi.org/10.1002%2F2015GL064466">doi:10.1002/2015GL064466</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-10-31 05:29:39 UTC; jake</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-11-01 04:04:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='infraFDTD.assist-package'>
IO Help for infraFDTD Model
</h2><span id='topic+infraFDTD.assist-package'></span><span id='topic+infraFDTD.assist'></span>

<h3>Description</h3>

<p>Facilitates the generation of input files for infraFDTD and processes snapshot output. infraFDTD is a finite-difference model written by Keehoon Kim for simulating infrasound that considers topography and a 1-D atmosphere (see Kim et al., 2015 &lt;doi:10.1002/2015GL064466&gt;).
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> infraFDTD.assist</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> IO Help for infraFDTD Model</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-10-30</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> fields</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> rNOMADS</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Jake Anderson</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Jake Anderson &lt;ajakef@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Facilitates the generation of input files for infraFDTD and processes snapshot output. infraFDTD is a finite-difference model written by Keehoon Kim for simulating infrasound that considers topography and a 1-D atmosphere (see Kim et al., 2015 &lt;doi:10.1002/2015GL064466&gt;).</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
MakeSnapshotInfo        First Step in Snapshot Conversion
MakeSnapshots           Convert Binary Snapshot Output to PNGs
PrepFiles               Generate Input Files for infraFDTD
infraFDTD.assist-package
                        IO Help for infraFDTD Model
</pre>
<p>Before running the infraFDTD model, generate the input files using
PrepFiles. After running the model, binary snapshot files can be
converted into png files by MakeSnapshotInfo and MakeSnapshots.
</p>


<h3>Author(s)</h3>

<p>Jake Anderson
</p>
<p>Maintainer: Jake Anderson &lt;ajakef@gmail.com&gt;
</p>


<h3>References</h3>

<p>The infraFDTD code is available on request from Keehoon Kim at LLNL
(kim84@llnl.gov) and is described in Kim et al. (2015)
&lt;doi:10.1002/2015GL064466&gt;.
</p>


<h3>See Also</h3>

<p>See package rNOMADS for help finding atmospheric profiles for given time/place.
</p>

<hr>
<h2 id='MakeSnapshotInfo'>
First Step in Snapshot Conversion
</h2><span id='topic+MakeSnapshotInfo'></span>

<h3>Description</h3>

<p>Helps convert binary snapshot output from infraFDTD into images. This
function collects information from the snapshots to facilitate the
conversion. It does NOT perform the conversion itself (see
MakeSnapshots for that).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MakeSnapshotInfo(inputdir = "./snapshots", dframe = 20, N = 400, xs, ys,
zs, makesec1 = TRUE, makesec2 = TRUE, makesurf = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MakeSnapshotInfo_+3A_inputdir">inputdir</code></td>
<td>

<p>Directory containing snapshot files.
</p>
</td></tr>
<tr><td><code id="MakeSnapshotInfo_+3A_dframe">dframe</code></td>
<td>

<p>Snapshot interval in samples (difference between snapshot file numbers).
</p>
</td></tr>
<tr><td><code id="MakeSnapshotInfo_+3A_n">N</code></td>
<td>

<p>Number of snapshots.
</p>
</td></tr>
<tr><td><code id="MakeSnapshotInfo_+3A_xs">xs</code></td>
<td>

<p>X source coordinates (m); can be a vector if multiple sources.
</p>
</td></tr>
<tr><td><code id="MakeSnapshotInfo_+3A_ys">ys</code></td>
<td>

<p>Y source coordinates (m); can be a vector if multiple sources.
</p>
</td></tr>
<tr><td><code id="MakeSnapshotInfo_+3A_zs">zs</code></td>
<td>

<p>Z source coordinates (m); can be a vector if multiple sources.
</p>
</td></tr>
<tr><td><code id="MakeSnapshotInfo_+3A_makesec1">makesec1</code></td>
<td>

<p>Logical: should section 1 snapshots be processed?
</p>
</td></tr>
<tr><td><code id="MakeSnapshotInfo_+3A_makesec2">makesec2</code></td>
<td>

<p>Logical: should section 2 snapshots be processed?
</p>
</td></tr>
<tr><td><code id="MakeSnapshotInfo_+3A_makesurf">makesurf</code></td>
<td>

<p>Logical: should surface snapshots be processed?
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>inputdir must include all snapshot files as well as coord_sec1.txt,
coord_sec2.txt, and coord_sur.txt.
</p>
<p>MakeSnapshotInfo is fairly time-consuming, so it's separated from
MakeSnapshots so that MakeSnapshots can be run repeatedly to test
different graphical settings without having to re-calculate this
information every time.
</p>


<h3>Value</h3>

<p>A list of data to be passed to MakeSnapshots.
</p>


<h3>Author(s)</h3>

<p>Jake Anderson; code is heavily modified from Keehoon Kim's original
snapshot code.
</p>


<h3>See Also</h3>

<p>MakeSnapshots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Don't Run: (requires snapshot files)
## info = MakeSnapshotInfo('./snapshots', dframe = 20, N = 400,
## xs = 100, ys = 100, zs = 500)
## MakeSnapshots(info, outputdir = './anim', prefix = 'snapshot', dt = 0.1)
</code></pre>

<hr>
<h2 id='MakeSnapshots'>
Convert Binary Snapshot Output to PNGs
</h2><span id='topic+MakeSnapshots'></span>

<h3>Description</h3>

<p>With the help of MakeSnapshotInfo, converts binary snapshot output
files from infraFDTD to PNG format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MakeSnapshots(info, outputdir = "./anim", prefix = "snapshot", nums =
1:info$N, dt = 0.1, makesec1 = TRUE, makesec2 = TRUE, makesurf = TRUE,
res = 96, fn_topomap = "topomap.png", width = 480, height = NaN, asp =
1, pointsize = 12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MakeSnapshots_+3A_info">info</code></td>
<td>

<p>Output of MakeSnapshotInfo().
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_outputdir">outputdir</code></td>
<td>

<p>Directory where PNG files should be written.
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_prefix">prefix</code></td>
<td>

<p>Prefix to use in output file names (e.g., outputdir/prefix_sec1_001.png).
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_nums">nums</code></td>
<td>

<p>Vector of snapshot numbers to convert (default is all of them).
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_dt">dt</code></td>
<td>

<p>Snapshot interval in seconds
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_makesec1">makesec1</code></td>
<td>

<p>Logical: should section 1 snapshots be converted?
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_makesec2">makesec2</code></td>
<td>

<p>Logical: should section 2 snapshots be converted?
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_makesurf">makesurf</code></td>
<td>

<p>Logical: should surface snapshots be converted?
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_res">res</code></td>
<td>

<p>Resolution of output PNG files (see ?png).
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_fn_topomap">fn_topomap</code></td>
<td>

<p>File name for topo map output.
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_width">width</code></td>
<td>

<p>Width of output images (pixels)
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_height">height</code></td>
<td>

<p>Optional: if blank, MakeSnapshots() will find the correct height
given the image dimensions and asp. If set, forces the height of
output images.
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_asp">asp</code></td>
<td>

<p>Aspect ratio of images (default 1).
</p>
</td></tr>
<tr><td><code id="MakeSnapshots_+3A_pointsize">pointsize</code></td>
<td>

<p>Pointsize in output images (default 12).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use a shell command like 'convert' (imagemagick, available in linux)
to make a gif out of the stills.
</p>


<h3>Value</h3>

<p>None, file output only.
</p>


<h3>Author(s)</h3>

<p>Jake Anderson; code is heavily modified from Keehoon Kim's original.
</p>


<h3>See Also</h3>

<p>MakeSnapshotInfo
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Don't Run: (requires snapshot files)
## info = MakeSnapshotInfo('./snapshots', dframe = 20, N = 400,
## xs = 100, ys = 100, zs = 500)
## MakeSnapshots(info, outputdir = './anim', prefix = 'snapshot', dt = 0.1)
</code></pre>

<hr>
<h2 id='PrepFiles'>
Generate Input Files for infraFDTD
</h2><span id='topic+PrepFiles'></span>

<h3>Description</h3>

<p>infraFDTD requires text files defining the topography, atmospheric
sound speed structure, atmospheric density structure, and station
locations. PrepFiles generates these files from variables in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PrepFiles(X, sta, dh, fn_topo, fn_c, fn_rho, fn_sta, c = 335, rho = 1.2,
xlim = range(X$x), ylim = range(X$y), c_function = NA, rho_function =
NA, z_extent = NaN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PrepFiles_+3A_x">X</code></td>
<td>

<p>DEM. Must include elements x (vector), y (vector), z (matrix: nrow =
length(x), ncol = length(y))
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_sta">sta</code></td>
<td>

<p>Station info. Must include elements x, y (vectors in meters, in
same coordinate system as X). Station names are optionally stored in
element sta. z is optional and should only be included if you want 
microphones in the air. If z is missing, all stations are located on
surface. Otherwise, NaN elevations are located on the surface, and
non-NaN elevations are preserved. 
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_dh">dh</code></td>
<td>

<p>Grid Spacing (m).
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_fn_topo">fn_topo</code></td>
<td>

<p>Output file name for DEM.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_fn_c">fn_c</code></td>
<td>

<p>Output file name for sound speed. 
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_fn_rho">fn_rho</code></td>
<td>

<p>Output file name for density.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_fn_sta">fn_sta</code></td>
<td>

<p>Output file name for stations.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_c">c</code></td>
<td>

<p>Sound speed (m/s). If a scalar, sound speed is homogeneous in the
model. If a vector with length equal to the number of vertical nodes
in the model, sound speed varies vertically according to the vector
(this is inconvenient; it's normally better to use c_function for a
variable atmosphere). This input is ignored if c_function is provided.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_rho">rho</code></td>
<td>

<p>Density (kg/m^3). If a scalar, density is homogeneous in the
model. If a vector with length equal to the number of vertical nodes
in the model, density varies vertically according to the vector
(this is inconvenient; it's normally better to use rho_function for a
variable atmosphere). This input is ignored if rho_function is provided.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_xlim">xlim</code></td>
<td>

<p>X limits of output DEM&ndash;must be contained within the boundaries of DEM.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_ylim">ylim</code></td>
<td>

<p>Y limits of output DEM&ndash;must be contained within the boundaries of DEM.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_c_function">c_function</code></td>
<td>

<p>Function giving sound speed as a function of height. Consider using
approxfun() to generate this from an atmospheric profile.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_rho_function">rho_function</code></td>
<td>

<p>Function giving density as a function of height. Consider using
approxfun() to generate this from an atmospheric profile.
</p>
</td></tr>
<tr><td><code id="PrepFiles_+3A_z_extent">z_extent</code></td>
<td>

<p>Vertical thickness of model (m); must be greater than total relief in model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does not generate a param.h file; however, it does print
values that can be copied to param.h by the user.
</p>
<p>Consider using package rNOMADS to find the atmospheric profile.
</p>


<h3>Value</h3>

<p>None; print and file output only.
</p>


<h3>Author(s)</h3>

<p>Jake Anderson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate the DEM
data(volcano) # Maunga Whau (NZ) from built-in package "datasets"
DEM = list(x = 10 * 1:87, y = 10 * 1:61, z = volcano)

## choose the station locations
sta = list(x = c(100, 500), y = c(100, 500))

## show the topo map with stations
image(DEM, col = terrain.colors(20))
contour(DEM, add = TRUE)
points(sta, pch = 25, bg = 1)

## make the input files for infraFDTD, using the default homogeneous
## sound speed and density
PrepFiles(X = DEM, sta = sta, dh = 10, fn_topo = 'topo.txt', fn_c =
'c.txt', fn_rho = 'rho.txt', fn_sta = 'sta.txt')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
