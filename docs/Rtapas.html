<!DOCTYPE html><html lang="en"><head><title>Help for package Rtapas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rtapas}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#amph_trem'><p>amph_trem dataset</p></a></li>
<li><a href='#assoc_mat'><p>Create an host-symbiont association matrix</p></a></li>
<li><a href='#geo_D'><p>Geodesic distance between trees</p></a></li>
<li><a href='#gini_ci'><p>Plot the confidence intervals of Gini coefficient</p></a></li>
<li><a href='#gini_RSV'><p>The Gini coefficient adjusted for negative attributes (Raffinetti, Siletti,</p>
&amp; Vernizzi, 2015)</a></li>
<li><a href='#link_freq'><p>Frequency of host-symbiont association</p></a></li>
<li><a href='#linkf_CI'><p>Confidence intervals for the frequency of host-symbiont association</p></a></li>
<li><a href='#max_cong'><p>Algortihm for maximizing congruence between two phylogenies</p></a></li>
<li><a href='#max_incong'><p>Algortihm for maximizing incongruence between two phylogenies</p></a></li>
<li><a href='#nuc_cp'><p>Nuclear and chloroplast dataset of orchids</p></a></li>
<li><a href='#one2one_f'><p>Maximum number of unique one-to-one association over a number of runs</p></a></li>
<li><a href='#paco_ss'><p>Procrustes Approach to Cophylogeny (PACo) of the host and symbiont</p>
configurations</a></li>
<li><a href='#paraF'><p>Test of host-symbiont coevolution</p></a></li>
<li><a href='#prob_statistic'><p>Frequencies of the associations for the posterior probability trees</p></a></li>
<li><a href='#tangle_gram'><p>Tanglegram of the host-symbiont frequencies</p></a></li>
<li><a href='#trimHS_maxC'><p>Trims the H-S association matrix maximizing the congruence</p></a></li>
<li><a href='#trimHS_maxI'><p>Trims the H-S association matrix maximizing the incongruence</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Random Tanglegram Partitions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Applies a given global-fit method to random partial tanglegrams of a fixed size
             to identify the associations, terminals, and nodes that maximize phylogenetic
             (in)congruence. It also includes functions to compute more easily the confidence
             intervals of classification metrics and plot results, reducing computational time.
             See Llaberia-Robledillo et al., (2023) &lt;<a href="https://doi.org/10.1093%2Fsysbio%2Fsyad016">doi:10.1093/sysbio/syad016</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>phytools, parallel, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, distory, paco, parallelly, stats, stringr, vegan</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.2.1.1)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-12 11:43:29 UTC; Mar</td>
</tr>
<tr>
<td>Author:</td>
<td>Mar Llaberia-Robledillo
    <a href="https://orcid.org/0000-0002-7989-796X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Juan A. Balbuena <a href="https://orcid.org/0000-0003-4006-1353"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  José Ignacio Lucas-Lledó
    <a href="https://orcid.org/0000-0001-6254-8942"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph],
  Oscar Alejandro Pérez-Escobar
    <a href="https://orcid.org/0000-0001-9166-2410"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mar Llaberia-Robledillo &lt;mar.llaberia@uv.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-13 12:00:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='amph_trem'>amph_trem dataset</h2><span id='topic+amph_trem'></span><span id='topic+am_matrix'></span><span id='topic+amphipod'></span><span id='topic+trematode'></span><span id='topic+amphipod_1000tr'></span><span id='topic+trematode_1000tr'></span>

<h3>Description</h3>

<p>Data set of mitochondrial haplotypes of the trematode
<em>Coitocaecum parvum</em> (Crowcroft, 1945) and those of its
amphipod host, <em>Paracalliope fluviatilis</em> (Thomson, 1879)
from several locations in South Island, New Zeland
(Largue et al. 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(amph_trem)
</code></pre>


<h3>Format</h3>

<p>This data set compresses five objects:
</p>

<dl>
<dt><code>am_matrix</code></dt><dd><p>Associations between 17 haplotypes of
<em>Coitocaecum parvum</em> and 59 haplotypes of
<em>Paracalliope fluviatilis</em>.
A binary matrix with 59 rows (amphipod) and 17 variables (trematode).</p>
</dd>
<dt><code>amphipod</code></dt><dd><p><em>Paracalliope fluviatilis</em> consensus tree.
An object of class <code>"phylo"</code> containing a list with the details of
the consensus phylogenetic tree (i.e. edges, edges length, nodes, and
tips names).</p>
</dd>
<dt><code>trematode</code></dt><dd><p><em>Coitocaecum parvum</em> consensus tree.
An object of class <code>"phylo"</code> containing a list with the details of
the phylogenetic tree (i.e. edges, edges length, nodes and tips names).</p>
</dd>
<dt><code>amphipod_1000tr</code></dt><dd><p>1000 Bayesian posterior probability trees
of <em>Paracalliope fluviatilis</em>.
List of class <code>"multiphylo"</code> containing a 1000 phylogenetic trees
with their respective details (i.e. edges, edges length, nodes, and
tips names).</p>
</dd>
<dt><code>trematode_1000tr</code></dt><dd><p>1000 Bayesian posterior probability trees
of <em>Coitocaecum parvum</em>.
List of class <code>"multiphylo"</code> containing a 1000 phylogenetic trees
with their respective details (i.e. edges, edges length, nodes, and
tips names).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Balbuena J.A., Perez-Escobar O.A., Llopis-Belenguer C., Blasco-Costa I.
(2022). User’s Guide Random Tanglegram Partitions V.1.0.0. Zenodo.
<a href="https://doi.org/10.5281/zenodo.6327235">doi:10.5281/zenodo.6327235</a>
</p>


<h3>References</h3>

<p>Lagrue C., Joannes A., Poulin R., Blasco-Costa I. (2016). Genetic structure
and host–parasite co‐divergence: evidence for trait‐specific local adaptation.
Biological Journal of the Linnean Society. 118:344–358.
</p>
<p>Balbuena J.A., Perez-Escobar O.A., Llopis-Belenguer C., Blasco-Costa I.
(2022). User’s Guide Random Tanglegram Partitions V.1.0.0. Zenodo.
<a href="https://doi.org/10.5281/zenodo.6327235">doi:10.5281/zenodo.6327235</a>
</p>

<hr>
<h2 id='assoc_mat'>Create an host-symbiont association matrix</h2><span id='topic+assoc_mat'></span>

<h3>Description</h3>

<p>Creates a binary host-symbiont association matrix from a two-columns matrix
or data frame of host-symbiont associations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assoc_mat(hs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assoc_mat_+3A_hs">hs</code></td>
<td>
<p>A two-columns matrix or data frame representing associations
between hosts (column 1) and symbionts (column 2) species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An association binary matrix, with hosts in rows and symbionts in
columns, sorted alphabetically.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(nuc_cp)
NTaxa &lt;- sort(NUCtr$tip.label)
CPTaxa &lt;- sort(CPtr$tip.label)

NC &lt;- assoc_mat(data.frame(NTaxa, CPTaxa))


</code></pre>

<hr>
<h2 id='geo_D'>Geodesic distance between trees</h2><span id='topic+geo_D'></span>

<h3>Description</h3>

<p>For any trimmed matrix produced with
<code><a href="#topic+trimHS_maxC">trimHS_maxC()</a></code> it prunes the host-symbiont
phylogenies to conform with the trimmed matrix and computes geodesic
distance between the pruned trees.
<code>NOTE</code>: This function can only be used with strictly bifurcating trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geo_D(ths, treeH, treeS, strat = "sequential", cl = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geo_D_+3A_ths">ths</code></td>
<td>
<p>A trimmed matrix.</p>
</td></tr>
<tr><td><code id="geo_D_+3A_treeh">treeH</code></td>
<td>
<p>Host phylogeny. An object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="geo_D_+3A_trees">treeS</code></td>
<td>
<p>Symbiont phylogeny. An object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="geo_D_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="geo_D_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Geodesic distance
</p>


<h3>NOTE</h3>

<p>The <code>node.label</code> object in both trees can not contain NAs or null
values (i.e. no numeric value). All nodes should have a value. Else
remove node labels within the <code>"phylo"</code> class tree
with <code>tree$node.label &lt;- NULL</code>. For more details, see
<code><a href="distory.html#topic+dist.multiPhylo">distory::dist.multiPhylo()</a></code>.
</p>
<div class="sourceCode"><pre>  This function can not be used with the trimmed matrices produced
  with \code{\link[=trimHS_maxI]{trimHS_maxI()}} or with the algorithm
  \code{\link[=max_incong]{max_incong()}} in datasets with
  multiple host-symbiont associations.
</pre></div>


<h3>Source</h3>

<p>Balbuena J.A., Perez-Escobar O.A., Llopis-Belenguer C., Blasco-Costa I.
(2022). User’s Guide Random Tanglegram Partitions V.1.0.0. Zenodo.
</p>


<h3>References</h3>

<p>Schardl C.L., Craven K.D., Speakman S., Stromberg A., Lindstrom A.,
Yoshida R. (2008). A Novel Test for Host-Symbiont Codivergence Indicates
Ancient Origin of Fungal Endophytes in Grasses. Systematic Biology.
57:483–498.
</p>
<p>Balbuena J.A., Perez-Escobar Ó.A., Llopis-Belenguer C., Blasco-Costa I.
(2020). Random Tanglegram Partitions (Random TaPas): An Alexandrian Approach
to the Cophylogenetic Gordian Knot. Systematic Biology. 69:1212–1230.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(amph_trem)
N = 10 #for the example, we recommend 1e+4 value
n = 8

TAM &lt;- trimHS_maxC(N, am_matrix, n, check.unique = TRUE)
GD &lt;- geo_D(TAM, amphipod, trematode, strat = "sequential", cl = 1)


</code></pre>

<hr>
<h2 id='gini_ci'>Plot the confidence intervals of Gini coefficient</h2><span id='topic+gini_ci'></span>

<h3>Description</h3>

<p>Computes and displays in a boxplot the Gini coefficient and their
confidence intervals of the frequency (or residual/corrected frequencies)
distributions of the estimated (in)congruence metric (with any of the three
global-fit methods) of the individual host-symbiont associations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gini_ci(LF_1, M01, ylab = "Gini coefficient", plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gini_ci_+3A_lf_1">LF_1</code></td>
<td>
<p>Vector of statistics produced with
<code><a href="#topic+max_cong">max_cong()</a></code> or
<code><a href="#topic+max_incong">max_incong()</a></code> for <code>"geoD"</code>,
<code>"paco"</code> or <code>"paraF"</code>.</p>
</td></tr>
<tr><td><code id="gini_ci_+3A_m01">M01</code></td>
<td>
<p>Matrix produced with
<code><a href="#topic+prob_statistic">prob_statistic()</a></code> for <code>"geoD"</code>,
<code>"paco"</code> or <code>"paraF"</code> using <code>LF_1</code>.</p>
</td></tr>
<tr><td><code id="gini_ci_+3A_ylab">ylab</code></td>
<td>
<p>Title of the y label.</p>
</td></tr>
<tr><td><code id="gini_ci_+3A_plot">plot</code></td>
<td>
<p>Default is <code>"TRUE"</code>, plots the Gini coefficient and its
confidence intervals in a boxplot.</p>
</td></tr>
<tr><td><code id="gini_ci_+3A_...">...</code></td>
<td>
<p>Any optional argument admissible in
<code><a href="graphics.html#topic+boxplot">boxplot()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Gini values obtained and their representation in a boxplot, with
their confidence intervals.
</p>


<h3>NOTE</h3>

<p>It produces a conventional Gini coefficient (G)
(Ultsch and Lötsch 2017) if all output values are positive, or
a normalized Gini coefficient (G*) (Raffinetti et al. 2015) if
negative values are produced due to corrected frequencies
(if <code>res.fq = TRUE</code> or
<code>diff.fq = TRUE</code>). For more details see
Raffinetti et al. (2015).
</p>


<h3>References</h3>

<p>Ultsch A., Lötsch J. (2017). A data science based standardized Gini index
as a Lorenz dominance preserving measure of the inequality of distributions.
PLOS ONE. 12:e0181572. <a href="https://doi.org/10.1371/journal.pone.0181572">doi:10.1371/journal.pone.0181572</a>
</p>
<p>Raffinetti E., Siletti E., Vernizzi A. (2015). On the Gini coefficient
normalization when attributes with negative values are considered.
Stat Methods Appl. 24:507–521. <a href="https://doi.org/10.1007/s10260-014-0293-4">doi:10.1007/s10260-014-0293-4</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nuc_cp)
N = 1 #for the example, we recommend 1e+4 value
n = 15
# Maximizing congruence
NPc_PACo &lt;- max_cong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                symmetric = FALSE, ei.correct = "sqrt.D",
                percentile = 0.01, res.fq = FALSE)

# Loaded directly from dataset
# THSC &lt;- trimHS_maxC(N, np_matrix, n)
# pp_treesPACo_cong &lt;- prob_statistic(ths = THSc, np_matrix, NUC_500tr[1:10],
#                         CP_500tr[1:10], freqfun = "paco", NPc_PACo,
#                         symmetric = FALSE, ei.correct = "sqrt.D",
#                         percentile = 0.01, correction = "none")

gini_ci(LF_1 = NPc_PACo, M01 = pp_treesPACo_cong,
         ylab = "Gini Coefficient (G)",
         plot = TRUE, ylim = c(0.3, 0.8))
abline(h = 1/3) # because res.fq = TRUE

</code></pre>

<hr>
<h2 id='gini_RSV'>The Gini coefficient adjusted for negative attributes (Raffinetti, Siletti,
&amp; Vernizzi, 2015)</h2><span id='topic+gini_RSV'></span>

<h3>Description</h3>

<p>Computes the Gini coefficient adjusted for negative (even weighted) data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gini_RSV(y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gini_RSV_+3A_y">y</code></td>
<td>
<p>a vector of attributes containing even negative elements</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the Gini coefficient adjusted for negative attributes.
</p>


<h3>NOTE</h3>

<p>It produces a conventional Gini coefficient (G)
(Ultsch and Lötsch 2017) if all output values are positive, or
a normalized Gini coefficient (G*) (Raffinetti et al. 2015) if
negative values are produced due to corrected frequencies
(if <code>res.fq = TRUE</code> or
<code>diff.fq = TRUE</code>). For more details see
Raffinetti et al. (2015).
</p>


<h3>References</h3>

<p>Ultsch A., Lötsch J. (2017). A data science based standardized Gini index
as a Lorenz dominance preserving measure of the inequality of distributions.
PLOS ONE. 12:e0181572. <a href="https://doi.org/10.1371/journal.pone.0181572">doi:10.1371/journal.pone.0181572</a>
</p>
<p>Raffinetti E., Siletti E., Vernizzi A. (2015). On the Gini coefficient
normalization when attributes with negative values are considered.
Stat Methods Appl. 24:507–521. <a href="https://doi.org/10.1007/s10260-014-0293-4">doi:10.1007/s10260-014-0293-4</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(nuc_cp)
N = 10 #for the example, we recommend 1e+4 value
n = 15
# Maximizing congruence
NPc_PACo &lt;- max_cong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
               symmetric = FALSE, ei.correct = "sqrt.D",
               percentile = 0.01, res.fq = FALSE)
gini_RSV(y = NPc_PACo)


</code></pre>

<hr>
<h2 id='link_freq'>Frequency of host-symbiont association</h2><span id='topic+link_freq'></span>

<h3>Description</h3>

<p>Determines the frequency (or residual/corrected frequency) of each
host-symbiont association in a given percentile of cases that maximize
phylogenetic (in)congruence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>link_freq(
  x,
  fx,
  HS,
  percentile = 0.01,
  sep = "-",
  below.p = TRUE,
  res.fq = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="link_freq_+3A_x">x</code></td>
<td>
<p>List of trimmed matrices produced by
<code><a href="#topic+trimHS_maxC">trimHS_maxC()</a></code> or
<code><a href="#topic+trimHS_maxI">trimHS_maxI()</a></code>.</p>
</td></tr>
<tr><td><code id="link_freq_+3A_fx">fx</code></td>
<td>
<p>Vector of statistics produced with <code><a href="#topic+geo_D">geo_D()</a></code>,
<code><a href="#topic+paco_ss">paco_ss()</a></code> or <code><a href="#topic+paraF">paraF()</a></code></p>
</td></tr>
<tr><td><code id="link_freq_+3A_hs">HS</code></td>
<td>
<p>Host-symbiont association matrix.</p>
</td></tr>
<tr><td><code id="link_freq_+3A_percentile">percentile</code></td>
<td>
<p>Percentile to evaluate (<em>p</em>). Default is
<code>0.01</code> (1\%).</p>
</td></tr>
<tr><td><code id="link_freq_+3A_sep">sep</code></td>
<td>
<p>Character that separates host and symbiont labels.</p>
</td></tr>
<tr><td><code id="link_freq_+3A_below.p">below.p</code></td>
<td>
<p>Determines whether frequencies are to be computed below or
above the percentile set. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="link_freq_+3A_res.fq">res.fq</code></td>
<td>
<p>Determines whether a correction to avoid one-to-one
associations being overrepresented in the percentile evaluated.
If <code>TRUE</code> (default) a residual frequency value (observed -
expected frequency) is computed for each host-symbiont association.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with host-symbiont associations in rows. The first and
second columns display the names of the host and symbiont terminals,
respectively. The third column designates the host-symbiont
association by pasting the names of the terminals, and the fourth
column displays the frequency of occurrence of each host-symbiont
association. If <code>res.fq = TRUE</code>, column 5 displays the
corrected frequencies as a residual.
</p>


<h3>NOTE</h3>

<p>The <code>res.fq = TRUE</code> correction is recommended in tanglegrams with
large portion of multiple (as opposed to one-to-one) host-symbiont
associations. For future usage, frequencies of host-symbiont
associations above a given percentile values can also be computed
setting <code>below.p = FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(amph_trem)
N = 10 #for the example, we recommend 1e+4 value
n = 8

TAM &lt;- trimHS_maxC(N, am_matrix, n, check.unique = TRUE)
PACO &lt;- paco_ss(TAM, amphipod, trematode, symmetric = TRUE,
                ei.correct = "sqrt.D", strat = "parallel", cl = 8)
LFPACO &lt;- link_freq(TAM, PACO, am_matrix, percentile = 0.01,
                    below.p = TRUE, res.fq = TRUE)


</code></pre>

<hr>
<h2 id='linkf_CI'>Confidence intervals for the frequency of host-symbiont association</h2><span id='topic+linkf_CI'></span>

<h3>Description</h3>

<p>From the matrix obtained in <code><a href="#topic+prob_statistic">prob_statistic()</a></code>,
compute the confidence intervals for the frequencies (or residual/corrected
frequencies) of the host-symbiont associations using a set of pairs of
posterior probability trees of host and symbiont.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linkf_CI(
  freqfun = "paco",
  x,
  fx,
  c.level = 95,
  barplot = TRUE,
  col.bar = "lightblue",
  col.ci = "darkblue",
  y.lim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linkf_CI_+3A_freqfun">freqfun</code></td>
<td>
<p>Global-fit method. Options are <code>"geoD"</code>
(Geodesic Distances), <code>"paco"</code> (PACo) or <code>"paraF"</code>
(ParaFit). It should be the same method used to obtain <code>"fx"</code>.</p>
</td></tr>
<tr><td><code id="linkf_CI_+3A_x">x</code></td>
<td>
<p>Matrix produced with <code><a href="#topic+prob_statistic">prob_statistic()</a></code>
for<code>"geoD"</code> (Geodesic Distances),
<code>"paco"</code> (PACo) or <code>"paraF"</code> (ParaFit).</p>
</td></tr>
<tr><td><code id="linkf_CI_+3A_fx">fx</code></td>
<td>
<p>Vector of statistics produced with
<code><a href="#topic+max_cong">max_cong()</a></code> or
<code><a href="#topic+max_incong">max_incong</a></code> for<code>"geoD"</code>
(Geodesic Distances), <code>"paco"</code> (PACo) or <code>"paraF"</code>
(ParaFit).</p>
</td></tr>
<tr><td><code id="linkf_CI_+3A_c.level">c.level</code></td>
<td>
<p>Confidence interval level. Default is <code>95</code> (95\%).</p>
</td></tr>
<tr><td><code id="linkf_CI_+3A_barplot">barplot</code></td>
<td>
<p>Default is <code>"TRUE"</code>, plots the distribution and
confidence intervals of the frequencies.</p>
</td></tr>
<tr><td><code id="linkf_CI_+3A_col.bar">col.bar</code></td>
<td>
<p>A vector of colors for the bars or bar components.
By default, <code>"lightblue"</code> is used.</p>
</td></tr>
<tr><td><code id="linkf_CI_+3A_col.ci">col.ci</code></td>
<td>
<p>A vector of colors for the confidence intervals arrows.
By default, <code>"darkblue"</code> is used.</p>
</td></tr>
<tr><td><code id="linkf_CI_+3A_y.lim">y.lim</code></td>
<td>
<p>Limits for the y axis.</p>
</td></tr>
<tr><td><code id="linkf_CI_+3A_...">...</code></td>
<td>
<p>Any graphical option admissible in
<code><a href="graphics.html#topic+barplot">barplot()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with associations information (columns 1 and 2), the
observed value of the frequencies for these associations (column 3),
the mean, the minimum and the maximum value of the frequencies
(columns 4, 5 and 6) obtained with the sets of posterior
probability trees.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(nuc_cp)
N = 10 #for the example, we recommend 1e+4 value
n = 8
# Maximizing incongruence
NPi &lt;- max_incong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                 symmetric = FALSE, ei.correct = "sqrt.D",
                 percentile = 0.99, diff.fq = TRUE,
                 strat = "parallel", cl = 8)
# Loaded directly from dataset
# THSi &lt;- trimHS_maxI(N, np_matrix, n)
# pp_treesPACo_incong &lt;- prob_statistic(ths = THSi, np_matrix,
#                        NUC_500tr[1:5], CP_500tr[1:5], freqfun = "paco",
#                        NPi, symmetric = FALSE, ei.correct = "sqrt.D",
#                        percentile = 0.99, diff.fq = TRUE, res.fq = FALSE,
#                        below.p = FALSE, strat = "parallel", cl = 8)
LFci &lt;- linkf_CI (freqfun = "paco", x = pp_treesPACo_incong, fx = NPi,
                  c.level = 95, ylab = "Observed - Expected frequency")


</code></pre>

<hr>
<h2 id='max_cong'>Algortihm for maximizing congruence between two phylogenies</h2><span id='topic+max_cong'></span>

<h3>Description</h3>

<p>Prunes the host (H) and symbiont (S) phylogenies to conform with trimmed
matrices and computes the given global fit method, Geodesic distances (GD),
Procrustes Approach to Cophylogeny (PACo) or ParaFit (Legendre et al. 2002)
between the pruned trees. Then, determines the frequency or corrected
residual of each host-symbiont association occurring in a given percentile
of cases that maximize phylogenetic congruence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max_cong(
  HS,
  treeH,
  treeS,
  n,
  N,
  method = "paco",
  symmetric = FALSE,
  ei.correct = "none",
  percentile = 0.01,
  res.fq = TRUE,
  strat = "sequential",
  cl = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="max_cong_+3A_hs">HS</code></td>
<td>
<p>Host-Symbiont association matrix.</p>
</td></tr>
<tr><td><code id="max_cong_+3A_treeh">treeH</code></td>
<td>
<p>Host phyolgeny. An object of class &quot;phylo&quot;.</p>
</td></tr>
<tr><td><code id="max_cong_+3A_trees">treeS</code></td>
<td>
<p>Symbiont phylogeny. An object of class &quot;phylo&quot;.</p>
</td></tr>
<tr><td><code id="max_cong_+3A_n">n</code></td>
<td>
<p>Number of unique associations.</p>
</td></tr>
<tr><td><code id="max_cong_+3A_n">N</code></td>
<td>
<p>Number of runs.</p>
</td></tr>
<tr><td><code id="max_cong_+3A_method">method</code></td>
<td>
<p>Specifies the desired global-fit method (GD, PACo or ParaFit).
The default is <code>PACo</code>. Options are <code>"geoD"</code> (Geodesic
Distances), <code>"paco"</code> (PACo) or <code>"paraF"</code> (ParaFit).</p>
</td></tr>
<tr><td><code id="max_cong_+3A_symmetric">symmetric</code></td>
<td>
<p>Specifies the type of Procrustes superimposition. Default
is <code>FALSE</code>, indicates that the superposition is applied
asymmetrically (S depends on H). If <code>TRUE</code>, PACo is applied
symmetrically (dependency between S and H is reciprocal).</p>
</td></tr>
<tr><td><code id="max_cong_+3A_ei.correct">ei.correct</code></td>
<td>
<p>Specifies how to correct potential negative eigenvalues
from the conversion of phylogenetic distances into Principal
Coordinates: <code>"none"</code> (the default) indicates that no correction
is applied, particularly if H and S are ultrametric; <code>"sqrt.D"</code>
takes the element-wise square-root of the phylogenetic distances;
<code>"lingoes"</code> and <code>"cailliez"</code> apply the classical Lingoes
and Cailliez corrections, respectively.</p>
</td></tr>
<tr><td><code id="max_cong_+3A_percentile">percentile</code></td>
<td>
<p>Percentile to evaluate (<em>p</em>). Default is
<code>0.01</code> (1\%).</p>
</td></tr>
<tr><td><code id="max_cong_+3A_res.fq">res.fq</code></td>
<td>
<p>Determines whether a correction to avoid one-to-one
associations being overrepresented in the percentile evaluated.
If <code>TRUE</code> (default) a residual frequency value (observed -
expected frequency) is computed for each host-symbiont association.</p>
</td></tr>
<tr><td><code id="max_cong_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="max_cong_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with host-symbiont associations in rows. The first and
second columns display the names of the host and symbiont terminals,
respectively. The third column designates the host-symbiont
association by pasting the names of the terminals, and the fourth
column displays the frequency of occurrence of each host-symbiont
association in <em>p</em>. If <code>res.fq = TRUE</code>, column 5 displays
the corrected frequencies as a residual.
</p>


<h3>NOTE</h3>

<p>If the <code>node.label</code> object in both trees contains NAs or empty
values (i.e. no numeric value). All nodes should have a value. Else
remove node labels within the <code>"phylo"</code> class tree
with <code>tree$node.label &lt;- NULL</code>. For more details, see
<code><a href="distory.html#topic+dist.multiPhylo">distory::dist.multiPhylo()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nuc_pc)
N = 1 #for the example, we recommend 1e+4 value
n = 15
NPc &lt;- max_cong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                symmetric = FALSE, ei.correct = "sqrt.D",
                percentile = 0.01, res.fq = FALSE)

</code></pre>

<hr>
<h2 id='max_incong'>Algortihm for maximizing incongruence between two phylogenies</h2><span id='topic+max_incong'></span>

<h3>Description</h3>

<p>Prunes the host (H) and symbiont (S) phylogenies to conform with the trimmed
matrix and computes the given global-fit method (PACo or ParaFit) between
the pruned trees. Then, determines the frequency of each host-symbiont
association occurring in a given percentile of cases that maximize
phylogenetic incongruence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max_incong(
  HS,
  treeH,
  treeS,
  n,
  N,
  method = "paco",
  symmetric = FALSE,
  ei.correct = "none",
  percentile = 0.99,
  diff.fq = FALSE,
  strat = "sequential",
  cl = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="max_incong_+3A_hs">HS</code></td>
<td>
<p>Host-Symbiont association matrix.</p>
</td></tr>
<tr><td><code id="max_incong_+3A_treeh">treeH</code></td>
<td>
<p>Host phyolgeny. An object of class &quot;phylo&quot;.</p>
</td></tr>
<tr><td><code id="max_incong_+3A_trees">treeS</code></td>
<td>
<p>Symbiont phylogeny. An object of class &quot;phylo&quot;.</p>
</td></tr>
<tr><td><code id="max_incong_+3A_n">n</code></td>
<td>
<p>Number of associations.</p>
</td></tr>
<tr><td><code id="max_incong_+3A_n">N</code></td>
<td>
<p>Number of runs.</p>
</td></tr>
<tr><td><code id="max_incong_+3A_method">method</code></td>
<td>
<p>Specifies the desired global-fit method (PACo or ParaFit).
The default is <code>PACo</code>. Options are <code>"paco"</code> (PACo) or
<code>"paraF"</code> (ParaFit).</p>
</td></tr>
<tr><td><code id="max_incong_+3A_symmetric">symmetric</code></td>
<td>
<p>Specifies the type of Procrustes superimposition. Default
is <code>FALSE</code>, indicates that the superposition is applied
asymmetrically (S depends on H). If <code>TRUE</code>, PACo is applied
symmetrically (dependency between S and H is reciprocal).</p>
</td></tr>
<tr><td><code id="max_incong_+3A_ei.correct">ei.correct</code></td>
<td>
<p>Specifies how to correct potential negative eigenvalues
from the conversion of phylogenetic distances into Principal
Coordinates: <code>"none"</code> (the default) indicates that no correction
is applied, particularly if H and S are ultrametric; <code>"sqrt.D"</code>
takes the element-wise square-root of the phylogenetic distances;
<code>"lingoes"</code> and <code>"cailliez"</code> apply the classical Lingoes
and Cailliez corrections, respectively.</p>
</td></tr>
<tr><td><code id="max_incong_+3A_percentile">percentile</code></td>
<td>
<p>Percentile to evaluate (<em>p</em>). Default is
<code>0.99</code> (99\%).</p>
</td></tr>
<tr><td><code id="max_incong_+3A_diff.fq">diff.fq</code></td>
<td>
<p>Determines whether a correction to detect those associations
that present a similar contribution to (in)congruence and occur with
some frequency at the 0.01 and 0.99 percentiles. These correction
avoid multiple associations being overrepresented.
If <code>TRUE</code> a corrected frequency value (observed in p -
observed in (p-1)) is computed for each host-symbiont association.</p>
</td></tr>
<tr><td><code id="max_incong_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="max_incong_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.y.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with host-symbiont associations in rows. The first and
second columns display the names of the host and symbiont terminals,
respectively. The third column designates the host-symbiont
association by pasting the names of the terminals, and the fourth
column displays the frequency of occurrence of each host-symbiont
association in <em>p</em>. If <code>diff.fq = TRUE</code>, column 5 displays
the corrected frequencies.
</p>


<h3>NOTE</h3>

<p>The <code>node.label</code> object in both trees can not contain NAs or null
values (i.e. no numeric value). All nodes should have a value. Else
remove node labels within the <code>"phylo"</code> class tree
with <code>tree$node.label &lt;- NULL</code>. For more details, see
<code><a href="distory.html#topic+dist.multiPhylo">distory::dist.multiPhylo()</a></code>.
</p>
<div class="sourceCode"><pre>  \code{GD} method can not be used with the trimmed matrices produced
  with \code{\link[=trimHS_maxI]{trimHS_maxI()}} or with the algorithm
  \code{\link[=max_incong]{max_incong()}} for those datasets with
  multiple associations.
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>data(nuc_pc)
N = 1 #for the example, we recommend 1e+4 value
n = 15
NPi &lt;- max_incong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                  symmetric = FALSE, ei.correct = "sqrt.D",
                  percentile = 0.99, diff.fq = TRUE)


</code></pre>

<hr>
<h2 id='nuc_cp'>Nuclear and chloroplast dataset of orchids</h2><span id='topic+nuc_cp'></span><span id='topic+np_matrix'></span><span id='topic+NUCtr'></span><span id='topic+CPtr'></span><span id='topic+NUC_500tr'></span><span id='topic+CP_500tr'></span><span id='topic+pp_treesPACo_cong'></span><span id='topic+pp_treesPACo_incong'></span>

<h3>Description</h3>

<p>Data set of nuclear and chloroplast loci of 52 orchid taxa
from Kew DNA and Tissue Collection,
https://dnabank.science.kew.org/homepage.html
(Perez-Escobar et al. 2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nuc_cp)
</code></pre>


<h3>Format</h3>

<p>This data set consists of seven objects:
</p>

<dl>
<dt><code>np_matrix</code></dt><dd><p>Associations one-to-one between the 52 orchid
taxa.
A binary matrix with 52 rows (nuclear) and 52 columns (chloroplast).</p>
</dd>
<dt><code>NUCtr</code></dt><dd><p>Phylogeny constructed by sequence data of nuclear
loci of orchids (Perez-Escobar et al. 2021).
An object of class <code>"phylo"</code> containing the details of
the phylogenetic tree (i.e. edge, edge length, nodes and tips names).</p>
</dd>
<dt><code>CPtr</code></dt><dd><p>Phylogeny constructed by sequence data of chloroplast
loci of orchids (Perez-Escobar et al. 2021).
An object of class <code>"phylo"</code> containing the details of
the phylogenetic tree (i.e. edge, edge length, nodes and tips names).</p>
</dd>
<dt><code>NUC_500tr</code></dt><dd><p>500 bootstrap replicates trees from
Perez-Escobar et al. (2021).
Object of class <code>"multiphylo"</code> containing a 500 phylogenetic trees
with their respective details (i.e. edges, edges length, nodes, and
tips names).</p>
</dd>
<dt><code>CP_500tr</code></dt><dd><p>500 bootstrap replicates trees from
Perez-Escobar et al. (2021).
Object of class <code>"multiphylo"</code> containing a 500 phylogenetic trees
with their respective details (i.e. edges, edges length, nodes, and
tips names).</p>
</dd>
<dt><code>pp_treesPACo_cong</code></dt><dd><p>Matrix with the value of the PACo
statistics generated for each pair (H and S) of posterior probability
trees maximizing congruence between them.</p>
</dd>
<dt><code>pp_treesPACo_incong</code></dt><dd><p>Matrix with the value of the PACo
statistics generated for each pair (H and S) of posterior probability
trees maximizing incongruence between them.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Perez-Escobar O.A., Dodsworth S., Bogarin D., Bellot S., Balbuena J.A.,
Schley R., Kikuchi I., Morris S.K., Epitawalage N., Cowan R., Maurin O.,
Zuntini A., Arias T., Serna A., Gravendeel B., Torres M.F., Nargar K.,
Chomicki G., Chase M.W., Leitch I.J., Forest F., Baker W.J. (2021).
Hundreds of nuclear and plastid loci yield novel insights into orchid
relationships. American Journal of Botany, 108(7), 1166-1180.
</p>


<h3>References</h3>

<p>Perez-Escobar O.A., Dodsworth S., Bogarin D., Bellot S., Balbuena J.A.,
Schley R., Kikuchi I., Morris S.K., Epitawalage N., Cowan R., Maurin O.,
Zuntini A., Arias T., Serna A., Gravendeel B., Torres M.F., Nargar K.,
Chomicki G., Chase M.W., Leitch I.J., Forest F., Baker W.J. (2021).
Hundreds of nuclear and plastid loci yield novel insights into orchid
relationships. American Journal of Botany, 108(7), 1166-1180.
</p>

<hr>
<h2 id='one2one_f'>Maximum number of unique one-to-one association over a number of runs</h2><span id='topic+one2one_f'></span>

<h3>Description</h3>

<p>For a binary matrix of host-symbiont associations, it finds the maximum
number of host-symbiont pairs, <code>n</code>, for which one-to-one unique
associations can be chosen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>one2one_f(
  HS,
  reps = 10000,
  interval = NULL,
  strat = "sequential",
  cl = 1,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="one2one_f_+3A_hs">HS</code></td>
<td>
<p>Host-symbiont association matrix.</p>
</td></tr>
<tr><td><code id="one2one_f_+3A_reps">reps</code></td>
<td>
<p>Number of runs to evaluate.</p>
</td></tr>
<tr><td><code id="one2one_f_+3A_interval">interval</code></td>
<td>
<p>Vector with the minimum and maximum <code>n</code> that the user
wants to test. Default is <code>"NULL"</code>, where a minimum <code>n</code>
(10% of the total associations) and a maximum <code>n</code> (20% of the
total associations) are automatically assigned.</p>
</td></tr>
<tr><td><code id="one2one_f_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="one2one_f_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td></tr>
<tr><td><code id="one2one_f_+3A_plot">plot</code></td>
<td>
<p>Default is <code>"TRUE"</code>, plots the number of unique host-
symbiont associations in the <code>"interval"</code> range against the
number of runs that could be completed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The maximum number of unique one-to-one associations
(<code>n</code>).
</p>


<h3>NOTE</h3>

<p>It can be used to decide the best <code>n</code> prior to application of
<code><a href="#topic+max_cong">max_cong()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
N = 10  #for the example, we recommend 1e+4 value
data(amph_trem)
n &lt;- one2one_f(am_matrix, reps = N, interval = c(2, 10), plot = TRUE)


</code></pre>

<hr>
<h2 id='paco_ss'>Procrustes Approach to Cophylogeny (PACo) of the host and symbiont
configurations</h2><span id='topic+paco_ss'></span>

<h3>Description</h3>

<p>For any trimmed matrix produced with
<code><a href="#topic+trimHS_maxC">trimHS_maxC()</a></code> or
<code><a href="#topic+trimHS_maxI">trimHS_maxI()</a></code>, it prunes the host (H) and
symbiont (S) phylogenies to conform with the trimmed matrix and runs
Procruste Approach to Cophylogeny (PACo) to produce the squared sum of
residuals of the Procrustes superimposition of the host and symbiont
configurations in Euclidean space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paco_ss(
  ths,
  treeH,
  treeS,
  symmetric = FALSE,
  proc.warns = FALSE,
  ei.correct = "none",
  strat = "sequential",
  cl = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="paco_ss_+3A_ths">ths</code></td>
<td>
<p>Trimmed matrix.</p>
</td></tr>
<tr><td><code id="paco_ss_+3A_treeh">treeH</code></td>
<td>
<p>Host phylogeny. An object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="paco_ss_+3A_trees">treeS</code></td>
<td>
<p>Symbiont phylogeny. An object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="paco_ss_+3A_symmetric">symmetric</code></td>
<td>
<p>Specifies the type of Procrustes superimposition. Default
is <code>FALSE</code>, indicates that the superposition is applied
asymmetrically (S depends on H). If <code>TRUE</code>, PACo is applied
symmetrically (dependency between S and H is reciprocal).</p>
</td></tr>
<tr><td><code id="paco_ss_+3A_proc.warns">proc.warns</code></td>
<td>
<p>Switches on/off trivial warnings returned when treeH and
treeS differ in size (number of tips). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="paco_ss_+3A_ei.correct">ei.correct</code></td>
<td>
<p>Specifies how to correct potential negative eigenvalues
from the conversion of phylogenetic distances into Principal
Coordinates: <code>"none"</code> (the default) indicates that no correction
is applied, particularly if H and S are ultrametric; <code>"sqrt.D"</code>
takes the element-wise square-root of the phylogenetic distances;
<code>"lingoes"</code> and <code>"cailliez"</code> apply the classical Lingoes
and Cailliez corrections, respectively.</p>
</td></tr>
<tr><td><code id="paco_ss_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="paco_ss_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A sum of squared residuals.
</p>


<h3>Source</h3>

<p>Balbuena J.A., Perez-Escobar O.A., Llopis-Belenguer C., Blasco-Costa I.
(2022). User’s Guide Random Tanglegram Partitions V.1.0.0. Zenodo.
</p>


<h3>References</h3>

<p>Balbuena J.A., Miguez-Lozano R., Blasco-Costa I. (2013). PACo: A Novel
Procrustes Application to Cophylogenetic Analysis. PLOS ONE. 8:e61048.
</p>
<p>Balbuena J.A., Perez-Escobar Ó.A., Llopis-Belenguer C., Blasco-Costa I.
(2020). Random Tanglegram Partitions (Random TaPas): An Alexandrian Approach
to the Cophylogenetic Gordian Knot. Systematic Biology. 69:1212–1230.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(amph_trem)
N = 10 #for the example, we recommend 1e+4 value
n = 8

TAM &lt;- trimHS_maxC(N, am_matrix, n, check.unique = TRUE)
PACO &lt;- paco_ss(TAM, amphipod, trematode, symmetric = TRUE,
                ei.correct = "sqrt.D", strat = "parallel", cl = 8)


</code></pre>

<hr>
<h2 id='paraF'>Test of host-symbiont coevolution</h2><span id='topic+paraF'></span>

<h3>Description</h3>

<p>For any trimmed matrix produced with
<code><a href="#topic+trimHS_maxC">trimHS_maxC()</a></code> or
<code><a href="#topic+trimHS_maxI">trimHS_maxI()</a></code>, it prunes the host (H) and
symbiont (S) phylogenies to conform with the trimmed matrix and runs
<code><a href="ape.html#topic+parafit">ape::parafit()</a></code> (Legendre et al. 2002) to
calculate the ParaFitGlobal Statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paraF(ths, treeH, treeS, ei.correct = "none", strat = "sequential", cl = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="paraF_+3A_ths">ths</code></td>
<td>
<p>Trimmed matrix.</p>
</td></tr>
<tr><td><code id="paraF_+3A_treeh">treeH</code></td>
<td>
<p>Host phylogeny. An object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="paraF_+3A_trees">treeS</code></td>
<td>
<p>Symbiont phylogeny. An object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="paraF_+3A_ei.correct">ei.correct</code></td>
<td>
<p>Specifies how to correct potential negative eigenvalues
from the conversion of phylogenetic distances into Principal
Coordinates: <code>"none"</code> (the default) indicates that no correction
is applied, particularly if H and S are ultrametric; <code>"sqrt.D"</code>
takes the element-wise square-root of the phylogenetic distances;
<code>"lingoes"</code> and <code>"cailliez"</code> apply the classical Lingoes and
Cailliez corrections, respectively.</p>
</td></tr>
<tr><td><code id="paraF_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="paraF_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number object with the ParaFitGlobal Statistic of host-symbiont
test for the N trimmed matrix.
</p>


<h3>References</h3>

<p>Legendre P., Desdevises Y., Bazin E. (2002). A Statistical Test for
Host–Parasite Coevolution. Systematic Biology. 51:217–234.
</p>
<p>Balbuena J.A., Perez-Escobar O.A., Llopis-Belenguer C., Blasco-Costa I.
(2020). Random Tanglegram Partitions (Random TaPas): An Alexandrian Approach
to the Cophylogenetic Gordian Knot. Systematic Biology. 69:1212–1230.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(amph_trem)
N = 10 #for the example, we recommend 1e+4 value
n = 8

TAM &lt;- trimHS_maxC(N, am_matrix, n, check.unique = TRUE)
PF &lt;- paraF(TAM, amphipod, trematode, ei.correct = "sqrt.D",
           strat = "parallel", cl = 8)



</code></pre>

<hr>
<h2 id='prob_statistic'>Frequencies of the associations for the posterior probability trees</h2><span id='topic+prob_statistic'></span>

<h3>Description</h3>

<p>Computes frequencies (or residual/corrected frequencies) of the
host-symbiont associations for pairs (H and S) of posterior  probability
trees from the statistics generatedwith <code>GD</code> (Geodesic Distances),
<code>PACo</code> (PACo) or <code>ParaFit</code>(ParaFit).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_statistic(
  ths,
  HS,
  mTreeH,
  mTreeS,
  freqfun = "paco",
  fx,
  percentile = 0.01,
  correction = "none",
  symmetric = FALSE,
  ei.correct = "none",
  algm = "maxcong",
  proc.warns = FALSE,
  strat = "sequential",
  cl = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob_statistic_+3A_ths">ths</code></td>
<td>
<p>List of trimmed matrices produced by
<code><a href="#topic+trimHS_maxC">trimHS_maxC()</a></code> or
<code><a href="#topic+trimHS_maxI">trimHS_maxI()</a></code>.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_hs">HS</code></td>
<td>
<p>Host-Symbiont association matrix.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_mtreeh">mTreeH</code></td>
<td>
<p>Number of posterior-probability trees of host.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_mtrees">mTreeS</code></td>
<td>
<p>Number of posterior-probability trees of symbiont.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_freqfun">freqfun</code></td>
<td>
<p>The global-fit method to compute using the
posterior probability trees. Options are <code>"geoD"</code> (Geodesic
Distances), <code>"paco"</code> (PACo) or <code>"paraF"</code> (ParaFit).
It should be the same method used to obtain <code>"fx"</code>.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_fx">fx</code></td>
<td>
<p>Vector of statistics produced with
<code><a href="#topic+max_cong">max_cong()</a></code> or
<code><a href="#topic+max_incong">max_incong()</a></code> for GD, PACo or
ParaFit.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_percentile">percentile</code></td>
<td>
<p>Percentile to evaluate (<em>p</em>). Default is
<code>0.01</code> (1\%).</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_correction">correction</code></td>
<td>
<p>Correction to be assumed. The default value is
<code>"none"</code>. If <code>= "res.fq"</code>, a residual frequency value
(observed - expected frequency) is computed for each host-symbiont
association that maximizes phylogenetic congruence. If
<code>= "diff.fq"</code>, a corrected frequency value
(observed in p - observed in (p-1)) is computed for each
host-symbiont association.
It should be the same correction used to obtain <code>"fx"</code>.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_symmetric">symmetric</code></td>
<td>
<p>Specifies the type of Procrustes superimposition. Default
is <code>FALSE</code>, indicates that the superposition is applied
asymmetrically (S depends on H). If <code>TRUE</code>, PACo is applied
symmetrically (dependency between S and H is reciprocal).</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_ei.correct">ei.correct</code></td>
<td>
<p>Specifies how to correct potential negative eigenvalues
from the conversion of phylogenetic distances into Principal
Coordinates: <code>"none"</code> (the default) indicates that no correction
is applied, particularly if H and S are ultrametric; <code>"sqrt.D"</code>
takes the element-wise square-root of the phylogenetic distances;
<code>"lingoes"</code> and <code>"cailliez"</code> apply the classical Lingoes
and Cailliez corrections, respectively.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_algm">algm</code></td>
<td>
<p>Only required if <code>correction = "none"</code>. Specifies the
algorithm that has been used to obtain
<code>"fx"</code> without correction. Use <code>= "maxcong"</code> for
<code><a href="#topic+max_cong">max_cong()</a></code>, and <code>= "maxincong"</code> for
<code><a href="#topic+max_incong">max_incong()</a></code>.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_proc.warns">proc.warns</code></td>
<td>
<p>Switches on/off trivial warnings returned when treeH and
treeS differ in size (number of tips). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="prob_statistic_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the value of the statistics for each of the
probability trees.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("nuc_cp")
N = 10 #for the example, we recommend 1e+4 value
n = 15
# Maximizing congruence (not run)
NPc &lt;- max_cong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                symmetric = FALSE, ei.correct = "sqrt.D",
                percentile = 0.01, strat = "parallel", cl = 8)
THSc &lt;- trimHS_maxC(N, np_matrix, n)
pp_treesPACOo_cong &lt;- prob_statistic(THSc, np_matrix, NUC_500tr[1:10],
                         CP_500tr[1:10], freqfun = "paco", NPc,
                         percentile = 0.01, correction = "none",
                         algm = "maxcong", symmetric = FALSE,
                         ei.correct = "sqrt.D",
                         strat = "parallel", cl = 8)

# Maximizing incongruence
NPi &lt;- max_incong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                  symmetric = FALSE, ei.correct = "sqrt.D",
                  percentile = 0.99, diff.fq = TRUE)
THSi &lt;- trimHS_maxI(N, np_matrix, n)
pp_treesPACOo_incong &lt;- prob_statistic(THSi, np_matrix, NUC_500tr[1:5],
                                 CP_500tr[1:5], freqfun = "paco", NPi,
                                 percentile = 0.99, correction = "diff.fq",
                                 symmetric = FALSE, ei.correct = "sqrt.D",
                                 strat = "parallel", cl = 8)


</code></pre>

<hr>
<h2 id='tangle_gram'>Tanglegram of the host-symbiont frequencies</h2><span id='topic+tangle_gram'></span>

<h3>Description</h3>

<p>Maps the estimated (in)congruence metrics of the individual host-symbiont
associations as heatmap on a tanglegram. It also plots the average frequency
(or residual/corrected frequency) of occurrence of each terminal
and optionally, the fast maximum likelihood estimators of ancestral states
of each node.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tangle_gram(
  treeH,
  treeS,
  HS,
  fqtab,
  colscale = "diverging",
  colgrad,
  nbreaks = 50,
  node.tag = TRUE,
  cexpt = 1,
  link.lwd = 1,
  link.lty = 1,
  fsize = 0.5,
  pts = FALSE,
  link.type = "straight",
  ftype = "i",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tangle_gram_+3A_treeh">treeH</code></td>
<td>
<p>Host phylogeny. An object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_trees">treeS</code></td>
<td>
<p>Symbiont phylogeny. An object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_hs">HS</code></td>
<td>
<p>Host-symbiont association matrix.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_fqtab">fqtab</code></td>
<td>
<p>Dataframe produced with <code><a href="#topic+max_cong">max_cong()</a></code> or
<code><a href="#topic+max_incong">max_incong()</a></code>.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_colscale">colscale</code></td>
<td>
<p>Choose between <code>"diverging"</code>, color reflects distance
from 0 (centered at 0, recommended if <code>"res.fq = TRUE"</code>)
or <code>"sequential"</code>, color reflects distance from minimum value
(spanning from the min to max frequencies observed).</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_colgrad">colgrad</code></td>
<td>
<p>Vector of R specified colors defining the color gradient of
the heatmap.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_nbreaks">nbreaks</code></td>
<td>
<p>Number of discrete values along <code>"colgrad"</code>.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_node.tag">node.tag</code></td>
<td>
<p>Specifies whether maximum likelihood estimators of ancestral
states are to be computed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_cexpt">cexpt</code></td>
<td>
<p>Size of color points at terminals and nodes.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_link.lwd">link.lwd</code></td>
<td>
<p>Line width for plotting, default to 1.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_link.lty">link.lty</code></td>
<td>
<p>Line type. Coded as <code>lty</code> in
<code><a href="graphics.html#topic+par">par()</a></code>.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_fsize">fsize</code></td>
<td>
<p>Relative font size for tip labels.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_pts">pts</code></td>
<td>
<p>Logical value indicating whether or not to plot filled circles at
each vertex of the tree, as well as at transition points between
mapped states. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_link.type">link.type</code></td>
<td>
<p>If curved linking lines are desired, set to <code>"curved"</code>.
Default is <code>"straight"</code>.</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_ftype">ftype</code></td>
<td>
<p>Font type. Options are <code>"reg"</code>, <code>"i"</code>
(italics), <code>"b"</code> (bold) or <code>"bi"</code> (bold-italics).</p>
</td></tr>
<tr><td><code id="tangle_gram_+3A_...">...</code></td>
<td>
<p>Any graphical option admissible in
<code><a href="phytools.html#topic+plot.cophylo">phytools::plot.cophylo()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tanglegram with quantitative information displayed as heatmap.
</p>


<h3>NOTE</h3>

<p>In order to calculate the ancestral states in the phylogenies, all
nodes of the trees (node.label) must have a value (NA or
empty values are not allowed). In addition, the trees must be
time-calibrated and preferably rooted. If one of these elements
is missing, an error will be generated and nodes and points of
terminals will be displayed as black.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nuc_cp)
N = 10 #for the example, we recommend 1e+4 value
n = 8
NPc &lt;- max_cong(np_matrix, NUCtr, CPtr, n, N, method = "paco",
                symmetric = TRUE, ei.correct = "sqrt.D",
                percentile = 0.01, res.fq = FALSE,
                strat = "parallel", cl = 4)
col = c("darkorchid4", "gold")
tangle_gram(NUCtr, CPtr, np_matrix, NPc, colscale = "sequential",
            colgrad = col, nbreaks = 50, node.tag = TRUE)


</code></pre>

<hr>
<h2 id='trimHS_maxC'>Trims the H-S association matrix maximizing the congruence</h2><span id='topic+trimHS_maxC'></span>

<h3>Description</h3>

<p>For N runs, it randomly chooses <code>n</code> unique one-to-one associations and
trims the H-S association matrix to include only the n associations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trimHS_maxC(N, HS, n, check.unique = TRUE, strat = "sequential", cl = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trimHS_maxC_+3A_n">N</code></td>
<td>
<p>Number of runs.</p>
</td></tr>
<tr><td><code id="trimHS_maxC_+3A_hs">HS</code></td>
<td>
<p>Host-Symbiont association matrix.</p>
</td></tr>
<tr><td><code id="trimHS_maxC_+3A_n">n</code></td>
<td>
<p>Number of unique associations.</p>
</td></tr>
<tr><td><code id="trimHS_maxC_+3A_check.unique">check.unique</code></td>
<td>
<p>if <code>TRUE</code> discards duplicated trimmed matrices. This
alternative is recommended if <code>n</code> is small, because the
probability of obtaining the same trimmed matrix in different runs
increases as <code>n</code> decreases.</p>
</td></tr>
<tr><td><code id="trimHS_maxC_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="trimHS_maxC_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the N trimmed matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(nuc_cp)
N = 10  #for the example, we recommend 1e+4 value
n = 15
TNC &lt;- trimHS_maxC(N, np_matrix, n, check.unique = TRUE)


</code></pre>

<hr>
<h2 id='trimHS_maxI'>Trims the H-S association matrix maximizing the incongruence</h2><span id='topic+trimHS_maxI'></span>

<h3>Description</h3>

<p>For N runs, it randomly chooses <code>n</code> associations and trims the H-S
association matrix to include them, allowing both single and multiple
associations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trimHS_maxI(N, HS, n, check.unique = TRUE, strat = "sequential", cl = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trimHS_maxI_+3A_n">N</code></td>
<td>
<p>Number of runs.</p>
</td></tr>
<tr><td><code id="trimHS_maxI_+3A_hs">HS</code></td>
<td>
<p>Host-Symbiont association matrix.</p>
</td></tr>
<tr><td><code id="trimHS_maxI_+3A_n">n</code></td>
<td>
<p>Number of associations.</p>
</td></tr>
<tr><td><code id="trimHS_maxI_+3A_check.unique">check.unique</code></td>
<td>
<p>if <code>TRUE</code> discards duplicated trimmed matrices. This
alternative is recommended if <code>n</code> is small, because the
probability of obtaining the same trimmed matrix in different runs
increases as <code>n</code> decreases.</p>
</td></tr>
<tr><td><code id="trimHS_maxI_+3A_strat">strat</code></td>
<td>
<p>Flag indicating whether execution is to be  <code>"sequential"</code>
or <code>"parallel"</code>. Default is <code>"sequential"</code>,
resolves <span class="rlang"><b>R</b></span> expressions sequentially in the current <span class="rlang"><b>R</b></span>
process. If <code>"parallel"</code> resolves <span class="rlang"><b>R</b></span> expressions in parallel in
separate <span class="rlang"><b>R</b></span> sessions running in the background.</p>
</td></tr>
<tr><td><code id="trimHS_maxI_+3A_cl">cl</code></td>
<td>
<p>Number of cluster to be used for parallel computing.
<code><a href="parallelly.html#topic+availableCores">parallelly::availableCores()</a></code>
returns the number of clusters available.
Default is <code>cl = 1</code> resulting in <code>"sequential"</code> execution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the N trimmed matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(nuc_cp)
N = 10  #for the example, we recommend 1e+4 value
n = 15
TNC &lt;- trimHS_maxI(N, np_matrix, n, check.unique = TRUE)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
