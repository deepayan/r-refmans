<!DOCTYPE html><html lang="en"><head><title>Help for package hrqglas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hrqglas}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.cv.hrq_glasso'><p>Extract coefficients from cv.hrq_glasso object</p></a></li>
<li><a href='#coef.hrq_glasso'><p>Extract coefficients from hrq_glasso object</p></a></li>
<li><a href='#cv.hrq_glasso'><p>Cross-validation for quantile regression with group lasso</p></a></li>
<li><a href='#hrq_glasso'><p>Robust group variable selection for quantile and mean regression</p></a></li>
<li><a href='#plot.cv.hrq_glasso'><p>Generating plots for cross-validation</p></a></li>
<li><a href='#predict.cv.hrq_glasso'><p>Prediction for cv.hrq_glasso object</p></a></li>
<li><a href='#predict.hrq_glasso'><p>Prediction for the hrq_glasso object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Group Variable Selection for Quantile and Robust Mean Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shaobo Li &lt;shaobo.li@ku.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A program that conducts group variable selection for quantile and robust mean 
              regression (Sherwood and Li, 2022). The group lasso penalty (Yuan and Lin, 2006) is used for
              group-wise variable selection. Both of the quantile and mean regression models are based on the Huber loss.
              Specifically, with the tuning parameter in the Huber loss approaching to 0, the quantile check 
              function can be approximated by the Huber loss for the median and the tilted version of 
              Huber loss at other quantiles. Such approximation provides computational efficiency and stability, and
              has also been shown to be statistical consistent.</td>
</tr>
<tr>
<td>URL:</td>
<td>GitHub: <a href="https://github.com/shaobo-li/hrqglas">https://github.com/shaobo-li/hrqglas</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.4), stats, MASS, Matrix, graphics, quantreg</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-30 03:50:16 UTC; lisha</td>
</tr>
<tr>
<td>Author:</td>
<td>Shaobo Li [aut, cre],
  Ben Sherwood [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-30 08:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.cv.hrq_glasso'>Extract coefficients from cv.hrq_glasso object</h2><span id='topic+coef.cv.hrq_glasso'></span>

<h3>Description</h3>

<p>Extract coefficients from cv.hrq_glasso object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv.hrq_glasso'
coef(object, s, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.cv.hrq_glasso_+3A_object">object</code></td>
<td>
<p>The model object <code>cv.hrq_glasso object</code>.</p>
</td></tr>
<tr><td><code id="coef.cv.hrq_glasso_+3A_s">s</code></td>
<td>
<p>Value of lambda.</p>
</td></tr>
<tr><td><code id="coef.cv.hrq_glasso_+3A_...">...</code></td>
<td>
<p>other input parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function extract estimated coefficients from <code>cv.hrq_glasso</code> object.
</p>

<hr>
<h2 id='coef.hrq_glasso'>Extract coefficients from hrq_glasso object</h2><span id='topic+coef.hrq_glasso'></span>

<h3>Description</h3>

<p>Extract coefficients from hrq_glasso object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hrq_glasso'
coef(object, s, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.hrq_glasso_+3A_object">object</code></td>
<td>
<p>The model object <code>hrq_glasso object</code>.</p>
</td></tr>
<tr><td><code id="coef.hrq_glasso_+3A_s">s</code></td>
<td>
<p>Value of lambda.</p>
</td></tr>
<tr><td><code id="coef.hrq_glasso_+3A_...">...</code></td>
<td>
<p>other input parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function extract estimated coefficients from <code>hrq_glasso</code> object.
</p>

<hr>
<h2 id='cv.hrq_glasso'>Cross-validation for quantile regression with group lasso</h2><span id='topic+cv.hrq_glasso'></span>

<h3>Description</h3>

<p>K fold cross-validation is conducted. Four types of loss (squared error (<code>se</code>), absolute error (<code>ae</code>)
quantile check loss (<code>check</code>) and huber loss (<code>he</code>)) 
can be specified as the CV criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.hrq_glasso(
  x,
  y,
  group.index,
  tau = 0.5,
  k = 5,
  loss = "check",
  method = "quantile",
  folds = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.hrq_glasso_+3A_x">x</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="cv.hrq_glasso_+3A_y">y</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="cv.hrq_glasso_+3A_group.index">group.index</code></td>
<td>
<p>A vector of group index, e.g., (1,1,1,2,2,2,3,3)</p>
</td></tr>
<tr><td><code id="cv.hrq_glasso_+3A_tau">tau</code></td>
<td>
<p>Percentage</p>
</td></tr>
<tr><td><code id="cv.hrq_glasso_+3A_k">k</code></td>
<td>
<p>Number of folders.</p>
</td></tr>
<tr><td><code id="cv.hrq_glasso_+3A_loss">loss</code></td>
<td>
<p>The loss function used for computing the cross-validation error. Supported losses include squared error (<code>se</code>), absolute error (<code>ae</code>), quantile check loss (<code>check</code>) and huber loss (<code>he</code>).</p>
</td></tr>
<tr><td><code id="cv.hrq_glasso_+3A_method">method</code></td>
<td>
<p>Choice for mean or quantile regression. Default is <code>quantile</code>.</p>
</td></tr>
<tr><td><code id="cv.hrq_glasso_+3A_folds">folds</code></td>
<td>
<p>A vector of folder index for all observations. The procedure random splits if this argument is not specified.</p>
</td></tr>
<tr><td><code id="cv.hrq_glasso_+3A_...">...</code></td>
<td>
<p>Other inputs of function <code>hrq_glasso()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The full solution path is returned. It also returns the vector of CV score 
as well as the optimal values in terms of min and 1se. Corresponding lambda values are also returned. 
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>The estimated coefficients for all lambdas, stored in sparse matrix format, where each column corresponds to a lambda.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The sequence of lambdas.</p>
</td></tr>
<tr><td><code>lambda.min</code></td>
<td>
<p>The optimal lambda that minimizes the CV error</p>
</td></tr>
<tr><td><code>lambda.1se</code></td>
<td>
<p>The largest lambda such that CV error is within 1 standard error of the minimum CV error.</p>
</td></tr>
<tr><td><code>cv.all</code></td>
<td>
<p>The vector of all values of CV error for all lambdas.</p>
</td></tr>
<tr><td><code>cv.min</code></td>
<td>
<p>The value of CV error corresponding to <code>lambda.min</code>.</p>
</td></tr>
<tr><td><code>cv.1se</code></td>
<td>
<p>The value of CV error corresponding to <code>lambda.1se</code>.</p>
</td></tr>
<tr><td><code>folds</code></td>
<td>
<p>The vector of indices for k folds split.</p>
</td></tr>
<tr><td><code>cvup</code></td>
<td>
<p>CV error + 1 standard error</p>
</td></tr>
<tr><td><code>cvlo</code></td>
<td>
<p>CV error + 1 standard error</p>
</td></tr>
<tr><td><code>n.grp</code></td>
<td>
<p>The number of selected groups for each lambda.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;- 100
p&lt;- 10
x0&lt;- matrix(rnorm(n*p),n,p)
X&lt;- cbind(x0, x0^2, x0^3)[,order(rep(1:p,3))]
y&lt;- -2+X[,1]+0.5*X[,2]-X[,3]-0.5*X[,7]+X[,8]-0.2*X[,9]+rt(n,2)
group&lt;- rep(1:p, each=3)
fitcv&lt;- cv.hrq_glasso(x=X, y=y, group.index=group, method="quantile")
plot(fitcv)
</code></pre>

<hr>
<h2 id='hrq_glasso'>Robust group variable selection for quantile and mean regression</h2><span id='topic+hrq_glasso'></span>

<h3>Description</h3>

<p>This function conducts group-wise (with known groups) variable selection for quantile and robust mean regression with the group lasso penalty. 
The Huber loss is used for both types of regression model, where the quantile check function is approximated by Huber loss. A full solution path
is generated unless a single value of the shrinkage parameter is specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hrq_glasso(
  x,
  y,
  group.index,
  tau = 0.5,
  lambda = NULL,
  weights = NULL,
  w.lambda = NULL,
  gamma = 0.2,
  max_iter = 200,
  apprx = "huber",
  lambda.discard = TRUE,
  method = "quantile",
  scalex = TRUE,
  epsilon = 1e-04,
  beta0 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hrq_glasso_+3A_x">x</code></td>
<td>
<p>Design matrix (in matrix format)</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_y">y</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_group.index">group.index</code></td>
<td>
<p>A vector of group index, e.g., (1,1,1,2,2,2,3,3)</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_tau">tau</code></td>
<td>
<p>Percentile</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_lambda">lambda</code></td>
<td>
<p>Shrinkage parameter, default is NULL so that the algorithm chooses a sequence.</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_weights">weights</code></td>
<td>
<p>Observation weights, default is NULL</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_w.lambda">w.lambda</code></td>
<td>
<p>Weights for Shrinkage parameter of each group, default is NULL</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_gamma">gamma</code></td>
<td>
<p>Huber parameter. An initial value is 0.2, while the algorithm adaptively tunes the value in each iteration.</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iteration</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_apprx">apprx</code></td>
<td>
<p>Approximation method. Default is <code>huber</code>. The other option is <code>tanh</code> which uses the hypertangent function to approximate the first order derivative of absolute loss.</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_lambda.discard">lambda.discard</code></td>
<td>
<p>Default is TRUE, meaning that the solution path stops if the relative deviance changes sufficiently small. It usually happens near the end of solution path. However, the program returns at least 70 models along the solution path.</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_method">method</code></td>
<td>
<p>Choice for mean or quantile regression. Default is <code>quantile</code>.</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_scalex">scalex</code></td>
<td>
<p>Standardize design matrix. Default is TRUE.</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_epsilon">epsilon</code></td>
<td>
<p>The epsilon level convergence. Default is 1e-4.</p>
</td></tr>
<tr><td><code id="hrq_glasso_+3A_beta0">beta0</code></td>
<td>
<p>Initial estimates. Default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a sequence of estimated coefficients for quantile regression with group feature selection corresponding to a sequence of lambda. 
The estimated coefficients are in the sparse matrix format. Returned values also include the sequence of lambda, the null deviance, 
values of penalized loss, and unpenalized loss across the sequence of lambda. 
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>The estimated coefficients for all lambdas, stored in sparse matrix format, where each column corresponds to a lambda.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The sequence of lambdas.</p>
</td></tr>
<tr><td><code>null.dev</code></td>
<td>
<p>The null deviance.</p>
</td></tr>
<tr><td><code>pen.loss</code></td>
<td>
<p>The value of penalized loss for each lambda.</p>
</td></tr>
<tr><td><code>loss</code></td>
<td>
<p>The value of unpenalized loss for each lambda.</p>
</td></tr>
<tr><td><code>index.grp</code></td>
<td>
<p>Group indices that correspond to the estimated coefficient matrix <code>beta</code>.</p>
</td></tr>
<tr><td><code>n.grp</code></td>
<td>
<p>The number of selected groups for each lambda.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sherwood, B., and Li, S. (2021) An Efficient Approach to Feature Selection and Estimation for Quantile Regression with Grouped Variables. <em>Working paper</em>.
</p>
<p>Yang, Y., and Zou, H., (2015) A Fast Unified Algorithm for Solving Group-lasso Penalize Learning Problems, <em>Statistics and Computing</em>, 25 1129-1141.
doi: <a href="https://doi.org/10.1007/s11222-014-9498-5">10.1007/s11222-014-9498-5</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;- 100
p&lt;- 10
x0&lt;- matrix(rnorm(n*p),n,p)
X&lt;- cbind(x0, x0^2, x0^3)[,order(rep(1:p,3))]
y&lt;- -2+X[,1]+0.5*X[,2]-X[,3]-0.5*X[,7]+X[,8]-0.2*X[,9]+rt(n,2)
group&lt;- rep(1:p, each=3)
fit&lt;- hrq_glasso(X, y, group)
fit$beta[,8]

</code></pre>

<hr>
<h2 id='plot.cv.hrq_glasso'>Generating plots for cross-validation</h2><span id='topic+plot.cv.hrq_glasso'></span>

<h3>Description</h3>

<p>Generating plots for cross-validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv.hrq_glasso'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cv.hrq_glasso_+3A_x">x</code></td>
<td>
<p>The object of function <code>cv.hrq_glasso</code>.</p>
</td></tr>
<tr><td><code id="plot.cv.hrq_glasso_+3A_...">...</code></td>
<td>
<p>other input parameters for the generic function <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross-validation plot for the entire solution path.
</p>

<hr>
<h2 id='predict.cv.hrq_glasso'>Prediction for cv.hrq_glasso object</h2><span id='topic+predict.cv.hrq_glasso'></span>

<h3>Description</h3>

<p>Prediction for cv.hrq_glasso object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv.hrq_glasso'
predict(object, newX, s, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.cv.hrq_glasso_+3A_object">object</code></td>
<td>
<p>The model object of <code>cv.hrq_glasso</code>.</p>
</td></tr>
<tr><td><code id="predict.cv.hrq_glasso_+3A_newx">newX</code></td>
<td>
<p>New design matrix.</p>
</td></tr>
<tr><td><code id="predict.cv.hrq_glasso_+3A_s">s</code></td>
<td>
<p>Value of lambda. If missing, the default is the <code>lambda.min</code>.</p>
</td></tr>
<tr><td><code id="predict.cv.hrq_glasso_+3A_...">...</code></td>
<td>
<p>other input parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns predicted values based on the fitted model from <code>cv.hrq_glasso</code>.
</p>

<hr>
<h2 id='predict.hrq_glasso'>Prediction for the hrq_glasso object</h2><span id='topic+predict.hrq_glasso'></span>

<h3>Description</h3>

<p>This function provides the prediction of the <code>hrq_glasso</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hrq_glasso'
predict(object, newX, s = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.hrq_glasso_+3A_object">object</code></td>
<td>
<p>The model object of <code>hrq_glasso</code>.</p>
</td></tr>
<tr><td><code id="predict.hrq_glasso_+3A_newx">newX</code></td>
<td>
<p>New design matrix.</p>
</td></tr>
<tr><td><code id="predict.hrq_glasso_+3A_s">s</code></td>
<td>
<p>Value of lambda. Default is NULL, so that the function provides prediction at all lambdas used in <code>hrq_glasso</code>.</p>
</td></tr>
<tr><td><code id="predict.hrq_glasso_+3A_...">...</code></td>
<td>
<p>other input parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns predicted values based on the fitted model from <code>hrq_glasso</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;- 100
p&lt;- 10
x0&lt;- matrix(rnorm(n*p),n,p)
X&lt;- cbind(x0, x0^2, x0^3)[,order(rep(1:p,3))]
y&lt;- -2+X[,1]+0.5*X[,2]-X[,3]-0.5*X[,7]+X[,8]-0.2*X[,9]+rt(n,2)
group&lt;- rep(1:p, each=3)
fit&lt;- hrq_glasso(X, y, group)
pred&lt;- predict(fit, newX=X, s=0.3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
