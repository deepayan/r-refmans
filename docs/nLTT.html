<!DOCTYPE html><html><head><title>Help for package nLTT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nLTT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nLTT-package'>
<p>Package providing functions to visualize the normalized Lineage-Through-Time statistic, and calculate the difference between two nLTT curves</p></a></li>
<li><a href='#abc_smc_nltt'><p>A function to perform Approximate Bayesian Computation within a</p>
Sequential Markov Chain (ABC-SMC), for diversification analysis
of phylogenetic trees.</a></li>
<li><a href='#check_input_event_times'><p>Checks that event times are correct</p></a></li>
<li><a href='#check_phylogenies'><p>Check if the input is a valid collection of one or more phylogenies</p></a></li>
<li><a href='#check_step_type'><p>Check if the step type is valid</p></a></li>
<li><a href='#check_time_unit'><p>Check if the time unit is valid</p></a></li>
<li><a href='#default_params_doc'><p>This function does nothing. It is intended to inherit is parameters'</p>
documentation.</a></li>
<li><a href='#exampleTrees'><p> example trees to test the functionality of the package</p></a></li>
<li><a href='#get_average_nltt_matrix'><p>Get the average nLTT from a collection of phylogenies</p></a></li>
<li><a href='#get_branching_times'><p>Collect the branching times from the stem age</p></a></li>
<li><a href='#get_n_lineages'><p>Collect the number of lineages from the stem age</p></a></li>
<li><a href='#get_nltt_values'><p>Get the nLTT values in time</p></a></li>
<li><a href='#get_norm_brts'><p>Collect the normalized branching times from the stem age</p></a></li>
<li><a href='#get_norm_n'><p>Collect the normalized number of lineages from the stem age</p></a></li>
<li><a href='#get_phylogeny_nltt_matrix'><p>Extract the nLTT matrix from a phylogeny</p></a></li>
<li><a href='#mcmc_nltt'><p>function, using a Monte Carlo Markov Chain</p></a></li>
<li><a href='#nltt_diff'><p>Calculates the exact difference between the lineage through time curves of</p>
tree1 &amp; tree2 (normalized in time and for the number of lineages)</a></li>
<li><a href='#nltt_diff_exact'><p>Calculates the exact, difference between the lineage through time</p>
curves of tree1 &amp; tree2 (normalized in time and for the number of lineages)</a></li>
<li><a href='#nltt_diff_exact_brts'><p>Calculates the exact difference between the nLTT</p>
curves of the branching times</a></li>
<li><a href='#nltt_diff_exact_calc_extinct'><p>Calculates the exact difference between the nLTT</p>
curves of the event times. This includes extinction events.</a></li>
<li><a href='#nltt_diff_exact_extinct'><p>Calculates the exact difference between the nLTT</p>
curves of the event times. This includes extinction events.</a></li>
<li><a href='#nltt_diff_exact_norm_brts'><p>Calculates the exact difference between the nLTT</p>
curves of the branching times</a></li>
<li><a href='#nltt_lines'><p>Normalized version of the ape function ltt.lines.</p></a></li>
<li><a href='#nltt_plot'><p>Normalized version of the ape function ltt.plot</p></a></li>
<li><a href='#nLTT-internal'><p>Internal nLTT functions</p></a></li>
<li><a href='#nltts_diff'><p>Calculates the nLTT statistic between each phylogeny in</p>
a collection compared to a same focal/reference tree</a></li>
<li><a href='#nltts_plot'><p>Get the average nLTT from a collection of phylogenies</p></a></li>
<li><a href='#nLTTstat'><p>Calculate the difference between two normalized</p>
Lineage-Through-Time curves, given two phylogenetic trees.</a></li>
<li><a href='#nLTTstat_exact'><p>Calculate the exact difference between</p>
two normalized Lineage-Through-Time curves, given two phylogenetic trees.</a></li>
<li><a href='#stretch_nltt_matrix'><p>Stretch matrix 'm' with a timestep resolution of 'dt'.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculate the NLTT Statistic</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.9</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to calculate the normalised Lineage-Through-
    Time (nLTT) statistic, given two phylogenetic trees. The nLTT statistic measures
    the difference between two Lineage-Through-Time curves, where each curve is
    normalised both in time and in number of lineages.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, coda, testit</td>
</tr>
<tr>
<td>Suggests:</td>
<td>TreeSim, DDD, ggplot2, Hmisc, knitr, lintr, microbenchmark,
plyr, reshape2, rmarkdown, TESS, testthat, DAISIE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/thijsjanzen/nLTT">https://github.com/thijsjanzen/nLTT</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/thijsjanzen/nLTT/issues">https://github.com/thijsjanzen/nLTT/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 10:37:54 UTC; thijsjanzen</td>
</tr>
<tr>
<td>Author:</td>
<td>Thijs Janzen [aut, cre],
  Richèl J.C. Bilderbeek
    <a href="https://orcid.org/0000-0003-1107-7049"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Pedro Neves [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thijs Janzen &lt;thijsjanzen@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-21 10:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='nLTT-package'>
Package providing functions to visualize the normalized Lineage-Through-Time statistic, and calculate the difference between two nLTT curves
</h2><span id='topic+nLTT-package'></span><span id='topic+nLTT'></span>

<h3>Description</h3>

<p>This package provides a function to visualize the normalized Lineage-Through-Time (nLTT) statistic, where the number of lineages relative to the maximum number of lineages in a phylogenetic tree is plotted against the relative time between the most common recent ancestor and the present. Furthermore the package provides a function to calculate the difference between two nLTT curves, including two different distance measurements.
<br />
<br />
Updates:
Version 1.4.9: improve DESCRIPTION <br />
Version 1.4.8: minor improvements to code <br />
Version 1.4.7: Fixed noSuggest error, to comply _R_CHECK_DEPENDS_ONLY_ <br />
Version 1.4.6: Fixed testing, to comply _R_CHECK_LENGTH_1_CONDITION_. <br />
Version 1.4.4: Added support for phylogenies with extinct lineages. <br />
Version 1.4.3: Added support for log transformation before normalization. <br />
Version 1.4: Added the following four functions: get_branching_times, get_n_lineages, get_norm_brts and get_norm_n. Furthermore, vignette building has improved, and the underlying code base has been polished up as well. <br />
Version 1.3.1: Added walkthrough vignette, and updated several typos in the manual <br />
Version 1.3: Version 1.3 adds a lot of extended functionality: firstly, we have added functions to calculate, and plot, the average nLTT across a number of phylogenies. Furthermore, we have added vignettes, and we have added a GitHub repository. On the GitHub repository the vignettes are separately accessible through the wiki. Lastly we have added an extra option to the nLTT functions, where the user can specify if the used trees are rooted, or not. Under the hood, some changes have been made as well, the majority of the code is now conforming to the lintR code conventions, and we have written formalized tests that check correctness of all code (code coverage 100
<br />
</p>
<p>Version 1.2.1: updated comments and coding style to adhere to the general coding rules. Backwards compatibility has been favoured for the nLTT stat functions. ABC related functions are no longer backwards compatible (variable names have been changed to adhere to coding style). <br />
Version 1.2: added an &quot;exact&quot; nLTT function. This function is faster for small trees, and provides an exact measurement of the nLTT function. Comparison between &quot;old&quot; and &quot;exact&quot; estimates show that these are highly correlated, although the &quot;exact&quot; values are slightly higher than the &quot;old&quot; values. The &quot;exact&quot; function should generally be preferred, unless dealing with extremely large trees (500+ tips) in which case the old function is much faster. <br /><br />
Version 1.2: updated the example for the ABC_SMC_nLTT function, prior generating and prior density functions are now more realistic
<br /><br />
Version 1.1.1: fixed a minor bug in the ABC_SMC_nLTT function <br />
Version 1.1.1: removed some intermediate output in ABC_SMC_nLTT function <br />
Version 1.1: Made a universal nLTT function called &quot;nLTTstat&quot;, with argument &quot;distanceMethod&quot;, this serves as a more elegant wrapper for the functions &quot;normLTTdiffABS&quot; and &quot;normLTTdiffSQ&quot; <br />
Version 1.1: Updated references in the manual <br />
</p>


<h3>Author(s)</h3>

<p>Thijs Janzen
</p>
<p>Maintainer: Thijs Janzen &lt;thijsjanzen@gmail.com&gt;
</p>


<h3>References</h3>

<p>Janzen,T. Hoehna,S., Etienne,R.S. (2015) Approximate Bayesian Computation of diversification rates from molecular phylogenies: introducing a new efficient summary statistic, the nLTT. Methods in Ecology and Evolution. &lt;doi:10.1111/2041-210X.12350&gt;
</p>

<hr>
<h2 id='abc_smc_nltt'>A function to perform Approximate Bayesian Computation within a
Sequential Markov Chain (ABC-SMC), for diversification analysis
of phylogenetic trees.</h2><span id='topic+abc_smc_nltt'></span>

<h3>Description</h3>

<p>This function performs ABC-SMC as described in Toni 2009
for given diversification model, provided a phylogenetic tree.
ABC-SMC is not limited to only using the normalized LTT as statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abc_smc_nltt(
    tree, statistics, simulation_function, init_epsilon_values,
    prior_generating_function, prior_density_function,
    number_of_particles = 1000, sigma = 0.05, stop_rate = 1e-05
  )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abc_smc_nltt_+3A_tree">tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>; the tree upon which we want
to fit our diversification model</p>
</td></tr>
<tr><td><code id="abc_smc_nltt_+3A_statistics">statistics</code></td>
<td>
<p>A vector containing functions that take a tree
as an argument and return a single scalar value (the statistic).</p>
</td></tr>
<tr><td><code id="abc_smc_nltt_+3A_simulation_function">simulation_function</code></td>
<td>
<p>A function that implements the
diversification model and returns an object of class <code>"phylo"</code>.</p>
</td></tr>
<tr><td><code id="abc_smc_nltt_+3A_init_epsilon_values">init_epsilon_values</code></td>
<td>
<p>A vector containing the initial threshold values
for the summary statistics from the vector <code>statistics</code>.</p>
</td></tr>
<tr><td><code id="abc_smc_nltt_+3A_prior_generating_function">prior_generating_function</code></td>
<td>
<p>Function to generate parameters
from the prior distribution of these parameters (e.g. a function returning
lambda and mu in case of the birth-death model)</p>
</td></tr>
<tr><td><code id="abc_smc_nltt_+3A_prior_density_function">prior_density_function</code></td>
<td>
<p>Function to calculate the prior probability
of a set of parameters.</p>
</td></tr>
<tr><td><code id="abc_smc_nltt_+3A_number_of_particles">number_of_particles</code></td>
<td>
<p>Number of particles to be used
per iteration of the ABC-SMC algorithm.</p>
</td></tr>
<tr><td><code id="abc_smc_nltt_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the perturbance distribution
(perturbance distribution is a gaussian with mean 0).</p>
</td></tr>
<tr><td><code id="abc_smc_nltt_+3A_stop_rate">stop_rate</code></td>
<td>
<p>If the acceptance rate drops below <code>stopRate</code>,
stop the ABC-SMC algorithm  and assume convergence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with <code>n</code> columns,
where <code>n</code> is the number of parameters you are trying to estimate.
</p>


<h3>Author(s)</h3>

<p>Thijs Janzen
</p>


<h3>References</h3>

<p>Toni, T., Welch, D., Strelkowa, N., Ipsen, A.,
&amp; Stumpf, M.P.H. (2009). Approximate Bayesian computation scheme for
parameter inference and model selection in dynamical systems.
Journal of the Royal Society Interface, 6(31), 187-202.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 

  prior_gen &lt;- function() {
    return( rexp(n=2, rate=0.1) )
  }

  prior_dens &lt;- function(val) {
    return( dexp( val[1], rate = 0.1) * dexp( val[2], rate = 0.1) )
  }

  require(TESS)

  treeSim &lt;- function(params) {
    t &lt;- TESS.sim.age(n=1, lambda = params[1], mu = params[2], age = 10)[[1]]
    return(t)
  }

  obs &lt;- treeSim(c(0.5,0.1))

  statWrapper &lt;- function(tree1) {
    return( nLTTstat_exact(tree1, obs, "abs"))
  }

  stats &lt;- c(statWrapper)

  results &lt;-  abc.smc.nltt(
    obs, stats, treeSim, init_epsilon_values = 0.2,
    prior_generating_function = prior_gen,
    prior_density_function = prior_dens,
    number_of_particles = 1000, sigma = 0.05, stop_rate = 1e-5
  )

  
## End(Not run) # end of dontrun
</code></pre>

<hr>
<h2 id='check_input_event_times'>Checks that event times are correct</h2><span id='topic+check_input_event_times'></span>

<h3>Description</h3>

<p>Checks <code>event_times</code> and <code>event_times2</code> are of the
appropriate class and have expected characteristics for correct calculation
of NLTT in <code><a href="#topic+nltt_diff_exact_extinct">nltt_diff_exact_extinct</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_input_event_times(event_times, event_times2, time_unit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_input_event_times_+3A_event_times">event_times</code></td>
<td>
<p>event times of the first phylogeny</p>
</td></tr>
<tr><td><code id="check_input_event_times_+3A_event_times2">event_times2</code></td>
<td>
<p>event times of the second phylogeny</p>
</td></tr>
<tr><td><code id="check_input_event_times_+3A_time_unit">time_unit</code></td>
<td>
<p>the time unit of the branching times
</p>

<ul>
<li><p>&quot;ago: &quot;the branching times are postive,
as these are in time units ago
</p>
</li>
<li><p>&quot;since: &quot;the branching times are negative,
as these are in time units since present
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing. Throws error with helpful error message if
<code>event_times</code> and <code>event_times2</code> are not correct.
</p>


<h3>Author(s)</h3>

<p>Pedro Neves and Richèl Bilderbeek and Thijs Janzen
</p>

<hr>
<h2 id='check_phylogenies'>Check if the input is a valid collection of one or more phylogenies</h2><span id='topic+check_phylogenies'></span>

<h3>Description</h3>

<p>Will <a href="base.html#topic+stop">stop</a> if not
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_phylogenies(phylogenies)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_phylogenies_+3A_phylogenies">phylogenies</code></td>
<td>
<p>a collection of one or more phylogenies,
where the phylogenies are of type <a href="ape.html#topic+phylo">phylo</a>.
This collection can both be a list of <a href="ape.html#topic+phylo">phylo</a> or
a <a href="ape.html#topic+multiphylo">multiphylo</a>.</p>
</td></tr>
</table>

<hr>
<h2 id='check_step_type'>Check if the step type is valid</h2><span id='topic+check_step_type'></span>

<h3>Description</h3>

<p>Will <a href="base.html#topic+stop">stop</a> if not
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_step_type(step_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_step_type_+3A_step_type">step_type</code></td>
<td>
<p>when between two points, where the second point
has both a higher x and y coordinat, which y coordinat to follow.
'step_type' can be:
</p>

<ul>
<li><p> lower maintain the y-coordinat of the leftmost point
</p>
</li>
<li><p> upper already use the y-coordinat of the rightmost point
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='check_time_unit'>Check if the time unit is valid</h2><span id='topic+check_time_unit'></span>

<h3>Description</h3>

<p>Will <a href="base.html#topic+stop">stop</a> if not
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_time_unit(time_unit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_time_unit_+3A_time_unit">time_unit</code></td>
<td>
<p>the time unit of the branching times
</p>

<ul>
<li><p>&quot;ago: &quot;the branching times are postive,
as these are in time units ago
</p>
</li>
<li><p>&quot;since: &quot;the branching times are negative,
as these are in time units since present
</p>
</li></ul>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Richèl J.C. Bilderbeek
</p>

<hr>
<h2 id='default_params_doc'>This function does nothing. It is intended to inherit is parameters'
documentation.</h2><span id='topic+default_params_doc'></span>

<h3>Description</h3>

<p>This function does nothing. It is intended to inherit is parameters'
documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_params_doc(dt, phylogenies, step_type, time_unit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="default_params_doc_+3A_dt">dt</code></td>
<td>
<p>The timestep resolution,
a value bigger than zero and less or equal to one.
1/dt is the number of points that will be evaluated</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_phylogenies">phylogenies</code></td>
<td>
<p>a collection of one or more phylogenies,
where the phylogenies are of type <a href="ape.html#topic+phylo">phylo</a>.
This collection can both be a list of <a href="ape.html#topic+phylo">phylo</a> or
a <a href="ape.html#topic+multiphylo">multiphylo</a>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_step_type">step_type</code></td>
<td>
<p>when between two points, where the second point
has both a higher x and y coordinat, which y coordinat to follow.
'step_type' can be:
</p>

<ul>
<li><p> lower maintain the y-coordinat of the leftmost point
</p>
</li>
<li><p> upper already use the y-coordinat of the rightmost point
</p>
</li></ul>
</td></tr>
<tr><td><code id="default_params_doc_+3A_time_unit">time_unit</code></td>
<td>
<p>the time unit of the branching times
</p>

<ul>
<li><p>&quot;ago: &quot;the branching times are postive,
as these are in time units ago
</p>
</li>
<li><p>&quot;since: &quot;the branching times are negative,
as these are in time units since present
</p>
</li></ul>
</td></tr>
</table>


<h3>Note</h3>

<p>This is an internal function, so it should be marked with
<code>@noRd</code>. This is not done, as this will disallow all
functions to find the documentation parameters
</p>


<h3>Author(s)</h3>

<p>Richèl J.C. Bilderbeek
</p>

<hr>
<h2 id='exampleTrees'> example trees to test the functionality of the package</h2><span id='topic+exampleTrees'></span>

<h3>Description</h3>

<p>100 phylogenetic trees of class <code>phylo</code>, generated using the sim.globalBiDe.age function from the <code>TESS</code> package, with lambda = 0.3, mu = 0.1, age = 10.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exampleTrees)</code></pre>


<h3>Format</h3>

  
<p>A list containing objects of class <code>phylo</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(exampleTrees);
 obs &lt;- exampleTrees[[1]];
 nltt_plot(obs);
</code></pre>

<hr>
<h2 id='get_average_nltt_matrix'>Get the average nLTT from a collection of phylogenies</h2><span id='topic+get_average_nltt_matrix'></span>

<h3>Description</h3>

<p>Get the average nLTT from a collection of phylogenies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_average_nltt_matrix(phylogenies, dt = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_average_nltt_matrix_+3A_phylogenies">phylogenies</code></td>
<td>
<p>the phylogenies, supplied as either a list
or a multiPhylo object, where the phylogenies are of type 'phylo'</p>
</td></tr>
<tr><td><code id="get_average_nltt_matrix_+3A_dt">dt</code></td>
<td>
<p>The timestep resolution, where 1/dt is
the number of points evaluated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of timepoints with the average number of (normalized)
lineages through (normalized) time
</p>


<h3>Author(s)</h3>

<p>Richèl J.C. Bilderbeek
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  get_average_nltt_matrix(c(ape::rcoal(10), ape::rcoal(20)))

</code></pre>

<hr>
<h2 id='get_branching_times'>Collect the branching times from the stem age</h2><span id='topic+get_branching_times'></span>

<h3>Description</h3>

<p>Collect the branching times from the stem age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_branching_times(phylogeny)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_branching_times_+3A_phylogeny">phylogeny</code></td>
<td>
<p>a phylogeny of class 'phylo'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>branching times, in time units before the present
</p>


<h3>Author(s)</h3>

<p>Richèl Bilderbeek
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  phylogeny &lt;- ape::read.tree(text = "((a:2,b:2):1,c:3);")
  phylogeny$root.edge &lt;- 2 # nolint ape variable name
    all.equal(as.vector(nLTT::get_branching_times(phylogeny)), c(5, 3, 2))
</code></pre>

<hr>
<h2 id='get_n_lineages'>Collect the number of lineages from the stem age</h2><span id='topic+get_n_lineages'></span>

<h3>Description</h3>

<p>Collect the number of lineages from the stem age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_n_lineages(phylogeny)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_n_lineages_+3A_phylogeny">phylogeny</code></td>
<td>
<p>a phylogeny of class 'phylo'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>number of lineages, will go from 1 to the number of tips,
if there is a stem, will go from 2 to the number of tips
if there is no stem
</p>


<h3>Author(s)</h3>

<p>Richèl Bilderbeek
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  phylogeny &lt;- ape::read.tree(text = "((a:2,b:2):1,c:3);")
    all.equal(as.vector(nLTT::get_n_lineages(phylogeny)), c(2, 3))
  phylogeny$root.edge &lt;- 2 # nolint ape variable name
    all.equal(as.vector(nLTT::get_n_lineages(phylogeny)), c(1, 2, 3))
</code></pre>

<hr>
<h2 id='get_nltt_values'>Get the nLTT values in time</h2><span id='topic+get_nltt_values'></span>

<h3>Description</h3>

<p>Collect the nLTT values in time
over all phylogenies in the long form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_nltt_values(phylogenies, dt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_nltt_values_+3A_phylogenies">phylogenies</code></td>
<td>
<p>the phylogenies, supplied as either
a list or a multiPhylo object, where the phylogenies are of type 'phylo'</p>
</td></tr>
<tr><td><code id="get_nltt_values_+3A_dt">dt</code></td>
<td>
<p>The timestep resolution,
where 1/dt is the number of points evaluated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of timepoints with the nLTT value
of each phylogeny in time
</p>


<h3>Author(s)</h3>

<p>Richèl Bilderbeek
</p>


<h3>See Also</h3>

<p>Use<a href="#topic+nltts_diff">nltts_diff</a> to compare nLTT statistic between one focal
tree and a set of one or more other trees
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Create some random phylogenies
  phylogeny1 &lt;- ape::rcoal(10)
  phylogeny2 &lt;- ape::rcoal(20)
  phylogeny3 &lt;- ape::rcoal(30)
  phylogeny4 &lt;- ape::rcoal(40)
  phylogeny5 &lt;- ape::rcoal(50)
  phylogeny6 &lt;- ape::rcoal(60)
  phylogeny7 &lt;- ape::rcoal(70)
  phylogenies &lt;- c(phylogeny1, phylogeny2, phylogeny3,
    phylogeny4, phylogeny5, phylogeny6, phylogeny7
  )

  # Obtain the nLTT values
  dt &lt;- 0.2
  nltt_values &lt;- get_nltt_values(phylogenies, dt = dt)

</code></pre>

<hr>
<h2 id='get_norm_brts'>Collect the normalized branching times from the stem age</h2><span id='topic+get_norm_brts'></span>

<h3>Description</h3>

<p>Collect the normalized branching times from the stem age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_norm_brts(phylogeny)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_norm_brts_+3A_phylogeny">phylogeny</code></td>
<td>
<p>a phylogeny of class 'phylo'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>branching times, in time units before the present
</p>


<h3>Author(s)</h3>

<p>Richèl Bilderbeek
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  phylogeny &lt;- ape::read.tree(text = "((a:2,b:2):1,c:3);")
  phylogeny$root.edge &lt;- 2 # nolint ape variable name
    all(nLTT::get_branching_times(phylogeny) == c(5, 3, 2))
</code></pre>

<hr>
<h2 id='get_norm_n'>Collect the normalized number of lineages from the stem age</h2><span id='topic+get_norm_n'></span>

<h3>Description</h3>

<p>Collect the normalized number of lineages from the stem age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_norm_n(phylogeny)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_norm_n_+3A_phylogeny">phylogeny</code></td>
<td>
<p>a phylogeny of class 'phylo'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>branching times, in time units before the present
</p>


<h3>Author(s)</h3>

<p>Richèl Bilderbeek
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  phylogeny &lt;- ape::read.tree(text = "((a:2,b:2):1,c:3);")
  phylogeny$root.edge &lt;- 2 # nolint ape variable name
    all.equal(as.vector(nLTT::get_branching_times(phylogeny)), c(5, 3, 2))
</code></pre>

<hr>
<h2 id='get_phylogeny_nltt_matrix'>Extract the nLTT matrix from a phylogeny</h2><span id='topic+get_phylogeny_nltt_matrix'></span>

<h3>Description</h3>

<p>Extract the nLTT matrix from a phylogeny
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_phylogeny_nltt_matrix(phylogeny)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_phylogeny_nltt_matrix_+3A_phylogeny">phylogeny</code></td>
<td>
<p>A phylogeny of type phylo</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix
</p>


<h3>Author(s)</h3>

<p>Richèl Bilderbeek
</p>

<hr>
<h2 id='mcmc_nltt'>function, using a Monte Carlo Markov Chain</h2><span id='topic+mcmc_nltt'></span>

<h3>Description</h3>

<p>function, using a Monte Carlo Markov Chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc_nltt(
  phy,
  likelihood_function,
  parameters,
  logtransforms,
  iterations,
  burnin = round(iterations/3),
  thinning = 1,
  sigma = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmc_nltt_+3A_phy">phy</code></td>
<td>
<p>phylo       Vector of weights</p>
</td></tr>
<tr><td><code id="mcmc_nltt_+3A_likelihood_function">likelihood_function</code></td>
<td>
<p>function    Function that calculates the
likelihood of our diversification
model, given the tree.
function should be of the format
function(parameters, phy).</p>
</td></tr>
<tr><td><code id="mcmc_nltt_+3A_parameters">parameters</code></td>
<td>
<p>vector      Initial parameters to start
the chain.</p>
</td></tr>
<tr><td><code id="mcmc_nltt_+3A_logtransforms">logtransforms</code></td>
<td>
<p>scalar      Whether to perform jumps on
logtransformed parameters (TRUE)
or not (FALSE)</p>
</td></tr>
<tr><td><code id="mcmc_nltt_+3A_iterations">iterations</code></td>
<td>
<p>scalar      Length of the chain</p>
</td></tr>
<tr><td><code id="mcmc_nltt_+3A_burnin">burnin</code></td>
<td>
<p>scalar      Length of the burnin, default is
30% of iterations</p>
</td></tr>
<tr><td><code id="mcmc_nltt_+3A_thinning">thinning</code></td>
<td>
<p>scalar      Size of thinning, default = 1</p>
</td></tr>
<tr><td><code id="mcmc_nltt_+3A_sigma">sigma</code></td>
<td>
<p>scalar      Standard deviation of the jumping
distribution, which is
N(0, sigma).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mcmc        An MCMC object, as used by the
package &quot;coda&quot;.
</p>

<hr>
<h2 id='nltt_diff'>Calculates the exact difference between the lineage through time curves of
tree1 &amp; tree2 (normalized in time and for the number of lineages)</h2><span id='topic+nltt_diff'></span>

<h3>Description</h3>

<p>Calculates the exact difference between the lineage through time curves of
tree1 &amp; tree2 (normalized in time and for the number of lineages)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltt_diff(
  tree1,
  tree2,
  distance_method = "abs",
  ignore_stem = TRUE,
  log_transform = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltt_diff_+3A_tree1">tree1</code></td>
<td>
<p>(phylo) First phylogenetic tree</p>
</td></tr>
<tr><td><code id="nltt_diff_+3A_tree2">tree2</code></td>
<td>
<p>(phylo) Second phylogenetic tree</p>
</td></tr>
<tr><td><code id="nltt_diff_+3A_distance_method">distance_method</code></td>
<td>
<p>(string) absolute, or squared distance?</p>
</td></tr>
<tr><td><code id="nltt_diff_+3A_ignore_stem">ignore_stem</code></td>
<td>
<p>logical    Should the phylogeny its stem be ignored?</p>
</td></tr>
<tr><td><code id="nltt_diff_+3A_log_transform">log_transform</code></td>
<td>
<p>(logical) Should the number of lineages be
log-transformed before normalization?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(scalar) normalized Lineage-Through-Time difference
between tree1 &amp; tree2
</p>


<h3>Author(s)</h3>

<p>Thijs Janzen
</p>


<h3>See Also</h3>

<p>use <code><a href="#topic+nltts_diff">nltts_diff</a></code> to compare a collection of
phylogenies to one focal/reference tree
</p>

<hr>
<h2 id='nltt_diff_exact'>Calculates the exact, difference between the lineage through time
curves of tree1 &amp; tree2 (normalized in time and for the number of lineages)</h2><span id='topic+nltt_diff_exact'></span>

<h3>Description</h3>

<p>Calculates the exact, difference between the lineage through time
curves of tree1 &amp; tree2 (normalized in time and for the number of lineages)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltt_diff_exact(
  tree1,
  tree2,
  distance_method = "abs",
  ignore_stem = TRUE,
  log_transform = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltt_diff_exact_+3A_tree1">tree1</code></td>
<td>
<p>(phylo) First phylogenetic tree</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_+3A_tree2">tree2</code></td>
<td>
<p>(phylo) Second phylogenetic tree</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_+3A_distance_method">distance_method</code></td>
<td>
<p>(string) absolute, or squared distance?</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_+3A_ignore_stem">ignore_stem</code></td>
<td>
<p>(logical) Should the phylogeny its stem be ignored?</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_+3A_log_transform">log_transform</code></td>
<td>
<p>(logical) Should the number of lineages be
log-transformed before normalization?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(scalar) normalized Lineage-Through-Time difference
between tree1 &amp; tree2
</p>


<h3>Author(s)</h3>

<p>Thijs Janzen
</p>

<hr>
<h2 id='nltt_diff_exact_brts'>Calculates the exact difference between the nLTT
curves of the branching times</h2><span id='topic+nltt_diff_exact_brts'></span>

<h3>Description</h3>

<p>Calculates the exact difference between the nLTT
curves of the branching times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltt_diff_exact_brts(
  b_times,
  lineages,
  b_times2,
  lineages2,
  distance_method = "abs",
  time_unit = "since"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltt_diff_exact_brts_+3A_b_times">b_times</code></td>
<td>
<p>branching times of the first phylogeny,</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_brts_+3A_lineages">lineages</code></td>
<td>
<p>the number of lineages,
usually one to the number of lineages</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_brts_+3A_b_times2">b_times2</code></td>
<td>
<p>branching times of the first phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_brts_+3A_lineages2">lineages2</code></td>
<td>
<p>the number of lineages,
usually one to the number of lineages</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_brts_+3A_distance_method">distance_method</code></td>
<td>
<p>how the difference between the two nLTTs is summed
</p>

<ul>
<li><p>&quot;abs: &quot;the absolute distance between the two nLTTs is summed
</p>
</li>
<li><p>&quot;squ: &quot;the squared distance between the two nLTTs is summed
</p>
</li></ul>
</td></tr>
<tr><td><code id="nltt_diff_exact_brts_+3A_time_unit">time_unit</code></td>
<td>
<p>the time unit of the branching times
</p>

<ul>
<li><p>&quot;ago: &quot;the branching times are postive,
as these are in time units ago
</p>
</li>
<li><p>&quot;since: &quot;the branching times are negative,
as these are in time units since present
</p>
</li></ul>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thijs Janzen and Richèl Bilderbeek
</p>

<hr>
<h2 id='nltt_diff_exact_calc_extinct'>Calculates the exact difference between the nLTT
curves of the event times. This includes extinction events.</h2><span id='topic+nltt_diff_exact_calc_extinct'></span>

<h3>Description</h3>

<p>Calculates the exact difference between the nLTT
curves of the event times. This includes extinction events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltt_diff_exact_calc_extinct(
  event_times,
  species_number,
  event_times2,
  species_number2,
  distance_method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltt_diff_exact_calc_extinct_+3A_event_times">event_times</code></td>
<td>
<p>event times of the first phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_calc_extinct_+3A_species_number">species_number</code></td>
<td>
<p>the number of species at each event time of the first
phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_calc_extinct_+3A_event_times2">event_times2</code></td>
<td>
<p>event times of the second phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_calc_extinct_+3A_species_number2">species_number2</code></td>
<td>
<p>the number of species at each event time of the second
phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_calc_extinct_+3A_distance_method">distance_method</code></td>
<td>
<p>(string) absolute, or squared distance?</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thijs Janzen and Richèl Bilderbeek and Pedro Neves
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate data
n &lt;- 10
b_times_n &lt;- (seq(1, n) / n)
lineages_n &lt;- b_times_n
b_times2_n &lt;- b_times_n * b_times_n
lineages2_n &lt;- b_times2_n

# Calculate nLTT
out &lt;- nLTT::nltt_diff_exact_calc_extinct(
  event_times = b_times_n,
  species_number  = lineages_n,
  event_times2 = b_times2_n,
  species_number2 = lineages2_n,
  distance_method = "abs"
)
#'
</code></pre>

<hr>
<h2 id='nltt_diff_exact_extinct'>Calculates the exact difference between the nLTT
curves of the event times. This includes extinction events.</h2><span id='topic+nltt_diff_exact_extinct'></span>

<h3>Description</h3>

<p>Takes branching times such as (for example) as returned by the
DDD package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltt_diff_exact_extinct(
  event_times,
  species_number,
  event_times2,
  species_number2,
  distance_method = "abs",
  time_unit = "since",
  normalize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltt_diff_exact_extinct_+3A_event_times">event_times</code></td>
<td>
<p>event times of the first phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_extinct_+3A_species_number">species_number</code></td>
<td>
<p>the number of species at each event time of the first
phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_extinct_+3A_event_times2">event_times2</code></td>
<td>
<p>event times of the second phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_extinct_+3A_species_number2">species_number2</code></td>
<td>
<p>the number of species at each event time of the second
phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_extinct_+3A_distance_method">distance_method</code></td>
<td>
<p>how the difference between the two nLTTs is summed
</p>

<ul>
<li><p>&quot;abs: &quot;the absolute distance between the two nLTTs is summed
</p>
</li>
<li><p>&quot;squ: &quot;the squared distance between the two nLTTs is summed
</p>
</li></ul>
</td></tr>
<tr><td><code id="nltt_diff_exact_extinct_+3A_time_unit">time_unit</code></td>
<td>
<p>the time unit of the branching times
</p>

<ul>
<li><p>&quot;ago: &quot;the branching times are postive,
as these are in time units ago
</p>
</li>
<li><p>&quot;since: &quot;the branching times are negative,
as these are in time units since present
</p>
</li></ul>
</td></tr>
<tr><td><code id="nltt_diff_exact_extinct_+3A_normalize">normalize</code></td>
<td>
<p>should the output be normalized? Default is TRUE.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pedro Neves and Richèl Bilderbeek and Thijs Janzen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate data
n &lt;- 10
b_times_n &lt;- (seq(1, n) / n)
lineages_n &lt;- b_times_n
b_times2_n &lt;- b_times_n * b_times_n
lineages2_n &lt;- b_times2_n

# Calculate nLTT
out &lt;- nLTT::nltt_diff_exact_extinct(
  event_times = b_times_n,
  species_number  = lineages_n,
  event_times2 = b_times2_n,
  species_number2 = lineages2_n,
  time_unit = "ago",
  distance_method = "abs"
)

</code></pre>

<hr>
<h2 id='nltt_diff_exact_norm_brts'>Calculates the exact difference between the nLTT
curves of the branching times</h2><span id='topic+nltt_diff_exact_norm_brts'></span>

<h3>Description</h3>

<p>Calculates the exact difference between the nLTT
curves of the branching times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltt_diff_exact_norm_brts(
  b_times_n,
  lineages_n,
  b_times2_n,
  lineages2_n,
  distance_method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltt_diff_exact_norm_brts_+3A_b_times_n">b_times_n</code></td>
<td>
<p>branching times of the first phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_norm_brts_+3A_lineages_n">lineages_n</code></td>
<td>
<p>the number of lineages,
usually one to the number of lineages</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_norm_brts_+3A_b_times2_n">b_times2_n</code></td>
<td>
<p>branching times of the first phylogeny</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_norm_brts_+3A_lineages2_n">lineages2_n</code></td>
<td>
<p>the number of lineages,
usually one to the number of lineages</p>
</td></tr>
<tr><td><code id="nltt_diff_exact_norm_brts_+3A_distance_method">distance_method</code></td>
<td>
<p>(string) absolute, or squared distance?</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thijs Janzen and Richèl Bilderbeek
</p>

<hr>
<h2 id='nltt_lines'>Normalized version of the ape function ltt.lines.</h2><span id='topic+nltt_lines'></span>

<h3>Description</h3>

<p>This is a modified version of the <code>ape</code> function ltt.lines:
add the normalized Lineage-Through-Time statistic of a phylogenetic tree
to an already existing plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltt_lines(phy, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltt_lines_+3A_phy">phy</code></td>
<td>
<p>an object of class <code>"phylo"</code></p>
</td></tr>
<tr><td><code id="nltt_lines_+3A_...">...</code></td>
<td>
<p>further graphical arguments that can be passed to <code>lines()</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thijs Janzen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(exampleTrees)
  nltt_plot(exampleTrees[[1]])
  nltt_lines(exampleTrees[[2]], lty=2)
</code></pre>

<hr>
<h2 id='nltt_plot'>Normalized version of the ape function ltt.plot</h2><span id='topic+nltt_plot'></span>

<h3>Description</h3>

<p>This function uses a modified version of the ltt.plot function
from <code>"ape"</code> to plot the normalized number of lineages
through normalized time, where the number of lineages is normalized
by dividing by the number of tips of the tree,
and the time is normalized by the total time between
the most common recent ancestor and the present,
such that t(MRCA) = 0 &amp; t(present) = 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltt_plot(
  phy, xlab = "Normalized Time", ylab = "Normalized Lineages", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltt_plot_+3A_phy">phy</code></td>
<td>
<p>an object of class <code>"phylo"</code></p>
</td></tr>
<tr><td><code id="nltt_plot_+3A_xlab">xlab</code></td>
<td>
<p>a character string (or a variable of mode character)
giving the label for the <code class="reqn">x</code>-axis (default is &quot;Normalized Time&quot;).</p>
</td></tr>
<tr><td><code id="nltt_plot_+3A_ylab">ylab</code></td>
<td>
<p>a character string (or a variable of mode character)
giving the label for the <code class="reqn">y</code>-axis (default is &quot;Normalized Lineages&quot;).</p>
</td></tr>
<tr><td><code id="nltt_plot_+3A_...">...</code></td>
<td>
<p>further graphical arguments that can be passed to <code>plot()</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thijs Janzen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(exampleTrees)
  nltt_plot(exampleTrees[[1]])
</code></pre>

<hr>
<h2 id='nLTT-internal'>Internal nLTT functions</h2><span id='topic+calculate_weight'></span>

<h3>Description</h3>

<p>Internal nLTT functions</p>


<h3>Details</h3>

<p>These are not to be called by the user</p>

<hr>
<h2 id='nltts_diff'>Calculates the nLTT statistic between each phylogeny in
a collection compared to a same focal/reference tree</h2><span id='topic+nltts_diff'></span>

<h3>Description</h3>

<p>Calculates the nLTT statistic between each phylogeny in
a collection compared to a same focal/reference tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltts_diff(
  tree,
  trees,
  distance_method = "abs",
  ignore_stem = TRUE,
  log_transform = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltts_diff_+3A_tree">tree</code></td>
<td>
<p>One phylogenetic tree</p>
</td></tr>
<tr><td><code id="nltts_diff_+3A_trees">trees</code></td>
<td>
<p>A collection of one or more phylogenetic trees</p>
</td></tr>
<tr><td><code id="nltts_diff_+3A_distance_method">distance_method</code></td>
<td>
<p>(string) absolute, or squared distance?</p>
</td></tr>
<tr><td><code id="nltts_diff_+3A_ignore_stem">ignore_stem</code></td>
<td>
<p>(logical) Should the phylogeny its stem be ignored?</p>
</td></tr>
<tr><td><code id="nltts_diff_+3A_log_transform">log_transform</code></td>
<td>
<p>(logical) Should the number of lineages be
log-transformed before normalization?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the nLTT statistic values, as a numeric vector of
the same length as <code>trees</code>
</p>


<h3>Author(s)</h3>

<p>Richèl J.C. Bilderbeek
</p>


<h3>See Also</h3>

<p>use <code><a href="#topic+nltt_diff">nltt_diff</a></code> to compare two
phylogenies
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  tree &lt;- ape::rcoal(4)
  trees &lt;- c(ape::rcoal(4), ape::rcoal(4))
  nltts &lt;- nltts_diff(tree, trees)
</code></pre>

<hr>
<h2 id='nltts_plot'>Get the average nLTT from a collection of phylogenies</h2><span id='topic+nltts_plot'></span>

<h3>Description</h3>

<p>Get the average nLTT from a collection of phylogenies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nltts_plot(
  phylogenies,
  dt = 0.001,
  plot_nltts = FALSE,
  xlab = "Normalized Time",
  ylab = "Normalized Lineages",
  replot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nltts_plot_+3A_phylogenies">phylogenies</code></td>
<td>
<p>a collection of one or more phylogenies,
where the phylogenies are of type <a href="ape.html#topic+phylo">phylo</a>.
This collection can both be a list of <a href="ape.html#topic+phylo">phylo</a> or
a <a href="ape.html#topic+multiphylo">multiphylo</a>.</p>
</td></tr>
<tr><td><code id="nltts_plot_+3A_dt">dt</code></td>
<td>
<p>The timestep resolution,
a value bigger than zero and less or equal to one.
1/dt is the number of points that will be evaluated</p>
</td></tr>
<tr><td><code id="nltts_plot_+3A_plot_nltts">plot_nltts</code></td>
<td>
<p>Also plot each nLLT line</p>
</td></tr>
<tr><td><code id="nltts_plot_+3A_xlab">xlab</code></td>
<td>
<p>Label on the x axis</p>
</td></tr>
<tr><td><code id="nltts_plot_+3A_ylab">ylab</code></td>
<td>
<p>Label on the y axis</p>
</td></tr>
<tr><td><code id="nltts_plot_+3A_replot">replot</code></td>
<td>
<p>If false, start a clean plot. If true,
plot the new data over the current</p>
</td></tr>
<tr><td><code id="nltts_plot_+3A_...">...</code></td>
<td>
<p>Plotting options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Richèl J.C. Bilderbeek
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  nltts_plot(c(ape::rcoal(10), ape::rcoal(10)))
  nltts_plot(c(ape::rcoal(10), ape::rcoal(20)), dt = 0.1)
</code></pre>

<hr>
<h2 id='nLTTstat'>Calculate the difference between two normalized
Lineage-Through-Time curves, given two phylogenetic trees.</h2><span id='topic+nLTTstat'></span>

<h3>Description</h3>

<p>This function takes two ultrametric phylogenetic trees,
calculates the normalized Lineage-Through-Time statistic for both trees
and then calculates the difference between the two statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nLTTstat(tree1, tree2, distance_method = "abs", ignore_stem = TRUE,
               log_transform = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nLTTstat_+3A_tree1">tree1</code></td>
<td>
<p>an object of class <code>"phylo"</code></p>
</td></tr>
<tr><td><code id="nLTTstat_+3A_tree2">tree2</code></td>
<td>
<p>an object of class <code>"phylo"</code></p>
</td></tr>
<tr><td><code id="nLTTstat_+3A_distance_method">distance_method</code></td>
<td>
<p>Chosen measurement of distance between
the two nLTT curves, options are (case sensitive):<br />
- &quot;abs&quot;: use the absolute distance<br />
- &quot;squ&quot;: use the squared distance;<br /></p>
</td></tr>
<tr><td><code id="nLTTstat_+3A_ignore_stem">ignore_stem</code></td>
<td>
<p>a boolean whether to ignore the stem length</p>
</td></tr>
<tr><td><code id="nLTTstat_+3A_log_transform">log_transform</code></td>
<td>
<p>a boolean wether to log-transform the number of
lineages before normalization</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The difference between the two nLTT statistics
</p>


<h3>Author(s)</h3>

<p>Thijs Janzen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(exampleTrees)
  nltt_plot(exampleTrees[[1]])
  nltt_lines(exampleTrees[[2]], lty=2)
  nLTTstat(
    exampleTrees[[1]], exampleTrees[[2]],
    distance_method = "abs", ignore_stem = TRUE)
</code></pre>

<hr>
<h2 id='nLTTstat_exact'>Calculate the exact difference between
two normalized Lineage-Through-Time curves, given two phylogenetic trees.</h2><span id='topic+nLTTstat_exact'></span>

<h3>Description</h3>

<p>This function takes two ultrametric phylogenetic trees,
calculates the normalized Lineage-Through-Time statistic
for both trees and then calculates the exact difference
between the two statistics.
Whereas the function <code>nLTTstat</code> uses an approximation
to calculate the difference (which is faster for large trees),
the function <code>nLTTstat_exact</code> calculates the exact difference,
and should generally be preferred.
Although the estimates are highly similar,
<code>nLTTstat_exact</code> tends to return slightly higher values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nLTTstat_exact(tree1, tree2, distance_method = "abs",
                 ignore_stem = TRUE, log_transform = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nLTTstat_exact_+3A_tree1">tree1</code></td>
<td>
<p>an object of class <code>"phylo"</code></p>
</td></tr>
<tr><td><code id="nLTTstat_exact_+3A_tree2">tree2</code></td>
<td>
<p>an object of class <code>"phylo"</code></p>
</td></tr>
<tr><td><code id="nLTTstat_exact_+3A_distance_method">distance_method</code></td>
<td>
<p>Chosen measurement of distance between the two nLTT curves,
options are (case sensitive):<br />
- &quot;abs&quot;: use the absolute distance.<br />
- &quot;squ&quot;: use the squared distance</p>
</td></tr>
<tr><td><code id="nLTTstat_exact_+3A_ignore_stem">ignore_stem</code></td>
<td>
<p>a boolean whether to ignore the stem length</p>
</td></tr>
<tr><td><code id="nLTTstat_exact_+3A_log_transform">log_transform</code></td>
<td>
<p>a boolean wether to log-transform the number of
lineages before normalization</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The exact difference between the two nLTT statistics
</p>


<h3>Author(s)</h3>

<p>Thijs Janzen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(exampleTrees)
  nltt_plot(exampleTrees[[1]])
  nltt_lines(exampleTrees[[2]], lty = 2)
  nLTTstat_exact(
    exampleTrees[[1]],
    exampleTrees[[2]],
    distance_method = "abs",
    ignore_stem = TRUE
  )
</code></pre>

<hr>
<h2 id='stretch_nltt_matrix'>Stretch matrix 'm' with a timestep resolution of 'dt'.</h2><span id='topic+stretch_nltt_matrix'></span>

<h3>Description</h3>

<p>Stretch matrix 'm' with a timestep resolution of 'dt'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stretch_nltt_matrix(m, dt, step_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stretch_nltt_matrix_+3A_m">m</code></td>
<td>
<p>A matrix of 2 columns and at least 2 rows</p>
</td></tr>
<tr><td><code id="stretch_nltt_matrix_+3A_dt">dt</code></td>
<td>
<p>The resulution, a value e [0.0001, 1].
If 'dt' is set to a very small value, this function will stop</p>
</td></tr>
<tr><td><code id="stretch_nltt_matrix_+3A_step_type">step_type</code></td>
<td>
<p>when between two points, where the second point
has both a higher x and y coordinat, which y coordinat to follow.
'step_type' can be:
</p>

<ul>
<li><p> lower maintain the y-coordinat of the leftmost point
</p>
</li>
<li><p> upper already use the y-coordinat of the rightmost point
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>The stretched matrix
</p>


<h3>Author(s)</h3>

<p>Richèl J.C. Bilderbeek
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  m &lt;- matrix( c(c(0.0, 1.0), c(0.5, 1.0)), ncol = 2, nrow = 2)
  expected &lt;- matrix(
    c(
      c(0.0, 0.5, 1.0),  # Timepoints
      c(0.5, 0.5, 1.0)   # Values
    ),
    ncol = 2, nrow = 3
  )
  result &lt;- stretch_nltt_matrix(m = m, dt = 0.5, step_type = "lower")
  all.equal(result, expected)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
