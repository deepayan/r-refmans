<!DOCTYPE html><html lang="en"><head><title>Help for package beast</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {beast}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#beast-package'>
<p>Bayesian Estimation of Change-Points in the Slope of Multivariate Time-Series</p></a></li>
<li><a href='#beast'>
<p>Main function</p></a></li>
<li><a href='#birthProbs'>
<p>Birth Probabilities</p></a></li>
<li><a href='#complexityPrior'>
<p>Complexity prior distribution</p></a></li>
<li><a href='#computeEmpiricalPriorParameters'>
<p>Compute the empirical mean.</p></a></li>
<li><a href='#computePosteriorParameters'>
<p>Compute empirical posterior parameters</p></a></li>
<li><a href='#computePosteriorParametersFree'>
<p>Posterior parameters</p></a></li>
<li><a href='#FungalGrowthDataset'><p>Fungal Growth Dataset</p></a></li>
<li><a href='#localProposal'>
<p>Move 3.b</p></a></li>
<li><a href='#logLikelihoodFullModel'>
<p>Log-likelihood function.</p></a></li>
<li><a href='#logPrior'>
<p>Log-prior.</p></a></li>
<li><a href='#mcmcSampler'>
<p>MCMC sampler</p></a></li>
<li><a href='#myUnicodeCharacters'>
<p>Printing</p></a></li>
<li><a href='#normalizeTime0'>
<p>Zero normalization</p></a></li>
<li><a href='#plot.beast.object'>
<p>Plot function</p></a></li>
<li><a href='#print.beast.object'>
<p>Print function</p></a></li>
<li><a href='#proposeTheta'>
<p>Move 2</p></a></li>
<li><a href='#simMultiIndNormInvGamma'>
<p>Prior random numbers</p></a></li>
<li><a href='#simulateFromPrior'>
<p>Generate change-points according to the prior</p></a></li>
<li><a href='#singleLocalProposal'>
<p>Move 3.b</p></a></li>
<li><a href='#truncatedPoisson'>
<p>Truncated Poisson pdf</p></a></li>
<li><a href='#updateNumberOfCutpoints'>
<p>Move 1</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Estimation of Change-Points in the Slope of
Multivariate Time-Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Panagiotis Papastamoulis</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Panagiotis Papastamoulis &lt;papapast@yahoo.gr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Assume that a temporal process is composed of contiguous segments with differing slopes and replicated noise-corrupted time series measurements are observed. The unknown mean of the data generating process is modelled as a piecewise linear function of time with an unknown number of change-points. The package infers the joint posterior distribution of the number and position of change-points as well as the unknown mean parameters per time-series by MCMC sampling. A-priori, the proposed model uses an overfitting number of mean parameters but, conditionally on a set of change-points, only a subset of them influences the likelihood. An exponentially decreasing prior distribution on the number of change-points gives rise to a posterior distribution concentrating on sparse representations of the underlying sequence, but also available is the Poisson distribution. See Papastamoulis et al (2017) &lt;<a href="https://doi.org/10.48550/arXiv.1709.06111">doi:10.48550/arXiv.1709.06111</a>&gt; for a detailed presentation of the method.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>RColorBrewer</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-16 07:12:36 UTC; mqbssppe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-16 07:42:36 UTC</td>
</tr>
</table>
<hr>
<h2 id='beast-package'>
Bayesian Estimation of Change-Points in the Slope of Multivariate Time-Series
</h2><span id='topic+beast-package'></span>

<h3>Description</h3>

<p>Assume that a temporal process is composed of contiguous segments with differing slopes and replicated noise-corrupted time series measurements are observed. The unknown mean of the data generating process is modelled as a piecewise linear function of time with an unknown number of change-points. The package infers the joint posterior distribution of the number and position of change-points as well as the unknown mean parameters per time-series by MCMC sampling. A-priori, the proposed model uses an overfitting number of mean parameters but, conditionally on a set of change-points, only a subset of them influences the likelihood. An exponentially decreasing prior distribution on the number of change-points gives rise to a posterior distribution concentrating on sparse representations of the underlying sequence, but also available is the Poisson distribution. See Papastamoulis et al (2017) &lt;arXiv:1709.06111&gt; for a detailed presentation of the method.
</p>


<h3>Details</h3>

<p>The <code>beast</code> package deals with <b>B</b>ayesian <b>e</b>stimation of ch<b>a</b>nge-points in the <b>s</b>lope of multivariate <b>t</b>ime-series, introduced by Papastamoulis et al (2017). For a given period <code class="reqn">t = 1,\ldots,T</code> we observe multiple time series which are assumed independent, each one consisting of multiple measurements (replicates). Each time series is assumed to have its own segmentation, which is common among its replicates. Thus, different time series have distinct mean parameters in the underlying normal distribution. The variance, which is assumed known, can be either shared between different time series or not and in practice it is estimated at a pre-processing stage. 
</p>
<p>Our model infers the joint posterior distribution of the number and location of change-points by MCMC sampling. For this purpose a Metropolis-Hastings MCMC sampler is used. The main function of the package is <code><a href="#topic+beast">beast</a></code>. 
</p>
<p>Assume that the observed data consists of <code class="reqn">N</code> time-series, each one consisting of <code class="reqn">R</code> variables (or replicates) measured at <code class="reqn">T</code> consecutive time-points. The input of the main function <code><a href="#topic+beast">beast</a></code> should be given in the form of a <code>list</code> <code>myDataList</code> with the following attributes: </p>

<ul>
<li> <p><code>length(myDataList)</code> should be equal to <code class="reqn">R</code>, that is, the number of variables (or replicates)
</p>
</li>
<li> <p><code>dim(myDataList)[[1]]</code>, <code class="reqn">\ldots</code>, <code>dim(myDataList)[[R]]</code> should be all <code class="reqn">T\times N</code>, that is, rows and columns should correspond to time-points and different series, respectively.
</p>
</li></ul>

<p>Then, a basic usage of the package consists of the following commands: </p>

<ul>
<li> <p><code>beastRun &lt;- beast( myDataList = myDataList )</code>
</p>
</li>
<li> <p><code>print(beastRun)</code>
</p>
</li>
<li> <p><code>plot(beastRun)</code>
</p>
</li></ul>

<p>which correspond to running the MCMC sampler, printing and plotting output summaries, respectively.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>
<p>Maintainer: Panagiotis Papastamoulis &lt;papapast@yahoo.gr&gt;
</p>


<h3>References</h3>

<p>Papastamoulis P., Furukawa T., van Rhijn N., Bromley M., Bignell E. and Rattray M. (2017). Bayesian detection of piecewise linear trends in replicated time-series with application to growth data modelling. arXiv:<b>1709.06111</b> [stat.AP]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+beast">beast</a>, <a href="#topic+print.beast.object">print.beast.object</a>, <a href="#topic+plot.beast.object">plot.beast.object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># toy-example (MCMC iterations not enough)
library('beast')	# load package
data("FungalGrowthDataset")	# load dataset
myIndex &lt;- c(392, 62, 3, 117)	# run the sampler only for the 
#                                 specific subset of time-series
set.seed(1)	
# Run MCMC sampler with very small number of iterations (nIter):
run_mcmc &lt;- beast(myDataList = FungalGrowthDataset, subsetIndex = myIndex, 
			zeroNormalization = TRUE, nIter = 40, burn = 20) 
# Print output:
print(run_mcmc)
# Plot output to file: "beast_plot.pdf"
plot(run_mcmc, fileName = "beast_plot_toy.pdf", timeScale=1/6, xlab = "hours", ylab = "growth")
# Run the following commands to obtain convergence:

## Not run: 
# This example illustrates the package using a subset of four 
#      time-series of the fungal dataset. 
library('beast')	# load package
data("FungalGrowthDataset")	# load dataset
myIndex &lt;- c(392, 62, 3, 117)	# run the sampler only for the 
#                                 specific subset of time-series
set.seed(1)		# optional
# Run MCMC sampler with the default number of iterations (nIter =70000):
run_mcmc &lt;- beast(myDataList = FungalGrowthDataset, subsetIndex = myIndex, 
			zeroNormalization = TRUE) 
# Print output:
print(run_mcmc)
# Plot output to file: "beast_plot.pdf"
plot(run_mcmc, fileName = "beast_plot.pdf", timeScale=1/6, xlab = "hours", ylab = "growth")
# NOTE 1: for a complete analysis remove the `subsetIndex = myIndex` argument.
# NOTE 2: `zeroNormalization = TRUE` is an optional argument that forces all 
#	   time-series to start from zero. It is not supposed to be used 
#	   for other applications.

## End(Not run)
</code></pre>

<hr>
<h2 id='beast'>
Main function
</h2><span id='topic+beast'></span>

<h3>Description</h3>

<p>This is the main function of the package, implementing the MCMC sampler described in Papastamoulis et al (2017). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beast(myDataList, burn, nIter, mhPropRange, mhSinglePropRange, startPoint,
    timeScale, savePlots, zeroNormalization, LRange, tau,
    gammaParameter, nu0, alpha0, beta0, subsetIndex, saveTheta, sameVariance,
    Prior
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="beast_+3A_mydatalist">myDataList</code></td>
<td>

<p>Observed data in the form of a <code>list</code> with length <code class="reqn">R</code>, denoting the dimensionality of the multivariate time-series data. For each <code class="reqn">r = 1,\ldots,R</code>, <code>myDataList[[r]]</code> should correspond to <code class="reqn">T\times N</code> array, with <code>myDataList[[r]][t, n]</code> corresponding to the observed data for time-series <code class="reqn">n = 1,\ldots,N</code> and time-point <code class="reqn">t = 1,\ldots,T</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_burn">burn</code></td>
<td>

<p>Number of iterations that will be discarder as burn-in period. Default value: <code>burn = 20000</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_niter">nIter</code></td>
<td>

<p>Number of MCMC iterations. Default value: <code>nIter = 70000</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_mhproprange">mhPropRange</code></td>
<td>

<p>Positive integer corresponding to the parameter <code class="reqn">d_1</code> of MCMC Move 3.a of Papastamoulis et al (2017). Default value: <code>mhPropRange = 1</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_mhsingleproprange">mhSinglePropRange</code></td>
<td>

<p>Positive integer denoting the parameter <code class="reqn">d_2</code> of Papastamoulis et al (2017). Default value: <code>mhPropRange = 40</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_startpoint">startPoint</code></td>
<td>

<p>An (optional) positive integer pointing at the minimum time-point where changes are allowed to occur. Default value: <code>startPoint = 2</code> (all possible values are taken into account).
</p>
</td></tr>
<tr><td><code id="beast_+3A_timescale">timeScale</code></td>
<td>

<p>Null.
</p>
</td></tr>
<tr><td><code id="beast_+3A_saveplots">savePlots</code></td>
<td>

<p>Character denoting the name of the folder where various plots will be saved to.
</p>
</td></tr>
<tr><td><code id="beast_+3A_zeronormalization">zeroNormalization</code></td>
<td>

<p>Logical value denoting whether to normalize to zero all time time-series for <code class="reqn">t=1</code>. Default: <code>zeroNormalization = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_lrange">LRange</code></td>
<td>

<p>Range of possible values for the number of change-points. Default value: <code>LRange = 0:30</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_tau">tau</code></td>
<td>

<p>Positive real number corresponding to parameter <code class="reqn">c</code> in Move 2 of Papastamoulis et al (2017). Default value: <code>tau = 0.05</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_gammaparameter">gammaParameter</code></td>
<td>

<p>Positive real number corresponding to parameter <code class="reqn">\alpha</code> of the exponential prior distribution. Default value: <code>gammaParameter = 2</code>. 
</p>
</td></tr>
<tr><td><code id="beast_+3A_nu0">nu0</code></td>
<td>

<p>Positive real number corresponding to prior parameter <code class="reqn">\nu_0</code> in Papastamoulis et al (2017). Default value: <code>nu0 = 0.1</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_alpha0">alpha0</code></td>
<td>

<p>Positive real number corresponding to prior parameter <code class="reqn">\alpha_0</code> in Papastamoulis et al (2017). Default value: <code>alpha0 = 1</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_beta0">beta0</code></td>
<td>

<p>Positive real number corresponding to prior parameter <code class="reqn">\beta_0</code> in Papastamoulis et al (2017). Default value: <code>beta0 = 1</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_subsetindex">subsetIndex</code></td>
<td>

<p>Optional subset of integers corresponding to time-series indexes. If not null, the sampler will be applied only to the specified subset.
</p>
</td></tr>
<tr><td><code id="beast_+3A_savetheta">saveTheta</code></td>
<td>

<p>Logical value indicating whether to save the generated values of the mean per time-point across the MCMC trace. Default: FALSE.
</p>
</td></tr>
<tr><td><code id="beast_+3A_samevariance">sameVariance</code></td>
<td>

<p>Logical value indicating whether to assume the same variance per time-point across time-series. Default value: <code>sameVariance = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="beast_+3A_prior">Prior</code></td>
<td>

<p>Character string specifying the prior distribution of the number of change-points. Allowed values: <code>Prior = "complexity"</code> (default) or <code>Prior = "Poisson"</code> (not suggested). 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output of the sampler is returned as a list, with the following features:
</p>
<table role = "presentation">
<tr><td><code>Cutpoint_posterior_median</code></td>
<td>
<p>The estimated medians per change-point, conditionally on the most probable number of change-points per time-series.</p>
</td></tr>
<tr><td><code>Cutpoint_posterior_variance</code></td>
<td>
<p>The estimated variances per change-points, conditionally on the most probable number of change-points per time-series.</p>
</td></tr>
<tr><td><code>NumberOfCutPoints_posterior_distribution</code></td>
<td>
<p>Posterior distributions of number of change-points per time-series.</p>
</td></tr>
<tr><td><code>NumberOfCutPoints_MAP</code></td>
<td>
<p>The most probable number of change-points per time-series.</p>
</td></tr>
<tr><td><code>Metropolis-Hastings_acceptance_rate</code></td>
<td>
<p>Acceptance of the MCMC move-types.</p>
</td></tr>
<tr><td><code>subject_ID</code></td>
<td>
<p>the identifier of individual time-series.</p>
</td></tr>
<tr><td><code>Cutpoint_mcmc_trace_map</code></td>
<td>
<p>The sampled values of each change-point per time series, conditionally on the MAP values.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The sampled values of the means per time-series, conditionally on the MAP values.</p>
</td></tr>
<tr><td><code>nCutPointsTrace</code></td>
<td>
<p>The sampled values of the number of change-points, per time-series.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The complexity prior distribution with parameter <code>gammaParameter = 2</code> is the default prior assumption imposed on the number of change-points. Smaller (larger) values of <code>gammaParameter</code> will a-priori support larger (respectively: smaller) number of change-points. 
</p>
<p>For completeness purposes, the Poisson distribution is also allowed in the <code>Prior</code>. In this latter case, the <code>gammaParameter</code> denotes the rate parameter of the Poisson distribution. Note that in this case the interpretation of <code>gammaParameter</code> is reversed: Smaller (larger) values of <code>gammaParameter</code> will a-priori support smaller (respectively: larger) number of change-points.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>


<h3>References</h3>

<p>Papastamoulis P., Furukawa T., van Rhijn N., Bromley M., Bignell E. and Rattray M. (2017). Bayesian detection of piecewise linear trends in replicated time-series with application to growth data modelling. arXiv:1709.06111 [stat.AP]
</p>


<h3>Examples</h3>

<pre><code class='language-R'># toy-example (MCMC iterations not enough)
library('beast')	# load package
data("FungalGrowthDataset")	# load dataset
myIndex &lt;- c(392, 62, 3, 117)	# run the sampler only for the 
#                                 specific subset of time-series
set.seed(1)	
# Run MCMC sampler with very small number of iterations (nIter):
run_mcmc &lt;- beast(myDataList = FungalGrowthDataset, subsetIndex = myIndex, 
			zeroNormalization = TRUE, nIter = 40, burn = 20) 
# Print output:
print(run_mcmc)
# Plot output to file: "beast_plot.pdf"
plot(run_mcmc, fileName = "beast_plot_toy.pdf", timeScale=1/6, xlab = "hours", ylab = "growth")
# Run the following commands to obtain convergence:

## Not run: 
# This example illustrates the package using a subset of four 
#      time-series of the fungal dataset. 
library('beast')	# load package
data("FungalGrowthDataset")	# load dataset
myIndex &lt;- c(392, 62, 3, 117)	# run the sampler only for the 
#                                 specific subset of time-series
set.seed(1)		# optional
# Run MCMC sampler with the default number of iterations (nIter =70000):
run_mcmc &lt;- beast(myDataList = FungalGrowthDataset, subsetIndex = myIndex, 
			zeroNormalization = TRUE) 
# Print output:
print(run_mcmc)
# Plot output to file: "beast_plot.pdf"
plot(run_mcmc, fileName = "beast_plot.pdf", timeScale=1/6, xlab = "hours", ylab = "growth")
# NOTE 1: for a complete analysis remove the `subsetIndex = myIndex` argument.
# NOTE 2: `zeroNormalization = TRUE` is an optional argument that forces all 
#	   time-series to start from zero. It is not supposed to be used 
#	   for other applications.

## End(Not run)
</code></pre>

<hr>
<h2 id='birthProbs'>
Birth Probabilities
</h2><span id='topic+birthProbs'></span>

<h3>Description</h3>

<p>This function defines the probability of proposing an addition of a change-point. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>birthProbs(LRange)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="birthProbs_+3A_lrange">LRange</code></td>
<td>
<p> The range of possible values for the number of change-points.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>probs</code></td>
<td>
<p>Vector of probabilities</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='complexityPrior'>
Complexity prior distribution
</h2><span id='topic+complexityPrior'></span>

<h3>Description</h3>

<p>This function computes the complexity prior distribution on the number of change-points, defined as <code class="reqn">f(\ell) = P(\ell_n = \ell)\propto e^{-\alpha\ell\log(bT/\ell)}, a, b &gt; 0; \ell = 0,1,2,\ldots</code>. Note that this distribution has exponential decrease (Castillo and van der Vaart, 2012) when <code class="reqn">b&gt;1+e</code>, so we set <code class="reqn">b=3.72</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complexityPrior(Lmax = 20, gammaParameter, nTime)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="complexityPrior_+3A_lmax">Lmax</code></td>
<td>

<p>maximum number of change-points (default = 20). 
</p>
</td></tr>
<tr><td><code id="complexityPrior_+3A_gammaparameter">gammaParameter</code></td>
<td>

<p>positive real number, corresponding to <code class="reqn">\alpha</code>.
</p>
</td></tr>
<tr><td><code id="complexityPrior_+3A_ntime">nTime</code></td>
<td>

<p>positive integer denoting the total number of time-points.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>logPrior</code></td>
<td>
<p>Prior distribution values in the log-scale.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>


<h3>References</h3>

<p>Castillo I. and van der Vaart A (2012). Needles and Straw in a Haystack: Posterior concentration for possibly sparse sequences. The Annals of Statistics, 40(4), 2069&ndash;2101.
</p>

<hr>
<h2 id='computeEmpiricalPriorParameters'>
Compute the empirical mean.
</h2><span id='topic+computeEmpiricalPriorParameters'></span>

<h3>Description</h3>

<p>This function computes the empirical mean of the time-series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeEmpiricalPriorParameters(myDataList, nu0 = 1, alpha0 = 1, beta0 = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeEmpiricalPriorParameters_+3A_mydatalist">myDataList</code></td>
<td>

<p>Observed multivariate time-series.
</p>
</td></tr>
<tr><td><code id="computeEmpiricalPriorParameters_+3A_nu0">nu0</code></td>
<td>

<p>positive real number.
</p>
</td></tr>
<tr><td><code id="computeEmpiricalPriorParameters_+3A_alpha0">alpha0</code></td>
<td>

<p>positive real number.
</p>
</td></tr>
<tr><td><code id="computeEmpiricalPriorParameters_+3A_beta0">beta0</code></td>
<td>

<p>positive real number.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mu0</code></td>
<td>
<p>Empirical mean</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='computePosteriorParameters'>
Compute empirical posterior parameters
</h2><span id='topic+computePosteriorParameters'></span>

<h3>Description</h3>

<p>Compute empirical posterior parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computePosteriorParameters(myDataList, priorParameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computePosteriorParameters_+3A_mydatalist">myDataList</code></td>
<td>

<p>Observed data.
</p>
</td></tr>
<tr><td><code id="computePosteriorParameters_+3A_priorparameters">priorParameters</code></td>
<td>

<p>Prior parameters.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of posterior parameters
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='computePosteriorParametersFree'>
Posterior parameters
</h2><span id='topic+computePosteriorParametersFree'></span>

<h3>Description</h3>

<p>Posterior parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computePosteriorParametersFree(myDataList, priorParameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computePosteriorParametersFree_+3A_mydatalist">myDataList</code></td>
<td>

<p>observed data.
</p>
</td></tr>
<tr><td><code id="computePosteriorParametersFree_+3A_priorparameters">priorParameters</code></td>
<td>

<p>list of prior parameters.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of posterior parameters.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='FungalGrowthDataset'>Fungal Growth Dataset</h2><span id='topic+FungalGrowthDataset'></span>

<h3>Description</h3>

<p>Time-series dataset with <code class="reqn">N\times R \times T</code> growth levels for <code class="reqn">R = 3</code> replicates of <code class="reqn">N = 411</code> objects (mutants) measured every 10 minutes for <code class="reqn">T = 289</code> time-points. See Papastamoulis et al (2017) for a detailed description.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FungalGrowthDataset</code></pre>


<h3>Format</h3>

<p>Time-series data.</p>


<h3>References</h3>


<p>Papastamoulis P., Furukawa T., van Rhijn N., Bromley M., Bignell E. and Rattray M. (2017). Bayesian detection of piecewise linear trends in replicated time-series with application to growth data modelling. arXiv:<b>1709.06111</b> [stat.AP]
</p>

<hr>
<h2 id='localProposal'>
Move 3.b
</h2><span id='topic+localProposal'></span>

<h3>Description</h3>

<p>Implements Move 3.b of the Metropolis-Hastings MCMC sampler.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>localProposal(cutPoints, nTime, mhPropRange, startPoint)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="localProposal_+3A_cutpoints">cutPoints</code></td>
<td>

<p>Current configuration of change-points.
</p>
</td></tr>
<tr><td><code id="localProposal_+3A_ntime">nTime</code></td>
<td>

<p>Total number of time-points.
</p>
</td></tr>
<tr><td><code id="localProposal_+3A_mhproprange">mhPropRange</code></td>
<td>

<p>Parameter <code class="reqn">d_2</code>.
</p>
</td></tr>
<tr><td><code id="localProposal_+3A_startpoint">startPoint</code></td>
<td>

<p>Integer, at least equal to 2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>newState</code></td>
<td>
<p>Candidate state of the chain.</p>
</td></tr>
<tr><td><code>propRatio</code></td>
<td>
<p>Proposal ratio.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='logLikelihoodFullModel'>
Log-likelihood function.
</h2><span id='topic+logLikelihoodFullModel'></span>

<h3>Description</h3>

<p>Log-likelihood function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLikelihoodFullModel(myData, cutPoints, theta, startPoint)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikelihoodFullModel_+3A_mydata">myData</code></td>
<td>

<p>data
</p>
</td></tr>
<tr><td><code id="logLikelihoodFullModel_+3A_cutpoints">cutPoints</code></td>
<td>

<p>change-points.
</p>
</td></tr>
<tr><td><code id="logLikelihoodFullModel_+3A_theta">theta</code></td>
<td>

<p>means.
</p>
</td></tr>
<tr><td><code id="logLikelihoodFullModel_+3A_startpoint">startPoint</code></td>
<td>

<p>optional integer at least equal to 2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>log-likelihood value.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='logPrior'>
Log-prior.
</h2><span id='topic+logPrior'></span>

<h3>Description</h3>

<p>Logarithm of the prior distribution on the number of change-points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logPrior(cutPoints, nTime, startPoint)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logPrior_+3A_cutpoints">cutPoints</code></td>
<td>

<p>change-points.
</p>
</td></tr>
<tr><td><code id="logPrior_+3A_ntime">nTime</code></td>
<td>

<p>number of time-points.
</p>
</td></tr>
<tr><td><code id="logPrior_+3A_startpoint">startPoint</code></td>
<td>

<p>optional integer, at least equal to 2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logarithm of the prior distribution.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='mcmcSampler'>
MCMC sampler
</h2><span id='topic+mcmcSampler'></span>

<h3>Description</h3>

<p>This function implements the Metropolis-Hastings MCMC sampler for individual time-series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmcSampler(myData, nIter, finalIterationPdf, modelVariance, mhPropRange, 
mhSinglePropRange, movesRange, startPoint, postPar, dName, timeScale, 
burn, iterPerPlotPrefix, priorParameters, L = 3, LRange, tau, 
gammaParameter, saveTheta, Prior = "complexity")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcmcSampler_+3A_mydata">myData</code></td>
<td>

<p>observed data.
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_niter">nIter</code></td>
<td>

<p>number of mcmc iterations
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_finaliterationpdf">finalIterationPdf</code></td>
<td>

<p>output folder
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_modelvariance">modelVariance</code></td>
<td>

<p>null
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_mhproprange">mhPropRange</code></td>
<td>

<p>positive integer
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_mhsingleproprange">mhSinglePropRange</code></td>
<td>

<p>positive integer
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_movesrange">movesRange</code></td>
<td>

<p>null
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_startpoint">startPoint</code></td>
<td>

<p>positive integer
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_postpar">postPar</code></td>
<td>

<p>list of emprirically estimated parameters
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_dname">dName</code></td>
<td>

<p>subject ID
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_timescale">timeScale</code></td>
<td>

<p>null
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_burn">burn</code></td>
<td>

<p>burn-in period.
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_iterperplotprefix">iterPerPlotPrefix</code></td>
<td>

<p>null
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_priorparameters">priorParameters</code></td>
<td>

<p>prior parameters.
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_l">L</code></td>
<td>

<p>null
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_lrange">LRange</code></td>
<td>

<p>range of possible values of the number of change-points.
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_tau">tau</code></td>
<td>

<p>real.
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_gammaparameter">gammaParameter</code></td>
<td>

<p>real.
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_savetheta">saveTheta</code></td>
<td>

<p>TRUE.
</p>
</td></tr>
<tr><td><code id="mcmcSampler_+3A_prior">Prior</code></td>
<td>

<p>character.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MCMC output.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='myUnicodeCharacters'>
Printing
</h2><span id='topic+myUnicodeCharacters'></span>

<h3>Description</h3>

<p>Printing various unicode symbols.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myUnicodeCharacters()
</code></pre>


<h3>Value</h3>

<p>printed symbol
</p>

<hr>
<h2 id='normalizeTime0'>
Zero normalization
</h2><span id='topic+normalizeTime0'></span>

<h3>Description</h3>

<p>Zero normalization at 1st time-point
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizeTime0(myDataList)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalizeTime0_+3A_mydatalist">myDataList</code></td>
<td>

<p>data
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>null
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='plot.beast.object'>
Plot function
</h2><span id='topic+plot.beast.object'></span>

<h3>Description</h3>

<p>This function plots objects returned by the <code>beast</code> function. All output is diverted to a pdf file provided in the <code>fileName</code> argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beast.object'
plot(x, fileName, width, height, pointsize, ylab, xlab, timeScale, myPal, boxwex, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.beast.object_+3A_x">x</code></td>
<td>

<p>An object of class <code>beast.object</code>, which is returned by the <code>beast</code> function.
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_filename">fileName</code></td>
<td>

<p>Name of the output pdf file.
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_width">width</code></td>
<td>

<p>Width of pdf file. Default: 9
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_height">height</code></td>
<td>

<p>Height pdf file. Default: 6
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_pointsize">pointsize</code></td>
<td>

<p>Pointsize. Default: 12
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_ylab">ylab</code></td>
<td>

<p><code class="reqn">y</code>-axis label. Default: x.
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_xlab">xlab</code></td>
<td>

<p><code class="reqn">x</code>-axis label. Default: t.
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_timescale">timeScale</code></td>
<td>

<p>A multiplicative-factor which will be used to scale the <code class="reqn">x</code>-axis labels. For example, if time-points correspond to 10-minute periods, then setting <code>timeScale = 1/6</code> will make the <code class="reqn">x</code>-axis labels correspond to hours. Default: <code>timeScale = 1</code>.
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_mypal">myPal</code></td>
<td>

<p>Vector of colors that will be used to produce the plot with all time-series overlayed. If the distinct values of the inferred numbers of change-points is less than 10,  the <code>Set1</code> pallete of the <code>RColorBrewer</code> library is used. Otherwise, the user has to manually define the colors.
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_boxwex">boxwex</code></td>
<td>

<p>A scale factor to be applied to all boxes. The appearance of the plot can be improved by making the boxes narrower or wider. Default: 0.2.
</p>
</td></tr>
<tr><td><code id="plot.beast.object_+3A_...">...</code></td>
<td>

<p>ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function will produce a plot with all time-series coloured according to the corresponding number of change-points. In addition, it will generate individual plots per time-series displaying the observed data with boxplots which summarize the posterior distribution of change-points locations, conditionally on the most probable number of change-points.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='print.beast.object'>
Print function
</h2><span id='topic+print.beast.object'></span>

<h3>Description</h3>

<p>This function prints a summary of objects returned by the <code>beast</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'beast.object'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.beast.object_+3A_x">x</code></td>
<td>

<p>An object of class <code>beast.object</code>, which is returned by the <code>beast</code> function.
</p>
</td></tr>
<tr><td><code id="print.beast.object_+3A_...">...</code></td>
<td>

<p>ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints a summary of the most probable number (MAP) of change-points per time-series in the form of a table, as well as a list containing the MAP number of change-points and the corresponding locations (posterior medians) per time-series.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='proposeTheta'>
Move 2
</h2><span id='topic+proposeTheta'></span>

<h3>Description</h3>

<p>Proposes an update of <code class="reqn">\theta</code> according to Metropolis-Hastings move 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proposeTheta(thetaOld, tau, alpha, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proposeTheta_+3A_thetaold">thetaOld</code></td>
<td>

<p>Current values
</p>
</td></tr>
<tr><td><code id="proposeTheta_+3A_tau">tau</code></td>
<td>

<p>Parameter <code class="reqn">c</code>.
</p>
</td></tr>
<tr><td><code id="proposeTheta_+3A_alpha">alpha</code></td>
<td>

<p>null
</p>
</td></tr>
<tr><td><code id="proposeTheta_+3A_beta">beta</code></td>
<td>

<p>null
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mean</code></td>
<td>
<p>proposed values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='simMultiIndNormInvGamma'>
Prior random numbers
</h2><span id='topic+simMultiIndNormInvGamma'></span>

<h3>Description</h3>

<p>Generation of mean values according to the prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simMultiIndNormInvGamma(mu, nu, alpha, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simMultiIndNormInvGamma_+3A_mu">mu</code></td>
<td>

<p>means
</p>
</td></tr>
<tr><td><code id="simMultiIndNormInvGamma_+3A_nu">nu</code></td>
<td>

<p>precision parameter
</p>
</td></tr>
<tr><td><code id="simMultiIndNormInvGamma_+3A_alpha">alpha</code></td>
<td>

<p>prior parameter
</p>
</td></tr>
<tr><td><code id="simMultiIndNormInvGamma_+3A_beta">beta</code></td>
<td>

<p>prior parameter
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>null
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='simulateFromPrior'>
Generate change-points according to the prior
</h2><span id='topic+simulateFromPrior'></span>

<h3>Description</h3>

<p>Generate change-points according to the prior distribution conditionally on a given number of change-points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateFromPrior(nTime, startPoint, L = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulateFromPrior_+3A_ntime">nTime</code></td>
<td>

<p>Number of time-points
</p>
</td></tr>
<tr><td><code id="simulateFromPrior_+3A_startpoint">startPoint</code></td>
<td>

<p>At least equal to 2.
</p>
</td></tr>
<tr><td><code id="simulateFromPrior_+3A_l">L</code></td>
<td>

<p>null
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>cutPoints</code></td>
<td>
<p>Change-point locations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='singleLocalProposal'>
Move 3.b
</h2><span id='topic+singleLocalProposal'></span>

<h3>Description</h3>

<p>Implement Metropolis-Hastings Move 3.b.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>singleLocalProposal(cutPoints, nTime, mhSinglePropRange, startPoint)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="singleLocalProposal_+3A_cutpoints">cutPoints</code></td>
<td>

<p>Current state
</p>
</td></tr>
<tr><td><code id="singleLocalProposal_+3A_ntime">nTime</code></td>
<td>

<p>Number of time-points
</p>
</td></tr>
<tr><td><code id="singleLocalProposal_+3A_mhsingleproprange">mhSinglePropRange</code></td>
<td>

<p>Prior parameter.
</p>
</td></tr>
<tr><td><code id="singleLocalProposal_+3A_startpoint">startPoint</code></td>
<td>

<p>Optional.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>newState</code></td>
<td>
<p>Candidate state</p>
</td></tr>
<tr><td><code>propRatio</code></td>
<td>
<p>Proposal ratio</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='truncatedPoisson'>
Truncated Poisson pdf
</h2><span id='topic+truncatedPoisson'></span>

<h3>Description</h3>

<p>Probability density function of the truncated Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truncatedPoisson(Lmax = 20, gammaParameter = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="truncatedPoisson_+3A_lmax">Lmax</code></td>
<td>

<p>Max number
</p>
</td></tr>
<tr><td><code id="truncatedPoisson_+3A_gammaparameter">gammaParameter</code></td>
<td>

<p>Location parameter.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>logPrior</code></td>
<td>
<p>Log-pdf values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

<hr>
<h2 id='updateNumberOfCutpoints'>
Move 1
</h2><span id='topic+updateNumberOfCutpoints'></span>

<h3>Description</h3>

<p>Update the number of change-points according to Metropolis-Hastings move 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateNumberOfCutpoints(cutPoints, nTime, startPoint, LRange, birthProbs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateNumberOfCutpoints_+3A_cutpoints">cutPoints</code></td>
<td>

<p>Current configuration
</p>
</td></tr>
<tr><td><code id="updateNumberOfCutpoints_+3A_ntime">nTime</code></td>
<td>

<p>Number of time-points
</p>
</td></tr>
<tr><td><code id="updateNumberOfCutpoints_+3A_startpoint">startPoint</code></td>
<td>

<p>Optional integer
</p>
</td></tr>
<tr><td><code id="updateNumberOfCutpoints_+3A_lrange">LRange</code></td>
<td>

<p>Range of possible values
</p>
</td></tr>
<tr><td><code id="updateNumberOfCutpoints_+3A_birthprobs">birthProbs</code></td>
<td>

<p>Birth probabilities
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>newState</code></td>
<td>
<p>Candidate state</p>
</td></tr>
<tr><td><code>propRatio</code></td>
<td>
<p>Proposal ratio</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
