<!DOCTYPE html><html><head><title>Help for package ropercenter</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ropercenter}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#read_ascii'><p>Read ASCII datasets downloaded from the Roper Center</p></a></li>
<li><a href='#roper_download'><p>Download datasets from the Roper Center</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Reproducible Data Retrieval from the Roper Center Data Archive</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-29</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/fsolt/ropercenter">https://github.com/fsolt/ropercenter</a>,
<a href="https://fsolt.org/ropercenter/">https://fsolt.org/ropercenter/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fsolt/ropercenter/issues">https://github.com/fsolt/ropercenter/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Reproducible, programmatic retrieval of datasets from the
    Roper Center data archive.  The Roper Center for Public Opinion
    Research <a href="https://ropercenter.cornell.edu">https://ropercenter.cornell.edu</a> maintains the largest 
    archive of public opinion data in existence, but researchers using
    these datasets are caught in a bind.  The Center's terms and conditions
    bar redistribution of downloaded datasets, but to ensure that one's 
    work can be reproduced, assessed, and built upon by others, one must
    provide access to the raw data one employed.  The 'ropercenter'
    package cuts this knot by providing registered users with programmatic,
    reproducible access to Roper Center datasets from within R.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>RSelenium, dplyr, foreign, haven, magrittr, netstat, purrr,
readr, rio, stringr, tibble, tidyr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-02 16:38:26 UTC; fredsolt</td>
</tr>
<tr>
<td>Author:</td>
<td>Frederick Solt [aut, cre, cph],
  Jennifer Lin [ctb],
  Paul Gronke [ctb],
  Dave Peterson [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frederick Solt &lt;frederick-solt@uiowa.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-02 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='read_ascii'>Read ASCII datasets downloaded from the Roper Center</h2><span id='topic+read_ascii'></span>

<h3>Description</h3>

<p><code>read_ascii</code> helps format ASCII data files downloaded from the Roper Center.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ascii(
  file,
  total_cards = 1,
  var_names,
  var_cards = 1,
  var_positions,
  var_widths,
  card_pattern,
  respondent_pattern
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_ascii_+3A_file">file</code></td>
<td>
<p>A path to an ASCII data file.</p>
</td></tr>
<tr><td><code id="read_ascii_+3A_total_cards">total_cards</code></td>
<td>
<p>For multicard files, the number of cards in the file.</p>
</td></tr>
<tr><td><code id="read_ascii_+3A_var_names">var_names</code></td>
<td>
<p>A string vector of variable names.</p>
</td></tr>
<tr><td><code id="read_ascii_+3A_var_cards">var_cards</code></td>
<td>
<p>For multicard files, a numeric vector of the cards on which <code>var_names</code> are recorded.</p>
</td></tr>
<tr><td><code id="read_ascii_+3A_var_positions">var_positions</code></td>
<td>
<p>A numeric vector of the column positions in which <code>var_names</code> are recorded.</p>
</td></tr>
<tr><td><code id="read_ascii_+3A_var_widths">var_widths</code></td>
<td>
<p>A numeric vector of the widths used to record <code>var_names</code>.</p>
</td></tr>
<tr><td><code id="read_ascii_+3A_card_pattern">card_pattern</code></td>
<td>
<p>For use when the file does not contain a line for every card for every respondent (or contains extra lines that correspond to no respondent), a regular expression that matches the file's card identifier; e.g., if the card number is stored in the last digit of each line, &quot;\d$&quot;.</p>
</td></tr>
<tr><td><code id="read_ascii_+3A_respondent_pattern">respondent_pattern</code></td>
<td>
<p>For use when the file does not contain a line for every card for every respondent (or contains extra lines that correspond to no respondent), a regular expression that matches the file's respondent identifier; e.g., if the respondent number is stored in the first four digits of each line, preceded by a space, &quot;(?&lt;=^\s)\d4&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many older Roper Center datasets are available only in ASCII format, which is notoriously difficult to work with.  The 'read_ascii' function facilitates the process of extracting selected variables from ASCII datasets. For single-card files, one can simply identify the names, positions, and widths of the needed variables from the codebook and pass them to <code>read_ascii</code>'s <code>var_names</code>, <code>var_positions</code>, and <code>var_widths</code> arguments.  Multicard datasets are more complicated. In the best case, the file contains one line per card per respondent; then, the user can extract the needed variables by adding only the <code>var_cards</code> and <code>total_cards</code> arguments. When this condition is violated&mdash;there is not a line for every card for every respondent, or there are extra lines&mdash;the function will throw an error and request the user specify the additional arguments <code>card_pattern</code> and <code>respondent_pattern</code>.
</p>


<h3>Value</h3>

<p>A data frame containing any variables specified in the <code>var_names</code> argument, plus a numeric <code>respondent</code> identifier and as many string <code>card</code> variables (<code>card1</code>, <code>card2</code>, ...) as specified by the <code>total_cards</code> argument.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# a single-card file
roper_download("USAIPO1982-1197G", # Gallup Poll for June 25-28, 1982
               download_dir = tempdir())  # remember to specify a directory for your download
                      
gallup1982 &lt;- read_ascii(file = file.path(tempdir(), "USAIPO1982-1197G",
                                          "1197.dat"),
                         var_names = c("q09j", "weight"),
                         var_positions = c(38, 1),
                         var_widths = c(1, 1))
   
# a multi-card file, with extra lines that make the card_pattern and
  respondent_pattern arguments necessary
roper_download("USAIPOCNUS1996-9603008", # Gallup/CNN/USA Today Poll: Politics/1996 Election
               download_dir = tempdir())  # remember to specify a directory for your download

gallup1996 &lt;- read_ascii(file = file.path(tempdir(), "USAIPOCNUS1996-9603008",
                                          "a9603008.dat"),
                         var_names = c("q43a", "q44", "weight"),
                         var_cards = c(6, 6, 1),
                         var_positions = c(62, 64, 13),
                         var_widths = c(1, 1, 3),
                         total_cards = 7,
                         card_pattern = "(?&lt;=^.{10})\\d", 
                                        # (a digit, preceded by the start of the line
                                        # and ten other characters)
                         respondent_pattern = "(?&lt;=^\\s{2})\\d{4}")
                                       # (# four digits, preceded by the start of the line
                                       # and two whitespace characters)

## End(Not run)

</code></pre>

<hr>
<h2 id='roper_download'>Download datasets from the Roper Center</h2><span id='topic+roper_download'></span>

<h3>Description</h3>

<p><code>roper_download</code> provides a programmatic and reproducible means to download  
datasets from the Roper Center's data archive
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roper_download(
  file_id,
  affiliation = getOption("roper_affiliation"),
  email = getOption("roper_email"),
  password = getOption("roper_password"),
  reset = FALSE,
  download_dir = "roper_data",
  msg = TRUE,
  convert = TRUE,
  delay = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roper_download_+3A_file_id">file_id</code></td>
<td>
<p>The unique identifier (or optionally a vector of these identifiers)
for the dataset(s) to be downloaded (see details).  Both new Archive Numbers and old
Historical Archive Numbers, if the latter are available, may be used.</p>
</td></tr>
<tr><td><code id="roper_download_+3A_affiliation">affiliation</code>, <code id="roper_download_+3A_email">email</code>, <code id="roper_download_+3A_password">password</code></td>
<td>
<p>Your Roper Center affiliation, email, and password 
(see details)</p>
</td></tr>
<tr><td><code id="roper_download_+3A_reset">reset</code></td>
<td>
<p>If TRUE, you will be asked to re-enter your Roper Center affiliation, 
email, and password.</p>
</td></tr>
<tr><td><code id="roper_download_+3A_download_dir">download_dir</code></td>
<td>
<p>The directory (relative to your working directory) to
which files from the Roper Center will be downloaded.</p>
</td></tr>
<tr><td><code id="roper_download_+3A_msg">msg</code></td>
<td>
<p>If TRUE, outputs a message showing which data set is being downloaded.</p>
</td></tr>
<tr><td><code id="roper_download_+3A_convert">convert</code></td>
<td>
<p>If TRUE, converts downloaded file(s) to .RData format.</p>
</td></tr>
<tr><td><code id="roper_download_+3A_delay">delay</code></td>
<td>
<p>If the speed of your connection to the Roper Center data archive is particularly slow, 
<code>roper_download</code> may encounter problems.  Increasing the <code>delay</code> parameter
may help.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To avoid requiring others to edit your scripts to insert their own affiliation, 
email, and password or to force them to do so interactively, the default is set 
to fetch this information from the user's .Rprofile.  Before running 
<code>roper_download</code>, then, you should be sure to add these options to your 
.Rprofile (<code>usethis::edit_r_profile()</code> is one particularly easy way),
substituting your own info for the example below:
</p>
<p><code>
  options("roper_affiliation" = "Upper Midwest University",
          "roper_email" = "juanita-herrara@uppermidwest.edu",
          "roper_password" = "password123!")
 </code>
</p>


<h3>Value</h3>

<p>The function returns nothing, but has the side effect of downloading
all files of the datasets identified in the file_id argument.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 roper_download(file_id = c("31117412", "USPEW2015-GOVERNANCE"),
                download_dir = tempdir()) # remember to specify a directory for your download

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
