<!DOCTYPE html><html lang="en"><head><title>Help for package SensitivityCaseControl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SensitivityCaseControl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SensitivityCaseControl-package'>
<p>Sensitivity Analysis for Case-Control Studies</p></a></li>
<li><a href='#adaptive.case.test'><p>Adaptive sensitivity analysis for case-control studies</p></a></li>
<li><a href='#adaptive.noether.brown'><p>Adaptive test for observational studies that adapts between Noether's and Brown's test statistics</p></a></li>
<li><a href='#adaptive.test.critical.value.func'>
<p>Critical values for adaptive test</p></a></li>
<li><a href='#gconv'>
<p>Distribution of the convolution of two discrete random variables that taken on nonnegative integer values.</p></a></li>
<li><a href='#jointcrit'>
<p>Joint critical values for adaptive test</p></a></li>
<li><a href='#mhxct.weighted'>
<p>Distribution of Mantel-Haenszel test statistic.</p></a></li>
<li><a href='#sens.analysis.aberrant.rank'>
<p>Sensitivity analysis for aberrant rank test.</p></a></li>
<li><a href='#sens.analysis.mh'>
<p>Sensitivity Analysis for Mantel-Haenszel test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sensitivity Analysis for Case-Control Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Dylan Small</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dylan Small &lt;dsmall@wharton.upenn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Sensitivity analysis for case-control studies in which some cases may meet a more narrow definition of being a case compared to other cases which only meet a broad definition.  The sensitivity analyses are described in Small, Cheng, Halloran and Rosenbaum (2013, "Case Definition and Sensitivity Analysis", Journal of the American Statistical Association, 1457-1468).  The functions sens.analysis.mh and sens.analysis.aberrant.rank provide sensitivity analyses based on the Mantel-Haenszel test statistic and aberrant rank test statistic as described in Rosenbaum (1991, "Sensitivity Analysis for Matched Case Control Studies", Biometrics); see also Section 1 of Small et al.  The function adaptive.case.test provides adaptive inferences as described in Section 5 of Small et al.  The function adaptive.noether.brown provides a sensitivity analysis for a matched cohort study based on an adaptive test.  The other functions in the package are internal functions.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-02 21:41:21 UTC; dsmall</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-03 19:00:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='SensitivityCaseControl-package'>
Sensitivity Analysis for Case-Control Studies
</h2><span id='topic+SensitivityCaseControl-package'></span><span id='topic+SensitivityCaseControl'></span>

<h3>Description</h3>

<p>This package performs sensitivity analysis for matched case-control studies in which some cases meet a narrow definition of being a case compared to other cases which only meet a broad definition.  The package also implements an adaptive sensitivity analysis for matched pair cohort studies.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> CaseSensitivity</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2012-10-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> R 2.11.1</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The functions sens.analysis.mh and sens.analysis.aberrant.rank provide sensitivity analyses based on the Mantel-Haenszel test statistic and aberrant rank test statistic.  The function adaptive.case.test provides adaptive inferences that reject if either the Mantel-Haenszel statistic for the narrow cases is greater than a critical value or the Mantel-Haenszel statistic for all cases is greater than a critical value.  The sensitivity analyses are described in Small, Cheng, Halloran and Rosenbaum (2012, &quot;Case Definition and Sensitivity Analysis&quot;, working paper).  The function adaptive.noether.brown provides a sensitivity analysis for a matched cohort study based on an adaptive test.  The other functions in the package are internal functions.  
</p>


<h3>Author(s)</h3>

<p>Dylan Small &lt;dsmall@wharton.upenn.edu&gt;
</p>


<h3>References</h3>

<p>Small, D.S., Cheng, J., Halloran, M.E. and Rosenbaum, P.R. (2013).  &quot;Case Definition and Design Sensitivity.&quot;  Journal of the American Statistical Association, 108, 1457-1468.
</p>
<p>Rosenbaum, P.R. (2012).  &quot;An Exact Adaptive Test with Superior Design Sensitivity in an Observational Study of Treatments for Ovarian Cancer.&quot;  Annals of Applied Statistics, 6, 83-105.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Adaptive test for a case-control study based on Table 4 in Small, Cheng, 
# Halloran and Rosenbaum (2013)
no.exposed.in.matched.set=c(rep(0,229),rep(1,23),rep(1,51),rep(2,9),rep(0,373),rep(1,46),rep(1,50),
rep(2,13));
narrowcase=c(rep(1,312),rep(0,482));
case.exposed=c(rep(0,229),rep(0,23),rep(1,51),rep(1,9),rep(0,373),rep(0,46),rep(1,50),rep(1,13));
size.matched.set=rep(2,length(case.exposed))
# Test using the statistics T1 and T1+T2 where T1 is Mantel-Haenszel for narrow cases and T2 is 
# Mantel Haenszel for marginal cases
adaptive.case.test(no.exposed.in.matched.set,narrowcase,case.exposed,size.matched.set,Gamma=1.37,
alpha=.05,narrowmultiplier=1)
# Test using the statistics T1 and 2*T1+T2
adaptive.case.test(no.exposed.in.matched.set,narrowcase,case.exposed,size.matched.set,Gamma=1.37,
alpha=.05,narrowmultiplier=2)

# Sensitivity analysis using only the narrow cases and the Mantel-Haenszel statistic
# Data from narrow cases in Table 1 of Small, Cheng and Halloran, Rosenbaum
cases.exposed=c(rep(0,174+60+14+4+0),rep(1,34+19+6+1+0));
referents.exposed=c(rep(0,174),rep(1,60),rep(2,14),rep(3,4),rep(0,34),rep(1,19),rep(2,6),rep(3,1));
no.referents=rep(4,312);
# Sensitivity analysis for Mantel-Haenszel statistic at Gamma=1.2
sens.analysis.mh(cases.exposed,referents.exposed,no.referents,Gamma=1.2);

# Adaptive test using Noether's and Brown's statstics for a matched cohort study
# Data on volume of hippocampus in 15 sets of twins in which one twin is affected by schizophrenia 
# and one twin is not (data from R.L. Suddath et al., "Anatomical Abnormalities in the Brains of 
# Monozygotic Twins Discordant for Schizophrenia," New England Journal of Medicine 322, 1990
# pp. 789-93.  Data taken from the Statistical Sleuth, F.L. Ramsey and D.W. Schafer
unaffected=c(1.94,1.44,1.56,1.58,2.06,1.66,1.75,1.77,1.78,1.92,1.25,1.93,2.04,1.62,2.08)
affected=c(1.27,16.3,1.47,1.39,1.93,1.26,1.71,1.67,1.28,1.85,1.02,1.34,2.02,1.59,1.97)
difference=unaffected-affected
adaptive.noether.brown(difference,Gamma=1.1)
# The null hypothesis of no treatment is rejected for Gamma=1.13 but not for Gamma=1.14
</code></pre>

<hr>
<h2 id='adaptive.case.test'>Adaptive sensitivity analysis for case-control studies</h2><span id='topic+adaptive.case.test'></span>

<h3>Description</h3>

<p>This function carries out sensitivity analysis for matched case-control studies using two Mantel-Haenszel tests with different case definitions.  The case in each matched set either meets a narrow case definition or only meets a more broadly defined case definition.  The function can accommodate designs in which cases are matched to variable numbers of controls (referents).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptive.case.test(no.exposed.in.matched.set, narrowcase, case.exposed, size.matched.set, 
Gamma, narrowmultiplier = 1, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adaptive.case.test_+3A_no.exposed.in.matched.set">no.exposed.in.matched.set</code></td>
<td>

<p>Vector which gives the number of subjects exposed in each matched set.
</p>
</td></tr>
<tr><td><code id="adaptive.case.test_+3A_narrowcase">narrowcase</code></td>
<td>

<p>Vector which contains 1 or 0 according to whether the case in the matched set meets the narrow case definition (1 if meets the narrow case definition).
</p>
</td></tr>
<tr><td><code id="adaptive.case.test_+3A_case.exposed">case.exposed</code></td>
<td>

<p>Vector which is 1 or 0 according to whether the case in the matched set was exposed to the treatment (1 if exposed to treatment)
</p>
</td></tr>
<tr><td><code id="adaptive.case.test_+3A_size.matched.set">size.matched.set</code></td>
<td>

<p>Vector which contains the number of subjects in each matched set.
</p>
</td></tr>
<tr><td><code id="adaptive.case.test_+3A_gamma">Gamma</code></td>
<td>

<p>The value of the sensitivity analysis parameter Gamma for which the test will be conducted.
</p>
</td></tr>
<tr><td><code id="adaptive.case.test_+3A_narrowmultiplier">narrowmultiplier</code></td>
<td>

<p>The amount by which the narrow cases are multiplied in the second test statistic (see Details).  The default is 1.
</p>
</td></tr>
<tr><td><code id="adaptive.case.test_+3A_alpha">alpha</code></td>
<td>

<p>The significance level at which the test is conducted (default = .05).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test being conducted is of the null hypothesis of no treatment effect vs. a one-sided alternative that exposure to the treatment increases the outcome.  The result of the test is whether or not the null hypothesis can be rejected for all distributions of treatment assignments that are consistent with the sensitivity parameter Gamma.  The sensitivity parameter Gamma is the maximum amount by which two subjects matched for observed covariates may differ in their odds of exposure to the treatment.  The test is rejected if either the Mantel-Haenszel statistic among the narrow cases is greater than a critical value or narrowmultiplier*Mantel Haenszel statistic among the narrow cases + Mantel-Haenszel statistic among the broad ases is greater than another critical value, where the critical values are determined so that the probability of a Type I error is at most alpha.  See Small, Cheng, Halloran and Rosenbaum (2013) for further details.  
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>alpha</code></td>
<td>
<p>Significance level at which the test is conducted.</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>The value of the sensitivity parameter Gamma at which the test of the null hypothesis of no treatment effect is conducted.</p>
</td></tr>
<tr><td><code>testinfomat</code></td>
<td>
<p>Matrix with information about the test.  The first column lists the definition of the two test statistics (one using only the narrow cases and the other using the narrow and marginal cases) that are being used in the adaptive test.  T1 is the Mantel-Haenszel statistic among the narrow cases and T2 is the Mantel-Haenszel test statistic among the broad (narrow + marginal) cases.  The second column lists the critical value for each test statistic.  The third column lists the observed values of these two test statsitics.  The null hypothesis is rejected if the observed value of either test statistic is greater than its critical value.</p>
</td></tr>  
<tr><td><code>overall.test.result</code></td>
<td>
<p>&quot;Accept H0&quot; or &quot;Reject H0&quot; according to whether the null hypothesis of no treatment effect can be rejected for sensitivity parameter Gamma.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Small, D.S., Cheng, J., Halloran, M.E. and Rosenbaum, P.R. (2013).  &quot;Case Definition and Design Sensitivity.&quot;  Journal of the American Statistical Association, 108, 1457-1468.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Adaptive test based on Table 4 in Small, Cheng, Halloran and Rosenbaum (2013)
no.exposed.in.matched.set=c(rep(0,229),rep(1,23),rep(1,51),rep(2,9),rep(0,373),rep(1,46),rep(1,50),
rep(2,13));
narrowcase=c(rep(1,312),rep(0,482));
case.exposed=c(rep(0,229),rep(0,23),rep(1,51),rep(1,9),rep(0,373),rep(0,46),rep(1,50),rep(1,13));
size.matched.set=rep(2,length(case.exposed))
# Test using the statistics T1 and T1+T2 where T1 is Mantel-Haenszel for narrow cases and T2 is 
# Mantel Haenszel for marginal cases
adaptive.case.test(no.exposed.in.matched.set,narrowcase,case.exposed,size.matched.set,Gamma=1.37,
alpha=.05,narrowmultiplier=1)
# Test using the statistics T1 and 2*T1+T2
adaptive.case.test(no.exposed.in.matched.set,narrowcase,case.exposed,size.matched.set,Gamma=1.37,
alpha=.05,narrowmultiplier=2)

# An example of an adaptive test in which narrow cases are matched to two controls and marginal 
# cases to one control
#      Narrow Cases                    Marginal Cases
# Referents Exposed  0   1   2         0     1   
# Case
# Not Exposed        40  10   6        50    20  
# Exposed            30  14   8        40    30
no.exposed.in.matched.set=c(rep(0,40),rep(1,10),rep(2,6),rep(1,30),rep(2,14),rep(3,8),rep(0,50),
rep(1,20),rep(1,40),rep(2,30))
narrowcase=c(rep(1,40+10+6+30+14+8),rep(0,50+20+40+30))
case.exposed=c(rep(0,40+10+6),rep(1,30+14+8),rep(0,50+20),rep(1,40+30))
size.matched.set=c(rep(3,40+10+6+30+14+8),rep(2,50+20+40+30))
adaptive.case.test(no.exposed.in.matched.set,narrowcase,case.exposed,size.matched.set,Gamma=1.2,
alpha=.05)




</code></pre>

<hr>
<h2 id='adaptive.noether.brown'>Adaptive test for observational studies that adapts between Noether's and Brown's test statistics
</h2><span id='topic+adaptive.noether.brown'></span>

<h3>Description</h3>

<p>Sensitivity analysis for a matched pair cohort study that rejects the null hypothesis of no treatment effect if either Brown's statistic or Noether's statistic is greater than respective critical values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptive.noether.brown(y,Gamma,alpha=.05,lambda1=1/3,lambda2=2/3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adaptive.noether.brown_+3A_y">y</code></td>
<td>

<p>Vector which gives matched pair differences between treated and control unit response in each matched pair
</p>
</td></tr>
<tr><td><code id="adaptive.noether.brown_+3A_gamma">Gamma</code></td>
<td>

<p>The value of the sensitivity analysis parameter Gamma for which the test will be conducted.
</p>
</td></tr>
<tr><td><code id="adaptive.noether.brown_+3A_alpha">alpha</code></td>
<td>

<p>The significance level at which the test is conducted (default = .05)
</p>
</td></tr>
<tr><td><code id="adaptive.noether.brown_+3A_lambda1">lambda1</code></td>
<td>
<p>The lambda1 parameter for defining Brown's and Noether's test statistics.  See details.
</p>
</td></tr>
<tr><td><code id="adaptive.noether.brown_+3A_lambda2">lambda2</code></td>
<td>
<p>The lambda2 parameter for defining Brown's and Noether's test statistics.  See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let 0&lt;=lambda1&lt;=lambda2&lt;=1.  Let B1 be the number of pairs for whom the treated unit in the pair has a greater outcome than the control unit and rank among the I pairs of the absolute value of the difference between the treated and control unit's outcomes is greater than or equal to (1 - lambda1)I, where I is the number of pairs, 
Also, let B2 be the number of pairs for whom the treated unit in the pair has a greater outcome than the control unit and the rank of the absolute value of the difference between the treated and control unit's outcomes is is less than or equal to (1-lambda1)I but greater than or equal to (1 - lambda2)I.  Noether (1973) proposed B1 as a test statistic, and Brown (1981) (and also Markowski and Hettmansperger (1982)) proposed T = 2B1 + B2 as a
test statistic.  The adaptive test combines these two test statistics.  See Rosenbaum (2012) for the details.   
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>alpha</code></td>
<td>
<p>Significance level at which the test is conducted.</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>The value of the sensitivity parameter Gamma at which the test of the null hypothesis of no treatment effect is conducted.</p>
</td></tr>
<tr><td><code>testinfomat</code></td>
<td>
<p>Matrix with information about the test.  The first column lists the critical values for Noether's and Brown's test statistics.  The second column lists the observed values of these two test statsitics.  The null hypothesis is rejected if the observed value of either test statistic is greater than its critical value.</p>
</td></tr>  
<tr><td><code>overall.test.result</code></td>
<td>
<p>&quot;Accept H0&quot; or &quot;Reject H0&quot; according to whether the null hypothesis of no treatment effect can be rejected for sensitivity parameter Gamma.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Rosenbaum, P.R. (2012).  &quot;An Exact Adaptive Test with Superior Design Sensitivity in an Observational Study of Treatments for Ovarian Cancer.&quot;  Annals of Applied Statistics, 6, 83-105.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data on volume of hippocampus in 15 sets of twins in which one twin is affected by schizophrenia
# and one twin is not (data from R.L. Suddath et al., "Anatomical Abnormalities in the Brains of 
# Monozygotic Twins Discordant for Schizophrenia," New England Journal of Medicine 322, 1990
# pp. 789-93.  Data taken from the Statistical Sleuth, F.L. Ramsey and D.W. Schafer
unaffected=c(1.94,1.44,1.56,1.58,2.06,1.66,1.75,1.77,1.78,1.92,1.25,1.93,2.04,1.62,2.08)
affected=c(1.27,16.3,1.47,1.39,1.93,1.26,1.71,1.67,1.28,1.85,1.02,1.34,2.02,1.59,1.97)
difference=unaffected-affected
adaptive.noether.brown(difference,Gamma=1.1)
# The null hypothesis of no treatment is rejected for Gamma=1.13 but not for Gamma=1.14
</code></pre>

<hr>
<h2 id='adaptive.test.critical.value.func'>
Critical values for adaptive test
</h2><span id='topic+adaptive.test.critical.value.func'></span>

<h3>Description</h3>

<p>This is an internal function which takes in a matrix that contains the error probabilities for different values of the test statistics T1.doublebar and T.doublebar  and finds the pair of critical values (k1,k) for T1.doublebar and T.doublebar which satisfy the following: (i) have a Type I error rate of at most alpha; (ii) among pairs of critical values that cannot be improved, the critical values are most equitable, dividing the chance of false rejection as equally as possible between the events T1.doublebar&gt;=k1 and T.doublebar&gt;=k.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptive.test.critical.value.func(critmat, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adaptive.test.critical.value.func_+3A_critmat">critmat</code></td>
<td>

<p>Matrix that contains the error probabilities for different values of the test statistics T1.doublebar and T.doublebar that is produced by the function jointcrit
</p>
</td></tr>
<tr><td><code id="adaptive.test.critical.value.func_+3A_alpha">alpha</code></td>
<td>

<p>Significance level at which the test is conducted (alpha = 0.05).  
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>t1</code></td>
<td>
<p>Critical value k1 for the test statistic T1.doublebar</p>
</td></tr>
<tr><td><code>t1plust2</code></td>
<td>
<p>Critical value k for the test statistic T.doublebar</p>
</td></tr>
</table>


<h3>References</h3>

<p>Small, D.S., Cheng, J., Halloran, M.E. and Rosenbaum, P.R. (2013).  &quot;Case Definition and Design Sensitivity.&quot;  Journal of the American Statistical Association, 108, 1457-1468.  See Section 5.1 of the paper.
</p>

<hr>
<h2 id='gconv'>
Distribution of the convolution of two discrete random variables that taken on nonnegative integer values.
</h2><span id='topic+gconv'></span>

<h3>Description</h3>

<p>Function finds the distribution for the convolution of two discrete random variables taking on nonnegative integer values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gconv(g1, g2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gconv_+3A_g1">g1</code></td>
<td>

<p>The probability that the first random variable takes on the values 0, 1, 2,...,maximum value.
</p>
</td></tr>
<tr><td><code id="gconv_+3A_g2">g2</code></td>
<td>

<p>The probability that the second random variable takes on the values 0, 1, 2,..., maximum value.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The probability that the convolution of the two random variables takes on the values 0, 1, 2,...,maximum value.  
</p>


<h3>References</h3>

<p>Section 2.3 of Small, D.S., Cheng, J., Halloran, M.E. and Rosenbaum, P.R. (2013).  &quot;Case Definition and Design Sensitivity.&quot;  Journal of the American Statistical Association, 108, 1457-1468.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For Gamma=3, I=3 discordant pairs and the Mantel-Haenszel statistic with d_i=1 for all i
gconv(gconv(c(1/4,3/4),c(1/4,3/4)),c(1/4,3/4))
## returns Pr(Tbar=k|m,F) for k=0,1,2,3)
</code></pre>

<hr>
<h2 id='jointcrit'>
Joint critical values for adaptive test
</h2><span id='topic+jointcrit'></span>

<h3>Description</h3>

<p>Internal function.  Given the probability distribution of independent test statistics T1 and T2, the function finds the joint distribution of T1, T1+T2.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointcrit(p1, p2, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jointcrit_+3A_p1">p1</code></td>
<td>

<p>The probability distribution of the test statistic T1 taking on values 0, 1, 2,..., maximum value
</p>
</td></tr>
<tr><td><code id="jointcrit_+3A_p2">p2</code></td>
<td>

<p>The probability disribution of the test statistic T2 taking on values 0, 1, 2, ..., maximum value
</p>
</td></tr>
<tr><td><code id="jointcrit_+3A_alpha">alpha</code></td>
<td>

<p>The significance level at which the test is conducted.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix which contains for each possible value of t1 and t2, information about the probability of T1&gt;=t1, T1+T2&gt;=t1+t2.
</p>

<hr>
<h2 id='mhxct.weighted'>
Distribution of Mantel-Haenszel test statistic.
</h2><span id='topic+mhxct.weighted'></span>

<h3>Description</h3>

<p>Internal function that computes the distribution of m*Mantel-Haenszel statistic for sensitivity parameter Gamma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mhxct.weighted(mi, Ji, gamma = 1, m = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mhxct.weighted_+3A_mi">mi</code></td>
<td>

<p>Number of exposed subjects in each matched set.
</p>
</td></tr>
<tr><td><code id="mhxct.weighted_+3A_ji">Ji</code></td>
<td>

<p>Number of subjects in each matched set.
</p>
</td></tr>
<tr><td><code id="mhxct.weighted_+3A_gamma">gamma</code></td>
<td>

<p>Sensitivity parameter.
</p>
</td></tr>
<tr><td><code id="mhxct.weighted_+3A_m">m</code></td>
<td>

<p>Factor by which Mantel-Haenszel statistic should be multiplied (default is 1).  
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Upper bound on the probability that m*Mantel-Haenszel statistic equals 0, 1,,...maximum value when the null hypothesis of no treatment effect is true and the sensitivity parameter is Gamma.  
</p>

<hr>
<h2 id='sens.analysis.aberrant.rank'>
Sensitivity analysis for aberrant rank test.
</h2><span id='topic+sens.analysis.aberrant.rank'></span>

<h3>Description</h3>

<p>This function carries out sensitivity analysis for the aberrant rank test for matched case-control studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sens.analysis.aberrant.rank(cases.exposed,referents.exposed,case.rank,no.referents,Gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sens.analysis.aberrant.rank_+3A_cases.exposed">cases.exposed</code></td>
<td>

<p>Vector which contains the number of cases exposed in each matched set.
</p>
</td></tr>
<tr><td><code id="sens.analysis.aberrant.rank_+3A_referents.exposed">referents.exposed</code></td>
<td>

<p>Vector which contains the number of referents (controls) exposed in each matched set.
</p>
</td></tr>
<tr><td><code id="sens.analysis.aberrant.rank_+3A_case.rank">case.rank</code></td>
<td>

<p>Vector which contains the rank of the cases' extremeness of disease, where 1 corresponds to the least extreme disease and I=number of matched sets corresponds to the most extreme disease.
</p>
</td></tr>
<tr><td><code id="sens.analysis.aberrant.rank_+3A_no.referents">no.referents</code></td>
<td>

<p>Vector which contains the number of referents (controls) in each matched set.
</p>
</td></tr>
<tr><td><code id="sens.analysis.aberrant.rank_+3A_gamma">Gamma</code></td>
<td>

<p>The sensitivity parameter Gamma at which the test is conducted.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test being conducted is of the null hypothesis of no treatment effect vs. a one-sided alternative that exposure to the treatment increases the outcome.  The function outputs the lower and upper bounds on the p-values for testing the null hypothesis for all distributions of treatment assignments that are consistent with the  sensitivity parameter Gamma.  The test is rejected if the upper bound on the p-value is less than alpha.   The sensitivity parameter Gamma is the maximum amount by which two subjects matched for observed covariates may differ in their odds of exposure to the treatment.  The test statistic is the sum of the aberrant ranks of the cases in the matched sets where the case is exposed to treatment, where the aberrant ranks are the ranks of the cases in extremeness of disease (1 corresponds to the least extreme disease and I = number of matched sets corresponds to the most extreme disease).  See Small, Cheng, Halloran and Rosenbaum (2012) for further details.  
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>lower.bound.pval</code></td>
<td>
<p>Lower bound on the p-value for all distributions of treatment assignment consistent with the sensitivity parameter Gamma.</p>
</td></tr>
<tr><td><code>upper.bound.pval</code></td>
<td>
<p>Upper bound on the p-value for all distributions of treatment assignment consistent with the sensitivity parameter Gamma.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Small, D.S., Cheng, J., Halloran, M.E. and Rosenbaum, P.R. (2013).  &quot;Case Definition and Design Sensitivity.&quot;  Journal of the American Statistical Association, 108, 1457-1468.
</p>

<hr>
<h2 id='sens.analysis.mh'>
Sensitivity Analysis for Mantel-Haenszel test
</h2><span id='topic+sens.analysis.mh'></span>

<h3>Description</h3>

<p>Sensitivity analysis for the Mantel-Haenszel test of no treatment effect for matched case-control studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sens.analysis.mh(cases.exposed, referents.exposed, no.referents, Gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sens.analysis.mh_+3A_cases.exposed">cases.exposed</code></td>
<td>

<p>Number of cases exposed to treatment in each matched set.
</p>
</td></tr>
<tr><td><code id="sens.analysis.mh_+3A_referents.exposed">referents.exposed</code></td>
<td>

<p>Number of referents (controls) exposed to treatment in each matched set.
</p>
</td></tr>
<tr><td><code id="sens.analysis.mh_+3A_no.referents">no.referents</code></td>
<td>

<p>Number of referents (controls) in each matched set.  
</p>
</td></tr>
<tr><td><code id="sens.analysis.mh_+3A_gamma">Gamma</code></td>
<td>

<p>The sensitivity parameter Gamma at which the test is conducted.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test being conducted is of the null hypothesis of no treatment effect vs. a one-sided alternative that exposure to the treatment increases the outcome.  The function outputs the lower and upper bounds on the p-values for testing the null hypothesis for all distributions of treatment assignments that are consistent with the sensitivity parameter Gamma.  The test is rejected if the upper bound on the p-value is less than alpha.   The sensitivity parameter Gamma is the maximum amount by which two subjects matched for observed covariates may differ in their odds of exposure to the treatment.  The test statistic is the Mantel-Haenszel test statistic, which is the sum of cases exposed to treatment.  
See Small, Cheng, Halloran and Rosenbaum (2012) for further details.  
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>lower.bound.pval</code></td>
<td>
<p>Lower bound on the p-value for all distributions of treatment assignment consistent with the sensitivity parameter Gamma.</p>
</td></tr>
<tr><td><code>upper.bound.pval</code></td>
<td>
<p>Upper bound on the p-value for all distributions of treatment assignment consistent with the sensitivity parameter Gamma.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Small, D.S., Cheng, J., Halloran, M.E. and Rosenbaum, P.R. (2013).  &quot;Case Definition and Design Sensitivity.&quot;  Journal of the American Statistical Association, 108, 1457-1468.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data from narrow cases in Table 1 of Small, Cheng and Halloran, Rosenbaum
cases.exposed=c(rep(0,174+60+14+4+0),rep(1,34+19+6+1+0));
referents.exposed=c(rep(0,174),rep(1,60),rep(2,14),rep(3,4),rep(0,34),rep(1,19),rep(2,6),rep(3,1));
no.referents=rep(4,312);
# Sensitivity analysis for Mantel-Haenszel statistic at Gamma=1.2
sens.analysis.mh(cases.exposed,referents.exposed,no.referents,Gamma=1.2);
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
