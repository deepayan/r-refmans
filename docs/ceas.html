<!DOCTYPE html><html lang="en"><head><title>Help for package ceas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ceas}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ceas-package'><p>ceas: Cellular Energetics Analysis Software</p></a></li>
<li><a href='#atp_plot'><p>ATP Plot</p></a></li>
<li><a href='#bioscope_plot'><p>Bioenergetic Scope Plot</p></a></li>
<li><a href='#energetics_lme_summary'><p>Get mean and confidence intervals from energetics mixed-effects models</p></a></li>
<li><a href='#energetics_ols_summary'><p>Get ordinary least squares mean and confidence intervals from energetics</p></a></li>
<li><a href='#fit_lme'><p>Estimate mean and confidence intervals using a mixed-effects model</p></a></li>
<li><a href='#get_energetics'><p>Calculate ATP Production from OXPHOS and Glycolysis</p></a></li>
<li><a href='#get_energetics_summary'><p>Calculate ATP Production Mean and Standard Deviation</p></a></li>
<li><a href='#get_rate_summary'><p>Rates summary</p></a></li>
<li><a href='#make_bioscope_plot'><p>Bioenergetic Scope Plot Shortcut</p></a></li>
<li><a href='#normalize'><p>Normalize Seahorse data</p></a></li>
<li><a href='#partition_data'><p>Organize Seahorse Data</p></a></li>
<li><a href='#rate_plot'><p>Rate plot</p></a></li>
<li><a href='#rates_lme_summary'><p>Estimate mean and confidence intervals for ATP measures using a mixed-effects model</p></a></li>
<li><a href='#read_data'><p>Read Seahorse Wave Excel File</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Cellular Energetics Analysis Software</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Measuring cellular energetics is essential to understanding a
    matrix’s (e.g. cell, tissue or biofluid) metabolic state. The Agilent
    Seahorse machine is a common method to measure real-time cellular
    energetics, but existing analysis tools are highly manual or lack
    functionality. The Cellular Energetics Analysis Software (ceas) R package
    fills this analytical gap by providing modular and automated Seahorse data
    analysis and visualization using the methods described by Mookerjee et al.
    (2017) &lt;<a href="https://doi.org/10.1074%2Fjbc.m116.774471">doi:10.1074/jbc.m116.774471</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://jamespeapen.github.io/ceas/">https://jamespeapen.github.io/ceas/</a>,
<a href="https://github.com/jamespeapen/ceas/">https://github.com/jamespeapen/ceas/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jamespeapen/ceas/issues/">https://github.com/jamespeapen/ceas/issues/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, ggplot2, lme4, readxl, stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-20 21:04:58 UTC; james.eapen</td>
</tr>
<tr>
<td>Author:</td>
<td>Rachel House <a href="https://orcid.org/0000-0003-2176-0431"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  James P. Eapen <a href="https://orcid.org/0000-0001-6016-3598"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Hui Shen <a href="https://orcid.org/0000-0001-9767-4084"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [fnd],
  Carrie R. Graveel <a href="https://orcid.org/0000-0001-7251-5642"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [fnd],
  Matthew R. Steensma
    <a href="https://orcid.org/0000-0002-9003-6730"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [fnd],
  Van Andel Institute [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rachel House &lt;rachel.house@vai.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-21 00:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ceas-package'>ceas: Cellular Energetics Analysis Software</h2><span id='topic+ceas'></span><span id='topic+ceas-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Measuring cellular energetics is essential to understanding a matrix’s (e.g. cell, tissue or biofluid) metabolic state. The Agilent Seahorse machine is a common method to measure real-time cellular energetics, but existing analysis tools are highly manual or lack functionality. The Cellular Energetics Analysis Software (ceas) R package fills this analytical gap by providing modular and automated Seahorse data analysis and visualization using the methods described by Mookerjee et al. (2017) <a href="https://doi.org/10.1074/jbc.m116.774471">doi:10.1074/jbc.m116.774471</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Rachel House <a href="mailto:rachel.house@vai.org">rachel.house@vai.org</a> (<a href="https://orcid.org/0000-0003-2176-0431">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> James P. Eapen <a href="mailto:james.eapen@vai.org">james.eapen@vai.org</a> (<a href="https://orcid.org/0000-0001-6016-3598">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Hui Shen <a href="mailto:hui.shen@vai.org">hui.shen@vai.org</a> (<a href="https://orcid.org/0000-0001-9767-4084">ORCID</a>) [funder]
</p>
</li>
<li><p> Carrie R. Graveel <a href="mailto:carrie.graveel@vai.org">carrie.graveel@vai.org</a> (<a href="https://orcid.org/0000-0001-7251-5642">ORCID</a>) [funder]
</p>
</li>
<li><p> Matthew R. Steensma <a href="mailto:matthew.steensma@vai.org">matthew.steensma@vai.org</a> (<a href="https://orcid.org/0000-0002-9003-6730">ORCID</a>) [funder]
</p>
</li>
<li><p> Van Andel Institute [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://jamespeapen.github.io/ceas/">https://jamespeapen.github.io/ceas/</a>
</p>
</li>
<li> <p><a href="https://github.com/jamespeapen/ceas/">https://github.com/jamespeapen/ceas/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/jamespeapen/ceas/issues/">https://github.com/jamespeapen/ceas/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='atp_plot'>ATP Plot</h2><span id='topic+atp_plot'></span>

<h3>Description</h3>

<p>Generate the ATP Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atp_plot(
  energetics,
  model = "ols",
  error_bar = "ci",
  conf_int = 0.95,
  size = 2,
  shape = 16,
  basal_vs_max = "basal",
  glyc_vs_resp = "glyc",
  group_label = "Experimental group",
  sep_reps = FALSE,
  ci_method = "Wald"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="atp_plot_+3A_energetics">energetics</code></td>
<td>
<p>A table of calculated glycolysis and OXPHOS rates.
Returned by <code>get_energetics</code></p>
</td></tr>
<tr><td><code id="atp_plot_+3A_model">model</code></td>
<td>
<p>The linear model used to estimate mean and confidence
intervals: ordinary least squares (<code>"ols"</code>) or mixed-effects (<code>"mixed"</code>)</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_error_bar">error_bar</code></td>
<td>
<p>Whether to plot error bars as standard deviation (<code>"sd"</code>)
or confidence intervals (<code>"ci"</code>)</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_conf_int">conf_int</code></td>
<td>
<p>The confidence interval percentage. Should be between 0 and 1</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_size">size</code></td>
<td>
<p>Size of the points</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_shape">shape</code></td>
<td>
<p>Shape of the points</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_basal_vs_max">basal_vs_max</code></td>
<td>
<p>Whether to plot <code>"basal"</code> or <code>"max"</code> respiration</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_glyc_vs_resp">glyc_vs_resp</code></td>
<td>
<p>Whether to plot glycolysis (<code>"glyc"</code>)  or respiration (<code>"resp"</code>)</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_group_label">group_label</code></td>
<td>
<p>Label for the experimental group to populate the legend title</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_sep_reps">sep_reps</code></td>
<td>
<p>Whether to calculate summary statistics on the groups with
replicates combined. The current default <code>FALSE</code> combines replicates, but
future releases will default to <code>TRUE</code> providing replicate-specific
summaries.</p>
</td></tr>
<tr><td><code id="atp_plot_+3A_ci_method">ci_method</code></td>
<td>
<p>The method used to compute confidence intervals for the
mixed-effects model: <code>"Wald"</code>, <code>"profile"</code>, or <code>"boot"</code> passed to
<code>lme4::confint.merMod()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Note:</strong>
When we use the term 'max' in the package documentation we mean the maximal
experimental OCR and ECAR values rather than absolute biological maximums.
</p>


<h3>Value</h3>

<p>a ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
partitioned_data &lt;- partition_data(seahorse_rates)
energetics &lt;- get_energetics(
  partitioned_data,
  ph = 7.4,
  pka = 6.093,
  buffer = 0.1
)
atp_plot(energetics, sep_reps = FALSE)

atp_plot(energetics, basal_vs_max = "max", sep_reps = FALSE)

atp_plot(
  energetics,
  basal_vs_max = "basal",
  glyc_vs_resp = "resp",
  sep_reps = TRUE
)
# to change fill, the geom_point shape number should be between 15 and 25
atp_plot(
  energetics,
  sep_reps = FALSE
) +
  ggplot2::scale_fill_manual(
    values = c("#e36500", "#b52356", "#3cb62d", "#328fe1")
  )

# to change color, use ggplot2::scale_color_manual
atp_plot(energetics, sep_reps = FALSE) +
  ggplot2::scale_color_manual(
    values = c("#e36500", "#b52356", "#3cb62d", "#328fe1")
  )
</code></pre>

<hr>
<h2 id='bioscope_plot'>Bioenergetic Scope Plot</h2><span id='topic+bioscope_plot'></span>

<h3>Description</h3>

<p>Generate the Bioenergetic Scope Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bioscope_plot(
  energetics,
  model = "ols",
  error_bar = "ci",
  conf_int = 0.95,
  size = 2,
  basal_shape = 1,
  max_shape = 19,
  group_label = "Experimental Group",
  sep_reps = FALSE,
  ci_method = "Wald"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bioscope_plot_+3A_energetics">energetics</code></td>
<td>
<p>A table of calculated glycolysis and OXPHOS rates.
Returned by <code>get_energetics</code></p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_model">model</code></td>
<td>
<p>The linear model used to estimate mean and confidence
intervals: ordinary least squares (<code>"ols"</code>) or mixed-effects (<code>"mixed"</code>)</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_error_bar">error_bar</code></td>
<td>
<p>Whether to plot error bars as standard deviation (<code>"sd"</code>)
or confidence intervals (<code>"ci"</code>)</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_conf_int">conf_int</code></td>
<td>
<p>The confidence interval percentage. Should be between 0 and 1</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_size">size</code></td>
<td>
<p>Size of the points</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_basal_shape">basal_shape</code></td>
<td>
<p>Shape of the points for basal values</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_max_shape">max_shape</code></td>
<td>
<p>Shape of the points for max values</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_group_label">group_label</code></td>
<td>
<p>Label for the experimental group to populate the legend title</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_sep_reps">sep_reps</code></td>
<td>
<p>Whether to calculate summary statistics on the groups with
replicates combined. The current default <code>FALSE</code> combines replicates, but
future releases will default to <code>TRUE</code> providing replicate-specific
summaries.</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_ci_method">ci_method</code></td>
<td>
<p>The method used to compute confidence intervals for the
mixed-effects model: <code>"Wald"</code>, <code>"profile"</code>, or <code>"boot"</code> passed to
<code>lme4::confint.merMod()</code>.</p>
</td></tr>
<tr><td><code id="bioscope_plot_+3A_bioscope_plot">bioscope_plot</code></td>
<td>
<p>Creates a 2D plot visualizing the mean and standard
deviation basal and maximal ATP production from glycolysis and OXPHOS for
each experimental group</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
partitioned_data &lt;- partition_data(seahorse_rates)
energetics &lt;- get_energetics(
  partitioned_data,
  ph = 7.4,
  pka = 6.093,
  buffer = 0.1
)
bioscope_plot(energetics, sep_reps = FALSE)

# to change fill, the geom_point shape should be between 15 and 20.
# These shapes are filled without border and will correctly show on the legend.
bioscope_plot(
  energetics,
  sep_reps = TRUE,
  size = 3,
  basal_shape = 2,
  max_shape = 17 # empty and filled triangle
) +
  ggplot2::scale_fill_manual(
    values = c("#e36500", "#b52356", "#3cb62d", "#328fe1")
  )

# to change color, use ggplot2::scale_color_manual
bioscope_plot(energetics, sep_reps = FALSE) +
  ggplot2::scale_color_manual(
    values = c("#e36500", "#b52356", "#3cb62d", "#328fe1")
  )
</code></pre>

<hr>
<h2 id='energetics_lme_summary'>Get mean and confidence intervals from energetics mixed-effects models</h2><span id='topic+energetics_lme_summary'></span>

<h3>Description</h3>

<p>Runs linear mixed-effects models on the ATP measure columns from
<code>get_energetics</code> with replicates as the random-effect. Estimates mean and
confidence intervals for ATP production from glycolysis and OXPHOS at points
defined in <code>partition_data</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>energetics_lme_summary(atp_col, energetics, conf_int, ci_method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="energetics_lme_summary_+3A_atp_col">atp_col</code></td>
<td>
<p>The column name of the ATP measure - one of &quot;ATP_basal_resp&quot;,
&quot;ATP_max_resp&quot;, &quot;ATP_basal_glyc&quot;, &quot;ATP_max_glyc&quot;</p>
</td></tr>
<tr><td><code id="energetics_lme_summary_+3A_energetics">energetics</code></td>
<td>
<p>a data.table of Seahorse OCR and ECAR rates (from <code>get_energetics</code>)</p>
</td></tr>
<tr><td><code id="energetics_lme_summary_+3A_conf_int">conf_int</code></td>
<td>
<p>The confidence interval percentage. Should be between 0 and
1</p>
</td></tr>
<tr><td><code id="energetics_lme_summary_+3A_ci_method">ci_method</code></td>
<td>
<p>The method used to compute confidence intervals for the
mixed-effects model: <code>"Wald"</code>, <code>"profile"</code>, or <code>"boot"</code> passed to
<code>lme4::confint.merMod()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table with mean and the confidence interval bounds by
experimental group
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
partitioned_data &lt;- partition_data(seahorse_rates)
energetics &lt;- get_energetics(
  partitioned_data,
  ph = 7.4,
  pka = 6.093,
  buffer = 0.1
)
# Only for one column. For the full energetics table run
# `get_energetics_summary` with `model = "mixed"`.
energetics_lme_summary(
  "ATP_max_resp",
  energetics,
  conf_int = 0.95,
  ci_method = "Wald"
)
</code></pre>

<hr>
<h2 id='energetics_ols_summary'>Get ordinary least squares mean and confidence intervals from energetics</h2><span id='topic+energetics_ols_summary'></span>

<h3>Description</h3>

<p>Helper function to calculate mean and standard deviation of ATP production
from glycolysis and OXPHOS at points defined in <code>partition_data</code> and with
values calculated using the <code>get_energetics</code> function. Should only be called
from <code>get_energetics_summary</code> as the function itself only operaes on a
vector without any of the grouping that <code>get_energetics</code> does.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>energetics_ols_summary(atp_col, error_metric, conf_int)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="energetics_ols_summary_+3A_atp_col">atp_col</code></td>
<td>
<p>The column name of the ATP measure - one of &quot;ATP_basal_resp&quot;,
&quot;ATP_max_resp&quot;, &quot;ATP_basal_glyc&quot;, &quot;ATP_max_glyc&quot;</p>
</td></tr>
<tr><td><code id="energetics_ols_summary_+3A_error_metric">error_metric</code></td>
<td>
<p>Whether to calculate error as standard deviation (<code>"sd"</code>) or confidence intervals (<code>"ci"</code>)</p>
</td></tr>
<tr><td><code id="energetics_ols_summary_+3A_conf_int">conf_int</code></td>
<td>
<p>The confidence interval percentage. Should be between 0 and
1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table with mean and the confidence interval bounds by
experimental group
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
partitioned_data &lt;- partition_data(seahorse_rates)
energetics &lt;- get_energetics(partitioned_data, ph = 7.4, pka = 6.093, buffer = 0.1)
# Only for one row and across all groups and replicates.
# For the full correctly grouped energetics table run
# `get_energetics_summary` with `model = "ols"`.
energetics_ols_summary(energetics$ATP_max_resp, error_metric = "ci", conf_int = 0.95)
</code></pre>

<hr>
<h2 id='fit_lme'>Estimate mean and confidence intervals using a mixed-effects model</h2><span id='topic+fit_lme'></span>

<h3>Description</h3>

<p>Estimates mean and standard deviation of energetics or rates with
replicates as the random-effect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_lme(
  data_col,
  input,
  group_colname = "exp_group",
  rep_colname = "replicate"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_lme_+3A_data_col">data_col</code></td>
<td>
<p>The column name of the ATP measure (&quot;ATP_basal_resp&quot;,
&quot;ATP_max_resp&quot;, &quot;ATP_basal_glyc&quot;, &quot;ATP_max_glyc&quot;) or rate measure (&quot;OCR&quot;, &quot;ECAR&quot;)</p>
</td></tr>
<tr><td><code id="fit_lme_+3A_input">input</code></td>
<td>
<p>The dataset containing <code>data_col</code> from <code>get_energetics</code> or <code>read_data</code></p>
</td></tr>
<tr><td><code id="fit_lme_+3A_group_colname">group_colname</code></td>
<td>
<p>The column containing experimental group names</p>
</td></tr>
<tr><td><code id="fit_lme_+3A_rep_colname">rep_colname</code></td>
<td>
<p>The column containing replicate IDs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>lme4::lmer</code> mixed effects model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
partitioned_data &lt;- partition_data(seahorse_rates)
energetics &lt;- get_energetics(partitioned_data, ph = 7.4, pka = 6.093, buffer = 0.1)
fit_lme("ATP_max_glyc", energetics)
</code></pre>

<hr>
<h2 id='get_energetics'>Calculate ATP Production from OXPHOS and Glycolysis</h2><span id='topic+get_energetics'></span>

<h3>Description</h3>

<p>Calculates ATP production from glycolysis and OXPHOS at points defined in patitioned_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_energetics(partitioned_data, ph, pka, buffer)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_energetics_+3A_partitioned_data">partitioned_data</code></td>
<td>
<p>a data.table of organized Seahorse OCR and ECAR
rates based on timepoints from the assay cycle. Returned by <code>partition_data</code></p>
</td></tr>
<tr><td><code id="get_energetics_+3A_ph">ph</code></td>
<td>
<p>pH value for energetics calculation (for XF Media, 7.5)</p>
</td></tr>
<tr><td><code id="get_energetics_+3A_pka">pka</code></td>
<td>
<p>pKa value for energetics calculation (for XF Media, 6.063)</p>
</td></tr>
<tr><td><code id="get_energetics_+3A_buffer">buffer</code></td>
<td>
<p>buffer for energetics calculation (for XF Media, 0.1 mpH/pmol H+)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TODO: check that all symbols are defined
</p>
<p>Proton production rate (PPR):
</p>
<p style="text-align: center;"><code class="reqn">\text{PPR} = \frac{\text{ECAR value}}{\text{buffer}}</code>
</p>

<p style="text-align: center;"><code class="reqn">
  \text{PPR}_{\text{mito}} = \frac{10^{\text{pH}-\text{pK}_a}}{1+10^{\text{pH}-\text{pK}_a}} \cdot \frac{\text{H}^+}{\text{O}_2} \cdot \text{OCR}
</code>
</p>

<p>calculates the proton production from glucose during its conversion to bicarbonate and <code class="reqn">\text{H}^+</code> assuming max <code class="reqn">\frac{\text{H}^+}{\text{O}_2}</code> of 1
</p>
<p style="text-align: center;"><code class="reqn">
 \text{PPR}_\text{glyc} = \text{PPR} - \text{PPR}_\text{resp}
</code>
</p>

<p>calculates the proton production from glucose during its conversion to lactate + <code class="reqn">\text{H}^+</code>
</p>
<p>Joules of ATP (JATP) production:
</p>
<p style="text-align: center;"><code class="reqn">
  \text{ATP}_{\text{glyc}} =
   \Bigl(\text{PPR}_\text{glyc} \cdot \frac{\text{ATP}}{\text{lactate}}\Bigl) +
   \Bigl(\text{MITO}_\text{resp} \cdot 2 \cdot \frac{\text{P}}{\text{O}_\text{glyc}}\Bigl)
</code>
</p>

<p style="text-align: center;"><code class="reqn">
 \frac{\text{ATP}}{\text{lactate}} = 1
</code>
</p>

<p>with
<code class="reqn">\frac{\text{P}}{{\text{O}_\text{glyc}}}</code> = 0.167 for glucose (0.242 for glycogen).
</p>
<p style="text-align: center;"><code class="reqn">
 \text{ATP}_\text{resp} =
  \Bigl(\text{coupled MITO}_\text{resp} \cdot 2 \cdot \frac{\text{P}}{\text{O}_\text{oxphos}}\Bigl) +
  \Bigl(\text{MITO}_\text{resp} \cdot 2 \cdot \frac{\text{P}}{\text{O}_\text{TCA}}\Bigl)
</code>
</p>

<p>with <code class="reqn">\frac{\text{P}}{{\text{O}_\text{oxphos}}}</code>  = 2.486 and <code class="reqn">\frac{\text{P}}{{\text{O}_\text{TCA}}}</code> = 0.167.
</p>


<h3>Value</h3>

<p>a <code>data.table</code> of glycolysis and OXPHOS rates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
partitioned_data &lt;- partition_data(seahorse_rates)
energetics &lt;- get_energetics(
  partitioned_data,
  ph = 7.4,
  pka = 6.093,
  buffer = 0.1
)
head(energetics, n = 10)
</code></pre>

<hr>
<h2 id='get_energetics_summary'>Calculate ATP Production Mean and Standard Deviation</h2><span id='topic+get_energetics_summary'></span>

<h3>Description</h3>

<p>Calculates mean and standard deviation of ATP production from glycolysis and
OXPHOS at points defined in <code>partition_data</code> and with values calculated
using the <code>get_energetics</code> function via ordinary least squares or a
mixed-effects model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_energetics_summary(
  energetics,
  model = "ols",
  error_metric = "ci",
  conf_int = 0.95,
  sep_reps = FALSE,
  ci_method = "Wald"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_energetics_summary_+3A_energetics">energetics</code></td>
<td>
<p>a data.table of Seahorse OCR and ECAR rates (from <code>get_energetics</code>)</p>
</td></tr>
<tr><td><code id="get_energetics_summary_+3A_model">model</code></td>
<td>
<p>The model used to estimate mean and confidence intervals:
ordinary least squares (<code>"ols"</code>) or mixed-effects (<code>"mixed"</code>)</p>
</td></tr>
<tr><td><code id="get_energetics_summary_+3A_error_metric">error_metric</code></td>
<td>
<p>Whether to calculate error as standard deviation (<code>"sd"</code>) or confidence intervals (<code>"ci"</code>)</p>
</td></tr>
<tr><td><code id="get_energetics_summary_+3A_conf_int">conf_int</code></td>
<td>
<p>The confidence interval percentage. Should be between 0 and 1</p>
</td></tr>
<tr><td><code id="get_energetics_summary_+3A_sep_reps">sep_reps</code></td>
<td>
<p>Whether to calculate summary statistics on the groups with
replicates combined. The current default <code>FALSE</code> combines replicates, but
future releases will default to <code>TRUE</code> providing replicate-specific
summaries.</p>
</td></tr>
<tr><td><code id="get_energetics_summary_+3A_ci_method">ci_method</code></td>
<td>
<p>The method used to compute confidence intervals for the
mixed-effects model: <code>"Wald"</code>, <code>"profile"</code>, or <code>"boot"</code> passed to
<code>lme4::confint.merMod()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To get the means and confidence intervals for experiments with replicates,
users can either use <code>sep_reps = TRUE</code> to get replicate-level summary
statistics or set <code>model = "mixed"</code> to use a linear mixed-effects model on
with replicate as the random-effect. The confidence intervals are generated
using <code>confint(method = "Wald")</code>.
</p>


<h3>Value</h3>

<p>a list of groups from the data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
partitioned_data &lt;- partition_data(seahorse_rates)
energetics_list &lt;- get_energetics(
  partitioned_data,
  ph = 7.4,
  pka = 6.093,
  buffer = 0.1
)
energetics_summary &lt;- get_energetics_summary(energetics_list, sep_reps = FALSE)
head(energetics_summary[, c(1:5)], n = 10)
head(energetics_summary[, c(1, 2, 6, 7)], n = 10)
</code></pre>

<hr>
<h2 id='get_rate_summary'>Rates summary</h2><span id='topic+get_rate_summary'></span>

<h3>Description</h3>

<p>Summarize OCR and ECAR as mean and bounded standard deviations or standard error with confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rate_summary(
  seahorse_rates,
  measure = "OCR",
  assay,
  model = "ols",
  error_metric = "ci",
  conf_int = 0.95,
  sep_reps = FALSE,
  ci_method = "Wald"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_rate_summary_+3A_seahorse_rates">seahorse_rates</code></td>
<td>
<p>data.table Seahorse OCR and ECAR rates (imported using <code>read_data</code> function)</p>
</td></tr>
<tr><td><code id="get_rate_summary_+3A_measure">measure</code></td>
<td>
<p>Whether to calculate summary for <code>"OCR"</code> or <code>"ECAR"</code></p>
</td></tr>
<tr><td><code id="get_rate_summary_+3A_assay">assay</code></td>
<td>
<p>What assay to calculate summary for (e.g. &quot;MITO&quot; or &quot;GLYCO&quot;)</p>
</td></tr>
<tr><td><code id="get_rate_summary_+3A_model">model</code></td>
<td>
<p>The model used to estimate mean and confidence intervals:</p>
</td></tr>
<tr><td><code id="get_rate_summary_+3A_error_metric">error_metric</code></td>
<td>
<p>Whether to calculate error as standard deviations (<code>"sd"</code>) or confidence intervals (<code>"ci"</code>)</p>
</td></tr>
<tr><td><code id="get_rate_summary_+3A_conf_int">conf_int</code></td>
<td>
<p>The confidence interval percentage. Should be between 0 and 1</p>
</td></tr>
<tr><td><code id="get_rate_summary_+3A_sep_reps">sep_reps</code></td>
<td>
<p>Whether to calculate summary statistics on the groups with
replicates combined. The current default <code>FALSE</code> combines replicates, but
future releases will default to <code>TRUE</code> providing replicate-specific
summaries.</p>
</td></tr>
<tr><td><code id="get_rate_summary_+3A_ci_method">ci_method</code></td>
<td>
<p>The method used to compute confidence intervals for the
mixed-effects model: <code>"Wald"</code>, <code>"profile"</code>, or <code>"boot"</code> passed to
<code>lme4::confint.merMod()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.table with means, standard deviations/standard error with bounds around the mean(sd or confidence intervals)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
combined_reps &lt;- get_rate_summary(
  seahorse_rates,
  measure = "OCR",
  assay = "MITO",
  model = "ols",
  error_metric = "ci",
  conf_int = 0.95,
  sep_reps = FALSE
)
head(combined_reps, n = 10)

# separate replicates
sep_reps &lt;- get_rate_summary(
  seahorse_rates,
  measure = "OCR",
  assay = "MITO",
  model = "ols",
  error_metric = "ci",
  conf_int = 0.95,
  sep_reps = TRUE
)
head(sep_reps, n = 10)

# mixed effects model
reps_as_random_effects &lt;- get_rate_summary(
  seahorse_rates,
  measure = "OCR",
  assay = "MITO",
  model = "mixed",
  error_metric = "ci",
  conf_int = 0.95,
  sep_reps = FALSE
)
head(reps_as_random_effects, n = 10)
</code></pre>

<hr>
<h2 id='make_bioscope_plot'>Bioenergetic Scope Plot Shortcut</h2><span id='topic+make_bioscope_plot'></span>

<h3>Description</h3>

<p>Wrapper to create a 2D plot visualizing the mean and standard deviation
basal and maximal ATP production from glycolysis and OXPHOS for each
experimental group Create a Bioenergetic scope plot from input Seahorse Wave
export, long-form rates excel files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_bioscope_plot(rep_list, ph, pka, buffer, sheet = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_bioscope_plot_+3A_rep_list">rep_list</code></td>
<td>
<p>A list of Seahorse Wave excel export files. One file per
replicate. Group all replicates for a given experiment in a single folder,
and write that folder's path in &quot;seahorse_data&quot;. You can use
'list.files(&quot;seahorse_data&quot;) &quot;full.names=TRUE&quot;) to get the paths to the
files.</p>
</td></tr>
<tr><td><code id="make_bioscope_plot_+3A_ph">ph</code></td>
<td>
<p>pH value for energetics calculation (for XF Media, 7.5)</p>
</td></tr>
<tr><td><code id="make_bioscope_plot_+3A_pka">pka</code></td>
<td>
<p>pKa value for energetics calculation (for XF Media, 6.063)</p>
</td></tr>
<tr><td><code id="make_bioscope_plot_+3A_buffer">buffer</code></td>
<td>
<p>buffer for energetics calculation (for XF Media, 0.1 mpH/pmol H+)</p>
</td></tr>
<tr><td><code id="make_bioscope_plot_+3A_sheet">sheet</code></td>
<td>
<p>The number of the excel sheet containing the long-form Seahorse
data. Default is 2 because the long-form output from Seahorse Wave is on
sheet 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
make_bioscope_plot(rep_list, ph = 7.4, pka = 6.093, buffer = 0.1)
</code></pre>

<hr>
<h2 id='normalize'>Normalize Seahorse data</h2><span id='topic+normalize'></span>

<h3>Description</h3>

<p>Normalizes input data according to a sample normalization measure (e.g. cell
number or <code class="reqn">\mu</code>g of protein). It assumes your data is background
normalized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize(
  seahorse_rates,
  norm_csv,
  norm_column = "well",
  norm_method = "minimum"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalize_+3A_seahorse_rates">seahorse_rates</code></td>
<td>
<p>The seahorse rates table read by the <code><a href="#topic+read_data">read_data()</a></code>
function.</p>
</td></tr>
<tr><td><code id="normalize_+3A_norm_csv">norm_csv</code></td>
<td>
<p>A csv file with either well or experimental group in column
1 and the sample normalization measure in column 2. Headers are ignored.</p>
</td></tr>
<tr><td><code id="normalize_+3A_norm_column">norm_column</code></td>
<td>
<p>Whether to normalize by <code>"well"</code> or <code>"exp_group"</code> group.
The first column of the normalization csv provided should match this value.</p>
</td></tr>
<tr><td><code id="normalize_+3A_norm_method">norm_method</code></td>
<td>
<p>How to normalize each well or experimental group (specified by <code>norm_column</code>):
</p>

<ul>
<li><p> by its corresponding row in the <code>norm_csv</code> (<code>"self"</code>) or
</p>
</li>
<li><p> by the minimum of the <code>measure</code> column in the provided <code>norm_csv</code> (<code>"minimum"</code>).
</p>
</li></ul>

<p>See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This normalization is distinct from the background normalization done by the
Wave software. If the data are not background normalized, <code>read_data()</code> will
output a warning showing rows with OCR, ECAR and PER values greater than 0.
</p>


<h4>Normalization Methods</h4>

<p>When <code>norm_method</code> is set to <code>"self"</code>, each OCR, ECAR, and PER value is
divided by the measure it&quot;self&quot;. OCR and ECAR values are divided by the
corresponding raw value in the &quot;measure&quot; column: an intra-well or
experimental group normalization. Each normalized value is then interpreted
as pmol/min per measure (e.g. pmol/min/cell  or pmol/min/<code class="reqn">\mu</code>g of
protein.
</p>
<p>When set to <code>"minimum"</code>, each OCR, ECAR, and PER value is normalized by the
minimum value in the <code>norm_csv</code> &quot;measure&quot; column. In this method, every
&quot;measure&quot; column's value in the provided CSV file is divided by the lowest
of the &quot;measure&quot; values to get a normalization factor for each well or
experimental group. The OCR, ECAR, and PER values in each well or
experimental group are divided by their corresponding normalization factors.
Compared to <code>"self"</code>, this is an inter-well/experimental group normalization
based on the lowest <code>"measure"</code>. The results may be interpreted as pmol/min
per minimum of the measure (eg: group cell count or <code class="reqn">\mu</code>g of protein.)
</p>



<h3>Value</h3>

<p>a normalized seahorse_rates data.table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
norm_csv &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "^norm.csv", full.names = TRUE)
read.csv(norm_csv)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
head(seahorse_rates, n = 10)
# normalize by experimental group based on the minimum cell count or protein quantity
seahorse_rates.normalized &lt;- normalize(
  seahorse_rates,
  norm_csv,
  norm_column = "exp_group",
  norm_method = "minimum"
)
head(seahorse_rates.normalized, n = 10)
</code></pre>

<hr>
<h2 id='partition_data'>Organize Seahorse Data</h2><span id='topic+partition_data'></span>

<h3>Description</h3>

<p>Organizes Seahorse OCR and ECAR rates based on defined time points (i.e. the
Measurement column) during the experiment. This time point can be specified
if you are modifying the Mito and Glyco Stress Test (i.e. from 3 measurements
per cycle to X measurements)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partition_data(
  seahorse_rates,
  assay_types = list(basal = "MITO", uncoupled = "MITO", maxresp = "MITO", nonmito =
    "MITO", no_glucose_glyc = "GLYCO", glucose_glyc = "GLYCO", max_glyc = "GLYCO"),
  basal_tp = 3,
  uncoupled_tp = 6,
  maxresp_tp = 8,
  nonmito_tp = 12,
  no_glucose_glyc_tp = 3,
  glucose_glyc_tp = 6,
  max_glyc_tp = 8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partition_data_+3A_seahorse_rates">seahorse_rates</code></td>
<td>
<p>A data.table of OCR and ECAR rates returned by <code>read_data</code></p>
</td></tr>
<tr><td><code id="partition_data_+3A_assay_types">assay_types</code></td>
<td>
<p>A list that configures data partitioning based on the type of assay. See details.</p>
</td></tr>
<tr><td><code id="partition_data_+3A_basal_tp">basal_tp</code></td>
<td>
<p>Basal respiration time point. Must be less than <code>uncoupled_tp</code></p>
</td></tr>
<tr><td><code id="partition_data_+3A_uncoupled_tp">uncoupled_tp</code></td>
<td>
<p>ATP-coupled respiration time point. Must be less than <code>maxresp_tp</code></p>
</td></tr>
<tr><td><code id="partition_data_+3A_maxresp_tp">maxresp_tp</code></td>
<td>
<p>Maximal uncoupled respiration time point. Must be less than <code>nonmito_tp</code></p>
</td></tr>
<tr><td><code id="partition_data_+3A_nonmito_tp">nonmito_tp</code></td>
<td>
<p>Non-mitochondrial respiration time point. Must be larger than <code>maxresp_tp</code></p>
</td></tr>
<tr><td><code id="partition_data_+3A_no_glucose_glyc_tp">no_glucose_glyc_tp</code></td>
<td>
<p>No glucose added acidification time point. Must be less than <code>glucose_glyc_tp</code></p>
</td></tr>
<tr><td><code id="partition_data_+3A_glucose_glyc_tp">glucose_glyc_tp</code></td>
<td>
<p>Glucose-associated acidification time point. Must be less than <code>max_glyc_tp</code></p>
</td></tr>
<tr><td><code id="partition_data_+3A_max_glyc_tp">max_glyc_tp</code></td>
<td>
<p>Maximal acidification time point. Must be less than <code>twodg_glyc_tp</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Note:</strong>
When we use the term 'max' in the package documentation we mean the maximal
experimental OCR and ECAR values rather than absolute biological maximums.
</p>
<p><code>partition_data</code> sets up the rates data for ATP calculations by the
<code>get_energetics</code> function. To do this, it takes a list <code>assay_types</code> with
the named values <code>basal</code>, <code>uncoupled</code>, <code>maxresp</code>, <code>nonmito</code>,
<code>no_glucose_glyc</code>, <code>glucose_glyc</code>, and <code>max_glyc</code>. In the default setting,
it is configured for an experiment with both Mito and Glyco assays. However,
partitioning can be configured for other experimental conditions.
</p>

<ul>
<li><p> Only MITO data:
</p>
</li></ul>

<pre>partitioned_data &lt;- partition_data(
  seahorse_rates,
  assay_types = list(
    basal = "MITO",
    uncoupled = "MITO",
    maxresp = "MITO",
    nonmito = "MITO",
    no_glucose_glyc = NA,
    glucose_glyc = "MITO",
    max_glyc = NA
  ),
  basal_tp = 3,
  uncoupled_tp = 6,
  maxresp_tp = 8,
  nonmito_tp = 12,
  no_glucose_glyc_tp = NA,
  glucose_glyc_tp = 3,
  max_glyc_tp = NA
)
</pre>
<p>Respiratory control ratio (RCR) and glycolytic capacity (GC) assay:
</p>
<pre>partitioned_data &lt;- partition_data(
  seahorse_rates,
  assay_types = list(
    basal = "RCR",
    uncoupled = "RCR",
    maxresp = "RCR,"
    nonmito = "RCR",
    no_glucose_glyc = NA,
    glucose_glyc = "GC",
    max_glyc = "GC"
  ),
  basal_tp = 3,
  uncoupled_tp = 6,
  maxresp_tp = 8,
  nonmito_tp = 12,
  no_glucose_glyc = NA,
  glucose_glyc_tp = 3,
  max_glyc_tp = 9
)
</pre>

<ul>
<li><p> Data according to Mookerjee <em>et al.</em> 2017 <em>J Biol Chem</em>;<em>292</em>:7189-207.
</p>
</li></ul>

<pre>partitioned_data &lt;- partition_data(
  seahorse_rates,
  assay_types = list(
    basal = "RefAssay",
    uncoupled = "RefAssay",
    maxresp = NA,
    nonmito = "RefAssay",
    no_glucose_glyc = "RefAssay",
    glucose_glyc = "RefAssay",
    max_glyc = NA
  ),
  basal_tp = 5,
  uncoupled_tp = 10,
  nonmito_tp = 12,
  maxresp = NA,
  no_glucose_glyc_tp = 1,
  glucose_glyc_tp = 5,
  max_glyc = NA
)
</pre>
<p>Also see the vignette.
</p>


<h3>Value</h3>

<p>a list of named time points from each assay cycle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
partitioned_data &lt;- partition_data(seahorse_rates)
</code></pre>

<hr>
<h2 id='rate_plot'>Rate plot</h2><span id='topic+rate_plot'></span>

<h3>Description</h3>

<p>Generate OCR and ECAR plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rate_plot(
  seahorse_rates,
  measure = "OCR",
  assay = "MITO",
  model = "ols",
  error_bar = "ci",
  conf_int = 0.95,
  group_label = "Experimental group",
  linewidth = 2,
  sep_reps = FALSE,
  ci_method = "Wald"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rate_plot_+3A_seahorse_rates">seahorse_rates</code></td>
<td>
<p>data.table Seahorse OCR and ECAR rates (imported using <code>read_data</code> function)</p>
</td></tr>
<tr><td><code id="rate_plot_+3A_measure">measure</code></td>
<td>
<p>Whether to plot <code>"OCR"</code> or <code>"ECAR"</code></p>
</td></tr>
<tr><td><code id="rate_plot_+3A_assay">assay</code></td>
<td>
<p>What assay to plot (e.g. &quot;MITO&quot; or &quot;GLYCO&quot;)</p>
</td></tr>
<tr><td><code id="rate_plot_+3A_model">model</code></td>
<td>
<p>The model used to estimate mean and confidence intervals:</p>
</td></tr>
<tr><td><code id="rate_plot_+3A_error_bar">error_bar</code></td>
<td>
<p>Whether to plot error bars as standard deviation (<code>"sd"</code>) or confidence intervals (<code>"ci"</code>)</p>
</td></tr>
<tr><td><code id="rate_plot_+3A_conf_int">conf_int</code></td>
<td>
<p>The confidence interval percentage. Should be between 0 and 1</p>
</td></tr>
<tr><td><code id="rate_plot_+3A_group_label">group_label</code></td>
<td>
<p>Label for the experimental group to populate the legend title</p>
</td></tr>
<tr><td><code id="rate_plot_+3A_linewidth">linewidth</code></td>
<td>
<p>Width for the lines, passed to <code>geom_line()</code></p>
</td></tr>
<tr><td><code id="rate_plot_+3A_sep_reps">sep_reps</code></td>
<td>
<p>Whether to calculate summary statistics on the groups with
replicates combined. The current default <code>FALSE</code> combines replicates, but
future releases will default to <code>TRUE</code> providing replicate-specific
summaries.</p>
</td></tr>
<tr><td><code id="rate_plot_+3A_ci_method">ci_method</code></td>
<td>
<p>The method used to compute confidence intervals for the
mixed-effects model: <code>"Wald"</code>, <code>"profile"</code>, or <code>"boot"</code> passed to
<code>lme4::confint.merMod()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
rate_plot(
  seahorse_rates,
  measure = "OCR",
  error_bar = "ci",
  conf_int = 0.95,
  sep_reps = FALSE
)
rate_plot(
  seahorse_rates,
  measure = "OCR",
  error_bar = "ci",
  conf_int = 0.95,
  sep_reps = TRUE
)
</code></pre>

<hr>
<h2 id='rates_lme_summary'>Estimate mean and confidence intervals for ATP measures using a mixed-effects model</h2><span id='topic+rates_lme_summary'></span>

<h3>Description</h3>

<p>Estimates mean and standard deviation of ATP production from glycolysis and
OXPHOS at points defined in <code>partition_data</code> and with values calculated
using the <code>get_energetics</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rates_lme_summary(measure, assay, rates, conf_int, ci_method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rates_lme_summary_+3A_measure">measure</code></td>
<td>
<p>Whether to plot <code>"OCR"</code> or <code>"ECAR"</code></p>
</td></tr>
<tr><td><code id="rates_lme_summary_+3A_assay">assay</code></td>
<td>
<p>What assay to plot (e.g. &quot;MITO&quot; or &quot;GLYCO&quot;)</p>
</td></tr>
<tr><td><code id="rates_lme_summary_+3A_rates">rates</code></td>
<td>
<p>a data.table of Seahorse OCR and ECAR rates (from <code>get_energetics</code>)</p>
</td></tr>
<tr><td><code id="rates_lme_summary_+3A_conf_int">conf_int</code></td>
<td>
<p>The confidence interval percentage. Should be between 0 and 1</p>
</td></tr>
<tr><td><code id="rates_lme_summary_+3A_ci_method">ci_method</code></td>
<td>
<p>The method used to compute confidence intervals for the
mixed-effects model: <code>"Wald"</code>, <code>"profile"</code>, or <code>"boot"</code> passed to
<code>lme4::confint.merMod()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of groups from the data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
rates_lme_summary(
  measure = "OCR",
  assay = "MITO",
  rates = seahorse_rates,
  conf_int = 0.95,
  ci_method = "Wald"
)
</code></pre>

<hr>
<h2 id='read_data'>Read Seahorse Wave Excel File</h2><span id='topic+read_data'></span>

<h3>Description</h3>

<p>Reads input seahore data from an excel Seahorse Wave File. It  assumes your
data is background normalized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_data(
  rep_list,
  norm = NULL,
  sheet = 2,
  delimiter = " ",
  norm_column = "exp_group",
  norm_method = "minimum"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_data_+3A_rep_list">rep_list</code></td>
<td>
<p>A list of Seahorse Wave excel export files. One file per
replicate. If your data is in a directory called &quot;seahorse_data&quot;, use
<code>list.files("seahorse_data", pattern = "*.xlsx", full.names = TRUE)</code> to make
a list of the excel files. Add multiple replicates with care - see details.</p>
</td></tr>
<tr><td><code id="read_data_+3A_norm">norm</code></td>
<td>
<p>A csv file with the experimental groups and their normalization
values. Leave unset if normalization is not required. See <code><a href="#topic+normalize">normalize()</a></code>.</p>
</td></tr>
<tr><td><code id="read_data_+3A_sheet">sheet</code></td>
<td>
<p>The number of the excel sheet containing the long-form Seahorse
data. Default is 2 because the long-form output from Seahorse Wave is on
sheet 2</p>
</td></tr>
<tr><td><code id="read_data_+3A_delimiter">delimiter</code></td>
<td>
<p>The delimiter between the group name and the assay type in
the Group column of the wave output. e.g. &quot;Group1 MITO&quot; would use a space
character as delimiter.</p>
</td></tr>
<tr><td><code id="read_data_+3A_norm_column">norm_column</code></td>
<td>
<p>Whether to normalize by <code>"Well"</code> or <code>"exp_group"</code> column.
The first column of the normalization csv provided should match this value.</p>
</td></tr>
<tr><td><code id="read_data_+3A_norm_method">norm_method</code></td>
<td>
<p>How to normalize each well or experimental group (specified by <code>norm_column</code>):
</p>

<ul>
<li><p> by its corresponding row in the <code>norm</code> csv (<code>"self"</code>) or
</p>
</li>
<li><p> by the minimum of the <code>measure</code> column in the provided <code>norm</code> csv (<code>"minimum"</code>).
</p>
</li></ul>

<p>See the <code>normalize()</code> function for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although ceas enables integration of multiple biological and/or technical
replicates, previous work has reported high inter-plate variation (Yepez et.
al 2018). If you don't want your replicate data combined, you can either:
</p>

<ul>
<li><p> make sure that the names of the common groups between the replicates are
different.
</p>
</li>
<li><p> in downstream analyses (<code>get_energetics_summary</code>, <code>bioscope_plot</code>,
<code>rate_plot</code>, <code>atp_plot</code>), use <code>sep_reps = TRUE</code> to do all calculations and
plotting separately for each replicate.
</p>
</li></ul>

<p><strong>NOTE:</strong> to maintain backwards compatibility <code>sep_reps</code> is currently
<code>FALSE</code> by default, but will be set to <code>TRUE</code> in a future release.
</p>


<h3>Value</h3>

<p>a seahorse_rates table
</p>


<h3>References</h3>

<p>Yépez <em>et al.</em> 2018
<em>OCR-Stats: Robust estimation and statistical testing of mitochondrial
respiration activities using Seahorse XF Analyzer</em>
<em>PLOS ONE</em> 2018;<strong>13</strong>:e0199938.
<a href="https://doi.org/10.1371/journal.pone.0199938">doi:10.1371/journal.pone.0199938</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_list &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "*.xlsx", full.names = TRUE)
seahorse_rates &lt;- read_data(rep_list, sheet = 2)
head(seahorse_rates, n = 10)

# normalization by well using raw cell count or protein quantity
norm_csv &lt;- system.file("extdata", package = "ceas") |&gt;
  list.files(pattern = "well_norm.csv", full.names = TRUE)
seahorse_rates.norm &lt;- read_data(
  rep_list,
  norm = norm_csv,
  norm_column = "well",
  norm_method = "self",
  sheet = 2
)
head(seahorse_rates.norm, n = 10)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
