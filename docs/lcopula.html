<!DOCTYPE html><html lang="en"><head><title>Help for package lcopula</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lcopula}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lcopula-package'>
<p>Liouville Copulas</p></a></li>
<li><a href='#.ctspecdens'><p>Spectral density of Coles and Tawn extreme value distribution</p></a></li>
<li><a href='#.liouv.iTau_s'><p>Moment estimate for <code>theta</code> derived from Kendall's <code class="reqn">\tau</code></p></a></li>
<li><a href='#.liouv.Tau_s'><p>Computes Kendall's <code class="reqn">\tau</code> for Clayton or Gumbel Liouville copula</p></a></li>
<li><a href='#.marginCombo'><p>Rcpp function to compute sum of rows and couple according to alphavec</p></a></li>
<li><a href='#.pickands.dir.uni'><p>Pickands dependence function for the copula domain of attraction of Liouville survival copulas</p></a></li>
<li><a href='#.pickands.fun.uni'><p>Pickands dependence function for the copula domain of attraction of Liouville copulas</p></a></li>
<li><a href='#.pliouv.opt_old'><p>Old code for the copula likelihood function for Liouville copulas</p></a></li>
<li><a href='#airquality'><p>Daily air pollutant measures in Leeds</p></a></li>
<li><a href='#danube'><p>Ranks of preprocessed monthly Danube river flow measurements</p></a></li>
<li><a href='#dirspecdens'><p>Spectral density of scaled Dirichlet and negative Dirichlet extreme value distributions</p></a></li>
<li><a href='#express_coef_clayton'><p>Clayton coefficient for Kendall's tau formula</p></a></li>
<li><a href='#express_coef_gumb'><p>Gumbel coefficient for Kendall's tau formula</p></a></li>
<li><a href='#H_inv'><p>Inverse survival function if Monte-Carlo approximation is set to <code>TRUE</code> in <code>liouv.maxim</code></p></a></li>
<li><a href='#hmvevdliouv'><p>Spectral density of the CDA of survival copula and copula of Liouville vectors</p></a></li>
<li><a href='#isliouv_m'><p>Multiple marginal inverse survival function of Liouville vectors</p></a></li>
<li><a href='#K.plot'><p>Kendall plot</p></a></li>
<li><a href='#liouv.iTau'><p>Moment estimate for theta derived from Kendall's tau formula</p></a></li>
<li><a href='#liouv.maxim'><p>Maximization of  Liouville copula likelihood function</p></a></li>
<li><a href='#liouv.Tau'><p>Computes Kendall's tau for Clayton or Gumbel Liouville copula</p></a></li>
<li><a href='#Liouville'><p>Liouville copulas</p></a></li>
<li><a href='#Liouville_marginal'><p>Liouville vectors marginal functions</p></a></li>
<li><a href='#negdirspecdens'><p>Spectral density of scaled negative Dirichlet extreme value distribution</p></a></li>
<li><a href='#nutrient'><p>Women daily nutrient intake</p></a></li>
<li><a href='#pickands.liouv'><p>Pickands dependence function for the copula domain of attraction of Liouville survival copulas</p></a></li>
<li><a href='#pickands.plot'><p>Plot Pickands dependence function for CDA of Liouville copulas</p></a></li>
<li><a href='#pliouv.opt'><p>Internal code for the copula likelihood function of Liouville copulas</p></a></li>
<li><a href='#rarchi'><p>Archimedean copula sampler</p></a></li>
<li><a href='#sliouv'><p>Joint survival function of Liouville vectors</p></a></li>
<li><a href='#sliouv_m'><p>Multiple marginal survival function for Liouville vectors</p></a></li>
<li><a href='#theta.bci'><p>Parametric bootstrap confidence interval for the parameter <code>theta</code> for Liouville copula</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Liouville Copulas</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Collections of functions allowing random number generations and
    estimation of 'Liouville' copulas, as described in Belzile and Neslehova (2017) &lt;<a href="https://doi.org/10.1016%2Fj.jmva.2017.05.008">doi:10.1016/j.jmva.2017.05.008</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lbelzile/lcopula/issues">https://github.com/lbelzile/lcopula/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.4), utils, graphics, stats</td>
</tr>
<tr>
<td>Depends:</td>
<td>copula (&ge; 0.999-12), R (&ge; 2.12.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>wdm</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-05 14:54:13 UTC; lbelzile</td>
</tr>
<tr>
<td>Author:</td>
<td>Leo Belzile <a href="https://orcid.org/0000-0002-9135-014X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Christian Genest [aut, ctb],
  Alexander J. McNeil [ctb],
  Johanna G. Neslehova [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leo Belzile &lt;belzilel@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-05 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='lcopula-package'>
Liouville Copulas
</h2><span id='topic+lcopula-package'></span><span id='topic+lcopula'></span>

<h3>Description</h3>

<p><b>lcopula</b> provides functions to evaluate and sample Liouville copulas. The code is adapted from <code>GumbelLiouville.R</code> used in Genest and Neslehova (2013) and from the routines in <code>LiouvilleFunction.R</code> used by McNeil and Neslehova (2010) and coded by Alexander McNeil. The new implementation draws heavily on functions implemented in the <code>copula</code> package and derived from work by Hofert, Maechler and McNeil (2012).
</p>
<p><em>Warning</em>: a different definition is used by the latter and in the <code>copula</code> package for the Clayton copula. The implementation below uses the generator definition found in the first edition of the book <em>Quantitative Risk Management</em>.
</p>
<p>The naming conventions are as follows: <code>'archi'</code> and <code>'liouv'</code> denote cores, prefixes <code>'d'</code>, <code>'p'</code>, <code>'r'</code>, <code>'s'</code>, <code>'is'</code> denote respectively density, distribution function, random number generation, survival function and inverse survival function. Suffixes are <code>'m'</code> for marginal, <code>'_m'</code> for simultaneous multiple margins and <code>'_p'</code> for vectorized versions of the functions.
</p>
<p>The functions mostly draws from the theory laid out in McNeil and Neslehova (2010) and Belzile (2014), which are the references for definitions and expressions.
</p>
<p>The Archimedean families implemented are Clayton, Gumbel, Frank, Ali-Mikhail-Haq (abbreviated AMH) and Joe.  Random number generation from the copulae is available via the function <code>rliouv</code>. Method-of-moment estimators can be used for fitting for the Clayton and Gumbel families for bivariate samples, using the function <code>liouv.maxim.mm</code>. More general models can be fitted using <code>liouv.maxim</code>, but optimization may be slow. The function <code>theta.bci</code> allows to construct bootstrap confidence interval for the parameter <code class="reqn">\theta</code>. Unless the method-of-moment estimator can be used, it is very slow since it relies on full optimization of each replicated sample under the model. 
</p>
<p>The copula and survival copula domains of attraction are implemented and the corresponding spectral density and Pickands dependence function can be computed and plotted in the bivariate case.
</p>


<h3>Author(s)</h3>

<p>Leo Belzile, using routines from Pr. Alexander J. McNeil, Pr. Johanna G. Neslehova. 
The <code>K.plot</code> was adapted from code provided by Pr. Christian Genest.
</p>
<p>Maintainer: Leo Belzile &lt;belzilel@gmail.com&gt;
</p>


<h3>References</h3>

<p>McNeil A.J. and Neslehova, J.G. (2010)
From Archimedean to Liouville Copulas.
<em>J. Multivar. Anal.</em>, <b>101</b>(8): 1772&ndash;1790.
</p>
<p>Belzile L.R. (2014) 
Extremal and inferential properties of Liouville copulas. 
Master thesis, McGill.
</p>
<p>Hofert, M., Maechler, M., and McNeil, A.J. (2012)
Likelihood inference for Archimedean copulas in high dimensions under known margins. 
<em>J. Multivar. Anal.</em>, <b>110</b>, 133&ndash;150.
</p>
<p>Genest, C. and Neslehova, J.G. (2013)
Assessing and Modeling Asymmetry in Bivariate Continuous Data. 
In P. Jaworski, F. Durante, and W.K. Hardle (Eds.), 
Copulae in Mathematical and Quantitative Finance, Lecture Notes in Statistics, 91&ndash;114, Springer: Berlin Heidelberg. 
</p>
<p>Belzile, L.R. and Neslehova, J.G. (2017), Extremal attractors of Liouville copulas, 
<em>J. Multivar. Anal.</em>, <b>160</b>, 68&ndash;92.
</p>


<h3>See Also</h3>

<p><code><a href="copula.html#topic+copula-package">copula</a></code> package
</p>

<hr>
<h2 id='.ctspecdens'>Spectral density of Coles and Tawn extreme value distribution</h2><span id='topic+.ctspecdens'></span>

<h3>Description</h3>

<p>Spectral density of Coles and Tawn extreme value distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ctspecdens(param, dat, transform = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".ctspecdens_+3A_param">param</code></td>
<td>
<p>vector containing the parameters <code class="reqn">\alpha</code>.</p>
</td></tr>
<tr><td><code id=".ctspecdens_+3A_dat">dat</code></td>
<td>
<p>matrix of pseudo-dat, of dimension <code class="reqn">d</code></p>
</td></tr>
<tr><td><code id=".ctspecdens_+3A_transform">transform</code></td>
<td>
<p>logical indicating whether parameters are on the log scale. Default to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value of the log likelihood for a sample of size <code>n</code>
</p>

<hr>
<h2 id='.liouv.iTau_s'>Moment estimate for <code>theta</code> derived from Kendall's <code class="reqn">\tau</code></h2><span id='topic+.liouv.iTau_s'></span>

<h3>Description</h3>

<p>The moment estimates are based on inversion of the formula Kendall's <code class="reqn">\tau</code> for Clayton or Gumbel Liouville copula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.liouv.iTau_s(tau_hat, family, alphavec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".liouv.iTau_s_+3A_tau_hat">tau_hat</code></td>
<td>
<p>estimated Kendall's <code class="reqn">\tau</code> value from data</p>
</td></tr>
<tr><td><code id=".liouv.iTau_s_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code> or <code>"gumbel"</code></p>
</td></tr>
<tr><td><code id=".liouv.iTau_s_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of theta
</p>

<hr>
<h2 id='.liouv.Tau_s'>Computes Kendall's <code class="reqn">\tau</code> for Clayton or Gumbel Liouville copula</h2><span id='topic+.liouv.Tau_s'></span>

<h3>Description</h3>

<p>The function computes Kendall's <code class="reqn">\tau</code> for the given model, given <code>alphavec</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.liouv.Tau_s(theta, family, alphavec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".liouv.Tau_s_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id=".liouv.Tau_s_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code> or <code>"gumbel"</code></p>
</td></tr>
<tr><td><code id=".liouv.Tau_s_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of <code class="reqn">\tau</code>
</p>

<hr>
<h2 id='.marginCombo'>Rcpp function to compute sum of rows and couple according to alphavec</h2><span id='topic+.marginCombo'></span>

<h3>Description</h3>

<p>Rcpp function to compute sum of rows and couple according to alphavec
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.marginCombo(alphavec, mc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".marginCombo_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
<tr><td><code id=".marginCombo_+3A_mc">mc</code></td>
<td>
<p>a matrix of Archimedean vectors to share of dimension <code>sum(alphavec)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of dimension <code>n</code> by <code>length(alphavec)</code> with combined data
</p>

<hr>
<h2 id='.pickands.dir.uni'>Pickands dependence function for the copula domain of attraction of Liouville survival copulas</h2><span id='topic+.pickands.dir.uni'></span>

<h3>Description</h3>

<p>Pickands dependence function as in <cite>Belzile (2014), Proposition 40 and Example 4</cite>
Returns the Pickands dependence function of the copula domain of attraction
of the survival copula, the scaled Dirichlet extreme value model. Currently only implemented in the bivariate case.
Setting <code>rho=1</code> yields the same output as the function in the <code>evd</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.pickands.dir.uni(t, alpha, rho)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".pickands.dir.uni_+3A_t">t</code></td>
<td>
<p>pseudo-angle in (0,1)</p>
</td></tr>
<tr><td><code id=".pickands.dir.uni_+3A_alpha">alpha</code></td>
<td>
<p>vector of Dirichlet allocations. Currently must be of length 2</p>
</td></tr>
<tr><td><code id=".pickands.dir.uni_+3A_rho">rho</code></td>
<td>
<p>index of regular variation parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of Pickands function for the scaled extremal Dirichlet  model
</p>

<hr>
<h2 id='.pickands.fun.uni'>Pickands dependence function for the copula domain of attraction of Liouville copulas</h2><span id='topic+.pickands.fun.uni'></span>

<h3>Description</h3>

<p>Pickands dependence function as in <cite>Belzile (2014), Proposition 41</cite>
Returns the Pickands dependence function of the copula domain of attraction
of the copula. This is only derived and implemented in the bivariate case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.pickands.fun.uni(t, rho = 0.5, alpha = c(1, 1))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".pickands.fun.uni_+3A_t">t</code></td>
<td>
<p>pseudo-angle in (0,1)</p>
</td></tr>
<tr><td><code id=".pickands.fun.uni_+3A_rho">rho</code></td>
<td>
<p>index of regular variation parameter</p>
</td></tr>
<tr><td><code id=".pickands.fun.uni_+3A_alpha">alpha</code></td>
<td>
<p>vector of Dirichlet allocations. Currently must be of length 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of Pickands function
</p>

<hr>
<h2 id='.pliouv.opt_old'>Old code for the copula likelihood function for Liouville copulas</h2><span id='topic+.pliouv.opt_old'></span>

<h3>Description</h3>

<p>The function is used internally for optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.pliouv.opt_old(theta, data, family, alphavec, MC.approx = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".pliouv.opt_old_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id=".pliouv.opt_old_+3A_data">data</code></td>
<td>
<p>sample matrix from a Liouville copula</p>
</td></tr>
<tr><td><code id=".pliouv.opt_old_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id=".pliouv.opt_old_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
<tr><td><code id=".pliouv.opt_old_+3A_mc.approx">MC.approx</code></td>
<td>
<p>whether to use Monte-Carlo approximation for the inverse survival function (default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of marginal density
</p>

<hr>
<h2 id='airquality'>Daily air pollutant measures in Leeds</h2><span id='topic+airquality'></span>

<h3>Description</h3>

<p>The <code>airquality</code> data frame consists of measurements of pollutants in the city of Leeds. In the saying of Boldi and Davison (2007): 
&quot;The dataset comprise daily series of monitoring measurements of ozone levels (O3), nitrogen dioxide (NO2), nitrogen oxide (NO) and particulate matter (PM10), in the city centre of Leeds, UK, over 1994&ndash;1998. Levels of the gases are measured in parts per billion, and those of PM 10 in micrograms per cubic metre. &quot;
</p>


<h3>Details</h3>

<p>Downloaded from <a href="https://uk-air.defra.gov.uk/">https://uk-air.defra.gov.uk/</a>. (c) Crown 2015 copyright Defra via uk-air.defra.gov.uk, licenced under the Open Government Licence (OGL).
</p>


<h3>References</h3>

<p>Heffernan, J., Tawn, J. (2004)  A conditional approach for multivariate extreme values (with discussion).   <em>J. R. Stat. Soc., Ser. B Stat. Methodol.</em> <b>66</b>(3), 497&ndash;546.
</p>
<p>Sabourin, A. , Naveau, P., Fougeres, A.-L. (2013) Bayesian Model averaging for Multivariate extremes. <em>Extremes</em>, <b>16</b>(3), 325&ndash;350.
</p>
<p>Boldi, M.O., Davison, A.C. (2007)  A mixture model for multivariate extremes. <em>J. R. Stat. Soc., Ser. B Stat. Methodol.</em> <b>69</b>(2), 217&ndash;229.
</p>
<p>Cooley, D., Davis, R., Naveau, P. (2010)  The pairwise beta distribution: A flexible parametric multivariate model for extremes.   <em>J. Multivar. Anal.</em> <b>101</b>(9), 2103&ndash;2117.
</p>

<hr>
<h2 id='danube'>Ranks of preprocessed monthly Danube river flow measurements</h2><span id='topic+danube'></span>

<h3>Description</h3>

<p>The <code>danube</code> dataset contains ranks of base flow observations from the Global River Discharge project of the Oak Ridge National Laboratory Distributed Active Archive Center (ORNL DAAC), a NASA data center. The measurements are monthly average flow rate for two stations situated at Scharding (Austria) on the Inn river and at Nagymaros (Hungary) on the Danube.
The data have been pre-processed to remove any time trend. Specifically, Bacigal et al. (2011) extracted the raw data, and obtain the fast Fourier transformed centered observations. The negative spectrum is retained and a linear time series model with 12 seasonal components is fitted. Residuals are then extracted and AR model fitted to the series, the selection being done based on the AIC criterion with imposed maximum order of 3 and the number of autoregressive components may differ for each series.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>inn</dt><dd><p>A numeric vector containing the rank of prewhitened level observations of the Inn river at Nagyramos.</p>
</dd>
<dt>donau</dt><dd><p>A numeric vector containing the rank of prewhitened level observations of the Donau river at Scharding.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Vorosmarty, C.J., Fekete, B.M., Tucker, B.A. (1998).   Global River Discharge, 1807&ndash;1991, V. 1.1(RivDIS). Data set.   Available from <code>http://doi.org/10.3334/ORNLDAAC/199</code>
</p>


<h3>References</h3>

<p>Bacigal, T., Jagr, V., Mesiar, R. (2011)  Non-exchangeable random variables, Archimax copulas and their fitting to real data.   <em>Kybernetika</em>, <b>47</b>(4), 519&ndash;531.  
</p>
<p>Genest, C. and Neslehova, J. G. (2013)  Assessing and Modeling Asymmetry in Bivariate Continuous Data.  In P. Jaworski, F. Durante, and W. K. Hardle (Eds.),  Copulae in Mathematical and Quantitative Finance, Lecture Notes in Statistics, 91&ndash;114, Springer: Berlin Heidelberg.
</p>

<hr>
<h2 id='dirspecdens'>Spectral density of scaled Dirichlet and negative Dirichlet extreme value distributions</h2><span id='topic+dirspecdens'></span>

<h3>Description</h3>

<p>Spectral density of scaled Dirichlet and negative Dirichlet extreme value distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dirspecdens(param, dat, d, transform = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dirspecdens_+3A_param">param</code></td>
<td>
<p>vector containing the parameters <code class="reqn">\alpha</code> and <code class="reqn">\rho</code>, in this order.</p>
</td></tr>
<tr><td><code id="dirspecdens_+3A_dat">dat</code></td>
<td>
<p>matrix of Frechet or Pareto observations, of dimension <code class="reqn">n</code> by <code class="reqn">d</code>.</p>
</td></tr>
<tr><td><code id="dirspecdens_+3A_d">d</code></td>
<td>
<p>dimension of model</p>
</td></tr>
<tr><td><code id="dirspecdens_+3A_transform">transform</code></td>
<td>
<p>logical indicating whether parameters are on the log scale. Default to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is provided as a wrapper and takes parameters on the log scale for <code class="reqn">\alpha</code> (<code class="reqn">\rho</code>).
</p>


<h3>Value</h3>

<p>the log-likelihood for the <code>n</code> sample
</p>

<hr>
<h2 id='express_coef_clayton'>Clayton coefficient for Kendall's tau formula</h2><span id='topic+express_coef_clayton'></span>

<h3>Description</h3>

<p>The function is used internally in <cite>liouv.Tau</cite>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>express_coef_clayton(i, j, theta, a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="express_coef_clayton_+3A_i">i</code></td>
<td>
<p>first index</p>
</td></tr>
<tr><td><code id="express_coef_clayton_+3A_j">j</code></td>
<td>
<p>second index</p>
</td></tr>
<tr><td><code id="express_coef_clayton_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id="express_coef_clayton_+3A_a">a</code></td>
<td>
<p><code class="reqn">L_1</code>-norm of Dirichlet allocation vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Clayton coefficient
</p>

<hr>
<h2 id='express_coef_gumb'>Gumbel coefficient for Kendall's tau formula</h2><span id='topic+express_coef_gumb'></span>

<h3>Description</h3>

<p>The function is used internally in <cite>liouv.Tau</cite>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>express_coef_gumb(index_k, index_l, theta, a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="express_coef_gumb_+3A_index_k">index_k</code></td>
<td>
<p>first index</p>
</td></tr>
<tr><td><code id="express_coef_gumb_+3A_index_l">index_l</code></td>
<td>
<p>second index</p>
</td></tr>
<tr><td><code id="express_coef_gumb_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id="express_coef_gumb_+3A_a">a</code></td>
<td>
<p>sum of alphavec</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Gumbel coefficient
</p>

<hr>
<h2 id='H_inv'>Inverse survival function if Monte-Carlo approximation is set to <code>TRUE</code> in <code>liouv.maxim</code></h2><span id='topic+H_inv'></span>

<h3>Description</h3>

<p>The function is used internally for optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H_inv(u, alphavec, family, theta, MC = 100000L, TRUNC = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="H_inv_+3A_u">u</code></td>
<td>
<p>data at which to compute the survival inverse</p>
</td></tr>
<tr><td><code id="H_inv_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
<tr><td><code id="H_inv_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="H_inv_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id="H_inv_+3A_mc">MC</code></td>
<td>
<p>number of Monte-Carlo points for evaluation</p>
</td></tr>
<tr><td><code id="H_inv_+3A_trunc">TRUNC</code></td>
<td>
<p>whether to truncate at low quantile. Will be based on numerical root finding for the lower 0.025 fraction of the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Inverse survival function values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
u &lt;- rliouv(n = 100, family = "frank", alphavec &lt;- c(2,3), theta = 1)
H_inv(u=u, family="frank", alphavec=c(2,3), theta=2)
#Difference between true value and approximation (can be large depending on family)
sum(abs(H_inv(u=u, family="frank", alphavec=c(2,3), theta=2)-
isliouv_m(u=u, family="frank", alphavec=c(2,3), theta=2)))

## End(Not run)
</code></pre>

<hr>
<h2 id='hmvevdliouv'>Spectral density of the CDA of survival copula and copula of Liouville vectors</h2><span id='topic+hmvevdliouv'></span>

<h3>Description</h3>

<p>Computes the Liouville EV model or the scaled Dirichlet EV model spectral density
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmvevdliouv(w, alpha, rho, CDA = c("C", "S"), logdensity = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hmvevdliouv_+3A_w">w</code></td>
<td>
<p>matrix of points in the unit simplex at which to evaluate the density</p>
</td></tr>
<tr><td><code id="hmvevdliouv_+3A_alpha">alpha</code></td>
<td>
<p>vector of Dirichlet allocations (strictly positive).</p>
</td></tr>
<tr><td><code id="hmvevdliouv_+3A_rho">rho</code></td>
<td>
<p>parameter of limiting model corresponding to index of regular variation</p>
</td></tr>
<tr><td><code id="hmvevdliouv_+3A_cda">CDA</code></td>
<td>
<p>copula domain of attraction of either the Liouville copula, <code>C</code>, or its survival copula <code>S</code></p>
</td></tr>
<tr><td><code id="hmvevdliouv_+3A_logdensity">logdensity</code></td>
<td>
<p>logical; whether to return the log density or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with the same number of rows as <code>w</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hmvevdliouv(seq(0.01,0.99,by=0.01), alpha=c(1,2), rho=0.2, CDA="C")
hmvevdliouv(seq(0.01,0.99,by=0.01), alpha=c(0.1,2), rho=0.2, CDA="S")
hmvevdliouv(seq(0.01,0.99,by=0.01), alpha=c(1,2), rho=0.2, CDA="S")
</code></pre>

<hr>
<h2 id='isliouv_m'>Multiple marginal inverse survival function of Liouville vectors</h2><span id='topic+isliouv_m'></span>

<h3>Description</h3>

<p>This function is a wrapper around <code><a href="#topic+isliouvm">isliouvm</a></code>; it allows the user to treat all the data matrix simultaneously
by applying different parameters to each margin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isliouv_m(u, family, alphavec, theta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isliouv_m_+3A_u">u</code></td>
<td>
<p>vector of survival probabilities</p>
</td></tr>
<tr><td><code id="isliouv_m_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="isliouv_m_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
<tr><td><code id="isliouv_m_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of same length as <code>u</code> with the quantile at 1-u
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u &lt;- rliouv(n = 10, family = "clayton", alphavec &lt;- c(2,3), theta = 2)
isliouv_m(u=u, family="clayton", alphavec=c(2,3), theta=2)
</code></pre>

<hr>
<h2 id='K.plot'>Kendall plot</h2><span id='topic+K.plot'></span>

<h3>Description</h3>

<p>This function plots the expectation of the order statistics under the null
hypothesis of independence against the ordered empirical copula values. The
data is transformed to ranks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>K.plot(data, add = F, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="K.plot_+3A_data">data</code></td>
<td>
<p>a <code>n</code> by <code>d</code> matrix of observations</p>
</td></tr>
<tr><td><code id="K.plot_+3A_add">add</code></td>
<td>
<p>whether to superimpose lines to an existing graph. Default to <code>F</code></p>
</td></tr>
<tr><td><code id="K.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>points</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses <code>integrate</code> and may fail for large <code>d</code> or large <code>n</code>. If <code class="reqn">n&gt;200</code>, the fallback is to generate
a corresponding sample of uniform variates and to compare the empirical copula of the sample generated under the null hypothesis with the one
obtained from the sample.
</p>


<h3>Value</h3>

<p>The Kendall plot corresponding to the data at hand
</p>


<h3>Author(s)</h3>

<p>Pr. Christian Genest (the code was adapted for the multivariate case)
</p>


<h3>References</h3>

<p>Genest &amp; Boies (2003). Detecting Dependence with Kendall Plots, <em>The American Statistician</em>, <b>57</b>(4), 275&ndash;284.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Independence
K.plot(matrix(runif(2000),ncol=2))
#Negative dependence
K.plot(rCopula(n=1000,claytonCopula(param=-0.5,dim=2)),add=TRUE,col=2)
#Perfect negative dependence
K.plot(rCopula(n=1000,claytonCopula(param=-1,dim=2)),add=TRUE,col=6)
#Positive dependence
K.plot(rCopula(n=1000,claytonCopula(param=iTau(claytonCopula(0.3),0.5),dim=2)),add=TRUE,col=3)
#Perfect positive dependence
K.plot(rCopula(n=1000,claytonCopula(param=iTau(claytonCopula(0.3),1),dim=2)),add=TRUE,col=4)
</code></pre>

<hr>
<h2 id='liouv.iTau'>Moment estimate for theta derived from Kendall's tau formula</h2><span id='topic+liouv.iTau'></span>

<h3>Description</h3>

<p>The moment estimates are based on inversion of the formula Kendall's tau for Clayton or Gumbel Liouville copula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>liouv.iTau(tau_hat, family, alphavec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="liouv.iTau_+3A_tau_hat">tau_hat</code></td>
<td>
<p>estimated vector of Kendall's tau values</p>
</td></tr>
<tr><td><code id="liouv.iTau_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code> or <code>"gumbel"</code></p>
</td></tr>
<tr><td><code id="liouv.iTau_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of theta
</p>


<h3>Examples</h3>

<pre><code class='language-R'>liouv.iTau(0.5,family="gumbel", c(1,2))
liouv.iTau(0.5,family="clayton", c(3,2))
</code></pre>

<hr>
<h2 id='liouv.maxim'>Maximization of  Liouville copula likelihood function</h2><span id='topic+liouv.maxim'></span><span id='topic+liouv.maxim.mm'></span>

<h3>Description</h3>

<p>Two methods, either numerical optimization or method-of-moments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>liouv.maxim(
  data,
  family,
  interval,
  boundary = NULL,
  lattice.mat = NULL,
  return_all = FALSE,
  MC.approx = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="liouv.maxim_+3A_data">data</code></td>
<td>
<p>sample matrix from a Liouville copula</p>
</td></tr>
<tr><td><code id="liouv.maxim_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="liouv.maxim_+3A_interval">interval</code></td>
<td>
<p>interval over which to look for <code>theta</code> (bounds for Nelder-Mead)</p>
</td></tr>
<tr><td><code id="liouv.maxim_+3A_boundary">boundary</code></td>
<td>
<p>vector of endpoints for search of Dirichlet allocation parameters. Either <code>boundary</code> or <code>lattice.mat</code> can be supplied</p>
</td></tr>
<tr><td><code id="liouv.maxim_+3A_lattice.mat">lattice.mat</code></td>
<td>
<p>matrix of tuples of Dirichlet allocation parameters at which to evaluate the likelihood</p>
</td></tr>
<tr><td><code id="liouv.maxim_+3A_return_all">return_all</code></td>
<td>
<p>should all results (as list) or only maximum value be returned. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="liouv.maxim_+3A_mc.approx">MC.approx</code></td>
<td>
<p>whether to use Monte-Carlo approximation for the inverse survival function (default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A wrapper to <code>optim</code> using the Nelder-Mead algorithm or using the methods of moments,
to maxime pointwise given every <code>alphavec</code> over a grid.
Returns the maximum for <code>alphavec</code> and <code>theta</code>.
</p>


<h3>Value</h3>

<p>a list with values of <code>theta</code> and Dirichlet parameter along with maximum found. Gives index of maximum amongst models fitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 data &lt;- rliouv(n=100, family="joe", alphavec=c(1,2), theta=2)
 liouv.maxim(data=data, family="j", interval=c(1.25,3), boundary=c(2,2),return_all=TRUE)
 lattice.mat &lt;- t(combn(1:3,2))
 liouv.maxim(data=data, family="j", interval=c(1.25,3), lattice.mat=lattice.mat, return_all=FALSE)
 #data &lt;- rliouv(n=1000, family="gumbel", alphavec=c(1,2), theta=2)
 liouv.maxim.mm(data=data, family="gumbel", boundary=c(3,3),return_all=TRUE)
 lattice.mat &lt;- t(combn(1:3,2))
 liouv.maxim.mm(data=data, family="gumbel", lattice.mat=lattice.mat, return_all=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='liouv.Tau'>Computes Kendall's tau for Clayton or Gumbel Liouville copula</h2><span id='topic+liouv.Tau'></span>

<h3>Description</h3>

<p>The function computes Kendall's <code class="reqn">\tau</code> for the given model, given <code>alphavec</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>liouv.Tau(theta, family, alphavec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="liouv.Tau_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id="liouv.Tau_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code> or <code>"gumbel"</code></p>
</td></tr>
<tr><td><code id="liouv.Tau_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of <code class="reqn">\tau</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>liouv.Tau(theta=2, family="gumbel", alphavec=c(1,2))
liouv.Tau(theta=1, family="clayton", alphavec=c(2,1))
</code></pre>

<hr>
<h2 id='Liouville'>Liouville copulas</h2><span id='topic+Liouville'></span><span id='topic+rliouv'></span><span id='topic+pliouv'></span><span id='topic+dliouv'></span>

<h3>Description</h3>

<p>Multivariate density, survival copula
and random generation for the Liouville copulas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rliouv(n = 100, family, alphavec, theta, reverse = FALSE)

pliouv(x, theta, family, alphavec)

dliouv(x, family, alphavec, theta, is.log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Liouville_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="Liouville_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="Liouville_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers) Specifies (implictly) the dimension of sample</p>
</td></tr>
<tr><td><code id="Liouville_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id="Liouville_+3A_reverse">reverse</code></td>
<td>
<p>if <code>TRUE</code>, return sample from the corresponding survival copula</p>
</td></tr>
<tr><td><code id="Liouville_+3A_x">x</code></td>
<td>
<p>matrix of quantiles from a Liouville copula</p>
</td></tr>
<tr><td><code id="Liouville_+3A_is.log">is.log</code></td>
<td>
<p>if <code>TRUE</code>, will return the log-likelihood value</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rliouv</code> generates draws from the Liouville copula. <code>dliouv</code> evaluates the density of an <code>n</code> by <code>d</code> matrix of observations. <code>pliouv</code> is the (survival) copula associated with the Liouville vector and is as such the multivariate distribution function for uniform observations.
</p>
<p>Liouville copulas were introduced in McNeil and Neslehova (2010), generalizing Archimedean copulas. Like the latter, they
are survival copulas, which means that the copula is evaluated using the (multivariate) survival function of Liouville vectors. See also <code><a href="#topic+sliouv">sliouv</a></code> for the latter.
</p>
<p>The Liouville copula is by definition a survival copula. The function thus
maps marginally observations from the unit interval to the positive half-line using the marginal inverse
survival function <code><a href="#topic+isliouvm">isliouvm</a></code> of the Liouville vector, and then evaluating the survival
distribution at the resulting Liouville vector.
</p>


<h3>Value</h3>

<p>either a matrix of dimension <code>n</code> by <code>length(alphavec)</code>  with the corresponding quantile, probability, survival probability or sample from the Liouville vector
</p>


<h3>References</h3>

<p>McNeil A.J. and Neslehova, J.G. (2010) From Archimedean to Liouville Copulas. <em>J. Multivar. Anal.</em>, <strong>101</strong>(8): 1772&ndash;1790.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Liouville_marginal">Liouville_marginal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Multivariate density of Clayton Liouville copula
x &lt;- rliouv(n = 100, family = "clayton", alphavec &lt;- c(2,3), theta = 2)
dliouv(x=x, family="clayton", alphavec=c(2,3), theta=2, TRUE)
#Distribution function, multivariate sample
x &lt;- rliouv(n=100, family="frank", theta=1.5, alphavec=c(2,3))
pliouv(theta=1.5, x=x,family="frank", alphavec=c(2,3))

## End(Not run)
</code></pre>

<hr>
<h2 id='Liouville_marginal'>Liouville vectors marginal functions</h2><span id='topic+Liouville_marginal'></span><span id='topic+sliouvm'></span><span id='topic+pliouvm'></span><span id='topic+dliouvm'></span><span id='topic+isliouvm'></span>

<h3>Description</h3>

<p>Marginal density, distribution, survival and inverse survival functions for Liouville copulas or Liouville vectors.
The inverse survival function of Liouville vectors is not available in closed-form and is obtained numerically by root-finding.
As such, Monte-Carlo approximation have been considered for dealing with inference to avoid computational bottlenecks.
Note: the arguments of <code>sliouv</code> are reversed since they are meant to be called inside <code>optim</code>. The functions borrow
<code class="reqn">psi</code> functions and their derivatives from the <code><a href="copula.html#topic+copula-package">copula-package</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sliouvm(x, family, alpha, theta)

pliouvm(x, family, alpha, theta)

isliouvm(u, family, alpha, theta)

dliouvm(x, family, alpha, theta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Liouville_marginal_+3A_x">x</code></td>
<td>
<p>vector of quantiles from a Liouville copula (or a Liouville vector for the survival function , with support on the positive real line)</p>
</td></tr>
<tr><td><code id="Liouville_marginal_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="Liouville_marginal_+3A_alpha">alpha</code></td>
<td>
<p>integer Dirichlet parameter</p>
</td></tr>
<tr><td><code id="Liouville_marginal_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id="Liouville_marginal_+3A_u">u</code></td>
<td>
<p>vector of quantiles or survival probabilities, (pseudo)-uniform variates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector  with the corresponding quantile, probability, survival probabilities
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Marginal density
samp &lt;- rliouv(n = 100, family = "clayton", alphavec &lt;- c(2,3), theta = 2)
dliouvm(x=samp[,1], family="clayton", alpha=2, theta=2)
sum(log(dliouvm(x=samp[,1], family="clayton", alpha=2, theta=2)))
#Marginal distribution and (inverse) survival function
x &lt;- rliouv(n = 100, family = "gumbel", alphavec &lt;- c(2,3), theta = 2)
pliouvm(x[,1], family="gumbel", alpha=alphavec[1], theta=2)
su &lt;- sliouvm(1-x[,1], family="gumbel", alpha=alphavec[1], theta=2)
isliouvm(u=su, family="clayton", alpha=2, theta=2)
#pliouv is the same as sliouv(isliouvm)

## End(Not run)
</code></pre>

<hr>
<h2 id='negdirspecdens'>Spectral density of scaled negative Dirichlet extreme value distribution</h2><span id='topic+negdirspecdens'></span>

<h3>Description</h3>

<p>Spectral density of scaled negative Dirichlet extreme value distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>negdirspecdens(param, dat, d, transform = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="negdirspecdens_+3A_param">param</code></td>
<td>
<p>vector containing the parameters <code class="reqn">\alpha</code> and <code class="reqn">\rho</code>, in this order.</p>
</td></tr>
<tr><td><code id="negdirspecdens_+3A_dat">dat</code></td>
<td>
<p>matrix of Frechet or Pareto observations, of dimension <code class="reqn">n</code> by <code class="reqn">d</code>.</p>
</td></tr>
<tr><td><code id="negdirspecdens_+3A_d">d</code></td>
<td>
<p>dimension of model</p>
</td></tr>
<tr><td><code id="negdirspecdens_+3A_transform">transform</code></td>
<td>
<p>logical indicating whether parameters are on the log scale. Default to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is provided as a wrapper and takes parameters on the log scale for <code class="reqn">\alpha</code> and <code class="reqn">\rho</code>.
</p>


<h3>Value</h3>

<p>the log-likelihood for the <code>n</code> sample
</p>

<hr>
<h2 id='nutrient'>Women daily nutrient intake</h2><span id='topic+nutrient'></span>

<h3>Description</h3>

<p>The <code>nutrient</code> data frame consists of quintuples consisting of four day measurements for intake of calcium, iron, protein, vitamin A and C from women aged 25 to 50 in the United States as part of the &quot;Continuing Survey of Food Intakes of Individuals&quot; program. The processed data has
737 measurements from a cohort study of the United States Department of Agriculture (USDA) and it is available online from the University of Pennsylvania repository.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>id</dt><dd><p>A numeric vector containing the identification of the participant.</p>
</dd>
<dt>calcium</dt><dd><p>A numeric vector containing measured calcium.</p>
</dd>
<dt>iron</dt><dd><p>A numeric vector containing iron measurements.</p>
</dd>
<dt>protein</dt><dd><p>A numeric vector containing protein measurements.</p>
</dd>
<dt>vitamin.a</dt><dd><p>A numeric vector containing vitamin A measurements.</p>
</dd>
<dt>vitamin.c</dt><dd><p>A numeric vector containing vitamin C measurements.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The survey data was processed by Dr. Andrew Wiesner for a course on multivariate statistics at The Pennsylvania State University.
</p>


<h3>References</h3>

<p>Genest, C., Neslehova, J., Quessy, J.-F. (2012)  Tests of symmetry for bivariate copulas.   <em>Annals of the Institute of Statistical Mathematics</em>, <b>64</b>(4), 811&ndash;834.
</p>
<p>Genest, C. and Neslehova, J. G. (2013)  Assessing and Modeling Asymmetry in Bivariate Continuous Data.   In P. Jaworski, F. Durante, &amp; W. K. Hardle (Eds.),   Copulae in Mathematical and Quantitative Finance, Lecture Notes in Statistics, 91&ndash;114, Springer: Berlin Heidelberg. 
</p>
<p>Li, B., Genton, M. G. (2013) Nonparametric identification of copula structures.  <em>Journal of the American Statistical Association</em>, <b>108</b>(502), 666&ndash;675.
</p>

<hr>
<h2 id='pickands.liouv'>Pickands dependence function for the copula domain of attraction of Liouville survival copulas</h2><span id='topic+pickands.liouv'></span>

<h3>Description</h3>

<p>Pickands dependence function as in <cite>Belzile (2014), Proposition 40 and Example 4</cite> and
<cite>Belzile (2014), Proposition 41</cite>, assuming that the parameter alpha is integer-valued.
Returns the Pickands dependence function of the copula domain of attraction (CDA)
of the survival copula, the scaled Dirichlet extreme value model, or the CDA of the copula, the Liouville EV model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pickands.liouv(t, rho = 0.5, alpha = c(1, 1), CDA = c("C", "S"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pickands.liouv_+3A_t">t</code></td>
<td>
<p>pseudo-angle in (0,1)</p>
</td></tr>
<tr><td><code id="pickands.liouv_+3A_rho">rho</code></td>
<td>
<p>index of regular variation parameter</p>
</td></tr>
<tr><td><code id="pickands.liouv_+3A_alpha">alpha</code></td>
<td>
<p>vector of Dirichlet allocations. Currently must be of length 2</p>
</td></tr>
<tr><td><code id="pickands.liouv_+3A_cda">CDA</code></td>
<td>
<p>select the extremal attractor of the copula (<code>C</code>) or the survival copula (<code>S</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of Pickands function for the scaled Dirichlet EV model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pickands.liouv(seq(0,1,by=0.01),1,c(0.1,0.3),CDA="S")
pickands.liouv(t = seq(0,1,by=0.01), rho = 0.5, alpha = c(1,3), CDA="C")
</code></pre>

<hr>
<h2 id='pickands.plot'>Plot Pickands dependence function for CDA of Liouville copulas</h2><span id='topic+pickands.plot'></span>

<h3>Description</h3>

<p>The function will draw the Pickands dependence function for output in <code>tikz</code> if
the corresponding function is selected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pickands.plot(
  rho,
  alpha,
  plot.new = TRUE,
  CDA = c("C", "S"),
  tikz = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pickands.plot_+3A_rho">rho</code></td>
<td>
<p>index of regular variation parameter</p>
</td></tr>
<tr><td><code id="pickands.plot_+3A_alpha">alpha</code></td>
<td>
<p>vector of Dirichlet allocations. Currently must be of length 2</p>
</td></tr>
<tr><td><code id="pickands.plot_+3A_plot.new">plot.new</code></td>
<td>
<p>boolean indicating whether a new plotting device should be called</p>
</td></tr>
<tr><td><code id="pickands.plot_+3A_cda">CDA</code></td>
<td>
<p>whether to plot Pickands function for the extremal model of the
copula (<code>C</code>) or the survival copula (<code>S</code>), which is the scaled Dirichlet</p>
</td></tr>
<tr><td><code id="pickands.plot_+3A_tikz">tikz</code></td>
<td>
<p>boolean specifying whether to prepare plot for <code>tikz</code> output. Defaults to <code>F</code></p>
</td></tr>
<tr><td><code id="pickands.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>lines</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of the Pickands dependence function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pickands.plot(
  rho = 0.9, 
  alpha = c(1,1), 
  col = "slateblue1", 
  CDA = "C")
pickands.plot(
  rho = 0.9, 
  alpha = c(2,3),
  col = "slateblue2", 
  CDA = "C", 
  plot.new = FALSE)
pickands.plot(
 rho = 0.5, 
 alpha = c(2,3), 
 col = "slateblue3", 
 CDA = "C", 
 plot.new = FALSE)
#Parameters for the Pickands function of the scaled Dirichlet need not be integer
pickands.plot(
  rho = 0.9, 
  alpha = c(1,1), 
  CDA = "S")
pickands.plot(
  rho = 0.9, 
  alpha = c(0.2,0.5), 
  col = "darkred", 
  CDA = "S", 
  plot.new = FALSE)
pickands.plot(
 rho = 0.8, 
 alpha = c(1.2,0.1), 
 col = "red", 
 CDA = "S", 
 plot.new = FALSE)
</code></pre>

<hr>
<h2 id='pliouv.opt'>Internal code for the copula likelihood function of Liouville copulas</h2><span id='topic+pliouv.opt'></span>

<h3>Description</h3>

<p>The function is used internally for optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pliouv.opt(theta, data, family, alphavec, MC.approx = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pliouv.opt_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id="pliouv.opt_+3A_data">data</code></td>
<td>
<p>sample matrix from a Liouville copula</p>
</td></tr>
<tr><td><code id="pliouv.opt_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="pliouv.opt_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
<tr><td><code id="pliouv.opt_+3A_mc.approx">MC.approx</code></td>
<td>
<p>whether to use Monte-Carlo approximation for the inverse survival function (default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of marginal density
</p>

<hr>
<h2 id='rarchi'>Archimedean copula sampler</h2><span id='topic+rarchi'></span>

<h3>Description</h3>

<p>Sampler based on the Marshall-Olkin algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rarchi(n, family, d, theta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rarchi_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="rarchi_+3A_family">family</code></td>
<td>
<p>family of the Archimedean copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="rarchi_+3A_d">d</code></td>
<td>
<p>dimension of sample</p>
</td></tr>
<tr><td><code id="rarchi_+3A_theta">theta</code></td>
<td>
<p>parameter of the Archimedean copula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a sample of dimension <code>n</code> by <code>d</code> from the Archimedean copula
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Sample from a Gumbel Archimedean copula
rarchi(n = 100, "gumbel", d = 4, theta = 2)
#Sample from the independence copula
rarchi(n = 100, "gumbel", d = 4, theta = 1)
</code></pre>

<hr>
<h2 id='sliouv'>Joint survival function of Liouville vectors</h2><span id='topic+sliouv'></span>

<h3>Description</h3>

<p><code>sliouv</code> returns the survival function of a Liouville vector. For the survival copula
and the associated probability, see <code><a href="#topic+pliouv">pliouv</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sliouv(theta, x, family, alphavec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sliouv_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
<tr><td><code id="sliouv_+3A_x">x</code></td>
<td>
<p>an <code>n</code> by <code>d</code> matrix of observations, each on the positive real line</p>
</td></tr>
<tr><td><code id="sliouv_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="sliouv_+3A_alphavec">alphavec</code></td>
<td>
<p><code>d</code>-vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
</table>

<hr>
<h2 id='sliouv_m'>Multiple marginal survival function for Liouville vectors</h2><span id='topic+sliouv_m'></span>

<h3>Description</h3>

<p>This function is a wrapper around <code><a href="#topic+sliouv">sliouv</a></code>; it allows the user to treat all the data matrix simultaneously
by applying different parameters to each margin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sliouv_m(x, family, alphavec, theta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sliouv_m_+3A_x">x</code></td>
<td>
<p>sample from copula</p>
</td></tr>
<tr><td><code id="sliouv_m_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="sliouv_m_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
<tr><td><code id="sliouv_m_+3A_theta">theta</code></td>
<td>
<p>parameter of the corresponding Archimedean copula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of same length as <code>x</code> with the survival probabilities
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rliouv(n = 100, family = "gumbel", alphavec &lt;- c(2,3), theta = 2)
sliouv_m(x, family="gumbel", alphavec=c(2,3), theta=2)
all(sliouv_m(x, family="gumbel", alphavec=c(2,3), theta=2)[,1]-
  sliouvm(x[,1], family="gumbel", alpha=2, theta=2)==0)
</code></pre>

<hr>
<h2 id='theta.bci'>Parametric bootstrap confidence interval for the parameter <code>theta</code> for Liouville copula</h2><span id='topic+theta.bci'></span>

<h3>Description</h3>

<p>The parametric bootstrap provides confidence intervals by repeatedly sampling datasets from the postulated
Liouvilla copula model. If <code class="reqn">d=2</code> and the model is either <code>gumbel</code> or <code>clayton</code>, the value of
Kendall's <code class="reqn">\tau</code> is calculated from the sample, and the confidence interval or the quantiles correspond
to the inverse <code class="reqn">\tau^{-1}(\tau(\theta))</code> for the bootstrap quantile values of <code class="reqn">\tau</code> (using monotonicity).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta.bci(
  B = 1999,
  family,
  alphavec,
  n,
  theta.hat,
  quant = c(0.025, 0.975),
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theta.bci_+3A_b">B</code></td>
<td>
<p>number of bootstrap replicates</p>
</td></tr>
<tr><td><code id="theta.bci_+3A_family">family</code></td>
<td>
<p>family of the Liouville copula. Either <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"AMH"</code> or <code>"joe"</code></p>
</td></tr>
<tr><td><code id="theta.bci_+3A_alphavec">alphavec</code></td>
<td>
<p>vector of Dirichlet allocations (must be a vector of integers)</p>
</td></tr>
<tr><td><code id="theta.bci_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="theta.bci_+3A_theta.hat">theta.hat</code></td>
<td>
<p>estimate of theta</p>
</td></tr>
<tr><td><code id="theta.bci_+3A_quant">quant</code></td>
<td>
<p>if the vector of probability is specified, the function will return the corresponding bootstrap quantiles</p>
</td></tr>
<tr><td><code id="theta.bci_+3A_silent">silent</code></td>
<td>
<p>boolean for output progress. Default is <code>FALSE</code>, which means iterations are printed if <code class="reqn">d&gt;2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Install package <code>wdm</code> to speed up calculation of Kendall's tau.
</p>
<p>Since no closed-form formulas exist for the other models or in higher dimension,
the method is extremely slow since it relies on maximization
of a new sample from the model and look up the corresponding parameters.
</p>


<h3>Value</h3>

<p>a list with a 95
and the bootstrap values of Kendall's tau in <code>boot_tau</code> if <code class="reqn">d=2</code> and the model is either <code>gumbel</code> or <code>clayton</code>.
Otherwise, the list contains <code>boot_theta</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
theta.bci(B=99, family="gumbel", alphavec=c(2,3), n=100, theta.hat=2)
theta.bci(B=19, family="AMH", alphavec=c(1,2), n=100, theta.hat=0.5, quant=c(0.05,0.95))
theta.bci(B=19, family="frank", alphavec=c(1,2,3), n=100, theta.hat=0.5, quant=c(0.05,0.95))

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
