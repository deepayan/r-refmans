<!DOCTYPE html><html><head><title>Help for package GSE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GSE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#auto'><p>Automobile data</p></a></li>
<li><a href='#boston'><p>Boston Housing Data</p></a></li>
<li><a href='#calcium'><p>Calcium data</p></a></li>
<li><a href='#CovEM'><p>Gaussian MLE of mean and covariance</p></a></li>
<li><a href='#CovRobMiss-class'><p> Class &quot;CovRobMiss&quot; &ndash; a superclass for the robust estimates of location and scatter for missing data</p></a></li>
<li><a href='#CovRobMissSc-class'><p> Class &quot;CovRobMissSc&quot; &ndash; a subclass of &quot;CovRobMiss&quot; with scale estimate</p></a></li>
<li><a href='#emve'><p>Extended Minimum Volume Ellipsoid (EMVE) in the presence of missing data</p></a></li>
<li><a href='#emve-class'><p>Extended Minimum Volume Ellipsoid (EMVE) in the presence of missing data.</p></a></li>
<li><a href='#geochem'><p>Geochemical Data</p></a></li>
<li><a href='#get-methods'><p>Accessor methods to the essential slots of classes CovRobMiss, TSGS, GSE, emve, and HuberPairwise</p></a></li>
<li><a href='#GSE'><p> Generalized S-Estimator in the presence of missing data</p></a></li>
<li><a href='#GSE-class'><p>Generalized S-Estimator in the presence of missing data</p></a></li>
<li><a href='#gy.filt'><p>Gervini-Yohai filter for detecting cellwise outliers</p></a></li>
<li><a href='#horse'><p>Horse-colic data</p></a></li>
<li><a href='#HuberPairwise'><p> Quadrant Covariance and Huberized Pairwise Scatter</p></a></li>
<li><a href='#HuberPairwise-class'><p> Quadrant Covariance and Huberized Pairwise Scatter</p></a></li>
<li><a href='#ImpS'><p>Imputed S-estimator</p></a></li>
<li><a href='#partial.mahalanobis'><p>Partial Square Mahalanobis Distance</p></a></li>
<li><a href='#plot-methods'><p>Plot methods for objects of class 'CovRobMiss'</p></a></li>
<li><a href='#simulation-tools'><p>Data generator for simulation study on cell- and case-wise contamination</p></a></li>
<li><a href='#slrt'><p>LRT-based distances between matrices</p></a></li>
<li><a href='#SummaryCovGSE-class'><p>Class &quot;SummaryCovGSE&quot; - displaying summary of &quot;CovRobMiss&quot; objects</p></a></li>
<li><a href='#TSGS'><p>Two-Step Generalized S-Estimator for cell- and case-wise outliers</p></a></li>
<li><a href='#TSGS-class'><p>Two-Step Generalized S-Estimator for cell- and case-wise outliers</p></a></li>
<li><a href='#wages'><p>Wages and Hours</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Estimation in the Presence of Cellwise and Casewise
Contamination and Missing Data</td>
</tr>
<tr>
<td>Version:</td>
<td>4.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-12-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Andy Leung, Mike Danilov, Victor Yohai, Ruben Zamar</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Claudio Agostinelli &lt;claudio.agostinelli@unitn.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Robust Estimation of Multivariate Location and Scatter in the
        Presence of Cellwise and Casewise Contamination and Missing Data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), Rcpp (&ge; 0.10.0), MASS</td>
</tr>
<tr>
<td>Imports:</td>
<td>rrcov, robustbase, cellWise, ggplot2, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-13 08:13:58 UTC; claudio</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-13 09:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='auto'>Automobile data</h2><span id='topic+auto'></span>

<h3>Description</h3>

<p>This data set is taken from UCI repository, see reference. Past usage includes price prediction of cars using 
all numeric and boolean attributes (Kibler et al., 1989).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(auto)</code></pre>


<h3>Format</h3>

<p>A data frame with 205 observations on the following 26 variables, of which 15 are quantitative and 11 are categorical. The following description is extracted
from UCI repository (Frank and Asuncion, 2010):  
</p>

<table>
<tr>
 <td style="text-align: left;">
		<code>Normalized-losses</code> </td><td style="text-align: left;"> the relative average loss payment per insured vehicle year; ranged from 65 to 256 </td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Make</code> </td><td style="text-align: left;"> Vehicle's make</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Fuel-type</code> </td><td style="text-align: left;"> diesel, gas</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Aspiration</code> </td><td style="text-align: left;"> std, turbo</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Num-of-doors</code> </td><td style="text-align: left;"> four, two</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Body-style</code> </td><td style="text-align: left;"> hardtop, wagon, sedan, hatchback, convertible</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Drive-wheels</code> </td><td style="text-align: left;"> 4wd, fwd, rwd</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Engine-location</code> </td><td style="text-align: left;"> front, rear</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Wheel-base</code> </td><td style="text-align: left;"> continuous from 86.6 120.9</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Length</code> </td><td style="text-align: left;"> continuous from 141.1 to 208.1</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Width</code> </td><td style="text-align: left;"> continuous from 60.3 to 72.3</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Height</code> </td><td style="text-align: left;"> continuous from 47.8 to 59.8</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Curb-weight</code> </td><td style="text-align: left;"> continuous from 1488 to 4066</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Engine-type</code> </td><td style="text-align: left;"> dohc, dohcv, l, ohc, ohcf, ohcv, rotor</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Num-of-cylinders</code> </td><td style="text-align: left;"> eight, five, four, six, three, twelve, two</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Engine-size</code> </td><td style="text-align: left;"> continuous from 61 to 326</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Fuel-system</code> </td><td style="text-align: left;"> 1bbl, 2bbl, 4bbl, idi, mfi, mpfi, spdi, spfi</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Bore</code> </td><td style="text-align: left;"> continuous from 2.54 to 3.94</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Stroke</code> </td><td style="text-align: left;"> continuous from 2.07 to 4.17</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Compression-ratio</code> </td><td style="text-align: left;"> continuous from 7 to 23</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Horsepower</code> </td><td style="text-align: left;"> continuous from 48 to 288</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Peak-rpm</code> </td><td style="text-align: left;"> continuous from 4150 to 6600</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>City-mpg</code> </td><td style="text-align: left;"> continuous from 13 to 49</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Highway-mpg</code> </td><td style="text-align: left;"> continuous from 16 to 54</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Price</code> </td><td style="text-align: left;"> continuous from 5118 to 45400</td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>Symboling</code> </td><td style="text-align: left;"> assigned insurance risk rating: -3, -2, -1, 0, 1, 2, 3</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Source</h3>

<p>The original data have been taken from the UCI Repository Of Machine Learning
Databases at
</p>

<ul>
<li> <p><a href="http://archive.ics.uci.edu/ml/datasets/Automobile">http://archive.ics.uci.edu/ml/datasets/Automobile</a>.
</p>
</li></ul>
  


<h3>References</h3>

<p>Frank, A. &amp; Asuncion, A. (2010). UCI Machine Learning Repository [http://archive.ics.uci.edu/ml]. 
Irvine, CA: University of California, School of Information and Computer Science.
</p>
<p>Kibler, D., Aha, D.W., &amp; Albert,M. (1989). Instance-based prediction of real-valued attributes. Computational Intelligence, Vol 5, 51&ndash;57. 
</p>

<hr>
<h2 id='boston'>Boston Housing Data</h2><span id='topic+boston'></span>

<h3>Description</h3>

<p>Housing data for 506 census tracts of Boston from the 1970
census. The dataframe <code>boston</code> contains the corrected data by Harrison and
Rubinfeld (1979). The data was for a few minor errors and augmented with the 
latitude and longitude of the observations.
The original data can be found in the references below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(boston) </code></pre>


<h3>Format</h3>

<p>The original data are 506 observations on 14 variables,
<code>medv</code> being the target variable:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>cmedv</code> </td><td style="text-align: left;"> corrected median value of owner-occupied homes in USD 1000's </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>crim</code> </td><td style="text-align: left;"> per capita crime rate by town </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>indus</code> </td><td style="text-align: left;"> proportion of non-retail business acres per town </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>nox</code> </td><td style="text-align: left;"> nitric oxides concentration (parts per 10 million) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>rm</code> </td><td style="text-align: left;"> average number of rooms per dwelling </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>age</code> </td><td style="text-align: left;"> proportion of owner-occupied units built prior to 1940 </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>dis</code> </td><td style="text-align: left;"> weighted distances to five Boston employment centres </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>rad</code> </td><td style="text-align: left;"> index of accessibility to radial highways </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>tax</code> </td><td style="text-align: left;"> full-value property-tax rate per USD 10,000 </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ptratio</code> </td><td style="text-align: left;"> pupil-teacher ratio by town </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>b</code> </td><td style="text-align: left;"> <code class="reqn">1000(B - 0.63)^2</code> where <code class="reqn">B</code> is the proportion of blacks by town</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>lstat</code> </td><td style="text-align: left;"> percentage of lower status of the population </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Source</h3>

<p>The original data have been taken from the UCI Repository Of Machine Learning
Databases at
</p>

<ul>
<li> <p><a href="http://www.ics.uci.edu/~mlearn/MLRepository.html">http://www.ics.uci.edu/~mlearn/MLRepository.html</a>,
</p>
</li></ul>

<p>the corrected data have been taken from Statlib at
</p>

<ul>
<li> <p><a href="https://dasl.datadescription.com/">https://dasl.datadescription.com/</a> (originally downloaded from lib.stat.cmu.edu/DASL/)
</p>
</li></ul>

<p>See Statlib and references there for details on the corrections.
Both were converted to R format by Friedrich Leisch.
</p>


<h3>References</h3>

  
<p>Harrison, D. and Rubinfeld, D.L. (1978).
Hedonic prices and the demand for clean air.
<em>Journal of Environmental Economics and Management</em>, <b>5</b>,
81&ndash;102.
</p>
<p>Gilley, O.W., and R. Kelley Pace (1996). On the Harrison and Rubinfeld  
Data. <em>Journal of Environmental Economics and Management</em>, <b>31</b>,  
403&ndash;405. [Provided corrections and examined censoring.]
</p>
<p>Newman, D.J. &amp; Hettich, S. &amp; Blake, C.L. &amp; Merz, C.J. (1998).
UCI Repository of machine learning databases
[http://www.ics.uci.edu/~mlearn/MLRepository.html]. Irvine, CA:
University of California, Department of Information and Computer
Science.
</p>
<p>Pace, R. Kelley, and O.W. Gilley (1997). Using the Spatial Configuration of  
the Data to Improve Estimation. <em>Journal of the Real Estate Finance  
and Economics</em>, <b>14</b>, 333&ndash;340. [Added georeferencing and spatial
estimation.]
</p>

<hr>
<h2 id='calcium'>Calcium data</h2><span id='topic+calcium'></span>

<h3>Description</h3>

<p>The Calcium data is from the article by Holcomb and Spalsbury (2005). The dataset used for
class was compiled by Boyd, Delost, and Holcomb (1998) for the use of a study to determine if
significant gender differences existed between subjects 65 years of age and older with regard to
calcium, inorganic phosphorous, and alkaline phosphatase levels. Although the original data from
Boyd, Delost, and Holcomb (1998) had observations needing investigation, Holcomb and Spalsbury
(2005) further massaged the original data to include data problems and issues that have arisen in
other research projects for pedagogical purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(calcium)</code></pre>


<h3>Format</h3>

<p>A data frame with 178 observations on the following 8 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
		<code>obsno</code> </td><td style="text-align: left;"> Patient Observation Number </td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>age</code> </td><td style="text-align: left;"> Age in years </td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>sex</code> </td><td style="text-align: left;"> 1=Male, 2=Female </td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>alkphos</code> </td><td style="text-align: left;"> Alkaline Phosphatase International Units/Liter </td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>lab</code> </td><td style="text-align: left;"> 1=Metpath; 2=Deyor; 3=St. Elizabeth's; 4=CB Rouche; 5=YOH; 6=Horizon </td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>cammol</code> </td><td style="text-align: left;"> Calcium mmol/L </td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>phosmmol</code> </td><td style="text-align: left;"> Inorganic Phosphorus mmol/L </td>
</tr>
<tr>
 <td style="text-align: left;">
		<code>agegroup</code> </td><td style="text-align: left;"> Age group 1=65-69; 2=70-74; 3=75-79; 4=80-84; 5=85-89 Years </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Source</h3>

<p>The original data have been taken from the Journal of Statistics Education
Databases at
</p>

<ul>
<li> <p><a href="http://jse.amstat.org/datasets/calcium.dat.txt">http://jse.amstat.org/datasets/calcium.dat.txt</a> (originally downloaded from www.amstat.org/publications/jse/datasets/calcium.dat.txt),
</p>
</li></ul>

<p>the corrected data have been taken from Statlib at
</p>

<ul>
<li> <p><a href="http://jse.amstat.org/datasets/calciumgood.dat.txt">http://jse.amstat.org/datasets/calciumgood.dat.txt</a> (originally downloaded from www.amstat.org/publications/jse/datasets/calciumgood.dat.txt)
</p>
</li></ul>



<h3>References</h3>

<p>Boyd, J., Delost, M., and Holcomb, J., (1998). Calcium, phosphorus, 
and alkaline phosphatase laboratory values of elderly subjects, 
<em>Clinical Laboratory Science</em>, 11, 223-227.
</p>
<p>Holcomb, J., and Spalsbury, A. (2005), Teaching Students to Use Summary Statistics and Graphics
to Clean and Analyze Data. <em>Journal of Statistics Education</em>, 13, Number 3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(calcium)
## remove the categorical variables
calcium.cts &lt;- subset(calcium, select=-c(obsno, sex, lab, agegroup) )
res &lt;- GSE(calcium.cts)
getOutliers(res)
## able to identify majority of the contaminated cases identified 
## in the reference

## End(Not run)
</code></pre>

<hr>
<h2 id='CovEM'>Gaussian MLE of mean and covariance</h2><span id='topic+CovEM'></span>

<h3>Description</h3>

<p>Computes the Gaussian MLE via EM-algorithm for missing data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>CovEM(x, tol=0.001, maxiter=1000)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CovEM_+3A_x">x</code></td>
<td>
<p>a matrix or data frame. May contain missing values, but cannot contain columns with completely missing entries.</p>
</td></tr>
<tr><td><code id="CovEM_+3A_tol">tol</code></td>
<td>
<p>tolerance level for the maximum relative change of the estimates. Default is 0.001.</p>
</td></tr>
<tr><td><code id="CovEM_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum iteration for the EM algorithm. Default is 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 object of class <code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code>.
The output S4 object contains the following slots:
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>mu</code> </td><td style="text-align: left;"> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>S</code> </td><td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	<code>pmd</code> </td><td style="text-align: left;"> Squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>pmd.adj</code> </td><td style="text-align: left;"> Adjusted squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>pu</code> </td><td style="text-align: left;"> Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>call</code> </td><td style="text-align: left;"> Object of class <code>"language"</code>. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>x</code> </td><td style="text-align: left;"> Input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>p</code> </td><td style="text-align: left;"> Column dimension of input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>estimator</code></td><td style="text-align: left;"> Character string of the name of the estimator used. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Mike Danilov, Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a></p>

<hr>
<h2 id='CovRobMiss-class'> Class &quot;CovRobMiss&quot; &ndash; a superclass for the robust estimates of location and scatter for missing data </h2><span id='topic+CovRobMiss-class'></span><span id='topic+show+2CCovRobMiss-method'></span><span id='topic+summary+2CCovRobMiss-method'></span><span id='topic+getDist+2CCovRobMiss-method'></span><span id='topic+getDistAdj+2CCovRobMiss-method'></span><span id='topic+getDim+2CCovRobMiss-method'></span><span id='topic+getLocation+2CCovRobMiss-method'></span><span id='topic+getScatter+2CCovRobMiss-method'></span><span id='topic+getMissing+2CCovRobMiss-method'></span><span id='topic+getOutliers+2CCovRobMiss-method'></span>

<h3>Description</h3>

<p> The Superclass of all the objects output from the various robust estimators of location 
and scatter for missing data, which includes Generalized S-estimator <code><a href="#topic+GSE">GSE</a></code>, Extended Minimum Volumn 
Ellipsoid <code><a href="#topic+emve">emve</a></code>, and Huberized Pairwise <code><a href="#topic+HuberPairwise">HuberPairwise</a></code>. It can also be constructed
using the code <code><a href="#topic+partial.mahalanobis">partial.mahalanobis</a></code>. </p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("CovRobMiss", ...)</code>,
but the best way of creating <code>CovRobMiss</code> objects is a call to either of the folowing 
functions:<code>GSE</code>, <code>emve</code>, <code>HuberPairwise</code>, and <code>partial.mahalanobis</code>, 
which all serve as a constructor.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mu</code> </dt><dd><p> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </p>
</dd>
<dt><code>S</code> </dt><dd><p> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </p>
</dd> 
<dt><code>pmd</code> </dt><dd><p> Square partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </p>
</dd>
<dt><code>pmd.adj</code> </dt><dd><p> Adjusted square partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </p>
</dd>
<dt><code>pu</code> </dt><dd><p> Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </p>
</dd>
<dt><code>call</code> </dt><dd><p> Object of class <code>"language"</code>. Not meant to be accessed. </p>
</dd>
<dt><code>x</code> </dt><dd><p> Input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>p</code> </dt><dd><p> Column dimension of input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>estimator</code></dt><dd><p> Character string of the name of the estimator used. Not meant to be accessed. </p>
</dd>
</dl>



<h3>Methods</h3>

 

<dl>
<dt>show</dt><dd><p><code>signature(object = "CovRobMiss")</code>: display the object </p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "CovRobMiss")</code>: calculate summary information </p>
</dd>
<dt>plot</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: plot the object. See <code><a href="#topic+plot">plot</a></code></p>
</dd>
<dt>getDist</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the squared partial Mahalanobis distances </p>
</dd>
<dt>getDistAdj</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the adjusted squared partial Mahalanobis distances </p>
</dd>
<dt>getDim</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the dimension of observed entries for each case </p>
</dd>
<dt>getLocation</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the estimated location vector</p>
</dd>
<dt>getScatter</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: return the estimated scatter matrix</p>
</dd>
<dt>getMissing</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the case number with completely missing data, if any</p>
</dd>
<dt>getOutliers</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: return the case number(s) adjusted squared 
distances above <code>(1 - cutoff)</code>th quantile of chi-square p-degrees of freedom.</p>
</dd>	
</dl>



<h3>Author(s)</h3>

<p> Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+GSE">GSE</a></code>, <code><a href="#topic+emve">emve</a></code>, <code><a href="#topic+HuberPairwise">HuberPairwise</a></code>, <code><a href="#topic+partial.mahalanobis">partial.mahalanobis</a></code>
</p>

<hr>
<h2 id='CovRobMissSc-class'> Class &quot;CovRobMissSc&quot; &ndash; a subclass of &quot;CovRobMiss&quot; with scale estimate </h2><span id='topic+CovRobMissSc-class'></span><span id='topic+getScale+2CCovRobMissSc-method'></span>

<h3>Description</h3>

<p> The Superclass of the <code><a href="#topic+GSE-class">GSE-class</a></code> and <code><a href="#topic+emve-class">emve-class</a></code> objects. </p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("CovRobMissSc", ...)</code>,
but the best way of creating <code>CovRobMissSc</code> objects is a call to either of the folowing 
functions:<code>GSE</code> or <code>emve</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mu</code> </dt><dd><p> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </p>
</dd>
<dt><code>S</code> </dt><dd><p> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </p>
</dd> 
<dt><code>sc</code> </dt><dd><p> Estimated M-scale (either GS-scale or MVE-scale). Can be accessed via <code><a href="#topic+getScale">getScale</a></code>. </p>
</dd> 	
<dt><code>pmd</code> </dt><dd><p> Square partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </p>
</dd>
<dt><code>pmd.adj</code> </dt><dd><p> Adjusted square partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </p>
</dd>
<dt><code>pu</code> </dt><dd><p> Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </p>
</dd>
<dt><code>call</code> </dt><dd><p> Object of class <code>"language"</code>. Not meant to be accessed. </p>
</dd>
<dt><code>x</code> </dt><dd><p> Input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>p</code> </dt><dd><p> Column dimension of input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>estimator</code></dt><dd><p> Character string of the name of the estimator used. Not meant to be accessed. </p>
</dd>
</dl>



<h3>Extends</h3>

<p> Class <code>"<a href="#topic+CovRobMiss-class">CovRobMiss</a>"</code>, directly. </p>


<h3>Methods</h3>

 

<p>In addition to methods inheritedfrom the class &quot;CovRobMiss&quot;:
</p>
<dl>
<dt>getScale</dt><dd><p><code>signature(object = "CovRobMissSc")</code></p>
</dd></dl>
<p>: return the GS-scale or MVE-scale of the best candidate.  

</p>


<h3>Author(s)</h3>

<p> Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+GSE">GSE</a></code>, <code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code>
</p>

<hr>
<h2 id='emve'>Extended Minimum Volume Ellipsoid (EMVE) in the presence of missing data</h2><span id='topic+emve'></span>

<h3>Description</h3>

<p>Computes the Extended S-Estimate (ESE) version of the minimum volume ellipsoid (EMVE), which is
used as an initial estimator in Generlized S-Estimator (GSE) for missing data by default. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emve(x, maxits=5, sampling=c("uniform","cluster"), n.resample, n.sub.size, seed) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emve_+3A_x">x</code></td>
<td>
<p>a matrix or data frame. May contain missing values, but cannot contain columns with completely missing entries.</p>
</td></tr>
<tr><td><code id="emve_+3A_maxits">maxits</code></td>
<td>
<p>integer indicating the maximum number of iterations of Gaussian MLE calculation for each subsample. Default is 5.</p>
</td></tr>
<tr><td><code id="emve_+3A_sampling">sampling</code></td>
<td>
<p>which sampling scheme is to use: 'uniform' or 'cluster' (see Leung and Zamar, 2016). Default is 'uniform'.</p>
</td></tr>
<tr><td><code id="emve_+3A_n.resample">n.resample</code></td>
<td>
<p>integer indicating the number of subsamples. Default is 15 for clustering-based subsampling and 500 for uniform subsampling.</p>
</td></tr>
<tr><td><code id="emve_+3A_n.sub.size">n.sub.size</code></td>
<td>
<p>integer indicating the sizes of each subsample. Default is 2(p+1)/a for clustering-based subsampling and (p+1)/a for uniform subsampling, where a is proportion of non-missing cells.</p>
</td></tr>
<tr><td><code id="emve_+3A_seed">seed</code></td>
<td>
<p>optional starting value for random generator. Default is seed = 1000.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function computes EMVE as described in Danilov et al. (2012). Two subsampling schemes can be used for computing EMVE:
uniform subsampling and the clustering-based subsampling as described in Leung and Zamar (2016).
For uniform subsampling, the number of subsamples must be large to ensure high breakdown point. For clustering-based 
subsampling, the number of subsamples can be smaller. The subsample size <code class="reqn">n_0</code> must be chosen to be larger than <code class="reqn">p</code> to avoid singularity. 
</p>
<p>In the algorithm, there exists a concentration step in which Gaussian MLE is computed for <code class="reqn">50\%</code> of the data points using the 
classical EM-algorithm multiplied by a scalar factor. This step is repeated for each subsample. As the computation can be heavy as the 
number of subsample increases, we set by default the maximum number of iteration of classical EM-algorithm (i.e. <code>maxits</code>) as 5. 
Users are encouraged to refer to Danilov et al. (2012) for details about the algorithm
and Rubin and Little (2002) for the classical EM-algorithm for missing data. 
</p>


<h3>Value</h3>

<p>An S4 object of class <code><a href="#topic+emve-class">emve-class</a></code> which is a subclass of the virtual class <code><a href="#topic+CovRobMissSc-class">CovRobMissSc-class</a></code>.
The output S4 object contains the following slots:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>mu</code> </td><td style="text-align: left;"> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>S</code> </td><td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    <code>sc</code> </td><td style="text-align: left;"> Estimated EMVE scale. Can be accessed via <code><a href="#topic+getScale">getScale</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>pmd</code> </td><td style="text-align: left;"> Squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>pmd.adj</code> </td><td style="text-align: left;"> Adjusted squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>pu</code> </td><td style="text-align: left;"> Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>call</code> </td><td style="text-align: left;"> Object of class <code>"language"</code>. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>x</code> </td><td style="text-align: left;"> Input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>p</code> </td><td style="text-align: left;"> Column dimension of input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>estimator</code></td><td style="text-align: left;"> Character string of the name of the estimator used. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Ruben H. Zamar, Mike Danilov, Victor J. Yohai</p>


<h3>References</h3>

<p>Danilov, M., Yohai, V.J., Zamar, R.H. (2012). Robust Esimation of Multivariate
Location and Scatter in the Presence of Missing Data. <em>Journal of the American Statistical Association</em>
<b>107</b>, 1178&ndash;1186.
</p>
<p>Leung, A. and Zamar, R.H. (2016). Multivariate Location and Scatter Matrix Estimation Under Cellwise and Casewise Contamination.
Submitted.
</p>
<p>Rubin, D.B. and Little, R.J.A. (2002). <em>Statistical analysis with missing data</em> (2nd ed.). New York: Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GSE">GSE</a></code>, <code><a href="#topic+emve-class">emve-class</a></code>
</p>

<hr>
<h2 id='emve-class'>Extended Minimum Volume Ellipsoid (EMVE) in the presence of missing data.</h2><span id='topic+emve-class'></span>

<h3>Description</h3>

<p> Class of Extended Minimum Volume Ellipsoid. It has the superclass of <code>CovRobMissSc</code>. </p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("emve", ...)</code>,
but the best way of creating <code>emve</code> objects is a call to the function
<code>emve</code> which serves as a constructor.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mu</code></dt><dd><p>Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </p>
</dd>
<dt><code>S</code></dt><dd><p>Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </p>
</dd> 
<dt><code>sc</code></dt><dd><p>Estimated EMVE scale. Can be accessed via <code><a href="#topic+getScale">getScale</a></code>. </p>
</dd>
<dt><code>pmd</code></dt><dd><p>Squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </p>
</dd>
<dt><code>pmd.adj</code></dt><dd><p>Adjusted squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </p>
</dd>
<dt><code>pu</code></dt><dd><p>Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </p>
</dd>
<dt><code>call</code></dt><dd><p>Object of class <code>"language"</code>. Not meant to be accessed. </p>
</dd>
<dt><code>x</code></dt><dd><p>Input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>p</code></dt><dd><p>Column dimension of input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>estimator</code></dt><dd><p>Character string of the name of the estimator used. Not meant to be accessed. </p>
</dd>
</dl>
	


<h3>Extends</h3>

<p> Class <code>"<a href="#topic+CovRobMissSc-class">CovRobMissSc</a>"</code>, directly. </p>


<h3>Methods</h3>

 
<p>The following methods are defined with the superclass &quot;CovRobMiss&quot;:
</p>

<dl>
<dt>show</dt><dd><p><code>signature(object = "CovRobMiss")</code>: display the object </p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "CovRobMiss")</code>: calculate summary information </p>
</dd>
<dt>plot</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: plot the object. See <code><a href="#topic+plot">plot</a></code></p>
</dd>
<dt>getDist</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the squared partial Mahalanobis distances </p>
</dd>
<dt>getDistAdj</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the adjusted squared partial Mahalanobis distances </p>
</dd>
<dt>getDim</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the dimension of observed entries for each case </p>
</dd>
<dt>getLocation</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the estimated location vector</p>
</dd>
<dt>getScatter</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: return the estimated scatter matrix</p>
</dd>
<dt>getMissing</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the case number(s) with completely missing data, if any</p>
</dd>
<dt>getOutliers</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: return the case number(s) adjusted squared 
distances above <code>(1 - cutoff)</code>th quantile of chi-square p-degrees of freedom.</p>
</dd>
</dl>

<p>In addition to above, the following methods are defined with the class &quot;CovRobMissSc&quot;:
</p>

<dl>
<dt>getScale</dt><dd><p><code>signature(object = "CovRobMissSc")</code>: return the MVE scale of the best candidate</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+emve">emve</a></code>, <code><a href="#topic+CovRobMissSc-class">CovRobMissSc-class</a></code>, <code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code>
</p>

<hr>
<h2 id='geochem'>Geochemical Data</h2><span id='topic+geochem'></span>

<h3>Description</h3>

<p>Geochemical data  analyzed by Smith et al (1984). The variables in the data
measures the contents (in parts per million) for 20 chemical elements (e.g., Copper and Zinc)  in 53 samples of rocks in Western Australia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(geochem) </code></pre>


<h3>Format</h3>

<p>The data contains 53 observations on 20 variables corresponding to the 20 chemical elements.</p>


<h3>References</h3>

  
<p>Smith, R.E., Campbell, N.A., Licheld, A. (1984).
Multivariate statistical techniques applied to pisolitic laterite geochemistry at Golden Grove, 
Western Australia. 
<em>Journal of Geochemical Exploration</em>, <b>22</b>,
193&ndash;216.
</p>
<p>Agostinelli, C., Leung, A. , Yohai, V.J., and Zamar, R.H. (2014) Robust estimation of 
multivariate location and scatter in the presence of cellwise and casewise contamination. 
arXiv:1406.6031[math.ST]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(ICSNP)
library(rrcov)

data(geochem)
n &lt;- nrow(geochem)
p &lt;- ncol(geochem)

# MLE
res.ML &lt;- list(mu=colMeans(geochem), S=cov(geochem))

# Tyler's M
geochem.med &lt;- apply(geochem,2,median,na.rm=TRUE)
res.Tyler &lt;- tyler.shape(geochem, location=geochem.med)
res.Tyler &lt;- res.Tyler*(median(mahalanobis( geochem, geochem.med, res.Tyler))/qchisq(0.5, df=p) )
res.Tyler &lt;- list(mu=geochem.med, S=res.Tyler)

# Rocke's Covariace 
res.Rock &lt;- CovSest(geochem, method="rocke")
res.Rock &lt;- list(mu=res.Rock@center, S=res.Rock@cov)

# Fast-MCD
res.FMCD &lt;- CovMcd( geochem)
res.FMCD &lt;- list(mu=res.FMCD@center, S=res.FMCD@cov)

# MVE
res.MVE &lt;- CovMve( geochem)
res.MVE &lt;- list(mu=res.MVE@center, S=res.MVE@cov)

# S-estimator with bisquare rho function
res.S &lt;- CovSest(geochem, method="bisquare")
res.S &lt;- list(mu=res.S@center, S=res.S@cov)

# Fast-S
res.FS &lt;- CovSest(geochem)
res.FS &lt;- list(mu=res.FS@center, S=res.FS@cov)

# 2SGS
res.2SGS &lt;- TSGS( geochem, seed=999 )
res.2SGS &lt;- list(mu=res.2SGS@mu, S=res.2SGS@S)

# Combine all the results
geochem.res &lt;- list(ML=res.ML, Tyler=res.Tyler, Rocke=res.Rock, MCD=res.FMCD, 
	MVE=res.MVE, FS=res.FS, MVES=res.S, TSGS=res.2SGS)

## Compare LRT distances between different estimators
res.tab &lt;- data.frame( 	LRT.to.2SGS=c(slrt( res.ML$S, res.2SGS$S),
			slrt( res.Tyler$S, res.2SGS$S), 
			slrt( res.Rock$S, res.2SGS$S),
			slrt( res.FMCD$S, res.2SGS$S),
			slrt( res.MVE$S, res.2SGS$S),
			slrt( res.FS$S, res.2SGS$S),
			slrt( res.S$S, res.2SGS$S),
			slrt( res.2SGS$S, res.2SGS$S) ))
row.names(res.tab) &lt;- c("ML","Tyler","Rocke","MCD","MVE","FS","MVES","TSGS")

# Calculate proportion of outliers cellwise
pairwise.mahalanobis &lt;- function(x, mu, S){
	# function that computes pairwise mahalanobis distances
	p &lt;- ncol(x)
	pairs.md &lt;- c()
	for(i in 1:(p-1)) for(j in (i+1):p)
		pairs.md &lt;- c(pairs.md, mahalanobis( x[,c(i,j)], mu[c(i,j)], S[c(i,j),c(i,j)]))
	pairs.md
}
res.tab$Full &lt;- res.tab$Pairs &lt;- res.tab$Cell &lt;- NA
for(i in names(geochem.res) ){
	## Identify cellwise outliers
	uni.dist &lt;- sweep(sweep(geochem, 2, geochem.res[[i]]$mu, "-"), 2, 
		sqrt(diag(geochem.res[[i]]$S)), "/")^2
	uni.dist.stat &lt;- mean(uni.dist &gt; qchisq(.99^(1/(n*p)), 1))
	res.tab$Cell[ which( row.names(res.tab) == i)] &lt;- round(uni.dist.stat,3)

	## Identify pairwise outliers
	pair.dist &lt;- pairwise.mahalanobis( geochem, geochem.res[[i]]$mu, geochem.res[[i]]$S)
	pair.dist.stat &lt;- mean(pair.dist &gt; qchisq(0.99^(1/(n*choose(p,2))), 2))
	res.tab$Pairs[ which( row.names(res.tab) == i)] &lt;- round(pair.dist.stat,3)

	## Identify any large global MD
	full.dist &lt;- mahalanobis( geochem, geochem.res[[i]]$mu, geochem.res[[i]]$S)
	full.dist.stat &lt;- mean(full.dist &gt; qchisq(0.99^(1/n), p))
	res.tab$Full[ which( row.names(res.tab) == i)] &lt;- round(full.dist.stat,3)
}
res.tab

## End(Not run)
</code></pre>

<hr>
<h2 id='get-methods'>Accessor methods to the essential slots of classes CovRobMiss, TSGS, GSE, emve, and HuberPairwise</h2><span id='topic+getDist'></span><span id='topic+getDist-methods'></span><span id='topic+getDistAdj'></span><span id='topic+getDistAdj-methods'></span><span id='topic+getDim'></span><span id='topic+getDim-methods'></span><span id='topic+getLocation'></span><span id='topic+getLocation-methods'></span><span id='topic+getScatter'></span><span id='topic+getScatter-methods'></span><span id='topic+getMissing'></span><span id='topic+getMissing-methods'></span><span id='topic+getOutliers'></span><span id='topic+getOutliers-methods'></span><span id='topic+getScale'></span><span id='topic+getScale-methods'></span><span id='topic+getFiltDat'></span><span id='topic+getFiltDat-methods'></span>

<h3>Description</h3>

<p>Accessor methods to the slots of objects of classes <code>CovRobMiss</code>, <code>TSGS</code>, <code>GSE</code>, <code>emve</code>, and <code>HuberPairwise</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLocation(object)
getScatter(object)
getDist(object)
getDistAdj(object)
getDim(object)
getMissing(object)
getOutliers(object, cutoff)
getScale(obj)
getFiltDat(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get-methods_+3A_obj">obj</code>, <code id="get-methods_+3A_object">object</code></td>
<td>
<p>an object of any of the following classes
<code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code>, <code><a href="#topic+GSE-class">GSE-class</a></code>,
<code><a href="#topic+emve-class">emve-class</a></code>, and <code><a href="#topic+HuberPairwise-class">HuberPairwise-class</a></code>. For
function <code>getScale</code> the package defines a method for objects of class <code><a href="#topic+GSE-class">GSE-class</a></code>
objects are allowed. 
</p>
</td></tr>
<tr><td><code id="get-methods_+3A_cutoff">cutoff</code></td>
<td>
<p>optional argument for <code>getOutliers</code> - 
quantiles of chi-square to be used as a threshold for outliers detection, defaults to 0.99</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>getLocation</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the estimated location vector</p>
</dd>
<dt>getScatter</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: return the estimated scatter matrix</p>
</dd>
<dt>getDist</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the squared partial Mahalanobis distances </p>
</dd>
<dt>getDistAdj</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the adjusted squared partial Mahalanobis distances </p>
</dd>
<dt>getDim</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the dimension of observed entries for each case </p>
</dd>
<dt>getMissing</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the case number with completely missing data, if any</p>
</dd>
<dt>getOutliers</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: return the case number(s) adjusted squared 
distances above <code>(1 - cutoff)</code>th quantile of chi-square p-degrees of freedom.</p>
</dd>	
<dt>getScale</dt><dd><p><code>signature(object = "CovRobMissSc")</code>: return either the estimated generalized S-scale or MVE-scale. See <code><a href="#topic+GSE">GSE</a></code> and <code><a href="#topic+emve">emve</a></code> for details.</p>
</dd>
<dt>getFiltDat</dt><dd><p><code>signature(object = "TSGS")</code>: return filtered data matrix from the first step of 2SGS.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(boston)
res &lt;- GSE(boston)

## extract estimated location
getLocation(res)

## extract estimated scatter
getScatter(res)

## extract estimated adjusted distances
getDistAdj(res)

## extract outliers
getOutliers(res)

## End(Not run)</code></pre>

<hr>
<h2 id='GSE'> Generalized S-Estimator in the presence of missing data</h2><span id='topic+GSE'></span>

<h3>Description</h3>

<p>Computes the Generalized S-Estimate (GSE) &ndash; a robust estimate of location and scatter 
for data with contamination and missingness. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GSE(x, tol=1e-4, maxiter=150, method=c("bisquare","rocke"), 
    init=c("emve","qc","huber","imputed","emve_c"), mu0, S0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GSE_+3A_x">x</code></td>
<td>
<p>a matrix or data frame. May contain missing values, but cannot contain columns with completely missing entries. </p>
</td></tr>
<tr><td><code id="GSE_+3A_tol">tol</code></td>
<td>
<p>tolerance for the convergence criterion. Default is 1e-4.</p>
</td></tr>
<tr><td><code id="GSE_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations for the GSE algorithm. Default is 150.</p>
</td></tr>
<tr><td><code id="GSE_+3A_method">method</code></td>
<td>
<p>which loss function to use: 'bisquare', 'rocke'.</p>
</td></tr>
<tr><td><code id="GSE_+3A_init">init</code></td>
<td>

<p>type of initial estimator. Currently this can either be &quot;emve&quot; (EMVE with uniform sampling, see Danilov et al., 2012),
&quot;qc&quot; (QC, see Danilov et al., 2012), &quot;huber&quot; (Huber Pairwise, see Danilov et al., 2012), 
&quot;imputed&quot; (Imputed S-estimator, see the rejoinder in Agostinelli et al., 2015), or
&quot;emve_c&quot; (EMVE_C with cluster sampling, see Leung and Zamar, 2016).
Default is &quot;emve&quot;. If <code>mu0</code> and <code>S0</code> are provided, this argument is ignored.
</p>
</td></tr>
<tr><td><code id="GSE_+3A_mu0">mu0</code></td>
<td>
<p>optional vector of initial location estimate</p>
</td></tr>
<tr><td><code id="GSE_+3A_s0">S0</code></td>
<td>
<p>optional matrix of initial scatter estimate</p>
</td></tr>
<tr><td><code id="GSE_+3A_...">...</code></td>
<td>
<p>optional arguments for computing the initial estimates (see <code><a href="#topic+emve">emve</a></code>, <code><a href="#topic+HuberPairwise">HuberPairwise</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes GSE (Danilov et al., 2012) and GRE (Leung and Zamar, 2016). The estimator requires a robust positive definite 
initial estimator. This initial estimator is required to &ldquo;re-scale&quot; the partial square mahalanobis distance for 
the different missing pattern, in which a single scale parameter is not enough. This function currently allows two 
main initial estimators: EMVE (the default; see <code><a href="#topic+emve">emve</a></code> and Huberized Pairwise 
(see <code><a href="#topic+HuberPairwise">HuberPairwise</a></code>). GSE using Huberized Pairwise with sign psi function is referred to as QGSE in Danilov et al. (2012). 
Numerical results have shown that GSE with EMVE as 
initial has better performance (in both efficiency and robustness), but computing time can be longer. 
</p>


<h3>Value</h3>

<p>An S4 object of class <code><a href="#topic+GSE-class">GSE-class</a></code> which is a subclass of the virtual class <code><a href="#topic+CovRobMissSc-class">CovRobMissSc-class</a></code>. The
output S4 object contains the following slots:
</p>

<table>
<tr>
 <td style="text-align: left;">
        <code>mu</code> </td><td style="text-align: left;"> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>S</code> </td><td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
        <code>sc</code> </td><td style="text-align: left;"> Generalized S-scale (GS-scale). Can be accessed via <code><a href="#topic+getScale">getScale</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>pmd</code> </td><td style="text-align: left;"> Squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>pmd.adj</code> </td><td style="text-align: left;"> Adjusted squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>pu</code> </td><td style="text-align: left;"> Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>mu0</code> </td><td style="text-align: left;"> Estimated initial location.</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>S0</code> </td><td style="text-align: left;"> Estimated initial scatter matrix. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
        <code>ximp</code> </td><td style="text-align: left;"> Input data matrix with missing values imputed using best linear predictor. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>weights</code> </td><td style="text-align: left;"> Weights used in the estimation of the location. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>weightsp</code> </td><td style="text-align: left;"> First derivative of the weights used in the estimation of the location. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>iter</code> </td><td style="text-align: left;"> Number of iterations till convergence. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>eps</code> </td><td style="text-align: left;"> relative change of the GS-scale at convergence. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>call</code> </td><td style="text-align: left;"> Object of class <code>"language"</code>. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>x</code> </td><td style="text-align: left;"> Input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>p</code> </td><td style="text-align: left;"> Column dimension of input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>estimator</code></td><td style="text-align: left;"> Character string of the name of the estimator used. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Ruben H. Zamar, Mike Danilov, Victor J. Yohai</p>


<h3>References</h3>

<p>Agostinelli, C., Leung, A. , Yohai, V.J., and Zamar, R.H. (2015) Robust estimation of multivariate location and scatter in the presence of cellwise and casewise contamination. <em>TEST</em>.
</p>
<p>Danilov, M., Yohai, V.J., Zamar, R.H. (2012). Robust Esimation of Multivariate
Location and Scatter in the Presence of Missing Data. <em>Journal of the American Statistical Association</em>
<b>107</b>, 1178&ndash;1186.
</p>
<p>Leung, A. and Zamar, R.H. (2016). Multivariate Location and Scatter Matrix Estimation Under Cellwise and Casewise Contamination.
Submitted.    
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emve">emve</a></code>, <code><a href="#topic+HuberPairwise">HuberPairwise</a></code>, <code><a href="#topic+GSE-class">GSE-class</a></code>, <code><a href="#topic+generate.casecontam">generate.casecontam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12)

## generate 10-dimensional data with 10% casewise contamination
n &lt;- 100
p &lt;- 10
A &lt;- matrix(0.9, p, p)
diag(A) &lt;- 1
x &lt;- generate.casecontam(n, p, cond=100, contam.size=10, contam.prop=0.1, A=A)$x

## introduce 5% missingness
pmiss &lt;- 0.05
nmiss &lt;- matrix(rbinom(n*p,1,pmiss), n,p)
x[ which( nmiss == 1 ) ] &lt;- NA

## Using EMVE as initial
res.emve &lt;- GSE(x)
slrt( getScatter(res.emve), A) ## LRT distances to the true covariance

## Using QC as initial
res.qc &lt;- GSE(x, init="qc")
slrt( getScatter(res.qc), A) ## in general performs worse than if EMVE used as initials

</code></pre>

<hr>
<h2 id='GSE-class'>Generalized S-Estimator in the presence of missing data</h2><span id='topic+GSE-class'></span>

<h3>Description</h3>

<p>Class of Generalized S-Estimator. It has the superclass of <code>CovRobMissSc</code>. </p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("GSE", ...)</code>,
but the best way of creating <code>GSE</code> objects is a call to the function
<code>GSE</code> which serves as a constructor.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mu</code> </dt><dd><p> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </p>
</dd>
<dt><code>S</code> </dt><dd><p> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </p>
</dd> 
<dt><code>sc</code> </dt><dd><p> Generalized S-scale (GS-scale). Can be accessed via <code><a href="#topic+getScale">getScale</a></code>. </p>
</dd>
<dt><code>pmd</code> </dt><dd><p> Square partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </p>
</dd>
<dt><code>pmd.adj</code> </dt><dd><p> Adjusted square partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </p>
</dd>
<dt><code>pu</code> </dt><dd><p> Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </p>
</dd>
<dt><code>mu0</code></dt><dd><p> Estimated initial location. </p>
</dd>
<dt><code>S0</code></dt><dd><p> Estimated initial scatter matrix. </p>
</dd>
<dt><code>ximp</code> </dt><dd><p> Input data matrix with missing values imputed using best linear predictor. Not meant to be accessed. </p>
</dd>
<dt><code>weights</code> </dt><dd><p> Weights used in the estimation of the location. Not meant to be accessed. </p>
</dd>
<dt><code>weightsp</code> </dt><dd><p> First derivative of the weights used in the estimation of the location. Not meant to be accessed. </p>
</dd>
<dt><code>iter</code> </dt><dd><p> Number of iterations till convergence. Not meant to be accessed. </p>
</dd>
<dt><code>eps</code> </dt><dd><p> relative change of the GS-scale at convergence. Not meant to be accessed. </p>
</dd>
<dt><code>call</code> </dt><dd><p> Object of class <code>"language"</code>. Not meant to be accessed. </p>
</dd>
<dt><code>x</code> </dt><dd><p> Input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>p</code> </dt><dd><p> Column dimension of input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>estimator</code></dt><dd><p> Character string of the name of the estimator used. Not meant to be accessed. </p>
</dd>
</dl>



<h3>Extends</h3>

<p> Class <code>"<a href="#topic+CovRobMissSc-class">CovRobMissSc</a>"</code>, directly. </p>


<h3>Methods</h3>

 
<p>The following methods are defined with the superclass &quot;CovRobMiss&quot;:
</p>

<dl>
<dt>show</dt><dd><p><code>signature(object = "CovRobMiss")</code>: display the object </p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "CovRobMiss")</code>: calculate summary information </p>
</dd>
<dt>plot</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: plot the object. See <code><a href="#topic+plot">plot</a></code></p>
</dd>
<dt>getDist</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the squared partial Mahalanobis distances </p>
</dd>
<dt>getDistAdj</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the adjusted squared partial Mahalanobis distances </p>
</dd>
<dt>getDim</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the dimension of observed entries for each case </p>
</dd>
<dt>getLocation</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the estimated location vector</p>
</dd>
<dt>getScatter</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: return the estimated scatter matrix</p>
</dd>
<dt>getMissing</dt><dd><p><code>signature(object = "CovRobMiss")</code>: return the case number(s) with completely missing data, if any</p>
</dd>
<dt>getOutliers</dt><dd><p><code>signature(object = "CovRobMiss", cutoff = "numeric")</code>: return the case number(s) adjusted squared 
distances above <code>(1 - cutoff)</code>th quantile of chi-square p-degrees of freedom.</p>
</dd>
</dl>

<p>In addition to above, the following methods are defined with the class &quot;CovRobMissSc&quot;:
</p>

<dl>
<dt>getScale</dt><dd><p><code>signature(object = "CovRobMissSc")</code>: return the GS scale</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+GSE">GSE</a></code>, <code><a href="#topic+CovRobMissSc-class">CovRobMissSc-class</a></code>, <code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code>
</p>

<hr>
<h2 id='gy.filt'>Gervini-Yohai filter for detecting cellwise outliers</h2><span id='topic+gy.filt'></span>

<h3>Description</h3>

<p>Flags cellwise outliers detected using Gervini-Yohai filter as described in Agostinelli et al. (2015) and Leung and Zamar (2016). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gy.filt(x, alpha=c(0.95,0.85), bivarQt=0.99, bivarCellPr=0.1, miter=5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gy.filt_+3A_x">x</code></td>
<td>
<p>a matrix or data frame.</p>
</td></tr>
<tr><td><code id="gy.filt_+3A_alpha">alpha</code></td>
<td>
<p>a vector of the quantiles of the univariate and bivariate reference distributions, respectively. 
Filtering turns off when alpha is 0. For univariate filtering only, <code>alpha=c(0.95,0)</code>.
Default value is <code>c(0.95,0.85)</code>.</p>
</td></tr>
<tr><td><code id="gy.filt_+3A_bivarqt">bivarQt</code></td>
<td>
<p>quantile of the binomial model for the number of flagged pairs in the bivariate filter. Default is 0.99.</p>
</td></tr>
<tr><td><code id="gy.filt_+3A_bivarcellpr">bivarCellPr</code></td>
<td>
<p>probability of the binomial model for the number of flagged pairs in the bivariate filter. Default is 0.1.</p>
</td></tr>
<tr><td><code id="gy.filt_+3A_miter">miter</code></td>
<td>
<p>maximum number of iteration of filtering. Default value is 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the univariate filter and the univariate-plus-bivariate filter as described in Agostinelli et al. (2015)
and Leung and Zamar (2016), respectively. 
</p>
<p>In the univariate filter, outliers are flagged by comparing the empirical tail distribution of each marginal 
with a reference (normal) distribution using Gervini-Yohai approach. 
</p>
<p>In the univiarate-plus-bivariate filter, outliers are first flagged by applying the univariate filter. Then, the bivariate filter
is applied to flag any additional outliers. In the bivariate filter, outliers are flagged by comparing the empirical tail distribution 
of each bivariate marginal with a reference (chi-square with 2 d.f.) distribution using Gervini-Yohai approach. The number of 
flagged pairs associated with each cell approximately follows a binomial model under Independent Cellwise Contamination Model. 
A cell is additionally flagged if the number of flagged pairs exceeds a large quantile of the binomial model. 
</p>


<h3>Value</h3>

<p>a matrix or data frame of the filtered data.
</p>


<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Claudio Agostinelli, Ruben H. Zamar, Victor J. Yohai</p>


<h3>References</h3>

<p>Agostinelli, C., Leung, A. , Yohai, V.J., and Zamar, R.H. (2015) Robust estimation of multivariate location and scatter in the presence of cellwise and casewise contamination. TEST.
</p>
<p>Leung, A. and Zamar, R.H. (2016). Multivariate Location and Scatter Matrix Estimation Under Cellwise and Casewise Contamination.
Submitted.        
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TSGS">TSGS</a></code>, <code><a href="#topic+generate.cellcontam">generate.cellcontam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

# Generate 5% cell-wise contaminated normal data 
x &lt;- generate.cellcontam(n=100, p=10, cond=100, contam.size=5, contam.prop=0.05)$x

## Using univariate filter only
xna &lt;- gy.filt(x, alpha=c(0.95,0))
mean(is.na(xna))

## Using univariate-and-bivariate filter
xna &lt;- gy.filt(x, alpha=c(0.95,0.95))
mean(is.na(xna))
</code></pre>

<hr>
<h2 id='horse'>Horse-colic data</h2><span id='topic+horse'></span>

<h3>Description</h3>

<p>This is a modified version of the original data set (taken from UCI repository, see reference), where only quantitative variables are considered.
This data set is about horse diseases where the task is to determine if the lesion of the horse was surgical or not. It contains rows with completely
missing values except for ID and must be removed by the users. They are kept mainly for pedagogical purposes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(horse)</code></pre>


<h3>Format</h3>

<p>A data frame with 368 observations on the following 7 variables are quantitative and 1 categorical. The first variable is a numeric id. 
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>Hospital_Number</code> </td><td style="text-align: left;"> numeric id, i.e. the case number assigned to the horse (may not be unique if the horse is treated &gt; 1 time) </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Rectal_temperature</code></td><td style="text-align: left;"> rectal temperature in degree celcius </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Pulse</code></td><td style="text-align: left;"> the heart rate in beats per minute; normal rate is 30-40 for adults </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Respiratory_rate</code></td><td style="text-align: left;"> respiratory rate; normal rate is 8 to 10 </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Nasogastric_reflux_PH</code> </td><td style="text-align: left;"> scale is from 0 to 14 with 7 being neutral; normal values are in the 3 to 4 range </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Packed_cell_volume</code> </td><td style="text-align: left;"> the number of red cells by volume in the blood; normal range is 30 to 50 </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Total_protein</code> </td><td style="text-align: left;"> normal values lie in the 6-7.5 (gms/dL) range </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Abdomcentesis_total_protein</code> </td><td style="text-align: left;"> Values are in gms/dL </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>surgical_leison</code> </td><td style="text-align: left;"> was the problem (lesion) surgical?; 1 = yes, 2 = no </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Source</h3>

<p>The original data have been taken from the Journal of Statistics Education
Databases at
</p>

<ul>
<li> <p><a href="http://archive.ics.uci.edu/ml/datasets/Horse+Colic">http://archive.ics.uci.edu/ml/datasets/Horse+Colic</a>,
</p>
</li></ul>



<h3>References</h3>

<p>Frank, A. &amp; Asuncion, A. (2010). UCI Machine Learning Repository [http://archive.ics.uci.edu/ml]. 
Irvine, CA: University of California, School of Information and Computer Science.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(horse)
horse.cts &lt;- horse[,-c(1,9)] ## remove the id and categorical variable
res &lt;- GSE(horse.cts)
plot(res, which="dd", xlog10=TRUE, ylog10=TRUE)
getOutliers(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='HuberPairwise'> Quadrant Covariance and Huberized Pairwise Scatter </h2><span id='topic+HuberPairwise'></span>

<h3>Description</h3>

<p>Computes the Quadrant Covariance (QC) or Huberized Pairwise Scatter as described in 
Alqallaf et al. (2002). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
    HuberPairwise( x, psi=c("huber","sign"), c0=1.345, computePmd=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HuberPairwise_+3A_x">x</code></td>
<td>
<p>a matrix or data frame. May contain missing values, but cannot contain columns with completely missing entries. </p>
</td></tr>
<tr><td><code id="HuberPairwise_+3A_psi">psi</code></td>
<td>
<p>loss function to be used in computing pairwise scatter. Default is &quot;huber&quot;. If <code>psi="sign"</code>, this yields QC. Other value includes &quot;huber&quot;. </p>
</td></tr>
<tr><td><code id="HuberPairwise_+3A_c0">c0</code></td>
<td>
<p>tuning constant for the huber function. <code>c0=0</code> would yield QC. Default is <code>c0=1.345</code>. This parameter is unnecessary if <code>psi='sign'</code>.</p>
</td></tr>
<tr><td><code id="HuberPairwise_+3A_computepmd">computePmd</code></td>
<td>
<p>logical indicating whether to compute partial Mahalanobis distances (pmd) and adjusted pmd. Default is <code>TRUE</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>As described in Alqallaf et al. (2002), this estimator requires a robust scale estimate and a location M-estimate, 
which will be used to transform the data through a loss-function to be outlier-free. Currently, this function takes
MADN (normalized MAD) and median as the robust scale and location estimate to save computation time. By default, the 
loss function <code>psi</code> is a sign function, but users are encouraged to also try Huberized scatter with the loss function 
as <code class="reqn">\psi_c(x) = min( max(-c, x), c), c &gt; 0, c=1.345</code>. The function does not adjust for intrinsic bias as described in 
Alqallaf et al. (2002). Missing values will be replaced by the corresponding column's median.
</p>


<h3>Value</h3>

<p>An S4 object of class <code><a href="#topic+HuberPairwise-class">HuberPairwise-class</a></code> which is a subclass of the virtual class <code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code>.
The output S4 object contains the following slots:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>mu</code> </td><td style="text-align: left;"> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>S</code> </td><td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    <code>pmd</code> </td><td style="text-align: left;"> Squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>pmd.adj</code> </td><td style="text-align: left;"> Adjusted squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>pu</code> </td><td style="text-align: left;"> Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>R</code> </td><td style="text-align: left;"> Estimated correlation matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>call</code> </td><td style="text-align: left;"> Object of class <code>"language"</code>. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>x</code> </td><td style="text-align: left;"> Input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>p</code> </td><td style="text-align: left;"> Column dimension of input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>estimator</code></td><td style="text-align: left;"> Character string of the name of the estimator used. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a> </p>


<h3>References</h3>

<p>Alqallaf, F.A., Konis, K. P., R. Martin, D., Zamar, R. H. (2002).
Scalable Robust Covariance and Correlation Estimates for Data Mining. In Proceedings 
of the Seventh ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. Edmonton.
</p>

<hr>
<h2 id='HuberPairwise-class'> Quadrant Covariance and Huberized Pairwise Scatter </h2><span id='topic+HuberPairwise-class'></span>

<h3>Description</h3>

<p> Class of Quadrant Covariance and Huberized Pairwise Scatter. It has the superclass of <code>CovRobMiss</code>. </p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("HuberPairwise", ...)</code>,
but the best way of creating <code>HuberPairwise</code> objects is a call to the function
<code>HuberPairwise</code> which serves as a constructor.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mu</code></dt><dd><p>Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </p>
</dd>
<dt><code>S</code></dt><dd><p>Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </p>
</dd> 
<dt><code>pmd</code></dt><dd><p>Squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </p>
</dd>
<dt><code>pmd.adj</code></dt><dd><p>Adjusted squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </p>
</dd>
<dt><code>pu</code></dt><dd><p>Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </p>
</dd>
<dt><code>R</code></dt><dd><p>Estimated correlation matrix. Not meant to be accessed.</p>
</dd>
<dt><code>call</code></dt><dd><p>Object of class <code>"language"</code>. Not meant to be accessed. </p>
</dd>
<dt><code>x</code></dt><dd><p>Input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>p</code></dt><dd><p>Column dimension of input data matrix. Not meant to be accessed. </p>
</dd>
<dt><code>estimator</code></dt><dd><p>Character string of the name of the estimator used. Not meant to be accessed. </p>
</dd>
</dl>
	


<h3>Extends</h3>

<p> Class <code>"<a href="#topic+CovRobMiss-class">CovRobMiss</a>"</code>, directly. </p>


<h3>Methods</h3>

<p> No methods defined with class &quot;HuberPairwise&quot; in the signature. </p>


<h3>Author(s)</h3>

<p> Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+HuberPairwise">HuberPairwise</a></code>, <code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code>
</p>

<hr>
<h2 id='ImpS'>Imputed S-estimator</h2><span id='topic+ImpS'></span>

<h3>Description</h3>

<p>Computes the simple three-step estimator as described in the rejoinder of Agostinelli et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ImpS(x, alpha=0.95, method=c("bisquare","rocke"), init=c("emve","emve_c"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ImpS_+3A_x">x</code></td>
<td>
<p>a matrix or data frame.</p>
</td></tr>
<tr><td><code id="ImpS_+3A_alpha">alpha</code></td>
<td>
<p>quantile of the reference distribution in the univariate filter step (see <code><a href="#topic+gy.filt">gy.filt</a></code>). Default is 0.95.</p>
</td></tr>
<tr><td><code id="ImpS_+3A_method">method</code></td>
<td>
<p>which loss function to use: 'bisquare', 'rocke'.</p>
</td></tr>
<tr><td><code id="ImpS_+3A_init">init</code></td>
<td>

<p>type of initial estimator. Currently this can either be &quot;emve&quot; (EMVE with uniform sampling, see Danilov et al., 2012) or
&quot;emve_c&quot; (EMVE_C with cluster sampling, see Leung and Zamar, 2016). Default is &quot;emve&quot;.
</p>
</td></tr>
<tr><td><code id="ImpS_+3A_...">...</code></td>
<td>
<p>optional, additional arguments to be passed to <code><a href="#topic+GSE">GSE</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the simple three-step estimator as described in the rejoinder in Agostinelli et al. (2015). The procedure has three steps:
</p>
<p>In Step I, the method flags and removes cell-wise outliers using the Gervini-Yohai univariate only filter (see <code><a href="#topic+gy.filt">gy.filt</a></code>).
</p>
<p>In Step II, the method imputes the filtered cells using coordinate-wise medians. 
</p>
<p>In Step III, the method applies MVE-S to the filtered and imputed data from Step II (see <code><a href="#topic+GSE">GSE</a></code>).
</p>


<h3>Value</h3>

<p>The following gives the major slots in the output S4 object: 
</p>

<table>
<tr>
 <td style="text-align: left;">
        <code>mu</code> </td><td style="text-align: left;"> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>S</code> </td><td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
        <code>xf</code> </td><td style="text-align: left;"> Filtered data matrix from the first step of 2SGS. Can be accessed via <code><a href="#topic+getFiltDat">getFiltDat</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Claudio Agostinelli, Ruben H. Zamar, Victor J. Yohai</p>


<h3>References</h3>

<p>Agostinelli, C., Leung, A. , Yohai, V.J., and Zamar, R.H. (2015) Robust estimation of multivariate location and scatter in the presence of cellwise and casewise contamination. TEST.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GSE">GSE</a></code>, <code><a href="#topic+gy.filt">gy.filt</a></code>
</p>

<hr>
<h2 id='partial.mahalanobis'>Partial Square Mahalanobis Distance</h2><span id='topic+partial.mahalanobis'></span>

<h3>Description</h3>

<p>Computes the partial square Mahalanobis distance for all observations in x. 
Let <code class="reqn">\mathbf{x} = (x_{i1},...,x_{ip})'</code> be a p-dimensional random vector and 
<code class="reqn">\mathbf{u} = (u_{i1},...,u_{ip})'</code> be a p-dimensional vectors of zeros and ones indicating which entry is missing:
0 as missing and 1 as observed. Then partial mahalanobis distance is given by:
</p>
<p><code class="reqn"> d(\mathbf{x, u, m, \Sigma}) = (\mathbf{x^{(u)}} - \mathbf{m^{(u)}})' (\mathbf{\Sigma^{(u)}})^{-1}(\mathbf{x^{(u)}} - \mathbf{m^{(u)}})</code>.
</p>
<p>With no missing data, this function is equivalent to mahalanobis distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partial.mahalanobis(x, mu, Sigma)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partial.mahalanobis_+3A_x">x</code></td>
<td>
<p>a matrix or data frame. May contain missing values, but cannot contain columns with completely missing entries.</p>
</td></tr>
<tr><td><code id="partial.mahalanobis_+3A_mu">mu</code></td>
<td>
<p>location estimate</p>
</td></tr>
<tr><td><code id="partial.mahalanobis_+3A_sigma">Sigma</code></td>
<td>
<p>scatter estimate. Must be positive definite</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 object of class <code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code>.
The output S4 object contains the following slots:
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>mu</code> </td><td style="text-align: left;"> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>S</code> </td><td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	<code>pmd</code> </td><td style="text-align: left;"> Squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDist">getDist</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>pmd.adj</code> </td><td style="text-align: left;"> Adjusted squared partial Mahalanobis distances. Can be accessed via <code><a href="#topic+getDistAdj">getDistAdj</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>pu</code> </td><td style="text-align: left;"> Dimension of the observed entries for each case. Can be accessed via <code><a href="#topic+getDim">getDim</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>call</code> </td><td style="text-align: left;"> Object of class <code>"language"</code>. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>x</code> </td><td style="text-align: left;"> Input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>p</code> </td><td style="text-align: left;"> Column dimension of input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>estimator</code></td><td style="text-align: left;"> Character string of the name of the estimator used. Not meant to be accessed. </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## suppose we would like to compute pmd for an MLE
x &lt;- matrix(rnorm(1000),100,10)
U &lt;- matrix(rbinom(1000,1,0.1),100,10)
x &lt;- x * ifelse(U==1,NA,1)
## compute MLE (i.e. EM in this case)
res &lt;- CovEM(x)
## compute pmd
res.pmd &lt;- partial.mahalanobis(x, mu=getLocation(res), S=getScatter(res))
summary(res.pmd)
plot(res.pmd, which="index")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot-methods'>Plot methods for objects of class 'CovRobMiss'</h2><span id='topic+plot'></span><span id='topic+plot-method'></span><span id='topic+plot+2CCovRobMiss-method'></span><span id='topic+plot+2CCovRobMiss+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot methods for objects of class 'CovRobMiss'. The following plots are available:
</p>
<p>- chi-square qqplot for adjusted square partial Mahalanobis distances
</p>
<p>- index plot for adjusted square partial Mahalanobis distances
</p>
<p>- distance-distance plot comparing the adjusted distances based on classical MLE and robust estimators
</p>
<p>Cases with completely missing data will be dropped out. Outliers are identified using some pre-specific 
cutoff value, for instance 99% quantile of chi-square with p degrees of freedom, where p is the column
dimension of the data. Identified outliers can also be retrieved using <code><a href="#topic+getOutliers">getOutliers</a></code> with
an optional argument of <code>cutoff</code>, ranged from 0 to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S4 method for signature 'CovRobMiss'
plot(x, which = c("all","distance","qqchi2", "dd"), 
		which = c("all", "distance", "qqchisq", "dd"),
		ask = (which=="all" &amp;&amp; dev.interactive(TRUE)),
		cutoff = 0.99, xlog10 = FALSE, ylog10 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p>an object of class <code>"CovRobMiss"</code></p>
</td></tr>
<tr><td><code id="plot-methods_+3A_which">which</code></td>
<td>
<p> Which plot to show? Default is <code>which</code>=&quot;all&quot;. </p>
</td></tr>
<tr><td><code id="plot-methods_+3A_ask">ask</code></td>
<td>
<p> logical; if 'TRUE', the user is <em>ask</em>ed before each plot, see 'par(ask=.)'. 
Default is <code>ask = which=="all" &amp;&amp; dev.interactive()</code>.  </p>
</td></tr>
<tr><td><code id="plot-methods_+3A_cutoff">cutoff</code></td>
<td>
<p> The quantile cutoff for the distances. Default is 0.99. </p>
</td></tr>
<tr><td><code id="plot-methods_+3A_xlog10">xlog10</code></td>
<td>
<p> Base-10 logged x-axis? Default is <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="plot-methods_+3A_ylog10">ylog10</code></td>
<td>
<p> Base-10 logged y-axis? Default is <code>FALSE</code>. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(boston)
res &lt;- GSE(boston)

## plot all graphs
plot(res)

## plot individuals plots
plot(res, which="qqchisq")
plot(res, which="index")
plot(res, which="dd")

## control the coordinates, e.g. log10 transform the y-axis
plot(res, which="qqchisq", xlog10=TRUE, ylog10=TRUE)
plot(res, which="index", ylog10=TRUE)
plot(res, which="dd", xlog10=TRUE, ylog10=TRUE)

## End(Not run)</code></pre>

<hr>
<h2 id='simulation-tools'>Data generator for simulation study on cell- and case-wise contamination</h2><span id='topic+generate.randcorr'></span><span id='topic+generate.cellcontam'></span><span id='topic+generate.casecontam'></span>

<h3>Description</h3>

<p>Includes the data generator for the simulation study on cell- and case-wise contamination that appears on Agostinelli et al. (2014). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate.randcorr(cond, p, tol=1e-5, maxits=100) 

generate.cellcontam(n, p, cond, contam.size, contam.prop, A=NULL)

generate.casecontam(n, p, cond, contam.size, contam.prop, A=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation-tools_+3A_cond">cond</code></td>
<td>
<p>desired condition number of the random correlation matrix. The correlation matrix will be used to generate multivariate normal samples in <code>generate.cellcontam</code> and <code>generate.cellcontam</code>.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_tol">tol</code></td>
<td>
<p>tolerance level for the condition number of the random correlation matrix. Default is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_maxits">maxits</code></td>
<td>
<p>integer indicating the maximum number of iterations until the condition number of the random correlation matrix is within a tolerance level. Default is 100.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_n">n</code></td>
<td>
<p>integer indicating the number of observations to be generated.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_p">p</code></td>
<td>
<p>integer indicating the number of variables to be generated.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_contam.size">contam.size</code></td>
<td>
<p>size of cell- or case-wise contamination. For cell-wise outliers, random cells in a data matrix are replaced by <code>contam.dist</code>. 
For case-wise outliers, random cases in a data matrix are replaced by <code>contam.dist</code> times <code class="reqn">v</code> where <code class="reqn">v</code></p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_contam.prop">contam.prop</code></td>
<td>
<p>proportion of cell- or case-wise contamination.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_a">A</code></td>
<td>
<p>correlation matrix used for generating data. If <code>A</code> is <code>NULL</code>, 
a random correlation matrix is generated. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details about how the correlation matrix is randomly generated and how the contaminated data is generated can be found in Agostinelli et al. (2014). 
</p>


<h3>Value</h3>

<p><code>generate.randcorr</code> gives the random correlation matrix in dimension <code>p</code> and with condition number <code>cond</code>. 
</p>
<p><code>generate.cellcontam</code> and <code>generate.casecontam</code> give the multivariate normal sample that is either cell-wise 
or case-wise contaminated as described in Agostinelli et al. (2014). The contaminated sample is returned as components of a list with components
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>x</code> </td><td style="text-align: left;"> multivariate normal sample with cell- or case-wise contamination. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>u</code> </td><td style="text-align: left;"> <code>n</code> by <code>p</code> matrix of 0's and 1's with 1's correspond to an outlier. A row of 1's correspond to a case-wise outlier.</td>
</tr>
<tr>
 <td style="text-align: left;"> 
	<code>A</code> </td><td style="text-align: left;"> random correlation matrix with a specified condition number. </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Claudio Agostinelli, Ruben H. Zamar, Victor J. Yohai</p>


<h3>References</h3>

<p>Agostinelli, C., Leung, A. , Yohai, V.J., and Zamar, R.H. (2014) Robust estimation of multivariate location and scatter in the presence of cellwise and casewise contamination. arXiv:1406.6031[math.ST]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TSGS">TSGS</a></code>
</p>

<hr>
<h2 id='slrt'>LRT-based distances between matrices
</h2><span id='topic+slrt'></span>

<h3>Description</h3>

<p>LRT-distance that we use to evaluate the performance of our covariance
estimates. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slrt(S, trueS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slrt_+3A_s">S</code></td>
<td>
<p>estimated covariance matrix</p>
</td></tr>
<tr><td><code id="slrt_+3A_trues">trueS</code></td>
<td>
<p>true covariance matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that this is not actually a distance in a sense that
slrt(M1,M2) != slrt(M2,M1)</p>


<h3>Value</h3>

<p>scalar LRT-distance
</p>


<h3>Author(s)</h3>

<p>Mike Danilov
</p>


<h3>References</h3>

<p>Seber, G.A. (2004) Multivariate observations, Wiley
</p>
<p>Danilov, M. (2010). Robust Estimation of Multivariate Scatter under Non-Affine Equivariant Scenarios. Ph.D. thesis, 
Department of Statistics, University of British Columbia.
</p>

<hr>
<h2 id='SummaryCovGSE-class'>Class &quot;SummaryCovGSE&quot; - displaying summary of &quot;CovRobMiss&quot; objects </h2><span id='topic+SummaryCovGSE-class'></span><span id='topic+show+2CSummaryCovGSE-method'></span>

<h3>Description</h3>

<p> Displays summary information for <code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code> objects </p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("SummaryCovGSE", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>obj</code>:</dt><dd><p><code><a href="#topic+CovRobMiss-class">CovRobMiss-class</a></code> object</p>
</dd>
<dt><code>evals</code>:</dt><dd><p>Eigenvalues and eigenvectors of the covariance or correlation matrix</p>
</dd>
</dl>



<h3>Methods</h3>

 

<dl>
<dt>show</dt><dd><p><code>signature(object = "SummaryCovGSE")</code>: display the object </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a> </p>

<hr>
<h2 id='TSGS'>Two-Step Generalized S-Estimator for cell- and case-wise outliers</h2><span id='topic+TSGS'></span>

<h3>Description</h3>

<p>Computes the Two-Step Generalized S-Estimate (2SGS) &ndash; a robust estimate of location and scatter
for data with cell-wise and case-wise contamination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSGS(x, filter=c("UBF-DDC","UBF","DDC","UF"),
    partial.impute=FALSE, tol=1e-4, maxiter=150, method=c("bisquare","rocke"),
    init=c("emve","qc","huber","imputed","emve_c"), mu0, S0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TSGS_+3A_x">x</code></td>
<td>
<p>a matrix or data frame.</p>
</td></tr>
<tr><td><code id="TSGS_+3A_filter">filter</code></td>
<td>
<p>the filter to be used in the first step (see Leung et al. (2016)). Default is 'UBF-DDC'. For all filters, the default parameters are used.</p>
</td></tr>
<tr><td><code id="TSGS_+3A_partial.impute">partial.impute</code></td>
<td>
<p>whether partial imputation is used prior to estimation (see details). The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="TSGS_+3A_tol">tol</code></td>
<td>
<p>tolerance for the convergence criterion. Default is 1e-4.</p>
</td></tr>
<tr><td><code id="TSGS_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations for the GSE algorithm. Default is 150.</p>
</td></tr>
<tr><td><code id="TSGS_+3A_method">method</code></td>
<td>
<p>which loss function to use: 'bisquare', 'rocke'.</p>
</td></tr>
<tr><td><code id="TSGS_+3A_init">init</code></td>
<td>

<p>type of initial estimator. Currently this can either be &quot;emve&quot; (EMVE with uniform sampling, see Danilov et al., 2012),
&quot;qc&quot; (QC, see Danilov et al., 2012), &quot;huber&quot; (Huber Pairwise, see Danilov et al., 2012),
&quot;imputed&quot; (Imputed S-estimator, see the rejoinder in Agostinelli et al., 2015), or
&quot;emve_c&quot; (EMVE_C with cluster sampling, see Leung and Zamar, 2016).
Default is &quot;emve&quot;. If <code>mu0</code> and <code>S0</code> are provided, this argument is ignored.
</p>
</td></tr>
<tr><td><code id="TSGS_+3A_mu0">mu0</code></td>
<td>
<p>optional vector of initial location estimate</p>
</td></tr>
<tr><td><code id="TSGS_+3A_s0">S0</code></td>
<td>
<p>optional matrix of initial scatter estimate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes 2SGS as described in Agostinelli et al. (2015) and Leung and Zamar (2016). The procedure has two major steps:
</p>
<p>In Step I, the method filters (i.e., flags and removes) cell-wise outliers using Gervini-Yohai univariate filter (Agostinelli et al., 2015)
or univariate-bivariate filter (Leung et al., 2016) or univariate-bivariate-plus-DDC filter (Leung et al., 2016; Rousseeuw and Van den Bossche, 2016).
The filtering step can be called on its own by using the function <code><a href="#topic+gy.filt">gy.filt</a></code> or <code><a href="cellWise.html#topic+DDC">DDC</a></code>.
</p>
<p>In Step II, the method applies GSE or GRE (GSE with a Rocke-type loss function), which has been specifically designed to deal with
incomplete multivariate data with case-wise outliers, to the filted data coming from Step I. The second step can be called on its own
by using the function <code><a href="#topic+GSE">GSE</a></code>.
</p>
<p>The 2SGS method is intended for continuous variables, and requires that the number of observations
n be relatively larger than 5 times the number of variables p for desirable performance (see the rejoinder in Agostinelli et al., 2015).
In our numerical studies, for n too small relative to p, 2SGS may experience a lack of convergence, especially for filtered data
sets with a proportion of complete observations less than
1/2 + (p+1)/n. To overcome this problem, partial imputation prior to estimation is proposed
(see the rejoinder in Agostinelli et al., 2015). The procedure is rather ad hoc, but initial numerical experiements
show that partial imputation may work. Further research on this topic is still needed.
By default, partial imputation is not used, unless specified.
</p>
<p>In general, we warn users to use 2SGS with caution for data set with n relatively smaller than 5 times p.
</p>
<p>The application to the chemical data set analyzed in Agostinelli et al. (2015) can be found in <code><a href="#topic+geochem">geochem</a></code>.
</p>
<p>The tools that were used to generate contaminated data in the simulation study in Agostinelli et al. (2015) can be found in <code><a href="#topic+generate.cellcontam">generate.cellcontam</a></code> and <code><a href="#topic+generate.casecontam">generate.casecontam</a></code>.
</p>


<h3>Value</h3>

<p>The following gives the major slots in the output S4 object:
</p>

<table>
<tr>
 <td style="text-align: left;">
        <code>mu</code> </td><td style="text-align: left;"> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>S</code> </td><td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>xf</code> </td><td style="text-align: left;"> Filtered data matrix from the first step of 2SGS. Can be accessed via <code><a href="#topic+getFiltDat">getFiltDat</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Claudio Agostinelli, Ruben H. Zamar, Victor J. Yohai</p>


<h3>References</h3>

<p>Agostinelli, C., Leung, A. , Yohai, V.J., and Zamar, R.H. (2015) Robust estimation of multivariate location and scatter in the presence of cellwise and casewise contamination. TEST.
</p>
<p>Leung, A., Yohai, V.J., Zamar, R.H. (2016). Multivariate Location and Scatter Matrix Estimation Under Cellwise and Casewise Contamination.
arXiv:1609.00402.
</p>
<p>Rousseeuw P.J., Van den Bossche W. (2016). Detecting deviating data cells. arXiv:1601.07251
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GSE">GSE</a></code>, <code><a href="#topic+gy.filt">gy.filt</a></code>, <code><a href="cellWise.html#topic+DDC">DDC</a></code>, <code><a href="#topic+generate.cellcontam">generate.cellcontam</a></code>, <code><a href="#topic+generate.casecontam">generate.casecontam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

# Generate 5% cell-wise contaminated normal data
# using a random correlation matrix with condition number 100
x &lt;- generate.cellcontam(n=100, p=10, cond=100, contam.size=5, contam.prop=0.05)

## Using MLE
slrt( cov(x$x), x$A)

## Using Fast-S
slrt( rrcov:::CovSest(x$x)@cov, x$A)

## Using 2SGS
slrt( TSGS(x$x)@S, x$A)


# Generate 5% case-wise contaminated normal data
# using a random correlation matrix with condition number 100
x &lt;- generate.casecontam(n=100, p=10, cond=100, contam.size=15, contam.prop=0.05)

## Using MLE
slrt( cov(x$x), x$A)

## Using Fast-S
slrt( rrcov:::CovSest(x$x)@cov, x$A)

## Using 2SGS
slrt( TSGS(x$x)@S, x$A)
</code></pre>

<hr>
<h2 id='TSGS-class'>Two-Step Generalized S-Estimator for cell- and case-wise outliers</h2><span id='topic+TSGS-class'></span><span id='topic+getFiltDat+2CTSGS-method'></span>

<h3>Description</h3>

<p>Class of Two-Step Generalized S-Estimator. It has the superclass of <code>GSE</code>. </p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("TSGS", ...)</code>,
but the best way of creating <code>TSGS</code> objects is a call to the function
<code>TSGS</code> which serves as a constructor.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mu</code> </dt><dd><p> Estimated location. Can be accessed via <code><a href="#topic+getLocation">getLocation</a></code>. </p>
</dd>
<dt><code>S</code> </dt><dd><p> Estimated scatter matrix. Can be accessed via <code><a href="#topic+getScatter">getScatter</a></code>. </p>
</dd> 
<dt><code>xf</code> </dt><dd><p> Filtered data matrix from the first step of 2SGS. Can be accessed via <code><a href="#topic+getFiltDat">getFiltDat</a></code>. </p>
</dd>
</dl>



<h3>Extends</h3>

<p> Class <code>"<a href="#topic+GSE-class">GSE</a>"</code>, directly. </p>


<h3>Methods</h3>

 
<p>In addition to the methods defined in the superclass &quot;GSE&quot;, the following methods are also defined:
</p>

<dl>
<dt>getFiltDat</dt><dd><p><code>signature(object = "TSGS")</code>: return the filtered data matrix.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+TSGS">TSGS</a></code>, <code><a href="#topic+GSE">GSE</a></code>, <code><a href="#topic+GSE-class">GSE-class</a></code>
</p>

<hr>
<h2 id='wages'>Wages and Hours</h2><span id='topic+wages'></span>

<h3>Description</h3>

<p>The data are from a national sample of 6000 households with a male head earning less than 
USD 15,000 annually in 1966. The data were clasified into 39 demographic groups for 
analysis. The study was undertaken in the context of proposals for a guaranteed 
annual wage (negative income tax). At issue was the response of labor supply 
(average hours) to increasing hourly wages. 
The study was undertaken to estimate this response from available data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wages)</code></pre>


<h3>Format</h3>

<p>A data frame with 39 observations on the following 10 variables: 
</p>

<table>
<tr>
 <td style="text-align: left;">
        <code>HRS</code> </td><td style="text-align: left;"> Average hours worked during the year </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>RATE</code> </td><td style="text-align: left;"> Average hourly wage (USD)</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>ERSP</code> </td><td style="text-align: left;"> Average yearly earnings of spouse (USD)</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>ERNO</code> </td><td style="text-align: left;"> Average yearly earnings of other family members (USD)</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>NEIN</code> </td><td style="text-align: left;"> Average yearly non-earned income</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>ASSET</code> </td><td style="text-align: left;"> Average family asset holdings (Bank account, etc.) (USD)</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>AGE</code> </td><td style="text-align: left;"> Average age of respondent</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>DEP</code> </td><td style="text-align: left;"> Average number of dependents</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>RACE</code> </td><td style="text-align: left;"> Percent of white respondents</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>SCHOOL</code> </td><td style="text-align: left;"> Average highest grade of school completed</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Source</h3>

<p>DASL library (http://lib.stat.cmu.edu/DASL/Datafiles/wagesdat.html),
the dataset is not anymore available at this source.
</p>


<h3>References</h3>

<p>D.H. Greenberg and M. Kosters, (1970). Income Guarantees and the Working Poor, The Rand Corporation. 
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
