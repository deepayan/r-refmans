<!DOCTYPE html><html><head><title>Help for package dipsaus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dipsaus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%?&lt;-%'><p>Left-hand side checked assignment</p>
Provides a way to assign default values to variables. If the statement
'<code>lhs</code>' is invalid or <code>NULL</code>, this function will try to assign
<code>value</code>, otherwise nothing happens.</a></li>
<li><a href='#%&lt;-?%'><p>Right-hand side checked assignment</p>
Provides a way to avoid assignment to the left-hand side. If the statement
'<code>value</code>' is invalid or <code>NULL</code>, this function will not assign values and nothing happens.</a></li>
<li><a href='#%+-%'><p>Plus-minus operator</p></a></li>
<li><a href='#%=&gt;%'><p>A JavaScript style of creating functions</p></a></li>
<li><a href='#%OF%'><p>Get an element with condition that it must be from a list or vector</p></a></li>
<li><a href='#AbstractMap'><p>Abstract Map to store key-value pairs</p></a></li>
<li><a href='#AbstractQueue'><p>Defines abstract queue class</p></a></li>
<li><a href='#actionButtonStyled'><p>Action Button but with customized styles</p></a></li>
<li><a href='#add_to_session'><p>Store/Get key-value pairs in 'shiny' session</p></a></li>
<li><a href='#as_pipe'><p>Convert functions to pipe-friendly functions</p></a></li>
<li><a href='#ask_or_default'><p>Read a Line from the Terminal, but with Default Values</p></a></li>
<li><a href='#ask_yesno'><p>Ask and Return True or False from the Terminal</p></a></li>
<li><a href='#async'><p>Evaluate expression in <code>async_expr</code></p></a></li>
<li><a href='#async_expr'><p>Apply R expressions in a parallel way</p></a></li>
<li><a href='#async_flapply'><p>Wrapper for <code>future.apply::future_lapply</code></p></a></li>
<li><a href='#async_works'><p>Run jobs in other R sessions without waiting</p></a></li>
<li><a href='#attached_packages'><p>Get attached package names in current session (Internally used)</p></a></li>
<li><a href='#base64_to_image'><p>Save &quot;Base64&quot; Data to Images</p></a></li>
<li><a href='#base64_to_string'><p>Convert &quot;Base64&quot; Data to String</p></a></li>
<li><a href='#base64-url'><p>Encode or decode 'base64'</p></a></li>
<li><a href='#baseline_array'><p>Calculate Contrasts of Arrays in Different Methods</p></a></li>
<li><a href='#capture_expr'><p>Captures Evaluation Output of Expressions as One Single String</p></a></li>
<li><a href='#cat2'><p>Color Output</p></a></li>
<li><a href='#check_installed_packages'><p>Check If Packages Are Installed, Returns Missing Packages</p></a></li>
<li><a href='#clear_env'><p>Function to clear all elements within environment</p></a></li>
<li><a href='#col2hexStr'><p>Convert color to Hex string</p></a></li>
<li><a href='#collapse'><p>Collapse Sensors And Calculate Summations/Mean</p></a></li>
<li><a href='#compoundInput2'><p>Compound input that combines and extends shiny inputs</p></a></li>
<li><a href='#decorate_function'><p>Python-style decorator</p></a></li>
<li><a href='#deparse_svec'><p>Convert Integer Vectors To String</p></a></li>
<li><a href='#dipsaus-rstudio-shortcuts'><p>Register customized R code to 'RStudio' shortcuts</p></a></li>
<li><a href='#do_aggregate'><p>Make aggregate pipe-friendly</p></a></li>
<li><a href='#do_nothing'><p>A dummy function that literally does nothing</p></a></li>
<li><a href='#drop_nulls'><p>Drop <code>NULL</code> values from list or vectors</p></a></li>
<li><a href='#eval_dirty'><p>Evaluate expressions</p></a></li>
<li><a href='#fancyFileInput'><p>Shiny drag-and-drop file input</p></a></li>
<li><a href='#fastcov2'><p>Calculate Covariance Matrix in Parallel</p></a></li>
<li><a href='#fastmap2'><p>A Wrapper for <code>fastmap::fastmap</code></p></a></li>
<li><a href='#fastquantile'><p>Calculate single quantile for numerical values</p></a></li>
<li><a href='#fastqueue2'><p>A Wrapper for <code>fastmap::fastqueue</code></p></a></li>
<li><a href='#flex_div'><p>Generate Shiny element with arrangement automatically</p></a></li>
<li><a href='#forelse'><p>Python-style <code>"for-else"</code> function</p></a></li>
<li><a href='#get_cpu'><p>Defunct Functions in Package <span class="pkg">dipsaus</span></p>
The functions or variables listed here are no longer part of the package.</a></li>
<li><a href='#get_credential'><p>Generate a random password</p></a></li>
<li><a href='#get_dots'><p>Get or check elements from dots <code>'...'</code></p></a></li>
<li><a href='#get_ip'><p>Get 'IP' address</p></a></li>
<li><a href='#get_os'><p>Detect the type of operating system</p></a></li>
<li><a href='#get_ram'><p>Get Memory Size</p></a></li>
<li><a href='#getInputBinding'><p>Obtain registered input bindings</p></a></li>
<li><a href='#graphic-devices'><p>Create a group of named graphic devices</p></a></li>
<li><a href='#handler_dipsaus_progress'><p>Progress-bar Handler</p></a></li>
<li><a href='#html_asis'><p>Escape HTML strings</p></a></li>
<li><a href='#html_class'><p>Combine, add, or remove 'HTML' classes</p></a></li>
<li><a href='#iapply'><p>Apply each elements with index as second input</p></a></li>
<li><a href='#lapply_async2'><p>Apply, but in parallel</p></a></li>
<li><a href='#lapply_callr'><p>Apply function with <code>rs_exec</code></p></a></li>
<li><a href='#list_to_fastmap2'><p>Copy elements to <code>fastmap2</code></p></a></li>
<li><a href='#list_to_fastqueue2'><p>Copy elements to <code>fastqueue2</code></p></a></li>
<li><a href='#lock'><p>Create or Unlock a Lock</p></a></li>
<li><a href='#make_forked_clusters'><p>Create forked clusters, but more than that</p></a></li>
<li><a href='#map'><p>Create R object map.</p></a></li>
<li><a href='#mask_function2'><p>Mask a function with given variables</p></a></li>
<li><a href='#match_calls'><p>Recursively match calls and modify arguments</p></a></li>
<li><a href='#mean_se'><p>Calculates mean and standard error of mean</p></a></li>
<li><a href='#mem_limit2'><p>Get max RAM size</p>
This is an experimental function that is designed for non-windows systems</a></li>
<li><a href='#new_function2'><p>Create new function that supports 'quasi-quosure' syntax</p></a></li>
<li><a href='#no_op'><p>Pipe-friendly no-operation function</p></a></li>
<li><a href='#package_installed'><p>Check if a package is installed</p></a></li>
<li><a href='#parse_svec'><p>Parse Text Into Numeric Vectors</p></a></li>
<li><a href='#PersistContainer'><p>Wrapper to cache key-value pairs and persist across sessions</p></a></li>
<li><a href='#print_directory_tree'><p>Print Directory Tree</p></a></li>
<li><a href='#progress2'><p>'Shiny' progress bar, but can run without reactive context</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#registerInputBinding'><p>Register customized input to enable support by compound input</p></a></li>
<li><a href='#restart_session'><p>Restart R Session</p></a></li>
<li><a href='#rs_active_project'><p>Get 'RStudio' active project</p></a></li>
<li><a href='#rs_avail'><p>Verify 'RStudio' version</p></a></li>
<li><a href='#rs_edit_file'><p>Use 'RStudio' to open and edit files</p></a></li>
<li><a href='#rs_exec'><p>Schedule a Background Job</p></a></li>
<li><a href='#rs_focus_console'><p>Focus on 'RStudio' Console</p></a></li>
<li><a href='#rs_save_all'><p>Save all documents in 'RStudio'</p></a></li>
<li><a href='#rs_select_path'><p>Use 'RStudio' to Select a Path on the Server</p></a></li>
<li><a href='#rs_set_repos'><p>Add secondary 'CRAN'-like repository to the 'RStudio' settings</p></a></li>
<li><a href='#rs_viewer'><p>Get 'RStudio' Viewer, or Return Default</p></a></li>
<li><a href='#screenshot'><p>Take a screenshot in shiny apps</p></a></li>
<li><a href='#session_uuid'><p>Provides Unique Session ID According to Current R Session</p></a></li>
<li><a href='#set_shiny_input'><p>Set Shiny Input</p></a></li>
<li><a href='#sexp_type2'><p>Get Internal Storage Type</p></a></li>
<li><a href='#shared_finalizer'><p>Create Shared Finalization to Avoid Over Garbage Collection</p></a></li>
<li><a href='#shift_array'><p>Shift Array by Index</p></a></li>
<li><a href='#shiny_alert2'><p>Simple shiny alert that uses 'JavaScript' promises</p></a></li>
<li><a href='#shiny_is_running'><p>Detect whether 'Shiny' is running</p></a></li>
<li><a href='#ste_mean'><p>Standard error of mean</p></a></li>
<li><a href='#sumsquared'><p>Fast Calculation of Sum-squared for Large Matrices/Vectors</p></a></li>
<li><a href='#sync_shiny_inputs'><p>Synchronize Shiny Inputs</p></a></li>
<li><a href='#test_farg'><p>Test whether function has certain arguments</p></a></li>
<li><a href='#time_delta'><p>Calculate time difference and return a number</p></a></li>
<li><a href='#to_datauri'><p>Convert file to 'base64' format</p></a></li>
<li><a href='#to_ram_size'><p>Convert bytes to KB, MB, GB,...</p></a></li>
<li><a href='#update_fastmap2'><p>Migrate a <code>fastmap2</code> object to a new one</p></a></li>
<li><a href='#updateActionButtonStyled'><p>Update styled action button</p></a></li>
<li><a href='#updateCompoundInput2'><p>Update compound inputs</p></a></li>
<li><a href='#use_shiny_dipsaus'><p>Set up shiny plugins</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Dipping Sauce for Data Analysis and Visualizations</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.8</td>
</tr>
<tr>
<td>Description:</td>
<td>Works as an "add-on" to packages like 'shiny', 'future', as well as 
    'rlang', and provides utility functions. Just like dipping sauce adding 
    flavors to potato chips or pita bread, 'dipsaus' for data analysis and 
    visualizations adds handy functions and enhancements to popular packages. 
    The goal is to provide simple solutions that are frequently asked for 
    online, such as how to synchronize 'shiny' inputs without freezing the app,
    or how to get memory size on 'Linux' or 'MacOS' system. The enhancements 
    roughly fall into these four categories: 1. 'shiny' input widgets; 2. 
    high-performance computing using the 'future' package; 3. 
    modify R calls and convert among numbers, strings, and other objects. 4. 
    utility functions to get system information such like CPU chip-set, memory 
    limit, etc.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dipterix/dipsaus">https://github.com/dipterix/dipsaus</a>, <a href="https://dipterix.org/dipsaus/">https://dipterix.org/dipsaus/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dipterix/dipsaus/issues">https://github.com/dipterix/dipsaus/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stats, graphics, grDevices, parallel, Rcpp, R6, shiny,
cli, stringr, jsonlite (&ge; 1.6), future, future.apply,
progressr, fastmap (&ge; 1.1.0), base64enc, digest, rlang (&ge;
0.4.0), rstudioapi (&ge; 0.11)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, promises, later, rmarkdown, testthat, microbenchmark,
magrittr, yaml, future.callr, remotes, glue</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-03 19:27:14 UTC; dipterix</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhengjia Wang [aut, cre],
  John Magnotti [ctb] (Contributed to `rutabaga.R`),
  Xiang Zhang [ctb] (Contributed to `rutabaga.R`)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhengjia Wang &lt;dipterix.wang@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-03 20:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+3F+26lt+3B-+25'>Left-hand side checked assignment
Provides a way to assign default values to variables. If the statement
'<code>lhs</code>' is invalid or <code>NULL</code>, this function will try to assign
<code>value</code>, otherwise nothing happens.</h2><span id='topic++25+3F+3C-+25'></span>

<h3>Description</h3>

<p>Left-hand side checked assignment
Provides a way to assign default values to variables. If the statement
'<code>lhs</code>' is invalid or <code>NULL</code>, this function will try to assign
<code>value</code>, otherwise nothing happens.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %?&lt;-% value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B3F+2B26lt+2B3B-+2B25_+3A_lhs">lhs</code></td>
<td>
<p>an object to check or assign</p>
</td></tr>
<tr><td><code id="+2B25+2B3F+2B26lt+2B3B-+2B25_+3A_value">value</code></td>
<td>
<p>value to be assigned if lhs is NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Assign value on the right-hand side to the left-hand side if
<code>lhs</code> does not exist or is <code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare, remove aaa if exists
if(exists('aaa', envir = globalenv(), inherits = FALSE)){
  rm(aaa, envir = globalenv())
}

# Assign
aaa %?&lt;-% 1; print(aaa)

# However, if assigned, nothing happens
aaa = 1;
aaa %?&lt;-% 2;
print(aaa)

# in a list
a = list()
a$e %?&lt;-% 1; print(a$e)
a$e %?&lt;-% 2; print(a$e)

</code></pre>

<hr>
<h2 id='+25+26lt+3B-+3F+25'>Right-hand side checked assignment
Provides a way to avoid assignment to the left-hand side. If the statement
'<code>value</code>' is invalid or <code>NULL</code>, this function will not assign values and nothing happens.</h2><span id='topic++25+3C-+3F+25'></span>

<h3>Description</h3>

<p>Right-hand side checked assignment
Provides a way to avoid assignment to the left-hand side. If the statement
'<code>value</code>' is invalid or <code>NULL</code>, this function will not assign values and nothing happens.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&lt;-?% value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26lt+2B3B-+2B3F+2B25_+3A_lhs">lhs</code></td>
<td>
<p>an object to be assigned to</p>
</td></tr>
<tr><td><code id="+2B25+2B26lt+2B3B-+2B3F+2B25_+3A_value">value</code></td>
<td>
<p>value to be checked</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Assign value on the right-hand side to the left-hand side if
<code>value</code> does exists and is not <code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare, remove aaa if exists
if(exists('aaa', envir = globalenv(), inherits = FALSE)){
  rm(aaa, envir = globalenv())
}

# aaa will not be assigned. run `print(aaa)` will raise error
aaa %&lt;-?% NULL

# Assign
aaa %&lt;-?% 1
print(aaa)

# in a list
a = list()
a$e %&lt;-?% bbb; print(a$e)
a$e %&lt;-?% 2; print(a$e)

</code></pre>

<hr>
<h2 id='+25+2B-+25'>Plus-minus operator</h2><span id='topic++25+2B-+25'></span>

<h3>Description</h3>

<p>Plus-minus operator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>a %+-% b
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B2B-+2B25_+3A_a">a</code>, <code id="+2B25+2B2B-+2B25_+3A_b">b</code></td>
<td>
<p>numeric vectors, matrices or arrays</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>a +/- b</code>, the dimension depends on <code>a+b</code>. If <code>a+b</code> is
a scalar, returns a vector of two; in the case of vector, returns a matrix;
all other cases will return an array with the last dimension equal to 2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# scalar
1 %+-% 2   # -1, 3

# vector input
c(1,2,3) %+-% 2   # matrix

# matrix input
matrix(1:9, 3) %+-% 2   # 3x3x2 array

</code></pre>

<hr>
<h2 id='+25+3D+26gt+3B+25'>A JavaScript style of creating functions</h2><span id='topic++25+3D+3E+25'></span>

<h3>Description</h3>

<p>A JavaScript style of creating functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>args %=&gt;% expr
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B3D+2B26gt+2B3B+2B25_+3A_args">args</code></td>
<td>
<p>function arguments: see <code><a href="base.html#topic+formals">formals</a></code></p>
</td></tr>
<tr><td><code id="+2B25+2B3D+2B26gt+2B3B+2B25_+3A_expr">expr</code></td>
<td>
<p>R expression that forms the body of functions: see <code><a href="base.html#topic+body">body</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function that takes <code>args</code> as parameters and <code>expr</code> as
the function body
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Formal arguments
c(a) %=&gt;% {
  print(a)
}

# Informal arguments
list(a=) %=&gt;% {
  print(a)
}

# Multiple inputs
c(a, b = 2, ...) %=&gt;% {
  print(c(a, b, ...))
}

# ----- JavaScript style of forEach -----
# ### Equivalent JavaScript Code:
# LETTERS.forEach((el, ii) =&gt; {
#   console.log('The index of letter ' + el + ' in "x" is: ' + ii);
# });

iapply(LETTERS, c(el, ii) %=&gt;% {
  cat2('The index of letter ', el, ' in ', sQuote('x'), ' is: ', ii)
}) -&gt; results
</code></pre>

<hr>
<h2 id='+25OF+25'>Get an element with condition that it must be from a list or vector</h2><span id='topic++25OF+25'></span>

<h3>Description</h3>

<p>Get an element with condition that it must be from a list or vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %OF% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25OF+2B25_+3A_lhs">lhs</code></td>
<td>
<p>the element of candidate</p>
</td></tr>
<tr><td><code id="+2B25OF+2B25_+3A_rhs">rhs</code></td>
<td>
<p>the constraint</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an element of length one that will be from <code>rhs</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# C is from LETTERS, therefore returns `C`
"C" %OF% LETTERS


# `lhs` is not from `rhs`, hence return the first element of LETTERS
'9' %OF% LETTERS
NULL %OF% LETTERS

# When there are multiple elements from `lhs`, select the first that
# matches the constraint
c('9', "D", "V") %OF% LETTERS

</code></pre>

<hr>
<h2 id='AbstractMap'>Abstract Map to store key-value pairs</h2><span id='topic+AbstractMap'></span>

<h3>Description</h3>

<p>Abstract Map to store key-value pairs
</p>

<hr>
<h2 id='AbstractQueue'>Defines abstract queue class</h2><span id='topic+AbstractQueue'></span>

<h3>Description</h3>

<p>This class is inspired by <a href="https://cran.r-project.org/package=txtq">https://cran.r-project.org/package=txtq</a>.
The difference is <code>AbstractQueue</code> introduce an abstract class that can
be extended and can queue not only text messages, but also arbitrary R
objects, including expressions and environments. All the queue types in this
package inherit this class.
</p>


<h3>Abstract Public Methods</h3>

<p>Methods start with <code>@...</code> are not thread-safe. Most of them are not
used directly by users. However, you might want to override them if you
inherit this abstract class. Methods marked as &quot;(override)&quot; are not
implemented, meaning you are supposed to implement the details. Methods
marked as &quot;(optional)&quot; usually have default alternatives.
</p>

<dl>
<dt><code>initialize(...)</code> (override)</dt><dd>
<p>The constructor. Usually three things to do during the process:
1. set <code>get_locker</code> <code>free_locker</code> if you don't want to use the
default lockers. 2. set lock file (if using default lockers). 3. call
<code>self$connect(...)</code>
</p>
</dd>
<dt><code>get_locker()</code>, <code>free_locker()</code> (optional)</dt><dd>
<p>Default is <code>NULL</code> for each methods, and queue uses an internal
<code>private$default_get_locker</code> and <code>private$default_free_locker</code>.
These two methods are for customized locker, please
implement these two methods as functions during <code>self$initialization</code>
<code>get_locker</code> obtains and lock access (exclusive), and <code>free_locker</code>
frees the locker. Once implemented, <code>private$exclusive</code> will take care
the rest. Type: function; parameters: none; return: none
</p>
</dd>
<dt><code>@get_head()</code>, <code>@set_head(v)</code> (override)</dt><dd>
<p>Get head so that we know where we are in the queue <code>self$@get_head()</code>
should return a integer indicating where we are at the queue
<code>self$@set_head(v)</code> stores that integer. Parameter <code>v</code> is always
non-negative, this is guaranteed. Users are not supposed to call these
methods directly, use <code>self$head</code> and <code>self$head&lt;-</code> instead.
However, if you inherit this class, you are supposed to override the methods.
</p>
</dd>
<dt><code>@get_total()</code>, <code>@set_total(v)</code> (override)</dt><dd>
<p>Similar to <code>@get_head</code> and <code>@set_head</code>, defines the total items
ever stored in the queue. total-head equals current items in the queue.
</p>
</dd>
<dt><code>@inc_total(n=1)</code> (optional)</dt><dd>
<p>Increase total, usually this doesn't need to be override, unless you are
using files to store total and want to decrease number of file connections
</p>
</dd>
<dt><code>@append_header(msg, ...)</code> (override)</dt><dd>
<p><code>msg</code> will be vector of strings, separated by &quot;|&quot;, containing encoded
headers: &lsquo;time', 'key', 'hash', and 'message'. to decode what&rsquo;s inside, you
can use <code>self$print_items(stringr::str_split_fixed(msg, '\|', 4))</code>.
<strong>Make sure</strong> to return a number, indicating number of items stored.
Unless handled elsewhere, usually <code>return(length(msg))</code>.
</p>
</dd>
<dt><code>@store_value(value, key)</code> (override)</dt><dd>
<p>Defines how to store value. 'key' is unique identifier generated from
time, queue ID, and value. Usually I use it as file name or key ID in
database. value is an arbitrary R object to store. you need to store value
somewhere and return a string that will be passed as 'hash' in
<code>self$restore_value</code>.
</p>
</dd>
<dt><code>restore_value(hash, key, preserve = FALSE)</code> (override)</dt><dd>
<p>Method to restore value from given combination of 'hash' and 'key'.
'hash' is the string returned by <code>@store_value</code>, and 'key' is the same
as key in <code>@store_value</code>. preserve is a indicator of whether to
preserve the value for future use. If set to <code>FALSE</code>, then you are
supposed to free up the resource related to the value. (such as free memory
or disk space)
</p>
</dd>
<dt><code>@log(n = -1, all = FALSE) (override)</code></dt><dd>
<p>get <code>n</code> items from what you saved to during <code>@append_header</code>.
<code>n</code> less equal than 0 means listing all possible items.
If <code>all=TRUE</code>, return all items (number of rows should equals to
<code>self$total</code>), including popped items. If <code>all=FALSE</code>, only
return items in the queue (number of rows is <code>self$count</code>). The
returned value should be a <code>n x 4</code> matrix. Usually I use
<code>stringr::str_split_fixed(..., '\|', 4)</code>. Please see all other
types implemented for example.
</p>
</dd>
<dt><code>@reset(...)</code> (override)</dt><dd>
<p>Reset queue, remove all items and reset head, total to be 0.
</p>
</dd>
<dt><code>@clean()</code> (override)</dt><dd>
<p>Clean the queue, remove all the popped items.
</p>
</dd>
<dt><code>@validate()</code> (override)</dt><dd>
<p>Validate the queue. Stop if the queue is broken.
</p>
</dd>
<dt><code>@connect(con, ...)</code> (override)</dt><dd>
<p>Set up connection. Usually should be called at the end of
<code>self$initialization</code> to connect to a database, a folder, or an
existing queue you should do checks whether the connection is new or it's
an existing queue.
</p>
</dd>
<dt><code>connect(con, ...)</code> (optional)</dt><dd>
<p>Thread-safe version. sometimes you need to override this function instead
of <code>@connect</code>, because <code>private$exclusive</code> requires <code>lockfile</code>
to exist and to be locked. If you don't have lockers ready, or need to set
lockers during the connection, override this one.
</p>
</dd>
<dt><code>destroy()</code> (optional)</dt><dd>
<p>Destroy a queue, free up space and call
<code>delayedAssign('.lockfile', {stop(...)}, assign.env=private)</code> to raise
error if a destroyed queue is called again later.
</p>
</dd>
</dl>



<h3>Public Methods</h3>

<p>Usually don't need to override unless you know what you are doing.
</p>

<dl>
<dt><code>push(value, message='',...)</code></dt><dd>
<p>Function to push an arbitrary R object to queue. <code>message</code> is a string
giving notes to the pushed item. Usually message is stored with header,
separated from values. The goal is to describe the value. <code>...</code> is
passed to <code>@append_header</code>
</p>
</dd>
<dt><code>pop(n = 1, preserve = FALSE)</code></dt><dd>
<p>Pop <code>n</code> items from the queue. <code>preserve</code> indicates whether not to
free up the resources, though not always guaranteed.
</p>
</dd>
<dt><code>print_item(item)</code>, <code>print_items(items)</code></dt><dd>
<p>To decode matrix returned by <code>log()</code>, returning named list or data frame
with four heads: 'time', 'key', 'hash', and 'message'.
</p>
</dd>
<dt><code>list(n=-1)</code></dt><dd>
<p>List items in the queue, decoded. If <code>n</code> is less equal than 0, then
list all results. The result is equivalent to
<code>self$print_items(self$log(n))</code>
</p>
</dd>
<dt><code>log(n=-1,all=FALSE)</code></dt><dd>
<p>List items in the queue, encoded. This is used with <code>self$print_items</code>.
When <code>all=TRUE</code>, result will list the  records ever pushed to the queue
since the last time queue is cleaned. When <code>all=FALSE</code>, results will be
items in the queue. <code>n</code> is the number of items.
</p>
</dd>
</dl>



<h3>Public Active Bindings</h3>


<dl>
<dt><code>id</code></dt><dd>
<p>Read-only property. Returns unique ID of current queue.
</p>
</dd>
<dt><code>lockfile</code></dt><dd>
<p>The lock file.
</p>
</dd>
<dt><code>head</code></dt><dd>
<p>Integer, total number of items popped, i.e. inactive items.
</p>
</dd>
<dt><code>total</code></dt><dd>
<p>Total number of items ever pushed to the queue since last cleaned, integer.
</p>
</dd>
<dt><code>count</code></dt><dd>
<p>Integer, read-only, equals to total - head, number of active items in the
queue
</p>
</dd>
</dl>



<h3>Private Methods or properties</h3>


<dl>
<dt><code>.id</code></dt><dd>
<p>Don't use directly. Used to store queue ID.
</p>
</dd>
<dt><code>.lockfile</code></dt><dd>
<p>Location of lock file.
</p>
</dd>
<dt><code>lock</code></dt><dd>
<p>Preserve the file lock.
</p>
</dd>
<dt><code>exclusive(expr,...)</code></dt><dd>
<p>Function to make sure the methods are thread-safe
</p>
</dd>
<dt><code>default_get_locker()</code></dt><dd>
<p>Default method to lock a queue
</p>
</dd>
<dt><code>default_free_locker</code></dt><dd>
<p>Default method to free a queue
</p>
</dd>
</dl>


<hr>
<h2 id='actionButtonStyled'>Action Button but with customized styles</h2><span id='topic+actionButtonStyled'></span>

<h3>Description</h3>

<p>Action Button but with customized styles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>actionButtonStyled(
  inputId,
  label,
  icon = NULL,
  width = NULL,
  type = "primary",
  btn_type = "button",
  class = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="actionButtonStyled_+3A_inputid">inputId</code>, <code id="actionButtonStyled_+3A_label">label</code>, <code id="actionButtonStyled_+3A_icon">icon</code>, <code id="actionButtonStyled_+3A_width">width</code>, <code id="actionButtonStyled_+3A_...">...</code></td>
<td>
<p>passed to <code>shiny::actionButton</code></p>
</td></tr>
<tr><td><code id="actionButtonStyled_+3A_type">type</code></td>
<td>
<p>button type, choices are 'default', 'primary', 'info', 'success',
'warning', and 'danger'</p>
</td></tr>
<tr><td><code id="actionButtonStyled_+3A_btn_type">btn_type</code></td>
<td>
<p>HTML tag type, either <code>"button"</code> or <code>"a"</code></p>
</td></tr>
<tr><td><code id="actionButtonStyled_+3A_class">class</code></td>
<td>
<p>additional classes to be added to the button</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'HTML' tags
</p>


<h3>See Also</h3>

<p><code><a href="#topic+updateActionButtonStyled">updateActionButtonStyled</a></code> for how to update the button.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# demo('example-actionButtonStyled', package='dipsaus')

library(shiny)
library(dipsaus)

ui &lt;- fluidPage(
  actionButtonStyled('btn', label = 'Click me', type = 'default'),
  actionButtonStyled('btn2', label = 'Click me2', type = 'primary')
)


server &lt;- function(input, output, session) {
  btn_types = c('default', 'primary', 'info', 'success', 'warning', 'danger')
  observeEvent(input$btn, {
    btype = btn_types[((input$btn-1) %% (length(btn_types)-1)) + 1]
    updateActionButtonStyled(session, 'btn2', type = btype)
  })
  observeEvent(input$btn2, {
    updateActionButtonStyled(session, 'btn',
                             disabled = c(FALSE,TRUE)[(input$btn2 %% 2) + 1])
  })
}


if( interactive() ){
  shinyApp(ui, server, options = list(launch.browser=TRUE))
}

</code></pre>

<hr>
<h2 id='add_to_session'>Store/Get key-value pairs in 'shiny' session</h2><span id='topic+add_to_session'></span>

<h3>Description</h3>

<p>If key is missing, it'll be created, otherwise ignored or
overwritten.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_to_session(
  session,
  key = "rave_id",
  val = paste(sample(c(letters, LETTERS, 0:9), 20), collapse = ""),
  override = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_to_session_+3A_session">session</code></td>
<td>
<p>'Shiny' session</p>
</td></tr>
<tr><td><code id="add_to_session_+3A_key">key</code></td>
<td>
<p>character, key to store</p>
</td></tr>
<tr><td><code id="add_to_session_+3A_val">val</code></td>
<td>
<p>value to store</p>
</td></tr>
<tr><td><code id="add_to_session_+3A_override">override</code></td>
<td>
<p>if key exists, whether to overwrite its value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If session is shiny session, returns current value stored in
session, otherwise returns <code>NULL</code>
</p>

<hr>
<h2 id='as_pipe'>Convert functions to pipe-friendly functions</h2><span id='topic+as_pipe'></span>

<h3>Description</h3>

<p>Convert functions to pipe-friendly functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_pipe(
  x,
  ...,
  call,
  arg_name,
  .name = arg_name,
  .env = parent.frame(),
  .quoted = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_pipe_+3A_x">x</code></td>
<td>
<p>R object as input</p>
</td></tr>
<tr><td><code id="as_pipe_+3A_...">...</code></td>
<td>
<p>default arguments explicitly display in the returned function</p>
</td></tr>
<tr><td><code id="as_pipe_+3A_call">call</code></td>
<td>
<p>a function call, or the function itself</p>
</td></tr>
<tr><td><code id="as_pipe_+3A_arg_name">arg_name</code></td>
<td>
<p>argument name to be varied. This argument will be the first
argument in the new function so it's pipe-friendly.</p>
</td></tr>
<tr><td><code id="as_pipe_+3A_.name">.name</code></td>
<td>
<p>new argument name; default is the same as <code>arg_name</code></p>
</td></tr>
<tr><td><code id="as_pipe_+3A_.env">.env</code></td>
<td>
<p>executing environment</p>
</td></tr>
<tr><td><code id="as_pipe_+3A_.quoted">.quoted</code></td>
<td>
<p>whether <code>call</code> has been quoted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>x</code> is missing, returns a function that takes one argument,
otherwise run the function with given <code>x</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# modify a function call
vary_title &lt;- as_pipe(call = plot(1:10, 1:10),
                      pch = 16,
                      arg_name = 'main',
                      .name = 'title')
vary_title

# vary_title is pipe-friendly with `pch` default 16
vary_title(title = 'My Title')

# `pch` is explicit
vary_title(title = 'My Title', pch = 1)

# other variables are implicit
vary_title(title = 'My Title', type = 'l')


# modify a function

f &lt;- function(b = 1, x){ b + x }
f_pipable &lt;- as_pipe(call = f, arg_name = 'x')
f_pipable

f_pipable(2)

# Advanced use

# Set option dipsaus.debug.as_pipe=TRUE to debug
options("dipsaus.debug.as_pipe" = TRUE)

# Both `.(z)` and `z` work

image2 &lt;- as_pipe(call = image(
  x = seq(0, 1, length.out = nrow(z)),
  y = 1:ncol(z),
  z = matrix(1:16, 4),
  xlab = "Time", ylab = "Freq",
  main = "Debug"
), arg_name = 'z')

# main can be overwritten
image2(matrix(1:50, 5), main = "Production")


# reset debug option
options("dipsaus.debug.as_pipe" = FALSE)


</code></pre>

<hr>
<h2 id='ask_or_default'>Read a Line from the Terminal, but with Default Values</h2><span id='topic+ask_or_default'></span>

<h3>Description</h3>

<p>Ask a question and read from the terminal in interactive scenario
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ask_or_default(..., default = "", end = "", level = "INFO")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ask_or_default_+3A_...">...</code>, <code id="ask_or_default_+3A_end">end</code>, <code id="ask_or_default_+3A_level">level</code></td>
<td>
<p>passed to <code><a href="#topic+cat2">cat2</a></code></p>
</td></tr>
<tr><td><code id="ask_or_default_+3A_default">default</code></td>
<td>
<p>default value to return in case of blank input</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The prompt string will ask a question, providing defaults. Users
need to enter the answer. If the answer is blank (no space), then returns the
default, otherwise returns the user input.
</p>
<p>This can only be used in an <code><a href="base.html#topic+interactive">interactive</a></code> session.
</p>


<h3>Value</h3>

<p>A character from the user's input, or the default value. See details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cat2">cat2</a></code>, <code><a href="base.html#topic+readline">readline</a></code>,
<code><a href="#topic+ask_yesno">ask_yesno</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
ask_or_default('What is the best programming language?',
               default = 'PHP')
}
</code></pre>

<hr>
<h2 id='ask_yesno'>Ask and Return True or False from the Terminal</h2><span id='topic+ask_yesno'></span>

<h3>Description</h3>

<p>Ask a question and read from the terminal in interactive scenario
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ask_yesno(
  ...,
  end = "",
  level = "INFO",
  error_if_canceled = TRUE,
  use_rs = TRUE,
  ok = "Yes",
  cancel = "No",
  rs_title = "Yes or No:"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ask_yesno_+3A_...">...</code>, <code id="ask_yesno_+3A_end">end</code>, <code id="ask_yesno_+3A_level">level</code></td>
<td>
<p>passed to <code><a href="#topic+cat2">cat2</a></code></p>
</td></tr>
<tr><td><code id="ask_yesno_+3A_error_if_canceled">error_if_canceled</code></td>
<td>
<p>raise error if canceled</p>
</td></tr>
<tr><td><code id="ask_yesno_+3A_use_rs">use_rs</code></td>
<td>
<p>whether to use <code>rstudioapi</code> if possible</p>
</td></tr>
<tr><td><code id="ask_yesno_+3A_ok">ok</code></td>
<td>
<p>button label for yes</p>
</td></tr>
<tr><td><code id="ask_yesno_+3A_cancel">cancel</code></td>
<td>
<p>button label for no</p>
</td></tr>
<tr><td><code id="ask_yesno_+3A_rs_title">rs_title</code></td>
<td>
<p>message title if 'RStudio' question box pops up.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The prompt string will ask for an yes or no question. Users need to
enter &quot;y&quot;, &quot;yes&quot; for yes, &quot;n&quot;, &quot;no&quot; or no, and &quot;c&quot; for cancel
(case-insensitive).
</p>
<p>This can only be used in an <code><a href="base.html#topic+interactive">interactive</a></code> session.
</p>


<h3>Value</h3>

<p>logical or <code>NULL</code> or raise an error. If &quot;yes&quot; is entered,
returns <code>TRUE</code>; if &quot;no&quot; is entered, returns <code>FALSE</code>; if &quot;c&quot; is
entered, <code>error_if_canceled=TRUE</code> will result in an error, otherwise
return <code>NULL</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cat2">cat2</a></code>, <code><a href="base.html#topic+readline">readline</a></code>,
<code><a href="#topic+ask_or_default">ask_or_default</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
ask_yesno('Do you know how hard it is to submit an R package and ',
          'pass the CRAN checks?')
ask_yesno('Can I pass the CRAN check this time?')
}
</code></pre>

<hr>
<h2 id='async'>Evaluate expression in <code>async_expr</code></h2><span id='topic+async'></span>

<h3>Description</h3>

<p>Evaluate expression in <code>async_expr</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>async(expr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="async_+3A_expr">expr</code></td>
<td>
<p>R expression</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+async_expr">async_expr</a></code>
</p>

<hr>
<h2 id='async_expr'>Apply R expressions in a parallel way</h2><span id='topic+async_expr'></span>

<h3>Description</h3>

<p>Apply R expressions in a parallel way
</p>


<h3>Usage</h3>

<pre><code class='language-R'>async_expr(
  .X,
  .expr,
  .varname = "x",
  envir = parent.frame(),
  .pre_run = NULL,
  .ncore = future::availableCores(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="async_expr_+3A_.x">.X</code></td>
<td>
<p>a vector or a list to apply evaluation on</p>
</td></tr>
<tr><td><code id="async_expr_+3A_.expr">.expr</code></td>
<td>
<p>R expression, unquoted</p>
</td></tr>
<tr><td><code id="async_expr_+3A_.varname">.varname</code></td>
<td>
<p>variable name representing element of each <code>.X</code></p>
</td></tr>
<tr><td><code id="async_expr_+3A_envir">envir</code></td>
<td>
<p>environment to evaluate expressions</p>
</td></tr>
<tr><td><code id="async_expr_+3A_.pre_run">.pre_run</code></td>
<td>
<p>expressions to be evaluated before looping.</p>
</td></tr>
<tr><td><code id="async_expr_+3A_.ncore">.ncore</code></td>
<td>
<p>number of CPU cores</p>
</td></tr>
<tr><td><code id="async_expr_+3A_...">...</code></td>
<td>
<p>passed to <code>future::future</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>async_expr</code> uses <code>lapply</code> and <code>future::future</code> internally.
Within each loop, an item in <code>".X"</code> will be assigned to variable <code>"x"</code>
(defined by <code>".varname"</code>) and enter the evaluation. During the evaluation,
function <code>async</code> is provided. Expressions within <code>async</code> will be
evaluated in another session, otherwise will be evaluated in current session.
Below is the workflow:
</p>

<ul>
<li><p> Run <code>.pre_run</code>
</p>
</li>
<li><p> For <code>i</code> in <code>seq_along(.X)</code>:
</p>

<ul>
<li><p> 1. Assign <code>x</code> with <code>.X[[i]]</code>, variable name <code>x</code> is
defined by <code>.varname</code>
</p>
</li>
<li><p> 2. Evaluate <code>expr</code> in current session.
</p>

<ul>
<li><p> a. If <code>async</code> is not called, return evaluated <code>expr</code>
</p>
</li>
<li><p> b. If <code>async(aync_expr)</code> is called, evaluate <code>aync_expr</code>
in another session, and return the evaluation results if <code>aync_expr</code>
</p>
</li></ul>

</li></ul>

</li></ul>



<h3>Value</h3>

<p>a list whose length equals to <code>.X</code>. The value of each item
returned depends on whether <code>async</code> is called. See details for workflow.
</p>

<hr>
<h2 id='async_flapply'>Wrapper for <code>future.apply::future_lapply</code></h2><span id='topic+async_flapply'></span>

<h3>Description</h3>

<p>Wrapper for <code>future.apply::future_lapply</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>async_flapply(X, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="async_flapply_+3A_x">X</code>, <code id="async_flapply_+3A_fun">FUN</code>, <code id="async_flapply_+3A_...">...</code></td>
<td>
<p>passing to <code>future.apply::future_lapply</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="future.apply.html#topic+future_lapply">future_lapply</a></code>
</p>

<hr>
<h2 id='async_works'>Run jobs in other R sessions without waiting</h2><span id='topic+async_works'></span>

<h3>Description</h3>

<p>This function has been deprecated. Please use
<code><a href="#topic+lapply_callr">lapply_callr</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>async_works(
  X,
  FUN,
  ...,
  .globals = NULL,
  .name = "Untitled",
  .rs = FALSE,
  .wait = TRUE,
  .chunk_size = Inf,
  .nworkers = future::availableCores(),
  .simplify = FALSE,
  .quiet = FALSE,
  .log
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="async_works_+3A_x">X</code></td>
<td>
<p>vector or list to be applied</p>
</td></tr>
<tr><td><code id="async_works_+3A_fun">FUN</code></td>
<td>
<p>function with the first argument to be each element of <code>X</code></p>
</td></tr>
<tr><td><code id="async_works_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>FUN</code></p>
</td></tr>
<tr><td><code id="async_works_+3A_.globals">.globals</code></td>
<td>
<p>global variables to be evaluated in <code>FUN</code></p>
</td></tr>
<tr><td><code id="async_works_+3A_.name">.name</code></td>
<td>
<p>job names, used if backed by <code>rstudioapi</code> jobs</p>
</td></tr>
<tr><td><code id="async_works_+3A_.rs">.rs</code></td>
<td>
<p>whether to use <code>rstudioapi</code> jobs</p>
</td></tr>
<tr><td><code id="async_works_+3A_.wait">.wait</code></td>
<td>
<p>whether to wait for the results</p>
</td></tr>
<tr><td><code id="async_works_+3A_.chunk_size">.chunk_size</code></td>
<td>
<p>used only when <code>.wait=FALSE</code>, chunk size for each
workers at a time. Only useful for printing progress messages, but might
slow down the process when <code>.chunk_size</code> is too small</p>
</td></tr>
<tr><td><code id="async_works_+3A_.nworkers">.nworkers</code></td>
<td>
<p>number of workers at a time</p>
</td></tr>
<tr><td><code id="async_works_+3A_.simplify">.simplify</code></td>
<td>
<p>whether to simplify the results, i.e. merge list of results
to vectors or arrays</p>
</td></tr>
<tr><td><code id="async_works_+3A_.quiet">.quiet</code></td>
<td>
<p>whether to suppress the printing messages</p>
</td></tr>
<tr><td><code id="async_works_+3A_.log">.log</code></td>
<td>
<p>internally used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unlike <code>future</code> package, where the global variables can be
automatically detected, <code>async_works</code> require users to specify global
variables explicitly via <code>.globals</code>
</p>
<p><code>async_works</code> is almost surely slower than <code>future.apply</code> packages.
However, it provides a functionality that <code>future.apply</code> can hardly
achieve: being non-block. When setting <code>.wait=FALSE</code>, the process will
run in the background, and one may run as many of these tasks as they want.
This is especially useful when large data generating process occurs (
such as read in from a file, process, generate summarizing reports).
</p>


<h3>Value</h3>

<p>If <code>.wait=TRUE</code>, returns the applied results of <code>FUN</code> on
each of <code>X</code>. The result types depend on <code>.simplify</code> (compare
the difference between <code><a href="base.html#topic+lapply">lapply</a></code> and <code><a href="base.html#topic+sapply">sapply</a></code>). If
<code>.wait=FALSE</code>, then returns a function that can check the result. The
function takes <code>timeout</code> argument that blocks the session at
most <code>timeout</code> seconds waiting for the results. See examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# requires a sub-process to run the code

# Basic usage
a &lt;- 1
async_works(1:10, function(ii){
  ii + a # sub-process don't know a, hence must pass a as globals
}, .globals = list(a = a))

# non-blocking case
system.time({
  check &lt;- async_works(1:10, function(ii){
    # simulating process, run run run
    Sys.sleep(ii)
    Sys.getpid()
  }, .wait = FALSE)
})

# check the results
res &lt;- check(timeout = 0.1)
attr(res, 'resolved') # whether it's resolved

# block the session waiting for the results
res &lt;- check(timeout = Inf)
attr(res, 'resolved')



## End(Not run)

</code></pre>

<hr>
<h2 id='attached_packages'>Get attached package names in current session (Internally used)</h2><span id='topic+attached_packages'></span>

<h3>Description</h3>

<p>Get attached package names in current session (Internally used)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attached_packages(include_base = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attached_packages_+3A_include_base">include_base</code></td>
<td>
<p>whether to include base packages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>characters, package names that are attached in current session
</p>

<hr>
<h2 id='base64_to_image'>Save &quot;Base64&quot; Data to Images</h2><span id='topic+base64_to_image'></span>

<h3>Description</h3>

<p>Save &quot;Base64&quot; Data to Images
</p>


<h3>Usage</h3>

<pre><code class='language-R'>base64_to_image(data, path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="base64_to_image_+3A_data">data</code></td>
<td>
<p>characters, encoded &quot;Base64&quot; data for images</p>
</td></tr>
<tr><td><code id="base64_to_image_+3A_path">path</code></td>
<td>
<p>file path to save to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Absolute path of the saved file
</p>

<hr>
<h2 id='base64_to_string'>Convert &quot;Base64&quot; Data to String</h2><span id='topic+base64_to_string'></span>

<h3>Description</h3>

<p>Decode &quot;Base64&quot; data to its generating characters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>base64_to_string(what)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="base64_to_string_+3A_what">what</code></td>
<td>
<p>characters, encoded &quot;Base64&quot; data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
input &lt;- "The quick brown fox jumps over the lazy dog"

# Base64 encode
what &lt;- base64enc::base64encode(what = charToRaw(input))

# Base64 decode
base64_to_string(what)

</code></pre>

<hr>
<h2 id='base64-url'>Encode or decode 'base64'</h2><span id='topic+base64-url'></span><span id='topic+base64_urlencode'></span><span id='topic+base64_urldecode'></span>

<h3>Description</h3>

<p>Compatible with results from package <code>'base64url'</code>,
but implemented with package <code>'base64enc'</code>. I simply do not like it
when I have to depend on two packages that can achieve the same goal.
This implementation is slower. If you have <code>'base64url'</code> installed,
please use that version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>base64_urlencode(x)

base64_urldecode(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="base64-url_+3A_x">x</code></td>
<td>
<p>character vector to encode or decode</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector of the same length as <code>x</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x = "plain text"
encoded = base64_urlencode(x)
decoded = base64_urldecode(encoded)
print(encoded)
print(decoded)

</code></pre>

<hr>
<h2 id='baseline_array'>Calculate Contrasts of Arrays in Different Methods</h2><span id='topic+baseline_array'></span>

<h3>Description</h3>

<p>Provides five methods to baseline an array and calculate
contrast.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baseline_array(
  x,
  along_dim,
  baseline_indexpoints,
  unit_dims = seq_along(dim(x))[-along_dim],
  method = c("percentage", "sqrt_percentage", "decibel", "zscore", "sqrt_zscore",
    "subtract_mean")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="baseline_array_+3A_x">x</code></td>
<td>
<p>array (tensor) to calculate contrast</p>
</td></tr>
<tr><td><code id="baseline_array_+3A_along_dim">along_dim</code></td>
<td>
<p>integer range from 1 to the maximum dimension of <code>x</code>.
baseline along this dimension, this is usually the time dimension.</p>
</td></tr>
<tr><td><code id="baseline_array_+3A_baseline_indexpoints">baseline_indexpoints</code></td>
<td>
<p>integer vector, which index points are counted
into baseline window? Each index ranges from 1 to <code>dim(x)[[along_dim]]</code>.
See Details.</p>
</td></tr>
<tr><td><code id="baseline_array_+3A_unit_dims">unit_dims</code></td>
<td>
<p>integer vector, baseline unit: see Details.</p>
</td></tr>
<tr><td><code id="baseline_array_+3A_method">method</code></td>
<td>
<p>character, baseline method options are:
<code>"percentage"</code>, <code>"sqrt_percentage"</code>, <code>"decibel"</code>,
<code>"zscore"</code>, and <code>"sqrt_zscore"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider a scenario where we want to baseline a bunch of signals recorded
from different locations. For each location, we record <code>n</code> sessions.
For each session, the signal is further decomposed into frequency-time
domain. In this case, we have the input <code>x</code> in the following form:
</p>
<p style="text-align: center;"><code class="reqn">session x frequency x time x location</code>
</p>

<p>Now we want to calibrate signals for each session, frequency and location
using the first 100 time points as baseline points, then the code will be
</p>
<p style="text-align: center;"><code class="reqn">baseline_array(x, along_dim=3, 1:100, unit_dims=c(1,2,4))</code>
</p>

<p><code>along_dim=3</code> is dimension of time, in this case, it's the
third dimension of <code>x</code>. <code>baseline_indexpoints=1:100</code>, meaning
the first 100 time points are used to calculate baseline.
<code>unit_dims</code> defines the unit signal. Its value <code>c(1,2,4)</code>
means the unit signal is per session (first dimension), per frequency
(second) and per location (fourth).
</p>
<p>In some other cases, we might want to calculate baseline across frequencies
then the unit signal is <code class="reqn">frequency x time</code>, i.e. signals that share the
same session and location also share the same baseline. In this case,
we assign <code>unit_dims=c(1,4)</code>.
</p>
<p>There are five baseline methods. They fit for different types of data.
Denote <code class="reqn">z</code> is an unit signal, <code class="reqn">z_0</code> is its baseline slice. Then
these baseline methods are:
</p>

<dl>
<dt><code>"percentage"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">
  \frac{z - \bar{z_{0}}}{\bar{z_{0}}} \times 100\%
</code>
</p>

</dd>
<dt><code>"sqrt_percentage"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">
  \frac{\sqrt{z} - \bar{\sqrt{z_{0}}}}{\bar{\sqrt{z_{0}}}} \times 100\%
</code>
</p>

</dd>
<dt><code>"decibel"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">
  10 \times ( \log_{10}(z) - \bar{\log_{10}(z_{0})} )
</code>
</p>

</dd>
<dt><code>"zscore"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">
  \frac{z-\bar{z_{0}}}{sd(z_{0})}
</code>
</p>

</dd>
<dt><code>"sqrt_zscore"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">
  \frac{\sqrt{z}-\bar{\sqrt{z_{0}}}}{sd(\sqrt{z_{0}})}
</code>
</p>

</dd>
</dl>



<h3>Value</h3>

<p>Contrast array with the same dimension as <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(dipsaus)
set.seed(1)

# Generate sample data
dims = c(10,20,30,2)
x = array(rnorm(prod(dims))^2, dims)

# Set baseline window to be arbitrary 10 timepoints
baseline_window = sample(30, 10)

# ----- baseline percentage change ------

# Using base functions
re1 &lt;- aperm(apply(x, c(1,2,4), function(y){
  m &lt;- mean(y[baseline_window])
  (y/m - 1) * 100
}), c(2,3,1,4))

# Using dipsaus
re2 &lt;- baseline_array(x, 3, baseline_window, c(1,2,4),
                      method = 'percentage')

# Check different, should be very tiny (double precisions)
range(re2 - re1)

# Check speed for large dataset
if(interactive()){
  dims = c(200,20,300,2)
  x = array(rnorm(prod(dims))^2, dims)
  # Set baseline window to be arbitrary 10 timepoints
  baseline_window = seq_len(100)
  f1 &lt;- function(){
    aperm(apply(x, c(1,2,4), function(y){
      m &lt;- mean(y[baseline_window])
      (y/m - 1) * 100
    }), c(2,3,1,4))
  }
  f2 &lt;- function(){
    # equivalent as bl = x[,,baseline_window, ]
    #
    baseline_array(x, along_dim = 3,
                   baseline_indexpoints = baseline_window,
                   unit_dims = c(1,2,4), method = 'sqrt_percentage')
  }
  microbenchmark::microbenchmark(f1(), f2(), times = 3L)
}



</code></pre>

<hr>
<h2 id='capture_expr'>Captures Evaluation Output of Expressions as One Single String</h2><span id='topic+capture_expr'></span>

<h3>Description</h3>

<p>Evaluate expression and captures output as characters, then
concatenate as one single string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capture_expr(expr, collapse = "\n", type = c("output", "message"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="capture_expr_+3A_expr">expr</code></td>
<td>
<p>R expression</p>
</td></tr>
<tr><td><code id="capture_expr_+3A_collapse">collapse</code></td>
<td>
<p>character to concatenate outputs</p>
</td></tr>
<tr><td><code id="capture_expr_+3A_type">type</code>, <code id="capture_expr_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="utils.html#topic+capture.output">capture.output</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character of length 1: output captured by
<code><a href="utils.html#topic+capture.output">capture.output</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- data.frame(a=1:10)
x_str &lt;- capture_expr({
  print(x)
})

x_str

cat(x_str)


</code></pre>

<hr>
<h2 id='cat2'>Color Output</h2><span id='topic+cat2'></span>

<h3>Description</h3>

<p>Color Output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cat2(
  ...,
  level = "DEBUG",
  print_level = FALSE,
  file = "",
  sep = " ",
  fill = FALSE,
  labels = NULL,
  append = FALSE,
  end = "\n",
  pal = list(DEBUG = "grey60", INFO = "#1d9f34", WARNING = "#ec942c", ERROR = "#f02c2c",
    FATAL = "#763053", DEFAULT = "grey60"),
  use_cli = TRUE,
  bullet = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cat2_+3A_...">...</code></td>
<td>
<p>to be printed</p>
</td></tr>
<tr><td><code id="cat2_+3A_level">level</code></td>
<td>
<p>'DEBUG', 'INFO', 'WARNING', 'ERROR', or 'FATAL' (total 5 levels)</p>
</td></tr>
<tr><td><code id="cat2_+3A_print_level">print_level</code></td>
<td>
<p>if true, prepend levels before messages</p>
</td></tr>
<tr><td><code id="cat2_+3A_file">file</code>, <code id="cat2_+3A_sep">sep</code>, <code id="cat2_+3A_fill">fill</code>, <code id="cat2_+3A_labels">labels</code>, <code id="cat2_+3A_append">append</code></td>
<td>
<p>pass to <code>base::cat</code></p>
</td></tr>
<tr><td><code id="cat2_+3A_end">end</code></td>
<td>
<p>character to append to the string</p>
</td></tr>
<tr><td><code id="cat2_+3A_pal">pal</code></td>
<td>
<p>a named list defining colors see details</p>
</td></tr>
<tr><td><code id="cat2_+3A_use_cli">use_cli</code></td>
<td>
<p>logical, whether to use package 'cli'</p>
</td></tr>
<tr><td><code id="cat2_+3A_bullet">bullet</code></td>
<td>
<p>character, if use 'cli', which symbol to show. see
<code><a href="cli.html#topic+symbol">symbol</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are five levels of colors by default: 'DEBUG', 'INFO', 'WARNING', 'ERROR',
or FATAL. Default colors are: 'DEBUG' (<code>grey60</code>), 'INFO' (<code>#1d9f34</code>), 'WARNING'
(<code>#ec942c</code>), 'ERROR' (<code>#f02c2c</code>), 'FATAL' (<code>#763053</code>) and
'DEFAULT' (<code>#000000</code>, black). If level is not in preset five levels,
the color will be &quot;default&quot;-black color.
</p>


<h3>Value</h3>

<p>none.
</p>

<hr>
<h2 id='check_installed_packages'>Check If Packages Are Installed, Returns Missing Packages</h2><span id='topic+check_installed_packages'></span>

<h3>Description</h3>

<p>Check If Packages Are Installed, Returns Missing Packages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_installed_packages(
  pkgs,
  libs = base::.libPaths(),
  auto_install = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_installed_packages_+3A_pkgs">pkgs</code></td>
<td>
<p>vector of packages to install</p>
</td></tr>
<tr><td><code id="check_installed_packages_+3A_libs">libs</code></td>
<td>
<p>paths of libraries</p>
</td></tr>
<tr><td><code id="check_installed_packages_+3A_auto_install">auto_install</code></td>
<td>
<p>automatically install packages if missing</p>
</td></tr>
<tr><td><code id="check_installed_packages_+3A_...">...</code></td>
<td>
<p>other parameters for <code>install.packages</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>package names that are not installed
</p>

<hr>
<h2 id='clear_env'>Function to clear all elements within environment</h2><span id='topic+clear_env'></span>

<h3>Description</h3>

<p>Function to clear all elements within environment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clear_env(env, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clear_env_+3A_env">env</code></td>
<td>
<p>environment to clean, can be an R environment, or a
<code><a href="#topic+fastmap2">fastmap2</a></code> instance</p>
</td></tr>
<tr><td><code id="clear_env_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
env = new.env()
env$a = 1
print(as.list(env))

clear_env(env)
print(as.list(env))

</code></pre>

<hr>
<h2 id='col2hexStr'>Convert color to Hex string</h2><span id='topic+col2hexStr'></span>

<h3>Description</h3>

<p>Convert color to Hex string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col2hexStr(col, alpha = NULL, prefix = "#", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col2hexStr_+3A_col">col</code></td>
<td>
<p>character or integer indicating color</p>
</td></tr>
<tr><td><code id="col2hexStr_+3A_alpha">alpha</code></td>
<td>
<p><code>NULL</code> or numeric, transparency. See <code>grDevices::rgb</code></p>
</td></tr>
<tr><td><code id="col2hexStr_+3A_prefix">prefix</code></td>
<td>
<p>character, default is <code>"#"</code></p>
</td></tr>
<tr><td><code id="col2hexStr_+3A_...">...</code></td>
<td>
<p>passing to  <code><a href="grDevices.html#topic+adjustcolor">adjustcolor</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>col2hexStr</code> converts colors such as 1, 2, 3, &quot;red&quot;, &quot;blue&quot;, ... into
hex strings that can be easily recognized by 'HTML', 'CSS' and 'JavaScript'.
Internally this function uses <code><a href="grDevices.html#topic+adjustcolor">adjustcolor</a></code> with two differences:
</p>

<ol>
<li><p> the returned hex string does not contain alpha value if <code>alpha</code> is <code>NULL</code>;
</p>
</li>
<li><p> the leading prefix &quot;#&quot; can be customized
</p>
</li></ol>



<h3>Value</h3>

<p>characters containing the hex value of each color. See details
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+adjustcolor">adjustcolor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
col2hexStr(1, prefix = '0x')      # "0x000000"
col2hexStr('blue')                # "#0000FF"

# Change default palette, see "grDevices::colors()"
grDevices::palette(c('orange3', 'skyblue1'))
col2hexStr(1)                     # Instead of #000000, #CD8500

</code></pre>

<hr>
<h2 id='collapse'>Collapse Sensors And Calculate Summations/Mean</h2><span id='topic+collapse'></span>

<h3>Description</h3>

<p>Collapse Sensors And Calculate Summations/Mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collapse(x, keep, average = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collapse_+3A_x">x</code></td>
<td>
<p>A numeric multi-mode tensor (array), without <code>NA</code></p>
</td></tr>
<tr><td><code id="collapse_+3A_keep">keep</code></td>
<td>
<p>Which dimension to keep</p>
</td></tr>
<tr><td><code id="collapse_+3A_average">average</code></td>
<td>
<p>collapse to sum or mean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a collapsed array with values to be mean or summation along
collapsing dimensions
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
x = matrix(1:16, 4)

# Keep the first dimension and calculate sums along the rest
collapse(x, keep = 1)
rowSums(x)  # Should yield the same result

# Example 2
x = array(1:120, dim = c(2,3,4,5))
result = collapse(x, keep = c(3,2))
compare = apply(x, c(3,2), sum)
sum(abs(result - compare)) # The same, yield 0 or very small number (1e-10)

# Example 3 (performance)
# Small data, no big difference, even slower
x = array(rnorm(240), dim = c(4,5,6,2))
microbenchmark::microbenchmark(
  result = collapse(x, keep = c(3,2)),
  compare = apply(x, c(3,2), sum),
  times = 1L, check = function(v){
    max(abs(range(do.call('-', v)))) &lt; 1e-10
  }
)

# large data big difference
x = array(rnorm(prod(300,200,105)), c(300,200,105,1))
microbenchmark::microbenchmark(
  result = collapse(x, keep = c(3,2)),
  compare = apply(x, c(3,2), sum),
  times = 1L , check = function(v){
    max(abs(range(do.call('-', v)))) &lt; 1e-10
  })

</code></pre>

<hr>
<h2 id='compoundInput2'>Compound input that combines and extends shiny inputs</h2><span id='topic+compoundInput2'></span>

<h3>Description</h3>

<p>Compound input that combines and extends shiny inputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compoundInput2(
  inputId,
  label = "Group",
  components = shiny::tagList(),
  initial_ncomp = 1,
  min_ncomp = 0,
  max_ncomp = 10,
  value = NULL,
  label_color = NA,
  max_height = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compoundInput2_+3A_inputid">inputId</code></td>
<td>
<p>character, shiny input ID</p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_label">label</code></td>
<td>
<p>character, will show on each groups</p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_components">components</code></td>
<td>
<p>'HTML' tags that defines and combines HTML components within groups</p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_initial_ncomp">initial_ncomp</code></td>
<td>
<p>numeric initial number of groups to show, non-negative</p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_min_ncomp">min_ncomp</code></td>
<td>
<p>minimum number of groups, default is 0, non-negative</p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_max_ncomp">max_ncomp</code></td>
<td>
<p>maximum number of groups, default is 10, greater or equal
than <code>min_ncomp</code></p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_value">value</code></td>
<td>
<p>list of lists, initial values of each inputs, see examples.</p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_label_color">label_color</code></td>
<td>
<p>integer or characters, length of 1 or <code>max_ncomp</code>, assigning colors to each group labels; default is <code>NA</code>, and try to get color from foreground <code>par("fg")</code></p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_max_height">max_height</code></td>
<td>
<p>maximum height of the widget</p>
</td></tr>
<tr><td><code id="compoundInput2_+3A_...">...</code></td>
<td>
<p>will be ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'HTML' tags
</p>


<h3>See Also</h3>

<p><code><a href="#topic+updateCompoundInput2">updateCompoundInput2</a></code> for how to update inputs
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(shiny); library(dipsaus)
compoundInput2(
  'input_id', 'Group',
    div(
    textInput('text', 'Text Label'),
    sliderInput('sli', 'Slider Selector', value = 0, min = 1, max = 1)
  ),
  label_color = 1:10,
  value = list(
    list(text = '1'),  # Set text first group to be "1"
    list(),                # no settings for second group
    list(sli = 0.2)    # sli = 0.2 for the third group
  ))

# Source - system.file('demo/example-compountInput2.R', package='dipsaus')

# demo('example-compountInput2', package='dipsaus')

library(shiny)
library(dipsaus)
ui &lt;- fluidPage(
  fluidRow(
    column(
      width = 4,
      compoundInput2(
        'compound', 'Group Label', label_color = c(NA,1:9),
        components = div(
          textInput('txt', 'Text'),
          selectInput('sel', 'Select', choices = 1:10, multiple = TRUE),
          sliderInput('sli', 'Slider', max=1, min=0, val=0.5)
        ),
        value = list(
          list(txt = '1'),  # Set text first group to be "1"
          '',                # no settings for second group
          list(sli = 0.2)    # sli = 0.2 for the third group
        )
      ),
      hr(),
      actionButton('action', 'Update compound input')
    )
  )
)

server &lt;- function(input, output, session) {
  observe({
    print(input$compound)
  })
  observe({
    # Getting specific input at group 1
    print(input$compound_txt_1)
  })
  observeEvent(input$action, {
    updateCompoundInput2(
      session, 'compound',
      # Update values for each components
      value = lapply(1:5, function(ii){
        list(
          txt = sample(LETTERS, 1),
          sel = sample(1:10, 3),
          sli = runif(1)
        )
      }), ncomp = NULL, txt = list(label = as.character(Sys.time())))
  })
}

if( interactive() ){
  shinyApp(ui, server, options = list(launch.browser = TRUE))
}

</code></pre>

<hr>
<h2 id='decorate_function'>Python-style decorator</h2><span id='topic+decorate_function'></span><span id='topic++25D+25'></span>

<h3>Description</h3>

<p>Python-style decorator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decorate_function(orig, decor, ...)

lhs %D% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decorate_function_+3A_orig">orig</code>, <code id="decorate_function_+3A_lhs">lhs</code></td>
<td>
<p>any function</p>
</td></tr>
<tr><td><code id="decorate_function_+3A_decor">decor</code>, <code id="decorate_function_+3A_rhs">rhs</code></td>
<td>
<p>decorator function that takes <code>orig</code> as its first
argument</p>
</td></tr>
<tr><td><code id="decorate_function_+3A_...">...</code></td>
<td>
<p>passed to <code>decor</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>

# Example 1: basic usage
# Decorator that prints summary of results and return results itself
verbose_summary &lt;- function(...){
  summary_args &lt;- list(...)
  function(f){
    function(...){
      results &lt;- f(...)


      print(do.call(
        summary,
        c(list(results), summary_args)
      ))
      results

    }
  }

}

# runs as.list, but through verbose_summary
as_list2 &lt;- decorate_function(as.list, verbose_summary)

# run test
res &lt;- as_list2(1:3)  # will verbose summary
identical(res, as.list(1:3))

# Example 2
x &lt;- 1:20
y &lt;- x + rnorm(20)

# decorator, add a line with slope 1 with given intercept
abline_xy &lt;- function(b){
  function(f){
    function(...){
      f(...)
      intercept &lt;- get_dots('intercept', 0, ...)
      abline(a = intercept, b = b)
    }
  }
}

# orig, plot whatever x vs jittered+intercept
plot_xy &lt;- function(x, intercept = rnorm(1)){
  plot(x, jitter(x, amount = 3) + intercept)
}

# new function that decorate plot_xy with abline_xy, and
# returns the intercept
plot_xy2 &lt;- decorate_function(plot_xy, abline_xy, b = 1)

# alternatively, you might also want to try
plot_xy2 &lt;- plot_xy %D% abline_xy(b = 1)

plot_xy2(x = 1:20)

</code></pre>

<hr>
<h2 id='deparse_svec'>Convert Integer Vectors To String</h2><span id='topic+deparse_svec'></span>

<h3>Description</h3>

<p>Convert Integer Vectors To String
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deparse_svec(
  nums,
  connect = "-",
  concatenate = TRUE,
  collapse = ",",
  max_lag = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deparse_svec_+3A_nums">nums</code></td>
<td>
<p>integer vector</p>
</td></tr>
<tr><td><code id="deparse_svec_+3A_connect">connect</code></td>
<td>
<p>character used to connect consecutive numbers</p>
</td></tr>
<tr><td><code id="deparse_svec_+3A_concatenate">concatenate</code></td>
<td>
<p>connect strings if there are multiples</p>
</td></tr>
<tr><td><code id="deparse_svec_+3A_collapse">collapse</code></td>
<td>
<p>if concatenate, character used to connect strings</p>
</td></tr>
<tr><td><code id="deparse_svec_+3A_max_lag">max_lag</code></td>
<td>
<p>defines &quot;consecutive&quot;, min = 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>strings representing the input vector. For example, <code>c(1, 2, 3)</code> returns &quot;1-3&quot;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+parse_svec">parse_svec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>deparse_svec(c(1:10, 15:18))
</code></pre>

<hr>
<h2 id='dipsaus-rstudio-shortcuts'>Register customized R code to 'RStudio' shortcuts</h2><span id='topic+dipsaus-rstudio-shortcuts'></span><span id='topic+rs_add_insertion_shortcut'></span><span id='topic+rs_add_shortcut'></span><span id='topic+rs_remove_shortcut'></span><span id='topic+rs_show_shortcut'></span><span id='topic+rs_quick_debug'></span>

<h3>Description</h3>

<p>'RStudio' keyboard shortcuts is handy, however, it is non-trivial
to set shortcuts that run customized code. The proposing functions
allow 10 customized R expressions to be registered. The first five
(1 to 5) are interactive shortcuts, the rest five
(6 to 10) are non-interactive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_add_insertion_shortcut(which, txt, force = FALSE)

rs_add_shortcut(which, expr, force = FALSE, quoted = FALSE)

rs_remove_shortcut(which)

rs_show_shortcut(which)

rs_quick_debug(env = globalenv())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dipsaus-rstudio-shortcuts_+3A_which">which</code></td>
<td>
<p>integer from 1 to 10, which keyboard shortcut to edit</p>
</td></tr>
<tr><td><code id="dipsaus-rstudio-shortcuts_+3A_txt">txt</code></td>
<td>
<p>an insertion/replacement shortcut to add</p>
</td></tr>
<tr><td><code id="dipsaus-rstudio-shortcuts_+3A_force">force</code></td>
<td>
<p>whether to remove existing shortcut if the hot-key has been
registered</p>
</td></tr>
<tr><td><code id="dipsaus-rstudio-shortcuts_+3A_expr">expr</code></td>
<td>
<p>expression to run if shortcut is pressed</p>
</td></tr>
<tr><td><code id="dipsaus-rstudio-shortcuts_+3A_quoted">quoted</code></td>
<td>
<p>whether <code>expr</code> is quoted, default is false</p>
</td></tr>
<tr><td><code id="dipsaus-rstudio-shortcuts_+3A_env">env</code></td>
<td>
<p>environment to debug code; default is global environment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two steps to register an 'RStudio' keyboard shortcut.
</p>
<p>1. Please enable the shortcuts by opening
<code>'Tools' &gt; 'Modify Keyboard Shortcuts'</code> in 'RStudio' menu bar;
search and locate add-in items starting with 'Dipsaus'; register hot-keys
of your choices, and then save. It is recommended that these
keys are <code>'Alt' + 1</code> to <code>'Alt' + 0</code>. On Apple, 'Alt' is
equivalent to 'option' key.
</p>
<p>2. run <code>rs_add_insertion_shortcut</code> or <code>rs_add_shortcut</code> to
customize the behaviors of each shortcuts; see Examples.
</p>
<p>Function <code>rs_quick_debug</code> provides quick way to debug a script or
function without messing up the code. The script only works in 'RStudio'.
When executing the quick-debug function, the cursor context will be
automatically resolved and nearest debugging code blocks will be searched
and executed.
To enable this feature, add a line with <code>"# DIPSAUS: DEBUG START"</code> in
your code, followed by debugging code blocks in comments. The script will
figure it out. Since the 'RStudio' context will be obtained when executing
the function, it is recommended to add this function to your shortcuts.
By default, if the shortcut-1 is unset, this function will be executed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# Need to run in RStudio
# Please read the Section 'Details' carefully

# --------------------------------------------

# I assume the shortcuts are Alt+1,2,...,9,0,
# corresponding to shortcuts 1 - 10

# Adds an insertion to Alt+9
rs_add_insertion_shortcut(9, " %?&lt;-% ", force = TRUE)
# restart RStudio and try `Alt+9`


# Adds an expression to Alt+2
rs_add_shortcut(2, {
  expr &lt;- sprintf("system.time({\n%s\n})\n",
                  rstudioapi::selectionGet()$value)
  cat(expr)
  eval(parse(text = expr))
}, force = TRUE)

# Select any valid R code and press Alt+1

# --------------------------------------------

# run this to set your shortcut (one-time setup)
rs_add_shortcut(1, { dipsaus::rs_quick_debug() })

# Add debug feature: insert the following comment anywhere in your code
# You may open a new script in the RStudio

# DIPSAUS: DEBUG START
# message("Debugging...")
# a &lt;- 1
# print(a)
# message("Finished")


# Place your cursor here, press the shortcut key


## End(Not run)

</code></pre>

<hr>
<h2 id='do_aggregate'>Make aggregate pipe-friendly</h2><span id='topic+do_aggregate'></span>

<h3>Description</h3>

<p>A pipe-friendly wrapper of <code><a href="stats.html#topic+aggregate">aggregate</a></code>
when using formula as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_aggregate(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_aggregate_+3A_x">x</code></td>
<td>
<p>an R object</p>
</td></tr>
<tr><td><code id="do_aggregate_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="stats.html#topic+aggregate">aggregate</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Results from <code><a href="stats.html#topic+aggregate">aggregate</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+aggregate">aggregate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)
data(ToothGrowth)

ToothGrowth %&gt;%
  do_aggregate(len ~ ., mean)

</code></pre>

<hr>
<h2 id='do_nothing'>A dummy function that literally does nothing</h2><span id='topic+do_nothing'></span>

<h3>Description</h3>

<p>A dummy function that literally does nothing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_nothing(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_nothing_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='drop_nulls'>Drop <code>NULL</code> values from list or vectors</h2><span id='topic+drop_nulls'></span>

<h3>Description</h3>

<p>Drop <code>NULL</code> values from list or vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drop_nulls(x, .invalids = list("is.null"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drop_nulls_+3A_x">x</code></td>
<td>
<p>list to check</p>
</td></tr>
<tr><td><code id="drop_nulls_+3A_.invalids">.invalids</code></td>
<td>
<p>a list of functions, or function name. Default is 'is.null'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list or vector containing no invalid values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- list(NULL,NULL,1,2)
drop_nulls(x)  # length of 2

</code></pre>

<hr>
<h2 id='eval_dirty'>Evaluate expressions</h2><span id='topic+eval_dirty'></span>

<h3>Description</h3>

<p>Evaluate expressions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_dirty(expr, env = parent.frame(), data = NULL, quoted = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_dirty_+3A_expr">expr</code></td>
<td>
<p>R expression or 'rlang' quo</p>
</td></tr>
<tr><td><code id="eval_dirty_+3A_env">env</code></td>
<td>
<p>environment to evaluate</p>
</td></tr>
<tr><td><code id="eval_dirty_+3A_data">data</code></td>
<td>
<p>dataframe or list</p>
</td></tr>
<tr><td><code id="eval_dirty_+3A_quoted">quoted</code></td>
<td>
<p>Is the expression quoted? By default, this is <code>TRUE</code>.
This is useful when you don't want to use an expression that is stored in a
variable; see examples</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>eval_dirty</code> uses <code>base::eval()</code> function to evaluate
expressions. Compare to <code>rlang::eval_tidy</code>, which won't affect original
environment, <code>eval_dirty</code> causes changes to the environment. Therefore
if <code>expr</code> contains assignment, environment will be changed in this case.
</p>


<h3>Value</h3>

<p>the executed results of <code>expr</code> evaluated with side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
env = new.env(); env$a = 1
rlang::eval_tidy(quote({a &lt;- 111}), env = env)
print(env$a)  # Will be 1. This is because eval_tidy has no side effect

eval_dirty(quote({a &lt;- 111}), env)
print(env$a)  # 111, a is changed

# Unquoted case
eval_dirty({a &lt;- 222}, env, quoted = FALSE)
print(env$a)

</code></pre>

<hr>
<h2 id='fancyFileInput'>Shiny drag-and-drop file input</h2><span id='topic+fancyFileInput'></span>

<h3>Description</h3>

<p>Fancy drag and drop file upload for <code>shiny</code> apps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fancyFileInput(
  inputId,
  label,
  width = NULL,
  after_content = "Drag &amp; drop, or button",
  size = c("s", "m", "l", "xl"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fancyFileInput_+3A_inputid">inputId</code></td>
<td>
<p>the input slot that will be used to access the value</p>
</td></tr>
<tr><td><code id="fancyFileInput_+3A_label">label</code></td>
<td>
<p>display label for the control, or NULL for no label.</p>
</td></tr>
<tr><td><code id="fancyFileInput_+3A_width">width</code></td>
<td>
<p>the width of the input</p>
</td></tr>
<tr><td><code id="fancyFileInput_+3A_after_content">after_content</code></td>
<td>
<p>tiny content that is to be displayed below the input box</p>
</td></tr>
<tr><td><code id="fancyFileInput_+3A_size">size</code></td>
<td>
<p>height of the widget, choices are <code>'s'</code>, <code>'m'</code>, <code>'l'</code>, and <code>'xl'</code></p>
</td></tr>
<tr><td><code id="fancyFileInput_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="shiny.html#topic+fileInput">fileInput</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>See <code><a href="shiny.html#topic+fileInput">fileInput</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(shiny)
library(dipsaus)

ui &lt;- basicPage(
  fancyFileInput('file_input', "Please upload")
)

if(interactive()) {
  shinyApp(
    ui, server = function(input, output, session){},
    options = list(launch.browser = TRUE)
  )
}

</code></pre>

<hr>
<h2 id='fastcov2'>Calculate Covariance Matrix in Parallel</h2><span id='topic+fastcov2'></span>

<h3>Description</h3>

<p>Speed up covariance calculation for large matrices. The
default behavior is similar <code><a href="stats.html#topic+cov">cov</a></code>. Please remove any <code>NA</code>
prior to calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcov2(x, y = NULL, col1, col2, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcov2_+3A_x">x</code></td>
<td>
<p>a numeric vector, matrix or data frame; a matrix is highly
recommended to maximize the performance</p>
</td></tr>
<tr><td><code id="fastcov2_+3A_y">y</code></td>
<td>
<p>NULL (default) or a vector, matrix or data frame with compatible
dimensions to x; the default is equivalent to <code>y = x</code></p>
</td></tr>
<tr><td><code id="fastcov2_+3A_col1">col1</code></td>
<td>
<p>integers indicating the subset (columns) of <code>x</code> to
calculate the covariance; default is all the columns</p>
</td></tr>
<tr><td><code id="fastcov2_+3A_col2">col2</code></td>
<td>
<p>integers indicating the subset (columns) of <code>y</code> to
calculate the covariance; default is all the columns</p>
</td></tr>
<tr><td><code id="fastcov2_+3A_df">df</code></td>
<td>
<p>a scalar indicating the degrees of freedom; default is
<code>nrow(x)-1</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A covariance matrix of <code>x</code> and <code>y</code>. Note that there is no
<code>NA</code> handling. Any missing values will lead to <code>NA</code> in the
resulting covariance matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- matrix(rnorm(400), nrow = 100)

# Call `cov(x)` to compare
fastcov2(x)

# Calculate covariance of subsets
fastcov2(x, col1 = 1, col2 = 1:2)

# Speed comparison
x &lt;- matrix(rnorm(100000), nrow = 1000)
microbenchmark::microbenchmark(
  fastcov2 = {
    fastcov2(x, col1 = 1:50, col2 = 51:100)
  },
  cov = {
    cov(x[,1:50], x[,51:100])
  },
  unit = 'ms', times = 10
)


</code></pre>

<hr>
<h2 id='fastmap2'>A Wrapper for <code>fastmap::fastmap</code></h2><span id='topic+fastmap2'></span><span id='topic++5B+5B.fastmap2'></span><span id='topic++24.fastmap2'></span><span id='topic++5B+5B+3C-.fastmap2'></span><span id='topic++24+3C-.fastmap2'></span><span id='topic++5B.fastmap2'></span><span id='topic++5B+3C-.fastmap2'></span><span id='topic+names.fastmap2'></span><span id='topic+print.fastmap2'></span><span id='topic+length.fastmap2'></span><span id='topic+as.list.fastmap2'></span>

<h3>Description</h3>

<p><code><a href="fastmap.html#topic+fastmap">fastmap</a></code>
provides a key-value store where the keys are strings and the
values are any R objects. It differs from normal environment that
<code><a href="fastmap.html#topic+fastmap">fastmap</a></code> avoids memory leak. <code>fastmap2</code>
is a wrapper for <code>fastmap</code>, which provides several generic
functions such that it has similar behaviors to lists or
environments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastmap2(missing_default = NULL)

## S3 method for class 'fastmap2'
x[[name]]

## S3 method for class 'fastmap2'
x$name

## S3 replacement method for class 'fastmap2'
x[[name]] &lt;- value

## S3 replacement method for class 'fastmap2'
x$name &lt;- value

## S3 method for class 'fastmap2'
x[i, j = NULL, ...]

## S3 replacement method for class 'fastmap2'
x[i, j = NULL, ...] &lt;- value

## S3 method for class 'fastmap2'
names(x)

## S3 method for class 'fastmap2'
print(x, ...)

## S3 method for class 'fastmap2'
length(x)

## S3 method for class 'fastmap2'
as.list(x, recursive = FALSE, sorted = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastmap2_+3A_missing_default">missing_default</code></td>
<td>
<p>passed to <code>fastmap::fastmap</code></p>
</td></tr>
<tr><td><code id="fastmap2_+3A_x">x</code></td>
<td>
<p>a <code>'fastmap2'</code> object</p>
</td></tr>
<tr><td><code id="fastmap2_+3A_name">name</code></td>
<td>
<p>name, or key of the value</p>
</td></tr>
<tr><td><code id="fastmap2_+3A_value">value</code></td>
<td>
<p>any R object</p>
</td></tr>
<tr><td><code id="fastmap2_+3A_i">i</code>, <code id="fastmap2_+3A_j">j</code></td>
<td>
<p>vector of names</p>
</td></tr>
<tr><td><code id="fastmap2_+3A_...">...</code></td>
<td>
<p>passed to other methods</p>
</td></tr>
<tr><td><code id="fastmap2_+3A_recursive">recursive</code></td>
<td>
<p>whether to recursively apply <code><a href="base.html#topic+as.list">as.list</a></code></p>
</td></tr>
<tr><td><code id="fastmap2_+3A_sorted">sorted</code></td>
<td>
<p>whether to sort names; default is false</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>'fastmap2'</code> instance
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## --------------------------- Basic Usage --------------------------
map &lt;- fastmap2()
map$a = 1
map$b = 2
print(map)

map[c('a', 'b')]
# Alternative way
map['a', 'b']

map[c('c', 'd')] &lt;- 3:4
# or
map['e', 'f'] &lt;- 5:6

# The order is not guaranteed, unless sort=TRUE
as.list(map)
as.list(map, sort=TRUE)

names(map)
length(map)

## ----------------------- NULL value handles -----------------------
map$b &lt;- NULL
names(map)   # 'b' still exists!
as.list(map) # 'b' is NULL, but still there

# to remove 'b', you have to use `@remove` method
map$`@remove`('b')

## ---------------- Native fastmap::fastmap methods -----------------

# whether map has 'a'
map$`@has`('a')

# Remove a name from list
map$`@remove`('a')

# remove all from list
map$`@reset`()
print(map)

</code></pre>

<hr>
<h2 id='fastquantile'>Calculate single quantile for numerical values</h2><span id='topic+fastquantile'></span>

<h3>Description</h3>

<p>Slightly faster than <code><a href="stats.html#topic+quantile">quantile</a></code> with
<code>na.rm=TRUE</code>. The internal implementation uses the 'C++' function
<code>std::nth_element</code>, which is significantly faster than base R
implementation when the length of input <code>x</code> is less than <code>1e7</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastquantile(x, q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastquantile_+3A_x">x</code></td>
<td>
<p>numerical vector (integers or double)</p>
</td></tr>
<tr><td><code id="fastquantile_+3A_q">q</code></td>
<td>
<p>number from 0 to 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Identical to <code>quantile(x, q, na.rm=TRUE)</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# create input x with NAs
x &lt;- rnorm(10000)
x[sample(10000, 10)] &lt;- NA

# compute median
res &lt;- fastquantile(x, 0.5)
res

# base method
res == quantile(x, 0.5, na.rm = TRUE)
res == median(x, na.rm = TRUE)

# Comparison
microbenchmark::microbenchmark(
  {
    fastquantile(x, 0.5)
  },{
    quantile(x, 0.5, na.rm = TRUE)
  },{
    median(x, na.rm = TRUE)
  }
)

</code></pre>

<hr>
<h2 id='fastqueue2'>A Wrapper for <code>fastmap::fastqueue</code></h2><span id='topic+fastqueue2'></span><span id='topic++5B+5B.fastqueue2'></span><span id='topic++5B.fastqueue2'></span><span id='topic+print.fastqueue2'></span><span id='topic+length.fastqueue2'></span><span id='topic+as.list.fastqueue2'></span>

<h3>Description</h3>

<p>A Wrapper for <code>fastmap::fastqueue</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastqueue2(init = 20L, missing_default = NULL)

## S3 method for class 'fastqueue2'
x[[i]]

## S3 method for class 'fastqueue2'
x[i, j = NULL, ...]

## S3 method for class 'fastqueue2'
print(x, ...)

## S3 method for class 'fastqueue2'
length(x)

## S3 method for class 'fastqueue2'
as.list(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastqueue2_+3A_init">init</code>, <code id="fastqueue2_+3A_missing_default">missing_default</code></td>
<td>
<p>passed to <code>fastmap::fastqueue</code></p>
</td></tr>
<tr><td><code id="fastqueue2_+3A_x">x</code></td>
<td>
<p>a <code>'fastqueue2'</code> object</p>
</td></tr>
<tr><td><code id="fastqueue2_+3A_i">i</code>, <code id="fastqueue2_+3A_j">j</code></td>
<td>
<p>integer index</p>
</td></tr>
<tr><td><code id="fastqueue2_+3A_...">...</code></td>
<td>
<p>integer indices or passed to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>'fastqueue2'</code> instance
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- fastqueue2()

# add elements
x$madd(1, "b", function(){ "c" }, 4, "5")

# print information
print(x)

# get the second element without changing the queue
x[[2]]

# remove and get the first element
x$remove()

# the second item
x[[2]]

# first two items in a list
x[c(1,2)]

print(x)
as.list(x)

</code></pre>

<hr>
<h2 id='flex_div'>Generate Shiny element with arrangement automatically</h2><span id='topic+flex_div'></span>

<h3>Description</h3>

<p>Generate Shiny element with arrangement automatically
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flex_div(..., ncols = "auto")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flex_div_+3A_...">...</code></td>
<td>
<p>shiny UI elements</p>
</td></tr>
<tr><td><code id="flex_div_+3A_ncols">ncols</code></td>
<td>
<p>number of columns, either <code>"auto"</code> or
vector of positive integers</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If multiple numbers of columns are specified,
<code>flex_div</code> will guess the best size that will be applied.
For button UI, <code>flex_div</code> automatically add <code>"20px"</code>
on the top margin.
</p>


<h3>Value</h3>

<p>HTML objects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ui &lt;- flex_div(
  shiny::selectInput('sel', label = 'Select input',
                     choices = '', width = '100%'),
  shiny::textInput('id2', label = html_asis(' '), width = '100%',
                   value = 'Heights aligned'),
  actionButtonStyled('ok2', 'Button', width = '100%',),
  shiny::sliderInput('sl', 'Item 4', min = 1, max = 2,
                     value = 1.5, width = '100%'),
  shiny::fileInput('aa', 'item 5', width = '100%'),
  ncols = c(2,3) # Try to assign 2 or 3 items per column
)
if(interactive()){
  shiny::shinyApp(ui = shiny::fluidPage(shiny::fluidRow(ui)),
                  server = function(input, output, session){})
}
</code></pre>

<hr>
<h2 id='forelse'>Python-style <code>"for-else"</code> function</h2><span id='topic+forelse'></span>

<h3>Description</h3>

<p>Provide Python-style <code>"for-else"</code> that works as
follows: for each element, execute &quot;for&quot; block, if there is break
while executing &quot;for&quot; block, then just stop and ignore the &quot;else&quot;
statement, otherwise run &quot;else&quot; block.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forelse(x, FUN, ALT_FUN = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forelse_+3A_x">x</code></td>
<td>
<p>iterative R objects such as list, vector, etc.</p>
</td></tr>
<tr><td><code id="forelse_+3A_fun">FUN</code></td>
<td>
<p>function that applies to each <code>x</code></p>
</td></tr>
<tr><td><code id="forelse_+3A_alt_fun">ALT_FUN</code></td>
<td>
<p>function that takes no argument or other types of R
object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If any <code>FUN</code> returns anything other than <code>NULL</code>,
then the function returns the first none <code>NULL</code> object. If
all <code>x</code> fed to <code>FUN</code> return <code>NULL</code>, then this
function returns <code>ALT_FUN</code> (if <code>ALT_FUN</code> is not a function)
or the result of <code>ALT_FUN()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --------------------------- Basic Usage ------------------------------

# 1. ALT_FUN get executed because FUN returns NULL for all items in x
forelse(
  1:10,
  function(x){
    cat('The input is ', x, end = '\n')
    if( x &gt; 10) return(x) else return(NULL)
  },
  function(){
    cat('ALT_FUN is executed!\n')
    'wow'
  }
)

# 2. FUN returns non-NULL object
forelse(
  1:10,
  function(x){
    cat('The input is ', x, end = '\n')
    if( x %% 2 == 0 ) return(x) else return(NULL)
  },
  'wow'
)

# --------------------------- Performance ------------------------------
FUN &lt;- function(x){
  Sys.sleep(0.01)
  if( x %% 2 == 0 ) return(x) else return(NULL)
}

microbenchmark::microbenchmark({
  forelse(1:10, FUN, 'wow')
}, {
  y &lt;- unlist(lapply(1:10, FUN))
  if(length(y)){
    y &lt;- y[[1]]
  }else{
    y &lt;- 'wow'
  }
}, {
  y &lt;- NULL
  for(x in 1:10){ y &lt;- FUN(x) }
  if(is.null(y)){ y &lt;- 'wow' }
}, times = 3)


</code></pre>

<hr>
<h2 id='get_cpu'>Defunct Functions in Package <span class="pkg">dipsaus</span>
The functions or variables listed here are no longer part of the package.</h2><span id='topic+get_cpu'></span><span id='topic+dipsaus-defunct'></span>

<h3>Description</h3>

<p>Defunct Functions in Package <span class="pkg">dipsaus</span>
The functions or variables listed here are no longer part of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cpu()
</code></pre>

<hr>
<h2 id='get_credential'>Generate a random password</h2><span id='topic+get_credential'></span>

<h3>Description</h3>

<p>Please note that this function is not meant to be used in
production. It is not meant to be used for highly secured
cryptographic purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_credential(
  master_password,
  method = c("get_or_create", "replace", "query"),
  service = NULL,
  special_chr = "~`! @#$%^&amp;*()_-+={[}]|:;'&lt;,&gt;.?/",
  tokenfile = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_credential_+3A_master_password">master_password</code></td>
<td>
<p>a master password that only you know, should have
at least 8 characters</p>
</td></tr>
<tr><td><code id="get_credential_+3A_method">method</code></td>
<td>
<p>whether to query token map, or to create the password,
choices are <code>'get_or_create'</code> (default), <code>'replace'</code>,
<code>'query'</code>; see 'Details'</p>
</td></tr>
<tr><td><code id="get_credential_+3A_service">service</code></td>
<td>
<p>service name, must only contains letters, digits, equal sign,
underscore, comma, dot, dash</p>
</td></tr>
<tr><td><code id="get_credential_+3A_special_chr">special_chr</code></td>
<td>
<p>special characters allowed in the password</p>
</td></tr>
<tr><td><code id="get_credential_+3A_tokenfile">tokenfile</code></td>
<td>
<p>a file containing all the tokens. Warning: if you lose the
token book, it is hard (not impossible, but impractical) to restore
the passwords</p>
</td></tr>
<tr><td><code id="get_credential_+3A_verbose">verbose</code></td>
<td>
<p>whether to print out service names; default is false</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please note that this function is not meant to be used in
production or anything that requires high security level. This is most
likely for my personal use since I am tired of
storing the passwords on the cloud or having to buy the services.
</p>
<p>The encryption adopts <code>'sha256'</code> algorithm provided by
<code><a href="digest.html#topic+digest">digest</a></code> function. To restore a password,
you will need twp components: <code>master_password</code>, a token book (
<code>tokenfile</code>). If any of them is missing, then the password is lost.
Please store the token book properly (for example, in 'Dropbox' vault).
</p>
<p>The token book could be shared. Anyone who do not have master password will
be unlikely to restore the service password. Do not share the master password
with anyone other than yourself.
</p>
<p>By default, <code>method='get_or_create'</code> will try to retrieve existing
tokens to generate password. If the token is missing, then a new token
will be generated. The <code>method='replace'</code> will ignore existing tokens
and directly create a new one.
</p>


<h3>Value</h3>

<p>If method is <code>'query'</code>, returns token map; otherwise returns
the password itself
</p>


<h3>See Also</h3>

<p><code><a href="digest.html#topic+digest">digest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tokenfile &lt;- tempfile()

# ---------- Create a password and store the tokens to token book ------
pass1 &lt;- get_credential(
  master_password = "my password",
  service = "google.com:my_username",
  special_chr = "@#$%^&amp;*",
  tokenfile = tokenfile
)
print(pass1)

# ---------- Query existing tokens ------
token_params &lt;- get_credential(
  method = "query",
  tokenfile = tokenfile,
  verbose = TRUE
)

print(token_params)

# ---------- retrieve stored password ----------
pass2 &lt;- get_credential(
  master_password = "my password",
  service = "google.com",
  tokenfile = tokenfile
)
identical(pass1, pass2)

# Using wrong master password
pass3 &lt;- get_credential(
  master_password = "wrong password",
  service = "google.com",
  tokenfile = tokenfile
)
identical(pass1, pass3)

# ---------- Replace token ----------
# Existing token will be replaced with a new token
pass4 &lt;- get_credential(
  master_password = "my password",
  method = "replace",
  service = "google.com",
  special_chr = "@#$%^&amp;*",
  tokenfile = tokenfile
)
print(pass4)
identical(pass1, pass4)

</code></pre>

<hr>
<h2 id='get_dots'>Get or check elements from dots <code>'...'</code></h2><span id='topic+get_dots'></span><span id='topic+missing_dots'></span>

<h3>Description</h3>

<p>Get information from <code>'...'</code> without
evaluating the arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dots(..name, ..default = NULL, ...)

missing_dots(envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dots_+3A_..name">..name</code></td>
<td>
<p>character name of the argument</p>
</td></tr>
<tr><td><code id="get_dots_+3A_..default">..default</code></td>
<td>
<p>R object to return if argument not found</p>
</td></tr>
<tr><td><code id="get_dots_+3A_...">...</code></td>
<td>
<p>dots that contains argument</p>
</td></tr>
<tr><td><code id="get_dots_+3A_envir">envir</code></td>
<td>
<p>R environment</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>missing_dots</code> returns logical vector with lengths matching
with dot lengths. <code>get_dots</code> returns value corresponding to the name.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# ------------------------ Basic Usage ---------------------------

# missing_dots(environment()) is a fixed usage

my_function &lt;- function(...){
  missing_dots(environment())
}
my_function(,)

# get_dots
plot2 &lt;- function(...){
  title = get_dots('main', 'There is no title', ...)
  plot(...)
  title
}

plot2(1:10)
plot2(1:10, main = 'Scatter Plot of 1:10')

# ------------------------ Comparisons ----------------------------
f1 &lt;- function(...){ get_dots('x', ...) }
f2 &lt;- function(...){ list(...)[['x']] }
delayedAssign('y', { cat('y is evaluated!') })

# y will not evaluate
f1(x = 1, y = y)

# y gets evaluated
f2(x = 1, y = y)

# -------------------- Decorator example --------------------------
ret_range &lt;- function(which_range = 'y'){
  function(f){
    function(...){
      f(...)
      y_range &lt;- range(get_dots(which_range, 0, ...))
      y_range
    }
  }
}
plot_ret_yrange &lt;- plot %D% ret_range('y')
plot_ret_yrange(x = 1:10, y = rnorm(10))


</code></pre>

<hr>
<h2 id='get_ip'>Get 'IP' address</h2><span id='topic+get_ip'></span>

<h3>Description</h3>

<p>Get 'IP' address
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ip(get_public = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ip_+3A_get_public">get_public</code></td>
<td>
<p>whether to get public 'IP'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of 'IP' addresses
</p>

<hr>
<h2 id='get_os'>Detect the type of operating system</h2><span id='topic+get_os'></span>

<h3>Description</h3>

<p>Detect the type of operating system
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_os()
</code></pre>


<h3>Value</h3>

<p>The type of current operating system: <code>'windows'</code>,
<code>'darwin'</code>, <code>'linux'</code>, <code>'solaris'</code>, or otherwise
<code>'unknown'</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_os()

</code></pre>

<hr>
<h2 id='get_ram'>Get Memory Size</h2><span id='topic+get_ram'></span>

<h3>Description</h3>

<p>Get Memory Size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ram()
</code></pre>


<h3>Details</h3>

<p>The function <code>get_ram</code> only supports 'MacOS', 'Windows', and 'Linux'. 'Solaris' or other platforms will return <code>NA</code>.
Here are the system commands used to detect memory limits:
</p>

<dl>
<dt>'Windows'</dt><dd><p>Uses command <code>'wmic.exe'</code> in the 'Windows' system folder. Notice this command-line tool might not exist on all 'Windows' machines. <code>get_ram</code> will return <code>NA</code> if it cannot locate the command-line tool.</p>
</dd>
<dt>'MacOS'</dt><dd><p>Uses command <code>'sysctl'</code> located at <code>'/usr/sbin/'</code> or <code>'/sbin/'</code>. Alternatively, you can edit the environment variable <code>'PATH'</code> to include the command-line tools if <code>'sysctl'</code> is missing. <code>get_ram</code> will return <code>NA</code> if it cannot locate <code>'sysctl'</code>.</p>
</dd>
<dt>'Linux'</dt><dd><p>Uses the file <code>'/proc/meminfo'</code>, possibly the first entry <code>'MemTotal'</code>. If the file is missing or entry <code>'MemTotal'</code> cannot be located, <code>get_ram</code> will return <code>NA</code>.</p>
</dd>
</dl>



<h3>Value</h3>

<p>System RAM in bytes, or <code>NA</code> if not supported.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_ram()

</code></pre>

<hr>
<h2 id='getInputBinding'>Obtain registered input bindings</h2><span id='topic+getInputBinding'></span>

<h3>Description</h3>

<p>Obtain registered input bindings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getInputBinding(fname, pkg = NULL, envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getInputBinding_+3A_fname">fname</code></td>
<td>
<p>input function name, character or quoted expression
such as <code>'shiny::textInput'</code> or <code>numericInput</code>.</p>
</td></tr>
<tr><td><code id="getInputBinding_+3A_pkg">pkg</code></td>
<td>
<p>(optional), name of package</p>
</td></tr>
<tr><td><code id="getInputBinding_+3A_envir">envir</code></td>
<td>
<p>environment to evaluate <code>fname</code> if <code>pkg</code> is not provided</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing: 1. 'JavaScript' input binding name; 2. 'R' updating function name
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dipsaus)

# Most recommended usage
getInputBinding('compoundInput2', pkg = 'dipsaus')

# Other usages
getInputBinding('shiny::textInput')


getInputBinding(shiny::textInput)

getInputBinding(compoundInput2, pkg = 'dipsaus')

# Bad usage, raise errors in some cases
## Not run: 
## You need to library(shiny), or set envir=asNamespace('shiny'), or pkg='shiny'
getInputBinding('textInput')
getInputBinding(textInput) # also fails

## Always fails
getInputBinding('dipsaus::compoundInput2', pkg = 'dipsaus')

## End(Not run)

</code></pre>

<hr>
<h2 id='graphic-devices'>Create a group of named graphic devices</h2><span id='topic+graphic-devices'></span><span id='topic+dev_create'></span><span id='topic+get_dev_attr'></span>

<h3>Description</h3>

<p>Create a group of named graphic devices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dev_create(..., env = parent.frame(), attributes = list())

get_dev_attr(which, dev = grDevices::dev.cur(), ifnotfound = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphic-devices_+3A_...">...</code></td>
<td>
<p>named expressions to launch devices</p>
</td></tr>
<tr><td><code id="graphic-devices_+3A_env">env</code></td>
<td>
<p>environment to evaluate expressions</p>
</td></tr>
<tr><td><code id="graphic-devices_+3A_attributes">attributes</code></td>
<td>
<p>named list; names correspond to device names and values
are attributes to set to the devices</p>
</td></tr>
<tr><td><code id="graphic-devices_+3A_which">which</code></td>
<td>
<p>which attribute to obtain</p>
</td></tr>
<tr><td><code id="graphic-devices_+3A_dev">dev</code></td>
<td>
<p>which device to search for attributes</p>
</td></tr>
<tr><td><code id="graphic-devices_+3A_ifnotfound">ifnotfound</code></td>
<td>
<p>value to return if attribute is not found</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of functions to query, control, and switch between devices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  ## Unix-specific example

# Create multiple named devices, setting attributes to the second graph
devs &lt;- dev_create(
  line = X11(), points = x11(),
  attributes = list(points = list(pch = 16))
)

# switch to device named "points"

devs$dev_which('points')

# Plot points, with pch given as preset
plot(1:10, pch = get_dev_attr(which = 'pch', ifnotfound = 1))

# switch to "line" device
devs$dev_switch('line')
plot(1:100, type='l')

# Create another group with conflict name
dev_another &lt;- dev_create(line = X11())

# Query device name with 'line'
dev_another$dev_which('line')  # 4
devs$dev_which('line')  # 2, doesn't conflict with the new groups

dev.list()
# close one or more device
dev_another$dev_off('line')
dev.list()

# close all devices
devs$dev_off()
dev.list()


## End(Not run)
</code></pre>

<hr>
<h2 id='handler_dipsaus_progress'>Progress-bar Handler</h2><span id='topic+handler_dipsaus_progress'></span>

<h3>Description</h3>

<p>Handler for <code><a href="#topic+progress2">progress2</a></code> to support
<code>progressr::handlers</code>. See examples for detailed use case
</p>


<h3>Usage</h3>

<pre><code class='language-R'>handler_dipsaus_progress(
  title = getOption("dipsaus.progressr.title", "Progress"),
  intrusiveness = getOption("progressr.intrusiveness.gui", 1),
  target = if (is.null(shiny::getDefaultReactiveDomain())) "terminal" else "gui",
  enable = interactive() || shiny_is_running(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="handler_dipsaus_progress_+3A_title">title</code></td>
<td>
<p>default title of <code><a href="#topic+progress2">progress2</a></code></p>
</td></tr>
<tr><td><code id="handler_dipsaus_progress_+3A_intrusiveness">intrusiveness</code></td>
<td>
<p>A non-negative scalar on how intrusive
(disruptive) the reporter to the user</p>
</td></tr>
<tr><td><code id="handler_dipsaus_progress_+3A_target">target</code></td>
<td>
<p>where progression updates are rendered</p>
</td></tr>
<tr><td><code id="handler_dipsaus_progress_+3A_enable">enable</code></td>
<td>
<p>whether the progress should be reported</p>
</td></tr>
<tr><td><code id="handler_dipsaus_progress_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="progressr.html#topic+make_progression_handler">make_progression_handler</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>

library(progressr)
library(shiny)
library(future)

## ------------------------------ Setup! -------------------------------
handlers(handler_dipsaus_progress())

# ------------------------------ A simple usage ------------------------
xs &lt;- 1:5
handlers(handler_dipsaus_progress())
with_progress({
  p &lt;- progressor(along = xs)
  y &lt;- lapply(xs, function(x) {
    p(sprintf("x=%g", x))
    Sys.sleep(0.1)
    sqrt(x)
  })
})

# ------------------------ A future.apply case -------------------------
plan(sequential)
# test it yourself with plan(multisession)

handlers(handler_dipsaus_progress())
with_progress({
  p &lt;- progressor(along = xs)
  y &lt;- future.apply::future_lapply(xs, function(x) {
    p(sprintf("x=%g", x))
    Sys.sleep(0.1)
    sqrt(x)
  })
})

# ------------------------ A shiny case --------------------------------

ui &lt;- fluidPage(
  actionButton('ok', 'Run Demo')
)

server &lt;- function(input, output, session) {
  handlers(handler_dipsaus_progress())
  make_forked_clusters()

  observeEvent(input$ok, {
    with_progress({
      p &lt;- progressor(along = 1:100)
      y &lt;- future.apply::future_lapply(1:100, function(x) {
        p(sprintf("Input %d|Result %d", x, x+1))
        Sys.sleep(1)
        x+1
      })
    })
  })
}

if(interactive()){
  shinyApp(ui, server)
}



</code></pre>

<hr>
<h2 id='html_asis'>Escape HTML strings</h2><span id='topic+html_asis'></span>

<h3>Description</h3>

<p>Escape HTML strings so that they will be displayed
'as-is' in websites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>html_asis(s, space = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="html_asis_+3A_s">s</code></td>
<td>
<p>characters</p>
</td></tr>
<tr><td><code id="html_asis_+3A_space">space</code></td>
<td>
<p>whether to also escape white space, default is true.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An R string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ui &lt;- flex_div(
  shiny::textInput('id', ' ', width = '100%',
                   value = 'Height not aligned'),
  actionButtonStyled('ok', 'Button1', width = '100%',),
  shiny::textInput('id2', html_asis(' '), width = '100%',
                   value = 'Heights aligned'),
  actionButtonStyled('ok2', 'Button2', width = '100%',),
  ncols = 2
)
if(interactive()){
  shiny::shinyApp(ui = shiny::fluidPage(shiny::fluidRow(ui)),
                  server = function(input, output, session){})
}

</code></pre>

<hr>
<h2 id='html_class'>Combine, add, or remove 'HTML' classes</h2><span id='topic+html_class'></span><span id='topic+combine_html_class'></span><span id='topic+remove_html_class'></span>

<h3>Description</h3>

<p>Combine 'HTML' classes to produce nice, clean 'HTML' class
string via <code>combine_html_class</code>, or to remove a class via
<code>remove_html_class</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_html_class(...)

remove_html_class(target, class)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="html_class_+3A_...">...</code></td>
<td>
<p>one or more characters, classes to combine; duplicated classes
will be removed</p>
</td></tr>
<tr><td><code id="html_class_+3A_target">target</code></td>
<td>
<p>characters, class list</p>
</td></tr>
<tr><td><code id="html_class_+3A_class">class</code></td>
<td>
<p>one or more characters, classes to be removed from <code>target</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string of new 'HTML' class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Combine classes "a b c d e"
combine_html_class("a", "b  a", c("c", " d", "b"), list("e ", "a"))

# Remove class
remove_html_class("a b   c  e", c("b", "c "))

</code></pre>

<hr>
<h2 id='iapply'>Apply each elements with index as second input</h2><span id='topic+iapply'></span>

<h3>Description</h3>

<p>Apply function with an index variable as the second input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iapply(X, FUN, ..., .method = c("sapply", "lapply", "vapply"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iapply_+3A_x">X</code></td>
<td>
<p>a vector (atomic or list)</p>
</td></tr>
<tr><td><code id="iapply_+3A_fun">FUN</code></td>
<td>
<p>the function to be applied to each element of <code>X</code>: see 'Details'.</p>
</td></tr>
<tr><td><code id="iapply_+3A_...">...</code></td>
<td>
<p>passed to apply methods</p>
</td></tr>
<tr><td><code id="iapply_+3A_.method">.method</code></td>
<td>
<p>method to use, default is <code><a href="base.html#topic+sapply">sapply</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>FUN</code> will be further passed to the apply methods. Unlike
<code><a href="base.html#topic+lapply">lapply</a></code>, <code>FUN</code> is expected to have at least two arguments.
The first argument is each element of <code>X</code>, the second argument is the
index number of the element.
</p>


<h3>Value</h3>

<p>a list or matrix depends on <code>.method</code>. See <code><a href="base.html#topic+lapply">lapply</a></code>
</p>

<hr>
<h2 id='lapply_async2'>Apply, but in parallel</h2><span id='topic+lapply_async2'></span>

<h3>Description</h3>

<p>Apply, but in parallel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lapply_async2(
  x,
  FUN,
  FUN.args = list(),
  callback = NULL,
  plan = TRUE,
  future.chunk.size = NULL,
  future.seed = sample.int(1, n = 1e+05 - 1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lapply_async2_+3A_x">x</code></td>
<td>
<p>vector, list</p>
</td></tr>
<tr><td><code id="lapply_async2_+3A_fun">FUN</code></td>
<td>
<p>function to apply on each element of <code>x</code></p>
</td></tr>
<tr><td><code id="lapply_async2_+3A_fun.args">FUN.args</code></td>
<td>
<p>more arguments to feed into <code>FUN</code></p>
</td></tr>
<tr><td><code id="lapply_async2_+3A_callback">callback</code></td>
<td>
<p>function to run after each iteration</p>
</td></tr>
<tr><td><code id="lapply_async2_+3A_plan">plan</code></td>
<td>
<p>logical, or character or <code>future</code> plan; see Details.</p>
</td></tr>
<tr><td><code id="lapply_async2_+3A_future.chunk.size">future.chunk.size</code>, <code id="lapply_async2_+3A_future.seed">future.seed</code></td>
<td>
<p>see also <code>future_lapply</code>.
If you want the callbacks
to be called immediately after each loop, then set it to <code>1</code>,
which is not optimal but the only way right now.</p>
</td></tr>
<tr><td><code id="lapply_async2_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="future.html#topic+plan">plan</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>plan</code> is logical, <code>FALSE</code> means use current plan.
If <code>plan=TRUE</code>, then it equals to <code>plan='multicore'</code>. For
characters, <code>plan</code> can be <code>'multicore'</code>, <code>'callr'</code>,
<code>'sequential'</code>, <code>'multisession'</code>, <code>'multiprocess'</code>,
etc. Alternatively, you could pass future <code><a href="future.html#topic+plan">plan</a></code>
objects.
</p>


<h3>Value</h3>

<p>same as
<code>with(FUN.args, lapply(x, function(el){eval(body(FUN))}))</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_forked_clusters">make_forked_clusters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(future)
plan(sequential)

# Use sequential plan
# 1. Change `plan` to 'multicore', 'multisession', or TRUE to enable
# multi-core, but still with progress information
# 2. Change plan=FALSE will use current future plan
res &lt;- lapply_async2(100:200, function(x){
  return(x+1)
}, callback = function(e){
  sprintf('Input=%d', e)
}, plan = 'sequential')

# Disable callback message, then the function reduce to
# normal `future.apply::future_lapply`
res &lt;- lapply_async2(100:200, function(x){
  return(x+1)
}, callback = NULL, plan = FALSE)

if(interactive()) {

  # PID are different, meaning executing in different sessions
  lapply_async2(1:4, function(x){
    Sys.getpid()
  })
}

</code></pre>

<hr>
<h2 id='lapply_callr'>Apply function with <code>rs_exec</code></h2><span id='topic+lapply_callr'></span>

<h3>Description</h3>

<p>Apply function with <code>rs_exec</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lapply_callr(
  x,
  fun,
  ...,
  .callback = NULL,
  .globals = list(),
  .ncores = future::availableCores(),
  .packages = attached_packages(),
  .focus_on_console = TRUE,
  .rs = FALSE,
  .quiet = FALSE,
  .name = "",
  .wait = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lapply_callr_+3A_x">x</code></td>
<td>
<p>vector or list</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_fun">fun</code></td>
<td>
<p>function</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_...">...</code></td>
<td>
<p>passed to function, see <code><a href="base.html#topic+lapply">lapply</a></code></p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.callback">.callback</code></td>
<td>
<p>a function takes zero, one, or two arguments
and should return a string to show in the progress</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.globals">.globals</code></td>
<td>
<p>a named list that <code>fun</code> relies on</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.ncores">.ncores</code></td>
<td>
<p>number of cores to use; only used when <code>.wait=TRUE</code></p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.packages">.packages</code></td>
<td>
<p>packages to load</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.focus_on_console">.focus_on_console</code></td>
<td>
<p>whether to focus on console once finished;
is only used when <code>.rs</code> is true</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.rs">.rs</code></td>
<td>
<p>whether to create 'RStudio' jobs; default is false</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.quiet">.quiet</code></td>
<td>
<p>whether to suppress progress message</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.name">.name</code></td>
<td>
<p>the name of progress and jobs</p>
</td></tr>
<tr><td><code id="lapply_callr_+3A_.wait">.wait</code></td>
<td>
<p>whether to wait for the results; default is true, which blocks
the main session waiting for results.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>.wait=TRUE</code>, returns a list that should be, in most of
the cases, identical to <code><a href="base.html#topic+lapply">lapply</a></code>; when <code>.wait=FALSE</code>,
returns a function that collects results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rs_exec">rs_exec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){

  lapply_callr(1:3, function(x, a){
    c(Sys.getpid(), a, x)
  }, a = 1)

  lapply_callr(1:30, function(x)
    {
      Sys.sleep(0.1)
      sprintf("a + x = %d", a + x)
    }, .globals = list(a = 1),
    .callback = I, .name = "Test")

}

</code></pre>

<hr>
<h2 id='list_to_fastmap2'>Copy elements to <code>fastmap2</code></h2><span id='topic+list_to_fastmap2'></span>

<h3>Description</h3>

<p>Copy elements to <code>fastmap2</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_to_fastmap2(li, map = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_to_fastmap2_+3A_li">li</code></td>
<td>
<p>a list or an environment</p>
</td></tr>
<tr><td><code id="list_to_fastmap2_+3A_map">map</code></td>
<td>
<p><code>NULL</code> or a <code>fastmap2</code> instance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>map</code> is not <code>NULL</code>, elements will be added
to <code>map</code> and return <code>map</code>, otherwise create a new instance.
</p>

<hr>
<h2 id='list_to_fastqueue2'>Copy elements to <code>fastqueue2</code></h2><span id='topic+list_to_fastqueue2'></span>

<h3>Description</h3>

<p>Copy elements to <code>fastqueue2</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_to_fastqueue2(li, queue = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_to_fastqueue2_+3A_li">li</code></td>
<td>
<p>a list or an environment</p>
</td></tr>
<tr><td><code id="list_to_fastqueue2_+3A_queue">queue</code></td>
<td>
<p><code>NULL</code> or a <code>fastqueue2</code> instance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>map</code> is not <code>NULL</code>, elements will be added
to <code>map</code> and return <code>map</code>, otherwise create a new instance.
</p>

<hr>
<h2 id='lock'>Create or Unlock a Lock</h2><span id='topic+lock'></span><span id='topic+dipsaus_lock'></span><span id='topic+dipsaus_unlock'></span><span id='topic+dipsaus_resetlocks'></span>

<h3>Description</h3>

<p>A wrapper for 'synchronicity' package, but user can
interrupt the lock procedure anytime, and don't have to worry about
whether the lock exists or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dipsaus_lock(name, timeout = 10, exclusive = TRUE)

dipsaus_unlock(name, timeout = 10, exclusive = TRUE)

dipsaus_resetlocks(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lock_+3A_name">name</code></td>
<td>
<p>character, the locker's name, must be only letters and digits</p>
</td></tr>
<tr><td><code id="lock_+3A_timeout">timeout</code></td>
<td>
<p>numeric, seconds to wait for the locker to lock or unlock</p>
</td></tr>
<tr><td><code id="lock_+3A_exclusive">exclusive</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical, whether the operation succeed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Clear existing locks
dipsaus::dipsaus_resetlocks()

# unlock to prepare for the example
dipsaus_unlock('testlocker', timeout = 0.01)

# Create a locker, return TRUE
lock_success = dipsaus_lock('testlocker')
if(lock_success){
  cat2('testlocker has been locked')
}

# test whether locker has been locked
lock_success = dipsaus_lock('testlocker', timeout = 0.01)
if(!lock_success){
  cat2('attempt to lock testlocker failed')
}

# unlock
dipsaus_unlock('testlocker', timeout = 0.01)

# clean up
dipsaus::dipsaus_resetlocks()


</code></pre>

<hr>
<h2 id='make_forked_clusters'>Create forked clusters, but more than that</h2><span id='topic+make_forked_clusters'></span>

<h3>Description</h3>

<p>Creates forked clusters. If fails, then switch to alternative
plan (default is <code>"multisession"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_forked_clusters(
  workers = future::availableCores(),
  on_failure = getOption("dipsaus.cluster.backup", "sequential"),
  clean = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_forked_clusters_+3A_workers">workers</code></td>
<td>
<p>positive integer, number of cores to use</p>
</td></tr>
<tr><td><code id="make_forked_clusters_+3A_on_failure">on_failure</code></td>
<td>
<p>alternative plan to use if failed. This is useful when
forked process is not supported (like 'windows'); default is
<code>options("dipsaus.cluster.backup")</code> or 'sequential'</p>
</td></tr>
<tr><td><code id="make_forked_clusters_+3A_clean">clean</code></td>
<td>
<p>whether to reverse the plan on exit. This is useful when use
<code>make_forked_clusters</code> inside of a function. See details and examples.</p>
</td></tr>
<tr><td><code id="make_forked_clusters_+3A_...">...</code></td>
<td>
<p>passing to <code>future::plan</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This was original designed as a wrapper for
<code>future::plan(future::multicore, ...)</code>. Forked
clusters are discouraged when running in 'RStudio' because some pointers
in 'RStudio' might be incorrectly handled, causing fork-bombs. However,
forked process also has big advantages over other parallel methods: there
is no data transfer needed, hence its speed is very fast. Many external
pointers can also be shared using forked process. Since version 1.14.0,
unfortunately, forked 'multicore' is banned by <code>future</code> package by
default, and you usually need to enable it manually. This function provides
a simple way of enable it and plan the future at the same time.
</p>
<p>On windows, forked process is not supported, under this situation, the plan
fall back to sequential, which might not be what you want. In such case,
this function provides an alternative strategy that allows you to plan.
You could also always enable the alternative strategy by setting
<code>dipsaus.no.fork</code> option to true.
</p>
<p>The parameter <code>clean</code> allows you to automatically clean the plan. This
function allows you to reverse back to previous plan automatically once your
function exits. For example, users might have already set up their own plans,
<code>clean=TRUE</code> allows you to set the plan back to those original plans
once function exit. To use this feature, please make sure this function is
called within another function, and you must collect results before exiting
the outer function.
</p>


<h3>Value</h3>

<p>Current future plan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lapply_async2">lapply_async2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


if(interactive()){

  # ------ Basic example
  library(future)
  library(dipsaus)

  # sequential
  plan("sequential")

  make_forked_clusters()
  plan()  # multicore, or multisession (on windows)

  Sys.getpid()  # current main session PID
  value(future({Sys.getpid()}))  # sub-process PID, evaluated as multicore

  # ------ When fork is not supported

  # reset to default single core strategy
  plan("sequential")

  # Disable forked process
  options("dipsaus.no.fork" = TRUE)
  options("dipsaus.cluster.backup" = "multisession")

  # Not fall back to multisession
  make_forked_clusters()
  plan()

  # ------ Auto-clean

  # reset plan
  plan("sequential")
  options("dipsaus.no.fork" = FALSE)
  options("dipsaus.cluster.backup" = "multisession")

  # simple case:
  my_func &lt;- function(){
    make_forked_clusters(clean = TRUE)

    fs &lt;- lapply(1:4, function(i){
      future({Sys.getpid()})
    })

    unlist(value(fs))
  }

  my_func()    # The PIDs are different, meaning they ran in other sessions
  plan()       # The plan is sequential, auto reversed strategy

  # ------ Auto-clean with lapply_async2
  my_plan &lt;- plan()

  # lapply_async2 version of the previous task
  lapply_async2(1:4, function(i){
    Sys.getpid()
  })

  identical(plan(), my_plan)

}



</code></pre>

<hr>
<h2 id='map'>Create R object map.</h2><span id='topic+map'></span><span id='topic+session_map'></span><span id='topic+rds_map'></span><span id='topic+text_map'></span>

<h3>Description</h3>

<p>Provides five types of map that fit in different use cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>session_map(map = fastmap::fastmap())

rds_map(path = tempfile())

text_map(path = tempfile())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_+3A_map">map</code></td>
<td>
<p>a <code>fastmap::fastmap()</code> list</p>
</td></tr>
<tr><td><code id="map_+3A_path">path</code></td>
<td>
<p>directory path where map data should be stored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are five types of map implemented. They all inherit class
<code><a href="#topic+AbstractMap">AbstractMap</a></code>. There are several differences in
use case scenarios and they backend implementations.
</p>

<dl>
<dt><code><a href="#topic+session_map">session_map</a></code></dt><dd>
<p>A session map takes a <code><a href="fastmap.html#topic+fastmap">fastmap</a></code> object. All objects are
stored in current R session. This means you cannot access the map from other
process nor parent process. The goal of this map is to share the data across
different environments and to store global variables, as long as they share
the same map object. If you are looking for maps that can be shared
by different processes, check the rest map types. The closest map type is
<code>rds_map</code>.
</p>
</dd>
<dt><code><a href="#topic+rds_map">rds_map</a></code></dt><dd>
<p>An 'RDS' map uses file system to store values. The values are stored
separately in '.rds' files. Compared to session maps, 'RDS' map can be
shared across different R process. It's recommended to store
large files in <code>rds_map</code>. If the value is not large in RAM,
<code>text_map</code> is recommended.
</p>
</dd>
<dt><code><a href="#topic+text_map">text_map</a></code></dt><dd>
<p>A 'text' map uses file system to store values. Similar to <code>rds_map</code>,
it can be stored across multiple processes as long as the maps share the
same file directory. However, unlike <code>rds_map</code>, <code>text_map</code>
the <code>text_map</code> can only store basic data values, namely atom data types.
The supported types are: numeric, character, vector, list, matrix
It's highly recommended to convert factors to characters. Do NOT use if the
values are functions or environments. The recommended use case scenario
is when the speed is not the major concern, and you want to preserve data
with backward compatibility. Otherwise it's highly recommended to use
<code>rds_map</code>.
</p>
</dd>
</dl>



<h3>Value</h3>

<p>An <code>R6</code> instance that inherits <code><a href="#topic+AbstractMap">AbstractMap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ----------------------Basic Usage ----------------------

# Define a path to your map.
path = tempfile()
map &lt;- rds_map(path)

# Reset
map$reset()

# Check if the map is corrupted.
map$validate()

# You have not set any key-value pairs yet.
# Let's say two parallel processes (A and B) are sharing this map.
# Process A set values
map$keys()

# Start push
# set a normal message
map$set(key = 'a', value = 1)

# set a large object
map$set(key = 'b', value = rnorm(100000))

# set an object with hash of another object
map$set(key = 'c', value = 2, signature = list(
  parameter1 = 123,
  parameter2 = 124
))

# Check what's in the map from process B
mapB &lt;- rds_map(path)
mapB$keys()
mapB$keys(include_signatures = TRUE)

# Number of key-values pairs in the map.
mapB$size()

# Check if key exists
mapB$has(c('1','a', 'c'))

# Check if key exists and signature also matches
mapB$has('c', signature = list(
  parameter1 = 123,
  parameter2 = 124
))

# Signature changed, then return FALSE. This is especially useful when
# value is really large and reading the value takes tons of time
mapB$has('c', signature = list(
  parameter1 = 1244444,
  parameter2 = 124
))

# Destroy the map's files altogether.
mapB$destroy()

## Not run: 
  # Once destroyed, validate will raise error
  mapB$validate()

## End(Not run)


</code></pre>

<hr>
<h2 id='mask_function2'>Mask a function with given variables</h2><span id='topic+mask_function2'></span>

<h3>Description</h3>

<p>Modifies the default behavior of
the function by adding one environment layer on top of input
function. The masked variables are assigned directly to the
environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask_function2(f, ..., .list = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mask_function2_+3A_f">f</code></td>
<td>
<p>any function</p>
</td></tr>
<tr><td><code id="mask_function2_+3A_...">...</code>, <code id="mask_function2_+3A_.list">.list</code></td>
<td>
<p>name-value pairs to mask the function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a masked function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
a &lt;- 123
f1 &lt;- function(){
  a + 1
}
f1()   # 124

f2 &lt;- mask_function2(f1, a = 1)
f2()   # a is masked with value 1, return 2

environment(f1)  # global env
environment(f2)  # masked env

env &lt;- environment(f2)
identical(parent.env(env), environment(f1))  # true
env$a  # masked variables: a=1

</code></pre>

<hr>
<h2 id='match_calls'>Recursively match calls and modify arguments</h2><span id='topic+match_calls'></span>

<h3>Description</h3>

<p>Recursively match calls and modify arguments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_calls(
  call,
  recursive = TRUE,
  replace_args = list(),
  quoted = FALSE,
  envir = parent.frame(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match_calls_+3A_call">call</code></td>
<td>
<p>an <code>R</code> expression</p>
</td></tr>
<tr><td><code id="match_calls_+3A_recursive">recursive</code></td>
<td>
<p>logical, recursively match calls, default is true</p>
</td></tr>
<tr><td><code id="match_calls_+3A_replace_args">replace_args</code></td>
<td>
<p>named list of functions, see examples</p>
</td></tr>
<tr><td><code id="match_calls_+3A_quoted">quoted</code></td>
<td>
<p>logical, is <code>call</code> quoted</p>
</td></tr>
<tr><td><code id="match_calls_+3A_envir">envir</code></td>
<td>
<p>which environment should call be evaluated</p>
</td></tr>
<tr><td><code id="match_calls_+3A_...">...</code></td>
<td>
<p>other parameters passing to <code>match.call</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nested call with all arguments matched
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dipsaus); library(shiny)

# In shiny modules, we might want to add ns() to inputIds
# In this example, textInput(id) will become textInput(ns(id))
match_calls(lapply(1:20, function(i){
  textInput(paste('id_', i), paste('Label ', i))
}), replace_args = list(
  inputId = function(arg, call){ as.call(list(quote(ns), arg)) }
))

</code></pre>

<hr>
<h2 id='mean_se'>Calculates mean and standard error of mean</h2><span id='topic+mean_se'></span>

<h3>Description</h3>

<p>Calculates mean and standard error of mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_se(x, na.rm = FALSE, se_na_as_zero = na.rm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_se_+3A_x">x</code></td>
<td>
<p>R numerical object</p>
</td></tr>
<tr><td><code id="mean_se_+3A_na.rm">na.rm</code></td>
<td>
<p>whether to remove <code>NA</code>; default is false</p>
</td></tr>
<tr><td><code id="mean_se_+3A_se_na_as_zero">se_na_as_zero</code></td>
<td>
<p>see <code>na_as_zero</code> in <code><a href="#topic+ste_mean">ste_mean</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector containing the <code><a href="base.html#topic+mean">mean</a></code> and standard error
of mean (<code><a href="#topic+ste_mean">ste_mean</a></code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ste_mean">ste_mean</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Mean should be near 0 (mean of standard normal)
# standard error of mean should be near 0.01
mean_se(rnorm(10000))

</code></pre>

<hr>
<h2 id='mem_limit2'>Get max RAM size
This is an experimental function that is designed for non-windows systems</h2><span id='topic+mem_limit2'></span>

<h3>Description</h3>

<p>Get max RAM size
This is an experimental function that is designed for non-windows systems
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mem_limit2()
</code></pre>


<h3>Value</h3>

<p>a list of total free memory.
</p>

<hr>
<h2 id='new_function2'>Create new function that supports 'quasi-quosure' syntax</h2><span id='topic+new_function2'></span>

<h3>Description</h3>

<p>Create new function that supports 'quasi-quosure' syntax
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_function2(
  args = alist(),
  body = {
 },
  env = parent.frame(),
  quote_type = c("unquoted", "quote", "quo"),
  quasi_env = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_function2_+3A_args">args</code></td>
<td>
<p>named list of function formals</p>
</td></tr>
<tr><td><code id="new_function2_+3A_body">body</code></td>
<td>
<p>function body expression, supports 'quasi-quosure' syntax</p>
</td></tr>
<tr><td><code id="new_function2_+3A_env">env</code></td>
<td>
<p>declare environment of the function</p>
</td></tr>
<tr><td><code id="new_function2_+3A_quote_type">quote_type</code></td>
<td>
<p>character, whether <code>body</code> is unquoted, quoted,
or a 'quo' object (from 'rlang' package)</p>
</td></tr>
<tr><td><code id="new_function2_+3A_quasi_env">quasi_env</code></td>
<td>
<p>where the 'quasi-quosure' should be evaluated,
default is parent environment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An unquoted body expression will be quoted, all the
expressions with 'quasi-quosure' like <code>!!var</code> will be evaluated
and substituted with the value of <code>var</code>. For a 'quosure',
<code><a href="rlang.html#topic+quo_squash">quo_squash</a></code> will be applied. A quoted
expression will not be substitute, but will be expanded if any
'quasi-quosure' detected
</p>
<p><code>args</code> must be a <code>list</code> object, see <code><a href="base.html#topic+formals">formals</a></code>.
For arguments with no default values, or quoted defaults, use
<code><a href="base.html#topic+alist">alist</a></code>. An <code>arg=alist(a=)</code> will result in a
function like <code>function(a){...}</code>. See examples for more details.
</p>


<h3>Value</h3>

<p>a function
</p>


<h3>See Also</h3>

<p><code><a href="rlang.html#topic+new_function">new_function</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ------------ standard usage ------------
x &lt;- 1:10
f1 &lt;- new_function2(alist(a=), { print(a + x) }, env = environment())
f1(0)

x &lt;- 20:23
f1(0)  # result changed as x changed

# ------------ 'quasi-quosure' syntax ------------
x &lt;- 1:10
f2 &lt;- new_function2(alist(a=), { print(a + !!x) })
print(f2)

f2(0)

x &lt;- 20:23
f2(0)  # result doesn't change as f2 doesn't depend on x anymore

# ------------ argument settings ------------

default &lt;- 123

# default with values pre-specified
new_function2(list(a = default))   # function (a = 123){}

# default with values unevaluated
new_function2(list(a = quote(default)))   # function (a = default){}
new_function2(alist(a = default))

# missing default
new_function2(alist(a = ))    # function (a){}


</code></pre>

<hr>
<h2 id='no_op'>Pipe-friendly no-operation function</h2><span id='topic+no_op'></span>

<h3>Description</h3>

<p>returns the first input with side effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>no_op(.x, .expr, ..., .check_fun = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="no_op_+3A_.x">.x</code></td>
<td>
<p>any R object</p>
</td></tr>
<tr><td><code id="no_op_+3A_.expr">.expr</code></td>
<td>
<p>R expression that produces side effects</p>
</td></tr>
<tr><td><code id="no_op_+3A_...">...</code>, <code id="no_op_+3A_.check_fun">.check_fun</code></td>
<td>
<p>see 'details'</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>no_op</code> is a pipe-friendly function that takes any values in,
evaluate expressions but still returns input. This is very useful when
you have the same input across multiple functions and you want to use pipes.
</p>
<p><code>.expr</code> is evaluated with a special object <code>'.'</code>, you can use
<code>'.'</code> to represent <code>.x</code> in <code>.expr</code>. For example, if
<code>.x=1:100</code>, then <code>plot(x=seq(0,1,length.out = 100), y=.)</code> is
equivalent to <code>plot(x=seq(0,1,length.out = 100), y=1:100)</code>.
</p>
<p><code>.check_fun</code> checks whether <code>.expr</code> returns a function, if yes,
then the function is called with argument <code>.x</code> and <code>...</code>
</p>


<h3>Value</h3>

<p>The value of <code>.x</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

## 1. Basic usage

# Will print('a') and return 'a'
no_op('a', print)

# Will do nothing and return 'a' because .check_fun is false
no_op('a', print, .check_fun = FALSE)

# Will print('a') and return 'a'
no_op('a', print(.), .check_fun = FALSE)

## 2. Toy example
library(graphics)

par(mfrow = c(2,2))
x &lt;- rnorm(100)

# hist and plot share the same input `rnorm(100)`

x %&gt;%
  # .expr is a function, all ... are passed as other arguments
  no_op( hist, nclass = 10 ) %&gt;%
  no_op( plot, x = seq(0,1,length.out = 100) ) %&gt;%

  # Repeat the previous two plots, but with different syntax
  no_op({ hist(., nclass = 10) }) %&gt;%
  no_op({ plot(x = seq(0,1,length.out = 100), y = .) }) %&gt;%

  # The return statement is ignored

  no_op({ return(x + 1)}) -&gt;
  y

# x is returned at the end

identical(x, y)   # TRUE

</code></pre>

<hr>
<h2 id='package_installed'>Check if a package is installed</h2><span id='topic+package_installed'></span>

<h3>Description</h3>

<p>Check if a package is installed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>package_installed(pkgs, all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="package_installed_+3A_pkgs">pkgs</code></td>
<td>
<p>vector of package names</p>
</td></tr>
<tr><td><code id="package_installed_+3A_all">all</code></td>
<td>
<p>only returns TRUE if all packages are installed. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical, if packages are installed or not. If <code>all=TRUE</code>, return
a logical value of whether all packages a re installed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Check if package base and dipsaus are installed
package_installed(c('base', 'dipsaus'))

# Check if all required packages are installed
package_installed(c('base', 'dipsaus'), all = TRUE)

</code></pre>

<hr>
<h2 id='parse_svec'>Parse Text Into Numeric Vectors</h2><span id='topic+parse_svec'></span>

<h3>Description</h3>

<p>Parse Text Into Numeric Vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_svec(text, sep = ",", connect = "-:|", sort = FALSE, unique = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_svec_+3A_text">text</code></td>
<td>
<p>string with chunks, e.g. <code>"1-10, 14, 16-20, 18-30"</code> has 4 chunks</p>
</td></tr>
<tr><td><code id="parse_svec_+3A_sep">sep</code></td>
<td>
<p>default is &quot;,&quot;, character used to separate chunks</p>
</td></tr>
<tr><td><code id="parse_svec_+3A_connect">connect</code></td>
<td>
<p>characters defining connection links for example &quot;1:10&quot; is the same as &quot;1-10&quot;</p>
</td></tr>
<tr><td><code id="parse_svec_+3A_sort">sort</code></td>
<td>
<p>sort the result</p>
</td></tr>
<tr><td><code id="parse_svec_+3A_unique">unique</code></td>
<td>
<p>extract unique elements</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector. For example, &quot;1-3&quot; returns <code>c(1, 2, 3)</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+deparse_svec">deparse_svec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parse_svec('1-10, 13:15,14-20')
</code></pre>

<hr>
<h2 id='PersistContainer'>Wrapper to cache key-value pairs and persist across sessions</h2><span id='topic+PersistContainer'></span>

<h3>Description</h3>

<p>This class is designed to persist arbitrary R objects locally
and share across different sessions. The container consists two-level caches.
The first one is session-based, meaning it's only valid under current R
session and will be cleared once the session is shut down. The second is
the persist-level map, which will persist to hard drive and shared across
sessions. See <code>cache</code> method in 'details'.
</p>


<h3>Public Methods</h3>


<dl>
<dt><code>initialize(..., backend = rds_map)</code></dt><dd>
<p>The constructor. backend must inherit <code>AbstractMap</code>, <code>...</code> will
be passed to <code>backend$new(...)</code>. To check available back-ends and their
use cases, see <code><a href="#topic+map">map</a></code>.
</p>
</dd>
<dt><code>reset(all = FALSE)</code></dt><dd>
<p>Reset container. If all is set to be true, then reset session-based and
hard-drive-based, otherwise only reset session-based container.
</p>
</dd>
<dt><code>destroy(all = FALSE)</code></dt><dd>
<p>destroy the container. Only use it when you want to finalize the container in
<code><a href="base.html#topic+reg.finalizer">reg.finalizer</a></code>.
</p>
</dd>
<dt><code>has(key, signature = NULL)</code></dt><dd>
<p>returns a list of true/false (logical) vectors indicating whether keys exist
in the container, if signature is used when caching the key-value pairs, then
it also checks whether signature matches. This is very important as even if
the keys match but signature is wrong, the results will be false.
</p>
</dd>
<dt><code>remove(keys, all = TRUE)</code></dt><dd>
<p>Remove keys in the container. Default is to remove the keys in both levels.
If <code>all=FALSE</code>, then only remove the key in current session
</p>
</dd>
<dt><code>cache(key, value, signature = NULL, replace = FALSE, persist = FALSE)</code></dt><dd>
<p><code>key</code> and <code>signature</code> together form the unique identifier for the
value. By default <code>signature</code> is none, but it's very useful when value
if large, or <code>key</code> is not a string. <code>replace</code> indicates whether
to force replace the key-value pairs even if the entry exists. If
<code>persist</code> is true, then the value is stored in hard-disks, otherwise
the value will be deleted once the session is closed.
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+map">map</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
container = PersistContainer$new(tempfile())

# Reset the container so that values are cleared
container$reset(all = TRUE)

# Store `1` to 'a' with signature 111 to a non-persist map
# returns 1
container$cache(key = 'a', value = 1, signature = 111, persist = FALSE)

# Replace 'a' with 3
# returns 3
container$cache(key = 'a', value = 3, signature = 111,
                persist = TRUE, replace = TRUE)

# check if 'a' exists with signature 111
container$has('a', signature = 111)    # TRUE
# When you only have 'a' but no signature
container$has('a')                     # TRUE
# check if 'a' exists with wrong signature 222
container$has('a', signature = 222)    # FALSE


# Store 'a' with 2 with same signature
# will fail and ignore the value (value will not be evaluated if signatured)
# Return 2 (Important! use cached values)
container$cache(key = 'a', value = {
  print(123)
  return(2)
}, signature = 111, replace = FALSE)

# When no signature is present
# If the key exists (no signature provided), return stored value
# returns 3
container$cache(key = 'a', value = 4)

# replace is TRUE (no signature provided), signature will be some default value
container$cache(key = 'a', value = 2, replace = TRUE)

# destroy the container to free disk space
container$destroy()
</code></pre>

<hr>
<h2 id='print_directory_tree'>Print Directory Tree</h2><span id='topic+print_directory_tree'></span>

<h3>Description</h3>

<p>Print Directory Tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_directory_tree(
  target,
  root = "~",
  child,
  dir_only = FALSE,
  collapse = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_directory_tree_+3A_target">target</code></td>
<td>
<p>target directory path, relative to <code>root</code></p>
</td></tr>
<tr><td><code id="print_directory_tree_+3A_root">root</code></td>
<td>
<p>root directory, default is <code>'~'</code></p>
</td></tr>
<tr><td><code id="print_directory_tree_+3A_child">child</code></td>
<td>
<p>child files in target; is missing, then list all files</p>
</td></tr>
<tr><td><code id="print_directory_tree_+3A_dir_only">dir_only</code></td>
<td>
<p>whether to display directory children only</p>
</td></tr>
<tr><td><code id="print_directory_tree_+3A_collapse">collapse</code></td>
<td>
<p>whether to concatenate results as one single string</p>
</td></tr>
<tr><td><code id="print_directory_tree_+3A_...">...</code></td>
<td>
<p>pass to <code><a href="base.html#topic+list.files">list.files</a></code> when list all files</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Characters, print-friendly directory tree.
</p>

<hr>
<h2 id='progress2'>'Shiny' progress bar, but can run without reactive context</h2><span id='topic+progress2'></span>

<h3>Description</h3>

<p>'Shiny' progress bar, but can run without reactive context
</p>


<h3>Usage</h3>

<pre><code class='language-R'>progress2(
  title,
  max = 1,
  ...,
  quiet = FALSE,
  session = shiny::getDefaultReactiveDomain(),
  shiny_auto_close = FALSE,
  log = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="progress2_+3A_title">title</code></td>
<td>
<p>character, task description</p>
</td></tr>
<tr><td><code id="progress2_+3A_max">max</code></td>
<td>
<p>maximum number of items in the queue</p>
</td></tr>
<tr><td><code id="progress2_+3A_...">...</code></td>
<td>
<p>passed to <code>shiny::Progress$new(...)</code></p>
</td></tr>
<tr><td><code id="progress2_+3A_quiet">quiet</code></td>
<td>
<p>suppress console output, ignored in shiny context.</p>
</td></tr>
<tr><td><code id="progress2_+3A_session">session</code></td>
<td>
<p>'shiny' session, default is current reactive domain</p>
</td></tr>
<tr><td><code id="progress2_+3A_shiny_auto_close">shiny_auto_close</code></td>
<td>
<p>logical, automatically close 'shiny' progress bar
once current observer is over. Default is <code>FALSE</code>. If setting to
<code>TRUE</code>, then it's equivalent to
<code>p &lt;- progress2(...); on.exit({p$close()}, add = TRUE)</code>.</p>
</td></tr>
<tr><td><code id="progress2_+3A_log">log</code></td>
<td>
<p>function when running locally, default is <code>NULL</code>,
which redirects to <code><a href="#topic+cat2">cat2</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of functions:
</p>

<dl>
<dt><code>inc(detail, message = NULL, amount = 1, ...)</code></dt><dd>
<p>Increase progress bar by <code>amount</code> (default is 1).
</p>
</dd>
<dt><code>close()</code></dt><dd>
<p>Close the progress
</p>
</dd>
<dt><code>reset(detail = '', message = '', value = 0)</code></dt><dd>
<p>Reset the progress to <code>value</code> (default is 0), and reset information
</p>
</dd>
<dt><code>get_value()</code></dt><dd>
<p>Get current progress value
</p>
</dd>
<dt><code>is_closed()</code></dt><dd>
<p>Returns logical value if the progress is closed or not.
</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
progress &lt;- progress2('Task A', max = 2)
progress$inc('Detail 1')
progress$inc('Detail 2')
progress$close()

# Check if progress is closed
progress$is_closed()

# ------------------------------ Shiny Example ------------------------------
library(shiny)
library(dipsaus)

ui &lt;- fluidPage(
  actionButtonStyled('do', 'Click Here', type = 'primary')
)

server &lt;- function(input, output, session) {
  observeEvent(input$do, {
    updateActionButtonStyled(session, 'do', disabled = TRUE)
    progress &lt;- progress2('Task A', max = 10, shiny_auto_close = TRUE)
    lapply(1:10, function(ii){
      progress$inc(sprintf('Detail %d', ii))
      Sys.sleep(0.2)
    })
    updateActionButtonStyled(session, 'do', disabled = FALSE)
  })
}

if(interactive()){
  shinyApp(ui, server)
}

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+digest'></span><span id='topic+detectCores'></span><span id='topic+ansi_strip'></span><span id='topic+tree'></span><span id='topic+entrace'></span><span id='topic+cnd_entrace'></span><span id='topic+abort'></span><span id='topic+error_cnd'></span><span id='topic+trace_back'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>cli</dt><dd><p><code><a href="cli.html#topic+ansi_strip">ansi_strip</a></code>, <code><a href="cli.html#topic+tree">tree</a></code></p>
</dd>
<dt>digest</dt><dd><p><code><a href="digest.html#topic+digest">digest</a></code></p>
</dd>
<dt>parallel</dt><dd><p><code><a href="parallel.html#topic+detectCores">detectCores</a></code></p>
</dd>
<dt>rlang</dt><dd><p><code><a href="rlang.html#topic+abort">abort</a></code>, <code><a href="rlang.html#topic+entrace">cnd_entrace</a></code>, <code><a href="rlang.html#topic+entrace">entrace</a></code>, <code><a href="rlang.html#topic+cnd">error_cnd</a></code>, <code><a href="rlang.html#topic+trace_back">trace_back</a></code></p>
</dd>
</dl>

<hr>
<h2 id='registerInputBinding'>Register customized input to enable support by compound input</h2><span id='topic+registerInputBinding'></span>

<h3>Description</h3>

<p>Register customized input to enable support by compound input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>registerInputBinding(
  fname,
  pkg,
  shiny_binding,
  update_function = NULL,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="registerInputBinding_+3A_fname">fname</code></td>
<td>
<p>character, function name, such as <code>"textInput"</code></p>
</td></tr>
<tr><td><code id="registerInputBinding_+3A_pkg">pkg</code></td>
<td>
<p>character, package name, like <code>"shiny"</code></p>
</td></tr>
<tr><td><code id="registerInputBinding_+3A_shiny_binding">shiny_binding</code></td>
<td>
<p>character, 'JavaScript' binding name.See examples</p>
</td></tr>
<tr><td><code id="registerInputBinding_+3A_update_function">update_function</code></td>
<td>
<p>character, update function such as <code>"shiny::textInput"</code></p>
</td></tr>
<tr><td><code id="registerInputBinding_+3A_quiet">quiet</code></td>
<td>
<p>logical, whether to suppress warnings</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of binding functions, one is 'JavaScript' object key in
<code>Shiny.inputBindings</code>, the other is 'shiny' update function in R end.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# register shiny textInput
registerInputBinding('textInput', 'shiny',
                     'shiny.textInput', 'shiny::updateTextInput')

# Register shiny actionLink
# In "Shiny.inputbindings", the binding name is "shiny.actionButtonInput",
# Shiny update function is "shiny::updateActionButton"
registerInputBinding('actionLink', 'shiny',
                     'shiny.actionButtonInput', 'shiny::updateActionButton')

</code></pre>

<hr>
<h2 id='restart_session'>Restart R Session</h2><span id='topic+restart_session'></span>

<h3>Description</h3>

<p>Utilize 'RStudio' functions to restart, if running without
'RStudio', use <code>startup</code>restart instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restart_session()
</code></pre>

<hr>
<h2 id='rs_active_project'>Get 'RStudio' active project</h2><span id='topic+rs_active_project'></span>

<h3>Description</h3>

<p>Get 'RStudio' active project
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_active_project(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs_active_project_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="#topic+rs_avail">rs_avail</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>If 'RStudio' is running and current project is not none, return
project name, otherwise return <code>NA</code>
</p>

<hr>
<h2 id='rs_avail'>Verify 'RStudio' version</h2><span id='topic+rs_avail'></span>

<h3>Description</h3>

<p>Verify 'RStudio' version
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_avail(version_needed = "1.3", child_ok = FALSE, shiny_ok = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs_avail_+3A_version_needed">version_needed</code></td>
<td>
<p>minimum version required</p>
</td></tr>
<tr><td><code id="rs_avail_+3A_child_ok">child_ok</code></td>
<td>
<p>check if the current R process is a child process of the
main RStudio session.</p>
</td></tr>
<tr><td><code id="rs_avail_+3A_shiny_ok">shiny_ok</code></td>
<td>
<p>if set false, then check if 'Shiny' is running, return false
if shiny reactive domain is not <code>NULL</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>whether 'RStudio' is running and its version is above the
required
</p>


<h3>See Also</h3>

<p><code><a href="rstudioapi.html#topic+isAvailable">isAvailable</a></code>
</p>

<hr>
<h2 id='rs_edit_file'>Use 'RStudio' to open and edit files</h2><span id='topic+rs_edit_file'></span>

<h3>Description</h3>

<p>Use 'RStudio' to open and edit files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_edit_file(path, create = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs_edit_file_+3A_path">path</code></td>
<td>
<p>path to file</p>
</td></tr>
<tr><td><code id="rs_edit_file_+3A_create">create</code></td>
<td>
<p>whether to create if path is not found; default is true</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Opens the file pointing to <code>path</code> to edit, and returns the
path
</p>

<hr>
<h2 id='rs_exec'>Schedule a Background Job</h2><span id='topic+rs_exec'></span>

<h3>Description</h3>

<p>Utilizes 'RStudio' job scheduler if correct environment is
detected, otherwise call system command via <code>Rscript</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_exec(
  expr,
  name = "Untitled",
  quoted = FALSE,
  rs = TRUE,
  as_promise = FALSE,
  wait = FALSE,
  packages = NULL,
  focus_on_console = FALSE,
  ...,
  nested_ok = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs_exec_+3A_expr">expr</code></td>
<td>
<p>R expression</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_name">name</code></td>
<td>
<p>used by 'RStudio' as name of the job</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_quoted">quoted</code></td>
<td>
<p>is <code>expr</code> quoted</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_rs">rs</code></td>
<td>
<p>whether to use 'RStudio' by default</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_as_promise">as_promise</code></td>
<td>
<p>whether to return as a <code><a href="promises.html#topic+promise">promise</a></code>
object; default is no</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_wait">wait</code></td>
<td>
<p>whether to wait for the result.</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_packages">packages</code></td>
<td>
<p>packages to load in the sub-sessions</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_focus_on_console">focus_on_console</code></td>
<td>
<p>whether to return back to console after creating
jobs; useful when users want to focus on writing code; default is false.
This feature works with 'RStudio' (<code>&gt;=1.4</code>)</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_...">...</code></td>
<td>
<p>internally used</p>
</td></tr>
<tr><td><code id="rs_exec_+3A_nested_ok">nested_ok</code></td>
<td>
<p>whether nested <code>rs_exec</code> is allowed; default is false;
Set to true to allow nested parallel code, but use at your own risk.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'RStudio' provides interfaces <code><a href="rstudioapi.html#topic+jobRunScript">jobRunScript</a></code> to
schedule background jobs. However, this
functionality only applies using 'RStudio' IDE. When launching R from
other places such as terminals, the job scheduler usually result in
errors. In this case, the alternative is to call system command via
<code>Rscript</code>
</p>
<p>The expression <code>expr</code> will run a clean environment. Therefore R objects
created outside of the context will be inaccessible from within the child
environment, and packages except for base packages will not be loaded.
</p>
<p>There is a small difference when running within and without 'RStudio'.
When running via <code>Rscript</code>, the environment will run under
<code>vanilla</code> argument, which means no load, no start-up code. If you
have start-up code stored at <code>~/.Rprofile</code>, the start-up code will be
ignored. When running within 'RStudio', the start-up code will be executed.
As of <code>rstudioapi</code> version 0.11, there is no 'vanilla' option. This
feature is subject to change in the future.
</p>


<h3>Value</h3>

<p>If <code>wait=TRUE</code>, returns evaluation results of <code>expr</code>,
otherwise a function that can track the state of job.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){
  h &lt;- rs_exec(
    {
      Sys.sleep(2)
      print(Sys.getpid())
    },
    wait = FALSE, name = 'Test',
    focus_on_console = TRUE
  )
  code &lt;- h()
  print(code)

  # wait 3 seconds
  Sys.sleep(3)
  code &lt;- h()
  attributes(code)
}

</code></pre>

<hr>
<h2 id='rs_focus_console'>Focus on 'RStudio' Console</h2><span id='topic+rs_focus_console'></span>

<h3>Description</h3>

<p>Focus on coding; works with 'RStudio' (<code>&gt;=1.4</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_focus_console(wait = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs_focus_console_+3A_wait">wait</code></td>
<td>
<p>wait in seconds before sending command; if too soon, then
'RStudio' might not be able to react.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='rs_save_all'>Save all documents in 'RStudio'</h2><span id='topic+rs_save_all'></span>

<h3>Description</h3>

<p>Perform &quot;safe&quot; save-all action with backward
compatibility: check whether 'RStudio' is running and whether
<code>rstudioapi</code> has function <code>documentSaveAll</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_save_all()
</code></pre>

<hr>
<h2 id='rs_select_path'>Use 'RStudio' to Select a Path on the Server</h2><span id='topic+rs_select_path'></span>

<h3>Description</h3>

<p>Use 'RStudio' to Select a Path on the Server
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_select_path(is_directory = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs_select_path_+3A_is_directory">is_directory</code></td>
<td>
<p>whether the path should be a directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Raise error if <code><a href="#topic+rs_avail">rs_avail</a></code> fails,
otherwise returns the selected path
</p>

<hr>
<h2 id='rs_set_repos'>Add secondary 'CRAN'-like repository to the 'RStudio' settings</h2><span id='topic+rs_set_repos'></span>

<h3>Description</h3>

<p>Add self-hosted repository, such as 'drat', 'r-universe' to
'RStudio' preference. Please restart 'RStudio' to take changes into effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_set_repos(name, url, add = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs_set_repos_+3A_name">name</code></td>
<td>
<p>repository name, must be unique and readable</p>
</td></tr>
<tr><td><code id="rs_set_repos_+3A_url">url</code></td>
<td>
<p>the website address of the repository, starting with schemes
such as <code>'https'</code>.</p>
</td></tr>
<tr><td><code id="rs_set_repos_+3A_add">add</code></td>
<td>
<p>whether to add to existing repository; default is true</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'RStudio' allows to add secondary 'CRAN'-like repository to its
preference, such that users can add on-going self-hosted developing
repositories (such as package <code>'drat'</code>, or 'r-universe'). These
repositories will be set automatically when running
<code><a href="utils.html#topic+install.packages">install.packages</a></code>.
</p>


<h3>Value</h3>

<p>a list of settings.
</p>

<hr>
<h2 id='rs_viewer'>Get 'RStudio' Viewer, or Return Default</h2><span id='topic+rs_viewer'></span>

<h3>Description</h3>

<p>Get 'RStudio' Viewer, or Return Default
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rs_viewer(
  ...,
  default = TRUE,
  version_needed = "1.3",
  child_ok = FALSE,
  shiny_ok = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rs_viewer_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="rstudioapi.html#topic+viewer">viewer</a></code></p>
</td></tr>
<tr><td><code id="rs_viewer_+3A_default">default</code></td>
<td>
<p>if <code><a href="#topic+rs_avail">rs_avail</a></code> fails, the
value to return. Default is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="rs_viewer_+3A_version_needed">version_needed</code>, <code id="rs_viewer_+3A_child_ok">child_ok</code>, <code id="rs_viewer_+3A_shiny_ok">shiny_ok</code></td>
<td>
<p>passed to <code><a href="#topic+rs_avail">rs_avail</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code><a href="rstudioapi.html#topic+viewer">viewer</a></code> can be called and
'RStudio' is running, then launch 'RStudio' internal viewer.
Otherwise if <code>default</code> is a function such as
<code><a href="utils.html#topic+browseURL">browseURL</a></code>, then call the function with given
arguments. If <code>default</code> is not a function, return <code>default</code>
</p>

<hr>
<h2 id='screenshot'>Take a screenshot in shiny apps</h2><span id='topic+screenshot'></span>

<h3>Description</h3>

<p>Take a screenshot of the whole page and save encoded
<code>DataURI</code> that can be accessed via <code>input[[inputId]]</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screenshot(inputId, session = shiny::getDefaultReactiveDomain())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screenshot_+3A_inputid">inputId</code></td>
<td>
<p>the input id where the screenshot should be</p>
</td></tr>
<tr><td><code id="screenshot_+3A_session">session</code></td>
<td>
<p>shiny session</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. However, the screenshot results can be accessed from
shiny input
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(shiny)
library(dipsaus)
ui &lt;- fluidPage(
  tagList(
    shiny::singleton(shiny::tags$head(
      shiny::tags$link(rel="stylesheet", type="text/css", href="dipsaus/dipsaus.css"),
      shiny::tags$script(src="dipsaus/dipsaus-dipterix-lib.js")
    ))
  ),
  actionButtonStyled('do', 'Take Screenshot'),
  compoundInput2('group', label = 'Group', components = list(
    textInput('txt', 'Enter something here')
  ))
)

server &lt;- function(input, output, session) {
  observeEvent(input$do, {
    screenshot('screeshot_result')
  })
  observeEvent(input$screeshot_result, {
    showModal(modalDialog(
      tags$img(src = input$screeshot_result, width = '100%')
    ))
  })
}

if(interactive()){
  shinyApp(ui, server)
}

</code></pre>

<hr>
<h2 id='session_uuid'>Provides Unique Session ID According to Current R Session</h2><span id='topic+session_uuid'></span>

<h3>Description</h3>

<p>Provides Unique Session ID According to Current R Session
</p>


<h3>Usage</h3>

<pre><code class='language-R'>session_uuid(pid = Sys.getpid(), attributes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="session_uuid_+3A_pid">pid</code></td>
<td>
<p>R session process ID, default is <code>Sys.getpid()</code></p>
</td></tr>
<tr><td><code id="session_uuid_+3A_attributes">attributes</code></td>
<td>
<p>whether to append data used to calculate
ID as attributes, default is false</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string
</p>

<hr>
<h2 id='set_shiny_input'>Set Shiny Input</h2><span id='topic+set_shiny_input'></span>

<h3>Description</h3>

<p>Shiny &lsquo;input&rsquo; object is read-only reactive list. When try to
assign values to input, errors usually occur. This method provides several
work-around to set values to input. Please use along with
<code><a href="#topic+use_shiny_dipsaus">use_shiny_dipsaus</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_shiny_input(
  session = shiny::getDefaultReactiveDomain(),
  inputId,
  value,
  priority = c("event", "deferred", "immediate"),
  method = c("proxy", "serialize", "value", "expression"),
  quoted = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_shiny_input_+3A_session">session</code></td>
<td>
<p>shiny session, see shiny <code><a href="shiny.html#topic+domains">domains</a></code></p>
</td></tr>
<tr><td><code id="set_shiny_input_+3A_inputid">inputId</code></td>
<td>
<p>character, input ID</p>
</td></tr>
<tr><td><code id="set_shiny_input_+3A_value">value</code></td>
<td>
<p>the value to assign</p>
</td></tr>
<tr><td><code id="set_shiny_input_+3A_priority">priority</code></td>
<td>
<p>characters, options are &quot;event&quot;, &quot;deferred&quot;, and &quot;immediate&quot;.
&quot;event&quot; and &quot;immediate&quot; are similar, they always fire changes. &quot;deferred&quot;
fire signals to other reactive/observers only when the input value has been
changed</p>
</td></tr>
<tr><td><code id="set_shiny_input_+3A_method">method</code></td>
<td>
<p>characters, options are &quot;proxy&quot;, &quot;serialize&quot;, &quot;value&quot;,
&quot;expression&quot;. &quot;proxy&quot; is recommended, other methods are experimental.</p>
</td></tr>
<tr><td><code id="set_shiny_input_+3A_quoted">quoted</code></td>
<td>
<p>is value quoted? Only used when method is &quot;expression&quot;</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(shiny)
library(dipsaus)
ui &lt;- fluidPage(
  # Register widgets
  use_shiny_dipsaus(),
  actionButton('run', 'Set Input'),
  verbatimTextOutput('input_value')
)

server &lt;- function(input, output, session) {
  start = Sys.time()

  output$input_value &lt;- renderPrint({

    now &lt;- input$key
    now %?&lt;-% start
    cat('This app has been opened for ',
        difftime(now, start, units = 'sec'), ' seconds')
  })

  observeEvent(input$run, {
    # setting input$key to Sys.time()
    set_shiny_input(session, 'key', Sys.time())
  })
}

if(interactive()){
  shinyApp(ui, server)
}


</code></pre>

<hr>
<h2 id='sexp_type2'>Get Internal Storage Type</h2><span id='topic+sexp_type2'></span><span id='topic+as.character.sexp_type2'></span><span id='topic+print.sexp_type2'></span>

<h3>Description</h3>

<p>Get internal (<code>C</code>) data types; See
<a href="https://cran.r-project.org/doc/manuals/r-release/R-ints.pdf">https://cran.r-project.org/doc/manuals/r-release/R-ints.pdf</a> Page 1
for more different <code>SEXPTYPE</code>s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sexp_type2(x)

## S3 method for class 'sexp_type2'
as.character(x, ...)

## S3 method for class 'sexp_type2'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sexp_type2_+3A_x">x</code></td>
<td>
<p>any <span class="pkg">R</span> object</p>
</td></tr>
<tr><td><code id="sexp_type2_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer of class <code>"sexp_type2"</code>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+storage.mode">storage.mode</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1 vs 1L

# Integer case
sexp_type2(1L)

# double
sexp_type2(1)

# Built-in function
sexp_type2(`+`)

# normal functions
sexp_type2(sexp_type2)

# symbols (quoted names)
sexp_type2(quote(`+`))

# Calls (quoted expressions)
sexp_type2(quote({`+`}))


</code></pre>

<hr>
<h2 id='shared_finalizer'>Create Shared Finalization to Avoid Over Garbage Collection</h2><span id='topic+shared_finalizer'></span><span id='topic+shared_finalizer.default'></span><span id='topic+shared_finalizer.R6'></span><span id='topic+shared_finalizer.fastmap'></span><span id='topic+shared_finalizer.fastmap2'></span>

<h3>Description</h3>

<p>Generates a function to be passed to
<code><a href="base.html#topic+reg.finalizer">reg.finalizer</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shared_finalizer(x, key, fin, onexit = FALSE, ...)

## Default S3 method:
shared_finalizer(x, key, fin, onexit = FALSE, ...)

## S3 method for class 'R6'
shared_finalizer(x, key, fin, onexit = TRUE, ...)

## S3 method for class 'fastmap'
shared_finalizer(x, key, fin, onexit = FALSE, ...)

## S3 method for class 'fastmap2'
shared_finalizer(x, key, fin, onexit = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shared_finalizer_+3A_x">x</code></td>
<td>
<p>object to finalize</p>
</td></tr>
<tr><td><code id="shared_finalizer_+3A_key">key</code></td>
<td>
<p>characters that should be identical if
finalization method is to be shared</p>
</td></tr>
<tr><td><code id="shared_finalizer_+3A_fin">fin</code></td>
<td>
<p>Shared finalization: function to call on finalization;
see <code><a href="base.html#topic+reg.finalizer">reg.finalizer</a></code>. See details.</p>
</td></tr>
<tr><td><code id="shared_finalizer_+3A_onexit">onexit</code></td>
<td>
<p>logical: should the finalization be run if the
object is still uncollected at the end of the R session?
See <code><a href="base.html#topic+reg.finalizer">reg.finalizer</a></code></p>
</td></tr>
<tr><td><code id="shared_finalizer_+3A_...">...</code></td>
<td>
<p>passed to other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main purpose of this function is to allow multiple
objects that point to a same source (say a temporary file) to
perform clean up when all the objects are garbage collected.
</p>
<p>Base function <code><a href="base.html#topic+reg.finalizer">reg.finalizer</a></code> provides finalization
to to garbage collect single R environment. However, when multiple
environments share the same file, finalizing one single environment
will result in removing the file so that all the other environment
lose the reference. (See example &quot;Native <code>reg.finalizer</code>
fails example&quot;)
</p>
<p>The argument of <code>fin</code> varies according to different types of
<code>x</code>. For environments, <code>fin</code> contains and only contains
one parameter, which is the environment itself. This is the same
as <code>reg.finalizer</code>. For <code>R6</code> classes, <code>fin</code> is
ignored if class has <code>"shared_finalize"</code> method defined.
For <code><a href="fastmap.html#topic+fastmap">fastmap</a></code> or <code><a href="#topic+fastmap2">fastmap2</a></code>
instances, <code>fin</code> accepts no argument.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ------------ Environment example ------------
file_exists &lt;- TRUE
clear_files &lt;- function(e){
  print('Clean some shared files')
  # do something to remove files
  file_exists &lt;&lt;- FALSE
}

# e1, e2 both require file existence
e1 &lt;- new.env()
e1$valid &lt;- function(){ file_exists }
e2 &lt;- new.env()
e2$valid &lt;- function(){ file_exists }

e1$valid(); e2$valid()

# we don't want to remove files when either e1,e2 gets
# garbage collected, however, we want to run `clear_files`
# when system garbage collecting *both* e1 and e2

# Make sure `key`s are identical
shared_finalizer(e1, 'cleanXXXfiles', clear_files)
shared_finalizer(e2, 'cleanXXXfiles', clear_files)

# Now remove e1, files are not cleaned, and e2 is still valid
rm(e1); invisible(gc(verbose = FALSE))
e2$valid()  # TRUE
file_exists # TRUE

# remove both e1 and e2, and file gets removed
rm(e2); invisible(gc(verbose = FALSE))
file_exists  # FALSE

# ------------ R6 example ------------

cls &lt;- R6::R6Class(
  classname = '...demo...',
  cloneable = TRUE,
  public = list(
    file_path = character(0),
    shared_finalize = function(){
      cat('Finalize shared resource - ', self$file_path, '\n')
    },
    finalize = function(){
      cat('Finalize private resource\n')
    },
    initialize = function(file_path){
      self$file_path = file_path
      shared_finalizer(self, key = self$file_path)
    }
  )
)
e1 &lt;- cls$new('file1')
rm(e1); invisible(gc(verbose = FALSE))

e1 &lt;- cls$new('file2')

# A copy of e1
e2 &lt;- e1$clone()
# unfortunately, we have to manually register
shared_finalizer(e2, key = e2$file_path)

# Remove e1, gc only free private resource
rm(e1); invisible(gc(verbose = FALSE))

# remove e1 and e2, run shared finalize
rm(e2); invisible(gc(verbose = FALSE))

# ------------ fastmap/fastmap2 example -----------

# No formals needed for fastmap/fastmap2
fin &lt;- function(){
  cat('Finalizer is called\n')
}
# single reference case
e1 &lt;- dipsaus::fastmap2()
shared_finalizer(e1, 'fin-fastmap2', fin = fin)
invisible(gc(verbose = FALSE)) # Not triggered
rm(e1); invisible(gc(verbose = FALSE)) # triggered

# multiple reference case
e1 &lt;- dipsaus::fastmap2()
e2 &lt;- dipsaus::fastmap2()
shared_finalizer(e1, 'fin-fastmap2', fin = fin)
shared_finalizer(e2, 'fin-fastmap2', fin = fin)

rm(e1); invisible(gc(verbose = FALSE)) # Not triggered
rm(e2); invisible(gc(verbose = FALSE)) # triggered

# ------------ Native reg.finalizer fails example ------------

# This example shows a failure case using base::reg.finalizer

file_exists &lt;- TRUE
clear_files &lt;- function(e){
  print('Clean some shared files')
  # do something to remove files
  file_exists &lt;&lt;- FALSE
}

# e1, e2 both require file existence
e1 &lt;- new.env()
e1$valid &lt;- function(){ file_exists }
e2 &lt;- new.env()
e2$valid &lt;- function(){ file_exists }

reg.finalizer(e1, clear_files)
reg.finalizer(e2, clear_files)
gc()
file_exists

# removing e1 will invalidate e2
rm(e1); gc()
e2$valid()    # FALSE

# Clean-ups
rm(e2); gc()

</code></pre>

<hr>
<h2 id='shift_array'>Shift Array by Index</h2><span id='topic+shift_array'></span>

<h3>Description</h3>

<p>Re-arrange arrays in parallel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shift_array(x, shift_idx, shift_by, shift_amount)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shift_array_+3A_x">x</code></td>
<td>
<p>array, must have at least matrix</p>
</td></tr>
<tr><td><code id="shift_array_+3A_shift_idx">shift_idx</code></td>
<td>
<p>which index is to be shifted</p>
</td></tr>
<tr><td><code id="shift_array_+3A_shift_by">shift_by</code></td>
<td>
<p>which dimension decides <code>shift_amount</code></p>
</td></tr>
<tr><td><code id="shift_array_+3A_shift_amount">shift_amount</code></td>
<td>
<p>shift amount along <code>shift_idx</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple use-case for this function is to think of a matrix where each row
is a signal and columns stand for time. The objective is to align (time-lock)
each signal according to certain events. For each signal, we want to shift
the time points by certain amount.
</p>
<p>In this case, the shift amount is defined by <code>shift_amount</code>, whose
length equals to number of signals. <code>shift_idx=2</code> as we want to shift
time points (column, the second dimension) for each signal. <code>shift_by=1</code>
because the shift amount is depend on the signal number.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:10, nrow = 2, byrow = TRUE)
z &lt;- shift_array(x, 2, 1, c(1,2))

y &lt;- NA * x
y[1,1:4] = x[1,2:5]
y[2,1:3] = x[2,3:5]

# Check if z ang y are the same
z - y

# array case
# x is Trial x Frequency x Time
x &lt;- array(1:27, c(3,3,3))

# Shift time for each trial, amount is 1, -1, 0
shift_amount &lt;- c(1,-1,0)
z &lt;- shift_array(x, 3, 1, shift_amount)

if(interactive()){

par(mfrow = c(3, 2))
for( ii in 1:3 ){
  image(t(x[ii, ,]), ylab = 'Frequency', xlab = 'Time',
        main = paste('Trial', ii))
  image(t(z[ii, ,]), ylab = 'Frequency', xlab = 'Time',
        main = paste('Shifted amount:', shift_amount[ii]))
}

}

</code></pre>

<hr>
<h2 id='shiny_alert2'>Simple shiny alert that uses 'JavaScript' promises</h2><span id='topic+shiny_alert2'></span><span id='topic+close_alert2'></span>

<h3>Description</h3>

<p>Simple shiny alert that uses 'JavaScript' promises
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny_alert2(
  title = "Alert",
  text = "",
  icon = c("info", "warning", "success", "error"),
  danger_mode = FALSE,
  auto_close = TRUE,
  buttons = NULL,
  on_close = NULL,
  session = shiny::getDefaultReactiveDomain()
)

close_alert2()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shiny_alert2_+3A_title">title</code></td>
<td>
<p>title of the alert</p>
</td></tr>
<tr><td><code id="shiny_alert2_+3A_text">text</code></td>
<td>
<p>alert body text (pure text)</p>
</td></tr>
<tr><td><code id="shiny_alert2_+3A_icon">icon</code></td>
<td>
<p>which icon to display, choices are <code>'info'</code>,
<code>'success'</code> <code>'warning'</code>, and <code>'error'</code></p>
</td></tr>
<tr><td><code id="shiny_alert2_+3A_danger_mode">danger_mode</code></td>
<td>
<p>true or false; if true, then the confirm button turns
red and the default focus is set on the cancel button instead. To enable
danger mode, <code>buttons</code> must be <code>TRUE</code> as well</p>
</td></tr>
<tr><td><code id="shiny_alert2_+3A_auto_close">auto_close</code></td>
<td>
<p>whether to close automatically when clicking outside of
the alert</p>
</td></tr>
<tr><td><code id="shiny_alert2_+3A_buttons">buttons</code></td>
<td>
<p>logical value or a named list, or characters. If logical,
it indicates whether buttons should be displayed or not; for named list,
the names will be the button text, see example; for characters, the
characters will be the button text and value</p>
</td></tr>
<tr><td><code id="shiny_alert2_+3A_on_close">on_close</code></td>
<td>
<p><code>NULL</code> or a function that takes in one argument. If
function is passed in, then it will be executed when users close the alert</p>
</td></tr>
<tr><td><code id="shiny_alert2_+3A_session">session</code></td>
<td>
<p>shiny session, see <code><a href="shiny.html#topic+domains">domains</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a temporary input ID, currently not useful
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(shiny)
library(dipsaus)
ui &lt;- fluidPage(
  use_shiny_dipsaus(),
  actionButtonStyled('btn', 'btn')
)

server &lt;- function(input, output, session) {
  observeEvent(input$btn, {
    shiny_alert2(
      on_close = function(value) {
        cat("Modal closed!\n")
        print(value)
      },
      title = "Title",
      text = "message",
      icon = "success",
      auto_close = FALSE,
      buttons = list("cancel" = TRUE,
                     "YES!" = list(value = 1))
    )
  })
}

if(interactive()){
  shinyApp(ui, server, options = list(launch.browser = TRUE))
}

</code></pre>

<hr>
<h2 id='shiny_is_running'>Detect whether 'Shiny' is running</h2><span id='topic+shiny_is_running'></span>

<h3>Description</h3>

<p>Detect whether 'Shiny' is running
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny_is_running()
</code></pre>


<h3>Value</h3>

<p>logical, true if current shiny context is active
</p>

<hr>
<h2 id='ste_mean'>Standard error of mean</h2><span id='topic+ste_mean'></span><span id='topic+ste_mean.default'></span>

<h3>Description</h3>

<p>Ported from <code>'rutabaga'</code> package, calculates standard error
of mean. The sample size is determined by number of none-<code>NA</code> numbers
by default
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ste_mean(x, na.rm = FALSE, na_as_zero = na.rm, ...)

## Default S3 method:
ste_mean(x, na.rm = FALSE, na_as_zero = na.rm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ste_mean_+3A_x">x</code></td>
<td>
<p>R object</p>
</td></tr>
<tr><td><code id="ste_mean_+3A_na.rm">na.rm</code></td>
<td>
<p>whether to remove <code>NA</code>; default is false</p>
</td></tr>
<tr><td><code id="ste_mean_+3A_na_as_zero">na_as_zero</code></td>
<td>
<p>whether convert <code>NA</code> to zero</p>
</td></tr>
<tr><td><code id="ste_mean_+3A_...">...</code></td>
<td>
<p>passed to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical number that is the standard error of the mean
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mean_se">mean_se</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rnorm(100)

ste_mean(x)

# internal implementation
identical(ste_mean(x), sd(x) / sqrt(100))

</code></pre>

<hr>
<h2 id='sumsquared'>Fast Calculation of Sum-squared for Large Matrices/Vectors</h2><span id='topic+sumsquared'></span>

<h3>Description</h3>

<p>Calculate <code>sum(x^2)</code>, but faster when the number of
elements exceeds 1000.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumsquared_+3A_x">x</code></td>
<td>
<p>double, integer, or logical vector/matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical scalar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rnorm(10000)
sumsquared(x)

# Compare speed
microbenchmark::microbenchmark(
  cpp = {sumsquared(x)},
  r = {sum(x^2)}
)

</code></pre>

<hr>
<h2 id='sync_shiny_inputs'>Synchronize Shiny Inputs</h2><span id='topic+sync_shiny_inputs'></span>

<h3>Description</h3>

<p>Synchronize Shiny Inputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sync_shiny_inputs(
  input,
  session,
  inputIds,
  uniform = rep("I", length(inputIds)),
  updates,
  snap = 250,
  ignoreNULL = TRUE,
  ignoreInit = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sync_shiny_inputs_+3A_input">input</code>, <code id="sync_shiny_inputs_+3A_session">session</code></td>
<td>
<p>shiny reactive objects</p>
</td></tr>
<tr><td><code id="sync_shiny_inputs_+3A_inputids">inputIds</code></td>
<td>
<p>input ids to be synchronized</p>
</td></tr>
<tr><td><code id="sync_shiny_inputs_+3A_uniform">uniform</code></td>
<td>
<p>functions, equaling to length of <code>inputIds</code>, converting inputs
to a uniform values</p>
</td></tr>
<tr><td><code id="sync_shiny_inputs_+3A_updates">updates</code></td>
<td>
<p>functions, equaling to length of <code>inputIds</code>, updating input values</p>
</td></tr>
<tr><td><code id="sync_shiny_inputs_+3A_snap">snap</code></td>
<td>
<p>numeric, milliseconds to defer the changes</p>
</td></tr>
<tr><td><code id="sync_shiny_inputs_+3A_ignorenull">ignoreNULL</code>, <code id="sync_shiny_inputs_+3A_ignoreinit">ignoreInit</code></td>
<td>
<p>passed to <code><a href="shiny.html#topic+bindEvent">bindEvent</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>none.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(shiny)

ui &lt;- fluidPage(
  textInput('a', 'a', value = 'a'),
  sliderInput('b', 'b', value = 1, min = 0, max = 1000)
)

server &lt;- function(input, output, session) {
  sync_shiny_inputs(input, session, inputIds = c('a', 'b'), uniform = list(
    function(a){as.numeric(a)},
    'I'
  ), updates = list(
    function(a){updateTextInput(session, 'a', value = a)},
    function(b){updateSliderInput(session, 'b', value = b)}
  ))

}

if( interactive() ){
  shinyApp(ui, server)
}

</code></pre>

<hr>
<h2 id='test_farg'>Test whether function has certain arguments</h2><span id='topic+test_farg'></span>

<h3>Description</h3>

<p>Test whether function has certain arguments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_farg(fun, arg, dots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_farg_+3A_fun">fun</code></td>
<td>
<p>function</p>
</td></tr>
<tr><td><code id="test_farg_+3A_arg">arg</code></td>
<td>
<p>characters of function arguments</p>
</td></tr>
<tr><td><code id="test_farg_+3A_dots">dots</code></td>
<td>
<p>whether <code>fun</code>'s dots (<code>...</code>) counts</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
a &lt;- function(n = 1){}

# Test whether `a` has argument called 'b'
test_farg(a, 'b')

# Test whether `a` has argument called 'b' and 'n'
test_farg(a, c('b', 'n'))

# `a` now has dots
a &lt;- function(n = 1, ...){}

# 'b' could goes to dots and a(b=...) is still valid
test_farg(a, 'b')

# strict match, dots doesn't count
test_farg(a, 'b', dots = FALSE)

</code></pre>

<hr>
<h2 id='time_delta'>Calculate time difference and return a number</h2><span id='topic+time_delta'></span>

<h3>Description</h3>

<p>Calculate time difference and return a number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_delta(t1, t2, units = "secs")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_delta_+3A_t1">t1</code></td>
<td>
<p>time start</p>
</td></tr>
<tr><td><code id="time_delta_+3A_t2">t2</code></td>
<td>
<p>time end</p>
</td></tr>
<tr><td><code id="time_delta_+3A_units">units</code></td>
<td>
<p>character, choices are <code>'secs'</code>, <code>'mins'</code>, <code>'hours'</code>, and <code>'days'</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric difference of time in units specified
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = Sys.time()
Sys.sleep(0.3)
b = Sys.time()

time_delta(a, b) # In seconds, around 0.3
time_delta(a, b, 'mins') # in minutes, around 0.005

</code></pre>

<hr>
<h2 id='to_datauri'>Convert file to 'base64' format</h2><span id='topic+to_datauri'></span>

<h3>Description</h3>

<p>Convert file to 'base64' format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_datauri(file, mime = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_datauri_+3A_file">file</code></td>
<td>
<p>file path</p>
</td></tr>
<tr><td><code id="to_datauri_+3A_mime">mime</code></td>
<td>
<p>'mime' type, default is blank</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a 'base64' data string looks like <code>'data:;base64,AEF6986...'</code>
</p>

<hr>
<h2 id='to_ram_size'>Convert bytes to KB, MB, GB,...</h2><span id='topic+to_ram_size'></span>

<h3>Description</h3>

<p>Convert bytes to KB, MB, GB,...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_ram_size(s, kb_to_b = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_ram_size_+3A_s">s</code></td>
<td>
<p>size</p>
</td></tr>
<tr><td><code id="to_ram_size_+3A_kb_to_b">kb_to_b</code></td>
<td>
<p>how many bytes counts one KB, 1000 by default</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric equaling to <code>s</code> but formatted
</p>

<hr>
<h2 id='update_fastmap2'>Migrate a <code>fastmap2</code> object to a new one</h2><span id='topic+update_fastmap2'></span>

<h3>Description</h3>

<p>Migrate a <code>fastmap2</code> object to a new one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_fastmap2(from, to, override = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_fastmap2_+3A_from">from</code>, <code id="update_fastmap2_+3A_to">to</code></td>
<td>
<p><code>fastmap2</code> object</p>
</td></tr>
<tr><td><code id="update_fastmap2_+3A_override">override</code></td>
<td>
<p>whether to override keys in <code>to</code> if they exist</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Map <code>to</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fastmap2">fastmap2</a></code>
</p>

<hr>
<h2 id='updateActionButtonStyled'>Update styled action button</h2><span id='topic+updateActionButtonStyled'></span>

<h3>Description</h3>

<p>Update styled action button
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateActionButtonStyled(
  session,
  inputId,
  label = NULL,
  icon = NULL,
  type = NULL,
  disabled = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateActionButtonStyled_+3A_session">session</code>, <code id="updateActionButtonStyled_+3A_inputid">inputId</code>, <code id="updateActionButtonStyled_+3A_label">label</code>, <code id="updateActionButtonStyled_+3A_icon">icon</code></td>
<td>
<p>passed to <code>shiny::updateActionButton</code></p>
</td></tr>
<tr><td><code id="updateActionButtonStyled_+3A_type">type</code></td>
<td>
<p>button type to update</p>
</td></tr>
<tr><td><code id="updateActionButtonStyled_+3A_disabled">disabled</code></td>
<td>
<p>whether to disable the button</p>
</td></tr>
<tr><td><code id="updateActionButtonStyled_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>


<h3>See Also</h3>

<p><code><a href="#topic+actionButtonStyled">actionButtonStyled</a></code> for how to define the button.
</p>

<hr>
<h2 id='updateCompoundInput2'>Update compound inputs</h2><span id='topic+updateCompoundInput2'></span>

<h3>Description</h3>

<p>Update compound inputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateCompoundInput2(
  session,
  inputId,
  value = NULL,
  ncomp = NULL,
  initialization = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateCompoundInput2_+3A_session">session</code></td>
<td>
<p>shiny session or session proxy</p>
</td></tr>
<tr><td><code id="updateCompoundInput2_+3A_inputid">inputId</code></td>
<td>
<p>character see <code>compoundInput2</code></p>
</td></tr>
<tr><td><code id="updateCompoundInput2_+3A_value">value</code></td>
<td>
<p>list of lists, see <code>compoundInput2</code> or examples</p>
</td></tr>
<tr><td><code id="updateCompoundInput2_+3A_ncomp">ncomp</code></td>
<td>
<p>integer, non-negative number of groups to update, <code>NULL</code> to
remain unchanged</p>
</td></tr>
<tr><td><code id="updateCompoundInput2_+3A_initialization">initialization</code>, <code id="updateCompoundInput2_+3A_...">...</code></td>
<td>
<p>named list of other updates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compoundInput2">compoundInput2</a></code> for how to define components.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(shiny); library(dipsaus)

## UI side
compoundInput2(
  'input_id', 'Group',
    div(
    textInput('text', 'Text Label'),
    sliderInput('sli', 'Slider Selector', value = 0, min = 1, max = 1)
  ),
  label_color = 1:10,
  value = list(
    list(text = '1'),  # Set text first group to be "1"
    '',                # no settings for second group
    list(sli = 0.2)    # sli = 0.2 for the third group
  ))

## server side:
updateCompoundInput2(session, 'inputid',
                     # Change the first 3 groups
                     value = lapply(1:3, function(ii){
                       list(sli = runif(1))
                     }),
                     # Change text label for all groups
                     initialization = list(
                       text = list(label = as.character(Sys.time()))
                     ))

## End(Not run)

</code></pre>

<hr>
<h2 id='use_shiny_dipsaus'>Set up shiny plugins</h2><span id='topic+use_shiny_dipsaus'></span>

<h3>Description</h3>

<p>This function must be called from a Shiny app's UI in order for
some widgets to work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use_shiny_dipsaus(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="use_shiny_dipsaus_+3A_x">x</code></td>
<td>
<p>'HTML' tags</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
