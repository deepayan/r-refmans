<!DOCTYPE html><html><head><title>Help for package UpAndDownPlots</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {UpAndDownPlots}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#UpAndDownPlots'>
<p>UpAndDownPlots: display both percentage and absolute changes</p></a></li>
<li><a href='#AutoSalesGermany'>
<p>Sales of cars and vans in Germany in the years 2017 and 2018.</p></a></li>
<li><a href='#AutoSalesXGermany'>
<p>Sales of cars and vans in Germany by manufacturer (edited version of AutoSales).</p></a></li>
<li><a href='#ConsumerPriceIndexUK'>
<p>Consumer Price Index data for the UK for August 2017 and August 2018.</p></a></li>
<li><a href='#dgroup'>
<p>Draws UpAndDown plots for different grouping variables</p></a></li>
<li><a href='#NIpop'>
<p>Northern Ireland population estimates 2011-2017</p></a></li>
<li><a href='#sort5'>
<p>Draws five UpAndDown plots for one grouping variable with the five different sorting methods provided</p></a></li>
<li><a href='#ud_colours'>
<p>Set colours for UpAndDown plots</p></a></li>
<li><a href='#ud_plot'>
<p>Draws an UpAndDown plot to display percentage and absolute changes</p></a></li>
<li><a href='#ud_prep'>
<p>Prepares data for drawing an UpAndDown plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Displays Percentage and Absolute Changes</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Displays percentage changes by height and absolute changes by area for up to three nested or non-nested levels. The plots visualise changes in indices and markets, showing how the changes for sectors or for individual components contribute to the overall change. Data can be classified by up to three levels of grouping variables in a layered, hierarchical plot. Each level can be ordered in several ways including by baseline, by percentage change, and by absolute change. The vignettes give examples.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>tidyverse, ggplot2, dplyr, tidyr, forcats, gridExtra, ggthemes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, colorspace</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-01 12:39:42 UTC; antonyunwin2</td>
</tr>
<tr>
<td>Author:</td>
<td>Antony Unwin [aut, cre, cph],
  Bill Venables [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Antony Unwin &lt;unwin@math.uni-augsburg.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-02 12:42:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='UpAndDownPlots'>
UpAndDownPlots: display both percentage and absolute changes
</h2><span id='topic+UpAndDownPlots-package'></span>

<h3>Description</h3>

<p>UpAndDown plots display percentage changes by height and absolute changes by area for up to three nested or non-nested levels.  They can visualise changes in indices, showing how the changes for sectors or for individual components contribute to the overall change.
</p>


<h3>Details</h3>

<p>An UpAndDown plot shows both percentage and absolute changes for a variable recorded at two separate time points.
</p>


<h3>Author(s)</h3>

<p>Antony Unwin unwin@math.uni-augsburg.de
</p>

<hr>
<h2 id='AutoSalesGermany'>
Sales of cars and vans in Germany in the years 2017 and 2018.
</h2><span id='topic+AutoSales'></span>

<h3>Description</h3>

<p>Sales of cars and vans in Germany for 2017 and 2018.  The market is divided into 14 segments and in the two years 2017 and 2018 there were 50 competing manufacturers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AutoSales)</code></pre>


<h3>Format</h3>

<p>A data frame with 393 observations on the following 7 variables.
</p>

<dl>
<dt><code>Sector</code></dt><dd><p>Car, Van, Other</p>
</dd>
<dt><code>Segment</code></dt><dd><p>The KBA splits the market into 14 segments</p>
</dd>
<dt><code>ModelSeries</code></dt><dd><p>Full vehicle name reported by KBA</p>
</dd>
<dt><code>Manufacturer</code></dt><dd><p>Manufacturer</p>
</dd>
<dt><code>Model</code></dt><dd><p>Model name</p>
</dd>
<dt><code>sales17</code></dt><dd><p>Sales in 2017</p>
</dd>
<dt><code>sales18</code></dt><dd><p>Sales in 2018</p>
</dd>
</dl>



<h3>Details</h3>

<p>The Kraftfahrt-Bundesamt (KBA, National Vehicle Authority in Germany) publishes spreadsheets of sales every month including year-to-date figures.  The full vehicle name has been split into manufacturer and model names.  NAs have been transformed to 0's.  The variable names and market segments have been anglicised.<br />
</p>
<p>A 'cleaned' and reduced version of the dataset is available as AutoSalesX in this package.
</p>


<h3>Source</h3>

<p>Kraftfahrt-Bundesamt <br />
<a href="https://www.kba.de/DE/Statistik/Fahrzeuge/Neuzulassungen/MonatlicheNeuzulassungen/monatl_neuzulassungen_node.html">https://www.kba.de/DE/Statistik/Fahrzeuge/Neuzulassungen/MonatlicheNeuzulassungen/monatl_neuzulassungen_node.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yy &lt;- ud_prep(AutoSales, v1="sales17", v2="sales18", levs=c("Segment"), sortLev=c("perc"))
y1 &lt;- ud_plot(yy, labelvar="Segment")
y1$uadl
</code></pre>

<hr>
<h2 id='AutoSalesXGermany'>
Sales of cars and vans in Germany by manufacturer (edited version of AutoSales).
</h2><span id='topic+AutoSalesX'></span>

<h3>Description</h3>

<p>Sales of cars and vans in Germany for 2017 and 2018.  The market is divided into 14 segments and in the two years 2017 and 2018 there were 50 competing manufacturers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AutoSalesX)</code></pre>


<h3>Format</h3>

<p>A data frame with 173 observations on the following 5 variables.
</p>

<dl>
<dt><code>Sector</code></dt><dd><p>Car, Van, Other</p>
</dd>
<dt><code>Segment</code></dt><dd><p>Market segment</p>
</dd>
<dt><code>Manufacturer</code></dt><dd><p>Manufacturer</p>
</dd>
<dt><code>sales17</code></dt><dd><p>Sales in 2017</p>
</dd>
<dt><code>sales18</code></dt><dd><p>Sales in 2018</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a 'cleaned' and reduced version of the dataset AutoSales from this package.<br />
</p>
<p>Vehicles selling less than 1000 in both years have been reclassified as 'Other'.  The data have been aggregated by manufacturer within segments.
</p>


<h3>Source</h3>

<p>Kraftfahrt-Bundesamt <br />
<a href="https://www.kba.de/DE/Statistik/Fahrzeuge/Neuzulassungen/MonatlicheNeuzulassungen/monatl_neuzulassungen_node.html">https://www.kba.de/DE/Statistik/Fahrzeuge/Neuzulassungen/MonatlicheNeuzulassungen/monatl_neuzulassungen_node.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
yx &lt;- ud_prep(AutoSalesX %&gt;% filter(Segment=="Compact"), v1="sales17",
      v2="sales18", levs=c("Manufacturer"), sortLev=c("base"))
y5 &lt;- ud_plot(yx, labelvar="Manufacturer")
y5$uadl
</code></pre>

<hr>
<h2 id='ConsumerPriceIndexUK'>
Consumer Price Index data for the UK for August 2017 and August 2018.
</h2><span id='topic+CPIuk'></span>

<h3>Description</h3>

<p>The UK Office for National Statistics publishes updated Consumer Price Index data every month.  There are 12 sectors with from 1 to 7 subsectors and the subsectors comprise up to 9 items.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CPIuk)</code></pre>


<h3>Format</h3>

<p>A data frame with 85 observations on the following 10 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>ID number made up of Sector, Subsector, Item numbers</p>
</dd>
<dt><code>SectorID</code></dt><dd><p>Sector number</p>
</dd>
<dt><code>SubsectorID</code></dt><dd><p>Subsector number within sector</p>
</dd>
<dt><code>Item</code></dt><dd><p>Item number within Sector</p>
</dd>
<dt><code>Sector</code></dt><dd><p>Sector label</p>
</dd>
<dt><code>Subsector</code></dt><dd><p>Subsector label</p>
</dd>
<dt><code>Component</code></dt><dd><p>Item label</p>
</dd>
<dt><code>Weight</code></dt><dd><p>Item weight in 2017</p>
</dd>
<dt><code>Aug2017</code></dt><dd><p>Item index value in August 2017</p>
</dd>
<dt><code>Aug2018</code></dt><dd><p>Item index value in August 2018</p>
</dd>
</dl>



<h3>Source</h3>

<p>Office for National Statistics (ONS) UK <br />
<a href="https://www.ons.gov.uk/economy/inflationandpriceindices/datasets/consumerpriceinflation/">https://www.ons.gov.uk/economy/inflationandpriceindices/datasets/consumerpriceinflation/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yw &lt;- ud_prep(CPIuk, weight="Weight", v1="Aug2017", v2="Aug2018",
              levs=c("Sector"), sortLev=c("perc"))
y2 &lt;- ud_plot(yw, labelvar="Sector")
y2$uadl
</code></pre>

<hr>
<h2 id='dgroup'>
Draws UpAndDown plots for different grouping variables
</h2><span id='topic+dgroup'></span>

<h3>Description</h3>

<p>This function draws plots to compare the effects of different grouping variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgroup(data, byvars, weight=1, v1, v2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgroup_+3A_data">data</code></td>
<td>

<p>the dataset to be analysed
</p>
</td></tr>
<tr><td><code id="dgroup_+3A_byvars">byvars</code></td>
<td>

<p>the grouping variables to be used
</p>
</td></tr>
<tr><td><code id="dgroup_+3A_weight">weight</code></td>
<td>

<p>a variable for weighting the individual items, the default is for every item to be weighted equally
</p>
</td></tr>
<tr><td><code id="dgroup_+3A_v1">v1</code></td>
<td>

<p>the variable specifying the start value in the comparison
</p>
</td></tr>
<tr><td><code id="dgroup_+3A_v2">v2</code></td>
<td>

<p>the variable specifying the end value in the comparison
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares UpAndDown plots showing percentage and absolute changes for different grouping variables.
All unlabelled plots have the same vertical scale to ease comparisons.  Scales of labelled plots are affected by label lengths.
</p>
<p>To draw an unlabelled or labelled set of plots, apply grid.arrange to the appropriate output of dgroup.
</p>


<h3>Value</h3>

<table>
<tr><td><code>uad</code></td>
<td>

<p>unlabelled horizontal UpAndDown plots
</p>
</td></tr>
<tr><td><code>uadl</code></td>
<td>

<p>vertical UpAndDown plots with labelling
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antony Unwin unwin@math.uni-augsburg.de
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gridExtra)
zs &lt;- dgroup(NIpop, byvars=c("age", "gender", "LGD2014_name", "area_name"), v1="y2011", v2="y2017")
grid.arrange(zs$uadg)
grid.arrange(zs$uadgl)
</code></pre>

<hr>
<h2 id='NIpop'>
Northern Ireland population estimates 2011-2017
</h2><span id='topic+NIpop'></span>

<h3>Description</h3>

<p>The Northern Ireland Statistics &amp; Research Agency (NISRA) publishes population estimates on their webpage for 80 District Electoral Areas (DEA).  Each of these DEAs is in one of the 11 Local Government Districts (LGD).  The data are further broken down by gender and age groups.  This dataset includes estimates for the years 2011 to 2017.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(NIpop)</code></pre>


<h3>Format</h3>

<p>A data frame with 640 observations on the following 11 variables.
</p>

<dl>
<dt><code>area_name</code></dt><dd><p>District Electoral Area</p>
</dd>
<dt><code>LGD2014_name</code></dt><dd><p>Local Government District</p>
</dd>
<dt><code>gender</code></dt><dd><p>Males or Females</p>
</dd>
<dt><code>age</code></dt><dd><p>four age groups: 00-15, 16-39, 40-64, 65+</p>
</dd>
<dt><code>y2011</code></dt><dd><p>population estimates for the year 2011</p>
</dd>
<dt><code>y2012</code></dt><dd><p>population estimates for the year 2012</p>
</dd>
<dt><code>y2013</code></dt><dd><p>population estimates for the year 2013</p>
</dd>
<dt><code>y2014</code></dt><dd><p>population estimates for the year 2014</p>
</dd>
<dt><code>y2015</code></dt><dd><p>population estimates for the year 2015</p>
</dd>
<dt><code>y2016</code></dt><dd><p>population estimates for the year 2016</p>
</dd>
<dt><code>y2017</code></dt><dd><p>population estimates for the year 2017</p>
</dd>
</dl>



<h3>Source</h3>

<p>Northern Ireland Statistics &amp; Research Agency <br />
<a href="https://www.nisra.gov.uk/sites/nisra.gov.uk/files/publications/MYE17_DEA_1117.xlsx">https://www.nisra.gov.uk/sites/nisra.gov.uk/files/publications/MYE17_DEA_1117.xlsx</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>km &lt;- ud_prep(NIpop, v1="y2011", v2="y2017", levs=c("age", "gender"), sortLev=c("orig", "perc"))
k2 &lt;- ud_plot(km, labelvar="age")
k2$uadl
</code></pre>

<hr>
<h2 id='sort5'>
Draws five UpAndDown plots for one grouping variable with the five different sorting methods provided
</h2><span id='topic+sort5'></span>

<h3>Description</h3>

<p>This function draws plots to compare the results of different sorting methods for a single grouping variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sort5(data, gvar, weight=1, v1, v2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sort5_+3A_data">data</code></td>
<td>

<p>the dataset to be analysed
</p>
</td></tr>
<tr><td><code id="sort5_+3A_gvar">gvar</code></td>
<td>

<p>the grouping variable to be used in all five plots
</p>
</td></tr>
<tr><td><code id="sort5_+3A_weight">weight</code></td>
<td>

<p>a variable for weighting the individual items, the default is for every item to be weighted equally
</p>
</td></tr>
<tr><td><code id="sort5_+3A_v1">v1</code></td>
<td>

<p>the variable specifying the start value in the comparison
</p>
</td></tr>
<tr><td><code id="sort5_+3A_v2">v2</code></td>
<td>

<p>the variable specifying the end value in the comparison
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares UpAndDown plots showing percentage and absolute changes for one grouping variable with five different sortings.
</p>
<p>To draw an unlabelled or labelled set of plots, apply grid.arrange to the appropriate output of sort5.
</p>


<h3>Value</h3>

<table>
<tr><td><code>uad</code></td>
<td>

<p>five unlabelled horizontal UpAndDown plots
</p>
</td></tr>
<tr><td><code>uadl</code></td>
<td>

<p>five vertical UpAndDown plots with labelling of groups
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antony Unwin unwin@math.uni-augsburg.de
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gridExtra)
xs &lt;- sort5(NIpop, gvar="LGD2014_name", v1="y2011", v2="y2017")
grid.arrange(xs$uad)
grid.arrange(xs$uadl)
</code></pre>

<hr>
<h2 id='ud_colours'>
Set colours for UpAndDown plots
</h2><span id='topic+ud_colours'></span>

<h3>Description</h3>

<p>Provides a colour scheme for UpAndDown plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ud_colours(colours = c("grey75", "grey65", "red", "blue", "brown"), colors,
           gcpal=colorblind_pal()(8))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ud_colours_+3A_colours">colours</code></td>
<td>

<p>A set of colours for UpAndDown plots.
</p>
<p>The first one is used for filling bars and the second for the borders of bars;
the third one is for colouring the dashed line for the overall percentage change;
the fourth one is for colouring the borders of rectangles representing the highest grouping level;
the last one is for colouring the borders of a second grouping level (if there is one).
</p>
</td></tr>
<tr><td><code id="ud_colours_+3A_colors">colors</code></td>
<td>

<p>To allow users to write 'colors' instead of 'colours'.
</p>
</td></tr>
<tr><td><code id="ud_colours_+3A_gcpal">gcpal</code></td>
<td>

<p>A colour palette to use if bars are to be coloured by a grouping variable (the parameter barColour in ud_plot).
The default is the colorblind palette from ggthemes, which has 8 colours.  If more are needed, a palette is generated from the randomcoloR package, always using the same seed for replication purposes.
The same procedure applies for a user-defined palette&mdash;if there are not enough colours, a randomcoloR palette is used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ud_colours is provided for assigning colours for UpAndDown plots.</p>


<h3>Value</h3>

<p>A named list of colours.
</p>


<h3>Author(s)</h3>

<p>Antony Unwin unwin@math.uni-augsburg.de
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ud_plot">ud_plot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Using default colours
yw &lt;- ud_prep(CPIuk, weight="Weight", v1="Aug2017", v2="Aug2018",
              levs=c("Sector"), sortLev=c("perc"))
y2 &lt;- ud_plot(yw, labelvar="Sector")
y2$uadl

# Using individually chosen colours
library(ggthemes)
y2a &lt;- ud_plot(yw, ud_control=ud_colours(colours = c("lightblue1", "grey50",
               "red4", "blue", "brown")))
y2a$uad

# Using barColour and the default palette
# A random palette from colorspace is used as there are more than 8 sectors.
y2b &lt;- ud_plot(yw, barColour="Sector")
y2b$uad

# Using barColour and a specified palette
y2c &lt;- ud_plot(yw, levelColour="Sector", ud_control=ud_colours(
       gcpal=sample(colorspace::qualitative_hcl(n = 20, l = 80))))
y2c$uad
</code></pre>

<hr>
<h2 id='ud_plot'>
Draws an UpAndDown plot to display percentage and absolute changes
</h2><span id='topic+ud_plot'></span>

<h3>Description</h3>

<p>Function for drawing UpAndDown plots for up to 3 levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ud_plot(outPrep, b=0, totperc="yes", vscale=NULL, labelvar=NULL, drawFrom="BigToSmall",
        levelColour="none", barColour=levelColour, ud_control=ud_colours())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ud_plot_+3A_outprep">outPrep</code></td>
<td>

<p>a list of the grouping variables chosen, the sorting methods for them, nesting information, the numbers of categories in them, and the sorted dataset to be plotted
</p>
</td></tr>
<tr><td><code id="ud_plot_+3A_b">b</code></td>
<td>

<p>the baseline value from which the bars are drawn.  The default is 0.  It can be informative to set it to the overall rate or to some threshold value.
</p>
</td></tr>
<tr><td><code id="ud_plot_+3A_totperc">totperc</code></td>
<td>

<p>whether the dashed line for overall percentage change is to be drawn.  The default is &quot;yes&quot;.  It is useful to set it to &quot;no&quot; if you draw an UpAndDown plot for a subset and do not want to draw the rate for the subset in this way.
</p>
</td></tr>
<tr><td><code id="ud_plot_+3A_vscale">vscale</code></td>
<td>

<p>sets the limits for the vertical axis scale.  Default limits are calculated from the data.
</p>
</td></tr>
<tr><td><code id="ud_plot_+3A_labelvar">labelvar</code></td>
<td>

<p>the name of the variable to be used for labelling.  If specified, it has to be one of the first two grouping variables.  Labelling is only used for vertical UpAndDown plots.
</p>
</td></tr>
<tr><td><code id="ud_plot_+3A_drawfrom">drawFrom</code></td>
<td>

<p>specifies the order in which the levels are drawn, either &quot;BigToSmall&quot; (top level first) or &quot;SmallToBig&quot; (lowest level first).
</p>
</td></tr>
<tr><td><code id="ud_plot_+3A_levelcolour">levelColour</code></td>
<td>

<p>specifies by variable name which level will be coloured (even if there is only one level).  The default is not to colour them, other than grey for the top level bars.
</p>
</td></tr>
<tr><td><code id="ud_plot_+3A_barcolour">barColour</code></td>
<td>

<p>specifies a character or factor variable to colour (fill) the bars.  The default is to use the levelColour variable itself. 
</p>
</td></tr>
<tr><td><code id="ud_plot_+3A_ud_control">ud_control</code></td>
<td>

<p>a list of colours for UpAndDown plots. If omitted, <code><a href="#topic+ud_colours">ud_colours</a></code> gives the defaults.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes the output from <code><a href="#topic+ud_prep">ud_prep</a></code> and draws an UpAndDown plot showing percentage and absolute changes for up to three levels.  The levels may be nested or not.  There are a number of options for sorting, labelling, and colouring the displays.
The plots produced are ggplot2 objects, so you can amend them&mdash;to some extent&mdash;yourself.
Choosing a barColour variable with many different colours is generally not a good idea and takes a while to draw because of the lengthy legend.  See <code><a href="#topic+ud_colours">ud_colours</a></code> for choosing palettes.
</p>


<h3>Value</h3>

<table>
<tr><td><code>uad</code></td>
<td>

<p>an unlabelled horizontal UpAndDown plot
</p>
</td></tr>
<tr><td><code>uadl</code></td>
<td>

<p>a vertical UpAndDown plot with labelling of groups or items (NULL if no labelvar is set)
</p>
</td></tr>
<tr><td><code>TotPerc</code></td>
<td>

<p>the percentage change for all the data used in the plot (the value displayed by the red dashed line)
</p>
</td></tr>
<tr><td><code>level1</code></td>
<td>

<p>the category names and percentage changes plotted for the first level specified in the input levs
</p>
</td></tr>
<tr><td><code>level2</code></td>
<td>

<p>the category names and percentage changes plotted for the second level specified in the input levs (NULL if there is only one level).
These are, of course, conditional on the categories of the first level.
</p>
</td></tr>
<tr><td><code>level3</code></td>
<td>

<p>the category names and percentage changes plotted for the third level specified in the input levs (NULL if there are not three levels).
These are, of course, conditional on the categories of the first two levels.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antony Unwin unwin@math.uni-augsburg.de
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ud_colours">ud_colours</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>yy &lt;- ud_prep(CPIuk, weight="Weight", v1="Aug2017", v2="Aug2018",
levs=c("Sector", "Subsector", "Component"), sortLev=c("perc", "perc", "perc"))
y1 &lt;- ud_plot(yy, b=0, vscale=NULL, labelvar="Sector")
y1$uad
y1$uadl
</code></pre>

<hr>
<h2 id='ud_prep'>
Prepares data for drawing an UpAndDown plot
</h2><span id='topic+ud_prep'></span>

<h3>Description</h3>

<p>Checks input parameters and sorts the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ud_prep(data, weight=1, v1, v2, levs, sortLev, reverse=c(FALSE, FALSE, FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ud_prep_+3A_data">data</code></td>
<td>

<p>the dataset to be analysed
</p>
</td></tr>
<tr><td><code id="ud_prep_+3A_weight">weight</code></td>
<td>

<p>a variable for weighting the individual items, the default is for every item to be weighted equally
</p>
</td></tr>
<tr><td><code id="ud_prep_+3A_v1">v1</code></td>
<td>

<p>the variable specifying the start value in the comparison
</p>
</td></tr>
<tr><td><code id="ud_prep_+3A_v2">v2</code></td>
<td>

<p>the variable specifying the end value in the comparison
</p>
</td></tr>
<tr><td><code id="ud_prep_+3A_levs">levs</code></td>
<td>

<p>up to three grouping variables to define the plot levels in order from highest to lowest
</p>
</td></tr>
<tr><td><code id="ud_prep_+3A_sortlev">sortLev</code></td>
<td>

<p>how the grouping variables named in levs are to be sorted.  Each entry must be one of &quot;orig&quot;, &quot;base&quot;, &quot;final&quot;, &quot;perc&quot;, &quot;abs&quot; (i.e., no sorting, sorting by initial value, sorting by final value, sorting by percentage change, sorting by absolute change).
</p>
</td></tr>
<tr><td><code id="ud_prep_+3A_reverse">reverse</code></td>
<td>

<p>whether a sorting is to be reversed or not.  Each entry must be TRUE or FALSE (the default) and is set separately for each level.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares the data for <code><a href="#topic+ud_plot">ud_plot</a></code> to draw UpAndDown plots.  As well as carrying out some basic checks, any NA values in the variables v1 and v2 are converted to 0.  There are a number of options for sorting the data.  If a level is nested, then it is sorted within the next highest level.  If a level is not nested, then it is sorted as if it were the top level.
</p>


<h3>Value</h3>

<table>
<tr><td><code>levs</code></td>
<td>

<p>the variables specifying the grouping levels for the plot
</p>
</td></tr>
<tr><td><code>sortLev</code></td>
<td>

<p>the sorting method used for each plot level
</p>
</td></tr>
<tr><td><code>reverse</code></td>
<td>

<p>whether individual sortings should be reversed or not
</p>
</td></tr>
<tr><td><code>hx</code></td>
<td>

<p>a summary of the nesting of the grouping variables
</p>
</td></tr>
<tr><td><code>lgv</code></td>
<td>

<p>the numbers of categories in the grouping variables
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>

<p>an extended version of the dataset comprising the original variables and the derived absolute and percentage changes for the different levels specified in levs.  The levels are sorted according to the sortLev settings chosen and the corresponding percentages.
The dataset is primarily for providing the necessary input for the Ud_plot function.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antony Unwin unwin@math.uni-augsburg.de
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yy &lt;- ud_prep(CPIuk, weight="Weight", v1="Aug2017", v2="Aug2018",
levs=c("Sector", "Subsector", "Component"), sortLev=c("perc", "perc", "perc"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
