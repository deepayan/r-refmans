<!DOCTYPE html><html lang="en"><head><title>Help for package cpmr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cpmr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cpmr-package'><p>cpmr: Connectome Predictive Modelling in R</p></a></li>
<li><a href='#cpm'><p>Perform Connectome-based Predictive Modeling (CPM)</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#summary.cpm'><p>Summary of a cpm object.</p></a></li>
<li><a href='#tidy.cpm'><p>Tidy a <code>cpm</code> object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Connectome Predictive Modelling in R</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Connectome Predictive Modelling (CPM) (Shen et al. (2017)
    &lt;<a href="https://doi.org/10.1038%2Fnprot.2016.178">doi:10.1038/nprot.2016.178</a>&gt;) is a method to predict individual
    differences in behaviour from brain functional connectivity. 'cpmr'
    provides a simple yet efficient implementation of this method.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/psychelzh/cpmr">https://github.com/psychelzh/cpmr</a>,
<a href="https://psychelzh.github.io/cpmr/">https://psychelzh.github.io/cpmr/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/psychelzh/cpmr/issues">https://github.com/psychelzh/cpmr/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>generics, Rfast, stats, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), withr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-06 07:13:55 UTC; lenovo</td>
</tr>
<tr>
<td>Author:</td>
<td>Liang Zhang <a href="https://orcid.org/0000-0001-9041-1150"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Liang Zhang &lt;psychelzh@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-06 07:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cpmr-package'>cpmr: Connectome Predictive Modelling in R</h2><span id='topic+cpmr'></span><span id='topic+cpmr-package'></span>

<h3>Description</h3>

<p>Connectome Predictive Modelling (CPM) (Shen et al. (2017) <a href="https://doi.org/10.1038/nprot.2016.178">doi:10.1038/nprot.2016.178</a>) is a method to predict individual differences in behaviour from brain functional connectivity. 'cpmr' provides a simple yet efficient implementation of this method.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Liang Zhang <a href="mailto:psychelzh@outlook.com">psychelzh@outlook.com</a> (<a href="https://orcid.org/0000-0001-9041-1150">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/psychelzh/cpmr">https://github.com/psychelzh/cpmr</a>
</p>
</li>
<li> <p><a href="https://psychelzh.github.io/cpmr/">https://psychelzh.github.io/cpmr/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/psychelzh/cpmr/issues">https://github.com/psychelzh/cpmr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='cpm'>Perform Connectome-based Predictive Modeling (CPM)</h2><span id='topic+cpm'></span>

<h3>Description</h3>

<p>The connectome-based predictive modeling (CPM) is a data-driven approach to
predict individual behavior from brain connectivity data. Originally proposed
by Shen et al. (2017), the CPM has been widely used in various studies. This
function implements the CPM algorithm and provides a convenient interface to
use it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpm(
  conmat,
  behav,
  ...,
  confounds = NULL,
  thresh_method = c("alpha", "sparsity"),
  thresh_level = 0.01,
  kfolds = NULL,
  bias_correct = TRUE,
  return_edges = c("sum", "none", "all"),
  na_action = c("fail", "exclude")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpm_+3A_conmat">conmat</code></td>
<td>
<p>A matrix of connectome data. Observations in row, edges in
column (assumed that duplicated edges are removed).</p>
</td></tr>
<tr><td><code id="cpm_+3A_behav">behav</code></td>
<td>
<p>A numeric vector contains behavior data. Length must equal to
number of observations in <code>conmat</code>. Note <code>behav</code> could also be a row/column
matrix, which will be converted to a vector using <code><a href="base.html#topic+drop">drop()</a></code>.</p>
</td></tr>
<tr><td><code id="cpm_+3A_...">...</code></td>
<td>
<p>For future extension. Currently ignored.</p>
</td></tr>
<tr><td><code id="cpm_+3A_confounds">confounds</code></td>
<td>
<p>A matrix of confounding variables. Observations in row,
variables in column. If <code>NULL</code>, no confounding variables are used. Note if
a vector is provided, it will be converted to a column matrix.</p>
</td></tr>
<tr><td><code id="cpm_+3A_thresh_method">thresh_method</code>, <code id="cpm_+3A_thresh_level">thresh_level</code></td>
<td>
<p>The threshold method and level used in edge
selection. If method is set to be <code>"alpha"</code>, the edge selection is based on
the critical value of correlation coefficient. If method is set to be
<code>"sparsity"</code>, the edge selection is based on the quantile of correlation
coefficient, thus network sparsity is controlled.</p>
</td></tr>
<tr><td><code id="cpm_+3A_kfolds">kfolds</code></td>
<td>
<p>Folds number of cross-validation. If <code>NULL</code>, it will be set to
be equal to the number of observations, i.e., leave-one-subject-out.</p>
</td></tr>
<tr><td><code id="cpm_+3A_bias_correct">bias_correct</code></td>
<td>
<p>Logical value indicating if the connectome data should be
bias-corrected. If <code>TRUE</code>, the connectome data will be centered and scaled
to have unit variance based on the training data before model fitting and
prediction. See Rapuano et al. (2020) for more details.</p>
</td></tr>
<tr><td><code id="cpm_+3A_return_edges">return_edges</code></td>
<td>
<p>A character string indicating the return value of the
selected edges. If <code>"none"</code>, no edges are returned. If <code>"sum"</code>, the sum of
selected edges across folds is returned. If <code>"all"</code>, the selected edges for
each fold is returned, which is a 3D array and memory-consuming.</p>
</td></tr>
<tr><td><code id="cpm_+3A_na_action">na_action</code></td>
<td>
<p>A character string indicating the action when missing values
are found in <code>behav</code>. If <code>"fail"</code>, an error will be thrown. If <code>"exclude"</code>,
missing values will be excluded from the analysis but kept in the output.
Note complete cases are intersection of <code>conmat</code>, <code>behav</code> and <code>confounds</code>
if provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>folds</code></td>
<td>
<p>The corresponding fold for each observation when used as test
group in cross-validation.</p>
</td></tr>
<tr><td><code>real</code></td>
<td>
<p>The real behavior data. This is the same as the input <code>behav</code>
if <code>confounds</code> is <code>NULL</code>, otherwise it is the residual of <code>behav</code> after
regressing out <code>confounds</code>.</p>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>The predicted behavior data, with each column corresponding to
a model, i.e., both edges, positive edges, negative edges, and the row
names corresponding to the observation names (the same as those of
<code>behav</code>).</p>
</td></tr>
<tr><td><code>edges</code></td>
<td>
<p>The selected edges, if <code>return_edges</code> is not <code>"none"</code>. If
<code>return_edges</code> is <code>"sum"</code>, it is a matrix with rows corresponding to
edges and columns corresponding to networks. If <code>return_edges</code> is
<code>"all"</code>, it is a 3D array with dimensions corresponding to edges,
networks and folds.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>A list of parameters used in the function, including:
</p>

<ul>
<li> <p><code>confounds</code> indicating if confounds are used
</p>
</li>
<li> <p><code>thresh_method</code> indicating the threshold method
</p>
</li>
<li> <p><code>thresh_level</code> indicating the threshold level
</p>
</li>
<li> <p><code>kfolds</code> indicating the number of folds in cross-validation
</p>
</li>
<li> <p><code>bias_correct</code> indicating if bias correction is used</p>
</li></ul>

</td></tr>
</table>


<h3>References</h3>

<p>Shen, X., Finn, E. S., Scheinost, D., Rosenberg, M. D., Chun, M. M.,
Papademetris, X., &amp; Constable, R. T. (2017). Using connectome-based
predictive modeling to predict individual behavior from brain connectivity.
Nature Protocols, 12(3), 506–518. https://doi.org/10.1038/nprot.2016.178
</p>
<p>Rapuano, K. M., Rosenberg, M. D., Maza, M. T., Dennis, N. J., Dorji, M.,
Greene, A. S., Horien, C., Scheinost, D., Todd Constable, R., &amp; Casey, B. J.
(2020). Behavioral and brain signatures of substance use vulnerability in
childhood. Developmental Cognitive Neuroscience, 46, 100878.
https://doi.org/10.1016/j.dcn.2020.100878
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conmat &lt;- matrix(rnorm(100 * 100), nrow = 100)
behav &lt;- rnorm(100)
cpm(conmat, behav)
# use different threshold method and level
cpm(conmat, behav, thresh_method = "sparsity", thresh_level = 0.05)
# use a 10-fold cross-validation
cpm(conmat, behav, kfolds = 10)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+tidy'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>generics</dt><dd><p><code><a href="generics.html#topic+tidy">tidy</a></code></p>
</dd>
</dl>

<hr>
<h2 id='summary.cpm'>Summary of a cpm object.</h2><span id='topic+summary.cpm'></span><span id='topic+print.cpm_summary'></span>

<h3>Description</h3>

<p>This function provides a summary of a <code>cpm</code> object, including the
prediction performance and the selected edges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cpm'
summary(object, ..., method = c("pearson", "spearman"), edge_level = 0.5)

## S3 method for class 'cpm_summary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.cpm_+3A_object">object</code></td>
<td>
<p>An object of class <code>cpm</code>.</p>
</td></tr>
<tr><td><code id="summary.cpm_+3A_...">...</code></td>
<td>
<p>Other parameters passed to the function.</p>
</td></tr>
<tr><td><code id="summary.cpm_+3A_method">method</code></td>
<td>
<p>A character vector indicating the method used to calculate the
correlation between the real and predicted values.</p>
</td></tr>
<tr><td><code id="summary.cpm_+3A_edge_level">edge_level</code></td>
<td>
<p>A numeric value between 0 and 1 indicating the proportional
threshold for edge selection.</p>
</td></tr>
<tr><td><code id="summary.cpm_+3A_x">x</code></td>
<td>
<p>An object of class <code>cpm_summary</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>cpm_summary</code> containing two elements:
</p>
<table role = "presentation">
<tr><td><code>performance</code></td>
<td>
<p>A matrix of prediction performance, including the
correlation between the real and predicted values for both edges,
positive edges only, and negative edges only.</p>
</td></tr>
<tr><td><code>edges</code></td>
<td>
<p>A logical vector indicating whether each edge is selected
based on the edge_level.</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>A list of parameters used in the summary.</p>
</td></tr>
</table>

<hr>
<h2 id='tidy.cpm'>Tidy a <code>cpm</code> object</h2><span id='topic+tidy.cpm'></span>

<h3>Description</h3>

<p>Tidy a <code>cpm</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cpm'
tidy(x, ..., component = c("performance", "edges"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy.cpm_+3A_x">x</code></td>
<td>
<p>A <code>cpm</code> object.</p>
</td></tr>
<tr><td><code id="tidy.cpm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary()</code>.</p>
</td></tr>
<tr><td><code id="tidy.cpm_+3A_component">component</code></td>
<td>
<p>A character vector indicating the component to tidy.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="tibble.html#topic+tibble-package">tibble</a> with columns storing parameters of the
<code><a href="#topic+cpm">cpm()</a></code> object and further columns depending on the <code>component</code> argument:
</p>
<p>For <code>component = "performance"</code>:
</p>
<table role = "presentation">
<tr><td><code>method</code></td>
<td>
<p>The method used to calculate the correlation between the real
and predicted values.</p>
</td></tr>
<tr><td><code>pos</code></td>
<td>
<p>The correlation between the real and predicted values for
positive edges.</p>
</td></tr>
<tr><td><code>neg</code></td>
<td>
<p>The correlation between the real and predicted values for
negative edges.</p>
</td></tr>
</table>
<p>For <code>component = "edges"</code>:
</p>
<table role = "presentation">
<tr><td><code>level</code></td>
<td>
<p>The proportional threshold for edge selection.</p>
</td></tr>
<tr><td><code>pos</code></td>
<td>
<p>A logical vector indicating whether each edge is selected based
on the edge_level (positive).</p>
</td></tr>
<tr><td><code>neg</code></td>
<td>
<p>A logical vector indicating whether each edge is selected based
on the edge_level (negative).</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
