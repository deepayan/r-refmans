<!DOCTYPE html><html><head><title>Help for package gcKrig</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gcKrig}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AtlanticFish'>
<p>Dataset of Mid-Atlantic Highlands Fish</p></a></li>
<li><a href='#beta.gc'><p>The Beta Marginal of Class <code>marginal.gc</code></p></a></li>
<li><a href='#binomial.gc'><p>The Binomial Marginal of Class <code>marginal.gc</code></p></a></li>
<li><a href='#corr.gc'>
<p>Spatial Correlation Functions for Simulation, Likelihood Inference and Spatial Prediction in Gaussian Copula Models with</p>
Geostatistical Count Data</a></li>
<li><a href='#corrTG'><p>Compute the Correlation in  Transformed Gaussian Random Fields</p></a></li>
<li><a href='#FHUBdiscrete'><p>Compute the Frechet Hoeffding Upper Bound for Given Discrete Marginal Distributions</p></a></li>
<li><a href='#gaussian.gc'><p>The Gaussian Marginal of Class <code>marginal.gc</code></p></a></li>
<li><a href='#gm.gc'><p>The Gamma Marginal of Class <code>marginal.gc</code></p></a></li>
<li><a href='#LansingTrees'>
<p>Locations and Botanical Classification of Trees in Lansing Woods</p></a></li>
<li><a href='#marginal.gc'>
<p>Marginals for Data Simulation,</p>
Correlation Assessment,
Likelihood Inference and Spatial Prediction in Gaussian Copula Models
for Geostatistical Data</a></li>
<li><a href='#matern.gc'><p>The Matern Correlation Function of Class <code>corr.gc</code></p></a></li>
<li><a href='#mlegc'><p>Maximum Likelihood Estimation in Gaussian Copula Models for Geostatistical Count Data</p></a></li>
<li><a href='#mvnintGHK'><p>Computing Multivariate Normal Rectangle Probability</p></a></li>
<li><a href='#negbin.gc'><p>The Negative Binomial Marginal of Class <code>marginal.gc</code></p></a></li>
<li><a href='#OilWell'>
<p>Location of Successful and Dry Wells</p></a></li>
<li><a href='#plot.mlegc'>
<p>Plot Geostatistical Data and Fitted Mean</p></a></li>
<li><a href='#plot.predgc'>
<p>Plot Geostatistical Data at Sampling and Prediction Locations</p></a></li>
<li><a href='#plot.simgc'>
<p>Plot Geostatistical Data Simulated From Gaussian Copula</p></a></li>
<li><a href='#plotgc'>
<p>Plot Geostatistical Count Data</p></a></li>
<li><a href='#poisson.gc'><p>The Poisson Marginal of Class <code>marginal.gc</code></p></a></li>
<li><a href='#powerexp.gc'><p>The Powered Exponential Correlation Function of Class <code>corr.gc</code></p></a></li>
<li><a href='#predgc'><p>Prediction at Unobserved Locations in Gaussian Copula Models for Geostatistical Count Data</p></a></li>
<li><a href='#profile.mlegc'>
<p>Profile Likelihood Based Confidence Interval of Parameters</p>
for Gaussian Copula Models in Geostatistical Count Data</a></li>
<li><a href='#simgc'><p>Simulate Geostatistical Data from Gaussian Copula Model at Given Locations</p></a></li>
<li><a href='#spherical.gc'><p>The Spherical Correlation Function of Class <code>corr.gc</code></p></a></li>
<li><a href='#summary.mlegc'>
<p>Methods for Extracting Information from Fitted Object of Class <code>mlegc</code></p></a></li>
<li><a href='#summary.predgc'>
<p>Methods for Extracting Information from Fitted Object of Class <code>predgc</code></p></a></li>
<li><a href='#vcov.mlegc'>
<p>Covariance Matrix of the Maximum Likelihood Estimates</p></a></li>
<li><a href='#Weed95'>
<p>Counts of Weed Plants on a Field</p></a></li>
<li><a href='#weibull.gc'><p>The Weibull Marginal of Class <code>marginal.gc</code></p></a></li>
<li><a href='#zip.gc'><p>The Zero-inflated Poisson Marginal of Class <code>marginal.gc</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Geostatistical Count Data using Gaussian Copulas</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.8</td>
</tr>
<tr>
<td>Author:</td>
<td>Zifei Han</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zifei Han &lt;hanzifei1@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a variety of functions to analyze and model
    geostatistical count data with Gaussian copulas, including
 1) data simulation and visualization; 
 2) correlation structure assessment (here also known as the Normal To Anything); 
 3) calculate multivariate normal rectangle probabilities; 
 4) likelihood inference and parallel prediction at predictive locations.
 Description of the method is available from: Han and DeOliveira (2018) &lt;<a href="https://doi.org/10.18637%2Fjss.v087.i13">doi:10.18637/jss.v087.i13</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>EQL, FNN, lattice, latticeExtra, mvtnorm, Matrix, MASS,
numDeriv, scatterplot3d, snowfall, sp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-02 08:53:23 UTC; zifeihan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-02 22:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AtlanticFish'>
Dataset of Mid-Atlantic Highlands Fish</h2><span id='topic+AtlanticFish'></span>

<h3>Description</h3>

<p>This dataset was studied by Johnson and Hoeting (2011) for analyzing pollution tolerance
in Mid-Atlantic Highlands Fish.
Pollution intolerant fish were sampled, and several stream characteristics
were measured to assess water quality at 119 sites in the Mid-Atlantic region of the United States.
All covariates of the data had been standardized to have mean 0 and variance 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AtlanticFish)</code></pre>


<h3>Format</h3>

<p>A data frame with 119 observations and 12 variables.
</p>

<dl>
<dt><code>LON</code></dt><dd><p>Longitude of the location.</p>
</dd>
<dt><code>LAT</code></dt><dd><p>Latitude of the location.</p>
</dd>
<dt><code>ABUND</code></dt><dd><p>Fish abundance at given locations, the discrete response.</p>
</dd>
<dt><code>ORDER</code></dt><dd><p>Strahler stream order, a natural covariate measuring stream size.</p>
</dd>
<dt><code>DISTOT</code></dt><dd><p>Watershed classified as disturbed by human activity,
a variable reflecting stream quality.</p>
</dd>
<dt><code>HAB</code></dt><dd><p>An index of fish habitat quality at the stream site, a variable reflecting stream quality.</p>
</dd>
<dt><code>WSA</code></dt><dd><p>Watershed area, a natural covariate.</p>
</dd>
<dt><code>ELEV</code></dt><dd><p>Elevation.</p>
</dd>
<dt><code>RD</code></dt><dd><p>Road density in the watershed, a variable reflecting stream quality.</p>
</dd>
<dt><code>DO</code></dt><dd><p>Concentration of dissolved oxygen in the stream at the sampling site,
a stream quality variable.</p>
</dd>
<dt><code>XFC</code></dt><dd><p>Percent of areal fish cover at the sampling site, a stream quality variable.</p>
</dd>
<dt><code>PCT</code></dt><dd><p>Percent of sand in streambed substrate, a stream quality variable.</p>
</dd>
</dl>



<h3>References</h3>

<p>Johnson, D. and Hoeting, J. (2011) Bayesian Multimodel Inference for Geostatistical Regression Models,
<em>PLOS ONE, 6:e25677</em>.
<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0025677">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0025677</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AtlanticFish)
str(AtlanticFish)
</code></pre>

<hr>
<h2 id='beta.gc'>The Beta Marginal of Class <code><a href="#topic+marginal.gc">marginal.gc</a></code></h2><span id='topic+beta.gc'></span>

<h3>Description</h3>

<p>The Beta marginal used for simulation and computing correlation in the
trans-Gaussian random field in function <code>simgc</code> and <code>corrTG</code> of the package <code>gcKrig</code>.
It cannot be used in function <code>mlegc</code> nor <code>predgc</code> to make model inferences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta.gc(shape1 = 1, shape2 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta.gc_+3A_shape1">shape1</code></td>
<td>
<p>non-negative scalar, the shape parameter of the Beta distribution.</p>
</td></tr>
<tr><td><code id="beta.gc_+3A_shape2">shape2</code></td>
<td>
<p>non-negative scalar, another shape parameter of the Beta distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Beta distribution with parameters <code>shape1 = a</code> and <code>shape2 = b</code> has density
</p>
<p style="text-align: center;"><code class="reqn">\frac{\Gamma(a+b)}{\Gamma(a) \Gamma(b)} x^{a-1} (1-x)^{b-1}</code>
</p>

<p>for <code class="reqn">a &gt; 0, b &gt; 0</code> and <code class="reqn">0 \le x \le 1</code> where the boundary values at
<code>x = 0</code> or <code>x = 1</code> are defined as by continuity (as limits).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> representing the marginal component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal.gc">marginal.gc</a></code>, <code><a href="#topic+binomial.gc">binomial.gc</a></code>, <code><a href="#topic+gm.gc">gm.gc</a></code>,
<code><a href="#topic+gaussian.gc">gaussian.gc</a></code>, <code><a href="#topic+negbin.gc">negbin.gc</a></code>,
<code><a href="#topic+poisson.gc">poisson.gc</a></code>, <code><a href="#topic+weibull.gc">weibull.gc</a></code>, <code><a href="#topic+zip.gc">zip.gc</a></code>
</p>

<hr>
<h2 id='binomial.gc'>The Binomial Marginal of Class <code><a href="#topic+marginal.gc">marginal.gc</a></code></h2><span id='topic+binomial.gc'></span>

<h3>Description</h3>

<p>The binomial marginal parameterized in terms of its size and probability.
</p>
<p>By default, this function is used for likelihood inference and spatial prediction in function
<code>mlegc</code> and <code>predgc</code> of the package <code>gcKrig</code>.
When all marginal parameters are given, the function is used for simulation and computing correlation in a
trans-Gaussian random field in function <code>simgc</code> and <code>corrTG</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomial.gc(link = "logit", size = NULL, prob = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomial.gc_+3A_link">link</code></td>
<td>
<p>the model link function.</p>
</td></tr>
<tr><td><code id="binomial.gc_+3A_size">size</code></td>
<td>
<p>number of trials (zero or more).</p>
</td></tr>
<tr><td><code id="binomial.gc_+3A_prob">prob</code></td>
<td>
<p>probability of success on each trial.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> representing the marginal component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal.gc">marginal.gc</a></code>,  <code><a href="#topic+beta.gc">beta.gc</a></code>,
<code><a href="#topic+gm.gc">gm.gc</a></code>, <code><a href="#topic+gaussian.gc">gaussian.gc</a></code>,
<code><a href="#topic+negbin.gc">negbin.gc</a></code>, <code><a href="#topic+poisson.gc">poisson.gc</a></code>,
<code><a href="#topic+weibull.gc">weibull.gc</a></code>, <code><a href="#topic+zip.gc">zip.gc</a></code>
</p>

<hr>
<h2 id='corr.gc'>
Spatial Correlation Functions for Simulation, Likelihood Inference and Spatial Prediction in Gaussian Copula Models with
Geostatistical Count Data
</h2><span id='topic+corr.gc'></span>

<h3>Description</h3>

<p>Class of isotropic correlation functions available in the <code>gcKrig</code> library.
</p>


<h3>Details</h3>

<p>By default, range parameter is not provided, so
this function is used for likelihood inference and spatial prediction with function <code>mlegc</code>
and <code>predgc</code>.
Users need to specify if the correlation model includes a nugget effect
<code>nugget = TRUE</code> or not <code>nugget = FALSE</code>. For Matern and powered exponential correlation functions, the
shape parameter <code>kappa</code> is also required from users.
</p>
<p>When both range and nugget parameters are given,
the function is used to specify the correlation structure in simulation
with function <code>simgc</code> in package <code>gcKrig</code>.
</p>


<h3>Value</h3>

<p>At the moment, the following three correlation functins are implemented:
</p>

<table>
<tr>
 <td style="text-align: left;">

<code><a href="#topic+matern.gc">matern.gc</a></code> </td><td style="text-align: left;"> the Matern correlation function. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+powerexp.gc">powerexp.gc</a></code> </td><td style="text-align: left;"> the powered exponential correlation function. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+spherical.gc">spherical.gc</a></code> </td><td style="text-align: left;"> the spherical correlation function. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>De Oliveira, V. (2013) Hierarchical Poisson models for spatial count data.
<em>Journal of Multivariate Analysis,122:393-408</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2018) gcKrig: An R Package for the Analysis of Geostatistical Count Data Using Gaussian Copulas.
<em>Journal of Statistical Software</em>, <b>87</b>(13), 1&ndash;32. doi: <a href="https://doi.org/10.18637/jss.v087.i13">10.18637/jss.v087.i13</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matern.gc">matern.gc</a></code>,
<code><a href="#topic+powerexp.gc">powerexp.gc</a></code>,
<code><a href="#topic+spherical.gc">spherical.gc</a></code>
</p>

<hr>
<h2 id='corrTG'>Compute the Correlation in  Transformed Gaussian Random Fields</h2><span id='topic+corrTG'></span>

<h3>Description</h3>

<p>This function implements two general methods for computing the correlation function in
a transformed Gaussian random field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrTG(marg1, marg2, corrGauss = 0.5, method = "integral", nrep = 1000,
       kmax = 10, earlystop = FALSE, epscut = 1e-3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrTG_+3A_marg1">marg1</code></td>
<td>
<p>an object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> specifying the first marginal distribution.</p>
</td></tr>
<tr><td><code id="corrTG_+3A_marg2">marg2</code></td>
<td>
<p>an object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> specifying the second marginal distribution.</p>
</td></tr>
<tr><td><code id="corrTG_+3A_corrgauss">corrGauss</code></td>
<td>
<p>the correlation in the Gaussian random field. Should be a scalar between 0 and 1.</p>
</td></tr>
<tr><td><code id="corrTG_+3A_method">method</code></td>
<td>
<p>the computation method of calculating correlation in the transformed Gaussian random field.
Can be either &quot;integral&quot; or &quot;mc&quot;.
If use &quot;integral&quot; then a series expansion based on the Hermite Polynomials will be used to approximate the
correlation, see De Oliveira (2013) or Han and De Oliveira (2016).
If use &quot;mc&quot; then the Monte Carlo method will be used.</p>
</td></tr>
<tr><td><code id="corrTG_+3A_nrep">nrep</code></td>
<td>
<p>the Monte Carlo size in computing the correlation. Only need to be specified if <code>method = "mc"</code>.</p>
</td></tr>
<tr><td><code id="corrTG_+3A_kmax">kmax</code></td>
<td>
<p>the maximum number of terms used in the series summation (with Hermite polynomial expansion).
Only need to be specified if <code>method = "integral"</code>.</p>
</td></tr>
<tr><td><code id="corrTG_+3A_earlystop">earlystop</code></td>
<td>
<p>whether or not to allow the series summation to stop early.
If <code>earlystop = FALSE</code> then a total number of kmax terms will be kept.
If <code>earlystop = TRUE</code> then the series will be automatically truncated if the absolute values
of the three consecutive terms are smaller than <code>epscut</code>.
</p>
</td></tr>
<tr><td><code id="corrTG_+3A_epscut">epscut</code></td>
<td>
<p>a small positive value used to truncate the series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>method = "mc"</code> the output is a scalar between 0 and 1, denoting the correlation of the transformed Gaussian random field. If <code>method = "integral"</code> the output is a scalar of the correlation in the transformed Gaussian random field, and a list of the values in the series expansion based on the integral with Hermite polynomials.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>De Oliveira, V. (2013) Hierarchical Poisson models for spatial count data.
<em>Journal of Multivariate Analysis,122:393-408</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2016) On the correlation structure of Gaussian
copula models for geostatistical count data.
<em>Australian and New Zealand Journal of Statistics, 58:47-69</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2018) gcKrig: An R Package for the Analysis of Geostatistical Count Data Using Gaussian Copulas.
<em>Journal of Statistical Software</em>, <b>87</b>(13), 1&ndash;32. doi: <a href="https://doi.org/10.18637/jss.v087.i13">10.18637/jss.v087.i13</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
corrTG(marg1 = poisson.gc(lambda = 10), marg2 = binomial.gc(size = 1, prob = 0.1),
       corrGauss = 0.5, method = "integral", kmax = 10, earlystop = TRUE, epscut = 1e-5)
set.seed(12345)
corrTG(marg1 = poisson.gc(lambda = 10), marg2 = binomial.gc(size = 1, prob = 0.1),
       corrGauss = 0.5, nrep = 100000, method = "mc")

## End(Not run)
</code></pre>

<hr>
<h2 id='FHUBdiscrete'>Compute the Frechet Hoeffding Upper Bound for Given Discrete Marginal Distributions</h2><span id='topic+FHUBdiscrete'></span>

<h3>Description</h3>

<p>This function implemented the method of computing the Frechet Hoeffding upper bound for discrete marginals
described in Nelsen (1987), which can only be applied to discrete marginals. Four commonly used
marginal distributions were implemented. The distribution &quot;nb&quot; (negative binomial) and &quot;zip&quot;
(zero-inflated Poisson) are parameterized in terms of the mean and overdispersion,
see Han and De Oliveira (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FHUBdiscrete(marg1, marg2, mu1, mu2, od1 = 0, od2 = 0, binomial.size1 = 1,
  binomial.size2 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FHUBdiscrete_+3A_marg1">marg1</code></td>
<td>
<p> name of the first discrete marginal distribution. Should be one of the
&quot;poisson&quot;, &quot;zip&quot;, &quot;nb&quot; or &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="FHUBdiscrete_+3A_marg2">marg2</code></td>
<td>
<p> name of the second discrete marginal distribution. Should be one of the
&quot;poisson&quot;, &quot;zip&quot;, &quot;nb&quot; or &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="FHUBdiscrete_+3A_mu1">mu1</code></td>
<td>
<p>mean of the first marginal distribution. If binomial then it is <code class="reqn">n_1 p_1</code>.</p>
</td></tr>
<tr><td><code id="FHUBdiscrete_+3A_mu2">mu2</code></td>
<td>
<p>mean of the second marginal distribution. If binomial then it is <code class="reqn">n_2 p_2</code>.</p>
</td></tr>
<tr><td><code id="FHUBdiscrete_+3A_od1">od1</code></td>
<td>
<p>the overdispersion parameter of the first marginal. Only used when marginal distribution is either
&quot;zip&quot; or &quot;nb&quot;.</p>
</td></tr>
<tr><td><code id="FHUBdiscrete_+3A_od2">od2</code></td>
<td>
<p>the overdispersion parameter of the second marginal. Only used when marginal distribution is either
&quot;zip&quot; or &quot;nb&quot;.</p>
</td></tr>
<tr><td><code id="FHUBdiscrete_+3A_binomial.size1">binomial.size1</code></td>
<td>
<p>the size parameter (number of trials) when <code>marg1 = "binomial"</code>.</p>
</td></tr>
<tr><td><code id="FHUBdiscrete_+3A_binomial.size2">binomial.size2</code></td>
<td>
<p>the size parameter (number of trials) when <code>marg2 = "binomial"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar denoting the Frechet Hoeffding upper bound of the two
specified marginal.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Nelsen, R. (1987) Discrete bivariate distributions with given marginals and correlation.
<em>Communications in Statistics Simulation and Computation, 16:199-208</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2016) On the correlation structure of Gaussian
copula models for geostatistical count data.
<em>Australian and New Zealand Journal of Statistics, 58:47-69</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2018) gcKrig: An R Package for the Analysis of Geostatistical Count Data Using Gaussian Copulas.
<em>Journal of Statistical Software</em>, <b>87</b>(13), 1&ndash;32. doi: <a href="https://doi.org/10.18637/jss.v087.i13">10.18637/jss.v087.i13</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

FHUBdiscrete(marg1 = 'nb', marg2 = 'zip',mu1 = 10, mu2 = 2, od1 = 2, od2 = 0.2)
FHUBdiscrete(marg1 = 'binomial', marg2 = 'zip', mu1 = 10, mu2 = 4, binomial.size1 = 25, od2 = 2)
FHUBdiscrete(marg1 = 'binomial', marg2 = 'poisson', mu1 = 0.3, mu2 = 20, binomial.size1 = 1)

NBmu = seq(0.01, 30, by = 0.02)
 fhub &lt;- c()
 for(i in 1:length(NBmu)){
  fhub[i] = FHUBdiscrete(marg1 = 'nb', marg2 = 'nb',mu1 = 10, mu2 = NBmu[i], od1 = 0.2, od2 = 0.2)
}
plot(NBmu, fhub, type='l')

## End(Not run)
</code></pre>

<hr>
<h2 id='gaussian.gc'>The Gaussian Marginal of Class <code><a href="#topic+marginal.gc">marginal.gc</a></code></h2><span id='topic+gaussian.gc'></span>

<h3>Description</h3>

<p>The Gaussian marginal used for simulation and computing correlation in the
trans-Gaussian random field in function <code>simgc</code> and <code>corrTG</code> of the package <code>gcKrig</code>.
It cannot be used in function <code>mlegc</code> nor <code>predgc</code> to make model inferences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gaussian.gc(mean = 0, sd = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gaussian.gc_+3A_mean">mean</code></td>
<td>
<p>the mean of the Gaussian distribution, a scalar.</p>
</td></tr>
<tr><td><code id="gaussian.gc_+3A_sd">sd</code></td>
<td>
<p>a positive scalar, the standard deviation of the Gaussian distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> representing the marginal component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal.gc">marginal.gc</a></code>, <code><a href="#topic+beta.gc">beta.gc</a></code>, <code><a href="#topic+binomial.gc">binomial.gc</a></code>,
<code><a href="#topic+gm.gc">gm.gc</a></code>, <code><a href="#topic+negbin.gc">negbin.gc</a></code>,
<code><a href="#topic+poisson.gc">poisson.gc</a></code>, <code><a href="#topic+weibull.gc">weibull.gc</a></code>, <code><a href="#topic+zip.gc">zip.gc</a></code>
</p>

<hr>
<h2 id='gm.gc'>The Gamma Marginal of Class <code><a href="#topic+marginal.gc">marginal.gc</a></code></h2><span id='topic+gm.gc'></span>

<h3>Description</h3>

<p>The Gamma marginal used for simulation and computing correlation in the
trans-Gaussian random field in functions <code>simgc</code> and <code>corrTG</code> of the package <code>gcKrig</code>.
It cannot be used in functions <code>mlegc</code> nor <code>predgc</code> to make model inferences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gm.gc(shape = 1, rate = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gm.gc_+3A_shape">shape</code></td>
<td>
<p>a non-negative scalar, shape parameter of the Gamma distribution.</p>
</td></tr>
<tr><td><code id="gm.gc_+3A_rate">rate</code></td>
<td>
<p>a non-negative scalar, rate parameter of the Gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Gamma distribution with parameters <code>shape = a</code> and <code>rate = r</code> has density
</p>
<p style="text-align: center;"><code class="reqn">\frac{r^{a}}{\Gamma(a)} x^{a-1} exp(-rx)</code>
</p>

<p>for <code class="reqn">x \ge 0</code>, <code class="reqn">a &gt; 0</code> and <code class="reqn">s &gt; 0</code>.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> representing the marginal component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal.gc">marginal.gc</a></code>, <code><a href="#topic+beta.gc">beta.gc</a></code>, <code><a href="#topic+binomial.gc">binomial.gc</a></code>,
<code><a href="#topic+gaussian.gc">gaussian.gc</a></code>, <code><a href="#topic+negbin.gc">negbin.gc</a></code>,
<code><a href="#topic+poisson.gc">poisson.gc</a></code>, <code><a href="#topic+weibull.gc">weibull.gc</a></code>, <code><a href="#topic+zip.gc">zip.gc</a></code>
</p>

<hr>
<h2 id='LansingTrees'>
Locations and Botanical Classification of Trees in Lansing Woods
</h2><span id='topic+LansingTrees'></span>

<h3>Description</h3>

<p>The data is aggregated from the dataset <code>lansing</code> in library <code>spatstat</code>, which
came from an investigation of a 924 ft x 924 ft (19.6 acres) plot in Lansing Woods, Clinton
County, Michigan USA by D.J. Gerrard.
The original point process data described the locations of 2,251 trees and their
botanical classification (into maples, hickories, black oaks, red oaks, white oaks and miscellaneous trees). The original plot size has been rescaled to the unit square and the number of different types of trees
has been counted within squares of length 1/16.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LansingTrees)</code></pre>


<h3>Format</h3>

<p>A data frame with 256 observations and 8 variables.
</p>

<dl>
<dt><code>Easting</code></dt><dd><p>Cartesian x-coordinate of the locations.</p>
</dd>
<dt><code>Northing</code></dt><dd><p>Cartesian y-coordinate of the locations.</p>
</dd>
<dt><code>maple</code></dt><dd><p>Number of maples in the area.</p>
</dd>
<dt><code>hickory</code></dt><dd><p>Number of hickories in the area.</p>
</dd>
<dt><code>blackoak</code></dt><dd><p>Number of black oaks in the area.</p>
</dd>
<dt><code>redoak</code></dt><dd><p>Number of red oaks in the area.</p>
</dd>
<dt><code>whiteoak</code></dt><dd><p>Number of white oaks in the area.</p>
</dd>
<dt><code>misc</code></dt><dd><p>Number of miscellaneous trees in the area.</p>
</dd>
</dl>



<h3>References</h3>

<p>Kazianka, H. (2013) Approximate copula-based estimation and prediction of discrete spatial data.
<em>Stoch Environ Res Risk Assess, 27:2015-2026</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LansingTrees)
str(LansingTrees)
</code></pre>

<hr>
<h2 id='marginal.gc'>
Marginals for Data Simulation,
Correlation Assessment,
Likelihood Inference and Spatial Prediction in Gaussian Copula Models
for Geostatistical Data
</h2><span id='topic+marginal.gc'></span>

<h3>Description</h3>

<p>Class of marginals available in <code>gcKrig</code> library for geostatistical data simulation,
correlation structure assessment (both continuous and discrete marginals)
and model inferences (discrete marginals only).
In former cases parameters of
the marginals are given by users, otherwise
parameters are estimated from the data (except when doing prediction
with function <code>predgc</code>,
users can choose to either input known estimates or
estimate the parameters with input data).
</p>


<h3>Details</h3>

<p>The package <code>gcKrig</code> does not include inference and prediction functionalities
for continuous marginals. For inference with continuous marginals, see Masarotto and Varin (2012).
</p>
<p>By default, when the marginals are discrete, they are used for
estimation with function <code>mlegc</code> and prediction with
function <code>predgc</code>.
They can be used in function <code>simgc</code> and <code>corrTG</code> as well for
the purpose of data simulation and correlation computation in a transformed
Gaussian random field (Han and De Oliveira, 2016), if parameter values are specified.
</p>
<p>For continuous marginals, they are used for simulation with function
<code>simgc</code> and correlation computation with <code>corrTG</code> only, so
parameters should always be specified.
</p>


<h3>Value</h3>

<p>At the moment, the following marginals are implemented:
</p>

<table>
<tr>
 <td style="text-align: left;">

<code><a href="#topic+beta.gc">beta.gc</a></code> </td><td style="text-align: left;"> beta marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+binomial.gc">binomial.gc</a></code> </td><td style="text-align: left;"> binomial marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+gm.gc">gm.gc</a></code> </td><td style="text-align: left;"> gamma marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+gaussian.gc">gaussian.gc</a></code> </td><td style="text-align: left;"> Gaussian marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+negbin.gc">negbin.gc</a></code> </td><td style="text-align: left;"> negative binomial marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+poisson.gc">poisson.gc</a></code> </td><td style="text-align: left;"> Poisson marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+weibull.gc">weibull.gc</a></code> </td><td style="text-align: left;"> Weibull marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+zip.gc">zip.gc</a></code> </td><td style="text-align: left;"> zero-inflated Poisson marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Cribari-Neto, F. and Zeileis, A. (2010) Beta regression in R.
<em>Journal of Statistical Software</em>, <b>34</b>(2), 1&ndash;24. doi: <a href="https://doi.org/10.18637/jss.v034.i02">10.18637/jss.v034.i02</a>.
</p>
<p>Ferrari, S.L.P. and Cribari-Neto, F. (2004) Beta regression for modeling rates and proportions. <em>Journal of Applied Statistics, 31:799-815</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2016) On the correlation structure of Gaussian
copula models for geostatistical count data.
<em>Australian and New Zealand Journal of Statistics, 58:47-69</em>.
</p>
<p>Masarotto, G. and Varin, C. (2012) Gaussian copula marginal regression.
<em>Electronic Journal of Statistics, 6:1517-1549</em>.
</p>
<p>Masarotto, G. and Varin C. (2017) Gaussian Copula Regression in R.
<em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. doi: <a href="https://doi.org/10.18637/jss.v077.i08">10.18637/jss.v077.i08</a>.
</p>
<p>Han, Z. and De Oliveira, V. (2018) gcKrig: An R Package for the Analysis of Geostatistical Count Data Using Gaussian Copulas.
<em>Journal of Statistical Software</em>, <b>87</b>(13), 1&ndash;32. doi: <a href="https://doi.org/10.18637/jss.v087.i13">10.18637/jss.v087.i13</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+beta.gc">beta.gc</a></code>,
<code><a href="#topic+binomial.gc">binomial.gc</a></code>,
<code><a href="#topic+gm.gc">gm.gc</a></code>,
<code><a href="#topic+gaussian.gc">gaussian.gc</a></code>,
<code><a href="#topic+negbin.gc">negbin.gc</a></code>,
<code><a href="#topic+poisson.gc">poisson.gc</a></code>,
<code><a href="#topic+weibull.gc">weibull.gc</a></code>,
<code><a href="#topic+zip.gc">zip.gc</a></code>
</p>

<hr>
<h2 id='matern.gc'>The Matern Correlation Function of Class <code><a href="#topic+corr.gc">corr.gc</a></code></h2><span id='topic+matern.gc'></span>

<h3>Description</h3>

<p>The Matern correlation function in spatial statistics.
</p>
<p>By default, range parameter is not available, so
this function is used for likelihood inference and spatial prediction in function <code>mlegc</code>
and <code>predgc</code>.
Users need to specify the shape parameter <code>kappa</code> and if the correlation model includes a nugget effect
<code>nugget = TRUE</code> or not <code>nugget = FALSE</code>.
</p>
<p>When both range and nugget parameters are given,
the function is used for simulation with function <code>simgc</code> in package <code>gcKrig</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matern.gc(range = NULL, kappa = 0.5, nugget = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matern.gc_+3A_range">range</code></td>
<td>
<p>a non-negative scalar of the range parameter in Matern correlation function.</p>
</td></tr>
<tr><td><code id="matern.gc_+3A_kappa">kappa</code></td>
<td>
<p>a non-negative scalar of the shape parameter in the Matern correlation function.
The default kappa = 0.5 corresponds to an exponential correlation model.</p>
</td></tr>
<tr><td><code id="matern.gc_+3A_nugget">nugget</code></td>
<td>
<p>the nugget effect of the correlation function. If specified, it must be a scalar between 0 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Matern correlation function with a nugget <code class="reqn">\tau^2</code> is of the form:
</p>
<p style="text-align: center;"><code class="reqn">\rho(h) =
    \frac{1-\tau^2}{2^{\kappa-1}\Gamma(\kappa)}\Big(\frac{h}{\phi}\Big)^\kappa
    K_{\kappa}\Big(\frac{h}{\phi}\Big)</code>
</p>

<p>when <code class="reqn">h &gt; 0</code> and <code class="reqn">\rho(h) = 1</code> when <code class="reqn">h = 0</code>. Here
<code class="reqn">\phi</code> is range parameter, <code class="reqn">\kappa</code> is the shape parameter and
<code class="reqn">\tau^2</code> is the nugget parameter.
<code class="reqn">K_\kappa(\cdot)</code> denotes the modified Bessel function of the third
kind of order <code class="reqn">\kappa</code>.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+corr.gc">corr.gc</a></code> representing the correlation component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Diggle, P. and Ribeiro, P.J. (2007) Model-based Geostatistics. <em>Springer</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerexp.gc">powerexp.gc</a></code>,  <code><a href="#topic+spherical.gc">spherical.gc</a></code>
</p>

<hr>
<h2 id='mlegc'>Maximum Likelihood Estimation in Gaussian Copula Models for Geostatistical Count Data</h2><span id='topic+mlegc'></span>

<h3>Description</h3>

<p>Computes the  maximum likelihood estimates. Two methods are implemented. If
<code>method = 'GHK'</code> then the maximum simulated likelihood estimates are computed, if
<code>method = 'GQT'</code> then the maximum surrogate likelihood estimates are computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlegc(y, x = NULL, locs, marginal, corr, effort = 1, longlat = FALSE,
  distscale = 1, method = "GHK", corrpar0 = NULL, ghkoptions = list(nrep
  = c(100, 1000), reorder = FALSE, seed = 12345))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlegc_+3A_y">y</code></td>
<td>
<p>a non-negative integer vector of response with its length equals to the number of sampling locations.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_x">x</code></td>
<td>
<p>a numeric matrix or data frame of covariates,
with its number of rows equals to the number of sampling locations.
If no covariates then <code>x = NULL</code>.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_locs">locs</code></td>
<td>
<p>a numeric matrix or data frame of <em>n-D</em> points with row denoting points.
The first column is <em>x</em> or longitude, the second column is <em>y</em> or latitude.
The number of locations is equal to the number of rows.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_marginal">marginal</code></td>
<td>
<p>an object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> specifying the marginal distribution.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_corr">corr</code></td>
<td>
<p>an object of class <code><a href="#topic+corr.gc">corr.gc</a></code> specifying the correlation function.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_effort">effort</code></td>
<td>
<p>the sampling effort. For binomial marginal it is the size parameter (number of trials).
See details.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_longlat">longlat</code></td>
<td>
<p>if FALSE, use Euclidean distance, if TRUE use great circle distance. The default is FALSE.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_distscale">distscale</code></td>
<td>
<p>a numeric scaling factor for computing distance. If original distance is in kilometers, then
<code>distscale = 1000</code> will convert it to meters.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_method">method</code></td>
<td>
<p>two methods are implemented. If
<code>method = 'GHK'</code> then the maximum simulated likelihood estimates are computed, if
<code>method = 'GQT'</code> then the maximum surrogate likelihood estimates are computed.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_corrpar0">corrpar0</code></td>
<td>
<p>the starting value of correlation parameter in the optimization procedure.
If <code>corrpar0 = NULL</code> then
initial range is set to be half of the median distance in distance matrix and initial nugget
(if <code>nugget = TRUE</code>) is 0.2.</p>
</td></tr>
<tr><td><code id="mlegc_+3A_ghkoptions">ghkoptions</code></td>
<td>
<p>a list of three elements that only need to be specified if <code>method = 'GHK'</code>.
</p>
<p><code>nrep</code> is the Monte Carlo size of the importance sampling algorithm for likelihood approximation.
It can be a vector with increasing positive integers so that the model is
fitted with a sequence of different Monte Carlo sizes, and the starting
values for optimization are taken from the previous fitting.
The default value is 100 for the first optimization and 1000 for the second and definitive optimization.
</p>
<p><code>reorder</code> indicates whether the integral will be reordered every iteration in computation
according to the algorithm in Gibson, etal (1994), default is FALSE.
</p>
<p><code>seed</code>  is the seed of the pseudorandom generator used in Monte Carlo simulation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This program implemented one simulated likelihood method via sequential importance
sampling (see Masarotto and Varin 2012), which is same as the method implemented in package
<code>gcmr</code> (Masarotto and Varin 2016) except an antithetic variable is used. It also implemented
one surrogate likelihood method via distributional transform (see Kazianka and Pilz 2010), which is
generally faster.
</p>
<p>The argument <code>effort</code> is the sampling effort (known). It can be used to consider the heterogeneity
of the measurement time or area at different locations.
The default is 1 for all locations. See Han and De Oliveira (2016) for more details.
</p>


<h3>Value</h3>

<p>A list of class &quot;mlegc&quot; with the following elements:
</p>
<table>
<tr><td><code>MLE</code></td>
<td>
<p>the maximum likelihood estimate.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the design matrix.</p>
</td></tr>
<tr><td><code>nug</code></td>
<td>
<p>1 if <code>nugget = TRUE</code>, 0 if <code>nugget = FALSE</code>.</p>
</td></tr>
<tr><td><code>nreg</code></td>
<td>
<p>number of regression parameters.</p>
</td></tr>
<tr><td><code>log.lik</code></td>
<td>
<p>the value of the maximum log-likelihood.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>the Akaike information criterion.</p>
</td></tr>
<tr><td><code>AICc</code></td>
<td>
<p>the AICc information criterion; essentially AIC with a greater penalty for extra parameters.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p> the Bayesian information criterion.</p>
</td></tr>
<tr><td><code>kmarg</code></td>
<td>
<p>number of marginal parameters.</p>
</td></tr>
<tr><td><code>par.df</code></td>
<td>
<p>number of parameters.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>the distance matrix.</p>
</td></tr>
<tr><td><code>optlb</code></td>
<td>
<p>lower bound in optimization.</p>
</td></tr>
<tr><td><code>optub</code></td>
<td>
<p>upper bound in optimization.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the hessian matrix evaluated at the final estimates.</p>
</td></tr>
<tr><td><code>args</code></td>
<td>
<p>arguments passed in function evaluation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Han, Z. and De Oliveira, V. (2016) On the correlation structure of Gaussian
copula models for geostatistical count data.
<em>Australian and New Zealand Journal of Statistics, 58:47-69</em>.
</p>
<p>Kazianka, H. and Pilz, J. (2010)
Copula-based geostatistical modeling of continuous and discrete data including covariates.
<em>Stoch Environ Res Risk Assess 24:661-673</em>.
</p>
<p>Masarotto, G. and Varin, C. (2012)
Gaussian copula marginal regression.
<em>Electronic Journal of Statistics 6:1517-1549</em>.
<a href="https://projecteuclid.org/euclid.ejs/1346421603">https://projecteuclid.org/euclid.ejs/1346421603</a>.
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. doi: <a href="https://doi.org/10.18637/jss.v077.i08">10.18637/jss.v077.i08</a>.
</p>
<p>Han, Z. and De Oliveira, V. (2018) gcKrig: An R Package for the Analysis of Geostatistical Count Data Using Gaussian Copulas.
<em>Journal of Statistical Software</em>, <b>87</b>(13), 1&ndash;32. doi: <a href="https://doi.org/10.18637/jss.v087.i13">10.18637/jss.v087.i13</a>.
</p>


<h3>See Also</h3>

<p><code><a href="gcmr.html#topic+gcmr">gcmr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Fit a Simulated Dataset with 100 locations
grid &lt;- seq(0.05, 0.95, by = 0.1)
xloc &lt;- expand.grid(x = grid, y = grid)[,1]
yloc &lt;- expand.grid(x = grid, y = grid)[,2]

set.seed(123)
simData1 &lt;- simgc(locs = cbind(xloc,yloc), sim.n = 1,
                    marginal = negbin.gc(mu = exp(1+xloc), od = 1),
                    corr = matern.gc(range = 0.4, kappa = 0.5, nugget = 0))

simFit1 &lt;- mlegc(y = simData1$data, x = xloc, locs = cbind(xloc,yloc),
                 marginal = negbin.gc(link = 'log'),
                 corr = matern.gc(kappa = 0.5, nugget = FALSE), method = 'GHK')

simFit2 &lt;- mlegc(y = simData1$data, x = xloc, locs = cbind(xloc,yloc),
                 marginal = negbin.gc(link = 'log'),
                 corr = matern.gc(kappa = 0.5, nugget = FALSE), method = 'GQT')
#summary(simFit1);summary(simFit2)
#plot(simFit1);plot(simFit2)



## Time consuming examples
## Fit a real dataset with 70 sampling locations.
data(Weed95)
weedobs &lt;- Weed95[Weed95$dummy==1, ]
weedpred &lt;- Weed95[Weed95$dummy==0, ]
Weedfit1 &lt;- mlegc(y = weedobs$weedcount, x = weedobs[,4:5], locs = weedobs[,1:2],
                     marginal = poisson.gc(link='log'),
                     corr = matern.gc(kappa = 0.5, nugget = TRUE),
                     method = 'GHK')
summary(Weedfit1)
plot(Weedfit1)


## Fit a real dataset with 256 locations
data(LansingTrees)
Treefit1 &lt;- mlegc(y = LansingTrees[,3], x = LansingTrees[,4], locs = LansingTrees[,1:2],
                  marginal = negbin.gc(link = 'log'),
                  corr = matern.gc(kappa = 0.5, nugget = FALSE), method = 'GHK')
summary(Treefit1)
plot(Treefit1)

# Try to use GQT method
Treefit2&lt;- mlegc(y = LansingTrees[,3], x = LansingTrees[,4],
                locs = LansingTrees[,1:2], marginal = poisson.gc(link='log'),
                corr = matern.gc(kappa = 0.5, nugget = TRUE), method = 'GQT')
summary(Treefit2)
plot(Treefit2)

## Fit a real dataset with randomized locations
data(AtlanticFish)
Fitfish &lt;- mlegc(y = AtlanticFish[,3], x = AtlanticFish[,4:6], locs = AtlanticFish[,1:2],
                   longlat = TRUE, marginal = negbin.gc(link='log'),
                   corr = matern.gc(kappa = 0.5, nugget = TRUE), method = 'GHK')
summary(Fitfish)

## Fit a real dataset with binomial counts; see Masarotto and Varin (2016).
library(gcmr)
data(malaria)
malariax &lt;- data.frame(netuse = malaria$netuse,
                       green = malaria$green/100,
                       phc = malaria$phc)
Fitmalaria &lt;- mlegc(y = malaria$cases, x = malariax, locs = malaria[,1:2],
                    marginal = binomial.gc(link='logit'), corrpar0 = 1.5,
                    corr = matern.gc(kappa = 0.5, nugget = FALSE),
                    distscale = 0.001, effort = malaria$size, method = 'GHK')
summary(Fitmalaria)


## Fit a real spatial binary dataset with 333 locations using probit link
data(OilWell)
Oilest1 &lt;- mlegc(y = OilWell[,3], x = NULL, locs = OilWell[,1:2],
                 marginal = binomial.gc(link = 'probit'),
                 corr = matern.gc(nugget = TRUE), method = 'GHK')
summary(Oilest1)
plot(Oilest1, col = 2)

## End(Not run)




</code></pre>

<hr>
<h2 id='mvnintGHK'>Computing Multivariate Normal Rectangle Probability</h2><span id='topic+mvnintGHK'></span>

<h3>Description</h3>

<p>Computes the multivariate normal rectangle probability for arbitrary
limits and covariance matrices using (reordered) sequential importance sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvnintGHK(mean, sigma, lower, upper, nrep = 5000, log = TRUE,
  reorder = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvnintGHK_+3A_mean">mean</code></td>
<td>
<p>the numeric vector of mean of length <code>n</code>.</p>
</td></tr>
<tr><td><code id="mvnintGHK_+3A_sigma">sigma</code></td>
<td>
<p>the covariance matrix of dimension <code>n</code>.</p>
</td></tr>
<tr><td><code id="mvnintGHK_+3A_lower">lower</code></td>
<td>
<p>the numeric vector of lower limits of length <code>n</code>.</p>
</td></tr>
<tr><td><code id="mvnintGHK_+3A_upper">upper</code></td>
<td>
<p>the numeric vector of upper limits of length <code>n</code>.</p>
</td></tr>
<tr><td><code id="mvnintGHK_+3A_nrep">nrep</code></td>
<td>
<p>a positive integer of Monte Carlo size.</p>
</td></tr>
<tr><td><code id="mvnintGHK_+3A_log">log</code></td>
<td>
<p>if TRUE then return the log of the probability. If FALSE return the probability.</p>
</td></tr>
<tr><td><code id="mvnintGHK_+3A_reorder">reorder</code></td>
<td>
<p>if TRUE then variable reordering algorithm is applied. If FALSE then original ordering is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This program implemented the Geweke-Hajivassiliou-Keane simulator of computing the
multivariate normal rectangle probability. For more details see Keane (1994).
Also a variable reordering algorithm in Gibson, etal (1994) was implemented.
</p>
<p>Note that both <code>-Inf</code> and <code>Inf</code> may be specified in <code>lower</code> and <code>upper</code>.
</p>


<h3>Value</h3>

<p>A list of the following two components:
</p>
<table>
<tr><td><code>value</code></td>
<td>
<p>the value of the integral. If <code>log = TRUE</code> then output the log of the integral. </p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p> the Monte Carlo standard deviation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Gibson GJ., Glasbey CA. and Elston DA. (1994) Monte Carlo evaluation of multivariate normal integrals and
sensitivity to variate ordering. <em>Advances in Numerical Methods and Applications,
World Scientific Publishing, River Edge</em>.
</p>
<p>Keane, M. (1994) A computationally practical simulation estimator for panel data.
<em>Econometrica, 62:95-116</em>.
</p>


<h3>See Also</h3>

<p><code><a href="mvtnorm.html#topic+pmvnorm">pmvnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mvnintGHK(mean = rep(0, 51), sigma =  diag(0.2, 51) + matrix(0.8, 51, 51),
          lower = rep(-2,51), upper = rep(2,51), nrep = 10000)
</code></pre>

<hr>
<h2 id='negbin.gc'>The Negative Binomial Marginal of Class <code><a href="#topic+marginal.gc">marginal.gc</a></code></h2><span id='topic+negbin.gc'></span>

<h3>Description</h3>

<p>The negative binomial marginal parameterized in terms of its mean and overdispersion.
</p>
<p>By default, this function is used for likelihood inference and spatial prediction in functions
<code>mlegc</code> and <code>predgc</code> of the package <code>gcKrig</code>.
When all marginal parameters are given, the function is used for simulation and computing correlation in a
trans-Gaussian random field in functions <code>simgc</code> and <code>corrTG</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>negbin.gc(link = "log", mu = NULL, od = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="negbin.gc_+3A_link">link</code></td>
<td>
<p>the model link function.</p>
</td></tr>
<tr><td><code id="negbin.gc_+3A_mu">mu</code></td>
<td>
<p>a non-negative scalar of the mean parameter.</p>
</td></tr>
<tr><td><code id="negbin.gc_+3A_od">od</code></td>
<td>
<p>a non-negative scalar of the overdispersion parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The negative binomial distribution with parameters <code>mu = a</code> and <code>od = 1/b</code> has density
</p>
<p style="text-align: center;"><code class="reqn">\frac{\Gamma(y+b)}{\Gamma(b)y!} \Big(\frac{b}{b+a}\Big)^b
        \Big(1 - \frac{b}{b+a}\Big)^y </code>
</p>

<p>which is called NB2 by Cameron and Trivedi (2013).
Under this parameterization, <code class="reqn">var(Y)= mu + od*mu^2</code>, where
<code class="reqn">mu</code> is the mean parameter and <code class="reqn">od</code> is the overdispersion parameter.
For more details see Han and De Oliveira (2016).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> representing the marginal component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Cameron,A.C. and Trivedi,P.K. (2013) Regression Analysis of Count Data.
<em>Cambridge University Press, 2nd Edition</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2016) On the correlation structure of Gaussian
copula models for geostatistical count data.
<em>Australian and New Zealand Journal of Statistics, 58:47-69</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal.gc">marginal.gc</a></code>,  <code><a href="#topic+beta.gc">beta.gc</a></code>,
<code><a href="#topic+binomial.gc">binomial.gc</a></code>, <code><a href="#topic+gm.gc">gm.gc</a></code>,
<code><a href="#topic+gaussian.gc">gaussian.gc</a></code>, <code><a href="#topic+poisson.gc">poisson.gc</a></code>,
<code><a href="#topic+weibull.gc">weibull.gc</a></code>, <code><a href="#topic+zip.gc">zip.gc</a></code>
</p>

<hr>
<h2 id='OilWell'>
Location of Successful and Dry Wells
</h2><span id='topic+OilWell'></span>

<h3>Description</h3>

<p>A dataset recording locations of successful and unsuccessful drilling oil wells
in the northwest shelf of Delaware basin in New Mexico, a region that is
densely drilled but has some sparsely drilled areas.
The original dataset was transformed to a central area of about 65 square kilometers,
see Hohn (1999), Chapter 6.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(OilWell)</code></pre>


<h3>Format</h3>

<p>A data frame with 333 observations and 3 variables.
</p>

<dl>
<dt><code>Easting</code></dt><dd><p>Cartesian x-coordinate of the locations.</p>
</dd>
<dt><code>Northing</code></dt><dd><p>Cartesian y-coordinate of the locations.</p>
</dd>
<dt><code>Success</code></dt><dd><p>A binary variable indicating the success of the drill at given locations.
1 for successful drilling oil wells and 0 for unsuccess. </p>
</dd>
</dl>



<h3>References</h3>

<p>Hohn, M. (1999) Geostatistics and petroleum geology, Second Edition.
<em>Springer Science &amp; Business Media, APA</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(OilWell)
str(OilWell)
</code></pre>

<hr>
<h2 id='plot.mlegc'>
Plot Geostatistical Data and Fitted Mean
</h2><span id='topic+plot.mlegc'></span>

<h3>Description</h3>

<p>Four plots can be generated: the 2-D level plot or 3-D scatterplot with the number of counts or fitted values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlegc'
plot(x, plotdata = "Observed", plottype = "2D", xlab = "xloc", ylab = "yloc",
     xlim = NULL, ylim = NULL, pch = 20, textcex = 0.8, plotcex = 1,
     angle = 60, col = 4, col.regions = gray(90:0/100),...)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mlegc_+3A_x">x</code></td>
<td>
<p>an object of class <code>mlegc</code> inherited from function <code><a href="#topic+mlegc">mlegc</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_plotdata">plotdata</code></td>
<td>
<p>the data to be plotted. Can be either &quot;Observed&quot; if the original counts are used or
&quot;Fitted&quot; if the fitted mean at different locations are used.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_plottype">plottype</code></td>
<td>
<p>the type of the plot. Can be either &quot;2D&quot; for 2-D level plot or &quot;3D&quot; for 3-D scatterplot.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_xlab">xlab</code>, <code id="plot.mlegc_+3A_ylab">ylab</code></td>
<td>
<p>a title for the x and y axis.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_xlim">xlim</code>, <code id="plot.mlegc_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y coordinates ranges.
if they equal to <code>NULL</code> then they will be adjusted from the data.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_pch">pch</code></td>
<td>
<p>plotting character, i.e., the symbol to use in the 3-D scatter plot.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_textcex">textcex</code></td>
<td>
<p>a numerical value giving the amount by which plotting text should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_plotcex">plotcex</code></td>
<td>
<p>a numerical value giving the amount by which plotting symbols should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_angle">angle</code></td>
<td>
<p>angle between x and y axis.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_col">col</code></td>
<td>
<p>color of the text.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_col.regions">col.regions</code></td>
<td>
<p>color vector to be used reflecting magnitude of the dataset at different locations.
The general idea is that this should be a color vector of gradually varying color.</p>
</td></tr>
<tr><td><code id="plot.mlegc_+3A_...">...</code></td>
<td>
<p>further arguments passed to plot and panel settings.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.simgc">plot.simgc</a></code>,
<code><a href="#topic+plot.predgc">plot.predgc</a></code>
</p>

<hr>
<h2 id='plot.predgc'>
Plot Geostatistical Data at Sampling and Prediction Locations
</h2><span id='topic+plot.predgc'></span>

<h3>Description</h3>

<p>Five plots can be generated. A level plot with the number of counts at both observed and
prediction locations; a
level plot with predicted means (intensity); a level plot with the predicted counts;
a level plot with estimated variances of the prediction; a
3-D scatter plot with both observed and predicted counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predgc'
plot(x, plottype = "2D", xlab = "xloc", ylab = "yloc", xlim = NULL,
     ylim = NULL, pch = 20, textcex = 0.6, plotcex = 1, angle = 60,
     col = c(2, 4), col.regions = gray(90:0/100),...)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.predgc_+3A_x">x</code></td>
<td>
<p>an object of class <code>predgc</code> inherited from function <code><a href="#topic+predgc">predgc</a></code>.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_plottype">plottype</code></td>
<td>
<p>can be one of the following: &quot;2D&quot;, &quot;Predicted Counts&quot;, &quot;Predicted Mean&quot;,
&quot;Predicted Variance&quot; or &quot;3D&quot;. Default is &quot;2D&quot; which generates a 2-D contour plot with
both observed and predicted counts. With arguments &quot;Predicted Counts&quot;, &quot;Predicted Mean&quot; and
&quot;Predicted Variance&quot;, a 2-D level plot will be generated with the corresponding data.
When &quot;3D&quot; is used, a 3-D scatter plot will be displayed with observed and predicted counts.
</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_xlab">xlab</code>, <code id="plot.predgc_+3A_ylab">ylab</code></td>
<td>
<p>a title for the x and y axis.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_xlim">xlim</code>, <code id="plot.predgc_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y coordinates ranges.
if they equal to <code>NULL</code> then they will be adjusted from the data.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_pch">pch</code></td>
<td>
<p>plotting character, i.e., symbol to use in the 3-D scatter plot.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_textcex">textcex</code></td>
<td>
<p>a numerical value giving the amount by which plotting text should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_plotcex">plotcex</code></td>
<td>
<p>a numerical value giving the amount by which plotting symbols should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_angle">angle</code></td>
<td>
<p>angle between x and y axis.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_col">col</code></td>
<td>
<p>a numeric vector of length 2 indicating
color of the plot at sampling and prediction locations.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_col.regions">col.regions</code></td>
<td>
<p>color vector to be used reflecting magnitude of the dataset at different locations.
The general idea is that this should be a color vector of gradually varying color.</p>
</td></tr>
<tr><td><code id="plot.predgc_+3A_...">...</code></td>
<td>
<p>further arguments passed to plot and panel settings.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.simgc">plot.simgc</a></code>,
<code><a href="#topic+plot.mlegc">plot.mlegc</a></code>,
<code><a href="#topic+mlegc">mlegc</a></code>,
<code><a href="#topic+predgc">predgc</a></code>
</p>

<hr>
<h2 id='plot.simgc'>
Plot Geostatistical Data Simulated From Gaussian Copula
</h2><span id='topic+plot.simgc'></span>

<h3>Description</h3>

<p>Three plots will be generated. A level plot with the number of counts at given locations; a
level plot with point referenced locations and varying colors and a 3-D scatter plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simgc'
plot(x, index = 1, plottype = "Text", xlab = "xloc", ylab = "yloc",
     xlim = NULL, ylim = NULL, pch = 20, textcex = 0.8, plotcex = 1,
     angle = 60, col = 4, col.regions = gray(90:0/100),...)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.simgc_+3A_x">x</code></td>
<td>
<p>an object of class <code>simgc</code>, typically generated from function <code><a href="#topic+simgc">simgc</a></code>.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_index">index</code></td>
<td>
<p>the index of the simulated data, need to be specified since <code>simgc</code> can
simulate multiple datasets simultaneously.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_plottype">plottype</code></td>
<td>
<p>the type of the printed plot, can be &quot;Text&quot;, &quot;Dot&quot;, or &quot;3D&quot;. When plottype =
&quot;Text&quot;, a 2-D plot is generated with exact counts at observed locations. When plottype =
&quot;Dot&quot;, a 2-D dot plot is generated and when plottype = &quot;3D&quot; a 3-D scatter plot is printed.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_xlab">xlab</code>, <code id="plot.simgc_+3A_ylab">ylab</code></td>
<td>
<p>a title for the x and y axis.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_xlim">xlim</code>, <code id="plot.simgc_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y coordinates ranges.
if they equal to <code>NULL</code> then they will be adjusted from the data.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_pch">pch</code></td>
<td>
<p>plotting character, i.e., symbol to use in the 3-D scatter plot.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_textcex">textcex</code></td>
<td>
<p>a numerical value giving the amount by which plotting text should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_plotcex">plotcex</code></td>
<td>
<p>a numerical value giving the amount by which plotting symbols should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_angle">angle</code></td>
<td>
<p>angle between x and y axis.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_col">col</code></td>
<td>
<p>color of the text.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_col.regions">col.regions</code></td>
<td>
<p>color vector to be used reflecting magnitude of the dataset at different locations.
The general idea is that this should be a color vector of gradually varying color.</p>
</td></tr>
<tr><td><code id="plot.simgc_+3A_...">...</code></td>
<td>
<p>further arguments passed to plot and panel settings.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.mlegc">plot.mlegc</a></code>,
<code><a href="#topic+plot.predgc">plot.predgc</a></code>
</p>

<hr>
<h2 id='plotgc'>
Plot Geostatistical Count Data
</h2><span id='topic+plotgc'></span>

<h3>Description</h3>

<p>This funtion generates two plots describing a geostatistical count data.
The first plot is a bubble plot with size proportional to the response.
The second plot is a lattice plot with text
describing the number of counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotgc(data = NULL, locs = NULL, bdry = NULL, col = 2, pch = 1,
       textcex = 1, col.regions = gray(90:0/100), size=c(0.3, 2.7), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotgc_+3A_data">data</code></td>
<td>
<p>the geostatistical count response.</p>
</td></tr>
<tr><td><code id="plotgc_+3A_locs">locs</code></td>
<td>
<p>a n by 2 matrix or data frame that indicates the coordinates of locations.</p>
</td></tr>
<tr><td><code id="plotgc_+3A_bdry">bdry</code></td>
<td>
<p>a list containing the coordinates of boundaries.</p>
</td></tr>
<tr><td><code id="plotgc_+3A_col">col</code></td>
<td>
<p>the color used for response variable in both plots.</p>
</td></tr>
<tr><td><code id="plotgc_+3A_pch">pch</code></td>
<td>
<p>the shape used for response variable in the first plot.</p>
</td></tr>
<tr><td><code id="plotgc_+3A_textcex">textcex</code></td>
<td>
<p>a numerical value giving the amount by which plotting text should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="plotgc_+3A_col.regions">col.regions</code></td>
<td>
<p>color vector to be used reflecting magnitude of the dataset at different locations.
The general idea is that this should be a color vector of gradually varying color.</p>
</td></tr>
<tr><td><code id="plotgc_+3A_size">size</code></td>
<td>
<p>the minimum and maximum of the sizes in the first plot. </p>
</td></tr>
<tr><td><code id="plotgc_+3A_...">...</code></td>
<td>
<p>other parameters that control the plotting.</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.simgc">plot.simgc</a></code>
<code><a href="#topic+plot.mlegc">plot.mlegc</a></code>,
<code><a href="#topic+plot.predgc">plot.predgc</a></code>
</p>

<hr>
<h2 id='poisson.gc'>The Poisson Marginal of Class <code><a href="#topic+marginal.gc">marginal.gc</a></code></h2><span id='topic+poisson.gc'></span>

<h3>Description</h3>

<p>The Poisson marginal parameterized in terms of its mean.
</p>
<p>By default, this function is used for likelihood inference and spatial prediction in function
<code>mlegc</code> and <code>predgc</code> of the package <code>gcKrig</code>.
When all marginal parameters are given, the function is used for simulation and computing correlation in a
trans-Gaussian random field in function <code>simgc</code> and <code>corrTG</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.gc(link = "log", lambda = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson.gc_+3A_link">link</code></td>
<td>
<p>the model link function.</p>
</td></tr>
<tr><td><code id="poisson.gc_+3A_lambda">lambda</code></td>
<td>
<p>a non-negative scalar of the mean parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> representing the marginal component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal.gc">marginal.gc</a></code>,  <code><a href="#topic+beta.gc">beta.gc</a></code>,
<code><a href="#topic+binomial.gc">binomial.gc</a></code>, <code><a href="#topic+gm.gc">gm.gc</a></code>,
<code><a href="#topic+gaussian.gc">gaussian.gc</a></code>, <code><a href="#topic+negbin.gc">negbin.gc</a></code>,
<code><a href="#topic+weibull.gc">weibull.gc</a></code>, <code><a href="#topic+zip.gc">zip.gc</a></code>
</p>

<hr>
<h2 id='powerexp.gc'>The Powered Exponential Correlation Function of Class <code><a href="#topic+corr.gc">corr.gc</a></code></h2><span id='topic+powerexp.gc'></span>

<h3>Description</h3>

<p>The powered exponential correlation function in spatial statistics.
</p>
<p>By default, range parameter is not available, so
this function is used for likelihood inference and spatial prediction in function <code>mlegc</code>
and <code>predgc</code>.
Users need to specify the shape parameter <code>kappa</code> and if the correlation model includes a nugget effect
<code>nugget = TRUE</code> or not <code>nugget = FALSE</code>.
</p>
<p>When both range and nugget parameters are given,
the function is used for simulation with function <code>simgc</code> in package <code>gcKrig</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerexp.gc(range = NULL, kappa = 1, nugget = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerexp.gc_+3A_range">range</code></td>
<td>
<p>a non-negative scalar of the range parameter in powered
exponential correlation function.</p>
</td></tr>
<tr><td><code id="powerexp.gc_+3A_kappa">kappa</code></td>
<td>
<p>a scalar between 0 and 2; the value of the shape
parameter in the powered exponential correlation function.</p>
</td></tr>
<tr><td><code id="powerexp.gc_+3A_nugget">nugget</code></td>
<td>
<p>the nugget effect of the correlation function. If specified, it must be a scalar between 0 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The powered exponential correlation function with a nugget <code class="reqn">\tau^2</code> is of the form:
</p>
<p style="text-align: center;"><code class="reqn">\rho(h) = (1-\tau^2) exp((-h/\phi)^\kappa)</code>
</p>

<p>when <code class="reqn">h &gt; 0</code> and <code class="reqn">\rho(h) = 1</code> when <code class="reqn">h = 0</code>.
Here <code class="reqn">h</code> is distance, <code class="reqn">\phi</code> is range parameter, <code class="reqn">\kappa</code> is the shape parameter and
<code class="reqn">\tau^2</code> is the nugget effect.
</p>
<p>When using the powered exponential correlation function, note that <code class="reqn">0&lt;\kappa \le 2</code>.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+corr.gc">corr.gc</a></code> representing the correlation component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matern.gc">matern.gc</a></code>,  <code><a href="#topic+spherical.gc">spherical.gc</a></code>
</p>

<hr>
<h2 id='predgc'>Prediction at Unobserved Locations in Gaussian Copula Models for Geostatistical Count Data</h2><span id='topic+predgc'></span>

<h3>Description</h3>

<p>Computes the plug-in prediction at unobserved sites. Two methods are implemented. If
<code>method = 'GHK'</code> then the maximum simulated likelihood estimates are computed and
the sequential importance sampling method is used in the integral evaluation. If
<code>method = 'GQT'</code> then the maximum surrogate likelihood estimates are computed and the
generalized quantile transform method is used in integral approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predgc(obs.y, obs.x = NULL, obs.locs, pred.x = NULL, pred.locs,
       longlat = FALSE, distscale = 1, marginal, corr, obs.effort = 1,
       pred.effort = 1, method = "GHK", estpar = NULL, corrpar0 = NULL,
       pred.interval = NULL, parallel = FALSE,
       ghkoptions = list(nrep = c(100,1000), reorder = FALSE, seed = 12345),
       paralleloptions = list(n.cores = 2, cluster.type = "SOCK"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predgc_+3A_obs.y">obs.y</code></td>
<td>
<p>a non-negative integer vector of observed response with its length
equals to the number of observed locations.</p>
</td></tr>
<tr><td><code id="predgc_+3A_obs.x">obs.x</code></td>
<td>
<p>a numeric matrix or data frame of covariates at observed locations,
with its number of rows equals to the number of observed locations.
If no covariates then <code>obs.x = NULL</code>.</p>
</td></tr>
<tr><td><code id="predgc_+3A_obs.locs">obs.locs</code></td>
<td>
<p>a numeric matrix or data frame of observed locations.obs.effort
The first column is <em>x</em> or longitude, the second column is <em>y</em> or latitude.
The number of observed locations is equal to the number of rows.</p>
</td></tr>
<tr><td><code id="predgc_+3A_pred.x">pred.x</code></td>
<td>
<p>a numeric matrix or data frame of covariates at prediction locations,
with its number of rows equals to the number of prediction locations.
If no covariates then <code>pred.x = NULL</code>.</p>
</td></tr>
<tr><td><code id="predgc_+3A_pred.locs">pred.locs</code></td>
<td>
<p>a numeric matrix or data frame of prediction locations.
First column is <em>x</em> or longitude, second column is <em>y</em> or latitude.
The number of prediction locations equals to the number of rows.</p>
</td></tr>
<tr><td><code id="predgc_+3A_longlat">longlat</code></td>
<td>
<p>if FALSE, use Euclidean distance, if TRUE use great circle distance. The default is FALSE.</p>
</td></tr>
<tr><td><code id="predgc_+3A_distscale">distscale</code></td>
<td>
<p>a numeric scaling factor for computing distance. If original distance is in kilometers, then
<code>distscale = 1000</code> will convert it to meters.</p>
</td></tr>
<tr><td><code id="predgc_+3A_marginal">marginal</code></td>
<td>
<p>an object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> specifying the marginal distribution.</p>
</td></tr>
<tr><td><code id="predgc_+3A_corr">corr</code></td>
<td>
<p>an object of class <code><a href="#topic+corr.gc">corr.gc</a></code> specifying the correlation function.</p>
</td></tr>
<tr><td><code id="predgc_+3A_obs.effort">obs.effort</code></td>
<td>
<p>sampling effort at observed locations.
For binomial marginal it is the size parameter (number of trials). See details.</p>
</td></tr>
<tr><td><code id="predgc_+3A_pred.effort">pred.effort</code></td>
<td>
<p>sampling effort at prediction locations.
For binomial marginal it is the size parameter (number of trials). See details.</p>
</td></tr>
<tr><td><code id="predgc_+3A_method">method</code></td>
<td>
<p>two methods are implemented. If
<code>method = 'GHK'</code> then the maximum simulated likelihood estimates are computed, if
<code>method = 'GQT'</code> then the maximum surrogate likelihood estimates are computed.</p>
</td></tr>
<tr><td><code id="predgc_+3A_estpar">estpar</code></td>
<td>
<p>if <code>estpar = NULL</code> then the likelihood estimates
will be computed first, then plug-in into the predictive density.
When all estimates are available,
it is suggested to specify <code>estpar</code> with the parameter estimates so
re-fitting is not needed. If so, the sequence of the
input values for <code>estpar</code> is: regression parameters, overdispersion (if any), and correlation parameters (range and nugget, if applicable).
</p>
</td></tr>
<tr><td><code id="predgc_+3A_corrpar0">corrpar0</code></td>
<td>
<p>the starting value of correlation parameters in optimization procedure.
If <code>corrpar0 = NULL</code> then
initial range is set to be half of the median distance in distance matrix, and initial nugget
(if <code>nugget = TRUE</code>) is 0.2.</p>
</td></tr>
<tr><td><code id="predgc_+3A_pred.interval">pred.interval</code></td>
<td>
<p>a number between <code>0</code> and <code>1</code> representing confidence level of the prediction
interval. The program will output two types of the prediction intervals, see detail.
If <code>pred.interval = NULL</code> then no prediction interval will be computed.</p>
</td></tr>
<tr><td><code id="predgc_+3A_parallel">parallel</code></td>
<td>
<p>if <code>TRUE</code> then parallel computing is used to predict multiple prediction locations
simultaneously. If <code>FALSE</code> then a serial version will be called.</p>
</td></tr>
<tr><td><code id="predgc_+3A_ghkoptions">ghkoptions</code></td>
<td>
<p>a list of three elements that only need to be specified if <code>method = 'GHK'</code>.
</p>
<p><code>nrep</code> is the Monte Carlo size of the importance sampling algorithm for likelihood approximation.
It can be a vector with increasing positive integers so that the model is
fitted with a sequence of different Monte Carlo sizes, and the starting
values for optimization are taken from the previous fitting.
The default value is 100 for the first optimization and 1000 for the second and definitive optimization.
</p>
<p><code>reorder</code> indicates whether the integral will be reordered every iteration in computation
according to the algorithm in Gibson, etal (1994), default is FALSE.
</p>
<p><code>seed</code> is seed of the pseudorandom generator used in Monte Carlo simulation.</p>
</td></tr>
<tr><td><code id="predgc_+3A_paralleloptions">paralleloptions</code></td>
<td>
<p>a list of two elements that only need to be specified if <code>parallel = TRUE</code>.
</p>
<p><code>n.cores</code> is the number of cores to be used in parallel prediction.
</p>
<p><code>cluster.type</code> is type of cluster to be used for parallel computing; can be &quot;SOCK&quot;, &quot;MPI&quot;, &quot;PVM&quot;, or &quot;NWS&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This program implemented two methods in predicting the response at unobserved sites. See <code><a href="#topic+mlegc">mlegc</a></code>.
</p>
<p>The argument <code>obs.effort</code> and <code>pred.effort</code>
are the sampling effort (known). It can be used to consider heterogeneity of
the measurement time or area at different locations. The default is 1 for all locations.
See Han and De Oliveira (2016) for more details.
</p>
<p>The program computes two types of prediction intervals at a given confidence level. The shortest
prediction interval is obtained from evaluating the highest to lowest prediction densities;
the equal tail prediction interval has equal tail probabilities.
</p>


<h3>Value</h3>

<p>A list of class &quot;predgc&quot; with the following elements:
</p>
<table>
<tr><td><code>obs.locs</code></td>
<td>
<p> observed locations.</p>
</td></tr>
<tr><td><code>obs.y</code></td>
<td>
<p> observed values at observed locations.</p>
</td></tr>
<tr><td><code>pred.locs</code></td>
<td>
<p> prediction locations.</p>
</td></tr>
<tr><td><code>predValue</code></td>
<td>
<p>the expectation of the conditional predictive distribution.</p>
</td></tr>
<tr><td><code>predCount</code></td>
<td>
<p> predicted counts; the closest integer that <code>predValue</code> rounded to.</p>
</td></tr>
<tr><td><code>predVar</code></td>
<td>
<p> estimated variance of the prediction at prediction locations.</p>
</td></tr>
<tr><td><code>ConfidenceLevel</code></td>
<td>
<p> confidence level (between 0 to 1) if prediction interval is computed.</p>
</td></tr>
<tr><td><code>predInterval.EqualTail</code></td>
<td>
<p> equal-tail prediction interval.</p>
</td></tr>
<tr><td><code>predInterval.Shortest</code></td>
<td>
<p> shortest length prediction interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Han, Z. and De Oliveira, V. (2016) On the correlation structure of Gaussian
copula models for geostatistical count data.
<em>Australian and New Zealand Journal of Statistics, 58:47-69</em>.
</p>
<p>Kazianka, H. and Pilz, J. (2010)
Copula-based geostatistical modeling of continuous and discrete data including covariates.
<em>Stoch Environ Res Risk Assess 24:661-673</em>.
</p>
<p>Kazianka, H. (2013)
Approximate copula-based estimation and prediction of discrete spatial data.
<em>Stoch Environ Res Risk Assess 27:2015-2026</em>.
</p>
<p>Masarotto, G. and Varin, C. (2012)
Gaussian copula marginal regression.
<em>Electronic Journal of Statistics 6:1517-1549</em>.
<a href="https://projecteuclid.org/euclid.ejs/1346421603">https://projecteuclid.org/euclid.ejs/1346421603</a>.
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. doi: <a href="https://doi.org/10.18637/jss.v077.i08">10.18637/jss.v077.i08</a>.
</p>
<p>Han, Z. and De Oliveira, V. (2018) gcKrig: An R Package for the Analysis of Geostatistical Count Data Using Gaussian Copulas.
<em>Journal of Statistical Software</em>, <b>87</b>(13), 1&ndash;32. doi: <a href="https://doi.org/10.18637/jss.v087.i13">10.18637/jss.v087.i13</a>.
</p>


<h3>See Also</h3>

<p><code><a href="gcmr.html#topic+gcmr">gcmr</a></code>;
<code><a href="#topic+mlegc">mlegc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## For fast check predict at four locations only
data(Weed95)
weedobs &lt;- Weed95[Weed95$dummy==1, ]
weedpred &lt;- Weed95[Weed95$dummy==0, ]
predweed1 &lt;- predgc(obs.y = weedobs$weedcount, obs.x = weedobs[,4:5], obs.locs = weedobs[,1:2],
                     pred.x = weedpred[1:4,4:5], pred.locs = weedpred[1:4,1:2],
                     marginal = negbin.gc(link = 'log'), pred.interval = 0.9,
                     corr = matern.gc(kappa = 0.5, nugget = TRUE), method = 'GHK')
#summary(predweed1)
#plot(predweed1)

## Time consuming examples
## Weed prediction at 200 locations using parallel programming
predweed2 &lt;- predgc(obs.y = weedobs$weedcount, obs.x = weedobs[,4:5], obs.locs = weedobs[,1:2],
                     pred.x = weedpred[,4:5], pred.locs = weedpred[,1:2],
                     marginal = negbin.gc(link = 'log'),
                     corr = matern.gc(kappa = 0.5, nugget = TRUE), method = 'GHK',
                     pred.interval = 0.95, parallel = TRUE,
                     paralleloptions = list(n.cores = 4))
#summary(predweed2)
#plot(predweed2)


## A more time consuming example for generating a prediction map at a fine grid
data(OilWell)
gridstep &lt;- seq(0.5, 30.5, length = 40)
locOilpred &lt;- data.frame(Easting = expand.grid(gridstep, gridstep)[,1],
                        Northing = expand.grid(gridstep, gridstep)[,2])
PredOil &lt;- predgc(obs.y = OilWell[,3], obs.locs = OilWell[,1:2],  pred.locs = locOilpred,
                       marginal = binomial.gc(link = 'logit'),
                       corr = matern.gc(nugget = FALSE), obs.effort = 1,
                       pred.effort = 1, method = 'GHK',
                       parallel = TRUE, paralleloptions = list(n.cores = 4))
PredMat &lt;- summary(PredOil)

## To generate better prediction maps
library(colorspace)
filled.contour(seq(0.5,30.5,length=40), seq(0.5,30.5,length=40),
               matrix(PredMat$predMean,40,), zlim = c(0, 1), col=rev(heat_hcl(12)),
               nlevels=12, xlab = "Eastings", ylab = "Northings",
               plot.axes = {axis(1); axis(2); points(OilWell[,1:2], col = 1,
               cex = 0.25 + 0.25*OilWell[,3])})

filled.contour(seq(0.5,30.5,length=40), seq(0.5,30.5,length=40),
               matrix(PredMat$predVar,40,),
               zlim = c(0, 0.3), col = rev(heat_hcl(12)), nlevels = 10,
               xlab = "Eastings", ylab = "Northings",
               plot.axes = {axis(1); axis(2); points(OilWell[,1:2], col = 1,
               cex = 0.25 + 0.25*OilWell[,3])})


## End(Not run)

</code></pre>

<hr>
<h2 id='profile.mlegc'>
Profile Likelihood Based Confidence Interval of Parameters
for Gaussian Copula Models in Geostatistical Count Data
</h2><span id='topic+profile.mlegc'></span>

<h3>Description</h3>

<p>This function computes the (approximate) profile likelihood based confidence interval. The algorithm
starts by choosing two starting points at different sides of the MLE and using an iterative process
to find the approximate lower and upper bound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlegc'
profile(fitted, par.index, alpha = 0.05, start.point = NULL,
        method = 'GQT', nrep = 1000, seed = 12345, ...)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profile.mlegc_+3A_fitted">fitted</code></td>
<td>
<p>an object of class <code>mlegc</code>, typically inherited from function <code><a href="#topic+mlegc">mlegc</a></code>.
</p>
</td></tr>
<tr><td><code id="profile.mlegc_+3A_par.index">par.index</code></td>
<td>
<p>the index of the parameter which should be profiled.  </p>
</td></tr>
<tr><td><code id="profile.mlegc_+3A_alpha">alpha</code></td>
<td>
<p>the significance level, default is <code>0.05</code> which corresponds to <code>95</code>
percent confidence interval.</p>
</td></tr>
<tr><td><code id="profile.mlegc_+3A_start.point">start.point</code></td>
<td>
<p>numeric vector of length 2 indicating the starting points for finding the
left and right bound. If <code>start.point = NULL</code> then the default starting points will be used.</p>
</td></tr>
<tr><td><code id="profile.mlegc_+3A_method">method</code></td>
<td>
<p>Two methods are implemented. If
<code>method = 'GHK'</code> then the simulated likelihood will be used, if
<code>method = 'GQT'</code> then the surrogate likelihood will be used.</p>
</td></tr>
<tr><td><code id="profile.mlegc_+3A_nrep">nrep</code></td>
<td>
<p>the Monte Carlo size of the importance sampling algorithm for likelihood approximation;
only need to be specified if <code>method = 'GHK'</code>.</p>
</td></tr>
<tr><td><code id="profile.mlegc_+3A_seed">seed</code></td>
<td>
<p>seed of the pseudorandom generator used in Monte Carlo simulation;
only need to be specified if <code>method = 'GHK'</code>.</p>
</td></tr>
<tr><td><code id="profile.mlegc_+3A_...">...</code></td>
<td>
<p>other arguments passed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Lower and upper bounds of the approximate confidence interval.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Masarotto, G. and Varin, C. (2012)
Gaussian copula marginal regression.
<em>Electronic Journal of Statistics 6:1517-1549</em>.
<a href="https://projecteuclid.org/euclid.ejs/1346421603">https://projecteuclid.org/euclid.ejs/1346421603</a>.
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. doi: <a href="https://doi.org/10.18637/jss.v077.i08">10.18637/jss.v077.i08</a>.
</p>
<p>Han, Z. and De Oliveira, V. (2018) gcKrig: An R Package for the Analysis of Geostatistical Count Data Using Gaussian Copulas.
<em>Journal of Statistical Software</em>, <b>87</b>(13), 1&ndash;32. doi: <a href="https://doi.org/10.18637/jss.v087.i13">10.18637/jss.v087.i13</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlegc">mlegc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(LansingTrees)
Treefit4 &lt;- mlegc(y = LansingTrees[,3], x = LansingTrees[,4],
                    locs = LansingTrees[,1:2], marginal = zip.gc(link = 'log'),
                    corr = matern.gc(kappa = 0.5, nugget = TRUE), method = 'GHK')
summary(Treefit4)

profile(Treefit4, 1, 0.05,  method = 'GHK', nrep = 1000, seed = 12345)
profile(Treefit4, 2, 0.05,  method = 'GHK', nrep = 1000, seed = 12345)
profile(Treefit4, 3, 0.05,  method = 'GHK', nrep = 1000, seed = 12345)
profile(Treefit4, 4, 0.05,  method = 'GHK', nrep = 1000, seed = 12345)
profile(Treefit4, 5, 0.05, method = 'GHK', nrep = 1000, seed = 12345)

## End(Not run)
</code></pre>

<hr>
<h2 id='simgc'>Simulate Geostatistical Data from Gaussian Copula Model at Given Locations</h2><span id='topic+simgc'></span>

<h3>Description</h3>

<p>Simulate geostatistical data from Gaussian copula model at given locations.
This function can simulate multiple datasets simultaneously.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simgc(locs, sim.n = 1, marginal, corr, longlat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simgc_+3A_locs">locs</code></td>
<td>
<p>a numeric matrix or data frame of <em>n-D</em> points with row denoting points.
First column is <em>x</em> or longitude, second column is <em>y</em> or latitude. The number of locations is
equal to the number of rows.</p>
</td></tr>
<tr><td><code id="simgc_+3A_sim.n">sim.n</code></td>
<td>
<p>the number of simulation samples required.</p>
</td></tr>
<tr><td><code id="simgc_+3A_marginal">marginal</code></td>
<td>
<p>an object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> specifying the marginal distribution.</p>
</td></tr>
<tr><td><code id="simgc_+3A_corr">corr</code></td>
<td>
<p>an object of class <code><a href="#topic+corr.gc">corr.gc</a></code> specifying the correlation function.</p>
</td></tr>
<tr><td><code id="simgc_+3A_longlat">longlat</code></td>
<td>
<p>if FALSE, use Euclidean distance, if TRUE use great circle distance. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two elements:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a numeric matrix with each row denoting a simulated data.</p>
</td></tr>
<tr><td><code>locs</code></td>
<td>
<p>the location of the simulated data, same as the input locs.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grid &lt;- seq(0.05, 0.95, by = 0.1)
xloc &lt;- expand.grid(x = grid, y = grid)[,1]
yloc &lt;- expand.grid(x = grid, y = grid)[,2]
set.seed(12345)
sim1 &lt;- simgc(locs = cbind(xloc,yloc), sim.n = 10, marginal = negbin.gc(mu = 5, od = 1),
              corr = matern.gc(range = 0.3, kappa = 0.5, nugget = 0.1))
#plot(sim1, index = 1)
</code></pre>

<hr>
<h2 id='spherical.gc'>The Spherical Correlation Function of Class <code><a href="#topic+corr.gc">corr.gc</a></code></h2><span id='topic+spherical.gc'></span>

<h3>Description</h3>

<p>The spherical correlation function in spatial statistics.
</p>
<p>By default, range parameter is not available, so
this function is used for likelihood inference and spatial prediction in function <code>mlegc</code>
and <code>predgc</code>.
Users need to specify if the correlation model includes a nugget effect
<code>nugget = TRUE</code> or not <code>nugget = FALSE</code>.
</p>
<p>When both range and nugget parameters are given,
the function is used for simulation with function <code>simgc</code> in package <code>gcKrig</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spherical.gc(range = NULL, nugget = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spherical.gc_+3A_range">range</code></td>
<td>
<p>a non-negative scalar of the range parameter in the spherical
correlation function.</p>
</td></tr>
<tr><td><code id="spherical.gc_+3A_nugget">nugget</code></td>
<td>
<p>the nugget effect of the correlation function. If specified, it must be a scalar between 0 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The spherical correlation function with a nugget <code class="reqn">\tau^2</code> is of the form:
</p>
<p style="text-align: center;"><code class="reqn">\rho(h) = (1-\tau^2) (1 - 1.5(h/\phi) + 0.5(-h/\phi)^3) </code>
</p>

<p>when <code class="reqn">h &gt; 0</code> and <code class="reqn">\rho(h) = 1</code> when <code class="reqn">h = 0</code>, <code class="reqn">h</code> is distance.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+corr.gc">corr.gc</a></code> representing the correlation component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matern.gc">matern.gc</a></code>,  <code><a href="#topic+spherical.gc">spherical.gc</a></code>
</p>

<hr>
<h2 id='summary.mlegc'>
Methods for Extracting Information from Fitted Object of Class <code>mlegc</code></h2><span id='topic+print.mlegc'></span><span id='topic+summary.mlegc'></span><span id='topic+print.summary.mlegc'></span>

<h3>Description</h3>

<p>Return a summary table of results from model fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlegc'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mlegc_+3A_object">object</code></td>
<td>
<p>an object of class <code>mlegc</code> inherited from function <code><a href="#topic+mlegc">mlegc</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.mlegc_+3A_...">...</code></td>
<td>
<p>additional arguments, but currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table summary of the estimates, standard error, z-value and several information criteria.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlegc">mlegc</a></code>
</p>

<hr>
<h2 id='summary.predgc'>
Methods for Extracting Information from Fitted Object of Class <code>predgc</code></h2><span id='topic+summary.predgc'></span>

<h3>Description</h3>

<p>Output a summary data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predgc'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.predgc_+3A_object">object</code></td>
<td>

<p>an object of class <code>predgc</code> inherited from function <code><a href="#topic+predgc">predgc</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.predgc_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table including the following information:
</p>
<table>
<tr><td><code>pred.locs</code></td>
<td>
<p> prediction locations.</p>
</td></tr>
<tr><td><code>predMean</code></td>
<td>
<p>the expectation of the conditional predictive distribution.</p>
</td></tr>
<tr><td><code>predCount</code></td>
<td>
<p> predicted counts; the closest integer that <code>predMean</code> rounded to.</p>
</td></tr>
<tr><td><code>predVar</code></td>
<td>
<p> estimated variance of the prediction at prediction locations.</p>
</td></tr>
<tr><td><code>predInterval.EqualTail</code></td>
<td>
<p> equal-tail prediction interval;
computed only if <code>ConfidenceLevel = TRUE</code>. </p>
</td></tr>
<tr><td><code>predInterval.Shortest</code></td>
<td>
<p> shortest length prediction interval;
computed only if <code>ConfidenceLevel = TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlegc">mlegc</a></code>,
<code><a href="#topic+predgc">predgc</a></code>
</p>

<hr>
<h2 id='vcov.mlegc'>
Covariance Matrix of the Maximum Likelihood Estimates
</h2><span id='topic+vcov.mlegc'></span>

<h3>Description</h3>

<p>Calculate covariance and correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlegc'
vcov(object, digits = max(3, getOption("digits") - 3), ...)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.mlegc_+3A_object">object</code></td>
<td>
<p>an object of class <code>mlegc</code> inherited from function <code><a href="#topic+mlegc">mlegc</a></code>.</p>
</td></tr>
<tr><td><code id="vcov.mlegc_+3A_digits">digits</code></td>
<td>
<p>integer indicating the number of decimal places (round) or
significant digits (signif) to be used. </p>
</td></tr>
<tr><td><code id="vcov.mlegc_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>vcov</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated variance-covariance matrix and estimated correlation matrix.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlegc">mlegc</a></code>
</p>

<hr>
<h2 id='Weed95'>
Counts of Weed Plants on a Field
</h2><span id='topic+Weed95'></span>

<h3>Description</h3>

<p>The weed species Viola Arvensis was counted within circular frames each of area
0.25 square meter except for 10 missing sites in the first row,
from a 20 by 14 rectangular grid, so the total number of locations is 270.
Also, the percentages of organic matter in a soil sample are collected.
The data was studied by Christensen and Waagepetersen (2002)
to investigate whether weed occurrence could be predicted
from observations of soil texture and soil chemical properties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Weed95)</code></pre>


<h3>Format</h3>

<p>A data frame with 270 observations and 6 variables.
</p>

<dl>
<dt><code>xloc</code></dt><dd><p>Cartesian x-coordinate of the locations (in meter).</p>
</dd>
<dt><code>yloc</code></dt><dd><p>Cartesian y-coordinate of the locations (in meter).</p>
</dd>
<dt><code>weedcount</code></dt><dd><p>Number of weed collected at the given site.</p>
</dd>
<dt><code>scaled Y coord</code></dt><dd><p>The scaled Y coordinate with range -1 to 1 as a
covariate in regression.</p>
</dd>
<dt><code>organic</code></dt><dd><p>Another chemical component indicating the organic matter of the soil.</p>
</dd>
<dt><code>dummy</code></dt><dd><p>A dummy variable taking values 0 or 1. If 0 it is
treated as observed location and 1 treated as predicted location in Christensen and Waagepetersen (2002). </p>
</dd>
</dl>



<h3>References</h3>

<p>Christensen,O. and Waagepetersen,R. (2002) Bayesian Prediction of Spatial Count Data Using
Generalized Linear Mixed Models. <em>Biometrics, 58:280-286 </em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Weed95)
str(Weed95)
</code></pre>

<hr>
<h2 id='weibull.gc'>The Weibull Marginal of Class <code><a href="#topic+marginal.gc">marginal.gc</a></code></h2><span id='topic+weibull.gc'></span>

<h3>Description</h3>

<p>The Weibull marginal used for simulation and computing correlation in the
trans-Gaussian random field in function <code>simgc</code> and <code>corrTG</code> of the package <code>gcKrig</code>.
It cannot be used in function <code>mlegc</code> nor <code>predgc</code> to make model inferences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibull.gc(shape = 1, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibull.gc_+3A_shape">shape</code></td>
<td>
<p>a positive scalar of shape parameter in the Weibull distribution.</p>
</td></tr>
<tr><td><code id="weibull.gc_+3A_scale">scale</code></td>
<td>
<p>a positive scalar of scale parameter in the Weibull distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Weibull distribution with <code>shape</code> parameter <code class="reqn">a</code> and <code>scale</code> parameter <code class="reqn">b</code>
has density given by
</p>
<p style="text-align: center;"><code class="reqn">(a/b) (x/b)^{a-1} exp(-(x/b)^a) </code>
</p>



<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> representing the marginal component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal.gc">marginal.gc</a></code>,  <code><a href="#topic+beta.gc">beta.gc</a></code>,
<code><a href="#topic+binomial.gc">binomial.gc</a></code>, <code><a href="#topic+gm.gc">gm.gc</a></code>,
<code><a href="#topic+gaussian.gc">gaussian.gc</a></code>, <code><a href="#topic+negbin.gc">negbin.gc</a></code>,
<code><a href="#topic+poisson.gc">poisson.gc</a></code>, <code><a href="#topic+zip.gc">zip.gc</a></code>
</p>

<hr>
<h2 id='zip.gc'>The Zero-inflated Poisson Marginal of Class <code><a href="#topic+marginal.gc">marginal.gc</a></code></h2><span id='topic+zip.gc'></span>

<h3>Description</h3>

<p>The zero-inflated Poisson marginal parameterized in terms of its mean and overdispersion.
</p>
<p>By default, this function is used for likelihood inference and spatial prediction in function
<code>mlegc</code> and <code>predgc</code> of the package <code>gcKrig</code>.
When all marginal parameters are given, the function is used for simulation and computing correlation in a
trans-Gaussian random field in function <code>simgc</code> and <code>corrTG</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zip.gc(link = "log", mu = NULL, od = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zip.gc_+3A_link">link</code></td>
<td>
<p>the model link function.</p>
</td></tr>
<tr><td><code id="zip.gc_+3A_mu">mu</code></td>
<td>
<p>a non-negative scalar of the mean parameter.</p>
</td></tr>
<tr><td><code id="zip.gc_+3A_od">od</code></td>
<td>
<p>a non-negative scalar of the overdispersion parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The zero-inflated Poisson distribution with parameters <code>mu = a</code> and <code>od = b</code> has density
</p>
<p style="text-align: center;"><code class="reqn">b/(1+b) + exp(-(a+ab))/(1+b)</code>
</p>

<p>when <code class="reqn">y = 0</code>, and
</p>
<p style="text-align: center;"><code class="reqn">exp(-(a+ab))*(a+ab)^y/((1+b)y!)</code>
</p>

<p>when <code class="reqn">y = 1, 2, \ldots</code>
</p>
<p>Under this parameterization, <code class="reqn">var(Y)= mu + od*mu^2</code>, where
<code class="reqn">mu</code> is the mean parameter and <code class="reqn">od</code> is the overdispersion parameter.
For more details see Han and De Oliveira (2016).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gc">marginal.gc</a></code> representing the marginal component.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Han, Z. and De Oliveira, V. (2016) On the correlation structure of Gaussian
copula models for geostatistical count data.
<em>Australian and New Zealand Journal of Statistics, 58:47-69</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal.gc">marginal.gc</a></code>,  <code><a href="#topic+beta.gc">beta.gc</a></code>, <code><a href="#topic+binomial.gc">binomial.gc</a></code>,
<code><a href="#topic+gm.gc">gm.gc</a></code>, <code><a href="#topic+gaussian.gc">gaussian.gc</a></code>,
<code><a href="#topic+negbin.gc">negbin.gc</a></code>, <code><a href="#topic+poisson.gc">poisson.gc</a></code>,
<code><a href="#topic+weibull.gc">weibull.gc</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
