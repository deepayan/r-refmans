<!DOCTYPE html><html><head><title>Help for package NPCD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NPCD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#NPCD-package'>
<p>NPCD: The <span class="rlang"><b>R</b></span> Package for Nonparametric Methods for Cognitive Diagnosis</p></a></li>
<li><a href='#AlphaMLE'><p>Maximum likelihood estimation of attribute profile</p></a></li>
<li><a href='#AlphaNP'><p>Nonparametric estimation of attribute profiles</p></a></li>
<li><a href='#CDL'><p>Log-likelihood for cognitive diagnostic models</p></a></li>
<li><a href='#CDP'><p>Probability of correct response for cognitive diagnostic models</p></a></li>
<li><a href='#Data.DINA'><p>Example dataset generated using DINA model</p></a></li>
<li><a href='#Data.DINO'><p>Example dataset generated using DINO model</p></a></li>
<li><a href='#Data.Qrefine'><p>Example dataset used for the <code>Qrefine</code> function</p></a></li>
<li><a href='#ItemFit'><p>Compute item fit statistics for outputs generated by estimation functions in the package</p></a></li>
<li><a href='#JMLE'><p>Joint maximum likelihood estimation of item parameters and examinee attribute profiles</p></a></li>
<li><a href='#ModelFit'><p>Compute overall model fit statistics for outputs generated by estimation functions in the package</p></a></li>
<li><a href='#ParMLE'><p>Maximum likelihood estimation of item parameters for cognitive diagnostic models.</p></a></li>
<li><a href='#plot.NPCD'><p>Produce diagnostic plots</p></a></li>
<li><a href='#print.NPCD'><p>Print outputs generated from the functions in the package.</p></a></li>
<li><a href='#Qrefine'><p>Refine the Q-matrix by minimizing the residual sum of square (RSS)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-11</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-11-15</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Methods for Cognitive Diagnosis</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yi Zheng &lt;yi.isabel.zheng@asu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An array of nonparametric and parametric estimation methods for cognitive diagnostic models, including nonparametric classification of examinee attribute profiles, joint maximum likelihood estimation (JMLE) of examinee attribute profiles and item parameters, and nonparametric refinement of the Q-matrix, as well as conditional maximum likelihood estimation (CMLE) of examinee attribute profiles given item parameters and CMLE of item parameters given examinee attribute profiles. Currently the nonparametric methods in the package support both conjunctive and disjunctive models, and the parametric methods in the package support the DINA model, the DINO model, the NIDA model, the G-NIDA model, and the R-RUM model. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14.2), BB</td>
</tr>
<tr>
<td>Imports:</td>
<td>R.methodsS3</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2.1)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-15 16:40:30 UTC; Isabelle</td>
</tr>
<tr>
<td>Author:</td>
<td>Yi Zheng [aut, cre],
  Chia-Yi Chiu [aut],
  Jeffrey A. Douglas [ctb]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-15 17:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='NPCD-package'>
NPCD: The <span class="rlang"><b>R</b></span> Package for Nonparametric Methods for Cognitive Diagnosis
</h2><span id='topic+NPCD-package'></span>

<h3>Description</h3>

<p>This package implements an array of nonparametric and parametric estimation methods for cognitive diagnostic models, including nonparametric classification of examinee attribute profiles, joint maximum likelihood estimation (JMLE) of examinee attribute profiles and item parameters, and nonparametric refinement of the Q-matrix, as well as conditional maximum likelihood estimation (CMLE) of examinee attribute profiles given item parameters and CMLE of item parameters given examinee attribute profiles.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> <code>NPCD</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 1.0-11</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2019-11-15</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> <abbr><span class="acronym">LGPL</span></abbr> (&gt;= 2.1)</td>
</tr>
<tr>
 <td style="text-align: left;">
    Depends: </td><td style="text-align: left;"> R (&gt;= 2.14.2), BB, R.oo
  </td>
</tr>

</table>

<p>Cognitive diagnostic models (CDM) are a group of latent class models specialized for cognitive diagnosis in educational testing. Based on the responses to the items in a test, CDMs classify each examinee into mastery or non-mastery on each of a few attributes, producing an &quot;attribute profile&quot; for the examinee. For different tests, the attributes can represent different constructs (e.g., skills, traits, strategies). An attribute profile can provide helpful diagnostic information of the examinee regarding the targeted constructs. Some examples of CDMs include the deterministic inputs, noisy &quot;AND&quot; gate (DINA) model (Junker &amp; Sijtsma, 2001), the Deterministic Input, Noisy Output &quot;OR&quot; gate (DINO) model (Templin &amp; Henson, 2006), the NIDA model (Maris, 1999), the reduced reparametrized unified model (R-RUM) (Hartz, Roussos, Henson, &amp; Templin, 2005), the log-linear CDM (Hen son, Templin, &amp; Willse, 2009), the general diagnostic model (GDM) (Davier, 2010), and the generalized DINA model (G-DINA) (de la Torre, 2011).
</p>
<p>Despite the different ways to model the relationship between examinees' attribute profiles and their answers to test items, most of the existing CDMs make use of a so-called Q-matrix (Tatsuoka, 1985), which specifies which attributes are required by each item. The Q-matrix and the examinee attribute profile together produce the ideal response pattern to the items by an examinee. However, the real response pattern may not be exactly the same with the ideal response pattern due to other factors. Therefore, CDMs incorporate stochastic elements to account for random deviations from the ideal response pattern. For an acceptable model fit, the stochastic terms should allow some departure from the ideal response pattern, but not so much that the model becomes doubtful. And in such nice conditions, despite the distinctive stochastic terms and assumptions of different CDMs, according to the likelihood functions, the ideal response pattern should still be the most likely one among all possible response patterns. Therefore, classification of examinee attribute profiles based on the ideal response patterns can be effective without fitting the parametric models. Chiu and Douglas (2013) proposed a few nonparametric classification methods based on this idea. This <span class="rlang"><b>R</b></span> package NPCD was built to carry out a group of methods that are all based on the above-mentioned nonparametric classification idea, including (1) the nonparametric classification methods proposed in Chiu and Douglas (2013), (2) a joint maximum likelihood estimation (JMLE) approach that utilizes the nonparametric classification methods to give good initial classifications of examinee attribute profiles and then estimates model-based attribute profiles and item parameters simultaneously, and (3) a nonparametric approach to refine the Q-matrix based on the residual sum of squares (RSS) criterion (Chiu, 2013).
</p>
<p>Joint maximum likelihood estimation (JMLE) is a parameteric approach to fit a CDM to response data and estimate both the item parameters and examinee attribute profiles. Two other common methods are the expectation maximization (EM) algorithm and the Markov chain Monte Carlo (MCMC) technique. Despite JMLE's attractive advantages of mathematical simplicity and computational rapidity especially for more complex models, so far JMLE has not been successfully implemented for CDMs due to the potential inconsistency resulted from arbitrary initial values. In this package, we try to overcome this limitation by taking the classification results obtained from the nonparametric classification methods (Chiu &amp; Douglas, 2013) as the initial values. Simulation results have shown JMLE is efficient and accurate for the models incorporated in this package.
</p>
<p>In most practices, the Q-matrix of a test is constructed from the judgments of content experts. The misspecification of the Q-matrix can impair the estimation of the model parameters as well as classification of examinee attribute profiles. This package implements the Q-matrix refinement method developed by Chiu (2013), which is also based on the aforementioned nonparametric classification methods (Chiu &amp; Douglas, 2013). This Q-matrix refinement method corrects potential misspecified entries of the Q-matrix through comparisons of the residual sum of squares computed from the observed and the ideal item responses. Interested users can refer to Chiu (2013) for more details.
</p>
<p>The aim of the NPCD package is to provide an easy-to-use tool to analyze cognitive diagnostic test data using the aforementioned nonparametric methods as well as a few model-based methods for some CDMs. Currently the nonparametric methods in the package support both conjunctive and disjunctive models, and the parametric methods in the package support the DINA model, the DINO model, the NIDA model, the G-NIDA model, and the R-RUM model. Note that the G-NIDA model and the R-RUM model are equivalent based on reparametrization; nevertheless, we think it may still provide some convenicence to the users to include both of them us an option. The package also contains demonstrative data generated from some of these models. Besides the numeric outputs, the package also provides diagnostic plots for users to look inside the algorithms. 
</p>


<h3>Author(s)</h3>

<p>Yi Zheng (Arizona State University) and Chia-Yi Chiu (Rutgers, the State University of New Jersey)
</p>
<p>Maintainer: Yi Zheng &lt;yi.isabel.zheng@asu.edu&gt;
</p>


<h3>References</h3>

<p>Chen, J. de la Torre, J., &amp; Zhang, Z. (2013). Relative and absolute fit evaluation in cognitive diagnosis modeling. <em>Journal of Educational Measurement, 50</em>, 123-140.
</p>
<p>Chiu, C. Y. (2011). <em>Flexible approaches to cognitive diagnosis: nonparametric methods and small sample techniques</em>. Invited session of cognitive diagnosis and item response theory at 2011 Joint Statistical Meeting.
</p>
<p>Chiu, C. Y., &amp; Douglas, J. A. (2013). A nonparametric approach to cognitive diagnosis by proximity to ideal response patterns. <em>Journal of Classification 30</em>(2), 225-250.
</p>
<p>Chiu, C. Y. (2013). Statistical Refinement of the Q-matrix in Cognitive Diagnosis. <em>Applied Psychological Measurement, 37</em>(8), 598-618. 
</p>
<p>Davier, M. (2010). A General Diagnostic Model Applied to Language Testing Data. <em>British Journal of Mathematical and Statistical Psychology, 61</em>(2), 287-307.
</p>
<p>de la Torre, J. (2011). The Generalized DINA Model Framework. <em>Psychometrika, 76</em>(2), 179-199.
</p>
<p>Hartz, S., Roussos, L., Henson, R., &amp; Templin, J. (2005). The Fusion Model for Skill Diagnosis: Blending Theory with Practicality. <em>Unpublished Manuscript</em>.
</p>
<p>Henson, R.A., Templin, J.L., &amp; Willse, J.T. (2009). Defining a Family of Cognitive Diagnosis Models Using Log-Linear Models with Latent Variables. <em>Psychometrika, 74</em>(2), 191-210.
</p>
<p>Junker, B., Sijtsma, K. (2001). Cognitive Assessment Models with Few Assumptions, and Connections with Nonparametric Item Response Theory. <em>Applied Psychological Measurement, 25</em>(3), 258-272.
</p>
<p>Maris, E. (1999). Estimating Multiple Classification Latent Class Models. <em>Psychometrika, 64</em>(2), 187-212.
</p>
<p>Tatsuoka, K. K. (1985). A probabilistic model for diagnosing misconceptions by the pattern classification approach. <em>Journal of Educational and Behavioral Statistics, 10</em>, 55-73.
</p>
<p>Templin, J.L,, Henson, R.A. (2006). Measurement of Psychological Disorders Using Cognitive Diagnosis Models. <em>Psychological Methods, 11</em>(3), 287-305.
</p>

<hr>
<h2 id='AlphaMLE'>Maximum likelihood estimation of attribute profile</h2><span id='topic+AlphaMLE'></span>

<h3>Description</h3>

<p>This function returns the model-based Maximum likelihood estimator(s) of the cognitive diagnostic attribute profile(s). Currently supported cognitive diagnostic models include the DINA, DINO, NIDA, GNIDA, and R-RUM models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AlphaMLE(Y, Q, par, model = c("DINA", "DINO", "NIDA", "GNIDA", "RRUM"),
undefined.flag = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AlphaMLE_+3A_y">Y</code></td>
<td>
<p>A matrix of binary responses. Rows represent persons and columns represent items. 1=correct, 0=incorrect.
</p>
</td></tr>
<tr><td><code id="AlphaMLE_+3A_q">Q</code></td>
<td>
<p>The Q-matrix of the test. Rows represent items and columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item.
</p>
</td></tr>
<tr><td><code id="AlphaMLE_+3A_par">par</code></td>
<td>
<p>A list of parameters.                                            
DINA &amp; DINO &mdash; <code>par$slip</code>: a vector of slipping parameters for each item;       
<code>par$guess</code>: a vector of guessing parameters for each item.  
NIDA &mdash; <code>par$slip</code>: a vector of slipping parameters for each attribute; 
<code>par$guess</code>: a vector of guessing parameters for each attribute.
GNIDA &mdash; <code>par$slip</code>: a matrix (items by attributes) of slipping parameters; 
<code>par$guess</code>: a matrix (items by attributes) of guessing parameters.
RRUM &mdash; <code>par$pi</code>: a vector of pi parameters for each item;
<code>par$r</code>: a matrix (items by attributes) of r parameters.                   
</p>
</td></tr>
<tr><td><code id="AlphaMLE_+3A_model">model</code></td>
<td>
<p>Currently supports five models: <code>"DINA"</code>, <code>"DINO"</code>, <code>"NIDA"</code>, <code>"GNIDA"</code>, and <code>"RRUM"</code>. The default is <code>"DINA"</code>.
</p>
</td></tr>
<tr><td><code id="AlphaMLE_+3A_undefined.flag">undefined.flag</code></td>
<td>
<p>A binary vector indicating whether the parameters of each item are undefined. 1=undefined, 0=defined.  Generally, this argument is only needed in <code>"JMLE"</code> for the DINA and DINO models, where the data may generate undefined item parameters for some items.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha.est</code></td>
<td>
<p>A matrix of estimated attribute profiles for all examinees. Rows represent persons and columns represent attributes. 1=examinee masters the attribute, 0=examinee does not master the attribute.</p>
</td></tr>
<tr><td><code>est.class</code></td>
<td>
<p>The class number (row index in <code>pattern</code>) for each person's attribute profile. It can also be used for locating the log-likelihood value in <code>loglike.matrix</code> for the estimated attribute profile for each person.</p>
</td></tr>
<tr><td><code>n.tie</code></td>
<td>
<p>Number of ties in the log-likelihood among the candidate attribute profiles for each person. When we encounter ties, one of the tied attribute profiles is randomly chosen.</p>
</td></tr>
<tr><td><code>class.tie</code></td>
<td>
<p>The class numbers (row index in <code>pattern</code>) of the tied patterns for each person.</p>
</td></tr>
<tr><td><code>pattern</code></td>
<td>
<p>All possible attribute profiles in the search space.</p>
</td></tr>
<tr><td><code>loglike.matrix</code></td>
<td>
<p>The matrix of the log-likelihood function values. Rows represent candidate attribute profiles in the same order with the pattern matrix; columns represent different examinees.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>, <code><a href="#topic+print.AlphaMLE">print.AlphaMLE</a></code>, <code><a href="#topic+plot.AlphaMLE">plot.AlphaMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate item and examinee profiles

natt &lt;- 3
nitem &lt;- 4
nperson &lt;- 5
Q &lt;- rbind(c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), c(1, 1, 1))
alpha &lt;- rbind(c(0, 0, 0), c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), c(1, 1, 1))

# Generate DINA model-based response data

slip &lt;- c(0.1, 0.15, 0.2, 0.25)
guess &lt;- c(0.1, 0.15, 0.2, 0.25)
my.par &lt;- list(slip=slip, guess=guess)

data &lt;- matrix(NA, nperson, nitem)
eta &lt;- matrix(NA, nperson, nitem)

for (i in 1:nperson) {
  for (j in 1:nitem) {
  eta[i, j] &lt;- prod(alpha[i,] ^ Q[j, ])
  P &lt;- (1 - slip[j]) ^ eta[i, j] * guess[j] ^ (1 - eta[i, j])
  u &lt;- runif(1)
  data[i, j] &lt;- as.numeric(u &lt; P)
  }
}

# Using the function to estimate examinee attribute profile

alpha.est.MLE &lt;- AlphaMLE(data, Q, my.par, model="DINA", undefined.flag=NULL)

nperson &lt;- 1   # Choose an examinee to investigate
print(alpha.est.MLE)   # Print the estimated examinee attribute profiles
plot(alpha.est.MLE, nperson)   # Plot the sorted log-likelihood function 
#of different attribute profiles for this examinee
ItemFit(alpha.est.MLE)
</code></pre>

<hr>
<h2 id='AlphaNP'>Nonparametric estimation of attribute profiles</h2><span id='topic+AlphaNP'></span>

<h3>Description</h3>

<p>This function estimates attribute profiles using nonparametric approaches for both the &quot;AND gate&quot; (conjunctive) and the &quot;OR gate&quot; (disjunctive) cognitive diagnostic models. These algorithms select the attribute profile with the smallest loss function value (plain, weighted, or penalized Hamming distance, see below for details) as the estimate. If more than one attribute profiles have the smallest loss function value, one of them is randomly chosen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AlphaNP(Y, Q, gate = c("AND", "OR"), method = c("Hamming", "Weighted", 
"Penalized"), wg = 1, ws = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AlphaNP_+3A_y">Y</code></td>
<td>
<p>A matrix of binary responses. Rows represent persons and columns represent items. 1=correct, 0=incorrect.
</p>
</td></tr>
<tr><td><code id="AlphaNP_+3A_q">Q</code></td>
<td>
<p>The Q-matrix of the test. Rows represent items and columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item.
</p>
</td></tr>
<tr><td><code id="AlphaNP_+3A_gate">gate</code></td>
<td>
<p><code>"AND"</code>: the examinee needs to possess all required attributes of an item in order to answer it correctly; <code>"OR"</code>: the examinee needs to possess only one of the required attributes of an item in order to answer it correctly.
</p>
</td></tr>
<tr><td><code id="AlphaNP_+3A_method">method</code></td>
<td>
<p>The method of nonparametric estimation. <code>"Hamming"</code>: the plain Hamming distance method; <code>"Weighted"</code>: the Hamming distance weighted by inversed item variance; <code>"Penalized"</code>: the Hamming distance weighted by inversed item variance and specified penalizing weights for guess and slip.
</p>
</td></tr>
<tr><td><code id="AlphaNP_+3A_wg">wg</code></td>
<td>
<p>Additional argument for the &quot;penalized&quot; method. <code>wg</code> is the weight assigned to guessing in the DINA or DINO models. A large value of <code>wg</code> results in a stronger impact on Hamming distance (larger loss function values) caused by guessing.
</p>
</td></tr>
<tr><td><code id="AlphaNP_+3A_ws">ws</code></td>
<td>
<p>Additional input for the &quot;penalized&quot; method. <code>ws</code> is the weight assigned to slipping in the DINA or DINO models. A large value of <code>ws</code> results in la stronger impact on Hamming distance (larger loss function values) caused by slipping.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha.est</code></td>
<td>
<p>Estimated attribute profiles. Rows represent persons and columns represent attributes. 1=examinee masters the attribute, 0=examinee does not master the attribute.</p>
</td></tr>
<tr><td><code>est.ideal</code></td>
<td>
<p>Estimated ideal response to all items by all examinees. Rows represent persons and columns represent items. 1=correct, 0=incorrect.</p>
</td></tr>
<tr><td><code>est.class</code></td>
<td>
<p>The class number (row index in <code>pattern</code>) for each person's attribute profile. It can also be used for locating the loss function value in <code>loss.matrix</code> for the estimated attribute profile for each person.</p>
</td></tr>
<tr><td><code>n.tie</code></td>
<td>
<p>Number of ties in the Hamming distance among the candidate attribute profiles for each person. When we encounter ties, one of the tied attribute profiles is randomly chosen.</p>
</td></tr>
<tr><td><code>pattern</code></td>
<td>
<p>All possible attribute profiles in the search space.</p>
</td></tr>
<tr><td><code>loss.matrix</code></td>
<td>
<p>The matrix of the values for the loss function (the plain, weighted, or penalized Hamming distance). Rows represent candidate attribute profiles in the same order with the pattern matrix; columns represent different examinees.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chiu, C. (2011). <em>Flexible approaches to cognitive diagnosis: nonparametric methods and small sample techniques</em>. Invited session of cognitive diagnosis and item response theory at 2011 Joint Statistical Meeting.
</p>
<p>Chiu, C. Y., &amp; Douglas, J. A. (2013). A nonparametric approach to cognitive diagnosis by proximity
to ideal response patterns. <em>Journal of Classification 30</em>(2), 225-250.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>, <code><a href="#topic+print.AlphaNP">print.AlphaNP</a></code>, <code><a href="#topic+plot.AlphaNP">plot.AlphaNP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate item and examinee profiles

natt &lt;- 3
nitem &lt;- 4
nperson &lt;- 5
Q &lt;- rbind(c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), c(1, 1, 1))
alpha &lt;- rbind(c(0, 0, 0), c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), c(1, 1, 1))

# Generate DINA model-based response data

slip &lt;- c(0.1, 0.15, 0.2, 0.25)
guess &lt;- c(0.1, 0.15, 0.2, 0.25)
my.par &lt;- list(slip=slip, guess=guess)

data &lt;- matrix(NA, nperson, nitem)
eta &lt;- matrix(NA, nperson, nitem)

for (i in 1:nperson) {
  for (j in 1:nitem) {
  eta[i, j] &lt;- prod(alpha[i,] ^ Q[j, ])
  P &lt;- (1 - slip[j]) ^ eta[i, j] * guess[j] ^ (1 - eta[i, j])
  u &lt;- runif(1)
  data[i, j] &lt;- as.numeric(u &lt; P)
  }
}

# Using the function to estimate examinee attribute profile

alpha.est.NP.H &lt;- AlphaNP(data, Q, gate="AND", method="Hamming")
alpha.est.NP.W &lt;- AlphaNP(data, Q, gate="AND", method="Weighted")
alpha.est.NP.P &lt;- AlphaNP(data, Q, gate="AND", method="Penalized", wg=2, ws=1)

nperson &lt;- 1   # Choose an examinee to investigate
print(alpha.est.NP.H) # Print the estimated examinee attribute profiles
plot(alpha.est.NP.H, nperson)   # Plot the sorted loss function of different 
#attribute profiles for this examinee
ItemFit(alpha.est.NP.H, model="DINA", par=list(slip=slip, guess=guess))
ItemFit(alpha.est.NP.W, model="DINA", par=list(slip=slip, guess=guess))
ItemFit(alpha.est.NP.P, model="DINA", par=list(slip=slip, guess=guess))
</code></pre>

<hr>
<h2 id='CDL'>Log-likelihood for cognitive diagnostic models</h2><span id='topic+CDL'></span>

<h3>Description</h3>

<p>This function returns the log-likelihood of a particular examinee's responses to a set of cognitive diagnostic items. Currently supported cognitive diagnostic models include the DINA model, DINO model, NIDA model, G-NIDA model, and R-RUM model. This function is called by the <code>AlphaMLE</code> function and the <code>JMLE</code> function in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDL(Y, Q, par, alpha, model = c("DINA", "DINO", "NIDA", "GNIDA", "RRUM"), 
undefined.flag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CDL_+3A_y">Y</code></td>
<td>
<p>A vector of binary examinee responses. 1=correct, 0=incorrect.
</p>
</td></tr>
<tr><td><code id="CDL_+3A_q">Q</code></td>
<td>
<p>The Q-matrix of the test. Rows represent items and columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item. 
</p>
</td></tr>
<tr><td><code id="CDL_+3A_par">par</code></td>
<td>
<p>A list of parameters.                                            
DINA &amp; DINO &mdash; <code>par$slip</code>: a vector of slipping parameters for each item;       
<code>par$guess</code>: a vector of guessing parameters for each item.  
NIDA &mdash; <code>par$slip</code>: a vector of slipping parameters for each attribute; 
<code>par$guess</code>: a vector of guessing parameters for each attribute.
GNIDA &mdash; <code>par$slip</code>: a matrix (items by attributes) of slipping parameters; 
<code>par$guess</code>: a matrix (items by attributes) of guessing parameters.
RRUM &mdash; <code>par$pi</code>: a vector of pi parameters for each item;
<code>par$r</code>: a matrix (items by attributes) of r parameters.  
</p>
</td></tr>
<tr><td><code id="CDL_+3A_alpha">alpha</code></td>
<td>
<p>A vector of examinee ability profile. 1=examinee masters the attribute, 0=examinee does not master the attribute.
</p>
</td></tr>
<tr><td><code id="CDL_+3A_model">model</code></td>
<td>
<p>Currently supports five models: <code>"DINA"</code>, <code>"DINO"</code>, <code>"NIDA"</code>, <code>"GNIDA"</code>, and <code>"RRUM"</code>. The default is <code>"DINA"</code>.
</p>
</td></tr>
<tr><td><code id="CDL_+3A_undefined.flag">undefined.flag</code></td>
<td>
<p>A binary vector indicating whether the parameters of each item are undefined. 1=undefined, 0=defined.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>loglike</code></td>
<td>
<p>The log likelihood function value for the given data.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate item and examinee profiles

nitem &lt;- 4
Q &lt;- rbind(c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), c(1, 1, 1))
alpha &lt;- c(1, 0, 0)

# Generate DINA model-based response data

slip &lt;- rep(0.1, nitem)
guess &lt;- rep(0.1, nitem)
my.par &lt;- list(slip=slip, guess=guess)

data &lt;- NA
eta &lt;- NA

for (i in 1:nitem) {
  eta[i] &lt;- prod(alpha ^ Q[i, ])
  P &lt;- (1 - slip[i]) ^ eta[i] * guess[i] ^ (1 - eta[i])
  u &lt;- runif(1)
  data[i] &lt;- as.numeric(u &lt; P)
}

# Using the function to compute the log-likelihood of the given data

CDL(data, Q, my.par, alpha, model="DINA", undefined.flag=rep(0, nitem))
</code></pre>

<hr>
<h2 id='CDP'>Probability of correct response for cognitive diagnostic models</h2><span id='topic+CDP'></span>

<h3>Description</h3>

<p>This function returns the model-predicted probability of correct response of one item for one person given the item parameters, Q vector, and alpha vector. Currently supported cognitive diagnostic models include the DINA model, DINO model, NIDA model, G-NIDA model, and R-RUM model. This function is called by the <code>ItemFit</code> function in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDP(Q, par, alpha, model = c("DINA", "DINO", "NIDA", "GNIDA", "RRUM"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CDP_+3A_q">Q</code></td>
<td>
<p>The Q-vector of the item. Columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item. 
</p>
</td></tr>
<tr><td><code id="CDP_+3A_par">par</code></td>
<td>
<p>A list of parameters.                                            
DINA &amp; DINO &mdash; <code>par$slip</code>: a scaler slip parameter for the item;       
<code>par$guess</code>: a scaler guessing parameter for the item.  
NIDA &mdash; <code>par$slip</code>: a vector of slip parameters for each attribute; 
<code>par$guess</code>: a vector of guessing parameters for each attribute.
GNIDA &mdash; <code>par$slip</code>: a vector of slip parameters for each attribute for the item; 
<code>par$guess</code>: a vector of guessing parameters for each attribute for the item.
RRUM &mdash; <code>par$pi</code>: a scaler pi parameter for the item;
<code>par$r</code>: a vector of r parameters for each attribute for the item.  
</p>
</td></tr>
<tr><td><code id="CDP_+3A_alpha">alpha</code></td>
<td>
<p>A vector of examinee ability profile. 1=examinee masters the attribute, 0=examinee does not master the attribute.
</p>
</td></tr>
<tr><td><code id="CDP_+3A_model">model</code></td>
<td>
<p>Currently supports five models: <code>"DINA"</code>, <code>"DINO"</code>, <code>"NIDA"</code>, <code>"GNIDA"</code>, and <code>"RRUM"</code>. The default is <code>"DINA"</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>P</code></td>
<td>
<p>The probability of correct response for the item by the person.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate item and examinee profiles

Q &lt;- c(1, 0, 0)
alpha &lt;- c(1, 0, 0)
slip &lt;- 0.2
guess &lt;- 0.1
my.par &lt;- list(slip=slip, guess=guess)
CDP(Q, my.par, alpha, model="DINA")
</code></pre>

<hr>
<h2 id='Data.DINA'>Example dataset generated using DINA model</h2><span id='topic+Data.DINA'></span>

<h3>Description</h3>

<p>This dataset is a <code>list</code> containing components generated using DINA model, which can be used to test out the estimation functions in the package.
</p>
<p><code>$Q</code>: The Q matrix. Numerical, 20 (item) by 3 (attribute). Binary values: 1=attribute required by the item, 0=attribute not required by the item.
</p>
<p><code>$response</code>: The examinee responses to all items. Numerical, 300 (examinee) by 20 (item). Binary values: 1=correct, 0=incorrect.
</p>
<p><code>$true.alpha</code>: The true examinee ability profiles. Numerical, 300 (examinee) by 3 (attribute). Binary values: 1=examinee masters the attribute, 0=examinee does not master the attribute.
</p>
<p><code>$true.par$slip</code>: The true slipping parameters for each item. Numerical, vector of 20.
</p>
<p><code>$true.par$guess</code>: The true guessing parameters for each item. Numerical, vector of 20.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Data.DINA)</code></pre>


<h3>Format</h3>

<p>The format is: List of 4 elements.</p>

<hr>
<h2 id='Data.DINO'>Example dataset generated using DINO model</h2><span id='topic+Data.DINO'></span>

<h3>Description</h3>

<p>This dataset is a <code>list</code> containing components generated using DINO model, which can be used to test out the estimation functions in the package.
</p>
<p><code>$Q</code>: The Q matrix. Numerical, 20 (item) by 3 (attribute). Binary values: 1=attribute required by the item, 0=attribute not required by the item.
</p>
<p><code>$response</code>: The examinee responses to all items. Numerical, 300 (examinee) by 20 (item). Binary values: 1=correct, 0=incorrect.
</p>
<p><code>$true.alpha</code>: The true examinee ability profiles. Numerical, 300 (examinee) by 3 (attribute). Binary values: 1=examinee masters the attribute, 0=examinee does not master the attribute.
</p>
<p><code>$true.par$slip</code>: The true slipping parameters for each item. Numerical, vector of 20.
</p>
<p><code>$true.par$guess</code>: The true guessing parameters for each item. Numerical, vector of 20.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Data.DINO)</code></pre>


<h3>Format</h3>

<p>The format is: List of 4 elements.</p>

<hr>
<h2 id='Data.Qrefine'>Example dataset used for the <code>Qrefine</code> function</h2><span id='topic+Data.Qrefine'></span>

<h3>Description</h3>

<p>This dataset is a <code>list</code> containing components that can be used for the <code>Qrefine</code> function. The response marix is generated using the DINA model.
</p>
<p><code>$mis.Q</code>: The mis-specified Q matrix. Numerical, 20 (item) by 3 (attribute). Binary values: 1=attribute required by the item, 0=attribute not required by the item.
</p>
<p><code>$true.Q</code>: The true Q-matrix. Numerical, 20 (item) by 3 (attribute). Binary values: 1=attribute required by the item, 0=attribute not required by the item.
</p>
<p><code>$response</code>: The examinee responses to all items, generated using the true Q-matrix. Numerical, 300 (examinee) by 20 (item). Binary values: 1=correct, 0=incorrect.
</p>
<p><code>$true.alpha</code>: The true examinee ability profiles. Numerical, 300 (examinee) by 3 (attribute). Binary values: 1=examinee masters the attribute, 0=examinee does not master the attribute.
</p>
<p><code>$true.par$slip</code>: The true slipping parameters for each item. Numerical, vector of 20.
</p>
<p><code>$true.par$guess</code>: The true guessing parameters for each item. Numerical, vector of 20.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Data.Qrefine)</code></pre>


<h3>Format</h3>

<p>The format is: List of 5 elements.</p>

<hr>
<h2 id='ItemFit'>Compute item fit statistics for outputs generated by estimation functions in the package</h2><span id='topic+ItemFit'></span>

<h3>Description</h3>

<p>This function computes item fit statistics for outputs generated by estimation functions in the package, including <code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+ParMLE">ParMLE</a></code>, and<code><a href="#topic+JMLE">JMLE</a></code>. The function currently provides the RMSEA and Chi-square item fit statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ItemFit(x, model=NULL, par=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ItemFit_+3A_x">x</code></td>
<td>
<p>The output from the function (The list of all outputs).</p>
</td></tr>
<tr><td><code id="ItemFit_+3A_model">model</code></td>
<td>
<p>This needs to be additionally specified only when <code>x</code> is output from <code>AlphaNP</code>. Currently support five models: <code>"DINA"</code>, <code>"DINO"</code>, <code>"NIDA"</code>, <code>"GNIDA"</code>, and <code>"RRUM"</code>. 
</p>
</td></tr>
<tr><td><code id="ItemFit_+3A_par">par</code></td>
<td>
<p>This needs to be additionally specified only when <code>x</code> is output from <code>AlphaNP</code>. A list of parameters.                                            
DINA &amp; DINO &mdash; <code>par$slip</code>: a vector of slipping parameters for each item;       
<code>par$guess</code>: a vector of guessing parameters for each item.  
NIDA &mdash; <code>par$slip</code>: a vector of slipping parameters for each attribute; 
<code>par$guess</code>: a vector of guessing parameters for each attribute.
GNIDA &mdash; <code>par$slip</code>: a matrix (items by attributes) of slipping parameters; 
<code>par$guess</code>: a matrix (items by attributes) of guessing parameters.
RRUM &mdash; <code>par$pi</code>: a vector of pi parameters for each item;
<code>par$r</code>: a matrix (items by attributes) of r parameters.                   
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>RMSEA</code></td>
<td>
<p>The model-based root mean square error of approximation (Kunina-Habenicht et al., 2012) of each item based on the estimated or given item parameter, Q-vector, and alpha matrix.</p>
</td></tr>
<tr><td><code>Chisq</code></td>
<td>
<p>The Q1 Chi-square statistic (Wang et al., 2015; Yen, 1981) of each item based on the estimated or given item parameter, Q-vector, and alpha matrix.</p>
</td></tr>
<tr><td><code>Chisq.p</code></td>
<td>
<p>The p-values for the Chi-square statistic for each item.</p>
</td></tr>
<tr><td><code>Chisq.df</code></td>
<td>
<p>The degrees of freedom for the Chi-square statistic for each item.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kunina-Habenicht, O., Rupp, A. A., &amp; Wilhelm, O. (2012). The Impact of Model Misspecification on Parameter Estimation and Item-Fit Assessment in Log0Linear Diagnostic Classification Models. <em>Journal of Educational Measurement, 49</em>(1), 59-81.
</p>
<p>Wang, C., Shu, Z., Shagn, Z., &amp; Xu, G. (2015). Assessing Item-Level Fit for the DINA Model. <em>Applied Psychological Measurement</em>, 1-14.
</p>
<p>Yen, W. M. (1981). Using Simulation Results to Choose a Latent Trait Model. <em>Applied Psychological Measurement, 5</em>, 245-262.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+ParMLE">ParMLE</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in AlphaNP, AlphaMLE, ParMLE, and JMLE.
</code></pre>

<hr>
<h2 id='JMLE'>Joint maximum likelihood estimation of item parameters and examinee attribute profiles</h2><span id='topic+JMLE'></span>

<h3>Description</h3>

<p>This function returns joint maximum likelihood estimates of item parameters and examinee attribute profiles in cognitive diagnostic models. The algorithm starts from the nonparametric estimation of attribute profiles, implemented by the <code>AlphaNP</code> function, and then iteratively estimates item parameters and attribute profiles using conditional maximum likelihood estimation until the algorithm converges. Currently supported models include the DINA model, the DINO model, he NIDA model, the G-NIDA model, and the R-RUM model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>JMLE(Y, Q, model = c("DINA", "DINO", "NIDA", "GNIDA", "RRUM"), 
NP.method = c("Weighted", "Hamming", "Penalized"), wg=1, ws=1, 
conv.crit.par = 0.001, conv.crit.att = 0.01, max.ite = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JMLE_+3A_y">Y</code></td>
<td>
<p>A matrix of binary responses. Rows represent persons and columns represent items. 1=correct, 0=incorrect.
</p>
</td></tr>
<tr><td><code id="JMLE_+3A_q">Q</code></td>
<td>
<p>The Q-matrix of the test. Rows represent items and columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item.
</p>
</td></tr>
<tr><td><code id="JMLE_+3A_model">model</code></td>
<td>
<p>Currently support five models: <code>"DINA"</code>, <code>"DINO"</code>, <code>"NIDA"</code>, <code>"GNIDA"</code>, and <code>"RRUM"</code>. The default is <code>"DINA"</code>.
</p>
</td></tr>
<tr><td><code id="JMLE_+3A_np.method">NP.method</code></td>
<td>
<p>The method of the nonparametric estimation in the initial stage. <code>"Hamming"</code>: the plain Hamming distance method; <code>"Weighted"</code>: the Hamming distance weighted by inversed item variance; <code>"Penalized"</code>: the Hamming distance weighted by inversed item variance and specified penalizing weights for guess and slip. The default is <code>"Weighted"</code>.
</p>
</td></tr>
<tr><td><code id="JMLE_+3A_wg">wg</code></td>
<td>
<p>Additional argument for the &quot;penalized&quot; NP.method. <code>wg</code> is the weight assigned to guessing in the DINA or DINO models. A large value of <code>wg</code> results in a stronger impact on Hamming distance (larger loss function values) caused by guessing.
</p>
</td></tr>
<tr><td><code id="JMLE_+3A_ws">ws</code></td>
<td>
<p>Additional input for the &quot;penalized&quot; NP.method. <code>ws</code> is the weight assigned to slipping in the DINA or DINO models. A large value of <code>ws</code> results in la stronger impact on Hamming distance (larger loss function values) caused by slipping.
</p>
</td></tr>
<tr><td><code id="JMLE_+3A_conv.crit.par">conv.crit.par</code></td>
<td>
<p>The critical value for the maximum absolute change in all item parameters values to determine convergence.
</p>
</td></tr>
<tr><td><code id="JMLE_+3A_conv.crit.att">conv.crit.att</code></td>
<td>
<p>The critical value for the percentage of examinee attribute profiles that are changed to determine convergence.
</p>
</td></tr>
<tr><td><code id="JMLE_+3A_max.ite">max.ite</code></td>
<td>
<p>The maximum number of iterations allowed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha.est</code></td>
<td>
<p>JMLE estimates of examinee attribute profiles. Rows represent persons and columns represent attributes. 1=examinee masters the attribute, 0=examinee does not master the attribute.</p>
</td></tr>
<tr><td><code>par.est</code></td>
<td>
<p>JMLE estimates of item parameters, including <code>par.est$slip</code>, <code>par.est$guess</code>, <code>par.est$se.slip</code>, and <code>par.est$se.guess</code> for the DINA, DINO, NIDA, and GNIDA models, and <code>par.est$pi</code>, <code>par.est$r</code>, <code>par.est$se.pi</code> and <code>par.est$se.r</code> for the R-RUM model. Note that for the G-NIDA model and the R-RUM model, the item parameter estimates and standard errors are not available for the entries where the Q-matrix is 0.</p>
</td></tr>
<tr><td><code>n.tie</code></td>
<td>
<p>Number of ties in the final log-likelihood among the candidate attribute profiles for each person. When we encounter ties, one of the tied attribute profiles is randomly chosen.</p>
</td></tr>
<tr><td><code>undefined.flag</code></td>
<td>
<p>A binary vector indicating whether the parameters of each item are undefined. 1=undefined, 0=defined.</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>The final overall log-likelihood value from the estimated item parameters and attribute profiles based on the specified model.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>A message on whether the algorithm converged.</p>
</td></tr>
<tr><td><code>n.ite</code></td>
<td>
<p>Number of iterations performed.</p>
</td></tr>
<tr><td><code>loglike.matrix</code></td>
<td>
<p>The values for the log-likelihood function in the last iteration for each candidate attribute profile by each person. Rows represent candidate attribute profiles in the same order with the pattern matrix; columns represent different examinees.</p>
</td></tr>
<tr><td><code>est.class</code></td>
<td>
<p>The final class number (row index in <code>pattern</code>) for each person's attribute profile. It can also be used for locating the log-likelihood value in <code>loglike.matrix</code> for the estimated attribute profile for each person.</p>
</td></tr>
<tr><td><code>NP.loss.matrix</code></td>
<td>
<p>The values for the loss function of the nonparametric estimation of Alpha. Rows represent candidate attribute profiles in the same order with the pattern matrix; columns represent different examinees.</p>
</td></tr>
<tr><td><code>NP.alpha.est</code></td>
<td>
<p>The estimates of examinee attribute profiles from the initial nonparameteric estimation.</p>
</td></tr>
<tr><td><code>NP.est.class</code></td>
<td>
<p>The class number (row index in <code>pattern</code>) for each person's attribute profile from the initial nonparametric classification. It can also be used for locating the loss function value in <code>NP.loss.matrix</code> for the estimated attribute profile for each person.</p>
</td></tr>
<tr><td><code>pattern</code></td>
<td>
<p>All possible attribute profiles in the search space.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>The chosen model.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>The Q-matrix of the test.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chiu, C. (2011). <em>Flexible approaches to cognitive diagnosis: nonparametric methods and small sample techniques</em>. Invited session of cognitive diagnosis and item response theory at 2011 Joint Statistical Meeting.
</p>
<p>Chiu, C. Y., &amp; Douglas, J. A. (2013). A nonparametric approach to cognitive diagnosis by proximity
to ideal response patterns. <em>Journal of Classification 30</em>(2), 225-250.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+ParMLE">ParMLE</a></code>, <code><a href="#topic+print.JMLE">print.JMLE</a></code>,  <code><a href="#topic+plot.JMLE">plot.JMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Data.DINA")
JMLE.result &lt;- JMLE(Data.DINA$response, Data.DINA$Q, model="DINA", conv.crit.par=0.001, 
conv.crit.att=0.001, max.ite=100)
print(JMLE.result)  # Print the estimated item parameters, standard errors, 
#and examinee attribute profiles
plot(JMLE.result, nperson=1)   # Plot the sorted loss function of different 
#attribute profiles for this examinee
ItemFit(JMLE.result)
ModelFit(JMLE.result)
</code></pre>

<hr>
<h2 id='ModelFit'>Compute overall model fit statistics for outputs generated by estimation functions in the package</h2><span id='topic+ModelFit'></span>

<h3>Description</h3>

<p>This function computes overall model fit statistics for outputs generated by estimation functions in the package, including <code><a href="#topic+ParMLE">ParMLE</a></code> and <code><a href="#topic+JMLE">JMLE</a></code>. The function currently provides the AIC and BIC statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModelFit(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModelFit_+3A_x">x</code></td>
<td>
<p>The output from the function (The list of all outputs).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>AIC</code></td>
<td>
<p>The AIC statistic of the overall model. See the reference for details.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>The BIC statistic of the overall model. See the reference for details.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chen, J. de la Torre, J., &amp; Zhang, Z. (2013). Relative and absolute fit evaluation in cognitive diagnosis modeling. <em>Journal of Educational Measurement, 50</em>, 123-140.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ParMLE">ParMLE</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in ParMLE and JMLE.
</code></pre>

<hr>
<h2 id='ParMLE'>Maximum likelihood estimation of item parameters for cognitive diagnostic models.</h2><span id='topic+ParMLE'></span>

<h3>Description</h3>

<p>This function returns maximum likelihood estimates of item parameters for cognitive diagnostic models when examinee ability patterns are known. This function can either be used independently or called in the <code><a href="#topic+JMLE">JMLE</a></code> function. Currently supported cognitive diagnostic models include the DINA model, the DINO model, the NIDA model, the G-NIDA model, and the R-RUM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParMLE(Y, Q, alpha, model = c("DINA", "DINO", "NIDA", "GNIDA", "RRUM"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ParMLE_+3A_y">Y</code></td>
<td>
<p>A matrix of binary responses. Rows represent persons and columns represent items. 1=correct, 0=incorrect.
</p>
</td></tr>
<tr><td><code id="ParMLE_+3A_q">Q</code></td>
<td>
<p>The Q-matrix of the test. Rows represent items and columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item.
</p>
</td></tr>
<tr><td><code id="ParMLE_+3A_alpha">alpha</code></td>
<td>
<p>Examinee attribute profiles. Rows represent persons and columns represent attributes. 1=examinee masters the attribute, 0=examinee does not master the attribute.
</p>
</td></tr>
<tr><td><code id="ParMLE_+3A_model">model</code></td>
<td>
<p>Currently support five models: <code>"DINA"</code>, <code>"DINO"</code>, <code>"NIDA"</code>, <code>"GNIDA"</code>, and <code>"RRUM"</code>. The default is <code>"DINA"</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For the DINA, DINO, and NIDA models:
</p>
<table>
<tr><td><code>slip</code></td>
<td>
<p>a vector of slip parameters.</p>
</td></tr>
<tr><td><code>guess</code></td>
<td>
<p>a vector of guessing parameters.</p>
</td></tr>
<tr><td><code>se.slip</code></td>
<td>
<p>a vector of the standard errors for slip parameters.</p>
</td></tr>
<tr><td><code>se.guess</code></td>
<td>
<p>a vector of the standard errors for guessing parameters.</p>
</td></tr>
</table>
<p>For the G-NIDA model: 
</p>
<table>
<tr><td><code>slip</code></td>
<td>
<p>a matrix (# items by # attributes) of slip parameters.</p>
</td></tr>
<tr><td><code>guess</code></td>
<td>
<p>a matrix (# items by # attributes) of guessing parameters.</p>
</td></tr>
<tr><td><code>se.slip</code></td>
<td>
<p>a matrix (# items by # attributes) of the standard errors for slip parameters.</p>
</td></tr>
<tr><td><code>se.guess</code></td>
<td>
<p>a matrix (# items by # attributes) of the standard errors for guessing parameters.</p>
</td></tr>
</table>
<p>For the R-RUM model:
</p>
<table>
<tr><td><code>pi</code></td>
<td>
<p>a vector of pi parameters for each item.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>a matrix (# items by # attributes) of r parameters.</p>
</td></tr>
<tr><td><code>se.pi</code></td>
<td>
<p>a vector of the standard errors for pi parameters.</p>
</td></tr>
<tr><td><code>se.r</code></td>
<td>
<p>a matrix (# items by # attributes) of the standard errors for r parameters.</p>
</td></tr>
</table>
<p>Note that for the G-NIDA model and the R-RUM model, the item parameter estimates and standard errors are not available for the entries where the Q-matrix is 0.
</p>
<p>Additionally, for all models:
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>The chosen model.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>The Q-matrix of the test.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+JMLE">JMLE</a></code>, <code><a href="#topic+print.ParMLE">print.ParMLE</a></code>  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate item and examinee profiles

natt &lt;- 3
nitem &lt;- 4
nperson &lt;- 5
Q &lt;- rbind(c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), c(1, 1, 1))
alpha &lt;- rbind(c(0, 0, 0), c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), c(1, 1, 1))

# Generate DINA model-based response data

slip &lt;- c(0.1, 0.15, 0.2, 0.25)
guess &lt;- c(0.1, 0.15, 0.2, 0.25)
my.par &lt;- list(slip=slip, guess=guess)

data &lt;- matrix(NA, nperson, nitem)
eta &lt;- matrix(NA, nperson, nitem)

for (i in 1:nperson) {
  for (j in 1:nitem) {
  eta[i, j] &lt;- prod(alpha[i,] ^ Q[j, ])
  P &lt;- (1 - slip[j]) ^ eta[i, j] * guess[j] ^ (1 - eta[i, j])
  u &lt;- runif(1)
  data[i, j] &lt;- as.numeric(u &lt; P)
  }
}

# Using the function to estimate item parameters

parMLE.result &lt;- ParMLE(data, Q, alpha, model="DINA")
print(parMLE.result)  # Print the estimated item parameters and standard errors
ItemFit(parMLE.result)
ModelFit(parMLE.result)
</code></pre>

<hr>
<h2 id='plot.NPCD'>Produce diagnostic plots</h2><span id='topic+plot.AlphaNP'></span><span id='topic+plot.AlphaMLE'></span><span id='topic+plot.JMLE'></span><span id='topic+plot.Qrefine'></span>

<h3>Description</h3>

<p>This function produces diagnostic plots of various outputs generated from the functions in this package, including <code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>, and<code><a href="#topic+Qrefine">Qrefine</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AlphaNP'
plot(x, nperson, cex.main, cex.legend, ...)
## S3 method for class 'AlphaMLE'
plot(x, nperson, cex.main, ...)
## S3 method for class 'JMLE'
plot(x, nperson, cex.main, ...)
## S3 method for class 'Qrefine'
plot(x, filename="Qrefine.plot.png", cex.main,
                 cex.lab, cex.axis, cex.legend, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.NPCD_+3A_x">x</code></td>
<td>
<p>The output from the function (The list of all outputs).</p>
</td></tr>
<tr><td><code id="plot.NPCD_+3A_nperson">nperson</code></td>
<td>
<p>The choice of examinee to be investigated.</p>
</td></tr>
<tr><td><code id="plot.NPCD_+3A_filename">filename</code></td>
<td>
<p>The filename of the plot, ending in &quot;.png&quot;. Directory can be included; otherwise the plot will be saved in the working directory.</p>
</td></tr>
<tr><td><code id="plot.NPCD_+3A_cex.main">cex.main</code></td>
<td>
<p>A numerical value giving the amount by which title text should be magnified relative to the default. This starts as 1 when a device is opened.</p>
</td></tr>
<tr><td><code id="plot.NPCD_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation.</p>
</td></tr>
<tr><td><code id="plot.NPCD_+3A_cex.lab">cex.lab</code></td>
<td>
<p>The magnification to be used for x and y labels.</p>
</td></tr>
<tr><td><code id="plot.NPCD_+3A_cex.legend">cex.legend</code></td>
<td>
<p>The magnification to be used for the legend if there is one.</p>
</td></tr>
<tr><td><code id="plot.NPCD_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>AlphaNP</code></td>
<td>
<p>Bar plot of sorted loss function values (plain, weighted, or penalized Hamming distance) for each candidate attribute profile for the chosen examinee. The bar with the tilted shade is the estimated attribute profile for this examinee, which ideally should have the smallest loss function value.</p>
</td></tr>
<tr><td><code>AlphaMLE</code></td>
<td>
<p>Bar plot of sorted negative log-likelihood function values for each candidate attribute profile for the chosen examinee.The bar with the tilted shade is the estimated attribute profile for this examinee, which ideally should have the smallest value.</p>
</td></tr>
<tr><td><code>JMLE</code></td>
<td>
<p>A pair of barplots. Plot1: Bar plot of unsorted loss function values for each candidate attribute profile for the chosen examinee using the nonparametric estimation; Plot2: bar plot of unsorted negative log-likelihood function values for each candidate attribute profile for the chosen examinee in the last iteration of the JMLE estimation.The bar with the tilted shade is the estimated attribute profile for this examinee by each method, which ideally should have the smallest value.</p>
</td></tr>
<tr><td><code>Qrefine</code></td>
<td>
<p>A panel plot for all items with refined q-vectors. Each subplot shows the unsorted residual sum of squares (RSS) between the real response patterns and the ideal response patterns generated from each possible q-vector. The bar with the sparsely tilted shade is the initial q-vector for this item, and the bar with the densely tilted shade is the refined q-vector for this item, which ideally should have the smallest RSS value.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>, <code><a href="#topic+Qrefine">Qrefine</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in AlphaNP, AlphaMLE, JMLE, and Qrefine.
</code></pre>

<hr>
<h2 id='print.NPCD'>Print outputs generated from the functions in the package.</h2><span id='topic+print.AlphaNP'></span><span id='topic+print.AlphaMLE'></span><span id='topic+print.ParMLE'></span><span id='topic+print.JMLE'></span><span id='topic+print.Qrefine'></span>

<h3>Description</h3>

<p>This function prints outputs generated from the functions in this package, including <code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+ParMLE">ParMLE</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>, and<code><a href="#topic+Qrefine">Qrefine</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AlphaNP'
print(x, ...)
## S3 method for class 'AlphaMLE'
print(x, ...)
## S3 method for class 'ParMLE'
print(x, ...)
## S3 method for class 'JMLE'
print(x, ...)
## S3 method for class 'Qrefine'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.NPCD_+3A_x">x</code></td>
<td>
<p>The output from the function (The list of all outputs).</p>
</td></tr>
<tr><td><code id="print.NPCD_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>AlphaNP</code></td>
<td>
<p>The estimated examinee attribute profiles.</p>
</td></tr>
<tr><td><code>AlphaMLE</code></td>
<td>
<p>The estimated examinee attribute profiles.</p>
</td></tr>
<tr><td><code>ParMLE</code></td>
<td>
<p>The estimated item parameters and standard errors.</p>
</td></tr>
<tr><td><code>JMLE</code></td>
<td>
<p>The estimated item parameters and examinee attribute profiles.</p>
</td></tr>
<tr><td><code>Qrefine</code></td>
<td>
<p>The modified Q-matrix and the modified entries</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+AlphaMLE">AlphaMLE</a></code>, <code><a href="#topic+ParMLE">ParMLE</a></code>, <code><a href="#topic+JMLE">JMLE</a></code>, <code><a href="#topic+Qrefine">Qrefine</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in AlphaNP, AlphaMLE, ParMLE, JMLE, and Qrefine.
</code></pre>

<hr>
<h2 id='Qrefine'>Refine the Q-matrix by minimizing the residual sum of square (RSS)</h2><span id='topic+Qrefine'></span>

<h3>Description</h3>

<p>Refine the Q-matrix by minimizing the residual sum of square (RSS) betweenn the real responses and ideal responses. Examinee attribute profiles are estimated using the nonparametric method (plain Hamming) implemented by <code><a href="#topic+AlphaNP">AlphaNP</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qrefine(Y, Q, gate=c("AND", "OR"), max.ite = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qrefine_+3A_y">Y</code></td>
<td>
<p>A matrix of binary responses. Rows represent persons and columns represent items. 1=correct, 0=incorrect.
</p>
</td></tr>
<tr><td><code id="Qrefine_+3A_q">Q</code></td>
<td>
<p>The Q-matrix of the test. Rows represent items and columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item.
</p>
</td></tr>
<tr><td><code id="Qrefine_+3A_gate">gate</code></td>
<td>
<p><code>"AND"</code>: the examinee needs to possess all attributes required by an item in order to answer it correctly; <code>"OR"</code>: the examinee needs to possess only one of the attributes required by an item in order to answer it correctly.
</p>
</td></tr>
<tr><td><code id="Qrefine_+3A_max.ite">max.ite</code></td>
<td>
<p>The maximum number of iterations allowed.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>patterns</code></td>
<td>
<p>All possible attribute profiles. Rows represent different patterns of attribute profiles and columns represent attributes. 1=examinee masters the attribute, 0=examinee does not master the attribute.</p>
</td></tr>
<tr><td><code>initial.Q</code></td>
<td>
<p>The initial Q-matrix. Rows represent items and columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item. This is the preliminary Q-matrix to be refined.</p>
</td></tr>
<tr><td><code>initial.class</code></td>
<td>
<p>The row indices of <code>patterns</code> in the initial estimation of examinee attribute profiles.</p>
</td></tr>
<tr><td><code>terminal.class</code></td>
<td>
<p>The The row indices on <code>patterns</code> in the terminal estimation of examinee attribute profiles after the Q-matrix has been refined.</p>
</td></tr>
<tr><td><code>modified.Q</code></td>
<td>
<p>The modified Q-matrix. Rows represent items and columns represent attributes. 1=attribute required by the item, 0=attribute not required by the item.</p>
</td></tr>
<tr><td><code>modified.entries</code></td>
<td>
<p>The modified q-entries. Column 1 is the item ID of the modified entry; column 2 is the attribute ID of the modified entry.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chiu, C. Y. (2013). Statistical Refinement of the Q-matrix in Cognitive Diagnosis. <em>Applied Psychological Measurement, 37</em>(8), 598-618. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AlphaNP">AlphaNP</a></code>, <code><a href="#topic+print.Qrefine">print.Qrefine</a></code>, <code><a href="#topic+plot.Qrefine">plot.Qrefine</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate item and examinee profiles

natt &lt;- 3
nitem &lt;- 4
nperson &lt;- 16
Q &lt;- rbind(c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), c(1, 1, 1))
alpha &lt;- rbind(c(0, 0, 0), c(1, 0, 0), c(0, 1, 0), c(0, 0, 1), 
  c(1, 1, 0), c(1, 0, 1), c(0, 1, 1), c(1, 1, 1))
alpha &lt;- rbind(alpha, alpha)

# Generate DINA model-based response data

slip &lt;- c(0.1, 0.15, 0.2, 0.25)
guess &lt;- c(0.1, 0.15, 0.2, 0.25)
my.par &lt;- list(slip=slip, guess=guess)

data &lt;- matrix(NA, nperson, nitem)
eta &lt;- matrix(NA, nperson, nitem)

for (i in 1:nperson) {
  for (j in 1:nitem) {
  eta[i, j] &lt;- prod(alpha[i,] ^ Q[j, ])
  P &lt;- (1 - slip[j]) ^ eta[i, j] * guess[j] ^ (1 - eta[i, j])
  u &lt;- runif(1)
  data[i, j] &lt;- as.numeric(u &lt; P)
  }
}

# Generate misspecified Q-matrix

Q_mis &lt;- Q
Q_mis[c(1,2), 1] &lt;- 1 - Q_mis[c(1,2), 1]

# Run Qrefine and create diagnostic plots

Qrefine.out &lt;- Qrefine(data, Q_mis, gate="AND", max.ite=50)
print(Qrefine.out)
plot(Qrefine.out)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
