<!DOCTYPE html><html><head><title>Help for package svydiags</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {svydiags}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nhanes2007'>
<p>National Health and Nutrition Examination Survey data, 2007-2008</p></a></li>
<li><a href='#svycollinear'>
<p>Condition indexes and variance decompositions in linear models fitted with complex survey data</p></a></li>
<li><a href='#svyCooksD'>
<p>Modified Cook's D for models fitted with complex survey data</p></a></li>
<li><a href='#svydfbetas'>
<p>dfbetas for models fitted with complex survey data</p></a></li>
<li><a href='#svydffits'>
<p>dffits for models fitted with complex survey data</p></a></li>
<li><a href='#svyhat'>
<p>Leverages for models fitted with complex survey data</p></a></li>
<li><a href='#svystdres'>
<p>Standardized residuals for models fitted with complex survey data</p></a></li>
<li><a href='#svyvif'>
<p>Variance inflation factors (VIF) for general linear models fitted with complex survey data</p></a></li>
<li><a href='#Vmat'>
<p>Compute covariance matrix of residuals for general linear models fitted with complex survey data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Linear Regression Model Diagnostics for Survey Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Richard Valliant [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Richard Valliant &lt;valliant@umich.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Diagnostics for fixed effects linear regression models fitted with survey data. Extensions of standard diagnostics to complex survey data are included: standardized residuals, leverages, Cook's D, dfbetas, dffits, condition indexes, and variance inflation factors as found in Li and Valliant (Surv. Meth., 2009, 35(1), pp. 15-24; Jnl. of Off. Stat., 2011, 27(1), pp. 99-119; Jnl. of Off. Stat., 2015, 31(1), pp. 61-75); Liao and Valliant (Surv. Meth., 2012, 38(1), pp. 53-62; Surv. Meth., 2012, 38(2), pp. 189-202).  Variance inflation factors are also computed for some general linear models (logistic and poisson) as described in Liao (U. Maryland thesis, 2010).</td>
</tr>
<tr>
<td>Suggests:</td>
<td>doBy, foreign, NHANES, sampling</td>
</tr>
<tr>
<td>Depends:</td>
<td>MASS, Matrix, survey</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-12 16:39:21 UTC; rv</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-12 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='nhanes2007'>
National Health and Nutrition Examination Survey data, 2007-2008
</h2><span id='topic+nhanes2007'></span>

<h3>Description</h3>

<p>Demographic and dietary intake variables from a U.S. national household survey
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nhanes2007)</code></pre>


<h3>Format</h3>

<p>A data frame with 4,329 person-level observations on the following 26 variables measuring 24-hour dietary recall. See <a href="https://wwwn.cdc.gov/nchs/nhanes/2013-2014/DR2IFF_H.htm">https://wwwn.cdc.gov/nchs/nhanes/2013-2014/DR2IFF_H.htm</a> for more details about the variables.
</p>

<dl>
<dt><code>SEQN</code></dt><dd><p>Identification variable</p>
</dd>
<dt><code>SDMVSTRA</code></dt><dd><p>Stratum</p>
</dd>
<dt><code>SDMVPSU</code></dt><dd><p>Primary sampling unit, numbered within each stratum (1,2)</p>
</dd>
<dt><code>WTDRD1</code></dt><dd><p>Dietary day 1 sample weight</p>
</dd>
<dt><code>GENDER</code></dt><dd><p>Gender (0 = female; 1 = male)</p>
</dd>
<dt><code>RIDAGEYR</code></dt><dd><p>Age in years at the time of the screening interview; reported for survey participants between the ages of 1 and 79 years of age. All responses of participants aged 80 years and older are coded as 80.</p>
</dd>
<dt><code>RIDRETH1</code></dt><dd><p>Race/Hispanic origin
(1 = Mexican American;
2 = Other Hispanic;
3 = Non-Hispanic White;
4 = Non-Hispanic Black;
5 = Other Race including multiracial)</p>
</dd>
<dt><code>BMXWT</code></dt><dd><p>Body weight (kg)</p>
</dd>
<dt><code>BMXBMI</code></dt><dd><p>Body mass Index ((weight in kg) / (height in meters)**2)</p>
</dd>
<dt><code>DIET</code></dt><dd><p>On any diet (0 = No; 1 = Yes)</p>
</dd>
<dt><code>CALDIET</code></dt><dd><p>On a low-calorie diet (0 = No; 1 = Yes)</p>
</dd>
<dt><code>FATDIET</code></dt><dd><p>On a low-fat diet (0 = No; 1 = Yes)</p>
</dd>
<dt><code>CARBDIET</code></dt><dd><p>On a low-carbohydrate diet (0 = No; 1 = Yes)</p>
</dd>
<dt><code>DR1DRSTZ</code></dt><dd><p>Dietary recall status that indicates quality and completeness of survey participant's response to dietary recall section.
(1 = Reliable and met the minimum criteria;
2 = Not reliable or not met the minimum criteria;
4 = Reported consuming breast-milk (infants and children only))</p>
</dd>
<dt><code>DR1TKCAL</code></dt><dd><p>Energy (kcal)</p>
</dd>
<dt><code>DR1TPROT</code></dt><dd><p>Protein (gm)</p>
</dd>
<dt><code>DR1TCARB</code></dt><dd><p>Carbohydrate (gm)</p>
</dd>
<dt><code>DR1TSUGR</code></dt><dd><p>Total sugars (gm)</p>
</dd>
<dt><code>DR1TFIBE</code></dt><dd><p>Dietary fiber (gm)</p>
</dd>
<dt><code>DR1TTFAT</code></dt><dd><p>Total fat (gm)</p>
</dd>
<dt><code>DR1TSFAT</code></dt><dd><p>Total saturated fatty acids (gm)</p>
</dd>
<dt><code>DR1TMFAT</code></dt><dd><p>Total monounsaturated fatty acids (gm)</p>
</dd>
<dt><code>DR1TPFAT</code></dt><dd><p>Total polyunsaturated fatty acids (gm)</p>
</dd>
<dt><code>DR1TCAFF</code></dt><dd><p>Caffeine (mg)</p>
</dd>
<dt><code>DR1TALCO</code></dt><dd><p>Alcohol (gm)</p>
</dd>
<dt><code>DR1_320Z</code></dt><dd><p>Total plain water drank yesterday (gm)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The National Health and Nutrition Examination Survey (NHANES) is a program of studies designed to assess the health and nutritional status of adults and children in the United States. The survey is unique in that it combines interviews and physical examinations. The <code>nhis2007</code> data set contains observations for 4,329 persons collected in 2007-2008.
</p>


<h3>Source</h3>

<p>National Health and Nutrition Examination Survey of 2007-2008 conducted by the U.S. National Center for Health Statistics.
<a href="https://www.cdc.gov/nchs/nhanes.htm">https://www.cdc.gov/nchs/nhanes.htm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nhanes2007)
str(nhanes2007)
summary(nhanes2007)
</code></pre>

<hr>
<h2 id='svycollinear'>
Condition indexes and variance decompositions in linear models fitted with complex survey data
</h2><span id='topic+svycollinear'></span>

<h3>Description</h3>

<p>Compute condition indexes and variance decompositions for diagnosing collinearity in fixed effects, linear regression models fitted with data collected from one- and two-stage complex survey designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svycollinear(mod, intcpt=TRUE, w, Vcov, sc=TRUE, svyglm.obj, rnd=3, fuzz=0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svycollinear_+3A_mod">mod</code></td>
<td>

<p>Either (i) an <code class="reqn">n \times p</code> matrix of real-valued covariates used in fitting a linear regression; <code class="reqn">n</code> = number of observations, <code class="reqn">p</code> = number of covariates in model, excluding the intercept; the matrix <code>mod</code> should not contain columns for the strata and cluster identifiers (unless those variables are part of the model). No missing values are allowed. The matrix can be created with <code>model.matrix</code>; see the example below. The <code>model</code> list component of an <code>svyglm</code> object cannot be used as it does not have factor variables coded as zero-ones.
</p>
<p>Or, (ii) a model object produced by <code>svyglm</code> in the <code>survey</code> package.
</p>
</td></tr>
<tr><td><code id="svycollinear_+3A_intcpt">intcpt</code></td>
<td>

<p><code>TRUE</code> if the model contains an intercept; <code>FALSE</code> if not.
</p>
</td></tr>
<tr><td><code id="svycollinear_+3A_w">w</code></td>
<td>

<p><code class="reqn">n</code>-vector of survey weights used in fitting the model. No missing values are allowed.
</p>
</td></tr>
<tr><td><code id="svycollinear_+3A_vcov">Vcov</code></td>
<td>

<p>Variance-covariance matrix of the estimated slopes in the regression model; component <code>cov.unscaled</code> in an <code>svyglm</code> object. This matrix can also be extracted with <code>vcov(m)</code> where <code>m</code> is an <code>svyglm</code> object.
</p>
</td></tr>
<tr><td><code id="svycollinear_+3A_sc">sc</code></td>
<td>

<p><code>TRUE</code> if the columns of the weighted model matrix <code class="reqn">\tilde{\mathbf{X}}</code> (defined in Details) should be scaled for computing condition indexes; <code>FALSE</code> if not. If <code>TRUE</code>, each column of  <code class="reqn">\tilde{\mathbf{X}}</code> is divided by its Euclidean norm, <code class="reqn">\sqrt{\tilde{\mathbf{x}}^T \tilde{\mathbf{x}}}</code>.
</p>
</td></tr>
<tr><td><code id="svycollinear_+3A_svyglm.obj">svyglm.obj</code></td>
<td>

<p>Is <code>mod</code> a <code>svyglm.obj</code> object? <code>TRUE</code> or <code>FALSE</code>. If <code>mod</code> is a matrix, set <code>svyglm.obj</code> to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="svycollinear_+3A_rnd">rnd</code></td>
<td>

<p>Round the output to <code>rnd</code> decimal places.
</p>
</td></tr>
<tr><td><code id="svycollinear_+3A_fuzz">fuzz</code></td>
<td>

<p>Replace any variance decomposition proportions that are less than <code>fuzz</code> by '.' in the output.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>svycollinear</code> computes condition indexes and variance decomposition proportions to use for diagnosing collinearity in a linear model fitted from complex survey data as discussed in Liao and Valliant (2012). All measures are based on <code class="reqn">\widetilde{\mathbf{X}} = \mathbf{W}^{1/2}\mathbf{X}</code> where <code class="reqn">\mathbf{W}</code> is the diagonal matrix of survey weights and <b>X</b> is the <code class="reqn">n \times p</code> matrix of covariates. In a full-rank model with <em>p</em> covariates, there are <em>p</em> condition indexes, defined as the ratio of the maximum eigenvalue of <code class="reqn">\widetilde{\mathbf{X}}</code> to its minimum eigenvalue. Before computing condition indexes, as recommended by Belsley (1991), the columns are normalized by their individual Euclidean norms, <code class="reqn">\sqrt{\tilde{\mathbf{x}}^T\tilde{\mathbf{x}}}</code>, so that each column has unit length. The columns are not centered around their means because that can obscure near-dependencies between the intercept and other covariates (Belsley 1984).
</p>
<p>Variance decompositions are for the variance of each estimated regression coefficient and are based on a singular value decomposition of the variance formula. Proportions of the model variance, <code class="reqn">Var_M(\hat{\mathbf{\beta}}_k)</code>, associated with each column of <code class="reqn">\widetilde{\mathbf{X}}</code> are displayed in an output matrix described below.
</p>


<h3>Value</h3>

<p><code class="reqn">p \times (p+1)</code> data frame, <code class="reqn">\mathbf{\Pi}</code>. The first column gives the condition indexes of <code class="reqn">\widetilde{\mathbf{X}}</code>. Values of 10 or more are usually considered to potentially signal collinearity of two or more columns of <code class="reqn">\widetilde{\mathbf{X}}</code>. The remaining columns give the proportions (within columns) of variance of each estimated regression coefficient associated with a singular value decomposition into <em>p</em> terms. Columns <code class="reqn">2, \ldots, p+1</code> will each approximately sum to 1. Note that some &lsquo;proportions&rsquo; can be negative due to the nature of the variance decomposition. If two proportions in a given row of <code class="reqn">\mathbf{\Pi}</code> are relatively large and its associated condition index in that row in the first column of <code class="reqn">\mathbf{\Pi}</code> is also large, then near dependencies between the covariates associated with those elements are influencing the regression coefficient estimates.
</p>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Belsley, D.A., Kuh, E. and Welsch, R.E. (1980). <em>Regression Diagnostics: Identifying Influential Data and Sources of Collinearity</em>. New York: Wiley-Interscience.
</p>
<p>Belsley, D.A. (1984). Demeaning conditioning diagnostics through centering. <em>The American Statistician</em>, 38(2), 73-77.
</p>
<p>Belsley, D.A. (1991). <em>Conditioning Diagnostics, Collinearity, and Weak Data in Regression</em>. New York: John Wiley &amp; Sons, Inc.
</p>
<p>Liao, D, and Valliant, R. (2012). Condition indexes and variance decompositions for diagnosing
collinearity in linear model analysis of survey data. <em>Survey Methodology</em>, 38, 189-202.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svyvif">svyvif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(survey)
    # example from svyglm help page
data(api)
dstrat &lt;- svydesign(id=~1,strata=~stype, weights=~pw, data=apistrat, fpc=~fpc)
m1 &lt;- svyglm(api00~ell+meals+mobility, design=dstrat)
    # send model object from svyglm
CI.out &lt;- svycollinear(mod = m1, w=apistrat$pw, Vcov=vcov(m1), sc=TRUE, svyglm.obj=TRUE,
        rnd=3, fuzz= 0.3)

    # use model.matrix to create matrix of covariates in model
data(nhanes2007)
newPSU &lt;- paste(nhanes2007$SDMVSTRA, nhanes2007$SDMVPSU, sep=".")
nhanes.dsgn &lt;- svydesign(ids = ~newPSU,
                         strata = NULL,
                         weights = ~WTDRD1, data=nhanes2007)
m1 &lt;- svyglm(BMXWT ~ RIDAGEYR + as.factor(RIDRETH1) + DR1TKCAL +
    DR1TTFAT + DR1TMFAT + DR1TSFAT + DR1TPFAT, design=nhanes.dsgn)
X &lt;- model.matrix(~ RIDAGEYR + as.factor(RIDRETH1) + DR1TKCAL + DR1TTFAT + DR1TMFAT
            + DR1TSFAT + DR1TPFAT,
        data = data.frame(nhanes2007))
CI.out &lt;- svycollinear(mod = X, w=nhanes2007$WTDRD1, Vcov=vcov(m1), sc=TRUE, svyglm.obj=FALSE,
        rnd=2, fuzz=0.3)
</code></pre>

<hr>
<h2 id='svyCooksD'>
Modified Cook's D for models fitted with complex survey data
</h2><span id='topic+svyCooksD'></span>

<h3>Description</h3>

<p>Compute a modified Cook's D for fixed effects, linear regression models fitted with data collected from one- and two-stage complex survey designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svyCooksD(mobj, stvar=NULL, clvar=NULL, doplot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svyCooksD_+3A_mobj">mobj</code></td>
<td>

<p>model object produced by <code>svyglm</code> in the <code>survey</code> package
</p>
</td></tr>
<tr><td><code id="svyCooksD_+3A_stvar">stvar</code></td>
<td>

<p>name of the stratification variable in the <code>svydesign</code> object used to fit the model
</p>
</td></tr>
<tr><td><code id="svyCooksD_+3A_clvar">clvar</code></td>
<td>

<p>name of the cluster variable in the <code>svydesign</code> object used to fit the model</p>
</td></tr>
<tr><td><code id="svyCooksD_+3A_doplot">doplot</code></td>
<td>

<p>if <code>TRUE</code>, plot the modified Cook's D values vs. their sequence number in data set. Reference lines are drawn at 2 and 3</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>svyCooksD</code> computes the modified Cook's D (m-cook; see Atkinson (1982) and Li &amp; Valliant (2011, 2015)) which measures the effect on the vector of parameter estimates of deleting single observations when fitting a fixed effects regression model to complex survey data. The function <code>svystdres</code> is called for some of the calculations. Values of m-cook are considered large if they are greater than 2 or 3.  The R package <code>MASS</code> must also be loaded before calling <code>svyCooksD</code>. The output is a vector of the m-cook values and a scatterplot of them versus the sequence number of the sample element used in fitting the model.  By default, <code>svyglm</code> uses only complete cases (i.e., ones for which the dependent variable and all independent variables are non-missing) to fit the model. The rows of the data frame used in fitting the model can be retrieved from the <code>svyglm</code> object via <code>as.numeric(names(mobj$y))</code>. The data for those rows is in <code>mobj$data</code>.
</p>


<h3>Value</h3>

<p>Numeric vector whose names are the rows of the data frame in the <code>svydesign</code> object that were used in fitting the model
</p>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Atkinson, A.C. (1982). Regression diagnostics, transformations and constructed variables (with discussion). <em>Journal of the Royal Statistical Society</em>, Series B, Methodological, 44, 1-36.
</p>
<p>Cook, R.D. (1977). Detection of Influential Observation in Linear Regression. <em>Technometrics</em>, 19, 15-18.
</p>
<p>Cook, R.D. and Weisberg, S. (1982). <em>Residuals and Influence in Regression</em>. London:Chapman &amp; Hall Ltd.
</p>
<p>Li, J., and Valliant, R. (2011). Linear regression diagnostics for unclustered survey data. <em>Journal of Official Statistics</em>, 27, 99-119.
</p>
<p>Li, J., and Valliant, R. (2015). Linear regression diagnostics in cluster samples. <em>Journal of Official Statistics</em>, 31, 61-75.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svydfbetas">svydfbetas</a></code>, <code><a href="#topic+svydffits">svydffits</a></code>, <code><a href="#topic+svystdres">svystdres</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(MASS)   # to get ginv
require(survey)
data(api)
    # unstratified design single stage design
d0 &lt;- svydesign(id=~1,strata=NULL, weights=~pw, data=apistrat)
m0 &lt;- svyglm(api00 ~ ell + meals + mobility, design=d0)
mcook &lt;- svyCooksD(m0, doplot=TRUE)

    # stratified clustered design
require(NHANES)
data(NHANESraw)
dnhanes &lt;- svydesign(id=~SDMVPSU, strata=~SDMVSTRA, weights=~WTINT2YR, nest=TRUE, data=NHANESraw)
m2 &lt;- svyglm(BPDiaAve ~ as.factor(Race1) + BMI + AlcoholYear, design = dnhanes)
mcook &lt;- svyCooksD(mobj=m2, stvar="SDMVSTRA", clvar="SDMVPSU", doplot=TRUE)
</code></pre>

<hr>
<h2 id='svydfbetas'>
dfbetas for models fitted with complex survey data
</h2><span id='topic+svydfbetas'></span>

<h3>Description</h3>

<p>Compute the dfbetas measure of the effect of extreme observations on parameter estimates for fixed effects, linear regression models fitted with data collected from one- and two-stage complex survey designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svydfbetas(mobj, stvar=NULL, clvar=NULL, z=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svydfbetas_+3A_mobj">mobj</code></td>
<td>

<p>model object produced by <code>svyglm</code> in the <code>survey</code> package
</p>
</td></tr>
<tr><td><code id="svydfbetas_+3A_stvar">stvar</code></td>
<td>

<p>name of the stratification variable in the <code>svydesign</code> object used to fit the model
</p>
</td></tr>
<tr><td><code id="svydfbetas_+3A_clvar">clvar</code></td>
<td>

<p>name of the cluster variable in the <code>svydesign</code> object used to fit the model
</p>
</td></tr>
<tr><td><code id="svydfbetas_+3A_z">z</code></td>
<td>

<p>numerator of cutoff for measuring whether an observation has an extreme effect on its own predicted value; default is 3 but can be adjusted to control how many observations are flagged for inspection
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>svydfbetas</code> computes the values of dfbetas for each observation and parameter estimate, i.e., the amount that a parameter estimate changes when the unit is deleted from the sample. The model object must be created by <code>svyglm</code> in the R <code>survey</code> package. The output is a vector of the dfbeta and standardized dfbetas values.  By default, <code>svyglm</code> uses only complete cases (i.e., ones for which the dependent variable and all independent variables are non-missing) to fit the model. The rows of the data frame used in fitting the model can be retrieved from the <code>svyglm</code> object via <code>as.numeric(names(mobj$y))</code>. The data for those rows is in <code>mobj$data</code>.
</p>


<h3>Value</h3>

<p>List object with values:
</p>
<table>
<tr><td><code>Dfbeta</code></td>
<td>
<p>Numeric vector of unstandardized dfbeta values whose names are the rows of the data frame in the <code>svydesign</code> object that were used in fitting the model</p>
</td></tr>
<tr><td><code>Dfbetas</code></td>
<td>
<p>Numeric vector of standardized dfbetas values whose names are the rows of the data frame in the <code>svydesign</code> object that were used in fitting the model</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>Value used for gauging whether a value of dffits is large. For a single-stage sample, <code>cutoff</code>=<code class="reqn">z/\sqrt{n}</code>; for a 2-stage sample, <code>cutoff</code>=<code class="reqn">z/\sqrt{n[1+\rho (\bar{m}-1)]}</code> </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Li, J., and Valliant, R. (2011). Linear regression diagnostics for unclustered survey data. <em>Journal of Official Statistics</em>, 27, 99-119.
</p>
<p>Li, J., and Valliant, R. (2015). Linear regression diagnostics in cluster samples. <em>Journal of Official Statistics</em>, 31, 61-75.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svydffits">svydffits</a></code>, <code><a href="#topic+svyCooksD">svyCooksD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(survey)
data(api)
    # unstratified design single stage design
d0 &lt;- svydesign(id=~1,strata=NULL, weights=~pw, data=apistrat)
m0 &lt;- svyglm(api00 ~ ell + meals + mobility, design=d0)
svydfbetas(mobj=m0)

    # stratified cluster
require(NHANES)
data(NHANESraw)
dnhanes &lt;- svydesign(id=~SDMVPSU, strata=~SDMVSTRA, weights=~WTINT2YR, nest=TRUE, data=NHANESraw)
m2 &lt;- svyglm(BPDiaAve ~ as.factor(Race1) + BMI + AlcoholYear, design = dnhanes)
yy &lt;- svydfbetas(mobj=m2, stvar= "SDMVSTRA", clvar="SDMVPSU")
apply(abs(yy$Dfbetas) &gt; yy$cutoff,1, sum)
</code></pre>

<hr>
<h2 id='svydffits'>
dffits for models fitted with complex survey data
</h2><span id='topic+svydffits'></span>

<h3>Description</h3>

<p>Compute the dffits measure of the effect of extreme observations on predicted values for fixed effects, linear regression models fitted with data collected from one- and two-stage complex survey designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svydffits(mobj, stvar=NULL, clvar=NULL, z=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svydffits_+3A_mobj">mobj</code></td>
<td>

<p>model object produced by <code>svyglm</code> in the <code>survey</code> package
</p>
</td></tr>
<tr><td><code id="svydffits_+3A_stvar">stvar</code></td>
<td>

<p>name of the stratification variable in the <code>svydesign</code> object used to fit the model
</p>
</td></tr>
<tr><td><code id="svydffits_+3A_clvar">clvar</code></td>
<td>

<p>name of the cluster variable in the <code>svydesign</code> object used to fit the model
</p>
</td></tr>
<tr><td><code id="svydffits_+3A_z">z</code></td>
<td>

<p>numerator of cutoff for measuring whether an observation has an extreme effect on its own predicted value; default is 3 but can be adjusted to control how many observations are flagged for inspection
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>svydffits</code> computes the value of dffits for each observation, i.e., the amount that a unit's predicted value changes when the unit is deleted from the sample. The model object must be created by <code>svyglm</code> in the R <code>survey</code> package. The output is a vector of the dffit and standardized dffits values.  By default, <code>svyglm</code> uses only complete cases (i.e., ones for which the dependent variable and all independent variables are non-missing) to fit the model. The rows of the data frame used in fitting the model can be retrieved from the <code>svyglm</code> object via <code>as.numeric(names(mobj$y))</code>. The data for those rows is in <code>mobj$data</code>.
</p>


<h3>Value</h3>

<p>List object with values:
</p>
<table>
<tr><td><code>Dffit</code></td>
<td>
<p>Numeric vector of unstandardized dffit values whose names are the rows of the data frame in the <code>svydesign</code> object that were used in fitting the model</p>
</td></tr>
<tr><td><code>Dffits</code></td>
<td>
<p>Numeric vector of standardized dffits values whose names are the rows of the data frame in the <code>svydesign</code> object that were used in fitting the model</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>Value used for gauging whether a value of dffits is large. For a single-stage sample, <code>cutoff</code>=<code class="reqn">z/\sqrt{n}</code>; for a 2-stage sample, <code>cutoff</code>=<code class="reqn">z\sqrt{p/n\bar{m}[1+\rho (\bar{m}-1)]}</code> </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Li, J., and Valliant, R. (2011). Linear regression diagnostics for unclustered survey data. <em>Journal of Official Statistics</em>, 27, 99-119.
</p>
<p>Li, J., and Valliant, R. (2015). Linear regression diagnostics in cluster samples. <em>Journal of Official Statistics</em>, 31, 61-75.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svydfbetas">svydfbetas</a></code>, <code><a href="#topic+svyCooksD">svyCooksD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(survey)
data(api)
    # unstratified design single stage design
d0 &lt;- svydesign(id=~1,strata=NULL, weights=~pw, data=apistrat)
m0 &lt;- svyglm(api00 ~ ell + meals + mobility, design=d0)
yy &lt;- svydffits(mobj=m0)
yy$cutoff
sum(abs(yy$Dffits) &gt; yy$cutoff)

require(NHANES)
data(NHANESraw)
dnhanes &lt;- svydesign(id=~SDMVPSU, strata=~SDMVSTRA, weights=~WTINT2YR, nest=TRUE, data=NHANESraw)
m2 &lt;- svyglm(BPDiaAve ~ as.factor(Race1) + BMI + AlcoholYear, design = dnhanes)
yy &lt;- svydffits(mobj=m2, stvar= "SDMVSTRA", clvar="SDMVPSU", z=4)
sum(abs(yy$Dffits) &gt; yy$cutoff)
</code></pre>

<hr>
<h2 id='svyhat'>
Leverages for models fitted with complex survey data
</h2><span id='topic+svyhat'></span>

<h3>Description</h3>

<p>Compute leverages for fixed effects, linear regression models fitted from complex survey data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svyhat(mobj, doplot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svyhat_+3A_mobj">mobj</code></td>
<td>

<p>model object produced by <code>svyglm</code> in the <code>survey</code> package
</p>
</td></tr>
<tr><td><code id="svyhat_+3A_doplot">doplot</code></td>
<td>

<p>if <code>TRUE</code>, plot the standardized residuals vs. their sequence number in data set. A reference line is drawn at 3 times the mean leverage
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>svyhat</code> computes the leverages from a model fitted with complex survey data. The model object <code>mobj</code> must be created by <code>svyglm</code> in the R <code>survey</code> package. The output is a vector of the leverages and a scatterplot of them versus the sequence number of the sample element used in fitting the model.  By default, <code>svyglm</code> uses only complete cases (i.e., ones for which the dependent variable and all independent variables are non-missing) to fit the model. The rows of the data frame used in fitting the model can be retrieved from the <code>svyglm</code> object via <code>as.numeric(names(mobj$y))</code>. The data for those rows is in <code>mobj$data</code>.
</p>


<h3>Value</h3>

<p>Numeric vector whose names are the rows of the data frame in the <code>svydesign</code> object that were used in fitting the model.
</p>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Belsley, D.A., Kuh, E. and Welsch, R. (1980). <em>Regression Diagnostics: Identifying Influential Data and Sources of Collinearity</em>. New York: John Wiley &amp; Sons, Inc.
</p>
<p>Li, J., and Valliant, R. (2009). Survey weighted hat matrix and leverages. <em>Survey Methodology</em>, 35, 15-24.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svystdres">svystdres</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(survey)
data(api)
dstrat &lt;- svydesign(id=~1,strata=~stype, weights=~pw, data=apistrat)
m1 &lt;- svyglm(api00 ~ ell + meals + mobility, design=dstrat)
h &lt;- svyhat(mobj = m1, doplot=TRUE)
100*sum(h &gt; 3*mean(h))/length(h)    # percentage of leverages &gt; 3*mean

require(NHANES)
data(NHANESraw)
dnhanes &lt;- svydesign(id=~SDMVPSU, strata=~SDMVSTRA, weights=~WTINT2YR, nest=TRUE, data=NHANESraw)
m1 &lt;- svyglm(BPDiaAve ~ as.factor(Race1) + BMI + AlcoholYear, design = dnhanes)
h &lt;- svyhat(mobj = m1, doplot=TRUE)
</code></pre>

<hr>
<h2 id='svystdres'>
Standardized residuals for models fitted with complex survey data
</h2><span id='topic+svystdres'></span>

<h3>Description</h3>

<p>Compute standardized residuals for fixed effects, linear regression models fitted with data collected from one- and two-stage complex survey designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svystdres(mobj, stvar=NULL, clvar=NULL, doplot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svystdres_+3A_mobj">mobj</code></td>
<td>

<p>model object produced by <code>svyglm</code> in the <code>survey</code> package
</p>
</td></tr>
<tr><td><code id="svystdres_+3A_stvar">stvar</code></td>
<td>

<p>name of the stratification variable in the <code>svydesign</code> object used to fit the model
</p>
</td></tr>
<tr><td><code id="svystdres_+3A_clvar">clvar</code></td>
<td>

<p>name of the cluster variable in the <code>svydesign</code> object used to fit the model</p>
</td></tr>
<tr><td><code id="svystdres_+3A_doplot">doplot</code></td>
<td>

<p>if <code>TRUE</code>, plot the standardized residuals vs. their sequence number in data set. Reference lines are drawn at +/-3</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>svystdres</code> computes the standardized residuals, i.e., the residuals divided by an estimate of the model standard deviation of the residuals. Residuals are used from a model object created by <code>svyglm</code> in the R <code>survey</code> package. The output is a vector of the standardized residuals and a scatterplot of them versus the sequence number of the sample element used in fitting the model.  By default, <code>svyglm</code> uses only complete cases (i.e., ones for which the dependent variable and all independent variables are non-missing) to fit the model. The rows of the data frame used in fitting the model can be retrieved from the <code>svyglm</code> object via <code>as.numeric(names(mobj$y))</code>. The data for those rows is in <code>mobj$data</code>.
</p>


<h3>Value</h3>

<p>List object with values:
</p>
<table>
<tr><td><code>stdresids</code></td>
<td>
<p>Numeric vector whose names are the rows of the data frame in the <code>svydesign</code> object that were used in fitting the model</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of sample clusters</p>
</td></tr>
<tr><td><code>mbar</code></td>
<td>
<p>average number of non-missing, sample elements per cluster</p>
</td></tr>
<tr><td><code>rtsighat</code></td>
<td>
<p>estimate of the square root of the model variance of the residuals, <code class="reqn">\sqrt(\sigma^2)</code></p>
</td></tr>
<tr><td><code>rhohat</code></td>
<td>
<p>estimate of the intracluster correlation of the residuals, <code class="reqn">\rho</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Li, J., and Valliant, R. (2011). Linear regression diagnostics for unclustered survey data. <em>Journal of Official Statistics</em>, 27, 99-119.
</p>
<p>Li, J., and Valliant, R. (2015). Linear regression diagnostics in cluster samples. <em>Journal of Official Statistics</em>, 31, 61-75.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svyhat">svyhat</a></code>, <code><a href="#topic+svyCooksD">svyCooksD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(survey)
data(api)
    # unstratified design single stage design
d0 &lt;- svydesign(id=~1,strata=NULL, weights=~pw, data=apistrat)
m0 &lt;- svyglm(api00 ~ ell + meals + mobility, design=d0)
svystdres(mobj=m0, stvar=NULL, clvar=NULL)

    # stratified cluster design
require(NHANES)
data(NHANESraw)
dnhanes &lt;- svydesign(id=~SDMVPSU, strata=~SDMVSTRA, weights=~WTINT2YR, nest=TRUE, data=NHANESraw)
m1 &lt;- svyglm(BPDiaAve ~ as.factor(Race1) + BMI + AlcoholYear, design = dnhanes)
svystdres(mobj=m1, stvar= "SDMVSTRA", clvar="SDMVPSU")
</code></pre>

<hr>
<h2 id='svyvif'>
Variance inflation factors (VIF) for general linear models fitted with complex survey data
</h2><span id='topic+svyvif'></span>

<h3>Description</h3>

<p>Compute a VIF for fixed effects, general linear regression models fitted with data collected from one- and two-stage complex survey designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svyvif(mobj, X, w, stvar=NULL, clvar=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svyvif_+3A_mobj">mobj</code></td>
<td>

<p>model object produced by <code>svyglm</code>. The following families of models are allowed: binomial, gaussian, poisson, quasibinomial, and quasipoisson. Other families allowed by <code>svyglm</code> will produce an error in <code>svyvif</code>.
</p>
</td></tr>
<tr><td><code id="svyvif_+3A_x">X</code></td>
<td>

<p><code class="reqn">n \times p</code> matrix of real-valued covariates used in fitting a linear regression; <code class="reqn">n</code> = number of observations, <code class="reqn">p</code> = number of covariates in model, excluding the intercept. A column of 1's for an intercept should not be included. <code>X</code> should not contain columns for the strata and cluster identifiers (unless those variables are part of the model). No missing values are allowed.
</p>
</td></tr>
<tr><td><code id="svyvif_+3A_w">w</code></td>
<td>

<p><code class="reqn">n</code>-vector of survey weights used in fitting the model. No missing values are allowed.
</p>
</td></tr>
<tr><td><code id="svyvif_+3A_stvar">stvar</code></td>
<td>

<p>field in <code>mobj</code> that contains the stratum variable in the complex sample design; use <code>stvar = NULL</code> if there are no strata
</p>
</td></tr>
<tr><td><code id="svyvif_+3A_clvar">clvar</code></td>
<td>

<p>field in <code>mobj</code> that contains the cluster variable in the complex sample design; use <code>clvar = NULL</code> if there are no clusters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>svyvif</code> computes a variance inflation factor (VIF) appropriate for linear models and some general linear models (GLMs) fitted from complex survey data (see Liao &amp; Valliant 2012). A VIF measures the inflation of a slope estimate caused by nonorthogonality of the predictors over and above what the variance would be with orthogonality (Theil 1971; Belsley, Kuh, and Welsch 1980). The standard VIF equals <code class="reqn">1/(1 - R^2_k)</code> where <code class="reqn">R_k</code> is the multiple correlation of the <code class="reqn">k^{th}</code> column of <code>X</code> regressed on the remaining columns. The complex sample value of the VIF for a linear model consists of the standard VIF multiplied by two adjustments denoted in the output as <code>zeta</code> and <code>varrho</code>. The VIF for a GLM is similar (Liao 2010, chap. 5). There is no widely agreed-upon cutoff value for identifying high values of a VIF, although 10 is a common suggestion.
</p>


<h3>Value</h3>

<p><code class="reqn">p \times 5</code> matrix with columns:
</p>
<table>
<tr><td><code>svy.vif</code></td>
<td>
<p>complex sample VIF</p>
</td></tr>
<tr><td><code>reg.vif</code></td>
<td>
<p>standard VIF, <code class="reqn">1/(1 - R^2_k)</code>, that omits the factors, <code>zeta</code> and <code>varrho</code>; <code class="reqn">R^2_k</code> is an R-square from a weighted least squares regression of the <code class="reqn">k^{th}</code> x on the other x's in the regression</p>
</td></tr>
<tr><td><code>zeta</code></td>
<td>
<p>1st multiplicative adjustment to <code>reg.vif</code></p>
</td></tr>
<tr><td><code>varrho</code></td>
<td>
<p>2nd multiplicative adjustment to <code>reg.vif</code></p>
</td></tr>
<tr><td><code>zeta.x.varrho</code></td>
<td>
<p>product of the two adjustments to <code>reg.vif</code></p>
</td></tr>
<tr><td><code>R.square</code></td>
<td>
<p>R-square in the regression of the <code class="reqn">k^{th}</code> x on the other x's, including the intercept</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Belsley, D.A., Kuh, E. and Welsch, R.E. (1980). <em>Regression Diagnostics: Identifying Influential Data and Sources of Collinearity</em>. New York: Wiley-Interscience.
</p>
<p>Liao, D. (2010). Collinearity Diagnostics for Complex Survey Data. PhD thesis, University of Maryland. <a href="http://hdl.handle.net/1903/10881">http://hdl.handle.net/1903/10881</a>.
</p>
<p>Liao, D, and Valliant, R. (2012). Variance inflation factors in the analysis of complex survey data. <em>Survey Methodology</em>, 38, 53-62.
</p>
<p>Theil, H. (1971). <em>Principles of Econometrics</em>. New York: John Wiley &amp; Sons, Inc.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Vmat">Vmat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(survey)
data(nhanes2007)
X1 &lt;- nhanes2007[order(nhanes2007$SDMVSTRA, nhanes2007$SDMVPSU),]
    # eliminate cases with missing values
delete &lt;- which(complete.cases(X1)==FALSE)
X2 &lt;- X1[-delete,]
nhanes.dsgn &lt;- svydesign(ids = ~SDMVPSU,
                         strata = ~SDMVSTRA,
                         weights = ~WTDRD1, nest=TRUE, data=X2)
    # linear model
m1 &lt;- svyglm(BMXWT ~ RIDAGEYR + as.factor(RIDRETH1) + DR1TKCAL
            + DR1TTFAT + DR1TMFAT, design=nhanes.dsgn)
summary(m1)
    # construct X matrix using model.matrix from stats package
X3 &lt;- model.matrix(~ RIDAGEYR + as.factor(RIDRETH1) + DR1TKCAL + DR1TTFAT + DR1TMFAT,
        data = data.frame(X2))
    # remove col of 1's for intercept with X3[,-1]
svyvif(mobj=m1, X=X3[,-1], w = X2$WTDRD1, stvar=NULL, clvar=NULL)

    # Logistic model
X2$obese &lt;- X2$BMXBMI &gt;= 30
nhanes.dsgn &lt;- svydesign(ids = ~SDMVPSU,
                         strata = ~SDMVSTRA,
                         weights = ~WTDRD1, nest=TRUE, data=X2)
m2 &lt;- svyglm(obese ~ RIDAGEYR + as.factor(RIDRETH1) + DR1TKCAL
             + DR1TTFAT + DR1TMFAT, design=nhanes.dsgn, family="quasibinomial")
summary(m2)
svyvif(mobj=m2, X=X3[,-1], w = X2$WTDRD1, stvar = "SDMVSTRA", clvar = "SDMVPSU")
</code></pre>

<hr>
<h2 id='Vmat'>
Compute covariance matrix of residuals for general linear models fitted with complex survey data
</h2><span id='topic+Vmat'></span>

<h3>Description</h3>

<p>Compute a covariance matrix using residuals from a fixed effects, general linear regression model fitted with data collected from one- and two-stage complex survey designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Vmat(mobj, stvar = NULL, clvar = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Vmat_+3A_mobj">mobj</code></td>
<td>

<p>model object produced by <code>svyglm</code>
</p>
</td></tr>
<tr><td><code id="Vmat_+3A_stvar">stvar</code></td>
<td>

<p>field in <code>mobj</code> that contains the stratum variable in the complex sample design; use <code>stvar = NULL</code> if there are no strata
</p>
</td></tr>
<tr><td><code id="Vmat_+3A_clvar">clvar</code></td>
<td>

<p>field in <code>mobj</code> that contains the cluster variable in the complex sample design; use <code>clvar = NULL</code> if there are no clusters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Vmat</code> computes a covariance matrix among the residuals returned from <code>svyglm</code> in the <code>survey</code> package. <code>Vmat</code> is called by <code>svyvif</code> when computing variance inflation factors. The matrix that is computed by <code>Vmat</code> is appropriate under these model assumptions: (1) in single-stage, unclustered sampling, units are assumed to be uncorrelated but can have different model variances, (2) in single-stage, stratified sampling, units are assumed to be uncorrelated within strata and between strata but can have different model variances; (3) in unstratified, clustered samples, units in different clusters are assumed to be uncorrelated but units within clusters are correlated; (3) in stratified, clustered samples, units in different strata or clusters are assumed to be uncorrelated but units within clusters are correlated.
</p>


<h3>Value</h3>

<p><code class="reqn">n \times n</code> matrix where <code class="reqn">n</code> is the number of cases used in the linear regression model
</p>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Liao, D, and Valliant, R. (2012). Variance inflation factors in the analysis of complex survey data. <em>Survey Methodology</em>, 38, 53-62.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svyvif">svyvif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(Matrix)
require(survey)
data(nhanes2007)
black &lt;- nhanes2007$RIDRETH1 == 4
X &lt;- nhanes2007
X &lt;-  cbind(X, black)
X1 &lt;- X[order(X$SDMVSTRA, X$SDMVPSU),]

    # unstratified, unclustered design
nhanes.dsgn &lt;- svydesign(ids = 1:nrow(X1),
                         strata = NULL,
                         weights = ~WTDRD1, data=X1)
m1 &lt;- svyglm(BMXWT ~ RIDAGEYR + as.factor(black) + DR1TKCAL, design=nhanes.dsgn)
summary(m1)

V &lt;- Vmat(mobj = m1,
          stvar = NULL,
          clvar = NULL)

    # stratified, clustered design
nhanes.dsgn &lt;- svydesign(ids = ~SDMVPSU,
                         strata = ~SDMVSTRA,
                         weights = ~WTDRD1, nest=TRUE, data=X1)
m1 &lt;- svyglm(BMXWT ~ RIDAGEYR + as.factor(black) + DR1TKCAL, design=nhanes.dsgn)
summary(m1)
V &lt;- Vmat(mobj = m1,
          stvar = "SDMVSTRA",
          clvar = "SDMVPSU")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
