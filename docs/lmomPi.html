<!DOCTYPE html><html lang="en"><head><title>Help for package lmomPi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmomPi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cdf'><p>Generic function for <code>cdf...</code>: probability distribution fitting with L-Moments.</p></a></li>
<li><a href='#lmomPi-Package'><p>lmomPi: (Precipitation) Frequency Analysis and Variability with L-Moments from lmom</p></a></li>
<li><a href='#pel'><p>Generic function for <code>pel...</code></p></a></li>
<li><a href='#qua'><p>Generic function for <code>qua...</code>: probabilily distribution fitting with L-Moments</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Title:</td>
<td>(Precipitation) Frequency Analysis and Variability with
L-Moments from 'lmom'</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Description:</td>
<td>It is an extension of 'lmom' R package: 'pel...()','cdf...()',qua...()' function
    families are lumped and called from one function per each family respectively in order to
    create robust automatic tools to fit data  with different probability
    distributions and then to estimate probability values and return periods.  The implemented functions are able to manage time series with constant and/or missing values without stopping
    the execution with error messages. The package also contains tools to  calculate several  indices based on variability (e.g. 'SPI' , Standardized
    Precipitation Index, see <a href="https://climatedataguide.ucar.edu/climate-data/standardized-precipitation-index-spi">https://climatedataguide.ucar.edu/climate-data/standardized-precipitation-index-spi</a> and <a href="http://spei.csic.es/">http://spei.csic.es/</a>) for multiple time series or spatially gridded values. </td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-14</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.0.1),lmom,stringr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>SPEI</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-14 08:45:18 UTC; ecor</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-15 09:20:02 UTC</td>
</tr>
<tr>
<td>Author:</td>
<td>Emanuele Cordano [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emanuele Cordano &lt;emanuele.cordano@gmail.com&gt;</td>
</tr>
</table>
<hr>
<h2 id='cdf'>Generic function for <code>cdf...</code>: probability distribution fitting with L-Moments.</h2><span id='topic+cdf'></span><span id='topic+spi.cdf'></span><span id='topic+cdf.spi'></span>

<h3>Description</h3>

<p>These functions compute value(s) of cumulated probability or SPI-like (normal standardize) index from a sample or time series of <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf(
  para,
  x,
  probability_distribution_attrname = "probability_distrib",
  indices = NULL,
  return.as.spi = FALSE,
  spi.scale = NA,
  distrib = NA,
  ...
)

spi.cdf(x, para, ...)

cdf.spi(x, para, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cdf_+3A_x">x</code>, <code id="cdf_+3A_para">para</code>, <code id="cdf_+3A_...">...</code></td>
<td>
<p>L-moments and further parameters for <code>cdf...</code> and <code><a href="#topic+cdf">cdf</a></code></p>
</td></tr>
<tr><td><code id="cdf_+3A_probability_distribution_attrname">probability_distribution_attrname</code></td>
<td>
<p>attribute name for probability distribution</p>
</td></tr>
<tr><td><code id="cdf_+3A_indices">indices</code></td>
<td>
<p>vector of string working as factors or indices, e g. the month names or similar. It must be of the same length of <code>x</code> or the length equal to 1 other <code>NULL</code>, if not used. If used, it computes <code>cdf</code> for each factor.</p>
</td></tr>
<tr><td><code id="cdf_+3A_return.as.spi">return.as.spi</code></td>
<td>
<p>logical parameter. Default is <code>FALSE</code>. If it is <code>TRUE</code> probability value is transformed to a normalized random variable through standard <code><a href="stats.html#topic+qnorm">qnorm</a></code>, as for Standard Precipitation Index (SPI) (<a href="https://climatedataguide.ucar.edu/climate-data/standardized-precipitation-index-spi">https://climatedataguide.ucar.edu/climate-data/standardized-precipitation-index-spi</a>).</p>
</td></tr>
<tr><td><code id="cdf_+3A_spi.scale">spi.scale</code></td>
<td>
<p>integer value or <code>NA</code>. If it greater than 1 <code>x</code> is filtered with the sum of a generic element of <code>x</code> and the previous <code>spi.scale-1</code> ones (e.g. SPI-3,SPI-6, etc. ). Default is <code>NA</code> (no filtering) which is equivalent to <code>spi.scale=1</code>.</p>
</td></tr>
<tr><td><code id="cdf_+3A_distrib">distrib</code></td>
<td>
<p>character string indicating the probability distribution, it can be used in case <code>para</code> has no attributes. Default is <code>NA</code> and distribution info are all passed through <code>para</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of cumulated probability value(s) or SPI-like Gaussianized values. It is a list of vectors in case of several probability parametric distribution functions (i.e. <code>para</code> is a list and <code>length(para)&gt;1</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pel">pel</a></code>,<code><a href="lmom.html#topic+cdfexp">cdfexp</a></code>,<code><a href="lmom.html#topic+cdfgam">cdfgam</a></code>,<code><a href="lmom.html#topic+cdfgev">cdfgev</a></code>,<code><a href="lmom.html#topic+cdfglo">cdfglo</a></code>,
</p>
<p><code><a href="lmom.html#topic+cdfgpa">cdfgpa</a></code>,<code><a href="lmom.html#topic+cdfgno">cdfgno</a></code>,<code><a href="lmom.html#topic+cdfgum">cdfgum</a></code>,<code><a href="lmom.html#topic+cdfkap">cdfkap</a></code>,<code><a href="lmom.html#topic+cdfln3">cdfln3</a></code>,<code><a href="lmom.html#topic+cdfnor">cdfnor</a></code>,<code><a href="lmom.html#topic+cdfpe3">cdfpe3</a></code>,<code><a href="lmom.html#topic+cdfwak">cdfwak</a></code>,<code><a href="lmom.html#topic+cdfwei">cdfwei</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Sample L-moments of Ozone from the airquality data
data(airquality)
lmom &lt;- samlmu(airquality$Ozone,nmom=6)

distrib &lt;- c("exp","gam","gev","glo","gpa","gno","gum","kap",
"ln3","nor","pe3","wak","wei")

para_list &lt;- pel(distrib=distrib,lmom=lmom)
cdf_list &lt;- cdf(para=para_list,x=airquality$Ozone)

cdf_gam &lt;- cdf(para=para_list$gam,x=airquality$Ozone)
cdf_gam2 &lt;- cdf(para=para_list$gam,x=airquality$Ozone,distrib="gam")

if (any(cdf_gam!=cdf_gam2,na.rm=TRUE)) stop("Any possible errors after  0.6.3 package updates!") 



## Comparison with the SPI/SPEI algorithms:  'SPEI::spi' ('SPEI' package)

if (requireNamespace("SPEI",quietly = TRUE)) {
 library(SPEI)
 data(wichita)

 distrib_wichita &lt;- 'pe3'
 spi.scale &lt;- 1

 month_wichita &lt;- sprintf("M%02d",wichita$MONTH)
 para_whichita  &lt;- pel(x=wichita$PRCP,indices=month_wichita,distrib=distrib_wichita,
						spi.scale=spi.scale)
 spi_wichita   &lt;- spi.cdf(x=wichita$PRCP,indices=month_wichita,para=para_whichita,
						spi.scale=spi.scale)
 spi_wichita_speipkg   &lt;- spi(data=wichita$PRCP,distrib='PearsonIII',scale=spi.scale)
 difference &lt;- spi_wichita-spi_wichita_speipkg$fitted
}



</code></pre>

<hr>
<h2 id='lmomPi-Package'>lmomPi: (Precipitation) Frequency Analysis and Variability with L-Moments from lmom</h2><span id='topic+lmomPi-Package'></span>

<h3>Description</h3>

<p>This packages contains wrapper functions of 'lmom' packages :  
<code><a href="#topic+cdf">cdf</a></code>: generic distribution function;    
<code><a href="#topic+qua">qua</a></code>: generic quantile function;   
<code><a href="#topic+pel">pel</a></code>: fitting of probability distribution function through L-moments. 
</p>


<h3>Details</h3>

<p>The example functions are illustrated making use of CHIRPS rainfall meteorological data taken: 
</p>
<p>Funk, Chris, Pete Peterson, Martin Landsfeld, Diego Pedreros, James Verdin, 
Shraddhanand Shukla, Gregory Husak, James Rowland, Laura Harrison, 
Andrew Hoell and Joel Michaelsen.
&quot;The climate hazards infrared precipitation with stations - a new environmental 
record for monitoring extremes&quot;. Scientific Data 2, 150066. doi:10.1038/sdata.2015.66 2015 , 
<a href="https://chc.ucsb.edu/data/chirps">https://chc.ucsb.edu/data/chirps</a>.
</p>
<p>The package-provided datasets shall be only used as example datasets. 
</p>
<p>The package also contains wrapped functions to  calculate several  indices based on variability (e.g. 'SPI' , Standardized
Precipitation Index, see <a href="https://climatedataguide.ucar.edu/climate-data/standardized-precipitation-index-spi">https://climatedataguide.ucar.edu/climate-data/standardized-precipitation-index-spi</a> and <a href="http://spei.csic.es">http://spei.csic.es</a>) for multiple time series or spatio-temporal gridded values. 
The function  <code><a href="#topic+spi.cdf">spi.cdf</a>()</code> is compared against <code>SPEI::spi()</code> in SPEI package (<a href="https://cran.r-project.org/package=SPEI">https://cran.r-project.org/package=SPEI</a>). The differences in SPI extimation have order of magnitude averagely about 10^-8,  due to  the different fitting methods implemented in the two packages. 
(see <code>SPEI::spi()</code> and <code><a href="#topic+spi.cdf">spi.cdf</a>()</code> for more details). 
</p>
<p>The development of this package has been sponsored by ACEWATER2 and &quot;Water  for  Growth  and  Poverty Reduction  in  the  Mekrou&quot; projects of the Joint Research Centre of the Europan Commission (<a href="https://aquaknow.jrc.ec.europa.eu">https://aquaknow.jrc.ec.europa.eu</a>).
</p>

<hr>
<h2 id='pel'>Generic function for <code><a href="lmom.html#topic+pel...">pel...</a></code></h2><span id='topic+pel'></span><span id='topic+pel_x'></span><span id='topic+pel_lmom'></span>

<h3>Description</h3>

<p>Generic function for <code><a href="lmom.html#topic+pel...">pel...</a></code>: probability distribution fitting with L-Moments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pel(
  distrib = c("exp", "gam", "gev", "glo", "gpa", "gno", "gum", "kap", "ln3", "nor",
    "pe3", "wak", "wei"),
  lmom = NULL,
  probability_distribution_attrname = "probability_distrib",
  x = NULL,
  nmom = 5,
  sort.data = TRUE,
  ratios = sort.data,
  trim = 0,
  indices = NULL,
  spi.scale = NA,
  correction = NULL,
  ...
)

pel_x(x, ...)

pel_lmom(lmom, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pel_+3A_distrib">distrib</code></td>
<td>
<p>character string indicating the probability distribution to fit</p>
</td></tr>
<tr><td><code id="pel_+3A_lmom">lmom</code>, <code id="pel_+3A_...">...</code></td>
<td>
<p>L-moments and further parameters for <code><a href="lmom.html#topic+pel...">pel...</a></code></p>
</td></tr>
<tr><td><code id="pel_+3A_probability_distribution_attrname">probability_distribution_attrname</code></td>
<td>
<p>attribute name for probability distribution</p>
</td></tr>
<tr><td><code id="pel_+3A_x">x</code></td>
<td>
<p>vector containg sample. It is utiled to calculete L-moments in case <code>lmom</code> is set equal to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="pel_+3A_nmom">nmom</code>, <code id="pel_+3A_sort.data">sort.data</code>, <code id="pel_+3A_ratios">ratios</code>, <code id="pel_+3A_trim">trim</code></td>
<td>
<p>arguments for <code><a href="lmom.html#topic+samlmu">samlmu</a></code> (<code>nmom=5</code> by default). Thay are utilized if argument <code>lmom</code> is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="pel_+3A_indices">indices</code></td>
<td>
<p>optional index or tag character vector of the same length of <code>x</code> used as INDEX for <code><a href="base.html#topic+tapply">tapply</a></code>. It is used to fit different probability distribution in one sample time series (e. g. months in an year).</p>
</td></tr>
<tr><td><code id="pel_+3A_spi.scale">spi.scale</code></td>
<td>
<p>integer value or <code>NA</code>. If it is greater than 1, <code>x</code> is filtered with the sum of a generic element of <code>x</code> and the previous <code>spi.scale-1</code> ones (e.g. SPI-3,SPI-6, etc. ). Default is <code>NA</code> (no filtering) which is equivalent to <code>spi.scale=1</code>.</p>
</td></tr>
<tr><td><code id="pel_+3A_correction">correction</code></td>
<td>
<p>numeric value correction for the 3rd (and higher) L-moment estimation. Default is <code>NULL</code> , generally it is not used. It is used and suggested to be <code>10^(-10)</code> in case of a massive function use with <code>lmom=NULL</code> (e.g. raster cell or zonal statistics).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>pel_x</code> and <code>pel_lmom</code> are wrapper functions of <code><a href="#topic+pel">pel</a></code> whose first argument is <code>x</code> or <code>lmom</code> respectively.
</p>


<h3>Value</h3>

<p>A numeric vector containing the  parameters of the selected probability distribution. It is a list in case of selection of several probability distributions (i.e. <code>length(distrib)&gt;1</code>).
</p>


<h3>See Also</h3>

<p><code><a href="lmom.html#topic+pel...">pel...</a></code>,<code><a href="lmom.html#topic+pelexp">pelexp</a></code>,<code><a href="lmom.html#topic+pelgam">pelgam</a></code>,<code><a href="lmom.html#topic+pelgev">pelgev</a></code>,<code><a href="lmom.html#topic+pelglo">pelglo</a></code>,<code><a href="lmom.html#topic+pelgpa">pelgpa</a></code>,
</p>
<p><code><a href="lmom.html#topic+pelgno">pelgno</a></code>,<code><a href="lmom.html#topic+pelgum">pelgum</a></code>,<code><a href="lmom.html#topic+pelkap">pelkap</a></code>,<code><a href="lmom.html#topic+pelln3">pelln3</a></code>,<code><a href="lmom.html#topic+pelnor">pelnor</a></code>,
</p>
<p><code><a href="lmom.html#topic+pelpe3">pelpe3</a></code>,<code><a href="lmom.html#topic+pelwak">pelwak</a></code>,<code><a href="lmom.html#topic+pelwei">pelwei</a></code>,
</p>
<p><code><a href="#topic+cdf">cdf</a></code>,<code><a href="#topic+qua">qua</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Sample L-moments of Ozone from the airquality data
 data(airquality)
 lmom &lt;- samlmu(airquality$Ozone,nmom=6)
 distrib &lt;- "gev"    
 # Fit a GEV distribution
 out_gev &lt;- pel(distrib=distrib,lmom=lmom)

 distrib &lt;- c("exp","gam","gev","glo","gpa","gno","gum","kap","ln3",
 "nor","pe3","wak","wei")

 out_list &lt;- pel(distrib=distrib,lmom=lmom)


</code></pre>

<hr>
<h2 id='qua'>Generic function for <code>qua...</code>: probabilily distribution fitting with L-Moments</h2><span id='topic+qua'></span>

<h3>Description</h3>

<p>Generic function for <code>qua...</code>: probabilily distribution fitting with L-Moments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qua(
  para,
  f,
  probability_distribution_attrname = "probability_distrib",
  distrib = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qua_+3A_f">f</code>, <code id="qua_+3A_para">para</code>, <code id="qua_+3A_...">...</code></td>
<td>
<p>L-moments and further parameters for <code>qua...</code></p>
</td></tr>
<tr><td><code id="qua_+3A_probability_distribution_attrname">probability_distribution_attrname</code></td>
<td>
<p>attribute name for probability distribution</p>
</td></tr>
<tr><td><code id="qua_+3A_distrib">distrib</code></td>
<td>
<p>character string indicating the probability distribution, it can be used in case <code>para</code> has no attributes. Default is <code>NA</code> and distribution info are all passed through <code>para</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of quantiles. It is a list of vectors of quantiles in case of several probability parametric distribution functions (i.e. <code>para</code> is a list and <code>length(para)&gt;1</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pel">pel</a></code>,<code><a href="lmom.html#topic+quaexp">quaexp</a></code>,<code><a href="lmom.html#topic+quagam">quagam</a></code>,<code><a href="lmom.html#topic+quagev">quagev</a></code>,<code><a href="lmom.html#topic+quaglo">quaglo</a></code>,<code><a href="lmom.html#topic+quagpa">quagpa</a></code>,<code><a href="lmom.html#topic+quagno">quagno</a></code>,<code><a href="lmom.html#topic+quagum">quagum</a></code>,
</p>
<p><code><a href="lmom.html#topic+quakap">quakap</a></code>,<code><a href="lmom.html#topic+qualn3">qualn3</a></code>,<code><a href="lmom.html#topic+quanor">quanor</a></code>,<code><a href="lmom.html#topic+quape3">quape3</a></code>,
<code><a href="lmom.html#topic+quawak">quawak</a></code>,<code><a href="lmom.html#topic+quawei">quawei</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Sample L-moments of Ozone from the airquality data
data(airquality)
lmom &lt;- samlmu(airquality$Ozone,nmom=6)

distrib &lt;- c("exp","gam","gev","glo","gpa","gno","gum","kap","ln3","nor",
	"pe3","wak","wei")

para_list &lt;- pel(distrib=distrib,lmom=lmom)
f &lt;- (1:10)/10
qua_list &lt;- qua(para=para_list,f=f)

qua_gam &lt;- qua(para=para_list$gam,f=f)
qua_gam2 &lt;- qua(para=as.vector(para_list$gam),f=f,distrib="gam")

if (any(qua_gam!=qua_gam2,na.rm=TRUE)) stop("Any possible errors after  0.6.3 package updates!") 


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
