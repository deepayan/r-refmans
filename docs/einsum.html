<!DOCTYPE html><html><head><title>Help for package einsum</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {einsum}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#einsum'><p>Einstein Summation</p></a></li>
<li><a href='#einsum_package'><p>Einstein Summation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Einstein Summation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>The summation notation suggested by Einstein (1916) &lt;<a href="https://doi.org/10.1002%2Fandp.19163540702">doi:10.1002/andp.19163540702</a>&gt; is a 
  concise mathematical notation that implicitly sums over repeated indices of n-dimensional arrays. Many ordinary
  matrix operations (e.g. transpose, matrix multiplication, scalar product, 'diag()', trace etc.)
  can be written using Einstein notation. The notation is particularly convenient for 
  expressing operations on arrays with more than two dimensions because the 
  respective operators ('tensor products') might not have a standardized name.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, covr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>mathjaxr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, glue, mathjaxr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://const-ae.github.io/einsum/">https://const-ae.github.io/einsum/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/const-ae/einsum/issues">https://github.com/const-ae/einsum/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-28 14:17:21 UTC; ahlmanne</td>
</tr>
<tr>
<td>Author:</td>
<td>Constantin Ahlmann-Eltze
    <a href="https://orcid.org/0000-0002-3762-068X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Constantin Ahlmann-Eltze &lt;artjom31415@googlemail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-28 14:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='einsum'>Einstein Summation</h2><span id='topic+einsum'></span><span id='topic+einsum_generator'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>Einstein summation is a convenient and concise notation for operations
on n-dimensional arrays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>einsum(equation_string, ...)

einsum_generator(equation_string, compile_function = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="einsum_+3A_equation_string">equation_string</code></td>
<td>
<p>a string in Einstein notation where arrays
are separated by ',' and the result is separated by '-&gt;'. For
example <code>"ij,jk-&gt;ik"</code> corresponds to a standard matrix multiplication.
Whitespace inside the <code>equation_string</code> is ignored. Unlike the
equivalent functions in Python, <code>einsum()</code> only supports the explicit
mode. This means that the <code>equation_string</code> must contain '-&gt;'.</p>
</td></tr>
<tr><td><code id="einsum_+3A_...">...</code></td>
<td>
<p>the arrays that are combined. All arguments are converted
to arrays with <code>as.array</code>.</p>
</td></tr>
<tr><td><code id="einsum_+3A_compile_function">compile_function</code></td>
<td>
<p>boolean that decides if <code>einsum_generator()</code>
returns the result of <code>Rcpp::cppFunction()</code> or the program as a
string. Default: <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following table show, how the Einstein notation abbreviates complex
summation for arrays/matrices:
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code>equation_string</code> </td><td style="text-align: right;"> Formula </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  ------------------------</td><td style="text-align: right;">--------------------------------------</td><td style="text-align: right;">----------------------------------</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>"ij,jk-&gt;ik"</code> </td><td style="text-align: right;"> \( Y_{ik} = \sum_{j}{A_{ij} B_{jk}}  \) </td><td style="text-align: right;"> Matrix multiplication </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>"ij-&gt;ji"</code>` </td><td style="text-align: right;"> \( Y = A^{T}  \) </td><td style="text-align: right;"> Transpose </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>"ii-&gt;i"</code> </td><td style="text-align: right;"> \(y = \textrm{diag}(A)\) </td><td style="text-align: right;"> Diagonal </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>"ii-&gt;ii"</code> </td><td style="text-align: right;"> \(Y = \textrm{diag}(A) I\) </td><td style="text-align: right;"> Diagonal times Identity  </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>"ii-&gt;"</code> </td><td style="text-align: right;"> \(y = \textrm{trace}(A) = \sum_i{A_{ii}} \) </td><td style="text-align: right;"> Trace </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>"ijk,mjj-&gt;i"</code> </td><td style="text-align: right;"> \( y_i = \sum_{j}\sum_{k}\sum_{m}A_{ijk}B_{mjj}  \) </td><td style="text-align: right;"> Complex 3D operation  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The function and the conventions are inspired by the <code>einsum()</code> function
in NumPy (<a href="https://numpy.org/doc/stable/reference/generated/numpy.einsum.html">documentation</a>).
Unlike NumPy, 'einsum' only supports the explicit mode. The explicit mode is more flexible and
can avoid confusion. The common summary of the Einstein  summation to
&quot;sum over duplicated indices&quot; however is not a good mental model. A better rule of thumb is
&quot;sum over all indices not in the result&quot;.
</p>
<p><em>Note:</em> <code>einsum()</code> internally uses C++ code to provide results quickly, the repeated
parsing of the <code>equation_string</code> comes with some overhead. Thus,
if you need to do the same calculation over and over again it can be worth to use
<code>einsum_generator()</code> and call the returned the function. <code>einsum_generator()</code>
generates efficient C++ code that can be one or two orders of magnitude faster than
<code>einsum()</code>.
</p>


<h3>Value</h3>

<p>The <code>einsum()</code> function returns an array with one dimension for each index in the result
of the <code>equation_string</code>. For example <code>"ij,jk-&gt;ik"</code> produces a 2-dimensional array,
<code>"abc,cd,de-&gt;abe"</code> produces a 3-dimensional array.
</p>
<p>The <code>einsum_generator()</code> function returns a function that takes one array for each
comma-separated input in the <code>equation_string</code> and returns the same result as <code>einsum()</code>.
Or if <code>compile_function = FALSE</code>, <code>einsum_generator()</code> function returns a string with the
C++ code for such a function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mat1 &lt;- matrix(rnorm(n = 4 * 8), nrow = 4, ncol = 8)
mat2 &lt;- matrix(rnorm(n = 8 * 3), nrow = 8, ncol = 3)

# Matrix Multiply
mat1 %*% mat2
einsum("ij,jk -&gt; ik", mat1, mat2)

# einsum_generator() works just like einsum() but returns a performant function
mat_mult &lt;- einsum_generator("ij,jk -&gt; ik")
mat_mult(mat1, mat2)

# Diag
mat_sq &lt;- matrix(rnorm(n = 4 * 4), nrow = 4, ncol = 4)
diag(mat_sq)
einsum("ii-&gt;i", mat_sq)
einsum("ii-&gt;ii", mat_sq)

# Trace
sum(diag(mat_sq))
einsum("ii-&gt;", mat_sq)


# Scalar product
mat3 &lt;- matrix(rnorm(n = 4 * 8), nrow = 4, ncol = 8)
mat3 * mat1
einsum("ij,ij-&gt;ij", mat3, mat1)

# Transpose
t(mat1)
einsum("ij-&gt;ji", mat1)


# Batched L2 norm
arr1 &lt;- array(c(mat1, mat3), dim = c(dim(mat1), 2))
c(sum(mat1^2), sum(mat3^2))
einsum("ijb,ijb-&gt;b", arr1, arr1)

</code></pre>

<hr>
<h2 id='einsum_package'>Einstein Summation</h2><span id='topic+einsum_package'></span><span id='topic+einsum-package'></span>

<h3>Description</h3>

<p>Einstein summation is a concise mathematical notation that
implicitly sums over repeated indices of n-dimensional arrays. Many ordinary
matrix operations (e.g. transpose, matrix multiplication, scalar product, 'diag()', trace etc.)
can be written using Einstein notation. The notation is particularly convenient for
expressing operations on arrays with more than two dimensions because the
respective operators ('tensor products') might not have a standardized name.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
