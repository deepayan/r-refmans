<!DOCTYPE html><html><head><title>Help for package NPCirc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NPCirc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ancova.circ.lin'><p>Nonparametric analysis of covariance tests for circular regression</p></a></li>
<li><a href='#bw.AA'><p>Direct and solve-the-equation plug-in rule</p></a></li>
<li><a href='#bw.boot'><p> Bootstrap method</p></a></li>
<li><a href='#bw.circ.local.lik'><p>Smoothing parameter selection for circular local likelihood regression</p>
</a></li>
<li><a href='#bw.CV'><p> Cross-validation for density estimation</p></a></li>
<li><a href='#bw.joint.dpcirc'>
<p>Smoothing parameter selection for circular double Poisson regression</p></a></li>
<li><a href='#bw.modalreg.circ.lin'><p>Smoothing parameter selection for circular multimdodal regression</p>
</a></li>
<li><a href='#bw.pi'><p> Plug&ndash;in rule</p></a></li>
<li><a href='#bw.reg.circ.lin'><p> Cross-validation rule for circular regression estimation</p></a></li>
<li><a href='#bw.rt'><p> Rule of thumb</p></a></li>
<li><a href='#circ.local.lik'><p>Local likelihood estimation for regression with circular covariate</p>
</a></li>
<li><a href='#circsizer.density'><p> CircSiZer map for density</p></a></li>
<li><a href='#circsizer.map'><p> CircSiZer map</p></a></li>
<li><a href='#circsizer.regression'><p> CircSiZer map for regression</p></a></li>
<li><a href='#cross.beds1'><p> Cross-beds azimuths (I)</p></a></li>
<li><a href='#cross.beds2'><p> Cross-beds (II)</p></a></li>
<li><a href='#cycle.changes'><p> Cycle changes</p></a></li>
<li><a href='#dcircmix'><p> Mixtures of circular distributions</p></a></li>
<li><a href='#dpreg.circ'>
<p>Joint parametric estimation of mean and dispersion functions in circular double Poisson models</p></a></li>
<li><a href='#dragonfly'><p> Orientations of dragonflies</p></a></li>
<li><a href='#dwsn'><p> Wrapped skew-Normal density function</p></a></li>
<li><a href='#flywheels'>
<p>Flywheel measurements</p></a></li>
<li><a href='#HumanMotorResonance'>
<p>Human motor resonance data</p></a></li>
<li><a href='#kern.den.circ'>
<p>Kernel density derivative estimate for circular data</p></a></li>
<li><a href='#kern.dpreg.circ'>
<p>Joint kernel estimation of mean and dispersion functions in circular double Poisson models</p></a></li>
<li><a href='#kern.reg.circ.lin'><p> Nonparametric regression estimation for circular data</p></a></li>
<li><a href='#lines.regression.circular'><p> Add a plot for circular regression</p></a></li>
<li><a href='#modalreg.circ.lin'><p>Circular multimodal regression estimation</p>
</a></li>
<li><a href='#noeffect.circ.lin'><p>No-effect test for regression with circular data</p></a></li>
<li><a href='#NPCirc-internal'><p>Internal NPCirc Functions</p></a></li>
<li><a href='#NPCirc-package'>
<p>Nonparametric circular methods.</p></a></li>
<li><a href='#periwinkles'><p> Orientations of dragonflies</p></a></li>
<li><a href='#plot.regression.circular'><p> Plot circular regression</p></a></li>
<li><a href='#pm10'>
<p>Pm10 particles in Pontevedra, Spain</p></a></li>
<li><a href='#sandhoppers'>
<p>Behavioral plasticity of Talitrus saltator and Talorchestia brito</p></a></li>
<li><a href='#speed.wind'><p> Wind speed and wind direction data</p></a></li>
<li><a href='#spikes'>
<p>Neuronal spikes in a macaque monkey</p></a></li>
<li><a href='#temp.wind'><p> Temperature and wind direction data</p></a></li>
<li><a href='#wind'><p> Wind direction data</p></a></li>
<li><a href='#zebrafish'>
<p>Zebrafish</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Circular Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Maria Alonso-Pena [aut, cre], 
		Maria Oliveira [aut], 
		Jose Ameijeiras-Alonso [aut], 
		Rosa M. Crujeiras [aut], 
		Irene Gijbels [aut],
		Alberto Rodriguez-Casal [aut],
		Felicita Scapini [dtc]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maria Alonso-Pena &lt;maria.alonsopena@kuleuven.be&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Nonparametric smoothing methods for density and regression estimation involving circular data, 
				including the estimation of the mean regression function and other conditional characteristics.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0), circular</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.8.3), misc3d, movMF, plotrix, rgl, shape,
Bolstad2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-09 12:50:54 UTC; u0158054</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-10 13:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='ancova.circ.lin'>Nonparametric analysis of covariance tests for circular regression</h2><span id='topic+ancova.circ.lin'></span><span id='topic+ancova.lin.circ'></span><span id='topic+ancova.circ.circ'></span>

<h3>Description</h3>

<p>Function <code>ancova.circ.lin</code> computes nonparametric ANCOVA tests to compare regression curves with a circular predictor variable and a real-valued response variable. The null hypothesis may be either equality or parallelism of the regression curves, as described in Alonso-Pena et al. (2021). It uses the nonparametric Nadaraya-Watson estimator or the Local-Linear estimator for circular-linear data described in Di Marzio et al. (2009) and Oliveira et al. (2013).
</p>
<p>Function <code>ancova.lin.circ</code> computes nonparametric ANCOVA tests to compare regression curves with a real-valued predictor variable and a circular response variable. The null hypothesis may be either equality or parallelism of the regression curves, as described in Alonso-Pena et al. (2021). It uses the nonparametric Nadaraya-Watson estimator or the Local-Linear estimator for linear-circular data described in Di Marzio et al. (2012).
</p>
<p>Function <code>ancova.circ.circ</code> computes nonparametric ANCOVA tests to compare regression curves with a circular predictor variable and a circular response variable. The null hypothesis may be either equality or parallelism of the regression curves, as described in Alonso-Pena et al. (2021). It uses the nonparametric Nadaraya-Watson estimator or the Local-Linear estimator for circular-circular data described in Di Marzio et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ancova.circ.lin(x, y, g, bw, bw1, test = "eq", method = "LL",calib = "chisq", 
   n_boot = 500)
ancova.lin.circ(x, y, g, bw, bw1, test = "eq", method = "LL", n_boot = 500)
ancova.circ.circ(x, y, g, bw, bw1, test = "eq", method = "LL", n_boot = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ancova.circ.lin_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>ancova.circ.lin</code> and <code>ancova.circ.circ</code>.</p>
</td></tr>
<tr><td><code id="ancova.circ.lin_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as <code>x</code>. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>ancova.lin.circ</code> and <code>ancova.circ.circ</code>.</p>
</td></tr>
<tr><td><code id="ancova.circ.lin_+3A_g">g</code></td>
<td>
<p>Vector of group indicators.</p>
</td></tr>
<tr><td><code id="ancova.circ.lin_+3A_bw">bw</code></td>
<td>
<p>Smoothing parameter to be used. If not provided it selects the parameter obtained by cross-validation.</p>
</td></tr>
<tr><td><code id="ancova.circ.lin_+3A_bw1">bw1</code></td>
<td>
<p>Preliminary smoothing parameter for the parallelism test.</p>
</td></tr>
<tr><td><code id="ancova.circ.lin_+3A_test">test</code></td>
<td>
<p>Character string giving the type of test to be performed. Must be one of <code>"eq"</code> for the test of equality or <code>"paral"</code> for the test of parallelism. Default is <code>test="eq"</code>.</p>
</td></tr>
<tr><td><code id="ancova.circ.lin_+3A_method">method</code></td>
<td>
<p>Character string giving the estimator to be used. This must be one of <code>"LL"</code> for Local-Linear estimator or <code>"NW"</code> for Nadaraya-Watson estimator. Default <code>method="LL"</code>.</p>
</td></tr>
<tr><td><code id="ancova.circ.lin_+3A_calib">calib</code></td>
<td>
<p>Character string giving the calibration method to be used in <code>ancova.circ.lin</code> function. This must be one of <code>"chisq"</code> for the chi-squared approximation or <code>"boot"</code> for the bootstrap calibration.</p>
</td></tr>
<tr><td><code id="ancova.circ.lin_+3A_n_boot">n_boot</code></td>
<td>
<p>Number of bootstrap resamples. Default is <code>n_boot=500</code>. In function <code>ancova.circ.lin</code>, only if <code>calib="boot"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Alonso-Pena et al. (2021). The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>observed value of the statistic.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Smoothing parameter used.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value for the test.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Alonso-Pena, Jose Ameijeiras-Alonso and Rosa M. Crujeiras
</p>


<h3>References</h3>

<p>Alonso-Pena, M., Ameijeiras-Alonso, J. and Crujeiras, R.M. (2021) Nonparametric tests for circular regression. <em>Journal of Statistical Computation and Simulation</em>, <b>91</b>(3), 477&ndash;500.
</p>
<p>Di Marzio, M., Panzera A. and Taylor, C. C. (2009) Local polynomial regression for circular predictors. <em>Statistics and Probability Letters</em>, <b>79</b>, 2066&ndash;2075.
</p>
<p>Di Marzio, M., Panzera A. and Taylor, C. C. (2012) Non&ndash;parametric regression for circular responses. <em>Scandinavian Journal of Statistics</em>, <b>40</b>, 228&ndash;255.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez-Casal, A. (2013) Nonparametric circular methods for exploring environmental data. <em>Environmental and Ecological Statistics</em>, <b>20</b>, 1&ndash;17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.reg.circ.lin">kern.reg.circ.lin</a></code>, <code><a href="#topic+kern.reg.lin.circ">kern.reg.lin.circ</a></code>, <code><a href="#topic+kern.reg.circ.circ">kern.reg.circ.circ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ANCOVA circ-lin
set.seed(2025)
x1 &lt;- rcircularuniform(100)
x2 &lt;- rcircularuniform(100)
x &lt;- c(x1, x2)
y1 &lt;- 2*sin(as.numeric(x1)) + rnorm(100, sd=2)
y2 &lt;- 4 + 2*sin(as.numeric(x2)) + rnorm(100, sd=2)
y &lt;- c(y1, y2)
g &lt;- c(rep(0,100), rep(1,100))
ancova.circ.lin(x, y, g,  test = "eq")
ancova.circ.lin(x, y, g,  test = "paral")


# ANCOVA lin-circ
set.seed(2025)
x1 &lt;- runif(100)
x2 &lt;- runif(100)
y1 &lt;- 3*pi*x1^2 + rvonmises(100, mu = 0, kappa = 6)
y2 &lt;- 2*pi/8 + 3*pi*x2^2 + rvonmises(100, mu = 0, kappa = 6)
x &lt;- c(x1, x2)
y &lt;- c(y1, y2)
g&lt;-c(rep(0, 100), rep(1, 100))
ancova.lin.circ(x, y, g,  test = "eq")
ancova.lin.circ(x, y, g,  test = "paral")


# ANCOVA circ-circ
set.seed(2025)
x1 &lt;- rcircularuniform(100)
x2 &lt;- rcircularuniform(100)
y1 &lt;- 2*sin(2*x1) + rvonmises(100, mu = 0, kappa = 8 )
y2 &lt;- pi/8 + 2*sin(2*x2) + rvonmises(100, mu = 0, kappa = 8 )
x &lt;- c(x1, x2)
y &lt;- c(y1, y2)
g&lt;-c(rep(0, 100), rep(1, 100))
ancova.circ.circ(x, y, g,  test = "eq")
ancova.circ.circ(x, y, g,  test = "paral")

</code></pre>

<hr>
<h2 id='bw.AA'>Direct and solve-the-equation plug-in rule</h2><span id='topic+bw.AA'></span>

<h3>Description</h3>

<p>Smoothing selectors for the circular kernel density (and its derivatives) estimator. This function implements the l-stage solve-the-equation and direct plug-in smoothing selector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.AA(x,deriv.order=0,method = c("ste","dpi"),nstage=2,kernel="vonmises",M=NULL,
      commonkappa=TRUE,Q1=NULL,Q2=NULL,lower=NULL,upper=NULL,tol=NULL,
      approximate=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.AA_+3A_x">x</code></td>
<td>
<p> Data from which the smoothing parameter is to be computed. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_deriv.order">deriv.order</code></td>
<td>
<p> Derivative order. Default <code>deriv.order=0</code> (density estimation).</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_method">method</code></td>
<td>
<p> Either <code>"ste"</code> (solve-the-equation) or <code>"dpi"</code> (direct plug-in). Can be abbreviated.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_nstage">nstage</code></td>
<td>
<p> Number of stages in the plug-in smoothing parameter. Default <code>nstage=2</code>.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_kernel">kernel</code></td>
<td>
<p> A character string giving the smoothing kernel to be used. This must be one of <code>vonmises</code> or <code>wrappednormal</code>. Default <code>kernel=vonmises</code>.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_m">M</code></td>
<td>
<p> Integer indicating the number of components in the von Mises mixture at stage 0. If <code>M</code> is a vector, AIC will be used, to select the number of components between the indicated values of <code>M</code>. Default, <code>M=1</code> if method <code>"ste"</code>, <code>M=1:5</code> if method <code>"dpi"</code>.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_commonkappa">commonkappa</code></td>
<td>
<p> Logical; if <code>TRUE</code>, at stage 0, all the components in the von Mises mixture have the same concentration. Default, <code>commonkappa=T</code>.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_q1">Q1</code></td>
<td>
<p>Vector of constants related to the kernel to derive the explicit expression of the optimal smoothing parameters of the density functionals. Its value is provided by default when using the <code>"vonmises"</code> or <code>"wrappednormal"</code> as <code>kernel</code>.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_q2">Q2</code></td>
<td>
<p>Constant related to the kernel to derive the explicit expression of the optimal smoothing parameters of the density derivative. Its value is provided by default when using the <code>"vonmises"</code> or <code>"wrappednormal"</code> as <code>kernel</code>.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_lower">lower</code>, <code id="bw.AA_+3A_upper">upper</code></td>
<td>
<p> For method <code>"ste"</code>, the range over which the bandwidth h is searched. Default, <code>lower=10^(-3)</code> and <code>upper=pi^2/3</code> if <code>kernel="vonmises"</code>; <code>lower=10^(-10)</code> and <code>upper=0.5</code>, otherwise.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_tol">tol</code></td>
<td>
<p> For method <code>"ste"</code>, the convergence tolerance for searching the smoothing parameter with <code><a href="stats.html#topic+uniroot">uniroot</a></code>. Default, <code>tol=.Machine$double.eps^0.25</code>.</p>
</td></tr>
<tr><td><code id="bw.AA_+3A_approximate">approximate</code></td>
<td>
<p> For method <code>"dpi"</code>, logical, if <code>TRUE</code>, the explicit expressions (relying on asymptotics) for the optimal smoothing parameters are employed. If <code>FALSE</code>, an optimization routine is employed, searching for the smoothing parameter minimizing the asymptotic mean squared error of the density derivatives and functionals. Default, <code>approximate=T</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, this function computes the solve-the-equation plug-in rule for circular kernel density estimation. If <code>method="dpi"</code>, this function computes the direct plug-in rule.
</p>
<p>At stage 0, a mixture of von Mises is employed for computing the rule of thumb. The reason for employing a mixture model is that the von Mises estimates a uniform density when the true density model is k-fold rotational symmetric. Thus, in that case, the density functional estimator would be close to zero.
</p>
<p>The number of components in the mixture is controlled with <code>M</code>. By default, a von Mises density (<code>M=1</code>) is employed in <code>method="ste"</code>. For <code>method="dpi"</code>, by default, the number of components in the mixture is selected using the Akaike Information Criterion, by comparing a mixture of 1 to 5 components. For simplicity, by default, the same concentration parameter is employed in all the components. This may be changed by setting <code>commonkappa=F</code>.
</p>
<p>For <code>method="ste"</code>, the minimum number of stages is two (<code>nstage=2</code>). Otherwise, the solve-the-equation rule cannot be computed. A rule of thumb can be computed with <code>method="dpi"</code> and <code>nstage=0</code>.
</p>


<h3>Value</h3>

<p>Value of the smoothing parameter (mean resultant length). When the kernel is <code>vonmises</code> the bandwidth is equal to the concentration parameter.
</p>


<h3>Author(s)</h3>

<p>Jose Ameijeiras-Alonso.
</p>


<h3>References</h3>

<p>Ameijeiras-Alonso, J. (2022). A reliable data-based smoothing parameter selection method for circular kernel estimation.
</p>


<h3>See Also</h3>

<p><code><a href="circular.html#topic+density.circular">density.circular</a></code>, <a href="#topic+kern.den.circ">kern.den.circ</a>, <code><a href="#topic+bw.pi">bw.pi</a></code>, <code><a href="#topic+bw.rt">bw.rt</a></code>, <code><a href="#topic+bw.CV">bw.CV</a></code>, <code><a href="#topic+bw.boot">bw.boot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2022)
n &lt;- 50
x &lt;- rcircmix(n,model=6)
# Concentration parameter for density estimation
bw.AA(x) # Solve-the-equation concentration parameter
bw.AA(x, method="dpi") # Direct plug-in concentration parameter
# Concentration parameter for the density derivative estimate
bw.AA(x, method="ste") # Solve-the-equation concentration parameter
bw.AA(x, deriv.order=1, method="dpi") # Direct plug-in concentration parameter
</code></pre>

<hr>
<h2 id='bw.boot'> Bootstrap method </h2><span id='topic+bw.boot'></span>

<h3>Description</h3>

<p>This function implements the bootstrap procedure proposed by Di Marzio et al. (2011) for selecting the smoothing parameter for density estimation taking
the von Mises density as kernel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.boot(x, lower=0, upper=100, np=500, tol=0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.boot_+3A_x">x</code></td>
<td>
<p> Data from which the smoothing parameter is to be computed. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="bw.boot_+3A_lower">lower</code>, <code id="bw.boot_+3A_upper">upper</code></td>
<td>
 <p><code>lower</code> and <code>upper</code> boundary of the interval to be used in the search for the value of the smoothing parameter. Default
<code>lower=0</code> and <code>upper=100</code>.</p>
</td></tr>
<tr><td><code id="bw.boot_+3A_np">np</code></td>
<td>
<p> Number of points where to evaluate the estimator for numerical integration. Default <code>np=500</code>.</p>
</td></tr>
<tr><td><code id="bw.boot_+3A_tol">tol</code></td>
<td>
<p> Convergence tolerance for <code><a href="stats.html#topic+optimize">optimize</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is based on the proposal of Taylor (1989) for linear data. See also Oliveira et al. (2012).
The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>Value of the smoothing parameter.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Di Marzio, M., Panzera A. and Taylor, C.C. (2011) Kernel density estimation on the torus. <em>Journal of Statistical Planning and Inference</em>, <b>141</b>, 2156&ndash;2173.
</p>
<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal, A. (2012) A plug&ndash;in rule for bandwidth selection in circular density. <em>Computational Statistics and Data Analysis</em>, <b>56</b>, 3898&ndash;3908.
</p>
<p>Taylor, C.C. (1989) Bootstrap choice of the smoothing parameter in kernel density estimation. <em>Biometrika</em>, <b>76</b>, 705&ndash;712.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.den.circ">kern.den.circ</a></code>, <code><a href="#topic+bw.rt">bw.rt</a></code>, <code><a href="#topic+bw.CV">bw.CV</a></code>, <code><a href="#topic+bw.pi">bw.pi</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2012)
n &lt;- 100
x &lt;- rcircmix(n, model=17)
bw.boot(x, lower=0, upper=20)
</code></pre>

<hr>
<h2 id='bw.circ.local.lik'>Smoothing parameter selection for circular local likelihood regression

</h2><span id='topic+bw.circ.local.lik'></span>

<h3>Description</h3>


<p>Function <code>bw.circ.local.lik</code> computes values of the smoothing (concentration) parameter for local likelihood regression when the predictor is circular and the conditional density is either gaussian, Bernoulli, Poisson or gamma. The smoothing parameter can be selected by the refined rule, the CRSC rule or cross-validation, as described in Alonso-Pena et al. (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.circ.local.lik(x, y, t, rule = NULL, p, family, startv = NULL,
  lower = 0, upper = 50, lower_ast = 0, upper_ast = 15, tol = 0.00001,
  maxit = 300, from = circular(0), to = circular(2 * pi), len = 250)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.circ.local.lik_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_t">t</code></td>
<td>
<p> Points where the regression function  is estimated. If <code>NULL</code>, equally spaced points are used according to the parameters <code>from</code>, <code>to</code> and <code>len</code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_rule">rule</code></td>
<td>
<p>Character string giving the rule to be used to select the smoothing (concentration) parameter. This must be one of <code>"refined"</code> (only for <code>p = 1</code>), <code>"CRSC"</code> or <code>"cv"</code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_p">p</code></td>
<td>
<p>Degree of the local sine-polynomial to be used in the estimation process. It must be 1 or 3.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_family">family</code></td>
<td>
<p>Character string indicating the conditional density to be used. It must be one of <code>"gaussian"</code>, <code>"bernoulli"</code>, <code>"poisson"</code> or <code>"gamma"</code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_startv">startv</code></td>
<td>
<p>Vector containing the initial values for the estimation algorithm if family is set as <code>"bernoulli"</code>, <code>"poisson"</code> or <code>"gamma"</code>. The vector must be of length 2 if <code>p = 1</code> and length 4 if <code>p = 3</code>. If <code>NULL</code>, the initial parameters are the ones corresponding to the global mean of the responses.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_lower">lower</code>, <code id="bw.circ.local.lik_+3A_upper">upper</code></td>
<td>
<p>Lower and upper boundary of the interval to be used in the search for the value of the smoothing parameter. Default <code>lower = 0</code> and <code>upper = 50</code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_lower_ast">lower_ast</code>, <code id="bw.circ.local.lik_+3A_upper_ast">upper_ast</code></td>
<td>
<p>Lower and upper boundary of the interval to be used in the search for the value of the pilot smoothing parameter in the refined rule. Default <code>lower_ast = 0</code> and <code>upper_ast = 15</code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_tol">tol</code></td>
<td>
<p>Tolerance parameter for convergence in the numerical estimation. Only needed if family is one of <code>"bernoulli"</code>, <code>"poisson"</code> or <code>"gamma"</code>. Default is <code>tol = 0.00001</code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the numerical estimation. Only needed if family is one of <code>"bernoulli"</code>, <code>"poisson"</code> or <code>"gamma"</code>. Default is <code>maxit = 300</code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_from">from</code>, <code id="bw.circ.local.lik_+3A_to">to</code></td>
<td>
<p>Left and right-most points of the grid at which the density is to be estimated. The objects are coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="bw.circ.local.lik_+3A_len">len</code></td>
<td>
<p>Number of equally spaced points at which the density is to be estimated.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>For the <code>refined</code> rule, which is only available for <code>p = 1</code>, first a pilot concentration parameter is selected with the (E)CRSC rule using a sine-polynomial of degree 3, where the search is conducted between the values <code>lower_ast</code> and <code>upper_ast</code>. With the pilot smoothing parameter, the MISE of the estimator is approximated and the refined rule selects the parameter which minimizes the approximated MISE.
</p>
<p>The <code>CRSC</code> rule selects the parameter minimizing the Circular Residual Squares Criterion if <code>family = "gaussian"</code> and the Extended Circular Residual Squares Criterion in the other cases.
</p>
<p>The <code>cv</code> rule performs a cross-validation search.
</p>
<p>See Alonso-Pena et al. (2022) for more details.
</p>


<h3>Value</h3>






<p>Value of the smoothing parameter.
</p>


<h3>Author(s)</h3>


<p>Maria Alonso-Pena, Irene Gijbels and Rosa M. Crujeiras.
</p>


<h3>References</h3>


<p>Alonso-Pena, M., Gijbels, I. and Crujeiras, R.M. (2022). A general framework for circular local likelihood regression. <em>Under review</em>.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+circ.local.lik">circ.local.lik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(spikes)
direction&lt;-circular(spikes$direction,units="degrees")
counts&lt;-spikes$counts
bw.circ.local.lik(direction, counts, rule = "refined", p=1, family="poisson")

</code></pre>

<hr>
<h2 id='bw.CV'> Cross-validation for density estimation</h2><span id='topic+bw.CV'></span>

<h3>Description</h3>

<p>This function provides a least squares cross-validation smoothing parameter or a likelihood cross-validation smoothing parameter for density estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.CV(x, method="LCV", lower=0, upper=50, tol=1e-2, np=500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.CV_+3A_x">x</code></td>
<td>
<p> Data from which the smoothing parameter is to be computed. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="bw.CV_+3A_method">method</code></td>
<td>
<p> Character string giving the cross-validation rule to be used. This must be one of <code>"LCV"</code> or <code>"LSCV"</code>. Default <code>method="LCV"</code>.</p>
</td></tr>
<tr><td><code id="bw.CV_+3A_lower">lower</code>, <code id="bw.CV_+3A_upper">upper</code></td>
<td>
 <p><code>lower</code> and <code>upper</code> boundary of the interval to be used in the search for the value of the smoothing parameter. Default <code>lower=0</code> and <code>upper=50</code>.</p>
</td></tr>
<tr><td><code id="bw.CV_+3A_tol">tol</code></td>
<td>
<p> Convergence tolerance for <code><a href="stats.html#topic+optimize">optimize</a></code>. Default <code>tol=1e-2</code>.</p>
</td></tr>
<tr><td><code id="bw.CV_+3A_np">np</code></td>
<td>
<p>  Number of points where to evaluate the estimator for numerical integration when <code>method="LSCV"</code>. Default <code>np=500</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LCV smoothing parameter is obtained as the value of <code class="reqn">\nu</code> that maximizes the logarithm of the likelihood cross-validation function (8) in Oliveira et al. (2013).
The LSCV smoothing parameter is obtained as the value of <code class="reqn">\nu</code> that minimizes expression (7) in Oliveira et al. (2013).
See also Hall et al. (1987) and Oliveira et al. (2012).
The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>Value of the smoothing parameter.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Hall, P., Watson, G.S. and Cabrera, J. (1987) Kernel density estimation with spherical data, <em>Biometrika</em>, <b>74</b>, 751&ndash;762.
</p>
<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal, A. (2012) A plug&ndash;in rule for bandwidth selection in circular density. <em>Computational Statistics and Data Analysis</em>, <b>56</b>, 3898&ndash;3908.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2013) Nonparametric circular methods for exploring environmental data.
<em>Environmental and Ecological Statistics</em>, <b>20</b>, 1&ndash;17.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.den.circ">kern.den.circ</a></code>, <code><a href="#topic+bw.rt">bw.rt</a></code>, <code><a href="#topic+bw.pi">bw.pi</a></code>, <code><a href="#topic+bw.boot">bw.boot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2012)
n &lt;- 100
x &lt;- rcircmix(n, model=11)
bw.CV(x, method="LCV", lower=0, upper=20)
bw.CV(x, method="LSCV", lower=0, upper=20)
</code></pre>

<hr>
<h2 id='bw.joint.dpcirc'>
Smoothing parameter selection for circular double Poisson regression
</h2><span id='topic+bw.joint.dpcirc'></span>

<h3>Description</h3>

<p>Function <code>bw.joint.dpcirc</code> provides the smoothing parameters for the nonparametric joint estimator of the mean and dispersion functions when the conditional density is a double Poisson. It performs a joint cross-validation search. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.joint.dpcirc(x, y, startvmu = NULL, startvgam = NULL, lower=c(0.05,0.05), 
  upper=c(50,7),tol = 0.00001, maxit = 300)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.joint.dpcirc_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to class circular.</p>
</td></tr>
<tr><td><code id="bw.joint.dpcirc_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as x and should contain counts.</p>
</td></tr>
<tr><td><code id="bw.joint.dpcirc_+3A_startvmu">startvmu</code></td>
<td>
<p>Vector of length two containing the initial values for the parameters corresponding to the estimation of the mean.</p>
</td></tr>
<tr><td><code id="bw.joint.dpcirc_+3A_startvgam">startvgam</code></td>
<td>
<p>Vector of length two containing the initial values for the parameters corresponding to the estimation of the dispersion.</p>
</td></tr>
<tr><td><code id="bw.joint.dpcirc_+3A_lower">lower</code>, <code id="bw.joint.dpcirc_+3A_upper">upper</code></td>
<td>
<p>Vectors of length two with the <code>lower</code> and <code>upper</code> boundaries of the intervals to be used in the search for the values of the smoothing parameters. The first component of each corresponds to the parameter associated to the estimation of the mean, while the second component corresponds to the estimation of the dispersion.</p>
</td></tr>
<tr><td><code id="bw.joint.dpcirc_+3A_tol">tol</code></td>
<td>
<p>Tolerance parameter for convergence in the numerical estimation.</p>
</td></tr>
<tr><td><code id="bw.joint.dpcirc_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the numerical estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Alonso-Pena et al. (2022) for details.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>A vector of length two with the first component being the value of the smoothing parameter associated to the mean estimation and with the second component being the value of the smoothing parameter associated to the dispersion estimation.
</p>


<h3>Author(s)</h3>

<p>Maria Alonso-Pena, Irene Gijbels and Rosa M. Crujeiras
</p>


<h3>References</h3>

<p>Alonso-Pena, M., Gijbels, I. and Crujeiras, R.M. (2022). Flexible joint modeling of mean and dispersion for the directional tuning of neuronal spike counts. <em>Under review</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.dpreg.circ">kern.dpreg.circ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(spikes)
direction&lt;-circular(spikes$direction,units="degrees")
counts&lt;-spikes$counts
bw.joint.dpcirc(direction, counts, lower=c(0.5,0.5), upper=c(50,7))

</code></pre>

<hr>
<h2 id='bw.modalreg.circ.lin'>Smoothing parameter selection for circular multimdodal regression

</h2><span id='topic+bw.modalreg.circ.lin'></span><span id='topic+bw.modalreg.lin.circ'></span><span id='topic+bw.modalreg.circ.circ'></span>

<h3>Description</h3>


<p>Function <code>bw.modalreg.circ.lin</code> provides the modal cross-validation smoothing parameters for the multimodal regression estimator when the covariate is circular and the response variable is linear.
</p>
<p>Function <code>bw.modalreg.circ.circ</code> provides the modal cross-validation smoothing parameters for the multimodal regression estimator when the covariate and the response variable are circular.
</p>
<p>Function <code>bw.modalreg.lin.circ</code> provides the modal cross-validation smoothing parameters for the multimodal regression estimator when the covariate is linear and the response variable is circular.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
bw.modalreg.circ.lin(x, y, lower = NULL, upper = NULL, maxit = 500, tol = 0.00001)
bw.modalreg.circ.circ(x, y, lower = NULL, upper = NULL, maxit = 500, tol = 0.00001)
bw.modalreg.lin.circ(x, y, lower = NULL, upper = NULL, maxit = 500, tol = 0.00001)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.modalreg.circ.lin_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to class circular when using functions bw.modalreg.circ.lin and bw.modalreg.circ.circ.</p>
</td></tr>
<tr><td><code id="bw.modalreg.circ.lin_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as x. The object is coerced to class circular when using functions bw.modalreg.circ.circ and bw.modalreg.lin.circ.</p>
</td></tr>
<tr><td><code id="bw.modalreg.circ.lin_+3A_lower">lower</code>, <code id="bw.modalreg.circ.lin_+3A_upper">upper</code></td>
<td>
<p>Vectors of length two with the <code>lower</code> and <code>upper</code> boundaries of the intervals to be used in the search for the values of the smoothing parameters.</p>
</td></tr>
<tr><td><code id="bw.modalreg.circ.lin_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the estimation through the conditional (circular) mean shift.</p>
</td></tr>
<tr><td><code id="bw.modalreg.circ.lin_+3A_tol">tol</code></td>
<td>
<p>Tolerance parameter for convergence in the estimation through the conditional (circular) mean shift.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>See Alonso-Pena and Crujeiras (2022) for details.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>






<p>A vector of length two with the first component being the value of the smoothing parameter associated to the predictor variable and with the second component being the value of the smoothing parameter associated to the response variable.
</p>


<h3>Author(s)</h3>


<p>Maria Alonso-Pena and Rosa M. Crujeiras.
</p>


<h3>References</h3>


<p>Alonso-Pena, M. and Crujeiras, R. M. (2022). Analizing animal escape data with circular nonparametric multimodal regression. Annals of Applied Statistics. (To appear).
</p>


<h3>See Also</h3>


<p><code><a href="#topic+modalreg.circ.lin">modalreg.circ.lin</a></code>, <code><a href="#topic+modalreg.circ.circ">modalreg.circ.circ</a></code>, <code><a href="#topic+modalreg.lin.circ">modalreg.lin.circ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Circ-lin
  set.seed(8833)
  n1&lt;-100
  n2&lt;-100
  gamma&lt;-8
  sigma&lt;-1.5
  theta1&lt;-rcircularuniform(n1)
  theta2&lt;-rcircularuniform(n2)
  theta&lt;-c(theta1,theta2)
  y1&lt;-2*sin(2*theta1)+rnorm(n1,sd=sigma)
  y2&lt;-gamma+2*sin(2*theta2)+rnorm(n2,sd=sigma)
  y&lt;-as.numeric(c(y1,y2))
  bw&lt;-bw.modalreg.circ.lin(theta, y)
  
  # Lin-circ
  n1&lt;-100
  n2&lt;-100
  con&lt;-8
  set.seed(8833)
  x1&lt;-runif(n1)
  x2&lt;-runif(n2)
  phi1&lt;-(6*atan(2.5*x1-3)+rvonmises(n1,m=0,k=con))
  phi2&lt;-(pi+6*atan(2.5*x2-3)+rvonmises(n2,m=0,k=con))
  x&lt;-c(x1,x2)
  phi&lt;-c(phi1,phi2)
  bw&lt;-bw.modalreg.lin.circ(x, phi)
  
  # Circ-circ
  n1&lt;-100
  n2&lt;-100
  con&lt;-10
  set.seed(8833)
  theta1&lt;-rcircularuniform(n1)
  theta2&lt;-rcircularuniform(n2)
  phi1&lt;-(2*cos(theta1)+rvonmises(n1,m=0,k=con))
  phi2&lt;-(3*pi/4+2*cos(theta2)+rvonmises(n2,m=0,k=con))
  theta=c(theta1,theta2)
  phi=c(phi1,phi2)
  bw&lt;-bw.modalreg.lin.circ(theta, phi)

</code></pre>

<hr>
<h2 id='bw.pi'> Plug&ndash;in rule </h2><span id='topic+bw.pi'></span>

<h3>Description</h3>

<p>This function implements the von Mises scale plug-in rule for the smoothing parameter for density estimation when the number of components in the mixture
is selected by Akaike Information Criterion (AIC) which selects the best model between a mixture of 2-5 von Mises distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.pi(x, M=NULL, lower=0, upper=100, np=500, tol=0.1, outM=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.pi_+3A_x">x</code></td>
<td>
<p> Data from which the smoothing parameter is to be computed. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="bw.pi_+3A_m">M</code></td>
<td>
<p> Integer indicating the number of components in the mixture. If <code>M=1</code>, the rule of thumb is carried out with <code class="reqn">\kappa</code> estimated by
maximum likelihood. If <code>M=NULL</code>, AIC will be used.</p>
</td></tr>
<tr><td><code id="bw.pi_+3A_lower">lower</code>, <code id="bw.pi_+3A_upper">upper</code></td>
<td>
 <p><code>lower</code> and <code>upper</code> boundary of the interval to be used in the search for the value of the smoothing parameter. Default
<code>lower=0</code> and <code>upper=100</code>.</p>
</td></tr>
<tr><td><code id="bw.pi_+3A_np">np</code></td>
<td>
<p> Number of points where to evaluate the estimator for numerical integration. Default <code>np=500</code>.</p>
</td></tr>
<tr><td><code id="bw.pi_+3A_tol">tol</code></td>
<td>
<p> Convergence tolerance for <code><a href="stats.html#topic+optimize">optimize</a></code>. Default <code>tol=0.1</code>.</p>
</td></tr>
<tr><td><code id="bw.pi_+3A_outm">outM</code></td>
<td>
<p> Logical; if <code>TRUE</code> the function also returns the number of components in the mixture. Default, <code>outM=FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of the smoothing parameter is chosen by minimizing the asymptotic mean integrated squared error (AMISE) derived by Di Marzio et al. (2009)
assuming that the data follow a mixture of von Mises distributions. The number of components in the mixture can be fixed by the user, by specifying
the argument <code>M</code> or selected by using AIC (default option) as described in Oliveira et al. (2012).
The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>Vector with the value of the smoothing parameter and the number of components in the mixture (if specified).
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal, A. (2012) A plug&ndash;in rule for bandwidth selection in circular density. <em>Computational
Statistics and Data Analysis</em>, <b>56</b>, 3898&ndash;3908.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.den.circ">kern.den.circ</a></code>, <code><a href="#topic+bw.rt">bw.rt</a></code>, <code><a href="#topic+bw.CV">bw.CV</a></code>, <code><a href="#topic+bw.boot">bw.boot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2012)
n &lt;- 100
x &lt;- rcircmix(n,model=18)
bw.pi(x, M=3)
bw.pi(x, outM=TRUE)  # Using AIC
</code></pre>

<hr>
<h2 id='bw.reg.circ.lin'> Cross-validation rule for circular regression estimation </h2><span id='topic+bw.reg.circ.lin'></span><span id='topic+bw.reg.circ.circ'></span><span id='topic+bw.reg.lin.circ'></span>

<h3>Description</h3>

<p>Function <code>bw.reg.circ.lin</code> provides the least squares cross-validation smoothing parameter for the Nadaraya-Watson and Local-Linear estimators when the covariate
is circular and the response variable is linear.
</p>
<p>Function <code>bw.reg.circ.circ</code> provides the least squares cross-validation smoothing parameter for the Nadaraya-Watson and Local-Linear estimators when the covariate
and the response variable are circular.
</p>
<p>Function <code>bw.reg.lin.circ</code> provides the least squares cross-validation smoothing parameter for the Nadaraya-Watson and Local-Linear estimators when the covariate
is linear and the response variable is circular.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.reg.circ.lin(x, y, method="LL", lower=0, upper=50, tol=1e-2)
bw.reg.circ.circ(x, y, method="LL", option=1, lower=0, upper=50, tol=1e-2)
bw.reg.lin.circ(x, y, method="LL", option=1, lower=0, upper=50, tol=1e-2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.reg.circ.lin_+3A_x">x</code></td>
<td>
<p> Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>bw.reg.circ.lin</code> and <code>bw.reg.circ.circ</code>.</p>
</td></tr>
<tr><td><code id="bw.reg.circ.lin_+3A_y">y</code></td>
<td>
<p> Vector of data for the dependent variable. This must be same length as <code>x</code>. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>bw.reg.circ.circ</code> and <code>bw.reg.lin.circ</code>.</p>
</td></tr>
<tr><td><code id="bw.reg.circ.lin_+3A_method">method</code></td>
<td>
<p> Character string giving the estimator to be used. This must be one of <code>"LL"</code> or <code>"NW"</code>. Default <code>method="LL"</code>.</p>
</td></tr>
<tr><td><code id="bw.reg.circ.lin_+3A_option">option</code></td>
<td>
<p> Cross&ndash;validation rule. Default <code>option=1</code>. See details.</p>
</td></tr>
<tr><td><code id="bw.reg.circ.lin_+3A_lower">lower</code>, <code id="bw.reg.circ.lin_+3A_upper">upper</code></td>
<td>
 <p><code>lower</code> and <code>upper</code> boundary of the interval to be used in the search for the value of the smoothing parameter. Default
<code>lower=0</code> and <code>upper=50</code>.</p>
</td></tr>
<tr><td><code id="bw.reg.circ.lin_+3A_tol">tol</code></td>
<td>
<p> Convergence tolerance for <code><a href="stats.html#topic+optimize">optimize</a></code>. Default <code>tol=1e-2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>For nonparmetric regression with circular response, given <code class="reqn">(X_i,Y_i)</code>, <code class="reqn">i=1,\ldots,n</code>:
If <code>option=1</code>, the cross&ndash;validation smoothing parameter is computed as the value that minimizes <code class="reqn">\sum_{i=1}^{n}(-\cos(Y_i-\hat{f}^{-i}(X_i))</code>, where <code class="reqn">\hat{f}^{-i}</code> denotes the estimator computed with all the observations except <code class="reqn">(X_i,Y_i)</code>.
</p>
<p>If <code>option=2</code>, the cross&ndash;validation smoothing parameter is computed as the value that minimizes <code class="reqn">n^{-1}\sum_{i=1}^{n}(d(Y_i,\hat{f}^{-i}(X_i))^2</code> where <code class="reqn">d(Y_i,\hat{f}^{-i}(X_i)=\min(|Y_i-\hat{f}^{-i}(X_i)|,2\pi-|Y_i-\hat{f}^{-i}(X_i)|)</code>.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>Value of the smoothing parameter.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2013) Nonparametric circular methods for exploring environmental data.
<em>Environmental and Ecological Statistics</em>, <b>20</b>, 1&ndash;17.
</p>
<p>Di Marzio, M., Panzera A. and Taylor, C. C. (2012) Non&ndash;parametric regression for circular responses. <em>Scandinavian Journal of Statistics</em>,
<b>40</b>, 228&ndash;255.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.reg.circ.lin">kern.reg.circ.lin</a></code>, <code><a href="#topic+kern.reg.circ.circ">kern.reg.circ.circ</a></code>, <code><a href="#topic+kern.reg.lin.circ">kern.reg.lin.circ</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2012)
n &lt;- 100
x &lt;- seq(0,2*pi,length=n)
y &lt;- sin(x)+0.2*rnorm(n)
bw.reg.circ.lin(circular(x), y, method="LL", lower=1, upper=20)
bw.reg.circ.lin(circular(x), y, method="NW", lower=1, upper=20)
</code></pre>

<hr>
<h2 id='bw.rt'> Rule of thumb </h2><span id='topic+bw.rt'></span>

<h3>Description</h3>

<p>This function implements the selector proposed by Taylor (2008) for density estimation, based on an estimation of the concentration parameter of a von
Mises distribution. The concentration parameter can be estimated by maximum likelihood or by a robustified procedure as described in Oliveira et al. (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.rt(x, robust=FALSE, alpha=0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.rt_+3A_x">x</code></td>
<td>
<p> Data from which the smoothing parameter is to be computed. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="bw.rt_+3A_robust">robust</code></td>
<td>
<p> Logical, if <code>robust=FALSE</code> the parameter <code class="reqn">\kappa</code> is estimated by maximum likelihood, if <code>TRUE</code> it is estimated
as described in Oliveira et al. (2012b). Default <code>robust=FALSE</code>.</p>
</td></tr>
<tr><td><code id="bw.rt_+3A_alpha">alpha</code></td>
<td>
<p> Arc probability when <code>robust=TRUE</code>. Default is <code>alpha=0.5</code>. See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>robust=TRUE</code>, the parameter <code class="reqn">\kappa</code> is estimated as follows:
</p>
<p>1. Select <code class="reqn">\alpha \in (0, 1)</code> and find the shortest arc containing <code class="reqn">\alpha \cdot 100\%</code> of the sample data.
</p>
<p>2. Obtain the estimated <code class="reqn">\hat\kappa</code> in such way that the probability of a von Mises centered in the midpoint of the arc is <code>alpha</code>.
</p>
<p>The NAs will be automatically removed.
</p>
<p>See also Oliveira et al. (2012).
</p>


<h3>Value</h3>

<p>Value of the smoothing parameter.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal, A. (2012) A plug&ndash;in rule for bandwidth selection in circular density. <em>Computational Statistics
and Data Analysis</em>, <b>56</b>, 3898&ndash;3908.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2013) Nonparametric circular methods for exploring environmental data.
<em>Environmental and Ecological Statistics</em>, <b>20</b>, 1&ndash;17.
</p>
<p>Taylor, C.C. (2008) Automatic bandwidth selection for circular density estimation. <em>Computational Statistics and Data Analysis</em>, <b>52</b>, 3493&ndash;3500.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.den.circ">kern.den.circ</a></code>, <code><a href="#topic+bw.CV">bw.CV</a></code>, <code><a href="#topic+bw.pi">bw.pi</a></code>, <code><a href="#topic+bw.boot">bw.boot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2012)
n &lt;- 100
x &lt;- rcircmix(n,model=7)
bw.rt(x)
bw.rt(x, robust=TRUE)
</code></pre>

<hr>
<h2 id='circ.local.lik'>Local likelihood estimation for regression with circular covariate

</h2><span id='topic+circ.local.lik'></span>

<h3>Description</h3>


<p>Function <code>circ.local.lik</code> computes a nonparametric estimation of a curve of interest, regarded as a transformation of the mean regression function, when the predictor is circular and the conditional density is either gaussian, Bernoulli, Poisson or gamma. It also computes the derivatives of the function of interest. It uses the method described in Alonso-Pena et al. (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.local.lik(x, y, t = NULL, bw = NULL, family, p = 1,
  startv = NULL, tol = 0.00001, maxit = 300, from = circular(0),
  to = circular(2 * pi),len = 250)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circ.local.lik_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_t">t</code></td>
<td>
<p> Points where the regression function  is estimated. If <code>NULL</code>, equally spaced points are used according to the parameters <code>from</code>, <code>to</code> and <code>len</code>.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_bw">bw</code></td>
<td>
<p>Value of the smoothing (concentration) parameter used. The value of the smoothing parameter can be chosen by using <code>bw.circ.local.lik</code>.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_family">family</code></td>
<td>
<p>Character string indicating the conditional density to be used. It must be one of <code>"gaussian"</code>, <code>"bernoulli"</code>, <code>"poisson"</code> or <code>"gamma"</code>. When <code>family = "gaussian"</code>, the conditional mean is estimated; when <code>family = "bernoulli"</code>, the logit function is estimated and when <code>family = "poisson"</code> or <code>family = "gamma"</code>, the function of interest is the logarithm of the conditional mean.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_p">p</code></td>
<td>
<p>Degree of the local sine-polynomial to be used in the estimation process. It must be 1 or 3.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_startv">startv</code></td>
<td>
<p>Vector containing the initial values for the estimation algorithm if family is set as <code>"bernoulli"</code>, <code>"poisson"</code> or <code>"gamma"</code>. The vector must be of length 2 if <code>p = 1</code> and length 4 if <code>p = 3</code>. If <code>NULL</code>, the initial parameters are the ones corresponding to the global mean of the responses.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_tol">tol</code></td>
<td>
<p>Tolerance parameter for convergence in the numerical estimation. Only needed if family is one of <code>"bernoulli"</code>, <code>"poisson"</code> or <code>"gamma"</code>. Default is <code>tol = 0.00001</code>.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the numerical estimation. Only needed if family is one of <code>"bernoulli"</code>, <code>"poisson"</code> or <code>"gamma"</code>. Default is <code>maxit = 300</code>.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_from">from</code>, <code id="circ.local.lik_+3A_to">to</code></td>
<td>
<p>Left and right-most points of the grid at which the density is to be estimated. The objects are coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="circ.local.lik_+3A_len">len</code></td>
<td>
<p>Number of equally spaced points at which the density is to be estimated.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>See Alonso-Pena et al. (2022).
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>






<p>A list containing the following components:
</p>
<table>
<tr><td><code>datax</code>, <code>datay</code></td>
<td>
<p> Original dataset.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> The n coordinates of the points where the regression function and its derivatives are estimated.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> A list containing the estimated values of the function of interest and its derivatives up to order <code>p</code>.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p> The smoothing parameter used.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p> The sample size after elimination of missing values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The call which produced the result.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> The deparsed name of the x argument.</p>
</td></tr>
<tr><td><code>has.na</code></td>
<td>
<p> Logical, for compatibility (always FALSE).</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Maria Alonso-Pena, Irene Gijbels and Rosa M. Crujeiras.
</p>


<h3>References</h3>


<p>Alonso-Pena, M., Gijbels, I. and Crujeiras, R.M. (2022). A general framework for circular local likelihood regression. <em>Under review</em>.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+bw.circ.local.lik">bw.circ.local.lik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(spikes)
direction&lt;-circular(spikes$direction,units="degrees")
counts&lt;-spikes$counts
circ.local.lik(direction, counts, bw=8, p=1, family="poisson")

</code></pre>

<hr>
<h2 id='circsizer.density'> CircSiZer map for density </h2><span id='topic+circsizer.density'></span><span id='topic+print.circsizer'></span>

<h3>Description</h3>

<p>This function plots the CircSiZer map for circular density estimation based on circular kernel methods, as described in Oliveira et al. (2013). The
CircSiZer is an extension of SiZer proposed by Chaudhuri and Marron (1999) to circular data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circsizer.density(x, bws, ngrid=250, alpha=0.05, B=500, log.scale=TRUE,
display=TRUE)
## S3 method for class 'circsizer'
print(x, digits=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circsizer.density_+3A_x">x</code></td>
<td>
<p> Data from which the estimate is to be computed. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="circsizer.density_+3A_bws">bws</code></td>
<td>
<p> Vector of smoothing parameters. Values of <code>bws</code> must be positive. <code>bws</code> will be coerced to be equally spaced. Length of vector <code>bws</code> must be at least 2.</p>
</td></tr>
<tr><td><code id="circsizer.density_+3A_ngrid">ngrid</code></td>
<td>
<p> Integer indicating the number of equally spaced angles between <code class="reqn">0</code> and <code class="reqn">2\pi</code> where the estimator is evaluated. Default <code>ngrid=250</code>.</p>
</td></tr>
<tr><td><code id="circsizer.density_+3A_alpha">alpha</code></td>
<td>
<p> Significance level for the CircSiZer map. Default <code>alpha=0.05</code>.</p>
</td></tr>
<tr><td><code id="circsizer.density_+3A_b">B</code></td>
<td>
<p> Integer indicating the number of bootstrap samples to estimate the standard deviation of the derivative estimator. Default <code>B=500</code>.</p>
</td></tr>
<tr><td><code id="circsizer.density_+3A_log.scale">log.scale</code></td>
<td>
<p> Logical, if <code>TRUE</code>, the CircSiZer map is plotted in the scale <code class="reqn">-\log_{10}(\code{bws})</code>. Default is <code>TRUE</code>. See Details.</p>
</td></tr>
<tr><td><code id="circsizer.density_+3A_display">display</code></td>
<td>
<p> Logical, if <code>TRUE</code>, the CircSiZer map is plotted. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="circsizer.density_+3A_digits">digits</code></td>
<td>
<p> Integer indicating the precision to be used.</p>
</td></tr>
<tr><td><code id="circsizer.density_+3A_...">...</code></td>
<td>
<p> further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With CircSiZer, significance features (peaks and valleys) in the data are seeked via the construction of confidence intervals for the scale-space version of
the smoothed derivative curve, as it is described in Oliveira et al. (2013). Thus, for a given point and a given value of the smoothing parameter, the curve
is significantly increasing (decreasing) if the confidence interval is above (below) 0 and if the confidence interval contains 0, the curve for that value
of the smoothing parameter and at that point does not have a statistically significant slope. If <code>display=TRUE</code>, this information is displayed in a
circular color map, the CircSiZer map, in such a way that, at a given point, the performance of the estimated curve is represented by a color ring with radius
proportional to the value of the smoothing parameter.
</p>
<p>Differents colors allow to  indentify peaks and valleys. Blue color indicates locations where the curve is significantly increasing; red color shows where
it is significantly decreasing and purple indicates where it is not significantly different from zero. Gray color corresponds to those regions where there is
not enough data to make statements about significance. Thus, at a given bandwidth, a significant peak can be identified when a region of significant
positive gradient is followed by a region of significant negative gradient (i.e. blue-red pattern), and a significant trough by the reverse (red-blue
pattern), taking clockwise as the positive sense of rotation.
</p>
<p>If <code>log.scale=TRUE</code> then, the values of the considered smoothing parameters <code>bws</code> are transformed to <code class="reqn">-\log_{10}</code> scale, i.e, a sequence of equally
spaced smoothing parameters according to the parameters
<code>-log10(max(bws))</code>, <code>-log10(min(bws))</code> and <code>length(bws)</code> is used. Hence, small values
of this parameter corresponds with larger rings and large values corresponds with smaller rings. Whereas if <code>log.scale=FALSE</code>, small values of this
parameter corresponds with smaller rings and large values corresponds with larger rings.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>An object with class <code>circsizer</code> whose underlying structure is a list containing the following components:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p> Original dataset.</p>
</td></tr>
<tr><td><code>ngrid</code></td>
<td>
<p> Number of equally spaced angles where the derivative of the circular kernel density estimator.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p> Vector of smoothing parameters (given in <code class="reqn">-\log_{10}</code> scale if <code>log.scale=TRUE</code>).</p>
</td></tr>
<tr><td><code>log.scale</code></td>
<td>
<p> Logical; if <code>TRUE</code>, the <code class="reqn">-\log_{10}</code> scale is used for constructing the CircSiZer map.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p> List containing: a matrix with lower limits fot the confidence intervals; a matrix with the lower limits of the confidence intervals; a matrix
with the Effective Sample Size. Each row corresponds to each value of the smoothing parameter and each column corresponds to an angle.</p>
</td></tr>
<tr><td><code>col</code></td>
<td>
<p> Matrix containing the colors for plotting the CircSiZer map.</p>
</td></tr>
</table>
<p>If <code>display==TRUE</code>, the function also returns the CircSiZer map for density.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Chaudhuri, P. and Marron, J.S. (1999). SiZer for exploration of structures in curves, <em>Journal of the American Statistical Association</em>, <b>94</b>,
807&ndash;823.
</p>
<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal (2014) CircSiZer: an exploratory tool for circular data. <em>Environmental and Ecological Statistics</em>,
<b>21</b>, 143&ndash;159.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodr?guez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+circsizer.map">circsizer.map</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(2012)
x &lt;- rcircmix(100,model=7)
sizer &lt;- circsizer.density(x, bws=seq(0,50,length=12))
sizer
names(sizer)
circsizer.map(sizer,type=1,zero=pi/2,clockwise=TRUE,raw.data=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='circsizer.map'> CircSiZer map </h2><span id='topic+circsizer.map'></span>

<h3>Description</h3>

<p>This function plots the CircSiZer map for <code>circsizer</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circsizer.map(circsizer.object, type, zero, clockwise, title=NULL, labels=NULL,
label.pos=NULL, rad.pos=NULL, raw.data=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circsizer.map_+3A_circsizer.object">circsizer.object</code></td>
<td>
<p> An object of class <code>circsizer</code>, i.e., output from functions <code>circsizer.density</code> or <code>circsizer.regression</code>.</p>
</td></tr>
<tr><td><code id="circsizer.map_+3A_type">type</code></td>
<td>
<p> Number indicating the labels to display in the plot: 1 (directions), 2 (hours), 3 (angles in radians), 4 (angles in degrees) or 5 (months).</p>
</td></tr>
<tr><td><code id="circsizer.map_+3A_zero">zero</code></td>
<td>
<p> Where to place the starting (zero) point.</p>
</td></tr>
<tr><td><code id="circsizer.map_+3A_clockwise">clockwise</code></td>
<td>
<p> Whether to interpret positive positions as clockwise from the starting point.</p>
</td></tr>
<tr><td><code id="circsizer.map_+3A_title">title</code></td>
<td>
<p> Title for the plot.</p>
</td></tr>
<tr><td><code id="circsizer.map_+3A_labels">labels</code></td>
<td>
<p> Character or expression vector of labels to be placed at the <code>label.pos</code>. <code>label.pos</code> must also be supplied.</p>
</td></tr>
<tr><td><code id="circsizer.map_+3A_label.pos">label.pos</code></td>
<td>
<p> Vector indicating the position (between <code class="reqn">0</code> and <code class="reqn">2\pi</code>) at which the labels are to be drawn.</p>
</td></tr>
<tr><td><code id="circsizer.map_+3A_rad.pos">rad.pos</code></td>
<td>
<p> Vector (between <code class="reqn">0</code> and <code class="reqn">2\pi</code>) with the drawing position for the radius.</p>
</td></tr>
<tr><td><code id="circsizer.map_+3A_raw.data">raw.data</code></td>
<td>
<p> Logical, if <code>TRUE</code>, points indicated by <code>x</code> are stacked on the perimeter of the circle. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CircSiZer map.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+circsizer.density">circsizer.density</a></code>, <code><a href="#topic+circsizer.regression">circsizer.regression</a></code> </p>

<hr>
<h2 id='circsizer.regression'> CircSiZer map for regression </h2><span id='topic+circsizer.regression'></span>

<h3>Description</h3>

<p>This function plots the CircSiZer map for circular regression estimation based on circular kernel methods, as described in Oliveira et al. (2013). The
CircSiZer is an extension of SiZer proposed by Chaudhuri and Marron (1999) to circular data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circsizer.regression(x, y, bws=NULL, adjust=2, ngrid=150, alpha=0.05, B=500,
B2=250, log.scale=TRUE, display=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circsizer.regression_+3A_x">x</code></td>
<td>
<p> Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_y">y</code></td>
<td>
<p> Vector of data for the dependent variable. This must be same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_bws">bws</code></td>
<td>
<p> Vector of smoothing parameters. Values of <code>bws</code> must be positive. <code>bws</code> will be coerced to be equally spaced. Length of vector <code>bws</code>
must be at least 2.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_adjust">adjust</code></td>
<td>
<p> If <code>bws=NULL</code>, the smoothing parameters used are <code>adjust/bw</code> and <code>adjust*bw</code>, where <code>bw</code> is the smoothing parameter obtained
by using the cross&ndash;validation rule.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_ngrid">ngrid</code></td>
<td>
<p> Integer indicating the number of equally spaced angles between <code class="reqn">0</code> and <code class="reqn">2\pi</code> where the estimator is evaluated. Default
<code>ngrid=150</code>.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_alpha">alpha</code></td>
<td>
<p> Significance level for the CircSiZer map. Default <code>alpha=0.05</code>.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_b">B</code></td>
<td>
<p> Integer indicating the number of bootstrap samples to estimate the standard deviation of the derivative estimator. Default <code>B=500</code>.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_b2">B2</code></td>
<td>
<p> Integer indicating the number of bootstrap samples to compute the denominator in Step 2 of algorithm described in Oliveira et al. (2013).
Default <code>B=250</code>.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_log.scale">log.scale</code></td>
<td>
<p> Logical, if <code>TRUE</code>, the CircSiZer map is plotted in the scale <code class="reqn">-\log_{10}(\code{bws})</code>. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="circsizer.regression_+3A_display">display</code></td>
<td>
<p> Logical, if <code>TRUE</code>, the CircSiZer map is plotted. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Details Section of <code><a href="#topic+circsizer.density">circsizer.density</a></code>.
The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>An object with class <code>circsizer</code> whose underlying structure is a list containing the following components.
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p> Original dataset.</p>
</td></tr>
<tr><td><code>ngrid</code></td>
<td>
<p> Number of equally spaced angles where the derivative of the regression estimator is evaluated.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p> Vector of smoothing parameters (given in <code class="reqn">-\log_{10}</code> scale if <code>log.scale=TRUE</code>).</p>
</td></tr>
<tr><td><code>log.scale</code></td>
<td>
<p> Logical; if <code>TRUE</code>, the <code class="reqn">-\log_{10}</code> scale is used for constructing the CircSiZer map.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p> List containing: a matrix with lower limits fot the confidence intervals; a matrix with the lower limits of the confidence intervals; a matrix
with the Effective Sample Size. Each row corresponds to each value of the smoothing parameter and each column corresponds to an angle.</p>
</td></tr>
<tr><td><code>col</code></td>
<td>
<p> Matrix containing the colors for plotting the CircSiZer map.</p>
</td></tr>
</table>
<p>If <code>display==TRUE</code>, the function also returns the CircSiZer map for regression.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Chaudhuri, P. and Marron, J.S. (1999). SiZer for exploration of structures in curves, <em>Journal of the American Statistical Association</em>, <b>94</b>,
807&ndash;823.
</p>
<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal (2014) CircSiZer: an exploratory tool for circular data. <em>Environmental and Ecological Statistics</em>,
<b>21</b>, 143&ndash;159.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+circsizer.map">circsizer.map</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(2012)
n &lt;- 100
x &lt;- seq(0,2*pi,length=n)
y &lt;- sin(x)+sqrt(0.5)*rnorm(n)
circsizer.regression(circular(x), y, bws=seq(10,60,by=5))

## End(Not run)
</code></pre>

<hr>
<h2 id='cross.beds1'> Cross-beds azimuths (I)
</h2><span id='topic+cross.beds1'></span>

<h3>Description</h3>

<p>This dataset corresponds to azimuths of cross-beds in the Kamthi river (India). Originally analized by SenGupta and Rao (1966) and included in Table 1.5 in 
Mardia (1972), the dataset collects 580 azimuths of layers lying oblique to principal accumulation surface along the river, being these layers known as 
cross-beds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cross.beds1)</code></pre>


<h3>Format</h3>

<p>A single-column data frame with 580 observations in radians.
</p>


<h3>Details</h3>

<p>Data were originally recorded in degrees.
</p>


<h3>Source</h3>

<p>Mardia, K.V. (1972) <em>Statistics of Directional Data</em>. Academic Press, New York.
</p>
<p>SenGupta, S. and Rao, J.S. (1966) Statistical analysis of cross&ndash;bedding azimuths from the Kamthi formation around Bheemaram, 
Pranhita: Godavari Valley. <em>Sankhya: The Indian Journal of Statistics, Series B</em>, <b>28</b>, 165&ndash;174.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cross.beds1)
</code></pre>

<hr>
<h2 id='cross.beds2'> Cross-beds (II)
</h2><span id='topic+cross.beds2'></span>

<h3>Description</h3>

<p>A dataset of cross-beds measurements from Himalayan molasse in Pakistan presented in Fisher (1993). This dataset collects 104 measurements of Chaudan 
Zam large bedforms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cross.beds2)</code></pre>


<h3>Format</h3>

<p>A single-column data frame with 104 observations in radians.
</p>


<h3>Details</h3>

<p>Data were originally recorded in degrees.
</p>


<h3>Source</h3>

<p>Fisher, N.I. (1993) <em>Statistical Analysis of Circular Data</em>. Cambridge University Press, Cambridge, U.K.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cross.beds2)
</code></pre>

<hr>
<h2 id='cycle.changes'> Cycle changes
</h2><span id='topic+cycle.changes'></span>

<h3>Description</h3>

<p>The data consists on the changes in cycles of temperatures at ground level in periglacial Monte Alvear (Argentina). The dataset includes 350 observations 
which correspond to the hours where the temperature changes from positive to negative and viceversa from February 2008 to December 2009.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cycle.changes)</code></pre>


<h3>Format</h3>

<p>A data frame with 350 observations on two variables: <code>change</code>, which indicates if the temperature changed from positive to negative (-1) or viceversa (1) 
and <code>hour</code>, which indicates the hour (in radians) when the cycle change occured.
</p>


<h3>Details</h3>

<p>Analysis of cycle changes in temperatures for another locations can be seen in Oliveira et al. (2013).
</p>


<h3>Source</h3>

<p>The authors want to acknowledge Prof. Augusto Perez&ndash;Alberti for providing the data, collected within the Project POL2006-09071 from the Spanish Ministry 
of Education and Science.
</p>


<h3>References</h3>

<p> Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2013) Nonparametric circular methods for exploring environmental data. 
<em>Environmental and Ecological Statistics</em>, <b>20</b>, 1&ndash;17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cycle.changes)
thaw &lt;- (cycle.changes[,1]==1)
frosting &lt;- (cycle.changes[,1]==-1)
plot(circular(cycle.changes[frosting,2],template="clock24"), shrink=1.08, col=4, 
stack=TRUE, main="Frosting")
plot(circular(cycle.changes[thaw,2],template="clock24"), shrink=1.08, col=2, 
stack=TRUE, main="Thaw")
</code></pre>

<hr>
<h2 id='dcircmix'> Mixtures of circular distributions </h2><span id='topic+dcircmix'></span><span id='topic+rcircmix'></span>

<h3>Description</h3>

<p>Density and random generation functions for a circular distribution or a mixture of circular distributions allowing the following components: circular
uniform, von Mises, cardioid, wrapped Cauchy, wrapped normal, wrapped skew-normal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcircmix(x, model=NULL, dist=NULL, param=NULL)
rcircmix(n, model=NULL, dist=NULL, param=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcircmix_+3A_x">x</code></td>
<td>
<p> Vector of angles where the density is evaluated. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="dcircmix_+3A_n">n</code></td>
<td>
<p> Number of observations to generate.</p>
</td></tr>
<tr><td><code id="dcircmix_+3A_model">model</code></td>
<td>
<p> Number between 1 and 20, corresponding with a model defined in Oliveira et al. (2012). See Details.</p>
</td></tr>
<tr><td><code id="dcircmix_+3A_dist">dist</code></td>
<td>
<p> Vector of strings with the distributions that participate in the mixture: <code>"unif"</code>, <code>"vm"</code>, <code>"car"</code>, <code>"wc"</code>, <code>"wn"</code>,
<code>"wsn"</code>.</p>
</td></tr>
<tr><td><code id="dcircmix_+3A_param">param</code></td>
<td>
<p> List with three or four objects. The first object will be a vector containing the proportion of each distribution in the mixture,
the second object will be a vector containg the location parameters and the third object will be a vector containing the concentration
parameters. If the wrapped skew-normal distribution participates in the mixture, a fourth object will be introduced in the list, a vector
containing the skewness parameter. In this case, the values of the skewness parameter for the rest of distributions in the mixture will be
zero. The length of each object in the list must be equal to the length of argument <code>dist</code>. See Details and Examples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models from Oliveira et al. (2012) are described below:
</p>
<p>M1: Circular uniform.
</p>
<p>M2: von Mises: <code class="reqn">vM(\pi,1)</code>.
</p>
<p>M3: Wrapped normal: <code class="reqn">WN(\pi,0.9)</code>.
</p>
<p>M4: cardioid: <code class="reqn">C(\pi,0.5)</code>.
</p>
<p>M5: Wrapped Cauchy: <code class="reqn">WC(\pi,0.8)</code>.
</p>
<p>M6: Wrapped skew&ndash;normal: <code class="reqn">WSN(\pi,1,20)</code>.
</p>
<p>M7: Mixture of two von Mises <code class="reqn">1/2 vM(0,4) + 1/2 vM(\pi,4)</code>.
</p>
<p>M8: Mixture of two von Mises <code class="reqn">1/2 vM(2,5) + 1/2 vM(4,5)</code>.
</p>
<p>M9: Mixture of two von Mises <code class="reqn">1/4 vM(0,2) + 3/4 vM(\pi/\sqrt{3},2)</code>.
</p>
<p>M10: Mixture of von Mises and wrapped Cauchy <code class="reqn">4/5 vM(\pi,5) + 1/5 WC(4\pi/3,0.9)</code>.
</p>
<p>M11: Mixture of three von Mises <code class="reqn">1/3 vM(\pi/3,6) + 1/3 vM(\pi,6) + 1/3 vM(5\pi/3,6)</code>.
</p>
<p>M12: Mixture of three von Mises <code class="reqn">2/5 vM(\pi/2,4) + 1/5 vM(\pi,5) + 2/5 vM(3\pi/2,4)</code>.
</p>
<p>M13: Mixture of three von Mises <code class="reqn">2/5 vM(0.5,6) + 2/5 vM(3,6) + 1/5 vM(5,24)</code>.
</p>
<p>M14: Mixture of four von Mises  <code class="reqn">1/4 vM(0,12) + 1/4 vM(\pi/2,12) + 1/4 vM(\pi,12) + 1/4 vM(3\pi/2,12)</code>.
</p>
<p>M15: Mixture of wrapped Cauchy, wrapped normal, von Mises and wrapped skew-normal
<code class="reqn">3/10 WC(\pi-1,0.6) + 1/4 WN(\pi+0.5,0.9) + 1/4 vM(\pi+2,3) + 1/5 WSN(6,1,3)</code>.
</p>
<p>M16: Mixture of five von Mises <code class="reqn">1/5 vM(\pi/5,18) + 1/5 vM(3\pi/5,18) + 1/5 vM(\pi,18) +
1/5 vM(7\pi/5,18) + 1/5 vM(9\pi/5,18)</code>.
</p>
<p>M17: Mixture of cardioid and wrapped Cauchy <code class="reqn">2/3 C(\pi,0.5) + 1/3 WC(\pi,0.9)</code>.
</p>
<p>M18: Mixture of four von Mises  <code class="reqn">1/2 vM(\pi,1) + 1/6 vM(\pi-0.8,30) + 1/6 vM(\pi,30) + 1/ vM(\pi+0.8,30)</code>.
</p>
<p>M19: Mixture of five von Mises <code class="reqn">4/9 vM(2,3) + 5/36 vM(4,3) + 5/36 vM(3.5,50) + 5/36 vM(4,50) + 5/36 vM(4.5,50)</code>.
</p>
<p>M20: Mixture of two wrapped skew-normal and two wrapped Cauchy <code class="reqn">1/3 WSN(0,0.7,20) + 1/3 WSN(\pi,0.7,20) + 1/6 WC(3\pi/4,0.9) + 1/6 WC(7\pi/4,0.9)</code>.
</p>
<p>When the wrapped skew-normal distribution participates in the mixture, the argument <code>param</code> for function <code>dcircmix</code> can be a list with fifth
objects. The fifth object would be the number of terms to be used in approximating the density function of the wrapped skew normal distribution. By default
the number of terms used is 20.
</p>


<h3>Value</h3>

<p><code>dcircmix</code> gives the density and <code>rcircmix</code> generates random deviates.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal, A. (2012) A plug&ndash;in rule for bandwidth selection in circular density. <em>Computational Statistics and Data Analysis</em>, <b>56</b>, 3898&ndash;3908.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2012)
# Circular representation of models M1-M20, each one in a separate window
for (i in 1:20){
dev.new()
f &lt;- function(x) dcircmix(x, model=i)
curve.circular(f, n=500, join=TRUE, shrink=1.9, main=i)
}

# Random generation from model M1 (uniform model)
data1 &lt;- rcircmix(50, model=1)
plot(data1)

# Density function and random generation from a mixture of a von Mises and
# a wrapped skew-normal
f &lt;- function(x) dcircmix(x, model=NULL, dist=c("vm","wsn"),
param=list(p=c(0.5,0.5), mu=c(0,pi), con=c(1,1), sk=c(0,10)))
curve.circular(f, n=500, shrink=1.2)
data &lt;- rcircmix(100, model=NULL, dist=c("vm","wsn"),
param=list(p=c(0.5,0.5), mu=c(0,pi), con=c(1,1), sk=c(0,10)))
points(data)

# Density function and random generation from a mixture of two von Mises and
# two wrapped Cauchy
f &lt;- function(x) dcircmix(x, model=NULL, dist=c("vm","vm","wc","wc"),
param=list(p=c(0.3,0.3,0.2,0.2), mu=c(0,pi,pi/2,3*pi/2), con=c(5,5,0.9,0.9)))
curve.circular(f, n=1000, xlim=c(-1.65,1.65))
data &lt;- rcircmix(100, model=NULL, dist=c("vm","vm","wc","wc"),
param=list(p=c(0.3,0.3,0.2,0.2), mu=c(0,pi,pi/2,3*pi/2), con=c(5,5,0.9,0.9)))
points(data)
</code></pre>

<hr>
<h2 id='dpreg.circ'>
Joint parametric estimation of mean and dispersion functions in circular double Poisson models
</h2><span id='topic+dpreg.circ'></span>

<h3>Description</h3>

<p>Function <code>dpreg.circ</code> implements the parametric joint estimator of the mean and dispersion functions when the covariate is circular and the conditional distribution is a double Poisson, a particular case of the double exponential family. It is assumed that the logarithm of the mean and the logarithm of the dispersion are sums of sine and cosine terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpreg.circ(x, y, k = 2, ktilde = 1, startvmu = NULL, startvgam = NULL,
          tol= 0.000001, maxit = 300)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dpreg.circ_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="dpreg.circ_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as <code>x</code> and should contain counts.</p>
</td></tr>
<tr><td><code id="dpreg.circ_+3A_k">k</code></td>
<td>
<p>Number of components for modeling the logarithm of the mean, including the intercept. Equivalent to the number of parameters to be estimated for the mean function.</p>
</td></tr>
<tr><td><code id="dpreg.circ_+3A_ktilde">ktilde</code></td>
<td>
<p>Number of components for modeling the logarithm of the dispersion, including the intercept. Equivalent to the number of parameters to be estimated for the dispersion function.</p>
</td></tr>
<tr><td><code id="dpreg.circ_+3A_startvmu">startvmu</code></td>
<td>
<p>Vector of length <code>k</code> containing the initial values for the parameters corresponding to the estimation of the mean.</p>
</td></tr>
<tr><td><code id="dpreg.circ_+3A_startvgam">startvgam</code></td>
<td>
<p>Vector of length <code>ktilde</code> containing the initial values for the parameters corresponding to the estimation of the dispersion.</p>
</td></tr>
<tr><td><code id="dpreg.circ_+3A_tol">tol</code></td>
<td>
<p>Tolerance parameter for convergence in the numerical estimation.</p>
</td></tr>
<tr><td><code id="dpreg.circ_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the numerical estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Alonso-Pena et al. (2022) for details.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>datax</code>, <code>datay</code></td>
<td>
<p> Original dataset.</p>
</td></tr>
<tr><td><code>coefficients_mu</code></td>
<td>
<p> A vector of length <code>k</code> containing the estimators for the parameters corresponding to the mean.</p>
</td></tr>
<tr><td><code>coefficients_mu</code></td>
<td>
<p> A vector of length <code>ktilde</code> containing the estimators for the parameters corresponding to the dispersion.</p>
</td></tr>
<tr><td><code>numit</code></td>
<td>
<p> Number of iterations needed for convergence.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p> The sample size after elimination of missing values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The call which produced the result.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> The deparsed name of the x argument.</p>
</td></tr>
<tr><td><code>has.na</code></td>
<td>
<p> Logical, for compatibility (always FALSE).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Alonso-Pena, Irene Gijbels and Rosa M. Crujeiras
</p>


<h3>References</h3>

<p>Alonso-Pena, M., Gijbels, I. and Crujeiras, R.M. (2022). Flexible joint modeling of mean and dispersion for the directional tuning of neuronal spike counts. <em>Under review</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(spikes)
direction&lt;-circular(spikes$direction,units="degrees")
counts&lt;-spikes$counts
output&lt;-dpreg.circ(direction, counts,  k = 5, ktilde = 3)


</code></pre>

<hr>
<h2 id='dragonfly'> Orientations of dragonflies
</h2><span id='topic+dragonfly'></span>

<h3>Description</h3>

<p>The data, presented in Batschelet (1981), consists on the orientation of 214 dragonflies with respect to the sun's azimuth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dragonfly)</code></pre>


<h3>Format</h3>

<p>A single-column data frame with 214 observations in radians.
</p>


<h3>Details</h3>

<p>Data were originally recorded in degrees.
</p>


<h3>Source</h3>

<p>Batschelet, E. (1981) <em>Circular Statistics in Biology</em>. Academic Press, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dragonfly)
x &lt;- circular(dragonfly$orientation)
dens &lt;- kern.den.circ(x)
plot(dens, shrink=1.3)
</code></pre>

<hr>
<h2 id='dwsn'> Wrapped skew-Normal density function </h2><span id='topic+dwsn'></span><span id='topic+rwsn'></span>

<h3>Description</h3>

<p>Density function and random generation for the wrapped skew-Normal distribution introduced by Pewsey (2000). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwsn(x,xi,eta,lambda,K=NULL,min.k=20)
rwsn(n,xi,eta,lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dwsn_+3A_x">x</code></td>
<td>
<p> Vector of angles where the density is evaluated . The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="dwsn_+3A_n">n</code></td>
<td>
<p> Number of observations.</p>
</td></tr>
<tr><td><code id="dwsn_+3A_xi">xi</code></td>
<td>
<p> Location parameter. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="dwsn_+3A_eta">eta</code></td>
<td>
<p> Scale parameter.</p>
</td></tr>
<tr><td><code id="dwsn_+3A_lambda">lambda</code></td>
<td>
<p> Skewness parameter.</p>
</td></tr>
<tr><td><code id="dwsn_+3A_k">K</code></td>
<td>
<p> Number of terms to be used in approximating the density. Default <code>K=NULL</code>.</p>
</td></tr>
<tr><td><code id="dwsn_+3A_min.k">min.k</code></td>
<td>
<p> Minimum number of terms used in approximating the density.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p><code>dwsn</code> gives the density and <code>rwsn</code> generates random deviates. 
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

 
<p>Pewsey, A. (2000) The wrapped skew&ndash;Normal distribution on the circle. <em>Communications 
in Statistics - Theory and Methods</em>, <b>29</b>, 2459&ndash;2472.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2012)
# Density function of a wrapped skew-normal distribution WSN(pi,1,20)
wsn &lt;- function(x) dwsn(x, xi=circular(pi), eta=1, lambda=20)
curve.circular(wsn,n=500,xlim=c(-1.65,1.65),main=expression(WSN(pi,1,20)))
# Random generation
data&lt;-rwsn(50,xi=circular(pi),eta=1,lambda=20)
points(data)
</code></pre>

<hr>
<h2 id='flywheels'>
Flywheel measurements
</h2><span id='topic+flywheels'></span>

<h3>Description</h3>

<p>The data consists on measurements on mechanical flywheels, which are tools to regulate an engine's rotation in the automotive industry. The dataset contains 60 observations, containing the flywheels' angle of imbalance and the magnitude required to correct them. Four different types of metals were employed in the production process. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("flywheels")</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 3 variables.
</p>

<dl>
<dt><code>angle</code></dt><dd><p>A numeric vector containing the angles of imbalance (in radians)</p>
</dd>
<dt><code>weight</code></dt><dd><p>A numeric vector containing the magnitudes of correction (in inch-ounces).</p>
</dd>
<dt><code>group</code></dt><dd><p>A vector with numbers from 1 to 4 indicating the type of metal.</p>
</dd>
</dl>



<h3>Details</h3>


<p>The data were analyzed in Anderson-Cook (1999) and Alonso-Pena et al. (2021).
</p>


<h3>Source</h3>


<p>The dataset was obtained from Anderson-Cook (1999).
</p>


<h3>References</h3>


<p>Anderson-Cook, C.M. (1999). A tutorial on one-way analysis of circular-linear data. <em>Journal of Quality Technology</em>, <strong>31</strong>(1), 109&ndash;119.
</p>
<p>Alonso-Pena, M., Ameijeiras-Alonso, J. and Crujeiras, R.M. (2021) Nonparametric tests for circular regression. <em>Journal of Statistical Computation and Simulation</em>, <strong>91</strong>(3), 477&ndash;500.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(flywheels)
</code></pre>

<hr>
<h2 id='HumanMotorResonance'>
Human motor resonance data
</h2><span id='topic+HumanMotorResonance'></span>

<h3>Description</h3>


<p>This dataset, given by Puglisi et al. (2017), contains measurements of motor resonance responses in humans, who were requested to observe a movement of a rythmic hand flexion-extension. The dataset is composed of 70 observations, including the angular position of the hand and the resonance response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("HumanMotorResonance")</code></pre>


<h3>Format</h3>

<p>A data frame with 70 observations on the following 2 variables.
</p>

<dl>
<dt><code>Angular.position</code></dt><dd><p>A numeric vector containing the angular position of the hand (in radians).</p>
</dd>
<dt><code>Reflex.Amplitude</code></dt><dd><p>A numeric vector containing the resonance response.</p>
</dd></dl>



<h3>Details</h3>


<p>See Puglisi et al. (2017) for details.
</p>


<h3>Source</h3>


<p>The dataset was obtained by Puglisi et al. (2017).
</p>


<h3>References</h3>


<p>Puglisi, G.,  Leonetti, A., Landau, A., Fornia, L., Cerri, G. and Borroni, P. (2017). The role of attention in human motor resonance. <em>PLOS ONE</em>, <strong>12</strong>(5), e0177457.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HumanMotorResonance)
</code></pre>

<hr>
<h2 id='kern.den.circ'>
Kernel density derivative estimate for circular data
</h2><span id='topic+kern.den.circ'></span>

<h3>Description</h3>

<p>This function computes the kernel density derivative estimate with the given kernel and bandwidth for circular data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kern.den.circ(x,z=NULL,bw="AA",deriv.order=0,kernel="vonmises",na.rm = FALSE,
              from = circular(0), to = circular(2 * pi),n = 512,control.circular=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kern.den.circ_+3A_x">x</code></td>
<td>
<p> Data from which the estimate is to be computed. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="kern.den.circ_+3A_z">z</code></td>
<td>
<p> Points where the density derivative is estimated. If <code>NULL</code>
equally spaced points are used according to the parameters
<code>from</code>, <code>to</code> and <code>n</code>.</p>
</td></tr>
<tr><td><code id="kern.den.circ_+3A_bw">bw</code></td>
<td>
<p> Smoothing parameter to be used. <code>bw</code> can also be a character string giving a rule to choose the bandwidth. See <code><a href="#topic+bw.AA">bw.AA</a></code>, <code><a href="#topic+bw.pi">bw.pi</a></code>, <code><a href="#topic+bw.rt">bw.rt</a></code>, <code><a href="#topic+bw.CV">bw.CV</a></code>, and <code><a href="#topic+bw.boot">bw.boot</a></code>. The default, <code>'AA'</code>, is the 2-stage solve-the-equation plug-in smoothing selector.</p>
</td></tr>
<tr><td><code id="kern.den.circ_+3A_deriv.order">deriv.order</code></td>
<td>
<p> Derivative order. Default <code>deriv.order=0</code> (density estimation).</p>
</td></tr>
<tr><td><code id="kern.den.circ_+3A_kernel">kernel</code></td>
<td>
<p>a character string giving the smoothing kernel to be
used. This must be one of <code>"vonmises"</code> or
<code>"wrappednormal"</code>.</p>
</td></tr>
<tr><td><code id="kern.den.circ_+3A_na.rm">na.rm</code></td>
<td>
<p>logical; if <code>TRUE</code>, missing values are removed from
<code>x</code>. If <code>FALSE</code> any missing values cause an error.</p>
</td></tr>
<tr><td><code id="kern.den.circ_+3A_from">from</code>, <code id="kern.den.circ_+3A_to">to</code></td>
<td>
<p>the left and right-most
points of the grid at which the density is to be estimated. The objects are coerced to class <code>circular</code>.</p>
</td></tr>
<tr><td><code id="kern.den.circ_+3A_n">n</code></td>
<td>
<p>the number of equally spaced points at which the density is
to be estimated.</p>
</td></tr>
<tr><td><code id="kern.den.circ_+3A_control.circular">control.circular</code></td>
<td>
<p>the attribute of the resulting objects (<code>x</code> component).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with class <code><a href="circular.html#topic+density.circular">density.circular</a></code> whose
underlying structure is a list containing the following components.
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>original dataset.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the <code>n</code> coordinates of the points where the density is
estimated. It is a circular objects with coordinate system setting using <code>control.circular</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the estimated density values.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>the smoothing parameter used.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>the sample size after elimination of missing values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call which produced the result.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>the deparsed name of the <code>x</code> argument.</p>
</td></tr>
<tr><td><code>has.na</code></td>
<td>
<p>logical, for compatibility (always FALSE).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose Ameijeiras-Alonso.
</p>


<h3>References</h3>

<p>Ameijeiras-Alonso, J. (2022) A reliable data-based smoothing parameter selection method for circular kernel estimation.
</p>
<p>Di Marzio, M., Panzera, A., &amp; Taylor, C. C. (2011). Kernel density estimation on the torus. <em>Journal of Statistical Planning and Inference</em>, <b>141</b>(6), 2156&ndash;2173.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodr?guez-Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bw.AA">bw.AA</a></code>, <code><a href="circular.html#topic+plot.density.circular">plot.density.circular</a></code>, <code><a href="circular.html#topic+lines.density.circular">lines.density.circular</a></code>, <code><a href="#topic+bw.pi">bw.pi</a></code>, <code><a href="#topic+bw.rt">bw.rt</a></code>, <code><a href="#topic+bw.CV">bw.CV</a></code>, <code><a href="#topic+bw.boot">bw.boot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2022)
n &lt;- 50
x &lt;- rcircmix(n, model=13)
# Using the smoothing parameter by default,
# i.e., 2-stage solve-the-equation plug-in rule
est1 &lt;- kern.den.circ(x,deriv.order=1)
# Selecting the smoothing parameter: 2-stage direct plug-in rule
est2 &lt;- kern.den.circ(x, bw="dpi", deriv.order=1)
# Circular plot
plot(est1, plot.type="circle", points.plot=TRUE, shrink=1.4,
      main="Circular plot",ylab="Density derivative circular")
lines(est2, plot.type="circle", shrink=1.4 ,col=2)
# Linear plot
plot(est1, plot.type="line", main="Linear plot",ylab="Density derivative circular")
lines(est2, plot.type="line", col=2)
</code></pre>

<hr>
<h2 id='kern.dpreg.circ'>
Joint kernel estimation of mean and dispersion functions in circular double Poisson models
</h2><span id='topic+kern.dpreg.circ'></span>

<h3>Description</h3>

<p>Function <code>kern.dpreg.circ</code> implements the nonparametric joint estimator of the mean and dispersion functions when the covariate is circular and the conditional distribution is a double Poisson, a particular case of the double exponential family. It takes the von Mises distribution as the kernel employed for both the estimation of the mean and the dispersion. The employed estimator is a local-linear type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kern.dpreg.circ(x, y, t = NULL, bw, startvmu = NULL, startvgam = NULL, tol= 0.000001,
  maxit = 300, from =     circular(0),to = circular(2 * pi), len = 250)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kern.dpreg.circ_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as <code>x</code> and should contain counts.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_t">t</code></td>
<td>
<p> Points where the regression function  is estimated. If <code>NULL</code>, equally spaced points are used according to the parameters <code>from</code>, <code>to</code> and <code>len</code>.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_bw">bw</code></td>
<td>
<p>Numeric vector of length two containing the smoothing (concentration) parameters used. The first component is the parameter used for the estimation of the mean, while the second component is used for estimating the dispersion. The value of the smoothing parameters can be chosen by using <code>bw.joint.dpcirc</code>.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_startvmu">startvmu</code></td>
<td>
<p>Vector of length two containing the initial values for the parameters corresponding to the estimation of the mean.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_startvgam">startvgam</code></td>
<td>
<p>Vector of length two containing the initial values for the parameters corresponding to the estimation of the dispersion.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_tol">tol</code></td>
<td>
<p>Tolerance parameter for convergence in the numerical estimation.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the numerical estimation.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_from">from</code>, <code id="kern.dpreg.circ_+3A_to">to</code></td>
<td>
<p>Left and right-most points of the grid at which the density is to be estimated. The objects are coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="kern.dpreg.circ_+3A_len">len</code></td>
<td>
<p>Number of equally spaced points at which the function is to be estimated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Alonso-Pena et al. (2022) for details.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>datax</code>, <code>datay</code></td>
<td>
<p> Original dataset.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> The n coordinates of the points where the regression function and its derivatives are estimated.</p>
</td></tr>
<tr><td><code>estim</code></td>
<td>
<p> A list containing the estimated values of the logarithm of the mean function (first component) and the logarithm of the dispersion function (second component).</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p> The vector of smoothing parameters used.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p> The sample size after elimination of missing values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The call which produced the result.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> The deparsed name of the x argument.</p>
</td></tr>
<tr><td><code>has.na</code></td>
<td>
<p> Logical, for compatibility (always FALSE).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Alonso-Pena, Irene Gijbels and Rosa M. Crujeiras
</p>


<h3>References</h3>

<p>Alonso-Pena, M., Gijbels, I. and Crujeiras, R.M. (2022). Flexible joint modeling of mean and dispersion for the directional tuning of neuronal spike counts. <em>Under review</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bw.joint.dpcirc">bw.joint.dpcirc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(spikes)
direction&lt;-circular(spikes$direction,units="degrees")
counts&lt;-spikes$counts
output&lt;-kern.dpreg.circ(direction, counts, bw=c(7.41,4.47))

 # Plot the data
plot(as.numeric(output$datax),output$datay,pch=16,xlab="Stimulus direction",
      ylab="Spike number")
# Represent the estimated mean
points(as.numeric(output$x),exp(output$estim[[1]]),type="l",col=2,lwd=2)

# Represent the estimated dispersion
plot(as.numeric(output$x),exp(output$estim[[2]]),type="l",col=2,lwd=2,
      xlab="Stimulus direction",ylab="Dispersion")

</code></pre>

<hr>
<h2 id='kern.reg.circ.lin'> Nonparametric regression estimation for circular data</h2><span id='topic+kern.reg.circ.lin'></span><span id='topic+kern.reg.circ.circ'></span><span id='topic+kern.reg.lin.circ'></span><span id='topic+print.regression.circular'></span>

<h3>Description</h3>

<p>Function <code>kern.reg.circ.lin</code> implements the Nadaraya-Watson estimator and the Local-Linear estimator for circular-linear data (circular covariate and
linear response), as described in Di Marzio et al. (2009) and Oliveira et al. (2013), taking the von Mises distribution as kernel.
</p>
<p>Function <code>kern.reg.circ.circ</code> implements the Nadaraya-Watson estimator and the Local-Linear estimator for circular-circular data (circular covariate
and circular response), as described in Di Marzio et al. (2012), taking the von Mises distribution as kernel.
</p>
<p>Function <code>kern.reg.lin.circ</code> implements the Nadaraya-Watson estimator and the Local-Linear estimator for linear-circular data (linear covariate and
circular response), as described in Di Marzio et al. (2012), taking the Normal distribution as kernel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kern.reg.circ.lin(x, y, t=NULL, bw, method="LL", from=circular(0),
to=circular(2*pi), len=250, tol=300)
kern.reg.circ.circ(x, y, t=NULL, bw, method="LL", from=circular(0),
to=circular(2*pi), len=250)
kern.reg.lin.circ(x, y, t=NULL, bw, method="LL", len=250)
## S3 method for class 'regression.circular'
print(x, digits=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kern.reg.circ.lin_+3A_x">x</code></td>
<td>
<p> Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>kern.reg.circ.lin</code> and <code>kern.reg.circ.circ</code>.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_y">y</code></td>
<td>
<p> Vector of data for the dependent variable. This must be same length as <code>x</code>. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>kern.reg.circ.circ</code> and <code>kern.reg.lin.circ</code>.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_t">t</code></td>
<td>
<p> Points where the regression function  is estimated. If <code>NULL</code> equally spaced points are used according to the parameters <code>from</code>, <code>to</code> and <code>len</code>.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_bw">bw</code></td>
<td>
<p> Smoothing parameter to be used. The value of the smoothing parameter can be chosen by using the function <code><a href="#topic+bw.reg.circ.lin">bw.reg.circ.lin</a></code>, <code><a href="#topic+bw.reg.circ.circ">bw.reg.circ.circ</a></code> and
<code><a href="#topic+bw.reg.lin.circ">bw.reg.lin.circ</a></code>.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_method">method</code></td>
<td>
<p> Character string giving the estimator to be used. This must be one of <code>"LL"</code> for Local-Linear estimator or <code>"NW"</code> for
Nadaraya-Watson estimator. Default <code>method="LL"</code>.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_from">from</code>, <code id="kern.reg.circ.lin_+3A_to">to</code></td>
<td>
<p> Left and right-most points of the grid at which the regression function is to be estimated. The objects are coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_len">len</code></td>
<td>
<p> Number of equally spaced points at which the regression function is to be estimated.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_tol">tol</code></td>
<td>
<p> Tolerance parameter to avoid overflow when <code>bw</code> is larger than <code>tol</code>. Default is <code>tol=300</code>.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_digits">digits</code></td>
<td>
<p> Integer indicating the precision to be used.</p>
</td></tr>
<tr><td><code id="kern.reg.circ.lin_+3A_...">...</code></td>
<td>
<p> further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Di Marzio et al. (2012). See Section 3 in Oliveira et al. (2013). See Di Marzio et al. (2009).
The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>An object with class &quot;regression.circular&quot; whose underlying structure is a list containing the following components:
</p>
<table>
<tr><td><code>datax</code>, <code>datay</code></td>
<td>
<p> Original dataset.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> The n coordinates of the points where the regression is estimated.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> The estimated values.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p> The smoothing parameter used.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p> The sample size after elimination of missing values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The call which produced the result.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> The deparsed name of the x argument.</p>
</td></tr>
<tr><td><code>has.na</code></td>
<td>
<p> Logical, for compatibility (always FALSE).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Di Marzio, M., Panzera A. and Taylor, C. C. (2009) Local polynomial regression for circular predictors. <em>Statistics and Probability Letters</em>, <b>79</b>, 2066&ndash;2075.
</p>
<p>Di Marzio, M., Panzera A. and Taylor, C. C. (2012) Non&ndash;parametric regression for circular responses. <em>Scandinavian Journal of Statistics</em>,
<b>40</b>, 228&ndash;255.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2013) Nonparametric circular methods for exploring environmental data.
<em>Environmental and Ecological Statistics</em>, <b>20</b>, 1&ndash;17.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.regression.circular">plot.regression.circular</a></code>, <code><a href="#topic+lines.regression.circular">lines.regression.circular</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>### circular-linear
data(speed.wind2)
dir &lt;- speed.wind2$Direction
vel &lt;- speed.wind2$Speed
nas &lt;- which(is.na(vel))
dir &lt;- circular(dir[-nas],units="degrees")
vel &lt;- vel[-nas]
estLL &lt;- kern.reg.circ.lin(dir, vel, method="LL")
estNW &lt;- kern.reg.circ.lin(dir, vel, method="NW")
# Circular representation
res&lt;-plot(estNW, plot.type="circle", points.plot=TRUE,
labels=c("N","NE","E","SE","S","SO","O","NO"),
label.pos=seq(0,7*pi/4,by=pi/4), zero=pi/2, clockwise=TRUE)
lines(estLL, plot.type="circle", plot.info=res, line.col=2)
# Linear representation
plot(estNW, plot.type="line", points.plot=TRUE, xlab="direction", ylab="speed (m/s)")
lines(estLL, plot.type="line", line.col=2)


### circular-circular
data(wind)
wind6 &lt;- circular(wind$wind.dir[seq(7,1752,by=24)])
wind12 &lt;- circular(wind$wind.dir[seq(13,1752,by=24)])
estNW &lt;- kern.reg.circ.circ(wind6,wind12,t=NULL,bw=6.1,method="NW")
estLL &lt;- kern.reg.circ.circ(wind6,wind12,t=NULL,bw=2.25,method="LL")
# Torus representation
plot(estNW, plot.type="circle", points.plot=TRUE, line.col=2, lwd=2, points.col=2,
units="degrees")
lines(estLL, plot.type="circle", line.col=3, lwd=2)
# Linear representation
plot(estNW, plot.type="line", points.plot=TRUE, xlab="Wind direction at 6 a.m.",
ylab="Wind direction at noon")
lines(estLL, plot.type="line", line.col=2)


### linear-circular
data(periwinkles)
dist &lt;- periwinkles$distance
dir &lt;- circular(periwinkles$direction, units="degrees")
estNW &lt;- kern.reg.lin.circ(dist,dir,t=NULL,bw=12.7,method="NW")
estLL &lt;- kern.reg.lin.circ(dist,dir,t=NULL,bw=200,method="LL")
# Cylinder representation
plot(estNW, plot.type="circle", points.plot=TRUE, line.col=2, lwd=2, points.col=2)
lines(estLL, plot.type="circle", line.col=3, lwd=2)
# Linear representation
 plot(estNW, plot.type="line", points.plot=TRUE, units="radians", main="")
 lines(estLL, plot.type="line", line.col=2, units="radians")
</code></pre>

<hr>
<h2 id='lines.regression.circular'> Add a plot for circular regression</h2><span id='topic+lines.regression.circular'></span>

<h3>Description</h3>

<p>The <code>lines</code> add a plot for <code>regression.circular</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regression.circular'
lines(x, plot.type=c("circle", "line"), points.plot=FALSE, rp.type="p", type="l",
line.col=1, points.col="grey", points.pch=1, units=NULL, zero=NULL,
clockwise=NULL, radial.lim=NULL, plot.info=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines.regression.circular_+3A_x">x</code></td>
<td>
<p> An object of class <code>regression.circular</code>.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_plot.type">plot.type</code></td>
<td>
<p> Type of the plot: &quot;line&quot;: linear plot, &quot;circle&quot;: circular plot.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_points.plot">points.plot</code></td>
<td>
<p> Logical; if TRUE original data are added to the plot.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_rp.type">rp.type</code>, <code id="lines.regression.circular_+3A_type">type</code></td>
<td>
<p> Character indicating the type of plotting.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_line.col">line.col</code></td>
<td>
<p> Color code or name.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_points.col">points.col</code></td>
<td>
<p> Color code or name for the original data. Used if <code>points.plot=TRUE</code>.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_points.pch">points.pch</code></td>
<td>
<p> Plotting 'character', i.e., symbol to use for the original data. Used if
<code>points.plot=TRUE</code>.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_units">units</code></td>
<td>
<p> Units measure used in the plot. If <code>NULL</code> the value is taken from the attribute of object 'x' from the argument 'x', i.e. x$x.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_zero">zero</code></td>
<td>
<p> Where to place the starting (zero) point, i.e., the zero of the plot. Ignored if <code>plot.info</code> is provided.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_clockwise">clockwise</code></td>
<td>
<p> Logical, indicating the sense of rotation of the plot: clockwise if <code>TRUE</code> and counterclockwise if <code>FALSE</code>. Ignored if plot.info is provided.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_radial.lim">radial.lim</code></td>
<td>
<p> The range of the grid circle. Used if <code>plot.type="circle"</code>.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_plot.info">plot.info</code></td>
<td>
<p> An object from <code>plot.regression.circular</code> that contains information on the <code>zero</code>, the <code>clockwise</code> and <code>radial.lim</code>. Used if <code>plot.type="circle"</code>.</p>
</td></tr>
<tr><td><code id="lines.regression.circular_+3A_...">...</code></td>
<td>
<p> Further arguments to be passed to <code><a href="graphics.html#topic+lines.default">lines.default</a></code> (if <code>plot.type="line"</code>) or to <code><a href="plotrix.html#topic+radial.plot">radial.plot</a></code>
(if <code>plot.type="circle"</code> and <code>x</code> is the output of <code><a href="#topic+kern.reg.circ.lin">kern.reg.circ.lin</a></code>) or to <code><a href="rgl.html#topic+lines3d">lines3d</a></code> (if <code>plot.type="circle"</code>)
and <code>x</code> is the output of <code><a href="#topic+kern.reg.circ.circ">kern.reg.circ.circ</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.reg.circ.lin">kern.reg.circ.lin</a></code>, <code><a href="#topic+kern.reg.circ.circ">kern.reg.circ.circ</a></code>, <code><a href="#topic+kern.reg.lin.circ">kern.reg.lin.circ</a></code>, <code><a href="#topic+plot.regression.circular">plot.regression.circular</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1012)
n &lt;- 100
x &lt;- runif(100, 0, 2*pi)
y &lt;- sin(x)+0.5*rnorm(n)
estNW&lt;-kern.reg.circ.lin(circular(x),y,t=NULL,bw=10,method="NW")
estLL&lt;-kern.reg.circ.lin(circular(x),y,t=NULL,bw=10,method="LL")
res&lt;-plot(estNW, plot.type="circle", points.plot=TRUE)
lines(estLL, plot.type="circle",line.col=2, plot.info=res)
</code></pre>

<hr>
<h2 id='modalreg.circ.lin'>Circular multimodal regression estimation

</h2><span id='topic+modalreg.circ.lin'></span><span id='topic+modalreg.circ.circ'></span><span id='topic+modalreg.lin.circ'></span>

<h3>Description</h3>


<p>Function <code>modalreg.circ.lin</code> implements the nonparametric multimodal regression estimator for a circular covariate and a real-valued response, as described in Alonso-Pena and Crujeiras (2022). It takes the von Mises distribution as the kernel associated to the predictor variable and the normal distribution as the kernel associated to the response variable.
</p>
<p>Function <code>modalreg.circ.circ</code> implements the nonparametric multimodal regression estimator for a circular covariate and a circular response, as described in Alonso-Pena and Crujeiras (2022). It takes the von Mises distribution as the kernel associated to the predictor variable and the response variables.
</p>
<p>Function <code>modalreg.lin.circ</code> implements the nonparametric multimodal regression estimator for a real-valued covariate and a circular response, as described in Alonso-Pena and Crujeiras (2022). It takes the normal distribution as the kernel associated to the predictor variable and the von Mises distribution as the kernel associated to the response variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modalreg.circ.lin(x, y, t=NULL, bw=NULL, tol = 0.0001, maxit = 500,
    from = circular(0),to = circular(2 * pi), len = 300)

modalreg.circ.circ(x, y, t=NULL, bw=NULL, tol = 0.00001,
    maxit = 500, from = circular(0), to = circular(2 * pi), len = 300)

modalreg.lin.circ(x, y, t=NULL, bw=NULL, tol = 0.0001, maxit = 500, len=300)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modalreg.circ.lin_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>modalreg.circ.lin</code> and <code>modalreg.circ.circ</code>.</p>
</td></tr>
<tr><td><code id="modalreg.circ.lin_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as <code>x</code>. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>modalreg.circ.circ</code> and <code>modalreg.lin.circ</code>.</p>
</td></tr>
<tr><td><code id="modalreg.circ.lin_+3A_t">t</code></td>
<td>
<p>Points where the regression function  is estimated. If <code>NULL</code>, equally spaced points are used according to the parameters <code>from</code>, <code>to</code> and <code>len</code>.</p>
</td></tr>
<tr><td><code id="modalreg.circ.lin_+3A_bw">bw</code></td>
<td>
<p>Vector of length two with the values of the smoothing parameters to be used. The first component corresponds to the smoothing parameter associated to the predictor variable and the second component is the parameter associated to the response variable. If <code>NULL</code>, the parameters are selected via modal cross-validation.</p>
</td></tr>
<tr><td><code id="modalreg.circ.lin_+3A_tol">tol</code></td>
<td>
<p>Tolerance parameter for convergence in the estimation through the conditional (circular) mean shift.</p>
</td></tr>
<tr><td><code id="modalreg.circ.lin_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the estimation through the conditional (circular) mean shift.</p>
</td></tr>
<tr><td><code id="modalreg.circ.lin_+3A_from">from</code>, <code id="modalreg.circ.lin_+3A_to">to</code></td>
<td>
<p> Left and right-most points of the grid at which the regression multifunction is to be estimated. The objects are coerced to class <code><a href="circular.html#topic+circular">circular</a></code>.</p>
</td></tr>
<tr><td><code id="modalreg.circ.lin_+3A_len">len</code></td>
<td>
<p> Number of equally spaced points at which the regression multifunction is to be estimated.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>See Alonso-Pena and Crujeiras (2022) for details.
</p>
<p>The NAs will be automatically removed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>datax</code>, <code>datay</code></td>
<td>
<p> Original dataset.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> The n coordinates of the points where the regression multifunction is estimated.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> A list with dimension the length of the number of evaluation points  containing  the estimated values of the multidunfunction for each evaluation point.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p> A verctor of lenght two with the smoothing parameters used.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p> The sample size after elimination of missing values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> The call which produced the result.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> The deparsed name of the x argument.</p>
</td></tr>
<tr><td><code>has.na</code></td>
<td>
<p> Logical, for compatibility (always FALSE).</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Maria Alonso-Pena and Rosa M. Crujeiras.
</p>


<h3>References</h3>


<p>Alonso-Pena, M. and Crujeiras, R. M. (2022). Analizing animal escape data with circular nonparametric multimodal regression. Annals of Applied Statistics. (To appear).
</p>


<h3>See Also</h3>


<p><code><a href="#topic+bw.modalreg.circ.lin">bw.modalreg.circ.lin</a></code>, <code><a href="#topic+bw.modalreg.circ.circ">bw.modalreg.circ.circ</a></code>, <code><a href="#topic+bw.modalreg.lin.circ">bw.modalreg.lin.circ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Circ-lin
  set.seed(8833)
  n1&lt;-100
  n2&lt;-100
  gamma&lt;-8
  sigma&lt;-1.5
  theta1&lt;-rcircularuniform(n1)
  theta2&lt;-rcircularuniform(n2)
  theta&lt;-c(theta1,theta2)
  y1&lt;-2*sin(2*theta1)+rnorm(n1,sd=sigma)
  y2&lt;-gamma+2*sin(2*theta2)+rnorm(n2,sd=sigma)
  y&lt;-as.numeric(c(y1,y2))
  fit&lt;-modalreg.circ.lin(theta,y,bw=c(10,1.3))
  
  # Lin-circ
  n1&lt;-100
  n2&lt;-100
  con&lt;-8
  set.seed(8833)
  x1&lt;-runif(n1)
  x2&lt;-runif(n2)
  phi1&lt;-(6*atan(2.5*x1-3)+rvonmises(n1,m=0,k=con))
  phi2&lt;-(pi+6*atan(2.5*x2-3)+rvonmises(n2,m=0,k=con))
  x&lt;-c(x1,x2)
  phi&lt;-c(phi1,phi2)
  fit&lt;-modalreg.lin.circ(x, phi, bw=c(0.1,2.5))
  
  # Circ-circ
  n1&lt;-100
  n2&lt;-100
  con&lt;-10
  set.seed(8833)
  theta1&lt;-rcircularuniform(n1)
  theta2&lt;-rcircularuniform(n2)
  phi1&lt;-(2*cos(theta1)+rvonmises(n1,m=0,k=con))
  phi2&lt;-(3*pi/4+2*cos(theta2)+rvonmises(n2,m=0,k=con))
  theta=c(theta1,theta2)
  phi=c(phi1,phi2)
  fit&lt;-modalreg.circ.circ(theta, phi, bw=c(30,3))

</code></pre>

<hr>
<h2 id='noeffect.circ.lin'>No-effect test for regression with circular data</h2><span id='topic+noeffect.circ.lin'></span><span id='topic+noeffect.lin.circ'></span><span id='topic+noeffect.circ.circ'></span>

<h3>Description</h3>


<p>Function <code>noeffect.circ.lin</code> computes the no-effect test for a circular predictor variable and a real-valued response variable as described in Alonso-Pena et al. (2021). It uses the nonparametric Nadaraya-Watson estimator or the Local-Linear estimator for circular-linear data described in Di Marzio et al. (2009) and Oliveira et al. (2013).
</p>
<p>Function <code>noeffect.lin.circ</code> computes the no-effect test for a real-valued predictor variable and a circular response variable as described in Alonso-Pena et al. (2021). It uses the nonparametric Nadaraya-Watson estimator or the Local-Linear estimator for linear-circular data described in Di Marzio et al. (2012).
</p>
<p>Function <code>noeffect.circ.circ</code> computes the no-effect test for a circular predictor variable and a circular response variable as described in Alonso-Pena et al. (2021). It uses the nonparametric Nadaraya-Watson estimator or the Local-Linear estimator for circular-circular data described in Di Marzio et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noeffect.circ.lin(x, y, bw, method = "LL", calib = "chisq", n_boot = 500)
noeffect.lin.circ(x, y, bw, method = "LL", n_boot = 500)
noeffect.circ.circ(x, y, bw, method = "LL", n_boot = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noeffect.circ.lin_+3A_x">x</code></td>
<td>
<p>Vector of data for the independent variable. The object is coerced to              class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>noeffect.circ.lin</code> and <code>noeffect.circ.circ</code>.</p>
</td></tr>
<tr><td><code id="noeffect.circ.lin_+3A_y">y</code></td>
<td>
<p>Vector of data for the dependent variable. This must be same length as             <code>x</code>. The object is coerced to class <code><a href="circular.html#topic+circular">circular</a></code> when using functions <code>noeffect.lin.circ</code> and <code>noeffect.circ.circ</code>.</p>
</td></tr>
<tr><td><code id="noeffect.circ.lin_+3A_bw">bw</code></td>
<td>
<p>Smoothing parameter to be used. If not provided, functions <code>noeffect.circ.lin</code> and  <code>noeffect.circ.circ</code> select <code class="reqn">4cv</code> and function  <code>noeffect.lin.circ</code> selects <code class="reqn">cv/4</code>,  where <code class="reqn">cv</code> is the parameter selected by cross-validation.</p>
</td></tr>
<tr><td><code id="noeffect.circ.lin_+3A_method">method</code></td>
<td>
<p>Character string giving the estimator to be used. This must be one of <code>"LL"</code> for Local-Linear estimator or <code>"NW"</code> for Nadaraya-Watson estimator. Default <code>method="LL"</code>.</p>
</td></tr>
<tr><td><code id="noeffect.circ.lin_+3A_calib">calib</code></td>
<td>
<p>Character string giving the calibration method to be used in <code>noeffect.circ.lin</code> function. This must be one of <code>"chisq"</code> for the chi-squared approximation or <code>"boot"</code> for the bootstrap calibration.</p>
</td></tr>
<tr><td><code id="noeffect.circ.lin_+3A_n_boot">n_boot</code></td>
<td>
<p>Number of bootstrap resamples. Default is <code>n_boot=500</code>. In function <code>noeffect.circ.lin</code>, only if <code>calib="boot"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>See Alonso-Pena et al. (2021). The NAs will be automatically removed.
</p>


<h3>Value</h3>






<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>observed value of the statistic.</p>
</td></tr>
<tr><td><code>bw</code></td>
<td>
<p>Smoothing parameter used.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value for the test.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Maria Alonso-Pena, Jose Ameijeiras-Alonso and Rosa M. Crujeiras
</p>


<h3>References</h3>


<p>Alonso-Pena, M., Ameijeiras-Alonso, J. and Crujeiras, R.M. (2021) Nonparametric tests for circular regression. <em>Journal of Statistical Computation and Simulation</em>, <strong>91</strong>(3), 477&ndash;500.
</p>
<p>Di Marzio, M., Panzera A. and Taylor, C. C. (2009) Local polynomial regression for circular predictors. <em>Statistics and Probability Letters</em>, <strong>79</strong>, 2066&ndash;2075.
</p>
<p>Di Marzio, M., Panzera A. and Taylor, C. C. (2012) Non&ndash;parametric regression for circular responses. <em>Scandinavian Journal of Statistics</em>, <strong>40</strong>, 228&ndash;255.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez-Casal, A. (2013) Nonparametric circular methods for exploring environmental data. <em>Environmental and Ecological Statistics</em>, <strong>20</strong>, 1&ndash;17.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+kern.reg.circ.lin">kern.reg.circ.lin</a></code>, <code><a href="#topic+kern.reg.lin.circ">kern.reg.lin.circ</a></code>, <code><a href="#topic+kern.reg.circ.circ">kern.reg.circ.circ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# No-effect circ-lin
set.seed(2025)
x &lt;- rcircularuniform(200)
y &lt;- 2*sin(as.numeric(x)) + rnorm(200, sd=2)
noeffect.circ.lin(x, y)

# No-effect lin-circ
set.seed(2025)
x &lt;- runif(200)
y&lt;- pi/8 + rvonmises(200, mu = 0, kappa = 0.75)
noeffect.lin.circ(x, y)


# No-effect circ-circ
set.seed(2025)
x &lt;- rcircularuniform(200)
y &lt;- atan2(sin(2*x),cos(2*x)) + rvonmises(200, mu = 0, kappa = 2)
noeffect.circ.circ(x, y)

</code></pre>

<hr>
<h2 id='NPCirc-internal'>Internal NPCirc Functions</h2><span id='topic+amisefr'></span><span id='topic+amisefr2'></span><span id='topic+amsephi'></span><span id='topic+aux_CRSC'></span><span id='topic+aux_cross_validation'></span><span id='topic+aux_refined'></span><span id='topic+bw.dpi'></span><span id='topic+bw.ste'></span><span id='topic+cosmoments'></span><span id='topic+cross_validation'></span><span id='topic+CRSC'></span><span id='topic+d_fun'></span><span id='topic+dcirculardr'></span><span id='topic+ddvonmises'></span><span id='topic+dvonmisesd0'></span><span id='topic+dvonmisesd1'></span><span id='topic+dvonmisesd2'></span><span id='topic+dvonmisesd3'></span><span id='topic+dvonmisesd4'></span><span id='topic+dvonmisesd5'></span><span id='topic+dvonmisesd6'></span><span id='topic+dvonmisesd8'></span><span id='topic+DensCircRad'></span><span id='topic+dmixdvonmises'></span><span id='topic+est_bias'></span><span id='topic+est_variance'></span><span id='topic+estimation_gamma'></span><span id='topic+intmixddvonmises'></span><span id='topic+gammabw'></span><span id='topic+intP1'></span><span id='topic+intP2'></span><span id='topic+int.Simp'></span><span id='topic+kernCL'></span><span id='topic+loc_loglik'></span><span id='topic+loglik_cv'></span><span id='topic+matrixK_block'></span><span id='topic+MISECC'></span><span id='topic+MISECL'></span><span id='topic+MISELC'></span><span id='topic+mle.mixvm'></span><span id='topic+my_fun_DoublePois'></span><span id='topic+my_fun_loglik_cv_nu'></span><span id='topic+NN.circ'></span><span id='topic+NN'></span><span id='topic+Omega_a'></span><span id='topic+Param_DP'></span><span id='topic+pois_p1'></span><span id='topic+R_CV_grid_modereg_CircCirc'></span><span id='topic+R_CV_grid_modereg_CircLin'></span><span id='topic+R_CV_grid_modereg_LinCirc'></span><span id='topic+R_CV_modereg_CircCirc'></span><span id='topic+R_CV_modereg_CircLin2'></span><span id='topic+R_CV_modereg_LinCirc'></span><span id='topic+R_EM_vMN_select'></span><span id='topic+R_EM_vMvM_select'></span><span id='topic+R_cv_re_modereg_CircCirc'></span><span id='topic+R_cv_re_modereg_LinCirc'></span><span id='topic+R_modereg_CircCirc'></span><span id='topic+R_modereg_CircLin'></span><span id='topic+R_modereg_LinCirc'></span><span id='topic+R_myfun_DPoisG'></span><span id='topic+R_myfun_DPoisM'></span><span id='topic+R_re_CV_modereg_CircLin2'></span><span id='topic+refined_rule'></span><span id='topic+RegCircCirc'></span><span id='topic+RegCircLin'></span><span id='topic+RegLinCirc'></span>

<h3>Description</h3>

<p>Internal NPCirc functions
</p>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>

<hr>
<h2 id='NPCirc-package'>
Nonparametric circular methods.
</h2><span id='topic+NPCirc-package'></span><span id='topic+NPCirc'></span>

<h3>Description</h3>

<p>Nonparametric smoothing methods for density and regression estimation involving circular data,
including methods for estimating circular densities and mean regression functions, described in Oliveira et al. (2014), testing proposals for circular mean regression described in Alonso-Pena et al. (2021), estimation of conditional characteristics (Alonso-Pena et al. 2022a,2022b) and estimation of conditional modes (Alonso-Pena and Crujeiras, 2022).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> NPCirc</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 4.0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-07-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package incorporates the function <code>kern.den.circ</code> which computes the
circular kernel density estimator. For choosing the smoothing parameter different functions are available: <code>bw.rt</code>, <code>bw.CV</code>,
<code>bw.pi</code>, and <code>bw.boot</code>. For mean regression involving circular variables, the package includes the functions: <code>kern.reg.circ.lin</code> for a circular
covariate and linear response; <code>kern.reg.circ.circ</code> for a circular covariate and a circular response; <code>kern.reg.lin.circ</code> for a linear covariate
and a circular response. The three functions compute Nadaraya-Watson and Local-Linear smoothers. The functions <code>bw.reg.circ.lin</code>,
<code>bw.reg.circ.circ</code> and <code>bw.reg.circ.lin</code> implement cross&ndash;validation rules for selecting the smoothing parameter. Functions <code>circsizer.density</code> and <code>circsizer.re-</code> <code>gression</code> provide CircSiZer maps for kernel density estimation and regression estimation, respectively. Functions <code>noeffect.circ.lin</code>, <code>noeffect.circ.circ</code> and <code>noeffect.lin.circ</code> compute the test of no effect to assess the significance of the predictor variable. Additionally, functions <code>ancova.circ.lin</code>, <code>ancova.circ.circ</code> and <code>ancova.lin.circ</code> implement hypothesis testing tools to assess the equality and parallelism of regression curves across different groups of observations.
</p>
<p>Function <code>circ.local.lik</code> implements the estimation of different functions of interest (transformations of the mean function) in contexts where the predictor variable is circular and the conditional distribution is a Gaussian, Bernoulli, Poisson or gamma. Function <code>bw.circ.local.lik</code> computes smoothing parameters for the estimation in the previously described cases, allowing for three different rules. Function <code>kern.dpreg.circ</code> implements the joint kernel estimation of the mean and dispersion functions in cases where the predictor is circular and the conditional distribution is a double Poisson, a particular case of the double exponential family. Smoothing parameters in this context can be computed with function <code>bw.joint.dpcirc</code>, using a two-step cross-validation algorithm.
</p>
<p>Functions <code>modalreg.circ.circ</code>, <code>modalreg.lin.circ</code> and <code>modalreg.circ.lin</code> implement the estimation of the modal regression multifunction (the conditional local modes) in the three circular regression scenarios. Smoothing parameters for these contexts can by computed by modal cross-validation employin functions <code>bw.modalreg.circ.circ</code>, <code>bw.modalreg.lin.circ</code> and <code>bw.modalreg.circ.lin</code>.
</p>
<p>Functions <code>dcircmix</code> and <code>rcircmix</code> compute the density function and generate random samples of a circular distribution or a mixture of circular
distributions, allowing for different components such as the circular uniform, von Mises, cardioid, wrapped Cauchy, wrapped normal and wrapped skew-normal.
Finally, some data sets are provided. Missing data are allowed. Registries with missing data are simply removed.
</p>
<p>For a complete list of functions, use <code>library(help="NPCirc").</code> </p>


<h3>Acknowledgements</h3>

<p> This work has been supported by Project MTM2008-03010  from the Spanish Ministry of Science; Project and MTM201676969-P from the AEI co-funded by the European Regional Development Fund (ERDF), the Competitive Reference
Groups 2017-2020 (ED431C 2017/38) from the Xunta de Galicia through the ERDF; and Innovation IAP network (Developing
crucial Statistical methods for Understanding major complex Dynamic Systems in natural, biomedical and social sciences (StUDyS)) from Belgian Science Policy. Work of Maria Alonso-Pena was supported by grant ED481A-2019/139 from Xunta de Galicia. Work of Jose Ameijeiras-Alonso was supported by the FWO research project G.0826.15N (Flemish Science Foundation); and GOA/12/014 project (Research Fund KU Leuven). The authors want to acknowledge Prof. Arthur Pewsey for facilitating data examples and for his comments.
</p>


<h3>Author(s)</h3>

<p>Maria Oliveira, Maria Alonso-Pena, Jose Ameijeiras-Alonso, Rosa M. Crujeiras, Alberto Rodriguez&ndash;Casal and Irene Gijbels.
</p>
<p>Maintainer: Maria Alonso-Pena <a href="mailto:mariaalonso.pena@usc.es">mariaalonso.pena@usc.es</a>
</p>


<h3>References</h3>

<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal, A. (2012) A plug&ndash;in rule for bandwidth selection in circular density. <em>Computational Statistics
and Data Analysis</em>, <b>56</b>, 3898&ndash;3908.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2013) Nonparametric circular methods for exploring environmental data.
<em>Environmental and Ecological Statistics</em>, <b>20</b>, 1&ndash;17.
</p>
<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal (2014) CircSiZer: an exploratory tool for circular data. <em>Environmental and Ecological Statistics</em>,
<b>21</b>, 143&ndash;159.
</p>
<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>
<p>Alonso-Pena, M., Ameijeiras-Alonso, J. and Crujeiras, R.M. (2021) Nonparametric tests for circular regression. <em>Journal of Statistical Computation and Simulation</em>, <b>91</b>(3), 477&ndash;500.
</p>
<p>Alonso-Pena, M., Gijbels, I. and Crujeiras, R.M. (2022a). A general framework for circular local likelihood regression. <em>Under review</em>.
</p>
<p>Alonso-Pena, M., Gijbels, I. and Crujeiras, R.M. (2022b). Flexible joint modeling of mean and dispersion for the directional tuning of neuronal spike counts. <em>Under review</em>.
</p>
<p>Alonso-Pena, M. and Crujeiras, R. M. (2022). Analizing animal escape data with circular nonparametric multimodal regression. Annals of Applied Statistics. (To appear).
</p>

<hr>
<h2 id='periwinkles'> Orientations of dragonflies
</h2><span id='topic+periwinkles'></span>

<h3>Description</h3>

<p>These data, presented in Fisher and Lee (1992), contain distance and directions of movements from small blue periwinkles after relocation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(periwinkles)</code></pre>


<h3>Format</h3>

<p>A two-column data frame with 73 observations. Distances are measured in centimeters and directions are measured in degrees.
</p>


<h3>Source</h3>

<p>Fisher, N. I. and Lee, A. J. (1992) Regression models for angular responses. <em>Biometrics</em>, <b>48</b>, 665&ndash;677.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(periwinkles)
</code></pre>

<hr>
<h2 id='plot.regression.circular'> Plot circular regression</h2><span id='topic+plot.regression.circular'></span>

<h3>Description</h3>

<p>The <code>plot</code> method for <code>regression.circular</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regression.circular'
plot(x, plot.type=c("circle", "line"), points.plot=FALSE, rp.type="p", type="l",
line.col=1, points.col="grey", points.pch=1, xlim=NULL, ylim=NULL,
radial.lim=NULL, xlab=NULL, ylab=NULL, labels=NULL, label.pos=NULL, units=NULL,
zero=NULL, clockwise=NULL, main=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.regression.circular_+3A_x">x</code></td>
<td>
<p> An object of class <code>regression.circular</code>.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_plot.type">plot.type</code></td>
<td>
<p> Type of the plot: &quot;line&quot;: linear plot, &quot;circle&quot;: circular plot.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_points.plot">points.plot</code></td>
<td>
<p> Logical; if TRUE original data are added to the plot.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_rp.type">rp.type</code>, <code id="plot.regression.circular_+3A_type">type</code></td>
<td>
<p> Character indicating the type of plotting. Default <code>type="l"</code> and <code>rp.type="p"</code>.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_line.col">line.col</code></td>
<td>
<p> Color code or name.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_points.col">points.col</code></td>
<td>
<p> Color code or name for the original data. Used if <code>points.plot=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_points.pch">points.pch</code></td>
<td>
<p> Plotting 'character', i.e., symbol to use for the original data. Used if <code>points.plot=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_xlim">xlim</code>, <code id="plot.regression.circular_+3A_ylim">ylim</code></td>
<td>
<p> The ranges to be encompassed by the x and y axes. Used if <code>plot.type="line"</code>. </p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_radial.lim">radial.lim</code></td>
<td>
<p> The range of the grid circle, used if <code>plot.type="circle"</code>.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_xlab">xlab</code>, <code id="plot.regression.circular_+3A_ylab">ylab</code></td>
<td>
<p> Titles for the x axis and y axis, respectively.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_labels">labels</code></td>
<td>
<p> Character or expression vector of labels to be placed at the <code>label.pos</code>. <code>label.pos</code> must also be supplied.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_label.pos">label.pos</code></td>
<td>
<p> Vector indicating the position (between <code class="reqn">0</code> and <code class="reqn">2\pi</code>) at which the labels are to be drawn.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_units">units</code></td>
<td>
<p> Units measure used in the plot. If <code>NULL</code> the value is taken from the attribute of object 'x' from the argument 'x', i.e. x$x.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_zero">zero</code></td>
<td>
<p> Where to place the starting (zero) point, i.e. the zero of the plot. If <code>NULL</code> the value is taken from the attribute of object 'x'
from the argument 'x', i.e. x$x</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_clockwise">clockwise</code></td>
<td>
<p> Logical, indicating the sense of rotation of the plot: clockwise if <code>TRUE</code> and counterclockwise if <code>FALSE</code>. If <code>NULL</code> the
value is taken from the attribute of object 'x' from the argument 'x', i.e. x$x</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_main">main</code></td>
<td>
<p> An overall title for the plot.</p>
</td></tr>
<tr><td><code id="plot.regression.circular_+3A_...">...</code></td>
<td>
<p> Further arguments to be passed to <code><a href="graphics.html#topic+plot.default">plot.default</a></code> (if <code>plot.type="line"</code>) or to to <code><a href="plotrix.html#topic+radial.plot">radial.plot</a></code> (if
codeplot.type=&quot;circle&quot; and <code>x</code> is the output of <code><a href="#topic+kern.reg.circ.lin">kern.reg.circ.lin</a></code>) or to <code><a href="rgl.html#topic+lines3d">lines3d</a></code> (if <code>plot.type="circle"</code>)
and <code>x</code> is the output of <code><a href="#topic+kern.reg.circ.circ">kern.reg.circ.circ</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>plot.type="circle"</code> and <code>x</code> is the output of <code>kern.reg.circ.lin</code>), this function returns a list with information on the plot:
<code>zero</code>, <code>clockwise</code> and <code>radial.lim</code>.
</p>


<h3>Author(s)</h3>

<p> Maria Oliveira, Rosa M. Crujeiras and Alberto Rodriguez&ndash;Casal</p>


<h3>References</h3>

<p>Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2014) NPCirc: an R package for nonparametric circular methods. <em>Journal of Statistical Software</em>,
<b>61</b>(9), 1&ndash;26. <a href="https://www.jstatsoft.org/v61/i09/">https://www.jstatsoft.org/v61/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kern.reg.circ.lin">kern.reg.circ.lin</a></code>, <code><a href="#topic+kern.reg.circ.circ">kern.reg.circ.circ</a></code>, <code><a href="#topic+kern.reg.lin.circ">kern.reg.lin.circ</a></code>, <code><a href="#topic+lines.regression.circular">lines.regression.circular</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1012)
n &lt;- 100
x &lt;- runif(100, 0, 2*pi)
y &lt;- sin(x)+0.5*rnorm(n)
estNW&lt;-kern.reg.circ.lin(circular(x),y,t=NULL,bw=10,method="NW")
plot(estNW, plot.type="line", points.plot=TRUE)
plot(estNW, plot.type="circle", points.plot=TRUE)
</code></pre>

<hr>
<h2 id='pm10'>
Pm10 particles in Pontevedra, Spain
</h2><span id='topic+pm10'></span>

<h3>Description</h3>


<p>This dataset contains measurements on pm10 particles concentration in the city of Pontevedra, Spain, as well as wind speed and wind direction recordings. The measurements were taken in a meteorological station in Pontevedra, during the year 2019, every six hours. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pm10")</code></pre>


<h3>Format</h3>

<p>A data frame with 1156 observations on the following 3 variables.
</p>

<dl>
<dt><code>pm10</code></dt><dd><p>A numeric vector containing the concentration of pm10 particles (in micrograms per cubic meter).</p>
</dd>
<dt><code>direction</code></dt><dd><p>A numeric vector containing the wind direction in degrees between 0 and 360. </p>
</dd>
<dt><code>speed</code></dt><dd><p>A numeric vector containing the wind speed measured in kilometers per hour.</p>
</dd>
</dl>



<h3>Source</h3>


<p>Meteogalicia <a href="https://www.meteogalicia.gal/">https://www.meteogalicia.gal/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pm10)
</code></pre>

<hr>
<h2 id='sandhoppers'>
Behavioral plasticity of Talitrus saltator and Talorchestia brito
</h2><span id='topic+sandhoppers'></span>

<h3>Description</h3>


<p>Orientation measured under natural conditions and other variables of interest for analyzing the behavioral plasticity of two sympatric sandhoppers species, Talitrus saltator and Talorchestia brito. The experiment was carried out on the exposed nontidal sand of Zouara beach located in the Tunisian northwestern coast. More details can be found in Marchetti and Scapini (2003) or Scapini et al. (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sandhoppers")</code></pre>


<h3>Format</h3>

<p>A data frame with 1828 observations on the following 12 variables.
</p>

<dl>
<dt><code>angle</code></dt><dd><p>Numeric vector containing the orientation angles in radians between 0 and <code class="reqn">2\pi</code>.</p>
</dd>
<dt><code>date</code></dt><dd><p>A factor where each level indicates the date when angles were measured.</p>
</dd>
<dt><code>month</code></dt><dd><p>A factor with two levels indicating the month when angles were measured. Experiments were performed in two different periods, <code>April</code> and <code>October</code>, which were chosen for the abundance of the populations, as well as for their non-extreme and changing climatic conditions.</p>
</dd>
<dt><code>time</code></dt><dd><p>A factor with levels <code>afternoon</code>, <code>morning</code> and <code>noon</code>.</p>
</dd>
<dt><code>azim</code></dt><dd><p>A numeric vector indicating the sun azimuth. The sun position was confounded with the time of the day (morning: 100-150, noon: az=151-210 and afternoon: az=211-260 experiments).</p>
</dd>
<dt><code>hour</code></dt><dd><p>A factor with hours when angles were measured.</p>
</dd>
<dt><code>species</code></dt><dd><p>A factor with three levels (<code>brito</code>, <code>salt</code>, <code>ND</code>) indicating the specie (brito, saltator, not determined).</p>
</dd>
<dt><code>sex</code></dt><dd><p>A factor with three levels (<code>F</code>, <code>M</code>, <code>J</code>) indicating the sex (female, male, J).</p>
</dd>
<dt><code>temp</code></dt><dd><p>A numeric vector indicating the temperature (degrees centigrade).</p>
</dd>
<dt><code>humid</code></dt><dd><p>A numeric vector indicating the air relative humidity (%).</p>
</dd>
<dt><code>land</code></dt><dd><p>A factor with two levels (<code>no</code>, <code>yes</code>) indicating landscape view was either permitted or screened.</p>
</dd>
<dt><code>trap</code></dt><dd><p>A numeric vector containing the traps identifier used for capturing the sandhoppers.</p>
</dd>
</dl>



<h3>Details</h3>

<p>See Marchetti and Scapini (2003) and Scapini et al. (2002).
</p>


<h3>Source</h3>


<p>Authors thank Prof. Felicita Scapini for providing the sandhoppers data (collected under the support of the European Project ERB ICI8-CT98-0270).</p>


<h3>References</h3>

<p>Marchetti, G. M. and Scapini, F. (2003). Use of multiple regression models in the study of sandhopper orientation under natural conditions. <em>Estuarine, Coastal and Shelf Science</em>, <strong>58</strong>, 207-215.<br />
</p>
<p>Scapini, F., Aloia, A., Bouslama, M. F., Chelazzi, L., Colombini, I., ElGtari, M., Fallaci, M. and Marchetti, G. M. (2002). Multiple regression analysis of the sources of variation in orientation of two sympatric sandhoppers, Talitrus saltator and Talorchestia brito, from an exposed Mediterranean beach. <em>Behavioral Ecology and Sociobiology</em>, <strong>51</strong>(5), 403&ndash;414.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sandhoppers)

</code></pre>

<hr>
<h2 id='speed.wind'> Wind speed and wind direction data
</h2><span id='topic+speed.wind'></span><span id='topic+speed.wind2'></span>

<h3>Description</h3>

<p>This dataset consists of hourly observations of wind direction and wind speed in winter season (from November to February)
from 2003 until 2012 in the Atlantic coast of Galicia (NW&ndash;Spain). Data are registered by a buoy located at longitude -0.210E and latitude 43.500N in the 
Atlantic Ocean. The dataset <code>speed.wind2</code>, analized in Oliveira et al. (2013), is a subset of <code>speed.wind</code> which is obtained by taking the 
observations with a lag period of 95 hours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(speed.wind)
data(speed.wind2)
</code></pre>


<h3>Format</h3>

<p><code>speed.wind</code> is a data frame with 19488 observations on six variables: day, month, year, hour, wind speed (in m/s) and wind direction 
(in degrees). <code>speed.wind2</code> is a subset with 200 observations.
</p>


<h3>Details</h3>

<p>Data contains NAs.
There is no data in November 2005, December 2005, January 2006, February 2006, February 2007, February 2009 and November 2009. Months of November 2004, 
December 2004, January 2007, December 2009 are not fully observed.
</p>


<h3>Source</h3>

<p>Data can be freely downloaded from the Spanish Portuary Authority (<a href="https://www.puertos.es/">https://www.puertos.es/</a>).
</p>


<h3>References</h3>

 
<p>Oliveira, M., Crujeiras, R.M. and Rodriguez&ndash;Casal (2014) CircSiZer: an exploratory tool for circular data. <em>Environmental and Ecological Statistics</em>, 
<b>21</b>, 143&ndash;159.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(speed.wind2)

# Density
dir &lt;- circular(speed.wind2$Direction, units="degrees", template="geographics")
plot(dir, stack=TRUE,  shrink= 1.1)
rose.diag(dir, bins=16, add=TRUE)
lines(kern.den.circ(dir,bw=1), lwd=2, col=2)
lines(kern.den.circ(dir,bw=10), lwd=2, col=3)
lines(kern.den.circ(dir,bw=40), lwd=2, col=4)

# Regression
vel &lt;- speed.wind2$Speed
nas &lt;- which(is.na(vel))
dir &lt;- dir[-nas]
vel &lt;- vel[-nas]
res&lt;-plot(kern.reg.circ.lin(dir, vel, bw=1, method="LL"), plot.type="circle", 
points.plot=TRUE, line.col=2, lwd=2, main="")
lines(kern.reg.circ.lin(dir, vel, bw=10, method="LL"), plot.type="circle", plot.info=res,
line.col=3, lwd=2)
lines(kern.reg.circ.lin(dir, vel, bw=40, method="LL"), plot.type="circle", plot.info=res, 
line.col=4, lwd=2)
</code></pre>

<hr>
<h2 id='spikes'>
Neuronal spikes in a macaque monkey
</h2><span id='topic+spikes'></span>

<h3>Description</h3>


<p>This dataset, given by Kohn and Movshon (2003), contains observations from an experimental study on macaque monkeys, where a macaque received a visual stimulus. The dataset is composed of 68 observations, consisting on the angle of stimulus and the number of spikes produced in a MT/V5 neuron.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("spikes")</code></pre>


<h3>Format</h3>

<p>A data frame with 68 observations on the following 2 variables.
</p>

<dl>
<dt><code>direction</code></dt><dd><p>A numeric vector containing the direction of the visual stimulus (in degrees).</p>
</dd>
<dt><code>counts</code></dt><dd><p>A numeric vector containing the number of spikes.</p>
</dd>
</dl>



<h3>Details</h3>

<p>See Kohn and Movshon (2003) for details. This dataset was also studied in Alonso-Pena et al (2022). 
</p>


<h3>Source</h3>

<p>The dataset was obtained by Kohn and Movshon (2003). 
</p>


<h3>References</h3>


<p>Kohn, A., and Movshon, J.A. (2003). Neuronal adaptation to visual motion in area MT of the macaque. <em>Neuron</em>, <strong>39</strong>(4), 681&ndash;691.
</p>
<p>Alonso-Pena, M., Gijbels, I. and Crujeiras, R.M. (2022). Flexible joint modeling of mean and dispersion for the directional tuning of neuronal spike counts. <em>Under review</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spikes)
</code></pre>

<hr>
<h2 id='temp.wind'> Temperature and wind direction data
</h2><span id='topic+temp.wind'></span>

<h3>Description</h3>

<p>These data, analyzed by  Oliveira et al. (2013), consists of observations of temperature and wind direction during the austral summer season 2008-2009 
(from November 2008 to March 2009) in Vinciguerra (Tierra del Fuego, Argentina).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(temp.wind)</code></pre>


<h3>Format</h3>

<p>A data frame with 3648 observations on four variables: <code>Date</code>, <code>Time</code>, <code>Temperature</code> (in degrees Celsius) and <code>Direction</code> (in degrees).
</p>


<h3>Details</h3>

<p>Data contains NAs.
</p>


<h3>Source</h3>

<p>The authors want to acknowledge Prof. Augusto P?rez&ndash;Alberti for providing the data, collected within the Project POL2006-09071 from the Spanish Ministry 
of Education and Science.
</p>


<h3>References</h3>

<p> Oliveira, M., Crujeiras R.M. and Rodriguez&ndash;Casal, A. (2013) Nonparametric circular methods for exploring environmental data. 
<em>Environmental and Ecological Statistics</em>, <b>20</b>, 1&ndash;17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(temp.wind)
winddir &lt;- temp.wind[,4] 
temp &lt;- temp.wind[,3]
nas &lt;- which(is.na(winddir))
winddir &lt;- circular(winddir[-nas], units="degrees") 
temp &lt;- temp[-nas]

est &lt;- kern.reg.circ.lin(winddir, temp, t=NULL, bw=3.41, method="LL")
plot(est, plot.type="line", xlab="wind direction", ylab="temperature")
plot(est, plot.type="circle", points.plot=TRUE)
</code></pre>

<hr>
<h2 id='wind'> Wind direction data
</h2><span id='topic+wind'></span>

<h3>Description</h3>

<p>This dataset consists of hourly observations of wind direction measured at a weather station in Texas from May  20 to July 31, 2003 inclusive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wind)
</code></pre>


<h3>Format</h3>

<p><code>wind</code> is a data frame with observations on three variables: data, hour and wind direction (in radians).
</p>


<h3>Source</h3>

<p>The data, which correspons to the weather station designated as C28_1, are part of a larger data set taken from the Codiac data archive, available at <a href="https://data.eol.ucar.edu/dataset/85.034">https://data.eol.ucar.edu/dataset/85.034</a>. The full data
set contains hourly resolution surface meteorological data from the Texas Natural Resources Conservation Commission Air Quality Monitoring Network, from May 20 to July 31, 2003
inclusive. These data are provided by NCAR/EOL under the sponsorship of the National Science Foundation.
</p>


<h3>References</h3>

<p>Kato, S. and Jones, M. C. (2010) A family of distributions on the circle with links to, and applications arising from, M?bius transformation. <em>Journal
of the American Statistical Association</em>, <b>105</b>, 249&ndash;262.
</p>
<p>Di Marzio, M., Panzera A. and Taylor, C. C. (2012) Non&ndash;parametric regression for circular responses. <em>Scandinavian Journal of Statistics</em>,
<b>40</b>, 228&ndash;255.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wind)
</code></pre>

<hr>
<h2 id='zebrafish'>
Zebrafish
</h2><span id='topic+zebrafish'></span>

<h3>Description</h3>

<p>The data consists on measurements from an experimental study on larval zebrafish, which were startled by an imitating predator consisting on a robot disguised as an adult zebrafish. The dataset includes 502 observations corresponding to the escape directions of each fish and the angles in which the zebrafish perceive the threat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("zebrafish")</code></pre>


<h3>Format</h3>

<p>A data frame with 502 observations on the following 2 variables.
</p>

<dl>
<dt><code>stimulus</code></dt><dd><p>A numeric vector containing the angles of stimulus (in radians)</p>
</dd>
<dt><code>res_angle</code></dt><dd><p>A numeric vector containing the directions of escape (in radians)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Analysis of the zebrafish data with circular regression methods can be seen in Alonso-Pena et al. (2022).
</p>


<h3>Source</h3>


<p>The data were obtained from the Dryad Digital Repository <a href="https://doi.org/10.5061/dryad.47mq9">doi:10.5061/dryad.47mq9</a> and first analyzed in Nair et al. (2017).
</p>


<h3>References</h3>


<p>Nair, A., Changsing, K., Stewart, W.J. and McHenry, M.J. (2017). Fish prey change strategy with the direction of a threat. <em>Proceedings of the Royal Society B: Biological Sciences</em>, <b>284</b>, 20170393.
</p>
<p>Alonso-Pena, M. and Crujeiras, R. M. (2022). Analizing animal escape data with circular nonparametric multimodal regression. Annals of Applied Statistics. (To appear).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(zebrafish)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
