<!DOCTYPE html><html><head><title>Help for package mixPHM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixPHM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mixPHM-package'>
<p>Mixtures of proportional hazard models</p></a></li>
<li><a href='#msBIC'><p>PHM model selection with BIC</p></a></li>
<li><a href='#phmclust'><p>Fits mixtures of proportional hazard models</p></a></li>
<li><a href='#plot_hazard'><p>Plot functions</p></a></li>
<li><a href='#screeBIC'><p>Scree plot of BIC's</p></a></li>
<li><a href='#stableEM'><p>Stable EM solution</p></a></li>
<li><a href='#webshop'><p>Webshop dataset for mixPHM package</p></a></li>
<li><a href='#WilcoxH'><p>Tests of Zero Correlations Among P Variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mixtures of Proportional Hazard Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-07-23</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits multiple variable mixtures of various parametric proportional hazard models using the EM-Algorithm. Proportionality restrictions can be imposed on the latent groups and/or on the variables. Several survival distributions can be specified. Missing values and censored values are allowed. Independence is assumed over the single variables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, survival, lattice</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-07-23 12:11:41 UTC; patrick</td>
</tr>
<tr>
<td>Author:</td>
<td>Patrick Mair [cre, aut],
  Marcus Hudec [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Patrick Mair &lt;mair@fas.harvard.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-07-23 15:14:01</td>
</tr>
</table>
<hr>
<h2 id='mixPHM-package'>
Mixtures of proportional hazard models
</h2><span id='topic+mixPHM-package'></span><span id='topic+mixPHM'></span>

<h3>Description</h3>

<p>This package fits multiple variable mixtures of various parametric proportional hazard models using the EM-Algorithm. 
Proportionality restrictions can be imposed on the latent groups and/or on the variables. 
Several survival distributions can be specified. Missing and censored values are allowed. Independence is assumed over the single variables.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mixPHM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.7-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-07-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Patrick Mair, Marcus Hudec
</p>
<p>Maintainer: Patrick Mair &lt;mair@fas.harvard.edu&gt;
</p>


<h3>References</h3>

<p>Mair, P., and Hudec, M. (2009). Multivariate Weibull mixtures with proportional hazard
restrictions for dwell time based session clustering with incomplete data. Journal of
the Royal Statistical Society, Series C (Applied Statistics), 58(5), 619-639.
</p>
<p>Kalbfleisch, J.D., and Prentice, R.L. (1980). The statistical analysis of failure 
time data. New York: Wiley. 
</p>
<p>Celaux, G., and Govaert, G. (1992). A classification EM algorithm for clustering and
two stochastic versions. Computational Statistics and Data Analysis, 14, 315-332.
</p>

<hr>
<h2 id='msBIC'>PHM model selection with BIC</h2><span id='topic+msBIC'></span><span id='topic+print.msBIC'></span>

<h3>Description</h3>

<p>This function fits models for different proportionality restrictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msBIC(x, K, method = "all", Sdist = "weibull", cutpoint = NULL, 
EMoption = "classification", EMstop = 0.01, maxiter = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msBIC_+3A_x">x</code></td>
<td>
<p>Data frame or matrix of dimension n*p with survival times (<code>NA</code>'s allowed).</p>
</td></tr>
<tr><td><code id="msBIC_+3A_k">K</code></td>
<td>
<p>A vector with number of mixture components.</p>
</td></tr>
<tr><td><code id="msBIC_+3A_method">method</code></td>
<td>
<p>A vector with the methods provided in <code>phmclust</code>: 
With <code>"separate"</code> no restrictions are imposed, <code>"main.g"</code> relates to a group main effect, 
<code>"main.p"</code> to the variables main effects. <code>"main.gp"</code> reflects the proportionality assumption over groups
and variables. <code>"int.gp"</code> allows for interactions between groups and variables. If method is <code>"all"</code>, each model is fitted.</p>
</td></tr>
<tr><td><code id="msBIC_+3A_sdist">Sdist</code></td>
<td>
<p>Various survival distrubtions such as <code>"weibull"</code>, <code>"exponential"</code>, and <code>"rayleigh"</code>.</p>
</td></tr> 
<tr><td><code id="msBIC_+3A_cutpoint">cutpoint</code></td>
<td>
<p>Cutpoint for censoring</p>
</td></tr>
<tr><td><code id="msBIC_+3A_emoption">EMoption</code></td>
<td>
<p><code>"classification"</code> is based on deterministic cluster assignment, 
<code>"maximization"</code> on deterministic assignment, and <code>"randomization"</code> 
provides a posterior-based randomized cluster assignement.</p>
</td></tr>  
<tr><td><code id="msBIC_+3A_emstop">EMstop</code></td>
<td>
<p>Stopping criterion for EM-iteration.</p>
</td></tr>
<tr><td><code id="msBIC_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the output BIC matrix, model selection can be performed in terms of the
number of mixture components and imposed proportionality restrictions. 
</p>


<h3>Value</h3>

<p>Returns an object of class <code>BICmat</code> with the following values:
</p>
<table>
<tr><td><code>BICmat</code></td>
<td>
<p>Matrix with BIC values</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Vector with different components</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Vector with proportional hazard methods</p>
</td></tr>
<tr><td><code>Sdist</code></td>
<td>
<p>Survival distribution</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+screeBIC">screeBIC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Fitting 3 Weibull proportional hazard models (over groups, pages) for K=2,3 components
data(webshop)
res &lt;- msBIC(webshop, K = c(2,3), method = c("main.p","main.g"), maxiter = 10)
res 
</code></pre>

<hr>
<h2 id='phmclust'>Fits mixtures of proportional hazard models</h2><span id='topic+phmclust'></span><span id='topic+summary.mws'></span><span id='topic+print.mws'></span><span id='topic+logLik.mws'></span>

<h3>Description</h3>

<p>This function allows for the computation of proportional hazards models with different distribution assumptions 
on the underlying baseline hazard. Several options for imposing proportionality restrictions on the hazards are provided.
This function offers several variations of the EM-algorithm regarding the posterior computation in the M-step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phmclust(x, K, method = "separate", Sdist = "weibull", cutpoint = NULL, EMstart = NA, 
EMoption = "classification", EMstop = 0.01, maxiter = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phmclust_+3A_x">x</code></td>
<td>
<p>Data frame or matrix of dimension n*p with survival times (<code>NA</code>'s allowed).</p>
</td></tr>
<tr><td><code id="phmclust_+3A_k">K</code></td>
<td>
<p>Number of mixture components.</p>
</td></tr> 
<tr><td><code id="phmclust_+3A_method">method</code></td>
<td>
<p>Imposing proportionality restrictions on the hazards: 
With <code>"separate"</code> no restrictions are imposed, <code>"main.g"</code> relates to a group main effect, 
<code>"main.p"</code> to variable main effects. <code>"main.gp"</code> reflects the proportionality assumption over groups
and variables. <code>"int.gp"</code> allows for interactions between groups and variables.</p>
</td></tr> 
<tr><td><code id="phmclust_+3A_sdist">Sdist</code></td>
<td>
<p>Various survival distrubtions such as <code>"weibull"</code>, <code>"exponential"</code>, and <code>"rayleigh"</code>.</p>
</td></tr> 
<tr><td><code id="phmclust_+3A_cutpoint">cutpoint</code></td>
<td>
<p>Integer value with upper bound for observed dwell times. Above this cutpoint, values are regarded as censored. If NULL, no censoring is performed</p>
</td></tr>
<tr><td><code id="phmclust_+3A_emstart">EMstart</code></td>
<td>
<p>Vector of length n with starting values for group membership, 
<code>NA</code> indicates random starting values.</p>
</td></tr>
<tr><td><code id="phmclust_+3A_emoption">EMoption</code></td>
<td>
<p><code>"classification"</code> is based on deterministic cluster assignment, 
<code>"maximization"</code> on deterministic assignment, and <code>"randomization"</code> 
provides a posterior-based randomized cluster assignement.</p>
</td></tr>  
<tr><td><code id="phmclust_+3A_emstop">EMstop</code></td>
<td>
<p>Stopping criterion for EM-iteration.</p>
</td></tr>
<tr><td><code id="phmclust_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method <code>"separate"</code> corresponds to an ordinary mixture model. <code>"main.g"</code> imposes proportionality 
restrictions over variables (i.e., the group main effect allows for free-varying variable hazards). <code>"main.p"</code> 
imposes proportionality restrictions over groups (i.e., the variable main effect allows for free-varying group hazards).
If clusters with only one observation are generated, the algorithm stops. 
</p>


<h3>Value</h3>

<p>Returns an object of class <code>mws</code> with the following values:
</p>
<table>
<tr><td><code>K</code></td>
<td>
<p>Number of components</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of EM iterations</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Proportionality restrictions used for estimation</p>
</td></tr>
<tr><td><code>Sdist</code></td>
<td>
<p>Assumed survival distribution</p>
</td></tr>
<tr><td><code>likelihood</code></td>
<td>
<p>Log-likelihood value for each iteration</p>
</td></tr>
<tr><td><code>pvisit</code></td>
<td>
<p>Matrix of prior probabilities due to <code>NA structure</code></p>
</td></tr>
<tr><td><code>se.pvisit</code></td>
<td>
<p>Standard errors for priors</p>
</td></tr>
<tr><td><code>shape</code></td>
<td>
<p>Matrix with shape parameters</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>Matrix with scale parameters</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>Final deterministic cluster assignment</p>
</td></tr>
<tr><td><code>posteriors</code></td>
<td>
<p>Final probabilistic cluster assignment</p>
</td></tr>
<tr><td><code>npar</code></td>
<td>
<p>Number of estimated parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike information criterion</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayes information criterion</p>
</td></tr>
<tr><td><code>clmean</code></td>
<td>
<p>Matrix with cluster means</p>
</td></tr>
<tr><td><code>se.clmean</code></td>
<td>
<p>Standard errors for cluster means</p>
</td></tr>
<tr><td><code>clmed</code></td>
<td>
<p>Matrix with cluster medians</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mair, P., and Hudec, M. (2009). Multivariate Weibull mixtures with proportional hazard
restrictions for dwell time based session clustering with incomplete data. Journal of
the Royal Statistical Society, Series C (Applied Statistics), 58(5), 619-639.
</p>
<p>Celaux, G., and Govaert, G. (1992). A classification EM algorithm for clustering and
two stochastic versions. Computational Statistics and Data Analysis, 14, 315-332.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stableEM">stableEM</a></code>, <code><a href="#topic+msBIC">msBIC</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(webshop)

## Fitting a Weibll mixture model (3 components) is fitted with classification EM 
## Observations above 600sec are regarded as censored

res1 &lt;- phmclust(webshop, K = 3, cutpoint = 600)
res1
summary(res1)

## Fitting a Rayleigh Weibull proportional hazard model (2 components, proportional over groups)
res2 &lt;- phmclust(webshop, K = 2, method = "main.p", Sdist = "rayleigh") 
res2
summary(res2)

</code></pre>

<hr>
<h2 id='plot_hazard'>Plot functions</h2><span id='topic+plot_hazard'></span><span id='topic+plot_profile'></span><span id='topic+plot_survival'></span>

<h3>Description</h3>

<p>Plotting functions for hazard rates, survival times and cluster profiles. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_hazard(x, gr.subset, var.subset, group = TRUE, xlim = NA, ylim = NA, 
xlab = "Survival Time", ylab = "Hazard Function", main = "Hazard Functions", type = "l", 
lty = 1, lwd = 1, col = NA, legpos = "right", ...)

plot_survival(x, gr.subset, var.subset, group = TRUE, xlim = NA, ylim = NA, 
xlab = "Survival Time", ylab = "Survival Function", main = "Survival Functions", 
type = "l", lty = 1, lwd = 1, col = NA, legpos = "right", ...)

plot_profile(x, method = "mean", type = "b", pch = 19, lty = 1, lwd = 1, col = NA, 
xlab = "Variables", leglab = NA, ylab = NA, main = NA, legpos = "topright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_hazard_+3A_x">x</code></td>
<td>
<p>object of class <code>mws</code> from <code>phmclust</code></p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_gr.subset">gr.subset</code></td>
<td>
<p>Optional vector for plotting subset of clusters</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_var.subset">var.subset</code></td>
<td>
<p>Optional vector for plotting subset of variables</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_group">group</code></td>
<td>
<p>if <code>TRUE</code> hazard/survival plots are produced for each group, if <code>FALSe</code> for each variable</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_method">method</code></td>
<td>
<p><code>"mean"</code> for cluster mean profile plot and <code>"median"</code> for cluster median profile plot</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_xlim">xlim</code></td>
<td>
<p>limits for x-axis</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_ylim">ylim</code></td>
<td>
<p>limits for y-axis</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_leglab">leglab</code></td>
<td>
<p>label for the legend</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_type">type</code></td>
<td>
<p>type of plot</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_pch">pch</code></td>
<td>
<p>type of plotting points</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_col">col</code></td>
<td>
<p>colors; if <code>NA</code> it is determined in the function</p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_legpos">legpos</code></td>
<td>
<p>position of the legend; <code>"topright"</code>,<code>"topleft"</code>,<code>"bottomright"</code>,
<code>"bottomleft"</code>,<code>"left"</code>,<code>"right"</code>,<code>"top"</code>, or <code>"center"</code></p>
</td></tr>
<tr><td><code id="plot_hazard_+3A_...">...</code></td>
<td>
<p>Additional plot options</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+phmclust">phmclust</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Plots for mixture Weibull model with 3 components
data(webshop)
res &lt;- phmclust(webshop, 3)

##Hazard plot for first and third group, all pages
plot_hazard(res, gr.subset = c(1,3), group = TRUE, xlab = "Dwell Time")

##Survival plot for each group, first 6 pages
plot_survival(res, var.subset= 1:6, group = FALSE, xlab = "Dwell Time")

##Cluster profile plot
plot_profile(res, xlab = "Pages", ylab = "Mean Dwell Time", main = "Cluster Profile")

</code></pre>

<hr>
<h2 id='screeBIC'>Scree plot of BIC's</h2><span id='topic+screeBIC'></span>

<h3>Description</h3>

<p>This function produces a scree plot on the basis of the BIC values in <code>msBIC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screeBIC(x, lty = 1, col = NA, pch = 19, type = "b", main = "BIC Screeplot", 
xlab = "Number of Components", ylab = "BIC", legpos = "topright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screeBIC_+3A_x">x</code></td>
<td>
<p>Object of class <code>mws</code> from <code>msBIC</code></p>
</td></tr>
<tr><td><code id="screeBIC_+3A_lty">lty</code></td>
<td>
<p>Line type</p>
</td></tr>
<tr><td><code id="screeBIC_+3A_col">col</code></td>
<td>
<p>Line colors; if <code>NA</code>, colors are determined automatically</p>
</td></tr>
<tr><td><code id="screeBIC_+3A_pch">pch</code></td>
<td>
<p>Value for plotting points</p>
</td></tr>
<tr><td><code id="screeBIC_+3A_type">type</code></td>
<td>
<p>Type of plot</p>
</td></tr>
<tr><td><code id="screeBIC_+3A_main">main</code></td>
<td>
<p>Plot title</p>
</td></tr>
<tr><td><code id="screeBIC_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis</p>
</td></tr>
<tr><td><code id="screeBIC_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis</p>
</td></tr> 
<tr><td><code id="screeBIC_+3A_legpos">legpos</code></td>
<td>
<p>position of the legend</p>
</td></tr> 
<tr><td><code id="screeBIC_+3A_...">...</code></td>
<td>
<p>Additional plot parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+msBIC">msBIC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Fitting all Weibull proportional hazard models for K=2,3,4 components
data(webshop)
res &lt;- msBIC(webshop, K = c(2,3,4), method = "all", maxiter = 5)
screeBIC(res)
</code></pre>

<hr>
<h2 id='stableEM'>Stable EM solution</h2><span id='topic+stableEM'></span>

<h3>Description</h3>

<p>This function performs the clustering for different EM starting values in order
to find a stable solution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stableEM(x, K, numEMstart = 5, method = "separate", Sdist = "weibull", cutpoint = NULL,
EMoption = "classification", EMstop = 0.0001, maxiter = 1000, print.likvec = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stableEM_+3A_x">x</code></td>
<td>
<p>Data frame or matrix of dimension n*p with survival times (<code>NA</code>'s allowed).</p>
</td></tr>
<tr><td><code id="stableEM_+3A_k">K</code></td>
<td>
<p>Number of mixture components.</p>
</td></tr>
<tr><td><code id="stableEM_+3A_numemstart">numEMstart</code></td>
<td>
<p>Number of different starting solutions</p>
</td></tr>
<tr><td><code id="stableEM_+3A_method">method</code></td>
<td>
<p>Imposing proportionality restrictions on the hazards: 
With <code>separate</code> no restrictions are imposed, <code>main.g</code> relates to a group main effect, 
<code>main.p</code> to the variables main effects. <code>main.gp</code> reflects the proportionality assumption over groups
and variables. <code>int.gp</code> allows for interactions between groups and variables.</p>
</td></tr>
<tr><td><code id="stableEM_+3A_sdist">Sdist</code></td>
<td>
<p>Various survival distrubtions such as <code>weibull</code>, <code>exponential</code>, and <code>rayleigh</code>.</p>
</td></tr> 
<tr><td><code id="stableEM_+3A_cutpoint">cutpoint</code></td>
<td>
<p>Integer value with upper bound for observed dwell times. Above this cutpoint, values are regarded as censored. If NULL, no censoring is performed</p>
</td></tr>
<tr><td><code id="stableEM_+3A_emoption">EMoption</code></td>
<td>
<p><code>classification</code> is based on deterministic cluster assignment, 
<code>maximization</code> on deterministic assignment, and <code>randomization</code> 
provides a posterior-based randomized cluster assignement.</p>
</td></tr>  
<tr><td><code id="stableEM_+3A_emstop">EMstop</code></td>
<td>
<p>Stopping criterion for EM-iteration.</p>
</td></tr>
<tr><td><code id="stableEM_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations.</p>
</td></tr>
<tr><td><code id="stableEM_+3A_print.likvec">print.likvec</code></td>
<td>
<p>If <code>TRUE</code> the likelihood values for different starting solutions are printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After the computation of the models for different starting solutions using the
function <code>phmclust</code> the best model is chosen, i.e., the model with the largest likelihood value. 
The output values refer to this final model.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>mws</code> with the following values:
</p>
<table>
<tr><td><code>K</code></td>
<td>
<p>Number of components</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of EM iterations</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Method with propotionality restrictions used for estimation</p>
</td></tr>
<tr><td><code>Sdist</code></td>
<td>
<p>Assumed survival distribution</p>
</td></tr>
<tr><td><code>likelihood</code></td>
<td>
<p>Log-likelihood value for each iteration</p>
</td></tr>
<tr><td><code>pvisit</code></td>
<td>
<p>Matrix of prior probabilities due to <code>NA structure</code></p>
</td></tr>
<tr><td><code>se.pvisit</code></td>
<td>
<p>Standard errors for priors</p>
</td></tr>
<tr><td><code>shape</code></td>
<td>
<p>Matrix with shape parameters</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>Matrix with scale parameters</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>Final deterministic cluster assignment</p>
</td></tr>
<tr><td><code>posteriors</code></td>
<td>
<p>Final probabilistic cluster assignment</p>
</td></tr>
<tr><td><code>npar</code></td>
<td>
<p>Number of estimated parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike information criterion</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayes information criterion</p>
</td></tr>
<tr><td><code>clmean</code></td>
<td>
<p>Matrix with cluster means</p>
</td></tr>
<tr><td><code>se.clmean</code></td>
<td>
<p>Standard errors for cluster means</p>
</td></tr>
<tr><td><code>clmed</code></td>
<td>
<p>Matrix with cluster medians</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+phmclust">phmclust</a></code>,<code><a href="#topic+msBIC">msBIC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Exponental mixture model with 2 components for 4 different starting solutions
data(webshop)
res &lt;- stableEM(webshop, K = 2, numEMstart = 4, Sdist = "exponential")
res
summary(res)
</code></pre>

<hr>
<h2 id='webshop'>Webshop dataset for mixPHM package</h2><span id='topic+webshop'></span>

<h3>Description</h3>

<p>This artificial data set represents dwell times in seconds of 333 sessions on 7 webpage 
categories of a webshop. Missing values indicate that the corresponding session did not visit a particular page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(webshop)</code></pre>


<h3>Format</h3>

<p>Numeric matrices of data frames with subjects as rows and variables as columns. 
Missing values are coded as <code>NA</code> (which corresponds to 0 survival time).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(webshop)
str(webshop)
</code></pre>

<hr>
<h2 id='WilcoxH'>Tests of Zero Correlations Among P Variables</h2><span id='topic+WilcoxH'></span><span id='topic+print.wilcoxh'></span>

<h3>Description</h3>

<p>This function computes Wilcox H-test and the Steiger-Hakstian-Test for testing H0: R = I. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WilcoxH(x, use = "pairwise.complete.obs")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WilcoxH_+3A_x">x</code></td>
<td>
<p>Data frame or matrix of dimension n*p with survival times (<code>NA</code>'s allowed).</p>
</td></tr>
<tr><td><code id="WilcoxH_+3A_use">use</code></td>
<td>
<p>Treatment of <code>NA</code>'s for the computation of the correlation matrix (see <code>cor()</code>). Either <code>"all.obs"</code>, <code>"complete.obs"</code>, or <code>"pairwise.complete.obs"</code></p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This test is robust against violations of normality. Since <code>phmclust()</code> assumes independence across pages, this test can be used to explore the appropriateness of the data.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>"wilcoxh"</code> with the following values:
</p>
<table>
<tr><td><code>Rmat</code></td>
<td>
<p>Correlation matrix</p>
</td></tr>
<tr><td><code>SH.res</code></td>
<td>
<p>Results for Steiger-Hakstian-Test</p>
</td></tr>
<tr><td><code>WH.res</code></td>
<td>
<p>Results for Wilcox H-test</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (1997). Tests of independence and zero correlations among P variables. Biometrical Journal, 2, 183-193.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phmclust">phmclust</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(webshop)
res &lt;- WilcoxH(webshop)
res

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
