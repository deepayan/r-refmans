<!DOCTYPE html><html><head><title>Help for package OneSampleMR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OneSampleMR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#OneSampleMR-package'><p>OneSampleMR: One Sample Mendelian Randomization and Instrumental Variable Analyses</p></a></li>
<li><a href='#asmm'><p>Additive structural mean model</p></a></li>
<li><a href='#fsw'><p>Conditional F-statistic of Sanderson and Windmeijer (2016)</p></a></li>
<li><a href='#msmm'><p>Multiplicative structural mean model</p></a></li>
<li><a href='#summary.msmm'><p>Summarizing MSMM Fits</p></a></li>
<li><a href='#summary.tsps'><p>Summarizing TSPS Fits</p></a></li>
<li><a href='#summary.tsri'><p>Summarizing TSRI Fits</p></a></li>
<li><a href='#tsps'><p>Two-stage predictor substitution (TSPS) estimators</p></a></li>
<li><a href='#tsri'><p>Two-stage residual inclusion (TSRI) estimators</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>One Sample Mendelian Randomization and Instrumental Variable
Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Useful functions for one-sample (individual level data)
    Mendelian randomization and instrumental variable analyses. The
    package includes implementations of; the Sanderson and Windmeijer
    (2016) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2015.06.004">doi:10.1016/j.jeconom.2015.06.004</a>&gt; conditional F-statistic,
    the multiplicative structural mean model Hernán and Robins (2006)
    &lt;<a href="https://doi.org/10.1097%2F01.ede.0000222409.00878.37">doi:10.1097/01.ede.0000222409.00878.37</a>&gt;, and two-stage predictor
    substitution and two-stage residual inclusion estimators explained by
    Terza et al. (2008) &lt;<a href="https://doi.org/10.1016%2Fj.jhealeco.2007.09.009">doi:10.1016/j.jhealeco.2007.09.009</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/remlapmot/OneSampleMR">https://github.com/remlapmot/OneSampleMR</a>,
<a href="https://remlapmot.github.io/OneSampleMR/">https://remlapmot.github.io/OneSampleMR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/remlapmot/OneSampleMR/issues/">https://github.com/remlapmot/OneSampleMR/issues/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Formula, gmm, ivreg, lmtest, msm, rlang (&ge; 1.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>haven, knitr, lfe, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-26 18:28:46 UTC; tom</td>
</tr>
<tr>
<td>Author:</td>
<td>Tom Palmer <a href="https://orcid.org/0000-0003-4655-4511"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Wes Spiller <a href="https://orcid.org/0000-0002-8169-5531"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Eleanor Sanderson <a href="https://orcid.org/0000-0001-5188-5775"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tom Palmer &lt;remlapmot@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-26 18:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='OneSampleMR-package'>OneSampleMR: One Sample Mendelian Randomization and Instrumental Variable Analyses</h2><span id='topic+OneSampleMR-package'></span><span id='topic+onesamplemr'></span><span id='topic+OneSampleMR'></span>

<h3>Description</h3>

<p>Useful functions for one-sample (individual level data) Mendelian randomization and instrumental variable analyses. The package includes implementations of; the Sanderson and Windmeijer (2016) <a href="https://doi.org/10.1016/j.jeconom.2015.06.004">doi:10.1016/j.jeconom.2015.06.004</a> conditional F-statistic, the multiplicative structural mean model Hernán and Robins (2006) <a href="https://doi.org/10.1097/01.ede.0000222409.00878.37">doi:10.1097/01.ede.0000222409.00878.37</a>, and two-stage predictor substitution and two-stage residual inclusion estimators explained by Terza et al. (2008) <a href="https://doi.org/10.1016/j.jhealeco.2007.09.009">doi:10.1016/j.jhealeco.2007.09.009</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Tom Palmer <a href="mailto:remlapmot@hotmail.com">remlapmot@hotmail.com</a> (<a href="https://orcid.org/0000-0003-4655-4511">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Wes Spiller <a href="mailto:wes.spiller@bristol.ac.uk">wes.spiller@bristol.ac.uk</a> (<a href="https://orcid.org/0000-0002-8169-5531">ORCID</a>)
</p>
</li>
<li><p> Eleanor Sanderson <a href="mailto:eleanor.sanderson@bristol.ac.uk">eleanor.sanderson@bristol.ac.uk</a> (<a href="https://orcid.org/0000-0001-5188-5775">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/remlapmot/OneSampleMR">https://github.com/remlapmot/OneSampleMR</a>
</p>
</li>
<li> <p><a href="https://remlapmot.github.io/OneSampleMR/">https://remlapmot.github.io/OneSampleMR/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/remlapmot/OneSampleMR/issues/">https://github.com/remlapmot/OneSampleMR/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='asmm'>Additive structural mean model</h2><span id='topic+asmm'></span>

<h3>Description</h3>

<p><code>asmm</code> is not a function. This helpfile is to note that the additive structural mean model (ASMM)
is simply fit with a linear IV estimator, such as available in <code><a href="ivreg.html#topic+ivreg">ivreg::ivreg()</a></code>.
</p>


<h3>Details</h3>

<p>For a binary outcome the ASMM estimates a causal risk difference.
</p>


<h3>References</h3>

<p>Clarke PS, Palmer TM, Windmeijer F. Estimating structural
mean models with multiple instrumental variables using the
Generalised Method of Moments. Statistical Science, 2015, 30, 1,
96-117. <a href="https://doi.org/10.1214/14-STS503">doi:10.1214/14-STS503</a>
</p>
<p>Palmer TM, Sterne JAC, Harbord RM, Lawlor DA, Sheehan NA, Meng S,
Granell R, Davey Smith G, Didelez V.
Instrumental variable estimation of causal risk ratios and causal odds ratios
in Mendelian randomization analyses.
American Journal of Epidemiology, 2011, 173, 12, 1392-1403.
<a href="https://doi.org/10.1093/aje/kwr026">doi:10.1093/aje/kwr026</a>
</p>
<p>Robins JM. The analysis of randomised and
nonrandomised AIDS treatment trials using a new approach to
causal inference in longitudinal studies.
In Health Service Research Methodology: A Focus on AIDS
(L. Sechrest, H. Freeman and A. Mulley, eds.). 1989. 113–159.
US Public Health Service, National Center for Health Services Research,
Washington, DC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single instrument example
# Data generation from the example in the ivtools ivglm() helpfile
set.seed(9)
n    &lt;- 1000
psi0 &lt;- 0.5
Z    &lt;- rbinom(n, 1, 0.5)
X    &lt;- rbinom(n, 1, 0.7*Z + 0.2*(1 - Z))
m0   &lt;- plogis(1 + 0.8*X - 0.39*Z)
Y    &lt;- rbinom(n, 1, plogis(psi0*X + log(m0/(1 - m0))))
dat1 &lt;- data.frame(Z, X, Y)
fit1 &lt;- ivreg::ivreg(Y ~ X | Z, data = dat1)
summary(fit1)

# Multiple instrument example
set.seed(123456)
n    &lt;- 1000
psi0 &lt;- 0.5
G1   &lt;- rbinom(n, 2, 0.5)
G2   &lt;- rbinom(n, 2, 0.3)
G3   &lt;- rbinom(n, 2, 0.4)
U    &lt;- runif(n)
pX   &lt;- plogis(0.7*G1 + G2 - G3 + U)
X    &lt;- rbinom(n, 1, pX)
pY   &lt;- plogis(-2 + psi0*X + U)
Y    &lt;- rbinom(n, 1, pY)
dat2 &lt;- data.frame(G1, G2, G3, X, Y)
fit2 &lt;- ivreg::ivreg(Y ~ X | G1 + G2 + G3, data = dat2)
summary(fit2)
</code></pre>

<hr>
<h2 id='fsw'>Conditional F-statistic of Sanderson and Windmeijer (2016)</h2><span id='topic+fsw'></span><span id='topic+fsw.ivreg'></span>

<h3>Description</h3>

<p><code>fsw</code> calculates the conditional F-statistic of
Sanderson and Windmeijer (2016) for each endogenous variable
in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fsw(object)

## S3 method for class 'ivreg'
fsw(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fsw_+3A_object">object</code></td>
<td>
<p>An object of class <code>"ivreg"</code> containing the results of
an IV model fitted by <code><a href="ivreg.html#topic+ivreg">ivreg::ivreg()</a></code> for which to calculate
the conditional F-statistics for each endogenous variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"fsw"</code> with the following elements:
</p>

<dl>
<dt>fswres</dt><dd><p>matrix with columns for the conditional <em>F</em>-statistics,
degrees of freedom, residual degrees of freedom, and p-value.
1 row per endogenous variable.</p>
</dd>
<dt>namesendog</dt><dd><p>a character vector of the variable names of the endogenous
variables.</p>
</dd>
<dt>nendog</dt><dd><p>the number of endogenous variables.</p>
</dd>
<dt>n</dt><dd><p>the sample size used for the fitted model.</p>
</dd>
</dl>



<h3>References</h3>

<p>Sanderson E and Windmeijer F. A weak instrument <em>F</em>-test in linear
IV models with multiple endogenous variables. Journal of Econometrics,
2016, 190, 2, 212-221, <a href="https://doi.org/10.1016/j.jeconom.2015.06.004">doi:10.1016/j.jeconom.2015.06.004</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(ivreg)
set.seed(12345)
n   &lt;- 4000
z1  &lt;- rnorm(n)
z2  &lt;- rnorm(n)
w1  &lt;- rnorm(n)
w2  &lt;- rnorm(n)
u   &lt;- rnorm(n)
x1  &lt;- z1 + z2 + 0.2*u + 0.1*w1 + rnorm(n)
x2  &lt;- z1 + 0.94*z2 - 0.3*u + 0.1*w2 + rnorm(n)
y   &lt;- x1 + x2 + w1 + w2 + u
dat &lt;- data.frame(w1, w2, x1, x2, y, z1, z2)
mod &lt;- ivreg::ivreg(y ~ x1 + x2 + w1 + w2 | z1 + z2 + w1 + w2, data = dat)
fsw(mod)

</code></pre>

<hr>
<h2 id='msmm'>Multiplicative structural mean model</h2><span id='topic+msmm'></span>

<h3>Description</h3>

<p>Function providing several methods to estimate the multiplicative
structural mean model (MSMM) of Robins (1989).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msmm(
  formula,
  instruments,
  data,
  subset,
  na.action,
  contrasts = NULL,
  estmethod = c("gmm", "gmmalt", "tsls", "tslsalt"),
  t0 = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msmm_+3A_formula">formula</code>, <code id="msmm_+3A_instruments">instruments</code></td>
<td>
<p>formula specification(s) of the regression
relationship and the instruments. Either <code>instruments</code> is missing and
<code>formula</code> has three parts as in <code>y ~ x1 + x2 | z1 + z2 + z3</code>
(recommended) or <code>formula</code> is <code>y ~ x1 + x2</code> and <code>instruments</code>
is a one-sided formula <code>~ z1 + z2 + z3</code> (only for backward
compatibility).</p>
</td></tr>
<tr><td><code id="msmm_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment of the
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="msmm_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in fitting the model.</p>
</td></tr>
<tr><td><code id="msmm_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> option.</p>
</td></tr>
<tr><td><code id="msmm_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of
<code><a href="stats.html#topic+model.matrix">stats::model.matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="msmm_+3A_estmethod">estmethod</code></td>
<td>
<p>Estimation method, please use one of
</p>

<ul>
<li> <p><code>"gmm"</code> GMM estimation of the MSMM (the default).
</p>
</li>
<li> <p><code>"gmmalt"</code> GMM estimation of the alternative moment conditions
for the MSMM as per Clarke et al. (2015). These are the same moment
conditions fit by the user-written Stata command <code>ivpois</code> (Nichols, 2007)
and by the official Stata command <code style="white-space: pre;">&#8288;ivpoisson gmm ..., multiplicative&#8288;</code>
(StataCorp., 2013).
</p>
</li>
<li> <p><code>"tsls"</code> the TSLS method of fitting the MSMM of Clarke et al. (2015).
For binary <code class="reqn">Y</code> and <code class="reqn">X</code> this uses <code class="reqn">Y*(1-X)</code> as the outcome and
<code class="reqn">Y*X</code> as the exposure.
</p>
</li>
<li> <p><code>"tslsalt"</code> the alternative TSLS method of fitting the MSMM of
Clarke et al. (2015). For binary <code class="reqn">Y</code> and <code class="reqn">X</code> this uses <code class="reqn">Y*X</code>
as the outcome and <code class="reqn">Y*(1-X)</code> as the exposure.
</p>
</li></ul>
</td></tr>
<tr><td><code id="msmm_+3A_t0">t0</code></td>
<td>
<p>A vector of starting values for the gmm optimizer. This should
have length equal to the number of exposures plus 1.</p>
</td></tr>
<tr><td><code id="msmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function providing several methods to estimate the multiplicative
structural mean model (MSMM) of Robins (1989). These are the methods
described in Clarke et al. (2015), most notably
generalised method of moments (GMM) estimation of the MSMM.
</p>
<p>An equivalent estimator to the MSMM was proposed in Econometrics by Mullahy (1997) and
then discussed in several articles by Windmeijer (1997, 2002) and Cameron
and Trivedi (2013). This was implemented in the user-written Stata command <code>ivpois</code>
(Nichols, 2007) and then implemented in official Stata in the <code>ivpoisson</code>
command (StataCorp., 2013).
</p>


<h3>Value</h3>

<p>An object of class <code>"msmm"</code>. A list with the following items:
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>The object from either a <code><a href="gmm.html#topic+gmm">gmm::gmm()</a></code> or <code><a href="ivreg.html#topic+ivreg">ivreg::ivreg()</a></code> fit.</p>
</td></tr>
<tr><td><code>crrci</code></td>
<td>
<p>The causal risk ratio/s and it corresponding 95% confidence
interval limits.</p>
</td></tr>
<tr><td><code>estmethod</code></td>
<td>
<p>The specified <code>estmethod</code>.</p>
</td></tr>
</table>
<p>If <code>estmethod</code> is <code>"tsls"</code>, <code>"gmm"</code>, or <code>"gmmalt"</code>:
</p>
<table>
<tr><td><code>ey0ci</code></td>
<td>
<p>The estimate of the treatment/exposure free potential outcome and
its 95% confidence interval limits.</p>
</td></tr>
</table>
<p>If <code>estmethod</code> is <code>"tsls"</code> or <code>"tslsalt"</code>:
</p>
<table>
<tr><td><code>stage1</code></td>
<td>
<p>An object containing the first stage regression from an
<code><a href="stats.html#topic+lm">stats::lm()</a></code> fit.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cameron AC, Trivedi PK. Regression analysis of count data. 2nd ed. 2013.
New York, Cambridge University Press. ISBN:1107667275
</p>
<p>Clarke PS, Palmer TM, Windmeijer F. Estimating structural
mean models with multiple instrumental variables using the
Generalised Method of Moments. Statistical Science, 2015, 30, 1,
96-117. <a href="https://doi.org/10.1214/14-STS503">doi:10.1214/14-STS503</a>
</p>
<p>Hernán and Robins. Instruments for causal inference: An
Epidemiologist's dream? Epidemiology, 2006, 17, 360-372.
<a href="https://doi.org/10.1097/01.ede.0000222409.00878.37">doi:10.1097/01.ede.0000222409.00878.37</a>
</p>
<p>Mullahy J. Instrumental-variable estimation of count data models:
applications to models of cigarette smoking and behavior. The Review of
Economics and Statistics. 1997, 79, 4, 586-593.
<a href="https://doi.org/10.1162/003465397557169">doi:10.1162/003465397557169</a>
</p>
<p>Nichols A. ivpois: Stata module for IV/GMM Poisson regression. 2007.
<a href="https://ideas.repec.org/c/boc/bocode/s456890.html">url</a>
</p>
<p>Palmer TM, Sterne JAC, Harbord RM, Lawlor DA, Sheehan NA, Meng S,
Granell R, Davey Smith G, Didelez V.
Instrumental variable estimation of causal risk ratios and causal odds ratios
in Mendelian randomization analyses.
American Journal of Epidemiology, 2011, 173, 12, 1392-1403.
<a href="https://doi.org/10.1093/aje/kwr026">doi:10.1093/aje/kwr026</a>
</p>
<p>Robins JM. The analysis of randomised and
nonrandomised AIDS treatment trials using a new approach to
causal inference in longitudinal studies.
In Health Service Research Methodology: A Focus on AIDS
(L. Sechrest, H. Freeman and A. Mulley, eds.). 1989. 113–159.
US Public Health Service, National Center for Health Services Research,
Washington, DC.
</p>
<p>StataCorp. Stata Base Reference Manual. Release 13.
ivpoisson - Poisson model with continuous endogenous covariates. 2013.
<a href="https://www.stata.com/manuals13/rivpoisson.pdf">url</a>
</p>
<p>Windmeijer FAG, Santos Silva JMC. Endogeneity in Count Data Models:
An Application to Demand for Health Care. Journal of Applied Econometrics.
1997, 12, 3, 281-294.
<a href="https://doi.org/10/fdkh4n">doi:10/fdkh4n</a>
</p>
<p>Windmeijer, F. ExpEnd, A Gauss programme for non-linear GMM estimation of
EXPonential models with ENDogenous regressors for cross section and panel
data. CEMMAP working paper CWP14/02. 2002.
<a href="https://www.cemmap.ac.uk/wp-content/uploads/2020/08/CWP1402.pdf">url</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single instrument example
# Data generation from the example in the ivtools ivglm() helpfile
set.seed(9)
n    &lt;- 1000
psi0 &lt;- 0.5
Z    &lt;- rbinom(n, 1, 0.5)
X    &lt;- rbinom(n, 1, 0.7*Z + 0.2*(1 - Z))
m0   &lt;- plogis(1 + 0.8*X - 0.39*Z)
Y    &lt;- rbinom(n, 1, plogis(psi0*X + log(m0/(1 - m0))))
dat  &lt;- data.frame(Z, X, Y)
fit  &lt;- msmm(Y ~ X | Z, data = dat)
summary(fit)

# Multiple instrument example
set.seed(123456)
n    &lt;- 1000
psi0 &lt;- 0.5
G1   &lt;- rbinom(n, 2, 0.5)
G2   &lt;- rbinom(n, 2, 0.3)
G3   &lt;- rbinom(n, 2, 0.4)
U    &lt;- runif(n)
pX   &lt;- plogis(0.7*G1 + G2 - G3 + U)
X    &lt;- rbinom(n, 1, pX)
pY   &lt;- plogis(-2 + psi0*X + U)
Y    &lt;- rbinom(n, 1, pY)
dat2 &lt;- data.frame(G1, G2, G3, X, Y)
fit2 &lt;- msmm(Y ~ X | G1 + G2 + G3, data = dat2)
summary(fit2)
</code></pre>

<hr>
<h2 id='summary.msmm'>Summarizing MSMM Fits</h2><span id='topic+summary.msmm'></span><span id='topic+print.msmm'></span><span id='topic+print.summary.msmm'></span>

<h3>Description</h3>

<p>Summarizing MSMM Fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'msmm'
summary(object, ...)

## S3 method for class 'msmm'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'summary.msmm'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.msmm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"msmm"</code>.</p>
</td></tr>
<tr><td><code id="summary.msmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.
</p>
<p>S3 summary and print methods for objects of class <code>msmm</code> and <code>summary.msmm</code>.</p>
</td></tr>
<tr><td><code id="summary.msmm_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.msmm"</code>.</p>
</td></tr>
<tr><td><code id="summary.msmm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.msmm()</code> returns an object of class <code>"summary.msmm"</code>. A list with the following elements:
</p>
<table>
<tr><td><code>smry</code></td>
<td>
<p>An object from a call to either <code><a href="gmm.html#topic+summary">gmm::summary.gmm()</a></code> or
<code><a href="ivreg.html#topic+ivregMethods">ivreg::summary.ivreg()</a></code>.</p>
</td></tr>
<tr><td><code>object</code></td>
<td>
<p>The object of class <code>msmm</code> passed to the function.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># For examples see the examples at the bottom of help('msmm')
</code></pre>

<hr>
<h2 id='summary.tsps'>Summarizing TSPS Fits</h2><span id='topic+summary.tsps'></span><span id='topic+print.tsps'></span><span id='topic+print.summary.tsps'></span>

<h3>Description</h3>

<p>S3 print and summary methods for objects of
class <code>"tsps"</code> and print method for objects of
class <code>"summary.tsps"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsps'
summary(object, ...)

## S3 method for class 'tsps'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'summary.tsps'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.tsps_+3A_object">object</code></td>
<td>
<p>an object of class <code>"tsps"</code>.</p>
</td></tr>
<tr><td><code id="summary.tsps_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.tsps_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.tsps"</code>.</p>
</td></tr>
<tr><td><code id="summary.tsps_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.tsps()</code> returns an object of class <code>"summary.tsps"</code>. A list with the following elements:
</p>
<table>
<tr><td><code>smry</code></td>
<td>
<p>An object from a call to <code><a href="gmm.html#topic+summary">gmm::summary.gmm()</a></code></p>
</td></tr>
<tr><td><code>object</code></td>
<td>
<p>The object of class <code>tsps</code> passed to the function.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># See the examples at the bottom of help('tsps')
</code></pre>

<hr>
<h2 id='summary.tsri'>Summarizing TSRI Fits</h2><span id='topic+summary.tsri'></span><span id='topic+print.tsri'></span><span id='topic+print.summary.tsri'></span>

<h3>Description</h3>

<p>S3 print and summary methods for objects of
class <code>"tsri"</code> and print method for objects of
class <code>"summary.tsri"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsri'
summary(object, ...)

## S3 method for class 'tsri'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'summary.tsri'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.tsri_+3A_object">object</code></td>
<td>
<p>an object of class <code>"tsri"</code>.</p>
</td></tr>
<tr><td><code id="summary.tsri_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.tsri_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.tsri"</code>.</p>
</td></tr>
<tr><td><code id="summary.tsri_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.tsri()</code> returns an object of class <code>"summary.tsri"</code>. A list with the following elements:
</p>
<table>
<tr><td><code>smry</code></td>
<td>
<p>An object from a call to <code><a href="gmm.html#topic+summary">gmm::summary.gmm()</a></code></p>
</td></tr>
<tr><td><code>object</code></td>
<td>
<p>The object of class <code>tsps</code> passed to the function.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># See the examples at the bottom of help('tsri')
</code></pre>

<hr>
<h2 id='tsps'>Two-stage predictor substitution (TSPS) estimators</h2><span id='topic+tsps'></span>

<h3>Description</h3>

<p>Terza et al. (2008) give an excellent description of TSPS estimators.
They proceed by fitting a first stage model of the
exposure regressed upon the instruments (and possibly any measured
confounders). From this the predicted values of the exposure are obtained.
A second stage model is then fitted of the outcome regressed upon
the predicted values of the exposure (and possibly measured confounders).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsps(
  formula,
  instruments,
  data,
  subset,
  na.action,
  contrasts = NULL,
  t0 = NULL,
  link = "identity",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsps_+3A_formula">formula</code>, <code id="tsps_+3A_instruments">instruments</code></td>
<td>
<p>formula specification(s) of the regression
relationship and the instruments. Either <code>instruments</code> is missing and
<code>formula</code> has three parts as in <code>y ~ x1 + x2 | z1 + z2 + z3</code>
(recommended) or <code>formula</code> is <code>y ~ x1 + x2</code> and <code>instruments</code>
is a one-sided formula <code>~ z1 + z2 + z3</code> (only for backward
compatibility).</p>
</td></tr>
<tr><td><code id="tsps_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment of the
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="tsps_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in fitting the model.</p>
</td></tr>
<tr><td><code id="tsps_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> option.</p>
</td></tr>
<tr><td><code id="tsps_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of
<code><a href="stats.html#topic+model.matrix">stats::model.matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="tsps_+3A_t0">t0</code></td>
<td>
<p>A vector of starting values for the gmm optimizer. This should
have length equal to the number of exposures plus 1.</p>
</td></tr>
<tr><td><code id="tsps_+3A_link">link</code></td>
<td>
<p>character; one of <code>"identity"</code> (the default), <code>"logadd"</code>, <code>"logmult"</code>, <code>"logit"</code>.
This is the link function for the second stage model. <code>"identity"</code> corresponds to linear
regression; <code>"logadd"</code> is log-additive and corresponds to Poisson / log-binomial regression;
<code>"logmult"</code> is log-multiplicative and corresponds to gamma regression;
<code>"logit"</code> corresponds to logistic regression.</p>
</td></tr>
<tr><td><code id="tsps_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>tsps()</code> performs GMM estimation to ensure appropriate standard errors
on its estimates similar to the approach described in Clarke et al. (2015).
</p>


<h3>Value</h3>

<p>An object of class <code>"tsps"</code> with the following elements
</p>

<dl>
<dt>fit</dt><dd><p>the fitted object of class <code>"gmm"</code> from the call to <code><a href="gmm.html#topic+gmm">gmm::gmm()</a></code>.</p>
</dd>
<dt>estci</dt><dd><p>a matrix of the estimates with their corresponding confidence interval limits.</p>
</dd>
<dt>link</dt><dd><p>a character vector containing the specificed link function.</p>
</dd>
</dl>



<h3>References</h3>

<p>Burgess S, CRP CHD Genetics Collaboration.
Identifying the odds ratio estimated by a
two-stage instrumental variable analysis
with a logistic regression model.
Statistics in Medicine, 2013, 32, 27, 4726-4747.
<a href="https://doi.org/10.1002/sim.5871">doi:10.1002/sim.5871</a>
</p>
<p>Clarke PS, Palmer TM, Windmeijer F. Estimating structural
mean models with multiple instrumental variables using the
Generalised Method of Moments. Statistical Science, 2015, 30, 1,
96-117. <a href="https://doi.org/10.1214/14-STS503">doi:10.1214/14-STS503</a>
</p>
<p>Dukes O, Vansteelandt S.
A note on G-estimation of causal risk ratios.
American Journal of Epidemiology, 2018, 187, 5, 1079-1084.
<a href="https://doi.org/10.1093/aje/kwx347">doi:10.1093/aje/kwx347</a>
</p>
<p>Palmer TM, Sterne JAC, Harbord RM, Lawlor DA, Sheehan NA, Meng S,
Granell R, Davey Smith G, Didelez V.
Instrumental variable estimation of causal risk ratios and causal odds ratios
in Mendelian randomization analyses.
American Journal of Epidemiology, 2011, 173, 12, 1392-1403.
<a href="https://doi.org/10.1093/aje/kwr026">doi:10.1093/aje/kwr026</a>
</p>
<p>Terza JV, Basu A, Rathouz PJ. Two-stage residual inclusion estimation:
Addressing endogeneity in health econometric modeling.
Journal of Health Economics, 2008, 27, 3, 531-543.
<a href="https://doi.org/10.1016/j.jhealeco.2007.09.009">doi:10.1016/j.jhealeco.2007.09.009</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Two-stage predictor substitution estimator
# with second stage logistic regression
set.seed(9)
n            &lt;- 1000
psi0         &lt;- 0.5
Z            &lt;- rbinom(n, 1, 0.5)
X            &lt;- rbinom(n, 1, 0.7*Z + 0.2*(1 - Z))
m0           &lt;- plogis(1 + 0.8*X - 0.39*Z)
Y            &lt;- rbinom(n, 1, plogis(psi0*X + log(m0/(1 - m0))))
dat          &lt;- data.frame(Z, X, Y)
tspslogitfit &lt;- tsps(Y ~ X | Z , data = dat, link = "logit")
summary(tspslogitfit)
</code></pre>

<hr>
<h2 id='tsri'>Two-stage residual inclusion (TSRI) estimators</h2><span id='topic+tsri'></span>

<h3>Description</h3>

<p>An excellent description of TSRI estimators is given by Terza et al.
(2008). TSRI estimators proceed by fitting a first stage model of the
exposure regressed upon the instruments (and possibly any measured
confounders). From this the first stage residuals are estimated.
A second stage model is then fitted of the outcome regressed upon
the exposure and first stage residuals (and possibly measured
confounders).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsri(
  formula,
  instruments,
  data,
  subset,
  na.action,
  contrasts = NULL,
  t0 = NULL,
  link = "identity",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsri_+3A_formula">formula</code>, <code id="tsri_+3A_instruments">instruments</code></td>
<td>
<p>formula specification(s) of the regression
relationship and the instruments. Either <code>instruments</code> is missing and
<code>formula</code> has three parts as in <code>y ~ x1 + x2 | z1 + z2 + z3</code>
(recommended) or <code>formula</code> is <code>y ~ x1 + x2</code> and <code>instruments</code>
is a one-sided formula <code>~ z1 + z2 + z3</code> (only for backward
compatibility).</p>
</td></tr>
<tr><td><code id="tsri_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment of the
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="tsri_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in fitting the model.</p>
</td></tr>
<tr><td><code id="tsri_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> option.</p>
</td></tr>
<tr><td><code id="tsri_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of
<code><a href="stats.html#topic+model.matrix">stats::model.matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="tsri_+3A_t0">t0</code></td>
<td>
<p>A vector of starting values for the gmm optimizer. This should
have length equal to the number of exposures plus 1.</p>
</td></tr>
<tr><td><code id="tsri_+3A_link">link</code></td>
<td>
<p>character; one of <code>"identity"</code> (the default), <code>"logadd"</code>, <code>"logmult"</code>, <code>"logit"</code>.
This is the link function for the second stage model. <code>"identity"</code> corresponds to linear
regression; <code>"logadd"</code> is log-additive and corresponds to Poisson / log-binomial regression;
<code>"logmult"</code> is log-multiplicative and corresponds to gamma regression;
<code>"logit"</code> corresponds to logistic regression.</p>
</td></tr>
<tr><td><code id="tsri_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TSRI estimators are sometimes described as a special case of
control function estimators.
</p>
<p><code>tsri()</code> performs GMM estimation to ensure appropriate standard errors
on its estimates similar to that described that described by
Clarke et al. (2015). Terza (2017) described an alternative approach.
</p>


<h3>Value</h3>

<p>An object of class <code>"tsri"</code> with the following elements
</p>

<dl>
<dt>fit</dt><dd><p>the fitted object of class <code>"gmm"</code> from the call to <code><a href="gmm.html#topic+gmm">gmm::gmm()</a></code>.</p>
</dd>
<dt>estci</dt><dd><p>a matrix of the estimates with their corresponding confidence interval limits.</p>
</dd>
<dt>link</dt><dd><p>a character vector containing the specificed link function.</p>
</dd>
</dl>



<h3>References</h3>

<p>Bowden J, Vansteelandt S.
Mendelian randomization analysis of case-control data using
structural mean models.
Statistics in Medicine, 2011, 30, 6, 678-694.
<a href="https://doi.org/10.1002/sim.4138">doi:10.1002/sim.4138</a>
</p>
<p>Clarke PS, Palmer TM, Windmeijer F. Estimating structural
mean models with multiple instrumental variables using the
Generalised Method of Moments. Statistical Science, 2015, 30, 1,
96-117. <a href="https://doi.org/10.1214/14-STS503">doi:10.1214/14-STS503</a>
</p>
<p>Dukes O, Vansteelandt S.
A note on G-estimation of causal risk ratios.
American Journal of Epidemiology, 2018, 187, 5, 1079-1084.
<a href="https://doi.org/10.1093/aje/kwx347">doi:10.1093/aje/kwx347</a>
</p>
<p>Palmer T, Thompson JR, Tobin MD, Sheehan NA, Burton PR.
Adjusting for bias and unmeasured confounding in Mendelian randomization
studies with binary responses.
International Journal of Epidemiology, 2008, 37, 5, 1161-1168.
<a href="https://doi.org/10.1093/ije/dyn080">doi:10.1093/ije/dyn080</a>
</p>
<p>Palmer TM, Sterne JAC, Harbord RM, Lawlor DA, Sheehan NA, Meng S,
Granell R, Davey Smith G, Didelez V.
Instrumental variable estimation of causal risk ratios and causal odds ratios
in Mendelian randomization analyses.
American Journal of Epidemiology, 2011, 173, 12, 1392-1403.
<a href="https://doi.org/10.1093/aje/kwr026">doi:10.1093/aje/kwr026</a>
</p>
<p>Terza JV, Basu A, Rathouz PJ. Two-stage residual inclusion estimation:
Addressing endogeneity in health econometric modeling.
Journal of Health Economics, 2008, 27, 3, 531-543.
<a href="https://doi.org/10.1016/j.jhealeco.2007.09.009">doi:10.1016/j.jhealeco.2007.09.009</a>
</p>
<p>Terza JV.
Two-stage residual inclusion estimation: A
practitioners guide to Stata implementation.
The Stata Journal, 2017, 17, 4, 916-938.
<a href="https://doi.org/10.1177/1536867X1801700409">doi:10.1177/1536867X1801700409</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Two-stage residual inclusion estimator
# with second stage logistic regression
set.seed(9)
n            &lt;- 1000
psi0         &lt;- 0.5
Z            &lt;- rbinom(n, 1, 0.5)
X            &lt;- rbinom(n, 1, 0.7*Z + 0.2*(1 - Z))
m0           &lt;- plogis(1 + 0.8*X - 0.39*Z)
Y            &lt;- rbinom(n, 1, plogis(psi0*X + log(m0/(1 - m0))))
dat          &lt;- data.frame(Z, X, Y)
tsrilogitfit &lt;- tsri(Y ~ X | Z , data = dat, link = "logit")
summary(tsrilogitfit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
