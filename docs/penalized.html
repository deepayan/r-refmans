<!DOCTYPE html><html><head><title>Help for package penalized</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {penalized}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#breslow object'><p>Breslow estimator object</p></a></li>
<li><a href='#Cross-validation in penalized generalized linear models'><p>Cross-validated penalized regression</p></a></li>
<li><a href='#Netherlands Cancer Institute 70 gene signature'><p>The 70 gene signature of the Netherlands Cancer Institute for prediction of metastasis-free survival, measured on 144 independent lymph node positive patients.</p></a></li>
<li><a href='#Penalized generalized linear models'><p>Penalized regression</p></a></li>
<li><a href='#Penalized regression contrasts'><p>Contrast functions for penalized regression</p></a></li>
<li><a href='#penfit object'><p>Penalized regression object</p></a></li>
<li><a href='#Plotting the LASSO path'><p>Plotting the LASSO path</p></a></li>
<li><a href='#Prediction from penalized models'><p>Prediction based on penfit objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.9-52</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-23</td>
</tr>
<tr>
<td>Title:</td>
<td>L1 (Lasso and Fused Lasso) and L2 (Ridge) Penalized Estimation
in GLMs and in the Cox Model</td>
</tr>
<tr>
<td>Author:</td>
<td>Jelle Goeman, Rosa Meijer, Nimisha Chaturvedi, Matthew Lueder</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jelle Goeman &lt;j.j.goeman@lumc.nl&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0), survival, methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>globaltest</td>
</tr>
<tr>
<td>Description:</td>
<td>Fitting possibly high dimensional penalized
        regression models. The penalty structure can be any combination
        of an L1 penalty (lasso and fused lasso), an L2 penalty (ridge) and a
        positivity constraint on the regression coefficients. The
        supported regression models are linear, logistic and Poisson
        regression and the Cox Proportional Hazards model.
        Cross-validation routines allow optimization of the tuning
        parameters.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Collate:</td>
<td>onattach.R penfit.R breslow.R penalized.R core.R checkinput.R
cvl.R contrasts.R Brent.R plotpath.R cox.R logit.R linear.R
poisson.R</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-23 14:10:02 UTC</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-23 13:13:33 UTC; jelle</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
</table>
<hr>
<h2 id='breslow+20object'>Breslow estimator object</h2><span id='topic+breslow-class'></span><span id='topic+breslow'></span><span id='topic+show+2Cbreslow-method'></span><span id='topic+plot+2Cbreslow-method'></span><span id='topic++5B+2Cbreslow-method'></span><span id='topic++5B+5B+2Cbreslow-method'></span><span id='topic+as.list+2Cbreslow-method'></span><span id='topic+as.matrix+2Cbreslow-method'></span><span id='topic+as.data.frame+2Cbreslow-method'></span><span id='topic+time+2Cbreslow-method'></span><span id='topic+survival'></span><span id='topic+survival+2Cbreslow-method'></span><span id='topic++5B+2Cbreslow+2CANY+2CANY+2CANY-method'></span>

<h3>Description</h3>

<p>Stores one or more survival stepfunctions of the Kaplan-Meier and Breslow type.</p>


<h3>Details</h3>

<p>Breslow objects are generally created by the <code><a href="#topic+penalized">penalized</a></code> function and related functions.</p>


<h3>Slots</h3>


<dl>
<dt><code>time</code>:</dt><dd><p>Object of class &quot;vector&quot;. The time points at which the function starts, jumps or ends.</p>
</dd>
<dt><code>curves</code>:</dt><dd><p>Object of class &quot;matrix&quot;. The values of the curve at each time point.
Note that the function is left-continuous. Curves are stored as a matrix of dimension (\# curves) x (\# timepoints).</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>&quot;[&quot;</dt><dd><p>(breslow): Coerces the object to a matrix (as as.matrix) and selects rows and/or columns.</p>
</dd>
<dt>&quot;[[&quot;</dt><dd><p>(breslow): Selects a subset of the curves.</p>
</dd>
<dt>as.data.frame</dt><dd><p>(breslow): Returns the &quot;curves&quot; slot together with the &quot;time&quot; slot in a <code>data.frame</code>.</p>
</dd>
<dt>as.list</dt><dd><p>(breslow): Coerces the object to a list.</p>
</dd>
<dt>as.matrix</dt><dd><p>(breslow): Returns the &quot;curves&quot; slot with the &quot;time&quot; slot as column names.</p>
</dd>
<dt>plot</dt><dd><p>(breslow): Straightforward plotting (all curves in one plot).</p>
</dd>
<dt>show</dt><dd><p>(breslow): Summarizes the dimensions of the object.</p>
</dd>
<dt>survival</dt><dd><p>(breslow): Takes a second argument (<code>time</code>). Extracts the value of the survival curve(s) at any time point.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jelle Goeman: <a href="mailto:j.j.goeman@lumc.nl">j.j.goeman@lumc.nl</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+penalized">penalized</a></code>.</p>

<hr>
<h2 id='Cross-validation+20in+20penalized+20generalized+20linear+20models'>Cross-validated penalized regression</h2><span id='topic+cvl'></span><span id='topic+profL1'></span><span id='topic+profL2'></span><span id='topic+optL1'></span><span id='topic+optL2'></span>

<h3>Description</h3>

<p>Cross-validating generalized linear models with L1 (lasso or fused lasso) and/or L2 (ridge)  penalties, using likelihood cross-validation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
cvl (response, penalized, unpenalized, lambda1 = 0, lambda2= 0, positive = FALSE, 
    fusedl = FALSE, data, model = c("cox", "logistic", "linear", "poisson"), 
    startbeta, startgamma, fold, epsilon = 1e-10, maxiter, standardize = FALSE, 
    trace = TRUE, approximate = FALSE)

optL1 (response, penalized, unpenalized, minlambda1, maxlambda1, base1, lambda2 = 0, 
  fusedl = FALSE, positive = FALSE, data, 
  model = c("cox", "logistic", "linear", "poisson"), startbeta, startgamma, fold, 
  epsilon = 1e-10, maxiter = Inf, standardize = FALSE, tol = .Machine$double.eps^0.25, 
  trace = TRUE)

optL2 (response, penalized, unpenalized, lambda1 = 0, minlambda2, maxlambda2, base2, 
fusedl = FALSE ,positive = FALSE, data, 
  model = c("cox", "logistic", "linear", "poisson"), startbeta, startgamma, 
  fold, epsilon = 1e-10, maxiter, standardize = FALSE, tol = .Machine$double.eps^0.25, 
  trace = TRUE, approximate = FALSE)
    
profL1 (response, penalized, unpenalized, minlambda1, maxlambda1, base1, lambda2 = 0,
  fusedl = FALSE,positive = FALSE, data, 
  model = c("cox", "logistic", "linear", "poisson"), startbeta, startgamma, fold, 
  epsilon = 1e-10, maxiter = Inf, standardize = FALSE, steps = 100, minsteps = steps/3, 
  log = FALSE, save.predictions = FALSE, trace = TRUE, plot = FALSE)

profL2 (response, penalized, unpenalized, lambda1 = 0, minlambda2, maxlambda2, base2, 
  fusedl = FALSE,positive = FALSE, data, 
  model = c("cox", "logistic", "linear", "poisson"), startbeta, startgamma, fold, 
  epsilon = 1e-10, maxiter, standardize = FALSE, steps = 100, minsteps = steps/2, 
  log = TRUE, save.predictions = FALSE, trace = TRUE, plot = FALSE, approximate = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_response">response</code></td>
<td>
<p>The response variable (vector). This should be a numeric vector for linear regression, a <code><a href="survival.html#topic+Surv">Surv</a></code> object for Cox regression and <code>factor</code> or a vector of 0/1 values for logistic regression.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_penalized">penalized</code></td>
<td>
<p>The penalized covariates. These may be specified either as a matrix or as a (one-sided) <code><a href="stats.html#topic+formula">formula</a></code> object. See also under <code>data</code>.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_unpenalized">unpenalized</code></td>
<td>
<p>Additional unpenalized covariates. Specified as under <code>penalized</code>. Note that an unpenalized intercept is included in the model by default (except in the cox model). This can be suppressed by specifying <code>unpenalized = ~0</code>.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_lambda1">lambda1</code>, <code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_lambda2">lambda2</code></td>
<td>
<p>The fixed values of the tuning parameters for L1 and L2 penalization. Each must be either a single positive numbers or a vector with length equal to the number of covariates in <code>penalized</code> argument. In the latter case, each covariate is given its own penalty weight.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_minlambda1">minlambda1</code>, <code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_minlambda2">minlambda2</code>, <code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_maxlambda1">maxlambda1</code>, <code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_maxlambda2">maxlambda2</code></td>
<td>
<p>The values of the tuning parameters for L1 or L2 penalization between which the cross-validated likelihood is to be profiled or optimized. For fused lasso penalty <code>minlambda2</code> and <code>maxlambda2</code> are the tuning parameters for L1 penalty on the differences of the coefficients between which the cross-validated likelihood is to be optimized. </p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_base1">base1</code>, <code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_base2">base2</code></td>
<td>
<p>An optional vector of length equal to the number of covariates in penalized. If supplied, profiling or optimization is performed between <code>base1*minlambda1</code> and <code>base1*maxlambda1</code>; analogous for <code>base2</code>.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_fusedl">fusedl</code></td>
<td>
<p>If <code>TRUE</code> or a vector, the penalization method used is fused lasso. The value for <code>lambda1</code> is used as the tuning parameter for L1 penalization on the coefficients and the value for <code>lambda2</code> is used as the tuning parameter for L1 penalization on the differences of the coefficients. Default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_positive">positive</code></td>
<td>
<p>If <code>TRUE</code>, constrains the estimated regression coefficients of all penalized covariates to be non-negative. If a logical vector with the length of the number of covariates in <code>penalized</code>, constrains the estimated regression coefficients of a subset of the penalized covariates to be non-negative.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> used to evaluate <code>response</code>, and the terms of <code>penalized</code> or <code>unpenalized</code> when these have been specified as a  <code><a href="stats.html#topic+formula">formula</a></code> object.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_model">model</code></td>
<td>
<p>The model to be used. If missing, the model will be guessed from the <code>response</code> input.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_startbeta">startbeta</code></td>
<td>
<p>Starting values for the regression coefficients of the penalized covariates. These starting values will be used only for the first values of <code>lambda1</code> and <code>lambda2</code>.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_startgamma">startgamma</code></td>
<td>
<p>Starting values for the regression coefficients of the unpenalized covariates. These starting values will be used only for the first values of <code>lambda1</code> and <code>lambda2</code>.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_fold">fold</code></td>
<td>
<p>The fold for cross-validation. May be supplied as a single number (between 2 and n) giving the number of folds, or, alternatively, as a length <code>n</code> vector with values in <code>1:fold</code>, specifying exactly which subjects are assigned to which fold. The default is <code>fold = 1:n</code>, resulting in leave-one-out (n-fold) cross-validation.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_epsilon">epsilon</code></td>
<td>
<p>The convergence criterion. As in <code><a href="stats.html#topic+glm.control">glm</a></code>. Convergence is judged separately on the likelihood and on the penalty.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations allowed in each fitting of the model. Set by default at 25 when only an L2 penalty is present, infinite otherwise.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_standardize">standardize</code></td>
<td>
<p>If <code>TRUE</code>, standardizes all penalized covariates to unit central L2-norm before applying penalization.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_steps">steps</code></td>
<td>
<p>The maximum number of steps between <code>minlambda1</code> and <code>maxlambda1</code> or <code>minlambda2</code> and <code>maxlambda2</code> at which the cross-validated likelihood is to be calculated.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_minsteps">minsteps</code></td>
<td>
<p>The minimum number of steps between <code>minlambda1</code> and <code>maxlambda1</code> or <code>minlambda2</code> and <code>maxlambda2</code> at which the cross-validated likelihood is to be calculated. If <code>minsteps</code> is smaller than <code>steps</code>, the algorithm will automatically stop when the cross-validated likelihood drops below the cross-validated likelihood of the null model, provided it has done at least <code>minsteps</code> steps.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_log">log</code></td>
<td>
<p>If <code>FALSE</code>, the steps between <code>minlambda1</code> and <code>maxlambda1</code> or <code>minlambda2</code> and <code>maxlambda2</code> are equidistant on a linear scale, if <code>TRUE</code> on a logarithmic scale. Please note the different default between <code>optL1</code> (<code>FALSE</code>) and <code>optL2</code> (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_tol">tol</code></td>
<td>
<p>The tolerance of the Brent algorithm used for minimization. See also <code><a href="stats.html#topic+optimize">optimize</a></code>.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_save.predictions">save.predictions</code></td>
<td>
<p>Controls whether or not to save cross-validated predictions for all values of lambda.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_trace">trace</code></td>
<td>
<p>If <code>TRUE</code>, prints progress information. Note that setting <code>trace=TRUE</code> may slow down the algorithm (but it often feels quicker)</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_approximate">approximate</code></td>
<td>
<p>If <code>TRUE</code>, the cross-validated likelihood values are approximated rather than fully calculated. Note that this option is only available for ridge models.</p>
</td></tr>
<tr><td><code id="Cross-validation+2B20in+2B20penalized+2B20generalized+2B20linear+2B20models_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, makes a plot of cross-validated likelihood versus lambda.</p>
</td></tr>    </table>


<h3>Details</h3>

<p>All five functions return a list with the following named elements:
</p>

<dl>
<dt><code>lambda</code>:</dt><dd><p>For <code>optL1</code> and <code>optL2</code> <code>lambda</code> gives the optimal value of the tuning parameters found. For <code>profL1</code> and <code>profL2</code> <code>lambda</code> is the vector of values of the tuning parameter for which the cross-validated likelihood has been calculated. Absent in the output of <code>cvl</code>.</p>
</dd>
<dt><code>cvl</code>:</dt><dd><p>The value(s) of the cross-validated likelihood. For <code>optL1</code>, <code>optL2</code> this is the cross-validated likelihood at the optimal value of the tuning parameter.</p>
</dd>
<dt><code>fold</code>:</dt><dd><p>Returns the precise allocation of the subjects into the cross-validation folds. Note that the same allocation is used for all cross-validated likelihood calculations in each call to <code>optL1</code>, <code>optL2</code>, <code>profL1</code>, <code>profL2</code>.</p>
</dd>
<dt><code>predictions</code>:</dt><dd><p>The cross-validated predictions for the left-out samples. The precise format of the cross-validated predictions depends on the type of generalized linear model (see <code><a href="#topic+breslow">breslow</a></code> for survival models. The functions <code>profL1</code> and <code>profL2</code> return a list here (only if <code>save.predictions = TRUE</code>), whereas <code>optL1</code>, <code>optL2</code> return the predictions for the optimal value of the tuning parameter only.</p>
</dd>
<dt><code>fullfit</code>:</dt><dd><p>The fitted model on the full data. The functions <code>profL1</code> and <code>profL2</code> return a list of <code><a href="#topic+penfit">penfit</a></code> objects here, whereas <code>optL1</code>, <code>optL2</code> return the full data fit (a single <code><a href="#topic+penfit">penfit</a></code> object) for the optimal value of the tuning parameter only.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A named list. See details.</p>


<h3>Note</h3>

<p>The <code>optL1</code> and <code>optL2</code> functions use Brent's algorithm for minimization without derivatives (see also <code><a href="stats.html#topic+optimize">optimize</a></code>). There is a risk that these functions converge to a local instead of to a global optimum. This is especially the case for <code>optL1</code>, as the cross-validated likelihood as a function of <code>lambda1</code> quite often has local optima. It is   recommended to use <code>optL1</code> in combination with <code>profL1</code> to check whether <code>optL1</code> has converged to the right optimum.
</p>
<p>See also the notes under <code><a href="#topic+penalized">penalized</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jelle Goeman: <a href="mailto:j.j.goeman@lumc.nl">j.j.goeman@lumc.nl</a></p>


<h3>References</h3>

<p>Goeman J.J. (2010). L-1 Penalized Estimation in the Cox Proportional Hazards Model. Biometrical Journal 52 (1) 70-84.</p>


<h3>See Also</h3>

<p><code><a href="#topic+penalized">penalized</a></code>, <code><a href="#topic+penfit">penfit</a></code>, <code><a href="#topic+plotpath">plotpath</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># More examples in the package vignette:
#  type vignette("penalized")

data(nki70)
attach(nki70)

# Finding an optimal cross-validated likelihood
opt &lt;- optL1(Surv(time, event), penalized = nki70[,8:77], fold = 5)
coefficients(opt$fullfit)
plot(opt$predictions)

# Plotting the profile of the cross-validated likelihood
prof &lt;- profL1(Surv(time, event), penalized = nki70[,8:77],
    fold = opt$fold, steps=10)
plot(prof$lambda, prof$cvl, type="l")
plotpath(prof$fullfit)
</code></pre>

<hr>
<h2 id='Netherlands+20Cancer+20Institute+2070+20gene+20signature'>The 70 gene signature of the Netherlands Cancer Institute for prediction of metastasis-free survival, measured on 144 independent lymph node positive patients.</h2><span id='topic+nki70'></span>

<h3>Description</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>
of 144 lymph node positive breast cancer patients on metastasis-free survival, 5 clinical risk factors, and gene expression measurements of 70 genes found to be prognostic for metastasis-free survival in an earlier study. The included variables are
</p>

<dl>
<dt>time</dt><dd><p>Metastasis-free follow-up time (months).</p>
</dd>
<dt>event</dt><dd><p>Event indicator. 1 = metastasis or death; 0 = censored.</p>
</dd>
<dt>Diam</dt><dd><p>Diameter of the tumor (two levels).</p>
</dd>
<dt>N</dt><dd><p>Number of affected lymph nodes (two levels).</p>
</dd>
<dt>ER</dt><dd><p>Estrogen receptor status (two levels).</p>
</dd>
<dt>Grade</dt><dd><p>Grade of the tumor (three ordered levels).</p>
</dd>
<dt>Age</dt><dd><p>Patient age at diagnosis (years).</p>
</dd>
<dt>TSPYL5...C20orf46</dt><dd><p>Gene expression measurements of 70 prognostic genes.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>data(nki70)</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>


<h3>Note</h3>

<p>The 70 gene signature was trained on lymph node negative patients only.</p>


<h3>References</h3>

<p>M.J. van de Vijver, Y.D. He, L.J. van 't Veer, H. Dai, A.A.M. Hart, D.W. Voskuil, G.J. Schreiber, J.L. Peterse, C. Roberts, M.J. Marton, M. Parrish, D. Atsma, A. Witteveen, A. Glas, L. Delahaye, T. van der Velde, H. Bartelink, S. Rodenhuis, E.T. Rutgers, S.H. Friend, and R. Bernards (2002). A gene-expression signature as a predictor of survival in breast cancer. New England Journal of Medicine 347 (25), 1999&ndash;2009.</p>

<hr>
<h2 id='Penalized+20generalized+20linear+20models'>Penalized regression</h2><span id='topic+penalized'></span>

<h3>Description</h3>

<p>Fitting generalized linear models with L1 (lasso and fused lasso)
and/or L2 (ridge) penalties, or a combination of the two.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
penalized (response, penalized, unpenalized, lambda1=0, 
  lambda2=0, positive = FALSE, data, fusedl=FALSE,
  model = c("cox", "logistic", "linear", "poisson"), 
  startbeta, startgamma, steps =1, epsilon = 1e-10, 
  maxiter, standardize = FALSE, trace = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_response">response</code></td>
<td>
<p>The response variable (vector). This should be a numeric vector for linear regression, a <code><a href="survival.html#topic+Surv">Surv</a></code> object for Cox regression and <code>factor</code> or a vector of 0/1 values for logistic regression.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_penalized">penalized</code></td>
<td>
<p>The penalized covariates. These may be specified either as a matrix or as a (one-sided) <code><a href="stats.html#topic+formula">formula</a></code> object. See also under <code>data</code>.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_unpenalized">unpenalized</code></td>
<td>
<p>Additional unpenalized covariates. Specified as under <code>penalized</code>. Note that an unpenalized intercept is included in the model by default (except in the Cox model). This can be suppressed by specifying <code>unpenalized = ~0</code>.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_lambda1">lambda1</code>, <code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_lambda2">lambda2</code></td>
<td>
<p>The tuning parameters for L1 and L2 penalization. Each must be either a single positive numbers or a vector with length equal to the number of covariates in <code>penalized</code> argument. In the latter case, each covariate is given its own penalty weight.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_positive">positive</code></td>
<td>
<p>If <code>TRUE</code>, constrains the estimated regression coefficients of all penalized covariates to be non-negative. If a logical vector with the length of the number of covariates in <code>penalized</code>, constrains the estimated regression coefficients of a subset of the penalized covariates to be non-negative.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> used to evaluate <code>response</code>, and the terms of  <code>penalized</code> or <code>unpenalized</code> when these have been specified as a  <code><a href="stats.html#topic+formula">formula</a></code> object.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_fusedl">fusedl</code></td>
<td>
<p>If <code>TRUE</code> or a vector, the penalization method used is fused lasso. The value for <code>lambda1</code> is used as the tuning parameter for L1 penalization on the coefficients and the value for <code>lambda2</code> is used as the tuning parameter for L1 penalization on the differences of the coefficients. Default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_model">model</code></td>
<td>
<p>The model to be used. If missing, the model will be guessed from the <code>response</code> input.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_startbeta">startbeta</code></td>
<td>
<p>Starting values for the regression coefficients of the penalized covariates.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_startgamma">startgamma</code></td>
<td>
<p>Starting values for the regression coefficients of the unpenalized covariates.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_steps">steps</code></td>
<td>
<p>If greater than 1, the algorithm will fit the model for a range of <code>steps</code> <code>lambda1</code>-values, starting from the maximal value down to the value of <code>lambda1</code> specified. This is useful for making plots as in <code><a href="#topic+plotpath">plotpath</a></code>. With <code>steps = "Park"</code> it is possible to choose the steps in such a way that they are at the approximate value at which the active set changes, following Park and Haste (2007).</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_epsilon">epsilon</code></td>
<td>
<p>The convergence criterion. As in <code><a href="stats.html#topic+glm.control">glm</a></code>. Convergence is judged separately on the likelihood and on the penalty.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations allowed. Set by default at 25 when only an L2 penalty is present, infinite otherwise.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_standardize">standardize</code></td>
<td>
<p>If <code>TRUE</code>, standardizes all penalized covariates to unit central L2-norm before applying penalization.</p>
</td></tr>
<tr><td><code id="Penalized+2B20generalized+2B20linear+2B20models_+3A_trace">trace</code></td>
<td>
<p>If <code>TRUE</code>, prints progress information. Note that setting <code>trace=TRUE</code> may slow down the algorithm up to 30 percent (but it often feels quicker)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>penalized</code> function fits  regression models for a given combination of L1 and L2 penalty parameters.</p>


<h3>Value</h3>

<p><code>penalized</code> returns a <code><a href="#topic+penfit">penfit</a></code> object when <code>steps = 1</code> or a list of such objects if <code>steps &gt; 1</code>.</p>


<h3>Note</h3>

<p>The <code>response</code> argument of the function also accepts formula input as in  <code><a href="stats.html#topic+lm">lm</a></code> and related functions. In that case, the right hand side of the <code>response</code> formula is used as the <code>penalized</code> argument or, if that is already given, as the <code>unpenalized</code> argument. For example, the input <code>penalized(y~x)</code> is equivalent to <code>penalized(y, ~x)</code> and <code>penalized(y~x, ~z)</code> to <code>penalized(y, ~z, ~x)</code>.
</p>
<p>In case of tied survival times, the function uses Breslow's version of the partial likelihood.</p>


<h3>Author(s)</h3>

<p>Jelle Goeman: <a href="mailto:j.j.goeman@lumc.nl">j.j.goeman@lumc.nl</a></p>


<h3>References</h3>

<p>Goeman J.J. (2010). L-1 Penalized Estimation in the Cox Proportional Hazards Model. Biometrical Journal 52 (1) 70-84.</p>


<h3>See Also</h3>

<p><code><a href="#topic+penfit">penfit</a></code> for the <code>penfit</code> object returned, <code><a href="#topic+plotpath">plotpath</a></code>
for plotting the solution path, and <code><a href="#topic+cvl">cvl</a></code> for cross-validation and
optimizing the tuning parameters.</p>


<h3>Examples</h3>

<pre><code class='language-R'># More examples in the package vignette:
#  type vignette("penalized")

data(nki70)

# A single lasso fit predicting survival
pen &lt;- penalized(Surv(time, event), penalized = nki70[,8:77],
    unpenalized = ~ER+Age+Diam+N+Grade, data = nki70, lambda1 = 10)
show(pen)
coefficients(pen)
coefficients(pen, "penalized")
basehaz(pen)

# A single lasso fit using the clinical risk factors
pen &lt;- penalized(Surv(time, event), penalized = ~ER+Age+Diam+N+Grade,
    data = nki70, lambda1=10, standardize=TRUE)

# using steps
pen &lt;- penalized(Surv(time, event), penalized = nki70[,8:77],
    data = nki70, lambda1 = 1,steps = 20)
plotpath(pen)


# A fused lasso fit predicting survival
pen &lt;- penalized(Surv(time, event), penalized = nki70[,8:77], data = nki70, 
     lambda1 = 1, lambda2 = 2, fusedl = TRUE)
plot(coefficients(pen, "all"),type="l",xlab = "probes",ylab = "coefficient value")
plot(predict(pen,penalized=nki70[,8:77]))
 </code></pre>

<hr>
<h2 id='Penalized+20regression+20contrasts'>Contrast functions for penalized regression</h2><span id='topic+contr.none'></span><span id='topic+contr.diff'></span>

<h3>Description</h3>

<p>Contrast functions for factors that are appropriate for penalized regression.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
contr.none(n, contrasts)

contr.diff(n, contrasts = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Penalized+2B20regression+2B20contrasts_+3A_n">n</code></td>
<td>
<p>A vector of levels for a factor, or the number of levels.</p>
</td></tr>
<tr><td><code id="Penalized+2B20regression+2B20contrasts_+3A_contrasts">contrasts</code></td>
<td>
<p>A logical indicating whether contrasts should be computed. This
argument is ignored in <code>contr.none</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are used for creating contrast matrices for use in fitting penalized
analysis of variance and regression models. The columns of the resulting matrices
contain contrasts which can be used for coding a factor with n levels. The returned
value contains the computed contrasts.
</p>
<p><code>contr.none</code> returns an identity matrix except when the number of levels is 2,
in which case it returns a single contrast. <code>contr.none</code> ensures that all levels
of an unordered factor are treated symmetrically in a penalized regression model.
</p>
<p><code>contr.diff</code> returns a lower triangular matrix of ones if <code>contrasts=FALSE</code>
and the same matrix without its first column if <code>contrasts=TRUE</code>. This makes sure
that penalization is done on the difference between successive levels of an ordered factor.
It is not appropriate for unordered factors.
</p>


<h3>Value</h3>

<p><code>contr.diff</code> returns a matrix with <code>n</code> rows and <code>k</code> columns, with
<code>k=n-1</code> if contrasts is <code>TRUE</code> and <code>k=n</code> if contrasts is <code>FALSE</code>.
</p>
<p><code>contr.none</code> returns a matrix with <code>n</code> rows and <code>n</code> columns, except when <code>n=2</code>
when it returns a matrix with 2 rows and one column.</p>


<h3>Author(s)</h3>

<p>Jelle Goeman: <a href="mailto:j.j.goeman@lumc.nl">j.j.goeman@lumc.nl</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+penalized">penalized</a></code>, <code><a href="stats.html#topic+contr.treatment">contr.treatment</a></code>, <code><a href="stats.html#topic+contr.poly">contr.poly</a></code>, <code><a href="stats.html#topic+contr.helmert">contr.helmert</a></code>,
<code><a href="stats.html#topic+contr.SAS">contr.SAS</a></code>, <code><a href="stats.html#topic+contr.sum">contr.sum</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Three levels
levels &lt;- LETTERS[1:3]
contr.none(levels)
contr.diff(levels)

# Two levels
levels &lt;- LETTERS[1:2]
contr.none(levels)
</code></pre>

<hr>
<h2 id='penfit+20object'>Penalized regression object</h2><span id='topic+penfit-class'></span><span id='topic+penfit'></span><span id='topic+show+2Cpenfit-method'></span><span id='topic+coefficients+2Cpenfit-method'></span><span id='topic+coef+2Cpenfit-method'></span><span id='topic+residuals+2Cpenfit-method'></span><span id='topic+fitted.values+2Cpenfit-method'></span><span id='topic+fitted+2Cpenfit-method'></span><span id='topic+penalty+2Cpenfit-method'></span><span id='topic+weights+2Cpenfit-method'></span><span id='topic+loglik+2Cpenfit-method'></span><span id='topic+basehaz+2Cpenfit-method'></span><span id='topic+basesurv+2Cpenfit-method'></span><span id='topic+basesurv'></span><span id='topic+linear.predictors'></span><span id='topic+linear.predictors+2Cpenfit-method'></span><span id='topic+as.data.frame+2Cpenfit-method'></span><span id='topic+penalty'></span><span id='topic+loglik'></span>

<h3>Description</h3>

<p>Stores the result of a call to <code><a href="#topic+penalized">penalized</a></code>.</p>


<h3>Slots</h3>


<dl>
<dt><code>penalized</code>:</dt><dd><p>Object of class &quot;vector&quot;. Regression coefficients for the penalized covariates.</p>
</dd>
<dt><code>unpenalized</code>:</dt><dd><p>Object of class &quot;vector&quot;. Regression coefficients for the unpenalized covariates.</p>
</dd>
<dt><code>residuals</code>:</dt><dd><p>Object of class &quot;vector&quot;. Unstandardized residuals for each subject in the fitted model. Martingale residuals are given for the cox model.</p>
</dd>
<dt><code>fitted</code>:</dt><dd><p>Object of class &quot;vector&quot;. Fitted values (means) for each subject in the fitted model. In the cox model, this slot holds the relative risks.</p>
</dd>
<dt><code>lin.pred</code>:</dt><dd><p>Object of class &quot;vector&quot;. Linear predictors for each subject in the fitted model.</p>
</dd>
<dt><code>loglik</code>:</dt><dd><p>Object of class &quot;numeric&quot;. Log likelihood of the fitted model. For the Cox model, reports the full likelihood rather than the partial likelihood.</p>
</dd>
<dt><code>penalty</code>:</dt><dd><p>Object of class &quot;vector&quot;. L1 and L2 penalties of the fitted model.</p>
</dd>
<dt><code>iterations</code>:</dt><dd><p>Object of class &quot;numeric&quot;. Number of iterations used in the fitting process.</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>Object of class &quot;logical&quot;. Whether the fitting process was judged to be converged.</p>
</dd>
<dt><code>model</code>:</dt><dd><p>Object of class &quot;character&quot;. The name of the generalized linear model used.</p>
</dd>
<dt><code>lambda1</code>:</dt><dd><p>Object of class &quot;vector&quot;. The lambda1 parameter(s) used.</p>
</dd>
<dt><code>lambda2</code>:</dt><dd><p>Object of class &quot;vector&quot;. The lambda2 parameter(s) used.</p>
</dd>
<dt><code>nuisance</code>:</dt><dd><p>Object of class &quot;list&quot;. The maximum likelihood estimates of any nuisance parameters in the model.</p>
</dd>
<dt><code>weights</code>:</dt><dd><p>Object of class &quot;vector&quot;. The weights of the covariates used for standardization.</p>
</dd>
<dt><code>formula</code>:</dt><dd><p>Object of class &quot;list&quot;. A named list containing the unpenalized and penalized formula objects, if present.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>basehaz</dt><dd><p>(penfit): Returns the baseline hazard (a <code>data.frame</code>) if a cox model was fitted, <code>NULL</code> otherwise. An additional argument <code>center</code> (default (<code>TRUE</code>) can be used to give the survival curve at the covariate mean (<code>center = TRUE</code>) rather than at zero.</p>
</dd>
<dt>basesurv</dt><dd><p>(penfit): Returns the baseline survival curve (a <code><a href="#topic+breslow">breslow</a></code> object) if a cox model was fitted, <code>NULL</code> otherwise. An additional argument <code>center</code> (default (<code>TRUE</code>) can be used to give the survival curve at the covariate mean (<code>center = TRUE</code>) rather than at zero.</p>
</dd>
<dt>coef</dt><dd><p>(penfit): Returns the regression coefficients. Accepts a second argument &quot;which&quot;, that takes values &quot;nonzero&quot; (the default), &quot;all&quot;, &quot;penalized&quot; or &quot;unpenalized&quot; for extracting only the non-zero, the penalized or the unpenalized regression coefficients. A third argument &quot;standardize&quot; (default FALSE) can be used to let the method return the regression coefficients for the standardized covariates.</p>
</dd>
<dt>coefficients</dt><dd><p>(penfit): synonym for <code>coef</code> above.</p>
</dd>
<dt>fitted</dt><dd><p>(penfit): Returns the fitted values for each subject (i.e. the predicted means). In the Cox model, this method returns the relative risks for each individual.</p>
</dd>
<dt>fitted.values</dt><dd><p>(penfit): synonym for <code>fitted</code> above.</p>
</dd>
<dt>linear.predictors</dt><dd><p>(penfit): Returns the linear predictors for each subject.</p>
</dd>
<dt>loglik</dt><dd><p>(penfit): Returns the log likelihood of the fitted model.</p>
</dd>
<dt>penalty</dt><dd><p>(penfit): Returns the L1 and L2 penalties of the fitted model.</p>
</dd>
<dt>residuals</dt><dd><p>(penfit): Returns the residuals.</p>
</dd>
<dt>show</dt><dd><p>(penfit): Summarizes the fitted model.</p>
</dd>
<dt>weights</dt><dd><p>(penfit): Returns the weights used for standardization.</p>
</dd>
<dt>predict</dt><dd><p>(penfit): Calculates predictions for new subjects. See <code><a href="#topic+predict">predict</a></code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jelle Goeman: <a href="mailto:j.j.goeman@lumc.nl">j.j.goeman@lumc.nl</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+penalized">penalized</a></code>.</p>

<hr>
<h2 id='Plotting+20the+20LASSO+20path'>Plotting the LASSO path</h2><span id='topic+plotpath'></span>

<h3>Description</h3>

<p>Plotting a LASSO path fitted using <code><a href="#topic+penalized">penalized</a></code> with <code>steps &gt; 1</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotpath(object, labelsize = 0.6, standardize = FALSE, ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Plotting+2B20the+2B20LASSO+2B20path_+3A_object">object</code></td>
<td>
<p>A <code>list</code> of <code>link{penfit}</code> objects calculated for the same data but different <code>lambda1</code> values. This object can be created using the <code>link{penalized}</code> function using the <code>steps</code> argument.</p>
</td></tr>
<tr><td><code id="Plotting+2B20the+2B20LASSO+2B20path_+3A_labelsize">labelsize</code></td>
<td>
<p>Sets the size of the variable labels in the plot. Set to zero for no variable labels.</p>
</td></tr>
<tr><td><code id="Plotting+2B20the+2B20LASSO+2B20path_+3A_standardize">standardize</code></td>
<td>
<p>If <code>TRUE</code>, plots the regression coefficients for the
covariates standardize to unit second central moment. See <code><a href="#topic+penalized">penalized</a></code> for details on standardization. Note that the standardization in <code>plotpath</code> can also be used if standarization was not used in <code><a href="#topic+penalized">penalized</a></code>.</p>
</td></tr>
<tr><td><code id="Plotting+2B20the+2B20LASSO+2B20path_+3A_...">...</code></td>
<td>
<p>Any other arguments will be forwarded to the plot function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jelle Goeman: <a href="mailto:j.j.goeman@lumc.nl">j.j.goeman@lumc.nl</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+penalized">penalized</a></code>, <code><a href="#topic+penfit">penfit</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(nki70)

# Fit the model with the steps argument and plot
pen &lt;- penalized(Surv(time, event), penalized = nki70[,8:77],
    data = nki70, lambda1=1, steps = 20)

plotpath(pen)

</code></pre>

<hr>
<h2 id='Prediction+20from+20penalized+20models'>Prediction based on penfit objects</h2><span id='topic+predict+2Cpenfit-method'></span><span id='topic+predict'></span>

<h3>Description</h3>

<p>Predicting a response for new subjects based on a fitted penalized regression model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S4 method for signature 'penfit'
predict(object, penalized, unpenalized, data)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Prediction+2B20from+2B20penalized+2B20models_+3A_object">object</code></td>
<td>
<p>The fitted model (a <code><a href="#topic+penfit">penfit</a></code> object).</p>
</td></tr>
<tr><td><code id="Prediction+2B20from+2B20penalized+2B20models_+3A_penalized">penalized</code></td>
<td>
<p>The matrix of penalized covariates for the new subjects.</p>
</td></tr>
<tr><td><code id="Prediction+2B20from+2B20penalized+2B20models_+3A_unpenalized">unpenalized</code></td>
<td>
<p>The unpenalized covariates for the new subjects.</p>
</td></tr>
<tr><td><code id="Prediction+2B20from+2B20penalized+2B20models_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> used to evaluate the terms of  <code>penalized</code> or <code>unpenalized</code> when these have been specified as a  <code><a href="stats.html#topic+formula">formula</a></code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user need only supply those terms from the original call that are different relative to the original call that produced the <code><a href="#topic+penfit">penfit</a></code> object. In particular, if penalized and/or unpenalized was specified in matrix form, a matrix must be given with the new subjects' data. The columns of these matrices must be exactly the same as in the matrices supplied in the original call that produced the <code><a href="#topic+penfit">penfit</a></code> object. If either penalized or unpenalized was given as a <code>formula</code> in the original call, the user of <code>predict</code> must supply a new <code>data</code> argument. As with matrices, the new <code>data</code> argument must have a similar make-up as the <code>data</code> argument in the original call that produced the <code><a href="#topic+penfit">penfit</a></code> object. In particular, any factors in <code>data</code> must have the same levels.</p>


<h3>Value</h3>

<p>The predictions, either as a <code>vector</code> (logistic and Poisson models), a <code>matrix</code> (linear model), or a <code><a href="#topic+breslow">breslow</a></code> object (Cox model).</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(nki70)

pen &lt;- penalized(Surv(time, event), penalized = nki70[1:50,8:77],
    unpenalized = ~ER+Age+Diam+N+Grade, data = nki70[1:50,], lambda1 = 10)

predict(pen, nki70[51:52,8:77], data = nki70[51:52,])
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
