<!DOCTYPE html><html><head><title>Help for package hommel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hommel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hommel-package'>
<p>Methods for closed testing with Simes inequality, in particular Hommel's method</p></a></li>
<li><a href='#Concentration+20set'><p>Concentration set calculation</p></a></li>
<li><a href='#hommel'><p>Calculates adjusted p-values of Hommel's method efficiently.</p></a></li>
<li><a href='#hommel+20class'><p>Class &quot;hommel&quot; for storing the result of Hommel's multiple testing method.</p></a></li>
<li><a href='#Local+20test'><p>P-values and adjusted p-values of local tests</p></a></li>
<li><a href='#True+20Discoveries'><p>Confidence bounds for the number of discoveries</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods for Closed Testing with Simes Inequality, in Particular
Hommel's Method</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-12-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Jelle Goeman, Rosa Meijer, Thijmen Krebs</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jelle Goeman &lt;j.j.goeman@lumc.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides methods for closed testing using Simes local tests. In particular, calculates adjusted p-values for Hommel's multiple testing method, and provides lower confidence bounds for true discovery proportions. A robust but more conservative variant of the closed testing procedure that does not require the assumption of Simes inequality is also implemented. The methods have been described in detail in Goeman et al (2016) &lt;<a href="https://doi.org/10.48550/arXiv.1611.06739">doi:10.48550/arXiv.1611.06739</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-10 14:26:58 UTC; jelle</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-17 11:00:02 UTC</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2.9000</td>
</tr>
</table>
<hr>
<h2 id='hommel-package'>
Methods for closed testing with Simes inequality, in particular Hommel's method
</h2><span id='topic+hommel-package'></span>

<h3>Description</h3>

<p>Provides methods for closed testing using Simes local tests. In particular, calculates adjusted p-values for Hommel's multiple testing method, and provides lower confidence bounds for true discovery proportions. A robust but more conservative variant of the closed testing procedure that does not require the assumption of Simes inequality is also implemented.
</p>


<h3>Details</h3>

<p>The starting point of the package is the <a href="#topic+hommel">hommel</a> function. See examples there.
</p>


<h3>Author(s)</h3>

<p>Jelle Goeman, Rosa Meijer, Thijmen Krebs.
</p>
<p>Maintainer: Jelle Goeman &lt;j.j.goeman@lumc.nl&gt;
</p>


<h3>References</h3>

<p>Hommel, G. (1988). A stagewise rejective multiple test procedure based on a modified Bonferroni test. Biometrika, 75(2), 383-386.
</p>
<p>Meijer, R., Krebs, T., Solari, A., &amp; Goeman, J. (2016). Simultaneous Control of All False Discovery Proportions by an Extension of Hommel's Method. arXiv preprint arXiv:1611.06739.
</p>

<hr>
<h2 id='Concentration+20set'>Concentration set calculation</h2><span id='topic+concentration'></span>

<h3>Description</h3>

<p>Calculates the concentration set threshold. The concentration set is the subset of the p-values that contains all discoveries at confidence level 1-alpha.</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
  concentration (hommel, alpha=0.05) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Concentration+2B20set_+3A_hommel">hommel</code></td>
<td>
<p>The hommel object for the complete multiple testing problem.</p>
</td></tr>
<tr><td><code id="Concentration+2B20set_+3A_alpha">alpha</code></td>
<td>
<p>The type I error allowed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a p-value. P-values larger than that value contain no discoveries in this data set at this level of alpha and may be disregarded.</p>


<h3>Author(s)</h3>

<p>Jelle Goeman.</p>


<h3>References</h3>

<p>Goeman, J., Meijer, R., Krebs, T., &amp; Solari, A. (2016). Simultaneous control of all false discovery proportions in large-scale multiple hypothesis testing. arXiv preprint arXiv:1611.06739.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #Generate a vector of pvalues
  set.seed(102)
  m &lt;- 10
  pvalues &lt;- c(runif(0.5*m,0,0.02), runif(0.5*m,0,1))
  
  # First step: create a hommel object.
  # Use Simes'test (simes = TRUE) or Hommel's robust test (simes = FALSE)
  hom &lt;- hommel(pvalues, simes = TRUE)

  # Find the concentration set bound
  threshold &lt;- concentration(hom)
  
  # Find the concentration set itself
  set &lt;- pvalues &lt;= threshold
  sum(set)
</code></pre>

<hr>
<h2 id='hommel'>Calculates adjusted p-values of Hommel's method efficiently.</h2><span id='topic+hommel'></span>

<h3>Description</h3>

<p>Calculates adjusted p-values of Hommel's method efficiently.</p>


<h3>Usage</h3>

<pre><code class='language-R'> hommel (p, simes = TRUE) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hommel_+3A_p">p</code></td>
<td>
<p>A vector of p-values.</p>
</td></tr>
<tr><td><code id="hommel_+3A_simes">simes</code></td>
<td>
<p>If <code>TRUE</code>, the Simes test is used (Hommel's method), if <code>FALSE</code> Hommel's robust test is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="#topic+hommel-class">hommel-class</a></code> object.</p>


<h3>Author(s)</h3>

<p>Jelle Goeman, Rosa Meijer, Thijmen Krebs.</p>


<h3>References</h3>

<p>Hommel, G. (1988). A stagewise rejective multiple test procedure based on a modified Bonferroni test. Biometrika, 75(2), 383-386.
</p>
<p>Meijer, R. J., Krebs, T. J., &amp; Goeman, J. J. (2019). Hommel's procedure in linear time. Biometrical Journal, 61(1), 73-82.
</p>
<p>Goeman, J., Meijer, R., Krebs, T., &amp; Solari, A. (2016). Simultaneous control of all false discovery proportions in large-scale multiple hypothesis testing. arXiv preprint arXiv:1611.06739.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #Generate a vector of pvalues
  set.seed(102)
  m &lt;- 10
  pvalues &lt;- c(runif(0.5*m,0,0.02), runif(0.5*m,0,1))
  
  # First step: create a hommel object.
  # Use Simes'test (simes = TRUE) or Hommel's robust test (simes = FALSE)
  hom &lt;- hommel(pvalues, simes = TRUE)

  hom
  summary(hom)
  
  # retrieve familywise error adjusted p-values
  p.adjust(hom)
  
  # Find lower confidence bounds 
  # for the number of false null hypotheses (discoveries)
  # In any subset of interest
  discoveries(hom, 1:2)
</code></pre>

<hr>
<h2 id='hommel+20class'>Class &quot;hommel&quot; for storing the result of Hommel's multiple testing method.</h2><span id='topic+hommel-class'></span><span id='topic+p.adjust+2Chommel-method'></span><span id='topic+summary+2Chommel-method'></span><span id='topic+show+2Chommel-method'></span>

<h3>Description</h3>

<p>The class hommel is the output of a call to <code><a href="#topic+hommel">hommel</a></code>. It stores the adjusted p-values of all elementary hypotheses, as well as information needed to quickly calculate other results about the underlying closed testing procedure.</p>


<h3>Slots</h3>

<p>These slots are not meant to be directly accessed by the user.
</p>

<dl>
<dt><code>p</code>:</dt><dd><p>Object of class &quot;numeric&quot;. Stores original (unadjusted) p-values for all hypotheses.</p>
</dd>
<dt><code>sorter</code>:</dt><dd><p>Object of class &quot;integer&quot;. Stores the permutation to sort p.</p>
</dd>
<dt><code>jumpalpha</code>:</dt><dd><p>Object of class &quot;numeric&quot;. Stores the alpha-values where the function h jumps.</p>
</dd>
<dt><code>adjusted</code>:</dt><dd><p>Object of class &quot;numeric&quot;. Stores adjusted p-values for all elementary hypotheses.</p>
</dd>
<dt><code>simesfactor</code>:</dt><dd><p>Object of class &quot;numeric&quot;. The denominator of the local test that is used.</p>
</dd>
<dt><code>simes</code>:</dt><dd><p>Object of class &quot;logical&quot;. Is TRUE if the adjusted p-values are calculated based on Simes' test that assumes the Simes inequality. If FALSE if they are based on Hommel's robust test.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>p.adjust</dt><dd><p>(hommel): Retrieves adjusted pvalues for all elementary hypotheses.</p>
</dd>
<dt>summary</dt><dd><p>(hommel, alpha=0.05): Summarizes the results of hommel's method for the specified level of alpha.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jelle Goeman, Rosa Meijer, Thijmen Krebs.</p>


<h3>References</h3>

<p>Hommel, G. (1988). A stagewise rejective multiple test procedure based on a modified Bonferroni test. Biometrika, 75(2), 383-386.
</p>
<p>Meijer, R. J., Krebs, T. J., &amp; Goeman, J. J. (2019). Hommel's procedure in linear time. Biometrical Journal, 61(1), 73-82.
</p>
<p>Goeman, J., Meijer, R., Krebs, T., &amp; Solari, A. (2016). Simultaneous control of all false discovery proportions in large-scale multiple hypothesis testing. arXiv preprint arXiv:1611.06739.
</p>


<h3>See Also</h3>

<p>select, <a href="#topic+concentration">concentration</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #Generate a vector of pvalues
  set.seed(102)
  m &lt;- 10
  pvalues &lt;- c(runif(0.5*m,0,0.02), runif(0.5*m,0,1))
  
  # First step: create a hommel object.
  # Use Simes'test (simes = TRUE) or Hommel's robust test (simes = FALSE)
  hom &lt;- hommel(pvalues, simes = TRUE)

  hom
  summary(hom)
  
  # retrieve familywise error adjusted p-values
  p.adjust(hom)
  
  # Find lower confidence bounds 
  # for the number of false null hypotheses (discoveries)
  # In any subset of interest
  discoveries(hom, 1:2)
</code></pre>

<hr>
<h2 id='Local+20test'>P-values and adjusted p-values of local tests</h2><span id='topic+localtest'></span>

<h3>Description</h3>

<p>An intersection hypothesis is defined for any collection of null hypotheses as the hypothesis that is true if and only if the proportion of null hypotheses are less than the selected threshold. A test for an intersection hypothesis is called a local test. This function calculates familywise error adjusted p-values for local tests. Familywise error control is over all possible local tests simultaneously.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  localtest (hommel, ix, tdp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Local+2B20test_+3A_hommel">hommel</code></td>
<td>
<p>The hommel object for the complete multiple testing problem.</p>
</td></tr>
<tr><td><code id="Local+2B20test_+3A_ix">ix</code></td>
<td>
<p>The selection of hypotheses defining the intersection hypothesis. Any selector that works on the original vector of p-values (index, negative index, logical, names) is allowed. If ix is missing, the global null hypothesis is used.</p>
</td></tr>
<tr><td><code id="Local+2B20test_+3A_tdp">tdp</code></td>
<td>
<p>The threshold value for the intersection hypothesis which should be a proportion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the familywise error adjusted p-value.</p>


<h3>Author(s)</h3>

<p>Jelle Goeman.</p>


<h3>References</h3>

<p>Meijer, R. J., Krebs, T. J., &amp; Goeman, J. J. (2019). Hommel's procedure in linear time. Biometrical Journal, 61(1), 73-82.
</p>
<p>Goeman, J., Meijer, R., Krebs, T., &amp; Solari, A. (2016). Simultaneous control of all false discovery proportions in large-scale multiple hypothesis testing. arXiv preprint arXiv:1611.06739.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #Generate a vector of pvalues
  set.seed(102)
  m &lt;- 10
  pvalues &lt;- c(runif(0.5*m,0,0.02), runif(0.5*m,0,1))

  # First step: create a hommel object.
  hom &lt;- hommel(pvalues, simes = TRUE)

  # Test any intersection hypothesis of interest against any chosen threshold
  localtest(hom, tdp=0.2)
  localtest(hom, 1:3, 0.8)

</code></pre>

<hr>
<h2 id='True+20Discoveries'>Confidence bounds for the number of discoveries</h2><span id='topic+discoveries'></span><span id='topic+fdp'></span><span id='topic+tdp'></span>

<h3>Description</h3>

<p>Calculates (1-alpha) lower confidence bounds for the number of false null hypotheses (discoveries) or for the true discovery proportion, and (1-alpha) upper confidence bounds for the false discovery proportions. These bounds are for arbitrary subsets, and are simultaneous over all subsets. They are valid even if the subset is chosen after seeing the data.</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
  discoveries (hommel, ix, incremental=FALSE, alpha=0.05) 
  fdp (hommel, ix, incremental=FALSE, alpha=0.05) 
  tdp (hommel, ix, incremental=FALSE, alpha=0.05) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="True+2B20Discoveries_+3A_hommel">hommel</code></td>
<td>
<p>The hommel object for the complete multiple testing problem.</p>
</td></tr>
<tr><td><code id="True+2B20Discoveries_+3A_ix">ix</code></td>
<td>
<p>The selection of hypotheses considered. Any selector that works on the original vector of p-values (index, negative index, logical, names) is allowed. If missing, all hypotheses are selected.</p>
</td></tr>
<tr><td><code id="True+2B20Discoveries_+3A_incremental">incremental</code></td>
<td>
<p>If TRUE, the number of discoveries (of fdp or tdp) is reported for incremental sets formed by adding the indices from ix in order. If FALSE, reports the numbr of discoveries in the full set only.</p>
</td></tr>
<tr><td><code id="True+2B20Discoveries_+3A_alpha">alpha</code></td>
<td>
<p>The type I error allowed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a single integer (discoveries) or proportion (fdp, tdp), or a vector if incremental = TRUE. These represent the lower confidence bound (discoveries, tdp) or upper confidence bound (fdp). The confidence intervals are one-sided: the upper confidence bound for discoveries is the size of the set, and for tdp 1. The lower bound for fdp is 0.</p>


<h3>Author(s)</h3>

<p>Jelle Goeman, Rosa Meijer, Thijmen Krebs, Mitra Ebrahimpoor, Xu Chen.</p>


<h3>References</h3>

<p>Goeman, J., Meijer, R., Krebs, T., &amp; Solari, A. (2016). Simultaneous control of all false discovery proportions in large-scale multiple hypothesis testing. arXiv preprint arXiv:1611.06739.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #Generate a vector of pvalues
  set.seed(102)
  m &lt;- 10
  pvalues &lt;- c(runif(0.5*m,0,0.02), runif(0.5*m,0,1))
  
  # First step: create a hommel object.
  # Use Simes'test (simes = TRUE) or Hommel's robust test (simes = FALSE)
  hom &lt;- hommel(pvalues, simes = TRUE)

  hom
  summary(hom)
  
  # Find lower confidence bounds 
  # for the number of false null hypotheses (discoveries)
  # In any subset of interest
  discoveries(hom, 1:2)
  
  # a bound for the false discovery proportion:
  set &lt;- 1:5
  fdp(hom, set)
  
  # or incremental for sets ix = (1), (1,2), (1,2,3), (1,2,3,4) and (1,2,3,4,5)
  fdp(hom, set, incremental = TRUE)
  
  # use alpha=0.5 to obtain a conservative point estimate
  tdp(hom, set, alpha=0.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
