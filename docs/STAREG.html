<!DOCTYPE html><html><head><title>Help for package STAREG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {STAREG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#em_lfdr'><p>EM algorithm to estimate local false discovery rate</p></a></li>
<li><a href='#stareg'><p>An empirical Bayes approach for replicability analysis across two studies</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An Empirical Bayes Approach for Replicability Analysis Across
Two Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>A robust and powerful empirical Bayesian approach is developed for replicability analysis of two large-scale experimental studies. The method controls the false discovery rate by using the joint local false discovery rate based on the replicability null as the test statistic. An EM algorithm combined with a shape constraint nonparametric method is used to estimate unknown parameters and functions. [Li, Y. et al., (2023), <a href="https://www.biorxiv.org/content/10.1101/2023.05.30.542607v1">https://www.biorxiv.org/content/10.1101/2023.05.30.542607v1</a>].</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>Rcpp (&ge; 1.0.9), qvalue</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-15 14:16:28 UTC; P53</td>
</tr>
<tr>
<td>Author:</td>
<td>Yan Li [aut, cre, cph],
  Xiang Zhou [aut],
  Rui Chen [aut],
  Xianyang Zhang [aut],
  Hongyuan Cao [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yan Li &lt;yanli_@jlu.edu.cn&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-15 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='em_lfdr'>EM algorithm to estimate local false discovery rate</h2><span id='topic+em_lfdr'></span>

<h3>Description</h3>

<p>Estimate the local false discovery rate across two studies and apply a step-up procedure to control the FDR of replicability null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>em_lfdr(pa_in, pb_in, pi0a_in, pi0b_in)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em_lfdr_+3A_pa_in">pa_in</code></td>
<td>
<p>A numeric vector of p-values from study 1.</p>
</td></tr>
<tr><td><code id="em_lfdr_+3A_pb_in">pb_in</code></td>
<td>
<p>A numeric vector of p-values from study 2.</p>
</td></tr>
<tr><td><code id="em_lfdr_+3A_pi0a_in">pi0a_in</code></td>
<td>
<p>An initial estimate of the null probability in study 1.</p>
</td></tr>
<tr><td><code id="em_lfdr_+3A_pi0b_in">pi0b_in</code></td>
<td>
<p>An initial estimate of the null probability in study 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Lfdr</code></td>
<td>
<p>The estimated local false discovery rate for replicability null.</p>
</td></tr>
<tr><td><code>fdr</code></td>
<td>
<p>The adjusted values based on local false discovery rate for FDR control.</p>
</td></tr>
<tr><td><code>xi00</code></td>
<td>
<p>An estimate of the prior probability for joint state (0, 0).</p>
</td></tr>
<tr><td><code>xi01</code></td>
<td>
<p>An estimate of the prior probability for joint state (0, 1).</p>
</td></tr>
<tr><td><code>xi10</code></td>
<td>
<p>An estimate of the prior probability for joint state (1, 0).</p>
</td></tr>
<tr><td><code>xi11</code></td>
<td>
<p>An estimate of the prior probability for joint state (1, 1).</p>
</td></tr>
<tr><td><code>f1</code></td>
<td>
<p>A non-parametric estimate for the non-null probability density function in study 1.</p>
</td></tr>
<tr><td><code>f2</code></td>
<td>
<p>A non-parametric estimate for the non-null probability density function in study 2.</p>
</td></tr>
</table>

<hr>
<h2 id='stareg'>An empirical Bayes approach for replicability analysis across two studies</h2><span id='topic+stareg'></span>

<h3>Description</h3>

<p>An empirical Bayes approach for replicability analysis across two studies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stareg(pa, pb, init.pi0 = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stareg_+3A_pa">pa</code></td>
<td>
<p>A numeric vector of p-values from study 1.</p>
</td></tr>
<tr><td><code id="stareg_+3A_pb">pb</code></td>
<td>
<p>A numeric vector of p-values from study 2.</p>
</td></tr>
<tr><td><code id="stareg_+3A_init.pi0">init.pi0</code></td>
<td>
<p>A logistic value for deciding whether to initialize the prior probabilities based on the estimates of pi0's. If true, estimate the marginal pi0's in two studies using qvalue; otherwise, specify pi0_pa = pi_pb = 0.9.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list:
</p>
<table>
<tr><td><code>Lfdr</code></td>
<td>
<p>The estimated local false discovery rate for replicability null.</p>
</td></tr>
<tr><td><code>fdr</code></td>
<td>
<p>The adjusted Lfdr values based on the step-up procedure for FDR control.</p>
</td></tr>
<tr><td><code>xi00</code></td>
<td>
<p>An estimate of the prior probability for joint state (0, 0) in two studies.</p>
</td></tr>
<tr><td><code>xi01</code></td>
<td>
<p>An estimate of the prior probability for joint state (0, 1) in two studies.</p>
</td></tr>
<tr><td><code>xi10</code></td>
<td>
<p>An estimate of the prior probability for joint state (1, 0) in two studies.</p>
</td></tr>
<tr><td><code>xi11</code></td>
<td>
<p>An estimate of the prior probability for joint state (1, 1) in two studies.</p>
</td></tr>
<tr><td><code>f1</code></td>
<td>
<p>A non-parametric estimate for the non-null probability density function in study 1.</p>
</td></tr>
<tr><td><code>f2</code></td>
<td>
<p>A non-parametric estimate for the non-null probability density function in study 2.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate p-values in two studies
m = 10000
h = sample(0:3, m, replace = TRUE, prob = c(0.9, 0.025, 0.025, 0.05))
states1 = rep(0, m); states2 = rep(0, m)
states1[which(h==2|h==3)] = 1; states2[which(h==1|h==3)] = 1
z1 = rnorm(m, states1*2, 1)
z2 = rnorm(m, states2*3, 1)
p1 = 1 - pnorm(z1); p2 = 1 - pnorm(z2)
# Run STAREG to identify replicable signals
res.stareg = stareg(p1, p2)
sig.idx = which(res.stareg$fdr &lt;= 0.05)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
