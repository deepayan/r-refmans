<!DOCTYPE html><html><head><title>Help for package sfsmisc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sfsmisc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AsciiToInt'><p>Character to and from Integer Codes Conversion</p></a></li>
<li><a href='#axTexpr'><p>Axis Ticks Expressions in Nice 10 ** k Form</p></a></li>
<li><a href='#cairoSwd'><p>Cairo PDF Graphics Device useful for Sweave</p></a></li>
<li><a href='#capture.and.write'><p>Capture output and Write / Print First and Last Parts</p></a></li>
<li><a href='#col01scale'><p>Matrix Scaling Utilities</p></a></li>
<li><a href='#compresid2way'><p>Plot Components + Residuals for Two Factors</p></a></li>
<li><a href='#cum.Vert.funkt'><p>Kumulative Verteilung Aufzeichnen</p></a></li>
<li><a href='#D1D2'><p>Numerical Derivatives of (x,y) Data via Smoothing Splines</p></a></li>
<li><a href='#D2ss'><p>Numerical Derivatives of (x,y) Data  (via Smoothing Splines)</p></a></li>
<li><a href='#Deprecated'><p>Deprecated 'sfsmisc' Functions</p></a></li>
<li><a href='#diagDA'><p>Diagonal Discriminant Analysis</p></a></li>
<li><a href='#diagX'><p>The &ldquo;Other&rdquo; Diagonal Matrix</p></a></li>
<li><a href='#digitsBase'><p>Digit/Bit Representation of Integers in any Base</p></a></li>
<li><a href='#Duplicated'><p>Counting-Generalization of duplicated()</p></a></li>
<li><a href='#eaxis'><p>Extended / Engineering Axis for Graphics</p></a></li>
<li><a href='#ecdf.ksCI'><p>Plot Empirical Distribution Function With 95% Confidence Curves</p></a></li>
<li><a href='#ellipsePoints'><p>Compute Radially Equispaced Points on Ellipse</p></a></li>
<li><a href='#empty.dimnames'><p>Empty Dimnames of an Array</p></a></li>
<li><a href='#errbar'><p>Scatter Plot with Error Bars</p></a></li>
<li><a href='#f.robftest'><p>Robust F-Test: Wald test for multiple coefficients of rlm() Object.</p></a></li>
<li><a href='#factorize'><p>Prime Factorization of Integers</p></a></li>
<li><a href='#funEnv'><p>List-like Environment of Functions (and More)</p></a></li>
<li><a href='#hatMat'><p>Hat Matrix of a Smoother</p></a></li>
<li><a href='#helppdf'><p>help() Type=&quot;pdf&quot; and View It</p></a></li>
<li><a href='#histBxp'><p>Plot a Histogram and a Boxplot</p></a></li>
<li><a href='#integrate.xy'><p>Cheap Numerical Integration through Data points.</p></a></li>
<li><a href='#inv.seq'><p>Inverse seq() &ndash; Short Expression for Index Vector</p></a></li>
<li><a href='#is.whole'><p>Test Whether a Vector or Array Consists of Whole Numbers</p></a></li>
<li><a href='#iterate.lin.recursion'><p>Generate Sequence Iterating a Linear Recursion</p></a></li>
<li><a href='#KSd'><p>Approximate Critical Values for Kolmogorov-Smirnov's D</p></a></li>
<li><a href='#last'><p>Get Last Elements of a Vector</p></a></li>
<li><a href='#linesHyperb.lm'><p>Plot Confidence or Prediction Hyperbolas around a Regression Line</p></a></li>
<li><a href='#list_named'><p>Automatically Named list()</p></a></li>
<li><a href='#loessDemo'><p>Graphical Interactive Demo of loess()</p></a></li>
<li><a href='#lseq'><p>Generate Sequences, Equidistant on Log Scale</p></a></li>
<li><a href='#mat2tex'><p>Produce LaTeX commands to print a matrix</p></a></li>
<li><a href='#missingCh'><p>Has a Formal Argument been Set or is it Missing?</p></a></li>
<li><a href='#mpl'><p>Simple Matrix Plots</p></a></li>
<li><a href='#mult.fig'><p>Plot Setup for MULTiple FIGures, incl. Main Title</p></a></li>
<li><a href='#n.code'><p>Convert &quot;Round&quot; Integers to Short Strings and Back</p></a></li>
<li><a href='#n.plot'><p>Name Plot: Names or Numbers instead of Points in Plot</p></a></li>
<li><a href='#nearcor'><p>Find the Nearest Proper Correlation Matrix</p></a></li>
<li><a href='#nr.sign.chg'><p>Number of Sign Changes in Sequence</p></a></li>
<li><a href='#p.arrows'><p>Prettified Arrows Plots</p></a></li>
<li><a href='#p.datum'><p>Plot 'Datum' (deutsch!) unten rechts</p></a></li>
<li><a href='#p.dnorm'><p>Plot Parametric Density Functions</p></a></li>
<li><a href='#p.hboxp'><p>Add a Horizontal Boxplot to the Current Plot</p></a></li>
<li><a href='#p.profileTraces'><p>Plot a profile.nls Object With Profile Traces</p></a></li>
<li><a href='#p.res.2fact'><p>Plot Numeric (e.g. Residuals) vs 2 Factors Using Boxplots</p></a></li>
<li><a href='#p.res.2x'><p>Stahel's Residual Plot against 2 X's</p></a></li>
<li><a href='#p.scales'><p>Conversion between plotting scales: usr, cm, symbol</p></a></li>
<li><a href='#p.tachoPlot'><p>Draw Symbol on a Plot</p></a></li>
<li><a href='#p.ts'><p>plot.ts with multi-plots and Auto-Title &ndash; on 1 page</p></a></li>
<li><a href='#paste.vec'><p>Utility for 'Showing' S vectors</p></a></li>
<li><a href='#pkgDesc'><p>Version of packageDescription() as Simple Vector</p></a></li>
<li><a href='#pkgLibs'><p>R Package Compiled Code Library Dependencies (on Unix-alikes)</p></a></li>
<li><a href='#plotDS'><p>Plot Data and Smoother / Fitted Values</p></a></li>
<li><a href='#plotStep'><p>Plot a Step Function</p></a></li>
<li><a href='#polyn.eval'><p>Evaluate Polynomials</p></a></li>
<li><a href='#posdefify'><p>Find a Close Positive Definite Matrix</p></a></li>
<li><a href='#potatoes'><p>Fisher's Potato Crop Data</p></a></li>
<li><a href='#pretty10exp'><p>Nice  10 ** k  Label Expressions</p></a></li>
<li><a href='#primes'><p>Find all Primes Less Than n</p></a></li>
<li><a href='#printTable2'><p>Add and Print Marginals for 2-way Contingency Tables</p></a></li>
<li><a href='#prt.DEBUG'><p>Utility Printing in DEBUG mode</p></a></li>
<li><a href='#ps.end'><p>Close PostScript or Acrobat Graphics Device opened by 'ps.do' / 'pdf.do'</p></a></li>
<li><a href='#ps.latex'><p>PostScript/PDF Preview Device with Optional &lsquo;LaTeX&rsquo; Touch</p></a></li>
<li><a href='#quadrant'><p>Give the Quadrant Number of Planar Points</p></a></li>
<li><a href='#QUnif'><p>Quasi Randum Numbers via Halton Sequences</p></a></li>
<li><a href='#read.org.table'><p>Read.table for an Emacs Org Table</p></a></li>
<li><a href='#relErr'><p>Relative Error When Appropriate, Absolute Otherwise</p></a></li>
<li><a href='#repChar'><p>Make Simple String from Repeating a Character, e.g. Blank String</p></a></li>
<li><a href='#rot2'><p>Rotate Planar Points by Angle</p></a></li>
<li><a href='#rotn'><p>Generalized Rot13 Character Translation (Rotation)</p></a></li>
<li><a href='#roundfixS'><p>Round to Integer Keeping the Sum Fixed</p></a></li>
<li><a href='#rrange'><p>Robust Range using Boxplot 'Quartiles'</p></a></li>
<li><a href='#seqXtend'><p>Sequence Covering the Range of X, including X</p></a></li>
<li><a href='#sessionInfoX'><p>Extended Information About the Current R Session</p></a></li>
<li><a href='#sfsmisc-defunct'><p>Defunct Functions in Package <span class="pkg">sfsmisc</span></p></a></li>
<li><a href='#shortRversion'><p>Short R Version String</p></a></li>
<li><a href='#signi'><p>Rounding to Significant Digits</p></a></li>
<li><a href='#sourceAttach'><p>Source and Attach an R source file</p></a></li>
<li><a href='#str_data'><p>Overview on All Datasets in an R Package</p></a></li>
<li><a href='#Sys.cpuinfo'><p>Provide Information about the Linux Hardware (CPU, Memory, etc)</p></a></li>
<li><a href='#Sys.ps'><p>Return Process Status (Unix 'ps') Information</p></a></li>
<li><a href='#TA.plot'><p>Tukey-Anscombe Plot (Residual vs. Fitted) of a Linear Model</p></a></li>
<li><a href='#tapplySimpl'><p>More simplification in tapply() result</p></a></li>
<li><a href='#tkdensity'><p>GUI Density Estimation using Tcl/Tk</p></a></li>
<li><a href='#toLatex.numeric'><p>LaTeX or Sweave friendly Formatting of Numbers</p></a></li>
<li><a href='#u.assign0'><p>'Portable' assign / get functions (R / S-plus) for 'Frame 0'</p></a></li>
<li><a href='#u.boxplot.x'><p>Utility Returning x-Coordinates of Boxplot</p></a></li>
<li><a href='#u.date'><p>Return Date[-Time] String in 'European' Format</p></a></li>
<li><a href='#u.datumdecode'><p>Convert &ldquo;Numeric&rdquo; Dates</p></a></li>
<li><a href='#u.Datumvonheute'><p>Datum und Uhrzeit (auf deutsch)</p></a></li>
<li><a href='#u.log'><p>(Anti)Symmetric Log High-Transform</p></a></li>
<li><a href='#u.sys'><p>'Portable' System function (R / S-plus)</p></a></li>
<li><a href='#unif'><p>Nice Uniform Points in Interval</p></a></li>
<li><a href='#uniqueL'><p>A Reversable Version of unique()</p></a></li>
<li><a href='#vcat'><p>Paste Utilities &ndash; Concatenate Strings</p></a></li>
<li><a href='#wrapFormula'><p>Enhance Formula by Wrapping each Term, e.g., by &quot;s(.)&quot;</p></a></li>
<li><a href='#xy.grid'><p>Produce regular grid matrix.</p></a></li>
<li><a href='#xy.unique.x'><p>Uniqify (X,Y) Values using Weights</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Utilities from 'Seminar fuer Statistik' ETH Zurich</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-17</td>
</tr>
<tr>
<td>VersionNote:</td>
<td>Last CRAN: 1.1-16 on 2023-08-10</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-01</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Maechler &lt;maechler@stat.math.ethz.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Useful utilities ['goodies'] from Seminar fuer Statistik ETH Zurich,
   some of which were ported from S-plus in the 1990s.
 For graphics, have pretty (Log-scale) axes eaxis(), an enhanced Tukey-Anscombe
   plot, combining histogram and boxplot, 2d-residual plots, a 'tachoPlot()',
   pretty arrows, etc.
 For robustness, have a robust F test and robust range().
 For system support, notably on Linux, provides 'Sys.*()' functions with
   more access to system and CPU information.
 Finally, miscellaneous utilities such as simple efficient prime numbers,
   integer codes, Duplicated(), toLatex.numeric() and is.whole().</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, utils, stats, tools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>datasets, tcltk, cluster, lattice, MASS, Matrix, nlme,
lokern, Rmpfr, gmp</td>
</tr>
<tr>
<td>Enhances:</td>
<td>mgcv, rpart, nor1mix, polycor, sm, tikzDevice, e1071, Hmisc,
pastecs, polynom, robustbase</td>
</tr>
<tr>
<td>EnhancesNote:</td>
<td>2nd line: packages mentioned in Rd xrefs</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mmaechler/sfsmisc">https://github.com/mmaechler/sfsmisc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mmaechler/sfsmisc/issues">https://github.com/mmaechler/sfsmisc/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-01 09:34:52 UTC; maechler</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Maechler <a href="https://orcid.org/0000-0002-8685-9910"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Werner Stahel [ctb] (Functions: compresid2way(), f.robftest(), last(),
    p.scales(), p.dnorm()),
  Andreas Ruckstuhl [ctb] (Functions: p.arrows(), p.profileTraces(),
    p.res.2x()),
  Christian Keller [ctb] (Functions: histBxp(), p.tachoPlot()),
  Kjetil Halvorsen [ctb] (Functions: KSd(), ecdf.ksCI()),
  Alain Hauser [ctb] (Functions: cairoSwd(), is.whole(),
    toLatex.numeric()*),
  Christoph Buser [ctb] (to function Duplicated()),
  Lorenz Gygax [ctb] (to function p.res.2fact()),
  Bill Venables [ctb] (Functions: empty.dimnames(), primes()),
  Tony Plate [ctb] (to inv.seq()),
  Isabelle Flückiger [ctb],
  Marcel Wolbers [ctb],
  Markus Keller [ctb],
  Sandrine Dudoit [ctb],
  Jane Fridlyand [ctb],
  Greg Snow [ctb] (to loessDemo()),
  Henrik Aa. Nielsen [ctb] (to loessDemo()),
  Vincent Carey [ctb],
  Ben Bolker [ctb],
  Philippe Grosjean [ctb],
  Frédéric Ibanez [ctb],
  Caterina Savi [ctb],
  Charles Geyer [ctb],
  Jens Oehlschlägel [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-01 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AsciiToInt'>Character to and from Integer Codes Conversion</h2><span id='topic+AsciiToInt'></span><span id='topic+ichar'></span><span id='topic+chars8bit'></span><span id='topic+strcodes'></span>

<h3>Description</h3>

<p><code>AsciiToInt</code> returns <code><a href="base.html#topic+integer">integer</a></code> codes in <code>0:255</code>
for each (one byte) character in <code>strings</code>.  <code>ichar</code> is an
alias for it, for old S compatibility.
</p>
<p><code>strcodes</code> implements in <span class="rlang"><b>R</b></span> the basic engine for translating
characters to corresponding integer codes.
</p>
<p><code>chars8bit()</code> is the <em>inverse</em> function of
<code>AsciiToint</code>, producing &ldquo;one byte&rdquo; characters from integer
codes.  Note that it (and hence <code>strcodes()</code> depends on the
locale, see <code><a href="base.html#topic+Sys.getlocale">Sys.getlocale</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AsciiToInt(strings)
     ichar(strings)
chars8bit(i = 1:255)
strcodes(x, table = chars8bit(1:255))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AsciiToInt_+3A_strings">strings</code>, <code id="AsciiToInt_+3A_x">x</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> vector.</p>
</td></tr>
<tr><td><code id="AsciiToInt_+3A_i">i</code></td>
<td>
<p>numeric (integer) vector of values in <code>1:255</code>.</p>
</td></tr>
<tr><td><code id="AsciiToInt_+3A_table">table</code></td>
<td>
<p>a vector of (unique) character strings, typically of one
character each.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only codes in <code>1:127</code> make up the ASCII encoding which should be
identical for all <span class="rlang"><b>R</b></span> versions, whereas the <em>&lsquo;upper&rsquo;</em> half
is often determined from the ISO-8859-1 (aka &ldquo;ISO-Latin 1)&rdquo;
encoding, but may well differ, depending on the locale setting, see
also <code><a href="base.html#topic+Sys.setlocale">Sys.setlocale</a></code>.
</p>
<p>Note that <code>0</code> is no longer allowed since, <span class="rlang"><b>R</b></span> does not allow
<code>\0</code> aka <code>nul</code> characters in a string anymore.
</p>


<h3>Value</h3>

<p><code>AsciiToInt</code> (and hence <code>ichar</code>) and <code>chars8bit</code> return a
vector of the same length as their argument.
</p>
<p><code>strcodes(x, tab)</code> returns a <code><a href="base.html#topic+list">list</a></code> of the same
<code><a href="base.html#topic+length">length</a></code> and <code><a href="base.html#topic+names">names</a></code> as <code>x</code> with list
components of integer vectors with codes in <code>1:255</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, partly in 1991 for S-plus</p>


<h3>Examples</h3>

<pre><code class='language-R'>chars8bit(65:70)#-&gt; "A" "B" .. "F"
stopifnot(identical(LETTERS,   chars8bit(65:90)),
          identical(AsciiToInt(LETTERS), 65:90))

## may only work in ISO-latin1 locale (not in UTF-8):
try( strcodes(c(a= "ABC", ch="1234", place = "Zürich")) )
## in "latin-1" gives  {otherwise should give NA instead of 252}:
## Not run: 
$a
[1] 65 66 67

$ch
[1] 49 50 51 52

$place
[1]  90 252 114 105  99 104

## End(Not run)

myloc &lt;- Sys.getlocale()

if(.Platform $ OS.type == "unix") withAutoprint({ # ''should work'' here
  try( Sys.setlocale(locale = "de_CH") )# "try": just in case
  strcodes(c(a= "ABC", ch="1234", place = "Zürich")) # no NA hopefully
  AsciiToInt(chars8bit()) # -&gt; 1:255  {if setting latin1 succeeded above}

  chars8bit(97:140)
  try( Sys.setlocale(locale = "de_CH.utf-8") )# "try": just in case
  chars8bit(97:140) ## typically looks different than above
})

## Resetting to original locale .. works "mostly":
lapply(strsplit(strsplit(myloc, ";")[[1]], "="),
       function(cc) try(Sys.setlocale(cc[1], cc[2]))) -&gt; .scratch

Sys.getlocale() == myloc # TRUE if we have succeeded to reset it
</code></pre>

<hr>
<h2 id='axTexpr'>Axis Ticks Expressions in Nice 10 ** k Form</h2><span id='topic+axTexpr'></span>

<h3>Description</h3>

<p>Produce nice <code class="reqn">a \times 10^k</code> expressions for
<code><a href="graphics.html#topic+axis">axis</a></code> labeling instead of the scientific notation
<code>"a E&lt;k&gt;"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>axTexpr(side, at = axTicks(side, axp = axp, usr = usr, log = log),
        axp = NULL, usr = NULL, log = NULL,
        drop.1 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="axTexpr_+3A_side">side</code></td>
<td>
<p>integer in 1:4 specifying the axis side, as for
<code><a href="graphics.html#topic+axis">axis</a></code>.</p>
</td></tr>
<tr><td><code id="axTexpr_+3A_at">at</code></td>
<td>
<p>numeric vector; with identical default as in
<code><a href="graphics.html#topic+axTicks">axTicks</a>()</code>.</p>
</td></tr>
<tr><td><code id="axTexpr_+3A_axp">axp</code>, <code id="axTexpr_+3A_usr">usr</code>, <code id="axTexpr_+3A_log">log</code></td>
<td>
<p>as for <code><a href="graphics.html#topic+axTicks">axTicks</a>()</code>.</p>
</td></tr>
<tr><td><code id="axTexpr_+3A_drop.1">drop.1</code></td>
<td>
<p>logical indicating if <code class="reqn">1 \times</code> should be
dropped from the resulting expressions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is just a utility with the same arguments as
<code><a href="graphics.html#topic+axTicks">axTicks</a></code>, a wrapper <code><a href="#topic+pretty10exp">pretty10exp</a>(at, *)</code>.
</p>


<h3>Value</h3>

<p>an expression of the same length as <code>x</code>, with elements of the
form <code>a %*% 10 ^ k</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#topic+pretty10exp">pretty10exp</a></code>;
<code><a href="#topic+eaxis">eaxis</a></code>,   <code><a href="graphics.html#topic+axis">axis</a></code>, <code><a href="graphics.html#topic+axTicks">axTicks</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1e7*(-10:50)
y &lt;- dnorm(x, m=10e7, s=20e7)
plot(x,y)## not really nice,  the following is better:

## For horizontal y-axis labels, need more space:
op &lt;- par(mar= .1+ c(5,5,4,1))
plot(x,y, axes= FALSE, frame=TRUE)
aX &lt;- axTicks(1); axis(1, at=aX, label= axTexpr(1, aX))
## horizontal labels on y-axis:
aY &lt;- axTicks(2); axis(2, at=aY, label= axTexpr(2, aY), las=2)
par(op)

### -- only 'x' and using log-scale there:
plot(x,y, xaxt= "n", log = "x")
aX &lt;- axTicks(1); axis(1, at=aX, label= axTexpr(1, aX))

## Now an "engineer's version" ( more ticks; only label "10 ^ k" ) :

axp &lt;- par("xaxp") #-&gt; powers of 10 *inside* 'usr'
axp[3] &lt;- 1 # such that only 10^. are labeled
aX &lt;- axTicks(1, axp = axp)
xu &lt;- 10 ^ par("usr")[1:2]
e10 &lt;- c(-1,1) + round(log10(axp[1:2])) ## exponents of 10 *outside* 'usr'
v &lt;- c(outer(1:9, e10[1]:e10[2], function(x,E) x * 10 ^ E))
v &lt;- v[xu[1] &lt;= v &amp; v &lt;= xu[2]]

plot(x,y, xaxt= "n", log = "x", main = "engineer's version of x - axis")
axis(1, at = aX, label = axTexpr(1, aX, drop.1=TRUE)) # 'default'
axis(1, at = v,  label = FALSE, tcl = 2/3 * par("tcl"))
</code></pre>

<hr>
<h2 id='cairoSwd'>Cairo PDF Graphics Device useful for Sweave</h2><span id='topic+cairoSwd'></span>

<h3>Description</h3>

<p>Provides a graphics device for Sweave, based on
<code><a href="grDevices.html#topic+cairo_pdf">cairo_pdf</a></code>. The advantage of <code>cairoSwd()</code> compared
to <code><a href="grDevices.html#topic+pdf">pdf</a>()</code> is its support of Unicode characters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cairoSwd(name, width, height, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cairoSwd_+3A_name">name</code></td>
<td>
<p>file name prefix to which &lsquo;<span class="file">.pdf</span>&rsquo; will be appended.</p>
</td></tr>
<tr><td><code id="cairoSwd_+3A_width">width</code>, <code id="cairoSwd_+3A_height">height</code></td>
<td>
<p>in inches, see <code><a href="grDevices.html#topic+cairo_pdf">cairo_pdf</a></code>.</p>
</td></tr>
<tr><td><code id="cairoSwd_+3A_...">...</code></td>
<td>
<p>further arguments, passed to <code><a href="grDevices.html#topic+cairo_pdf">cairo_pdf</a>()</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>Sweave devices need to have an argument list as above.
</p>
<p>Usage in a Sweave chunk:
</p>
<pre>
&lt;&lt;some-plot, fig=TRUE, grdevice=cairoSwd&gt;&gt;=
</pre>


<h3>Author(s)</h3>

<p>Alain Hauser</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+pdf">pdf</a></code>, <code><a href="grDevices.html#topic+cairo_pdf">cairo_pdf</a></code>, <code><a href="utils.html#topic+Sweave">Sweave</a></code>.
</p>

<hr>
<h2 id='capture.and.write'>Capture output and Write / Print First and Last Parts</h2><span id='topic+capture.and.write'></span>

<h3>Description</h3>

<p>Capture output and print first and last parts, eliding
middle parts.  Particularly useful for teaching purposes, and, e.g.,
in Sweave (<code><a href="utils.html#topic+RweaveLatex">RweaveLatex</a></code>).
</p>
<p>By default, when <code>middle = NA</code>, <code>capture.output(EXPR, first, last)</code>
basically does
</p>
<pre>
    co &lt;- capture.output(EXPR)
    writeLines(head(co, first))
    cat( ... dotdots ...)
    writeLines(tail(co, last))
  </pre>


<h3>Usage</h3>

<pre><code class='language-R'>capture.and.write(EXPR, first, last = 2, middle = NA,
                  i.middle, dotdots = " ....... ", n.dots = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="capture.and.write_+3A_expr">EXPR</code></td>
<td>
<p>the (literal) expression the output of which is to be
captured.</p>
</td></tr>
<tr><td><code id="capture.and.write_+3A_first">first</code></td>
<td>
<p>integer: how many lines should be printed at beginning.</p>
</td></tr>
<tr><td><code id="capture.and.write_+3A_last">last</code></td>
<td>
<p>integer: how many lines should be printed at the end.</p>
</td></tr>
<tr><td><code id="capture.and.write_+3A_middle">middle</code></td>
<td>
<p>numeric (or NA logical):</p>
</td></tr>
<tr><td><code id="capture.and.write_+3A_i.middle">i.middle</code></td>
<td>
<p>index start of middle part</p>
</td></tr>
<tr><td><code id="capture.and.write_+3A_dotdots">dotdots</code></td>
<td>
<p>string to be used for elided lines</p>
</td></tr>
<tr><td><code id="capture.and.write_+3A_n.dots">n.dots</code></td>
<td>
<p>number of <code>dotdots</code> lines added between parts.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return value of <code><a href="utils.html#topic+capture.output">capture.output</a>(EXPR)</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, ETH Zurich</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+head">head</a></code>, <code><a href="utils.html#topic+tail">tail</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(0, 10, by = .1)

## for matrix, dataframe, .. first lines include a header line:
capture.and.write( cbind(x, log1p(exp(x))),  first = 5)

## first, *middle* and last :
capture.and.write( cbind(x, x^2, x^3), first = 4, middle = 3, n.dots= 1)
</code></pre>

<hr>
<h2 id='col01scale'>Matrix Scaling Utilities</h2><span id='topic+col01scale'></span><span id='topic+colcenter'></span>

<h3>Description</h3>

<p><code>col01scale</code> and <code>colcenter</code> (re)scale the columns of a
matrix.  These are simple one-line utilities, mainly with a didactical
purpose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colcenter (mat)
col01scale(mat, scale.func = function(x) diff(range(x)), location.func = mean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col01scale_+3A_mat">mat</code></td>
<td>
<p>numeric matrix, to rescaled.</p>
</td></tr>
<tr><td><code id="col01scale_+3A_scale.func">scale.func</code>, <code id="col01scale_+3A_location.func">location.func</code></td>
<td>
<p>two functions mapping a numeric
vector to a single number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with the same attributes as the input <code>mat</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p>The standard <span class="rlang"><b>R</b></span> function <code><a href="base.html#topic+scale">scale</a>()</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See the simple function definitions:

colcenter ## simply one line

col01scale# almost as simple
</code></pre>

<hr>
<h2 id='compresid2way'>Plot Components + Residuals for Two Factors</h2><span id='topic+compresid2way'></span>

<h3>Description</h3>

<p>For an analysis of variance or regression with (at least) two factors:
Plot components + residuals for two factors according to Tukey's
&ldquo;forget-it plot&rdquo;. Try it!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compresid2way(aov, data=NULL, fac=1:2, label = TRUE, numlabel = FALSE,
             xlab=NULL, ylab=NULL, main=NULL,
             col=c(2,3,4,4), lty=c(1,1,2,4), pch=c(1,2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compresid2way_+3A_aov">aov</code></td>
<td>
<p>either an <code><a href="stats.html#topic+aov">aov</a></code> object with a formula of the form
<code>y ~ a + b</code>, where  <code>a</code>  and  <code>b</code>  are factors,
or such a formula.</p>
</td></tr>
<tr><td><code id="compresid2way_+3A_data">data</code></td>
<td>
<p>data frame containing  <code>a</code>  and  <code>b</code>.</p>
</td></tr>
<tr><td><code id="compresid2way_+3A_fac">fac</code></td>
<td>
<p>the two factors used for plotting.  Either column numbers or
names for argument <code>data</code>.</p>
</td></tr>
<tr><td><code id="compresid2way_+3A_label">label</code></td>
<td>
<p>logical indicating if levels of factors should be shown
in the plot.</p>
</td></tr>
<tr><td><code id="compresid2way_+3A_numlabel">numlabel</code></td>
<td>
<p>logical indicating if effects of factors will be shown
in the plot.</p>
</td></tr>
<tr><td><code id="compresid2way_+3A_xlab">xlab</code>, <code id="compresid2way_+3A_ylab">ylab</code>, <code id="compresid2way_+3A_main">main</code></td>
<td>
<p>the usual <code><a href="graphics.html#topic+title">title</a></code> components, here
with a non-trivial default constructed from <code>aov</code> and the
component factors used.</p>
</td></tr>
<tr><td><code id="compresid2way_+3A_col">col</code>, <code id="compresid2way_+3A_lty">lty</code>, <code id="compresid2way_+3A_pch">pch</code></td>
<td>
<p>colors, line types, plotting characters to be used
for plotting [1] positive residuals, [2] negative residuals,
[3] grid, [4] labels.  If <code>pch</code> is sufficiently long, it will be used
as the list of individual symbols for plotting the y values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a two-way analysis of variance, the plot shows the additive
components of the fits for the two factors by the intersections of a
grid, along with the residuals.
The observed values of the target variable are identical to the
vertical coordinate.
</p>
<p>The application of the function has been extended to cover more
complicated models. The components of the fit for two factors are
shown as just described, and the residuals are added. The result is a
&ldquo;component plus residual&rdquo; plot for two factors in one display.
</p>


<h3>Value</h3>

<p>Invisibly, a list with components
</p>
<table>
<tr><td><code>compy</code></td>
<td>
<p>data.frame containing the component effects of the two
factors, and combined effects plus residual</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients: Intercept and effects of the factors</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Werner Stahel <a href="mailto:stahel@stat.math.ethz.ch">stahel@stat.math.ethz.ch</a></p>


<h3>References</h3>

<p>F. Mosteller and J. W. Tukey (1977)
<em>Data Analysis and Regression: A Second Course in Statistics</em>.
Addison-Wesley, Reading, Mass., p. 176.
</p>
<p>John W. Tukey (1977)
<em>Exploratory Data Analysis</em>.
Addison-Wesley, Reading, Mass., p. 381.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+interaction.plot">interaction.plot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## From Venables and Ripley (2002) p.165.
 N &lt;- c(0,1,0,1,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,1,1,0,0)
 P &lt;- c(1,1,0,0,0,1,0,1,1,1,0,0,0,1,0,1,1,0,0,1,0,1,1,0)
 K &lt;- c(1,0,0,1,0,1,1,0,0,1,0,1,0,1,1,0,0,0,1,1,1,0,1,0)
 yield &lt;- c(49.5,62.8,46.8,57.0,59.8,58.5,55.5,56.0,62.8,55.8,69.5,55.0,
            62.0,48.8,45.5,44.2,52.0,51.5,49.8,48.8,57.2,59.0,53.2,56.0)
 npk &lt;- data.frame(block=gl(6,4), N=factor(N), P=factor(P),
                   K=factor(K), yield=yield)
 npk.cr &lt;- compresid2way(yield ~ N+P+K, data=npk, fac=c("P","K"))

 ## Fisher's 1926 data on potatoe yield
 data(potatoes)
 pot.aov &lt;- aov(yield ~ nitrogen+potash+pos, data=potatoes)
 compresid2way(pot.aov, pch=as.character(potatoes$pos))

 compresid2way(yield~nitrogen+potash, data=subset(potatoes, pos == 2))

 ## 2 x 3 design :
 data(warpbreaks)
 summary(fm1 &lt;- aov(breaks ~ wool + tension, data = warpbreaks))
 compresid2way(fm1)
</code></pre>

<hr>
<h2 id='cum.Vert.funkt'>Kumulative Verteilung Aufzeichnen</h2><span id='topic+cum.Vert.funkt'></span>

<h3>Description</h3>

<p>Kumulative Verteilung von <code>x</code> aufzeichnen, auf Wunsch auch Median
und Quartile.
</p>
<p>This is just an old German language version of
<code><a href="stats.html#topic+plot.ecdf">plot.ecdf</a>()</code> used for teaching at ETHZ.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cum.Vert.funkt(x, Quartile = TRUE, titel = TRUE, Datum = TRUE,
               rang.axis = n &lt;= 20, xlab = "", main = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cum.Vert.funkt_+3A_x">x</code></td>
<td>
<p>numeric vector whose empirical distribution should be plotted.</p>
</td></tr>
<tr><td><code id="cum.Vert.funkt_+3A_quartile">Quartile</code></td>
<td>
<p>logical indicating if all 3 non-trivial quartiles
should be drawn.</p>
</td></tr>
<tr><td><code id="cum.Vert.funkt_+3A_titel">titel</code></td>
<td>
<p>logical indicating if a German title should be drawn.</p>
</td></tr>
<tr><td><code id="cum.Vert.funkt_+3A_datum">Datum</code></td>
<td>
<p>logical indicating if <code><a href="#topic+p.datum">p.datum</a></code> should be added.</p>
</td></tr>
<tr><td><code id="cum.Vert.funkt_+3A_rang.axis">rang.axis</code></td>
<td>
<p>logical indicating if all the ranks should be marked at
the y-axis.  Defaults to true if there are not more than 20 observations.</p>
</td></tr>
<tr><td><code id="cum.Vert.funkt_+3A_xlab">xlab</code>, <code id="cum.Vert.funkt_+3A_main">main</code></td>
<td>
<p>x-axis label and main title; default to empty.</p>
</td></tr>
<tr><td><code id="cum.Vert.funkt_+3A_...">...</code></td>
<td>
<p>optional further arguments, passed to <code><a href="#topic+plotStep">plotStep</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the return value of <code><a href="#topic+plotStep">plotStep</a>()</code> which is called
internally, <em>invisibly</em>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler et al.</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotStep">plotStep</a></code> on which it is based; but you should
really consider using <code><a href="stats.html#topic+plot.ecdf">plot.ecdf</a>()</code> from the
<span class="pkg">stats</span> package instead of this.</p>


<h3>Examples</h3>

<pre><code class='language-R'>cum.Vert.funkt(runif(12))
cum.Vert.funkt(runif(20))

Z &lt;- rnorm(50)
cum.Vert.funkt(Z)
</code></pre>

<hr>
<h2 id='D1D2'>Numerical Derivatives of (x,y) Data via Smoothing Splines</h2><span id='topic+D1D2'></span>

<h3>Description</h3>

<p>Compute numerical derivatives of <code class="reqn">f()</code> given observations
<code>(x,y)</code>, using cubic smoothing splines with GCV, see
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>.  In other words, estimate <code class="reqn">f'()</code>
and/or <code class="reqn">f''()</code> for the model
</p>
<p style="text-align: center;"><code class="reqn">Y_i = f(x_i) + E_i, \ \ i = 1,\dots n,</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>D1D2(x, y, xout = x, spar.offset = 0.1384, deriv = 1:2, spl.spar = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="D1D2_+3A_x">x</code>, <code id="D1D2_+3A_y">y</code></td>
<td>
<p>numeric vectors of same length, supposedly from a model
<code>y ~ f(x)</code>.</p>
</td></tr>
<tr><td><code id="D1D2_+3A_xout">xout</code></td>
<td>
<p>abscissa values at which to evaluate the derivatives.</p>
</td></tr>
<tr><td><code id="D1D2_+3A_spar.offset">spar.offset</code></td>
<td>
<p>numeric fudge added to the smoothing parameter,
see <code>spl.par</code> below.</p>
</td></tr>
<tr><td><code id="D1D2_+3A_deriv">deriv</code></td>
<td>
<p>integer in <code>1:2</code> indicating which
derivatives are to be computed.</p>
</td></tr>
<tr><td><code id="D1D2_+3A_spl.spar">spl.spar</code></td>
<td>
<p>direct smoothing parameter for <code>smooth.spline</code>.
If it is <code>NULL</code> (as per default), the smoothing parameter used
will be <code>spar.offset + sp$spar</code>, where <code>sp$spar</code> is the GCV
estimated smoothing parameter, see <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is well known that for derivative estimation, the optimal smoothing
parameter is larger (more smoothing) than for the function itself.
<code>spar.offset</code> is really just a <em>fudge</em> offset added to the
smoothing parameter. Note that in <span class="rlang"><b>R</b></span>'s implementation of
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <code>spar</code> is really on the
<code class="reqn">\log\lambda</code> scale.
</p>
<p>When <code>deriv = 1:2</code> (as per default), both derivatives are
estimated with the <em>same</em> smoothing parameter which is suboptimal
for the single functions individually.  Another possibility is to call
<code>D1D2(*, deriv = k)</code> twice with <code>k = 1</code> and <code>k = 2</code> and
use a <em>larger</em> smoothing parameter for the second derivative.
</p>


<h3>Value</h3>

<p>a list with several components,
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>the abscissae values at which the derivative(s) are evaluated.</p>
</td></tr>
<tr><td><code>D1</code></td>
<td>
<p>if <code>deriv</code> contains 1, estimated values of
<code class="reqn">f'(x_i)</code> where <code class="reqn">x_i</code> are the values from <code>xout</code>.</p>
</td></tr>
<tr><td><code>D2</code></td>
<td>
<p>if <code>deriv</code> contains 2, estimated values of <code class="reqn">f''(x_i)</code>.</p>
</td></tr>
<tr><td><code>spar</code></td>
<td>
<p>the <b>s</b>moothing <b>par</b>ameter used in the (final)
<code>smooth.spline</code> call.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the equivalent <b>d</b>egrees of <b>f</b>reedom in that
<code>smooth.spline</code> call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler, in 1992 (for S).</p>


<h3>See Also</h3>

<p><code><a href="#topic+D2ss">D2ss</a></code> which calls <code>smooth.spline</code> twice,
first on <code>y</code>, then on the <code class="reqn">f'(x_i)</code> values;
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> on which it relies completely.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8840)
 x &lt;- runif(100, 0,10)
 y &lt;- sin(x) + rnorm(100)/4

 op &lt;- par(mfrow = c(2,1))
 plot(x,y)
 lines(ss &lt;- smooth.spline(x,y), col = 4)
 str(ss[c("df", "spar")])
 plot(cos, 0, 10, ylim = c(-1.5,1.5), lwd=2,
      main = expression("Estimating f'() : "~~ frac(d,dx) * sin(x) == cos(x)))
 offs &lt;- c(-0.1, 0, 0.1, 0.2, 0.3)
 i &lt;- 1
 for(off in offs) {
   d12 &lt;- D1D2(x,y, spar.offset = off)
   lines(d12$x, d12$D1, col = i &lt;- i+1)
 }
 legend(2,1.6, c("true cos()",paste("sp.off. = ", format(offs))), lwd=1,
        col = 1:(1+length(offs)), cex = 0.8, bg = NA)
 par(op)
</code></pre>

<hr>
<h2 id='D2ss'>Numerical Derivatives of (x,y) Data  (via Smoothing Splines)</h2><span id='topic+D2ss'></span><span id='topic+D1ss'></span><span id='topic+D1tr'></span>

<h3>Description</h3>

<p>Compute the numerical first or 2nd derivatives of <code class="reqn">f()</code> given
observations <code>(x[i], y ~= f(x[i]))</code>.
</p>
<p><code>D1tr</code> is the <em><b>tr</b>ivial</em> discrete first derivative
using simple difference ratios, whereas <code>D1ss</code> and <code>D2ss</code>
use cubic smoothing splines (see <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>)
to estimate first or second derivatives, respectively.
</p>
<p><code>D2ss</code> first uses <code>smooth.spline</code> for the first derivative
<code class="reqn">f'()</code> and then applies the same to the predicted values
<code class="reqn">\hat f'(t_i)</code> (where <code class="reqn">t_i</code> are the values of
<code>xout</code>) to find   <code class="reqn">\hat f''(t_i)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>D1tr(y, x = 1)

D1ss(x, y, xout = x, spar.offset = 0.1384, spl.spar=NULL)
D2ss(x, y, xout = x, spar.offset = 0.1384, spl.spar=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="D2ss_+3A_x">x</code>, <code id="D2ss_+3A_y">y</code></td>
<td>
<p>numeric vectors of same length, supposedly from a model
<code>y ~ f(x)</code>.  For <code>D1tr()</code>, <code>x</code> can have length one
and then gets the meaning of <code class="reqn">h = \Delta x</code>.</p>
</td></tr>
<tr><td><code id="D2ss_+3A_xout">xout</code></td>
<td>
<p>abscissa values at which to evaluate the derivatives.</p>
</td></tr>
<tr><td><code id="D2ss_+3A_spar.offset">spar.offset</code></td>
<td>
<p>numeric fudge added to the smoothing parameter(s),
see <code>spl.par</code> below.  Note that the current default is there
for historical reasons only, and we often  would recommend to use
<code>spar.offset = 0</code> instead.</p>
</td></tr>
<tr><td><code id="D2ss_+3A_spl.spar">spl.spar</code></td>
<td>
<p>direct smoothing parameter(s) for <code>smooth.spline</code>.
If it is <code>NULL</code> (as per default), the smoothing parameter used
will be <code>spar.offset + sp$spar</code>, where <code>sp$spar</code> is the GCV
estimated smoothing parameter for <em>both</em> smooths, see
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is well known that for derivative estimation, the optimal smoothing
parameter is larger (more smoothing needed) than for the function itself.
<code>spar.offset</code> is really just a <em>fudge</em> offset added to the
smoothing parameters. Note that in <span class="rlang"><b>R</b></span>'s implementation of
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <code>spar</code> is really on the
<code class="reqn">\log\lambda</code> scale.
</p>


<h3>Value</h3>

<p><code>D1tr()</code> and <code>D1ss()</code> return a numeric vector of the length
of <code>y</code> or <code>xout</code>, respectively.
</p>
<p><code>D2ss()</code> returns a list with components
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>the abscissae values (= <code>xout</code>) at which the
derivative(s) are evaluated.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>estimated values of <code class="reqn">f''(x_i)</code>.</p>
</td></tr>
<tr><td><code>spl.spar</code></td>
<td>
<p>numeric vector of length 2, contain the <code>spar</code>
arguments to the two <code>smooth.spline</code> calls.</p>
</td></tr>
<tr><td><code>spar.offset</code></td>
<td>
<p>as specified on input (maybe rep()eated to length 2).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler, in 1992 (for S).</p>


<h3>See Also</h3>

<p><code><a href="#topic+D1D2">D1D2</a></code> which directly uses the 2nd derivative of
the smoothing spline;  <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## First Derivative  --- spar.off = 0  ok "asymptotically" (?)
set.seed(330)
mult.fig(12)
for(i in 1:12) {
  x &lt;- runif(500, 0,10); y &lt;- sin(x) + rnorm(500)/4
  f1 &lt;- D1ss(x=x,y=y, spar.off=0.0)
  plot(x,f1, ylim = range(c(-1,1,f1)))
  curve(cos(x), col=3, add= TRUE)
}

 set.seed(8840)
 x &lt;- runif(100, 0,10)
 y &lt;- sin(x) + rnorm(100)/4

 op &lt;- par(mfrow = c(2,1))
 plot(x,y)
 lines(ss &lt;- smooth.spline(x,y), col = 4)
 str(ss[c("df", "spar")])
 xx &lt;- seq(0,10, len=201)
 plot(xx, -sin(xx), type = 'l', ylim = c(-1.5,1.5))
 title(expression("Estimating f''() :  " * frac(d^2,dx^2) * sin(x) == -sin(x)))
 offs &lt;- c(0.05, 0.1, 0.1348, 0.2)
 i &lt;- 1
 for(off in offs) {
   d12 &lt;- D2ss(x,y, spar.offset = off)
   lines(d12, col = i &lt;- i+1)
 }
 legend(2,1.6, c("true :  -sin(x)",paste("sp.off. = ", format(offs))), lwd=1,
        col = 1:(1+length(offs)), cex = 0.8, bg = NA)
 par(op)
</code></pre>

<hr>
<h2 id='Deprecated'>Deprecated 'sfsmisc' Functions</h2><span id='topic+pmax.sa'></span><span id='topic+pmin.sa'></span>

<h3>Description</h3>

<p>These functions are provided for compatibility with older versions of
the <span class="pkg">sfsmisc</span> package only, and may be defunct as soon as of the
next release.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmax.sa(scalar, arr)
pmin.sa(scalar, arr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Deprecated_+3A_scalar">scalar</code></td>
<td>
<p>numeric scalar.</p>
</td></tr>
<tr><td><code id="Deprecated_+3A_arr">arr</code></td>
<td>
<p>any numeric <span class="rlang"><b>R</b></span> object, typically array.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>pmax.sa(s, a)</code> and <code>pmin.sa(s, a)</code> return (more-dimensional) arrays.
These have been deprecated, because <code><a href="base.html#topic+pmax">pmax</a></code> and
<code><a href="base.html#topic+pmin">pmin</a></code> do so too, <b>if</b> the array is used as
<em>first</em> argument.
</p>

<hr>
<h2 id='diagDA'>Diagonal Discriminant Analysis</h2><span id='topic+diagDA'></span><span id='topic+dDA'></span><span id='topic+print.dDA'></span><span id='topic+predict.dDA'></span>

<h3>Description</h3>

<p>This function implements a simple Gaussian maximum likelihood
discriminant rule, for diagonal class covariance matrices.
</p>
<p>In machine learning lingo, this is called &ldquo;Naive Bayes&rdquo; (for
continuous predictors).  Note that naive Bayes is more general, as it
models discrete predictors as multinomial, i.e., binary predictor
variables as Binomial / Bernoulli.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dDA(x, cll, pool = TRUE)
## S3 method for class 'dDA'
predict(object, newdata, pool = object$pool, ...)
## S3 method for class 'dDA'
print(x, ...)

diagDA(ls, cll, ts, pool = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagDA_+3A_x">x</code>, <code id="diagDA_+3A_ls">ls</code></td>
<td>
<p>learning set data matrix, with rows corresponding to
cases (e.g., mRNA samples) and columns to predictor variables
(e.g., genes).</p>
</td></tr>
<tr><td><code id="diagDA_+3A_cll">cll</code></td>
<td>
<p>class labels for learning set, must be consecutive integers.</p>
</td></tr>
<tr><td><code id="diagDA_+3A_object">object</code></td>
<td>
<p>object of class <code>dDA</code>.</p>
</td></tr>
<tr><td><code id="diagDA_+3A_ts">ts</code>, <code id="diagDA_+3A_newdata">newdata</code></td>
<td>
<p>test set (prediction) data matrix, with rows corresponding
to cases and columns to predictor variables.</p>
</td></tr>
<tr><td><code id="diagDA_+3A_pool">pool</code></td>
<td>
<p>logical flag.  If true (by default), the covariance matrices
are assumed to be constant across classes and the discriminant rule
is linear in the data.  Otherwise (<code>pool= FALSE</code>), the
covariance matrices may vary across classes and the discriminant
rule is quadratic in the data.</p>
</td></tr>
<tr><td><code id="diagDA_+3A_...">...</code></td>
<td>
<p>further arguments passed to and from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dDA()</code> returns an object of class <code>dDA</code> for which there are
<code><a href="base.html#topic+print">print</a></code> and <code><a href="stats.html#topic+predict">predict</a></code> methods.  The latter
returns the same as <code>diagDA()</code>:
</p>
<p><code>diagDA()</code> returns an integer vector of class predictions for the
test set.
</p>


<h3>Author(s)</h3>


<p>Sandrine Dudoit, <a href="mailto:sandrine@stat.berkeley.edu">sandrine@stat.berkeley.edu</a>  and<br />
Jane Fridlyand, <a href="mailto:janef@stat.berkeley.edu">janef@stat.berkeley.edu</a> originally wrote
<code>stat.diag.da()</code> in CRAN package <a href="https://CRAN.R-project.org/package=sma"><span class="pkg">sma</span></a> which was modified
for speedup by Martin Maechler <a href="mailto:maechler@R-project.org">maechler@R-project.org</a>
who also introduced <code>dDA</code> etc.
</p>


<h3>References</h3>

<p>S. Dudoit, J. Fridlyand, and T. P. Speed. (2000)
Comparison of Discrimination Methods for the Classification of Tumors
Using Gene Expression Data.
(Statistics, UC Berkeley, June 2000, Tech Report #576)
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+lda">lda</a></code> and <code><a href="MASS.html#topic+qda">qda</a></code> from the
<a href="https://CRAN.R-project.org/package=MASS"><span class="pkg">MASS</span></a> package;
<code><a href="e1071.html#topic+naiveBayes">naiveBayes</a></code> from <a href="https://CRAN.R-project.org/package=e1071"><span class="pkg">e1071</span></a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## two artificial examples by Andreas Greutert:
d1 &lt;- data.frame(x = c(1, 5, 5, 5, 10, 25, 25, 25, 25, 29),
                 y = c(4, 1, 2, 4,  4,  4,     6:8,     7))
n.plot(d1)
library(cluster)
(cl1P &lt;- pam(d1,k=4)$cluster) # 4 surprising clusters
with(d1, points(x+0.5, y, col = cl1P, pch =cl1P))

i1 &lt;- c(1,3,5,6)
tr1 &lt;- d1[-i1,]
cl1. &lt;- c(1,2,1,2,1,3)
cl1  &lt;- c(2,2,1,1,1,3)
plot(tr1, cex=2, col = cl1, pch = 20+cl1)
(dd.&lt;- diagDA(tr1, cl1., ts = d1[ i1,]))# ok
(dd &lt;- diagDA(tr1, cl1 , ts = d1[ i1,]))# ok, too!
points(d1[ i1,], pch = 10, cex=3, col = dd)

## use new fit + predict instead :
(r1 &lt;- dDA(tr1, cl1))
(r1.&lt;- dDA(tr1, cl1.))
stopifnot(dd == predict(r1,  new = d1[ i1,]),
          dd.== predict(r1., new = d1[ i1,]))

plot(tr1, cex=2, col = cl1, bg = cl1, pch = 20+cl1,
     xlim=c(1,30), ylim= c(0,10))
xy &lt;- cbind(x= runif(500, min=1,max=30), y = runif(500, min=0, max=10))
points(xy, cex= 0.5, col = predict(r1, new = xy))
abline(v=c( mean(c(5,25)), mean(c(25,29))))

## example where one variable xj has  Var(xj) = 0:
x4 &lt;- matrix(c(2:4,7, 6,8,5,6,  7,2,3,1, 7,7,7,7), ncol=4)
y &lt;- c(2,2, 1,1)
m4.1 &lt;- dDA(x4, y, pool = FALSE)
m4.2 &lt;- dDA(x4, y, pool = TRUE)
xx &lt;- matrix(c(3,7,5,7), ncol=4)
predict(m4.1, xx)## gave integer(0) previously
predict(m4.2, xx)
</code></pre>

<hr>
<h2 id='diagX'>The &ldquo;Other&rdquo; Diagonal Matrix</h2><span id='topic+diagX'></span>

<h3>Description</h3>

<p>Compute the <em>other</em> diagonal identity matrix.
The result is basically a <em>fast</em> version of <code>diag(n)[, n:1]</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagX(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagX_+3A_n">n</code></td>
<td>
<p>positive integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric <code class="reqn">n \times n</code> matrix with many zeros &ndash; apart from
<code>1</code>s in the <em>other</em> diagonal.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 1992.</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+diag">diag</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>diagX(4)
for(m in 1:5)
  stopifnot(identical(diagX(m), diag(m)[, m:1, drop = FALSE]))
</code></pre>

<hr>
<h2 id='digitsBase'>Digit/Bit Representation of Integers in any Base</h2><span id='topic+digitsBase'></span><span id='topic+as.intBase'></span><span id='topic+bi2int'></span><span id='topic+as.integer.basedInt'></span><span id='topic+print.basedInt'></span>

<h3>Description</h3>

<p>Integer number representations in other Bases.
</p>
<p>Formally, for every element <code class="reqn">N =</code><code>x[i]</code>, compute the (vector
of) &ldquo;digits&rdquo; <code class="reqn">A</code> of the <code>base</code> <code class="reqn">b</code>
representation of the number <code class="reqn">N</code>, <code class="reqn">N = \sum_{k=0}^M  A_{M-k} b ^ k</code>.<br />
Revert such a representation to integers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>digitsBase(x, base = 2, ndigits = 1 + floor(1e-9 + log(max(x,1), base)))
## S3 method for class 'basedInt'
as.integer(x, ...)
## S3 method for class 'basedInt'
print(x, ...)

as.intBase(x, base = 2)
bi2int(xlist, base)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="digitsBase_+3A_x">x</code></td>
<td>
<p>For <code>digitsBase()</code>: non-negative integer (vector) whose
base <code>base</code> digits are wanted.
</p>
<p>For <code>as.intBase()</code>: <br /> a list of numeric vectors, a character
vector, or an integer matrix as returned by <code>digitsBase()</code>,
representing digits in base <code>base</code>.
</p>
</td></tr>
<tr><td><code id="digitsBase_+3A_base">base</code></td>
<td>
<p>integer, at least 2 specifying the base for representation.</p>
</td></tr>
<tr><td><code id="digitsBase_+3A_ndigits">ndigits</code></td>
<td>
<p>number of bits/digits to use.</p>
</td></tr>
<tr><td><code id="digitsBase_+3A_...">...</code></td>
<td>
<p>potential further arguments passed to methods, notably
<code><a href="base.html#topic+print">print</a></code>.</p>
</td></tr>
<tr><td><code id="digitsBase_+3A_xlist">xlist</code></td>
<td>
<p>a <code><a href="base.html#topic+list">list</a></code> of integer vectors with entries
typically in <code>0:(base-1)</code>, such as resulting from
<code>digitsBase()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>digitsBase()</code>, an object, say <code>m</code>, of class
<code>"basedInt"</code> which is basically a (<code>ndigits</code> x <code>n</code>)
<code><a href="base.html#topic+matrix">matrix</a></code> where <code>m[,i]</code> corresponds to <code>x[i]</code>,
<code>n &lt;- length(x)</code> and <code>attr(m,"base")</code> is the input
<code>base</code>.
</p>
<p><code>as.intBase()</code> and the <code><a href="base.html#topic+as.integer">as.integer</a></code> method for
<code>basedInt</code> objects return an <code><a href="base.html#topic+integer">integer</a></code> vector.
<br /> <code>bi2int()</code> is the low-level workhorse of <code>as.intBase()</code>.
</p>


<h3>Note</h3>

<p>Some of these functions existed under names <code>digits</code> and
<code>digits.v</code> in previous versions of the <span class="pkg">sfsmisc</span> package.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Dec 4, 1991 (for S-plus; then called <code>digits.v</code>).</p>


<h3>Examples</h3>

<pre><code class='language-R'>digitsBase(0:12, 8) #-- octal representation
empty.dimnames(digitsBase(0:33, 2)) # binary

## This may be handy for just one number (and default decimal):
digits &lt;- function(n, base = 10) as.vector(digitsBase(n, base = base))
digits(128982734)     # 1 2 8 9 8 2 7 3 4
digits(128, base = 8) # 2 0 0

## one way of pretty printing (base &lt;= 10!)
b2ch &lt;- function(db)
        noquote(gsub("^0+(.{1,})$"," \\1", 
                apply(db, 2, paste, collapse = "")))
b2ch(digitsBase(0:33, 2))  #-&gt;  0 1 10 11 100 101 ... 100001
b2ch(digitsBase(0:33, 4))  #-&gt;  0 1 2 3 10 11 12 13 20 ... 200 201

## Hexadecimal:
i &lt;- c(1:20, 100:106)
M &lt;- digitsBase(i, 16)
hexdig &lt;- c(0:9, LETTERS[1:6])
cM &lt;- hexdig[1 + M]; dim(cM) &lt;- dim(M)
b2ch(cM) #-&gt;  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F 10 11 ... 6A

## IP (Internet Protocol) numbers coding:  &lt;n&gt;.&lt;n&gt;.&lt;n&gt;.&lt;n&gt;  &lt;--&gt;  longinteger
ip_ntoa &lt;- function(n)
        apply(digitsBase(n, base = 256), 2, paste, collapse=".")
ip_ntoa(2130706430 + (0:9))# "126.255.255.254" ... "127.0.0.7"
## and the inverse:
ip_aton &lt;- function(a)
        bi2int(lapply(strsplit(a, ".", fixed=TRUE), as.integer), 256)

n &lt;- 2130706430 + (0:9)
head(ip &lt;- ip_ntoa(n))
head(ip_aton(ip))
stopifnot( n == ip_aton(ip_ntoa(n )),
          ip == ip_ntoa(ip_aton(ip)))


## Inverse of digitsBase() : as.integer method for the "basedInt" class
as.integer(M)
## or also as.intBase() working from strings:
(cb &lt;- apply(digitsBase(0:33, 4), 2, paste, collapse = ""))
##-&gt; "000" "001" ..... "200" "201"
all(0:33 == as.intBase(cb, base = 4))
</code></pre>

<hr>
<h2 id='Duplicated'>Counting-Generalization of duplicated()</h2><span id='topic+Duplicated'></span>

<h3>Description</h3>

<p>Duplicated() generalizes the <code><a href="base.html#topic+duplicated">duplicated</a></code> method for
vectors, by returning indices of &ldquo;equivalence classes&rdquo; for
duplicated entries and returning <code>nomatch</code> (<code>NA</code> by default)
for unique entries.
</p>
<p>Note that <code>duplicated()</code> is not <code>TRUE</code> for the first time a
duplicate appears, whereas <code>Duplicated()</code> only marks unique
entries with <code>nomatch</code> (<code>NA</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Duplicated(v, incomparables = FALSE, fromLast = FALSE, nomatch = NA_integer_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Duplicated_+3A_v">v</code></td>
<td>
<p>a vector, often character, factor, or numeric.</p>
</td></tr>
<tr><td><code id="Duplicated_+3A_incomparables">incomparables</code></td>
<td>
<p>a vector of values that cannot be compared,
passed to both <code><a href="base.html#topic+duplicated">duplicated</a>()</code> and <code><a href="base.html#topic+match">match</a>()</code>.
<code>FALSE</code> is a special value, meaning that all values can be
compared, and may be the only value accepted for methods other than
the default.  It will be coerced internally to the same type as <code>x</code>.</p>
</td></tr>
<tr><td><code id="Duplicated_+3A_fromlast">fromLast</code></td>
<td>
<p>logical indicating if duplication should be considered
from the reverse side, i.e., the last (or rightmost) of identical
elements would correspond to <code>duplicated=FALSE</code>.</p>
</td></tr>
<tr><td><code id="Duplicated_+3A_nomatch">nomatch</code></td>
<td>
<p>passed to <code><a href="base.html#topic+match">match</a>()</code>: the value to be
returned in the case when no match is found.  Note that it is
coerced to <code>integer</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an integer vector of the same length as <code>v</code>.  Can be used as a
<code><a href="base.html#topic+factor">factor</a></code>, e.g., in <code><a href="base.html#topic+split">split</a></code>,
<code><a href="base.html#topic+tapply">tapply</a></code>, etc.
</p>


<h3>Author(s)</h3>

<p>Christoph Buser and Martin Maechler, Seminar fuer Statistik, ETH
Zurich, Sep.2007</p>


<h3>See Also</h3>

<p><code><a href="#topic+uniqueL">uniqueL</a></code> (also in this <span class="pkg">sfsmisc</span> package);
<code><a href="base.html#topic+duplicated">duplicated</a></code>, <code><a href="base.html#topic+match">match</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(9:12, 1:4, 3:6, 0:7)
data.frame(x, dup = duplicated(x),
              dupL= duplicated(x, fromLast=TRUE),
              Dup = Duplicated(x),
              DupL= Duplicated(x, fromLast=TRUE))
</code></pre>

<hr>
<h2 id='eaxis'>Extended / Engineering Axis for Graphics</h2><span id='topic+eaxis'></span>

<h3>Description</h3>


<p>An extended <code><a href="graphics.html#topic+axis">axis</a>()</code> function which labels more
prettily, in particular for log-scale axes.
</p>
<p>It  makes use of <a href="grDevices.html#topic+plotmath">plotmath</a> or (LaTeX) <code><a href="base.html#topic+expression">expression</a></code>s of
the form <code class="reqn">k \times 10^k</code> for labeling a
log-scaled axis and when otherwise exponential formatting would be
used (see <code><a href="#topic+pretty10exp">pretty10exp</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eaxis(side, at = if(log) axTicks(side, axp=axp, log=log, nintLog=nintLog)
                 else    axTicks(side, axp=axp, log=log),
      labels = NULL, log = NULL,
      use.expr = log || format.info(as.numeric(at), digits=7)[3] &gt; 0,
      f.smalltcl = 3/5, at.small = NULL, small.mult = NULL, equidist.at.tol = 0.002,
      small.args = list(),
      draw.between.ticks = TRUE, between.max = 4,
      outer.at = TRUE, drop.1 = TRUE, sub10 = FALSE, las = 1,
      nintLog = max(12, par("lab")[2 - is.x]),
      axp = NULL, n.axp = NULL, max.at = Inf,
      lab.type = "plotmath", lab.sep = "cdot",
      ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eaxis_+3A_side">side</code></td>
<td>
<p>integer in 1:4, specifying side of <code><a href="graphics.html#topic+axis">axis</a></code>.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_at">at</code></td>
<td>
<p>numeric vector of (&ldquo;normalsized&rdquo;) tick locations; by
default <code><a href="graphics.html#topic+axTicks">axTicks</a>(side, ..)</code>, i.e., the same as
<code><a href="graphics.html#topic+axis">axis</a>()</code> would use.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_labels">labels</code></td>
<td>
<p><code>NULL</code> (default), <code><a href="base.html#topic+logical">logical</a></code>,
<code>character</code> or <code>expression</code>, as in <code><a href="graphics.html#topic+axis">axis</a>()</code>;
in addition, if <code>NA</code>, <code>labels = TRUE</code> is passed to
<code><a href="graphics.html#topic+axis">axis</a>()</code>, i.e. <code><a href="#topic+pretty10exp">pretty10exp</a></code> is <em>not</em>
used.  Use <code>FALSE</code> to suppress any labeling.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_log">log</code></td>
<td>
<p>logical or <code>NULL</code> specifying if log-scale should be
used; the default depends on the current plot's axis.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_use.expr">use.expr</code></td>
<td>
<p>logical specifying if <code><a href="#topic+pretty10exp">pretty10exp</a>(.)</code> should
be used for constructing <code>labels</code> when they are <code>NULL</code>.  The
default is typically good enough, but you may occasionally <em>force</em>
<code>use.expr = TRUE</code>.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_f.smalltcl">f.smalltcl</code></td>
<td>
<p>factor specifying the lengths of the small ticks in
proportion to the normalsized, labeled ticks.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_at.small">at.small</code></td>
<td>
<p>locations of <em>small</em> ticks; the default,
<code>NULL</code>, uses <code>small.mult</code> and constructs &ldquo;smart&rdquo;
locations.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_small.mult">small.mult</code></td>
<td>
<p>positive integer (or <code>NULL</code>), used when
<code>at.small</code> is NULL to indicate which multiples of
<code>at</code> (typically <code><a href="graphics.html#topic+axTicks">axTicks</a>()</code>) should be used as
&ldquo;small ticks&rdquo;.  The default <code>NULL</code> will use <code>9</code> in
the log case and a number in 2:5 otherwise.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_equidist.at.tol">equidist.at.tol</code></td>
<td>
<p>a small positive number, a tolerance to be used
for checking equidistant <code>at</code> values.  Used to be hardwired at
<code>.001</code> which was seen to be too small; increase it when necessary.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_small.args">small.args</code></td>
<td>
<p>optional <code><a href="base.html#topic+list">list</a></code> of further arguments to
the (second) <code><a href="graphics.html#topic+axis">axis</a>()</code> call which draws the <em>small</em> ticks.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_draw.between.ticks">draw.between.ticks</code></td>
<td>
<p>(only if <code>log</code> is true): logical indicating
that possible (non-small) ticks between the labeled (via <code>at</code>)
ones should be drawn as well (and possibly also used for <code>at.small</code>
construction), see also <code>between.max</code>.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_between.max">between.max</code></td>
<td>
<p>(only if <code>log</code> and <code>draw.between.ticks</code>
are true): integer indicating ticks should be drawn (approximately)
between the labeled ones.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_outer.at">outer.at</code></td>
<td>
<p>logical specifying that <code>at.small</code> should also be
constructed outside the <code>at</code> range, but still inside the
corresponding <code><a href="graphics.html#topic+par">par</a>("usr")</code>.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_drop.1">drop.1</code></td>
<td>
<p>logical specifying if <code class="reqn">1 \times</code> should be dropped
from labels, passed to <code><a href="#topic+pretty10exp">pretty10exp</a>()</code>.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_sub10">sub10</code></td>
<td>
<p>logical, integer (of length 1 or 2) or <code>"10"</code>, indicating if
some <code class="reqn">10^k</code> should be simplified to &ldquo;traditional&rdquo;
formats, see <code><a href="#topic+pretty10exp">pretty10exp</a></code>.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_nintlog">nintLog</code></td>
<td>
<p>only used in <span class="rlang"><b>R</b></span> &gt; 2.13.x, when <code>log</code> is true:
approximate (lower bound on) number of intervals for log scaling.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_axp">axp</code></td>
<td>
<p>to be passed to <code><a href="graphics.html#topic+axTicks">axTicks</a>()</code> if <code>at</code> is not
specified.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_n.axp">n.axp</code></td>
<td>
<p>to be set to <code>axp[3]</code> when <code>axp</code> and <code>at</code>
are not specified, in order to tweak the <em>number</em> of (non-small)
tick marks produced from <code><a href="graphics.html#topic+axTicks">axTicks</a>(..)</code>, notably when
<code>log</code> is true, set <code>n.axp</code> to 1, 2, or 3:
</p>

<dl>
<dt>1:</dt><dd><p>will produce tick marks at <code class="reqn">10^j</code> for integer <code class="reqn">j</code>,</p>
</dd>
<dt>2:</dt><dd><p>gives marks  <code class="reqn">k 10^j</code> with <code class="reqn">k \in \{1, 5\}</code>,</p>
</dd>
<dt>3:</dt><dd><p>gives marks  <code class="reqn">k 10^j</code> with <code class="reqn">k \in \{1, 2, 5\}</code></p>
</dd>
</dl>
<p> see <code>'xaxp'</code> on the <code><a href="graphics.html#topic+par">par</a></code> help page.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_max.at">max.at</code></td>
<td>
<p>maximal number of <code>at</code> values to be used
effectively.  If you don't specify <code>at</code> yourself carefully, it
is recommended to set this to something like <code>25</code>, but this is
not the default, for back compatibility reasons.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_las">las</code>, <code id="eaxis_+3A_...">...</code></td>
<td>
<p>arguments passed to (the first) <code><a href="graphics.html#topic+axis">axis</a></code>
call.  Note that the default <code>las = 1</code> differs from
<code>axis</code>'s default <code>las = 0</code>.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_lab.type">lab.type</code></td>
<td>
<p>string, passed to <code><a href="#topic+pretty10exp">pretty10exp</a></code> to choose
between default <code><a href="grDevices.html#topic+plotmath">plotmath</a></code> or LaTeX label format.</p>
</td></tr>
<tr><td><code id="eaxis_+3A_lab.sep">lab.sep</code></td>
<td>
<p>separator between mantissa and exponent for LaTeX labels,
see <code><a href="#topic+pretty10exp">pretty10exp</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+axis">axis</a></code>,
<code><a href="graphics.html#topic+axTicks">axTicks</a></code>,
<code><a href="#topic+axTexpr">axTexpr</a></code>,
<code><a href="#topic+pretty10exp">pretty10exp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- lseq(1e-10, 0.1, length = 201)
plot(x, pt(x, df=3), type = "l", xaxt = "n", log = "x")
eaxis(1)
## without small ticks:
eaxis(3, at.small=FALSE, col="blue")

## If you like the ticks, but prefer traditional (non-"plotmath") labels:
plot(x,  gamma(x),   type = "l", log = "x")
eaxis(1, labels=NA)

x &lt;- lseq(.001, 0.1, length = 1000)
plot(x, sin(1/x)*x, type = "l", xaxt = "n", log = "x")
eaxis(1)
eaxis(3, n.axp = 1)# -&gt; xaxp[3] = 1:  only  10^j (main) ticks

## non- log-scale : draw small ticks, but no "10^k" if not needed:
x &lt;- seq(-100, 100, length = 1000)
plot(x, sin(x)/x, type = "l", xaxt = "n")
eaxis(1)           # default -&gt; {1, 2, 5} * 10^j  ticks
eaxis(3, n.axp = 2)# -&gt; xaxp[3] := 2 -- approximately two (main) ticks

x &lt;- seq(-1, 1, length = 1000)
plot(x, sin(x)/x, type = "l", xaxt = "n")
eaxis(1, small.args = list(col="blue"))

x &lt;- x/1000
plot(x, 1-sin(x)/x, type = "l", xaxt = "n", yaxt = "n")
eaxis(1)
eaxis(2)
## more labels than default:
op &lt;- par(lab=c(10,5,7))
plot(x, sin(x)/x, type = "l", xaxt = "n")
eaxis(1) # maybe (depending on your canvas), there are too many,
## in that case, maybe use
plot(x, sin(x)/x, type = "l", xaxt = "n")
eaxis(1, axTicks(1)[c(TRUE,FALSE)]) # drop every 2nd label
eaxis(3, labels=FALSE)

## ore use 'max.at' which thins as well:
plot(x, sin(x)/x, type = "l", xaxt = "n")
eaxis(1, max.at=6)
par(op)

### Answering R-help "How do I show real values on a log10 histogram", 26 Mar 2013
## the data:
       set.seed(1); summary(x &lt;- rlnorm(100, m = 2, sdl = 3))
## the plot (w/o  x-axis) :
       r &lt;- hist(log10(x), xaxt = "n", xlab = "x [log scale]")
## the nice axis:
       axt &lt;- axTicks(1)
       eaxis(1, at = axt, labels = pretty10exp(10^axt, drop.1=TRUE))
## Additionally demo'ing   'sub10' options:
       plot(r, xaxt="n")
       eaxis(1, at = axt, labels = pretty10exp(10^axt, drop.1=TRUE, sub10 = 2))
## or
       plot(r, xaxt="n")
       eaxis(1, at = axt, labels = pretty10exp(10^axt, drop.1=TRUE, sub10 = "10"))
## or
       plot(r, xaxt="n")
       eaxis(1, at = axt, labels = pretty10exp(10^axt, drop.1=TRUE, sub10 = c(-2, 2)))
</code></pre>

<hr>
<h2 id='ecdf.ksCI'>Plot Empirical Distribution Function With 95% Confidence Curves</h2><span id='topic+ecdf.ksCI'></span>

<h3>Description</h3>

<p>Plots the empirical (cumulative) distribution function (ECDF) for
univariate data, together with upper and lower simultaneous 95% confidence curves,
computed via Kolmogorov-Smirnov' <code class="reqn">D</code>, see <code><a href="#topic+KSd">KSd</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecdf.ksCI(x, main = NULL, sub = NULL, xlab = deparse(substitute(x)),
          ci.col = "red", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecdf.ksCI_+3A_x">x</code></td>
<td>
<p><code>x</code> numerical vector of observations.</p>
</td></tr>
<tr><td><code id="ecdf.ksCI_+3A_main">main</code>, <code id="ecdf.ksCI_+3A_sub">sub</code>, <code id="ecdf.ksCI_+3A_xlab">xlab</code></td>
<td>
<p>arguments passed to <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="ecdf.ksCI_+3A_ci.col">ci.col</code></td>
<td>
<p>color for confidence interval lines.</p>
</td></tr>
<tr><td><code id="ecdf.ksCI_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code><a href="stats.html#topic+plot.stepfun">plot.stepfun</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing. Used for its side effect, to produce a plot.
</p>


<h3>Note</h3>

<p>Presently, will only work if <code>length(x)</code> &gt; 9. </p>


<h3>Author(s)</h3>

<p>Kjetil Halvorsen</p>


<h3>References</h3>

<p>Bickel and Doksum, see <code><a href="#topic+KSd">KSd</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ecdf">ecdf</a></code> and <code><a href="stats.html#topic+plot.stepfun">plot.stepfun</a></code> in standard
<span class="rlang"><b>R</b></span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ecdf.ksCI( rchisq(50,3) )
</code></pre>

<hr>
<h2 id='ellipsePoints'>Compute Radially Equispaced Points on Ellipse</h2><span id='topic+ellipsePoints'></span>

<h3>Description</h3>

<p>Compute points on (the boundary of) an ellipse which is given by
elementary geometric parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipsePoints(a, b, alpha = 0, loc = c(0, 0), n = 201, keep.ab.order=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipsePoints_+3A_a">a</code>, <code id="ellipsePoints_+3A_b">b</code></td>
<td>
<p>length of half axes in (x,y) direction.  Note that
<code class="reqn">(a,b)</code> is equivalent to <code class="reqn">(b,a)</code> <em>unless</em>
<code>keep.ab.order=TRUE</code>.</p>
</td></tr>
<tr><td><code id="ellipsePoints_+3A_alpha">alpha</code></td>
<td>
<p>angle (in degrees) giving the orientation of the ellipse,
i.e., the original (x,y)-axis ellipse is rotated by <code>angle</code>.</p>
</td></tr>
<tr><td><code id="ellipsePoints_+3A_loc">loc</code></td>
<td>
<p>center (LOCation) of the ellipse.</p>
</td></tr>
<tr><td><code id="ellipsePoints_+3A_n">n</code></td>
<td>
<p>number of points to generate.</p>
</td></tr>
<tr><td><code id="ellipsePoints_+3A_keep.ab.order">keep.ab.order</code></td>
<td>
<p>logical indicating if <code class="reqn">(a,b)</code> should be
considered <em>ordered</em>.  When <code>FALSE</code>, as per default,
the orientation of the ellipse is solely determined by <code>alpha</code>.
</p>
<p>Note that <code>keep.ab.order = TRUE</code> seems a more natural default,
but <code>FALSE</code> is there for back-compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of dimension <code>n x 2</code>, each row containing the
(x,y) coordinates of a point.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, March 2002.</p>


<h3>See Also</h3>

<p>the <a href="https://CRAN.R-project.org/package=ellipse"><span class="pkg">ellipse</span></a> package and <code><a href="cluster.html#topic+ellipsoidhull">ellipsoidhull</a></code>
and <code><a href="cluster.html#topic+ellipsoidPoints">ellipsoidPoints</a></code>
in the <a href="https://CRAN.R-project.org/package=cluster"><span class="pkg">cluster</span></a> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple Ellipse, centered at (0,0), x-/y- axis parallel:
ep &lt;- ellipsePoints(5,2)
str(ep)
plot(ep, type="n",asp=1) ; polygon(ep, col = 2)
## (a,b) = (2,5)  is equivalent to (5,2) :
lines(ellipsePoints(2,5), lwd=2, lty=3)
## keep.order=TRUE : Now, (2,5) are axes in x- respective y- direction:
lines(ellipsePoints(2,5, keep.ab.order=TRUE), col="blue")

## rotate by 30 degrees :
plot(ellipsePoints(5,2, alpha = 30), asp=1)
abline(h=0,v=0,col="gray")
abline(a=0,b= tan( 30 *pi/180), col=2, lty = 2)
abline(a=0,b= tan(120 *pi/180), col=3, lty = 2)

## NB: use x11(type = "Xlib") for the following if you can
if(dev.interactive(TRUE)) {
  ## Movie : rotating ellipse  :
  nTurns &lt;- 4 # #{full 360 deg turns}
  for(al in 1:(nTurns*360)) {
      ep &lt;- ellipsePoints(3,6, alpha=al, loc = c(5,2))
      plot(ep,type="l",xlim=c(-1,11),ylim=c(-4,8),
	   asp=1, axes = FALSE, xlab="", ylab="")
  }

  ## Movie : rotating _filled_ ellipse {less nice to look at}
  for(al in 1:180) {
      ep &lt;- ellipsePoints(3,6, alpha=al, loc = c(5,2))
      plot(ep,type="n",xlim=c(-1,11),ylim=c(-4,8),
	   asp=1, axes = FALSE, xlab="", ylab="")
      polygon(ep,col=2,border=3,lwd=2.5)
  }
}# only if interactive
</code></pre>

<hr>
<h2 id='empty.dimnames'>Empty Dimnames of an Array</h2><span id='topic+empty.dimnames'></span>

<h3>Description</h3>

<p>Remove all dimension names from an array for compact printing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empty.dimnames(a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="empty.dimnames_+3A_a">a</code></td>
<td>
<p>an <code><a href="base.html#topic+array">array</a></code>, i.e., as special case a matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>a</code> with its dimnames replaced by empty character strings.
</p>


<h3>Author(s)</h3>

<p>Bill Venables / Martin Maechler, Sept 1993.</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+unname">unname</a></code> <em>removes</em> the dimnames.</p>


<h3>Examples</h3>

<pre><code class='language-R'>empty.dimnames(diag(5)) # looks much nicer

(a &lt;- matrix(-9:10, 4,5))
empty.dimnames(a) # nicer, right?
</code></pre>

<hr>
<h2 id='errbar'>Scatter Plot with Error Bars</h2><span id='topic+errbar'></span>

<h3>Description</h3>

<p>Draws a scatter plot, adding vertical &ldquo;error bars&rdquo; to all the points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>errbar(x, y, yplus, yminus, cap = 0.015,
       ylim = range(y,yplus,yminus),
       xlab= deparse(substitute(x)),
       ylab= deparse(substitute(y)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="errbar_+3A_x">x</code></td>
<td>
<p>vector of x values.</p>
</td></tr>
<tr><td><code id="errbar_+3A_y">y</code></td>
<td>
<p>vector of y values.</p>
</td></tr>
<tr><td><code id="errbar_+3A_yplus">yplus</code></td>
<td>
<p>vector of y values: the tops of the error bars.</p>
</td></tr>
<tr><td><code id="errbar_+3A_yminus">yminus</code></td>
<td>
<p>vector of y values: the bottoms of the error bars.</p>
</td></tr>
<tr><td><code id="errbar_+3A_cap">cap</code></td>
<td>
<p>the width of the little lines at the tops and bottoms of
the error bars in units of the width of the plot.  Default is 0.015.</p>
</td></tr>
<tr><td><code id="errbar_+3A_ylim">ylim</code></td>
<td>
<p>(numeric of length 2): the y-axis extents with a sensible default.</p>
</td></tr>
<tr><td><code id="errbar_+3A_xlab">xlab</code>, <code id="errbar_+3A_ylab">ylab</code></td>
<td>
<p>axis labels for the plot, as in
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="errbar_+3A_...">...</code></td>
<td>
<p>Graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>) may also
be supplied as arguments to this function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Originally Charles Geyer, U.Chicago, early 1991; then Martin Mächler.</p>


<h3>See Also</h3>

<p><code><a href="Hmisc.html#topic+errbar">errbar</a></code> in package <a href="https://CRAN.R-project.org/package=Hmisc"><span class="pkg">Hmisc</span></a> is similar.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rnorm(10); d &lt;- 1 + .1*rnorm(10)
errbar(1:10, y, y + d, y - d, main="Error Bars example")
</code></pre>

<hr>
<h2 id='f.robftest'>Robust F-Test: Wald test for multiple coefficients of rlm() Object.</h2><span id='topic+f.robftest'></span>

<h3>Description</h3>

<p>Compute a robust F-Test, i.e., a Wald test for multiple coefficients
of an <code><a href="MASS.html#topic+rlm">rlm</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.robftest(object, var = -1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f.robftest_+3A_object">object</code></td>
<td>
<p>result of <code><a href="MASS.html#topic+rlm">rlm</a>()</code>.</p>
</td></tr>
<tr><td><code id="f.robftest_+3A_var">var</code></td>
<td>
<p>variables.  Either their names or their indices;  the
default, <code>-1</code> means all <em>but</em> the intercept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This builds heavily on <code><a href="MASS.html#topic+summary.rlm">summary.rlm</a>()</code>, the
<code><a href="base.html#topic+summary">summary</a></code> method for <code><a href="MASS.html#topic+rlm">rlm</a></code> results.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code>, hence with the standard print
methods for hypothesis tests.  This is basically a list with components
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the F statistic, according to ...</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>numerator and denominator degrees of freedom.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>(extracted from input <code>object</code>.)</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p><code>"two.sided"</code>, always.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the P-value, using an F-test on <code>statistic</code> and
<code>df[1:2]</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Werner Stahel, July 2000; updates by Martin Maechler.</p>


<h3>References</h3>

<p>FIXME &mdash; Need some here !
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+rlm">rlm</a></code>, <code><a href="stats.html#topic+summary.aov">summary.aov</a></code>, etc.</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require("MASS")) {
  ## same data as  example(rlm)
  data(stackloss)
  summary(rsl &lt;- rlm(stack.loss ~ ., stackloss))
  f.robftest(rsl)
 } else  " forget it "

</code></pre>

<hr>
<h2 id='factorize'>Prime Factorization of Integers</h2><span id='topic+factorize'></span>

<h3>Description</h3>

<p>Compute the prime factorization(s) of integer(s) <code>n</code>.
</p>









<h3>Usage</h3>

<pre><code class='language-R'>factorize(n, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factorize_+3A_n">n</code></td>
<td>
<p>vector of integers to factorize.</p>
</td></tr>
<tr><td><code id="factorize_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating if some progress information should
be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>works via <code><a href="#topic+primes">primes</a></code>, currently in a cheap way, sub-optimal
for large composite <code class="reqn">n</code>.
</p>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code> of the same length as <code>n</code>,
each element a 2-column matrix with column <code>"p"</code> the prime
factors and column~<code>"m"</code> their respective exponents (or
multiplities), i.e., for a prime number <code>n</code>, the resulting matrix
is <code>cbind(p = n, m = 1)</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Jan. 1996.</p>


<h3>See Also</h3>

<p><code><a href="#topic+primes">primes</a></code>.
</p>
<p>For factorization of moderately or really large numbers, see the <a href="https://CRAN.R-project.org/package=gmp"><span class="pkg">gmp</span></a>
package, and its <code><a href="gmp.html#topic+factorize">factorize</a>()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> factorize(47)
 factorize(seq(101, 120, by=2))
</code></pre>

<hr>
<h2 id='funEnv'>List-like Environment of Functions (and More)</h2><span id='topic+funEnv'></span>

<h3>Description</h3>

<p>Construct a &ldquo;list&rdquo;, really an <code><a href="base.html#topic+environment">environment</a></code>
typically of functions and optionally other <span class="rlang"><b>R</b></span> objects, where the
<code><a href="base.html#topic+function">function</a></code>s and <code><a href="stats.html#topic+formula">formula</a></code>s all
all share the same environment.
Consequently, the functions may call each other.
</p>
<p>On technical level, this is just a simple wrapper around
<code><a href="base.html#topic+list2env">list2env</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funEnv(..., envir = NULL, parent = parent.frame(),
       hash = (...length() &gt; 100), size = max(29L, ...length()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funEnv_+3A_...">...</code></td>
<td>
<p>an arbitrary <em>named</em> &ldquo;list&rdquo; of <span class="rlang"><b>R</b></span> objects,
typically including several <code><a href="base.html#topic+function">function</a></code>s.</p>
</td></tr>
<tr><td><code id="funEnv_+3A_envir">envir</code></td>
<td>
<p>an <code><a href="base.html#topic+environment">environment</a></code> or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="funEnv_+3A_parent">parent</code></td>
<td>
<p>(for the case <code>envir = NULL</code>): a parent frame aka
enclosing environment, see <code><a href="base.html#topic+new.env">new.env</a></code> and <code><a href="base.html#topic+list2env">list2env</a></code>.</p>
</td></tr>
<tr><td><code id="funEnv_+3A_hash">hash</code>, <code id="funEnv_+3A_size">size</code></td>
<td>
<p>(for the case <code>envir = NULL</code>): <code>hash</code> a
logical indicating if the created environment should use hashing,
and (<code>size</code>) the hash size, see <code><a href="base.html#topic+list2env">list2env</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="base.html#topic+environment">environment</a></code>, say <code>E</code>, containing the objects
from <code>...</code> (plus those in <code>envir</code>), and all function
objects' <code><a href="base.html#topic+environment">environment</a>()</code> is E.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+list2env">list2env</a></code>, <code><a href="base.html#topic+environment">environment</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ee &lt;- funEnv(f = function(x) g(2*(x+1)),
             g = function(y) hh(y+1),
            hh = function(u) u^2,
          info = "Some Information (not a function)")
ls(ee) # here the same as  names(ee)
## Check that it works: i.e., that "f sees g" and "g sees hh":
stopifnot(all.equal(ee$f(pi), (2*pi+3)^2))
ee$f(0:4) # [1]  9  25  49  81 121
</code></pre>

<hr>
<h2 id='hatMat'>Hat Matrix of a Smoother</h2><span id='topic+hatMat'></span>

<h3>Description</h3>

<p>Compute the hat matrix or smoother matrix, of &lsquo;any&rsquo; (linear) smoother,
smoothing splines, by default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hatMat(x, trace= FALSE,
       pred.sm = function(x, y, ...)
                 predict(smooth.spline(x, y, ...), x = x)$y,
       ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hatMat_+3A_x">x</code></td>
<td>
<p>numeric vector or matrix.</p>
</td></tr>
<tr><td><code id="hatMat_+3A_trace">trace</code></td>
<td>
<p>logical indicating if the whole hat matrix, or only its
trace, i.e. the sum of the diagonal values should be computed.</p>
</td></tr>
<tr><td><code id="hatMat_+3A_pred.sm">pred.sm</code></td>
<td>
<p>a function of at least two arguments <code>(x,y)</code>
which returns fitted values, i.e. <code class="reqn">\hat{y}</code>, of length
compatible to <code>x</code> (and <code>y</code>).</p>
</td></tr>
<tr><td><code id="hatMat_+3A_...">...</code></td>
<td>
<p>optionally further arguments to the smoother function
<code>pred.sm</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The hat matrix <code class="reqn">H</code> (if <code>trace = FALSE</code> as per default) or
a number, <code class="reqn">tr(H)</code>, the <em>trace</em> of <code class="reqn">H</code>, i.e.,
<code class="reqn">\sum_i H_{ii}</code>.
</p>
<p>Note that <code>dim(H) == c(n, n)</code> where <code>n &lt;- length(x)</code> also in
the case where some x values are duplicated (aka <em>ties</em>).
</p>


<h3>Author(s)</h3>

<p>Martin Maechler <a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a></p>


<h3>References</h3>

<p>Hastie and Tibshirani (1990).
<em>Generalized Additive Models</em>.
Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, etc.
Note the demo, <code>demo("hatmat-ex")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats) # for smooth.spline() or loess()

x1 &lt;- c(1:4, 7:12)
H1 &lt;- hatMat(x1, spar = 0.5) # default : smooth.spline()

matplot(x1, H1, type = "l", main = "columns of smoother hat matrix")

## Example 'pred.sm' arguments for hatMat() :
pspl &lt;-  function(x,y,...) predict(smooth.spline(x,y, ...), x = x)$y
pksm &lt;-  function(x,y,...) ksmooth(sort(x),y, "normal", x.points=x, ...)$y
## Rather than ksmooth():
if(require("lokern"))
  pksm2 &lt;- function(x,y,...) glkerns(x,y, x.out=x, ...)$est


## Explaining 'trace = TRUE'
all.equal(sum(diag((hatMat(c(1:4, 7:12), df = 4)))),
                    hatMat(c(1:4, 7:12), df = 4, trace = TRUE), tol = 1e-12)

## ksmooth() :
Hk &lt;- hatMat(x1, pr = pksm, bandwidth = 2)
cat(sprintf("df = %.2f\n", sum(diag(Hk))))
image(Hk)
Matrix::printSpMatrix(as(round(Hk, 2), "sparseMatrix"))

##---&gt;  see demo("hatmat-ex")  for more (and larger) examples
</code></pre>

<hr>
<h2 id='helppdf'>help() Type=&quot;pdf&quot; and View It</h2><span id='topic+helppdf'></span>

<h3>Description</h3>

<p>Utility to view PDF-rendered <code><a href="utils.html#topic+help">help</a></code> pages; particularly
useful in case they contain mathematical formulas or otherwise
sophisticated formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>helppdf(topic, viewer = getOption("pdfviewer"), quiet = !interactive(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="helppdf_+3A_topic">topic</code></td>
<td>
<p>the topic, passed to <code><a href="utils.html#topic+help">help</a>()</code>.</p>
</td></tr>
<tr><td><code id="helppdf_+3A_viewer">viewer</code></td>
<td>
<p>a pdf viewer; the default is typically what you want interactively.</p>
</td></tr>
<tr><td><code id="helppdf_+3A_quiet">quiet</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> indicating that nothing should be
printed to the console and the result should be returned as
<code><a href="base.html#topic+invisible">invisible</a>()</code>.</p>
</td></tr>
<tr><td><code id="helppdf_+3A_...">...</code></td>
<td>
<p>further optional arguments passed to <code>help()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the full path of the pdf file produced.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>, <code><a href="base.html#topic+system">system</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {
  ## Both calls work :
  helppdf(Normal)
  helppdf("NegBinomial")
} else if(.Platform$OS.type != "windows") { # batch mode (Windows often too slow for this)
  od &lt;- setwd(tempdir())
  ff &lt;- helppdf(Normal, viewer=NULL)
  stopifnot(file.exists(ff)) ; print(ff)
  setwd(od)# revert to previous dir.
}
</code></pre>

<hr>
<h2 id='histBxp'>Plot a Histogram and a Boxplot</h2><span id='topic+histBxp'></span>

<h3>Description</h3>

<p>Creates a histogram and a horizontal boxplot on the current graphics
device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>histBxp(x, nclass, breaks, probability=FALSE, include.lowest=TRUE,
         xlab = deparse(substitute(x)),
         ...,
         width=0.2, boxcol=3, medcol=2, medlwd=5, whisklty=2, staplelty=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="histBxp_+3A_x">x</code></td>
<td>
<p>numeric vector of data for histogram. Missing values
(<code>NA</code>s) are allowed.</p>
</td></tr>
<tr><td><code id="histBxp_+3A_nclass">nclass</code></td>
<td>

<p>recommendation for the number of classes (i.e., bars) the histogram should
have. The default is a number proportional to the logarithm of the length
of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="histBxp_+3A_breaks">breaks</code></td>
<td>

<p>vector of the break points for the bars of the histogram. The count in the
i-th bar is <code>sum(breaks[i] &lt; x &lt;= breaks[i+1])</code>
except that if <code>include.lowest</code> is <code>TRUE</code> (the default),
the first bar also includes points equal to <code>breaks[1]</code>.  If
omitted, evenly-spaced break points are determined from
<code>nclass</code> and the extremes of the data.
</p>
</td></tr>
<tr><td><code id="histBxp_+3A_probability">probability</code></td>
<td>

<p>logical flag: if <code>TRUE</code>, the histogram will be scaled as a probability
density; the sum of the bar heights times bar widths will equal <code>1</code>. If
<code>FALSE</code>, the heights of the bars will be counts.
</p>
</td></tr>
<tr><td><code id="histBxp_+3A_include.lowest">include.lowest</code></td>
<td>

<p>If <code>TRUE</code> (the default), the lowest bar will include data
points equal to the lowest break, otherwise it will act like the
other bars (see the description of the <code>breaks</code> argument).
</p>
</td></tr>
<tr><td><code id="histBxp_+3A_xlab">xlab</code></td>
<td>
<p>character or expression for x axis labeling.</p>
</td></tr>
<tr><td><code id="histBxp_+3A_...">...</code></td>
<td>
<p>additional arguments to <code><a href="graphics.html#topic+barplot">barplot</a></code>.  The
<code><a href="graphics.html#topic+hist">hist</a></code> function uses the function <code>barplot</code> to do
the actual plotting; consequently, arguments to the <code>barplot</code>
function that control shading, etc., can also be given to
<code>hist</code>. See the <code>barplot</code> documentation for arguments
<code>angle</code>, <code>density</code>, <code>col</code>, and  <code>inside</code>. Do not
use the <code>space</code> or <code>histo</code> arguments.
</p>
</td></tr>
<tr><td><code id="histBxp_+3A_width">width</code></td>
<td>

<p>width of the box relative to the height of the histogram. DEFAULT is
<code>0.2</code>.</p>
</td></tr>
<tr><td><code id="histBxp_+3A_boxcol">boxcol</code></td>
<td>
<p>color of filled box. The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="histBxp_+3A_medcol">medcol</code></td>
<td>

<p>the color of the median line. The special value, <code>NA</code>,
indicates the current plotting color (<code>par("col")</code>). The
default is <code>2</code>. If <code>boxcol=0</code> and <code>medcol</code> is not
explicitly specified this is set to the current plotting color
(<code>par("col")</code>).
</p>
</td></tr>
<tr><td><code id="histBxp_+3A_medlwd">medlwd</code></td>
<td>

<p>median line width.  The special value <code>NA</code>, is used to indicate
the current line width (<code>par("lwd")</code>).  The default is <code>5</code>.
</p>
</td></tr>
<tr><td><code id="histBxp_+3A_whisklty">whisklty</code></td>
<td>

<p>whisker line type. The special value <code>NA</code> indicates the
current line type (<code>par("lty")</code>). The default is <code>2</code>
(dotted line).</p>
</td></tr>
<tr><td><code id="histBxp_+3A_staplelty">staplelty</code></td>
<td>

<p>staple (whisker end cap) line type. The special value <code>NA</code>
indicates the current line type (<code>par("lty")</code>). The default is
<code>1</code> (solid line).
</p>
<p>Graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>) may also
be supplied as arguments to this function.
In addition, the high-level graphics arguments described under
<code>par</code> and the arguments to <code>title</code> may be supplied to this
function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>include.lowest</code> is <code>FALSE</code> the bottom breakpoint must be
strictly less than the minimum of the data, otherwise (the default) it
must be less than or equal to the minimum of the data.  The top
breakpoint must be greater than or equal to the maximum of the data.
</p>
<p>This function has been called <code>hist.bxp()</code> for 17 years; in 2012,
the increasingly strong CRAN policies required a new name (which could not
be confused with an S3 method name).
</p>


<h3>Author(s)</h3>

<p>S-Plus: Markus Keller, Christian Keller; port to <span class="rlang"><b>R</b></span> in 1990's: Martin Mächler.</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="graphics.html#topic+barplot">barplot</a></code>,
<code><a href="graphics.html#topic+boxplot">boxplot</a></code>, <code><a href="graphics.html#topic+rug">rug</a></code> and
<code><a href="Hmisc.html#topic+scat1d">scat1d</a></code> in the <a href="https://CRAN.R-project.org/package=Hmisc"><span class="pkg">Hmisc</span></a> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> lab &lt;- "50 samples from a t distribution with 5 d.f."
 mult.fig(2*3, main = "Hist() + Rug()   and    histBxp(*)")
 for(i in 1:3) {
   my.sample &lt;-  rt(50, 5)
   hist(my.sample, main=lab); rug(my.sample)# for 50 obs., this is ok, too..
   histBxp(my.sample, main=lab)
 }
</code></pre>

<hr>
<h2 id='integrate.xy'>Cheap Numerical Integration through Data points.</h2><span id='topic+integrate.xy'></span>

<h3>Description</h3>

<p>Given <code class="reqn">(x_i, f_i)</code> where <code class="reqn">f_i = f(x_i)</code>, compute a cheap
approximation of <code class="reqn">\int_a^b f(x) dx</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate.xy(x, fx, a, b, use.spline=TRUE, xtol=2e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate.xy_+3A_x">x</code></td>
<td>
<p>abscissa values.</p>
</td></tr>
<tr><td><code id="integrate.xy_+3A_fx">fx</code></td>
<td>
<p>corresponding values of <code class="reqn">f(x)</code>.</p>
</td></tr>
<tr><td><code id="integrate.xy_+3A_a">a</code>, <code id="integrate.xy_+3A_b">b</code></td>
<td>
<p>the boundaries of integration; these default to min(x) and
max(x) respectively.</p>
</td></tr>
<tr><td><code id="integrate.xy_+3A_use.spline">use.spline</code></td>
<td>
<p>logical; if TRUE use an interpolating spline.</p>
</td></tr>
<tr><td><code id="integrate.xy_+3A_xtol">xtol</code></td>
<td>
<p>tolerance factor, typically around
<code>sqrt(.Machine$double.eps)</code> ......(fixme)....</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that this is really not good for noisy <code>fx</code> values;
probably a smoothing spline should be used in that case.
</p>
<p>Also, we are not yet using Romberg in order to improve the trapezoid
rule.  This would be quite an improvement in equidistant cases.
</p>


<h3>Value</h3>

<p>the approximate integral.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, May 1994 (for S).</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+integrate">integrate</a></code> for numerical integration of
<em>functions</em>.</p>


<h3>Examples</h3>

<pre><code class='language-R'> x &lt;- 1:4
 integrate.xy(x, exp(x))
 print(exp(4) - exp(1), digits = 10) # the true integral

 for(n in c(10, 20,50,100, 200)) {
   x &lt;- seq(1,4, len = n)
   cat(formatC(n,wid=4), formatC(integrate.xy(x, exp(x)), dig = 9),"\n")
 }
</code></pre>

<hr>
<h2 id='inv.seq'>Inverse seq() &ndash; Short Expression for Index Vector</h2><span id='topic+inv.seq'></span>

<h3>Description</h3>

<p>Compute a short expression for a given integer vector, typically
an index, that can be expressed shortly, using <code><a href="base.html#topic++3A">:</a></code> etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inv.seq(i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inv.seq_+3A_i">i</code></td>
<td>
<p>vector of (usually increasing) integers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+call">call</a></code> (&ldquo;the inside of an
<code><a href="base.html#topic+expression">expression</a></code>&rdquo;) to be <code><a href="base.html#topic+eval">eval</a>()</code>ed to
return the original <code>i</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, October 1995; more elegant implementation from Tony Plate.</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+rle">rle</a></code> for another kind of integer vector coding.</p>


<h3>Examples</h3>

<pre><code class='language-R'>(rr &lt;- inv.seq(i1 &lt;- c(3:12, 20:24, 27, 30:33)))
eval(rr)
stopifnot(eval(rr) == i1)

e2 &lt;- expression(c(20:13, 3:12, -1:-4, 27, 30:31))
(i2 &lt;- eval(e2))
(r2 &lt;- inv.seq(i2))
stopifnot(all.equal(r2, e2[[1]]))

## Had {mapply()} bug in this example:
ii &lt;- c(1:3, 6:9, 11:16)
stopifnot(identical(ii, eval(inv.seq(ii))))
</code></pre>

<hr>
<h2 id='is.whole'>Test Whether a Vector or Array Consists of Whole Numbers</h2><span id='topic+is.whole'></span>

<h3>Description</h3>

<p>This function tests whether a <code>numeric</code> or <code>complex</code> vector
or array consists of whole numbers.  The function <code><a href="base.html#topic+is.integer">is.integer</a></code>
is not appropriate for this since it tests whether the vector is of class
<code>integer</code> (see examples).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.whole(x, tolerance = sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.whole_+3A_x">x</code></td>
<td>
<p><code>integer</code>, <code>numeric</code>, or <code>complex</code> vector or
array to be tested</p>
</td></tr>
<tr><td><code id="is.whole_+3A_tolerance">tolerance</code></td>
<td>
<p>maximal distance to the next whole number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value has the same dimension as the argument <code>x</code>: if <code>x</code>
is a vector, the function returns a <code>logical</code> vector of the same length;
if <code>x</code> is a matrix or array, the function returns a <code>logical</code> matrix
or array of the same dimensions.  Each entry in the result indicates whether
the corresponding entry in <code>x</code> is whole.
</p>


<h3>Author(s)</h3>

<p>Alain Hauser &lt;alain@huschhus.ch&gt;</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+is.integer">is.integer</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a random array, matrix, vector
set.seed(307)
a &lt;- array(runif(24), dim = c(2, 3, 4))
a[4:8] &lt;- 4:8
m &lt;- matrix(runif(12), 3, 4)
m[2:4] &lt;- 2:4
v &lt;- complex(real      = seq(0.5, 1.5, by = 0.1),
             imaginary = seq(2.5, 3.5, by = 0.1))

## Find whole entries
is.whole(a)
is.whole(m)
is.whole(v)

## Numbers of class integer are always whole
is.whole(dim(a))
is.whole(length(v))
</code></pre>

<hr>
<h2 id='iterate.lin.recursion'>Generate Sequence Iterating a Linear Recursion</h2><span id='topic+iterate.lin.recursion'></span>

<h3>Description</h3>

<p>Generate numeric sequences applying a linear recursion <code>nr.it</code> times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iterate.lin.recursion(x, coeff, delta = 0, nr.it)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iterate.lin.recursion_+3A_x">x</code></td>
<td>
<p>numeric vector with <em>initial values</em>, i.e., specifying
the beginning of the resulting sequence; must be of length (larger
or) equal to <code>length(coeff)</code>.</p>
</td></tr>
<tr><td><code id="iterate.lin.recursion_+3A_coeff">coeff</code></td>
<td>
<p>coefficient vector of the linear recursion.</p>
</td></tr>
<tr><td><code id="iterate.lin.recursion_+3A_delta">delta</code></td>
<td>
<p>numeric scalar added to each term; defaults to 0.  If not
zero, determines the linear drift component.</p>
</td></tr>
<tr><td><code id="iterate.lin.recursion_+3A_nr.it">nr.it</code></td>
<td>
<p>integer, number of iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector, say <code>r</code>, of length <code>n + nr.it</code>, where
<code>n = length(x)</code>. Initialized as <code>r[1:n] = x</code>, the recursion
is <code>r[k+1] = sum(coeff * r[(k-m+1):k])</code>, where <code>m = length(coeff)</code>.
</p>


<h3>Note</h3>

<p>Depending on the zeroes of the characteristic polynomial of <code>coeff</code>,
there are three cases, of convergence, oszillation and divergence.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+seq">seq</a></code> can be regarded as a trivial special case.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The Fibonacci sequence:
iterate.lin.recursion(0:1, c(1,1), nr = 12)
## 0 1 1 2 3 5 8 13 21 34 55 89 144 233

## seq() as a special case:
stopifnot(iterate.lin.recursion(4,1, d=2, nr=20)
          == seq(4, by=2, length=1+20))

## ''Deterministic AR(2)'' :
round(iterate.lin.recursion(1:4, c(-0.7, 0.9), d = 2, nr=15), dig=3)
## slowly decaying :
plot(ts(iterate.lin.recursion(1:4, c(-0.9, 0.95), nr=150)))
</code></pre>

<hr>
<h2 id='KSd'>Approximate Critical Values for Kolmogorov-Smirnov's D</h2><span id='topic+KSd'></span>

<h3>Description</h3>

<p>Computes the critical value for Kolmogorov-Smirnov's <code class="reqn">D_n</code>, for
sample sizes <code class="reqn">n \ge 10</code> and confidence level 95%.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KSd(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KSd_+3A_n">n</code></td>
<td>
<p>the sample size, <code>n &gt;= 10</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on tables values given in the reference below.
For <code class="reqn">n\le 80</code> uses interpolations from exact values, elsewhere
uses asymptotic approximation.
</p>


<h3>Value</h3>

<p>The critical value for D (two-sided) for significance level 0.05 (or
confidence level 95%).
</p>


<h3>Author(s)</h3>

<p>Kjetil Halvorsen and Martin Maechler</p>


<h3>References</h3>

<p>Peter J. Bickel and Kjell A. Doksum (1977),
<em>Mathematical Statistics: Basic Ideas and Selected Topics</em>.
Holden Day.
Section 9.6 and table IX.
</p>


<h3>See Also</h3>

<p>Is used from <code><a href="#topic+ecdf.ksCI">ecdf.ksCI</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>KSd(90)
KSd(1:9)# now works

op &lt;- par(mfrow=c(2,1))
  plot(KSd, 10, 150)# nice
  abline(v = c(75,85), col = "gray")
  plot(KSd, 79, 81, n = 1001)# *very* tiny discontinuity at 80
par(op)
</code></pre>

<hr>
<h2 id='last'>Get Last Elements of a Vector</h2><span id='topic+last'></span>

<h3>Description</h3>

<p>Extract the last elements of a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>last(x, length.out = 1, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="last_+3A_x">x</code></td>
<td>
<p>any vector.</p>
</td></tr>
<tr><td><code id="last_+3A_length.out">length.out</code></td>
<td>
<p>integer indicating how many element are desired.  If
positive, return the <code>length.out</code> last elements of <code>x</code>; if
negative, the last <code>length.out</code> elements are <em>dropped</em>.
</p>
</td></tr>
<tr><td><code id="last_+3A_na.rm">na.rm</code></td>
<td>
<p>logical indicating if the last non-missing value (if any)
shall be returned.  By default (it is <code>FALSE</code> and) the last
elements (whatever its values) are returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of length <code>abs(length.out)</code> of <em>last</em> values from <code>x</code>.
</p>


<h3>Note</h3>

<p>This function may eventually be deprecated for the standard <span class="rlang"><b>R</b></span>
function <code><a href="utils.html#topic+tail">tail</a>()</code>.
</p>
<p>Useful for the <code><a href="pastecs.html#topic+turnogram">turnogram</a>()</code> function in package
<a href="https://CRAN.R-project.org/package=pastecs"><span class="pkg">pastecs</span></a>.
</p>


<h3>Author(s)</h3>

<p>Werner Stahel (<a href="mailto:stahel@stat.math.ethz.ch">stahel@stat.math.ethz.ch</a>), and independently,
Philippe Grosjean (<a href="mailto:phgrosjean@sciviews.org">phgrosjean@sciviews.org</a>),
Frédéric Ibanez (<a href="mailto:ibanez@obs-vlfr.fr">ibanez@obs-vlfr.fr</a>).</p>


<h3>See Also</h3>

<p><code><a href="pastecs.html#topic+first">first</a></code>, <code><a href="pastecs.html#topic+turnogram">turnogram</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- c(NA, 1, 2, NA, 3, 4, NA)
last(a)
last(a, na.rm=TRUE)

last(a, length = 2)
last(a, length = -3)
</code></pre>

<hr>
<h2 id='linesHyperb.lm'>Plot Confidence or Prediction Hyperbolas around a Regression Line</h2><span id='topic+linesHyperb.lm'></span>

<h3>Description</h3>

<p>Add confidence/prediction hyperbolas for <code class="reqn">y(x_0)</code>
to a plot with data or regression line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linesHyperb.lm(object, c.prob=0.95, confidence=FALSE,
            k=if (confidence) Inf else 1,
            col=2, lty=2, do.abline=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linesHyperb.lm_+3A_object">object</code></td>
<td>
<p>result of <code><a href="stats.html#topic+lm">lm</a>(.)</code>.</p>
</td></tr>
<tr><td><code id="linesHyperb.lm_+3A_c.prob">c.prob</code></td>
<td>
<p>coverage probability in <code class="reqn">(0,1)</code>.</p>
</td></tr>
<tr><td><code id="linesHyperb.lm_+3A_confidence">confidence</code></td>
<td>
<p>logical; if true, do (small) confidence band, else,
realistic prediction band for the mean of <code>k</code> observations.</p>
</td></tr>
<tr><td><code id="linesHyperb.lm_+3A_k">k</code></td>
<td>
<p>integer or <code>Inf</code>; assume <code>k</code> future observations;
<code>k = Inf</code>  corresponds to confidence intervals (for y).</p>
</td></tr>
<tr><td><code id="linesHyperb.lm_+3A_col">col</code>, <code id="linesHyperb.lm_+3A_lty">lty</code></td>
<td>
<p>attributes for the <code><a href="graphics.html#topic+lines">lines</a></code> to be drawn.</p>
</td></tr>
<tr><td><code id="linesHyperb.lm_+3A_do.abline">do.abline</code></td>
<td>
<p>logical; if true, the regression line is drawn as well.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>With <code><a href="stats.html#topic+predict.lm">predict.lm</a>(*, interval=)</code> is available,
this function <code>linesHyperb.lm</code> is only slightly more general for
its <code>k</code> argument.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Oct 1995</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+predict.lm">predict.lm</a>(*, interval=)</code> optionally computes
prediction or confidence intervals.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swiss)
      plot(Fertility ~ Education, data = swiss) # the data
(lmS &lt;- lm(Fertility ~ Education, data = swiss))
linesHyperb.lm(lmS)
linesHyperb.lm(lmS, conf=TRUE, col="blue")
</code></pre>

<hr>
<h2 id='list_named'>Automatically Named list()</h2><span id='topic+list_'></span>

<h3>Description</h3>

<p>A version of <code><a href="base.html#topic+list">list</a>(...)</code>, but with &ldquo;automatically&rdquo;
<em>named</em> list components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_named_+3A_...">...</code></td>
<td>
<p>components to make up the resulting <code><a href="base.html#topic+list">list</a></code>.
Their variable names (or unevaluated expressions in the call) will
become the <code><a href="base.html#topic+names">names</a>(.)</code> of the result.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The names are extracted from <code><a href="base.html#topic+sys.call">sys.call</a>()</code>, and the function
is written to be <em>fast</em>  (rather than easy to ready for the uninitiated ;-)
</p>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+list">list</a></code> with the components in the arguments with
<code><a href="base.html#topic+names">names</a></code> taken from their call to <code>list_(..)</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+list">list</a></code>, <code><a href="base.html#topic+names">names</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- 1:4; lett &lt;- letters[1:9]; CH &lt;- "Suisse"
all.equal(list (a, lett),
          list_(a, lett)) # "names for current but not for target"
str(list(a, lett, CH)) # [[1]], [[2]], .. (no names)
str(list_(a, lett, CH))#   $a   $lett  ..

stopifnot(identical(            list (a, lett, CH),
                    unname(L &lt;- list_(a, lett, CH))),
          is.list(L), names(L) == c("a", "lett", "CH"),
          identical(lett, L$lett) ## etc
          )

## The function is currently defined as
function (...) `names&lt;-`(list(...), vapply(sys.call()[-1L], as.character, ""))
</code></pre>

<hr>
<h2 id='loessDemo'>Graphical Interactive Demo of loess()</h2><span id='topic+loessDemo'></span>

<h3>Description</h3>

<p>A graphical and interactive demonstration and visualization of how
<code><a href="stats.html#topic+loess">loess</a></code> works.  By clicking on the graphic, the user
determines the current estimation window which is visualized together
with the weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loessDemo(x, y, span = 1/2, degree = 1, family = c("gaussian", "symmetric"),
          nearest = FALSE, nout = 501,
          xlim = numeric(0), ylim = numeric(0), strictlim = TRUE, verbose = TRUE,
          inch.sym = 0.25, pch = 4, shade = TRUE, w.symbols = TRUE,
          sym.col = "blue", w.col = "light blue", line.col = "steelblue")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loessDemo_+3A_x">x</code>, <code id="loessDemo_+3A_y">y</code></td>
<td>
<p>numeric vectors of the same length; the demo is about
<code><a href="stats.html#topic+loess">loess</a>(y ~ x)</code>.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_span">span</code></td>
<td>
<p>the smoothing parameter <code class="reqn">\alpha</code>.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_degree">degree</code></td>
<td>
<p>the degree of the polynomials to be used; must be in <code class="reqn">{0,1,2}</code>.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_family">family</code></td>
<td>
<p>if <code>"gaussian"</code> fitting is by least-squares, and if
<code>"symmetric"</code> a re-descending M estimator is used with Tukey's
biweight function.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_nearest">nearest</code></td>
<td>
<p>logical indicating how <code class="reqn">x_0</code> should be determined,
the value at which <code class="reqn">\hat{f}(x_0)</code> is computed.  If
<code>nearest</code> is true, the closest <em>data</em> value is taken.
</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_nout">nout</code></td>
<td>
<p>the number of points at which to evaluate, i.e,
determining <code class="reqn">u_i</code>, <code class="reqn">i = 1,2, \dots, \mathtt{nout}</code>, at
which <code class="reqn">\hat{f}(u_i)</code> is computed.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_xlim">xlim</code></td>
<td>
<p>x-range; to extend or determine (iff <code>strictlim</code> is
true) the <code class="reqn">x</code>-range for plotting.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_ylim">ylim</code></td>
<td>
<p>y-range; to extend or determine (iff <code>strictlim</code> is
true) the <code class="reqn">y</code>-range for plotting.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_strictlim">strictlim</code></td>
<td>
<p>logical determining if <code>xlim</code> and <code>ylim</code>
should be strict limits (as e.g., in <code><a href="graphics.html#topic+plot.default">plot.default</a></code>), or
just a suggestion to <em>extend</em> the data-dependent ranges.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_verbose">verbose</code></td>
<td>
<p>logical ......</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_inch.sym">inch.sym</code></td>
<td>
<p>symbol size in inches of the maximal weight circle symbol.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_pch">pch</code></td>
<td>
<p>plotting character, see <code><a href="graphics.html#topic+points">points</a></code>.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_shade">shade</code></td>
<td>
<p>logical; if true, <code><a href="graphics.html#topic+polygon">polygon</a>(.., density=..)</code>
will be used to shade off the regions where the weights are zero.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_w.symbols">w.symbols</code></td>
<td>
<p>logical indicating if the non-zero weights should be
visualized by circles with radius proportional to <code>inch.sym</code>
and <code class="reqn">\sqrt{w}</code> where <code class="reqn">w</code> are the weights.</p>
</td></tr>
<tr><td><code id="loessDemo_+3A_sym.col">sym.col</code>, <code id="loessDemo_+3A_w.col">w.col</code>, <code id="loessDemo_+3A_line.col">line.col</code></td>
<td>
<p>colors for the symbols, weights and
lines, respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>As function <code>loess.demo()</code>,  written and posted to S-news, on 27
Sep 2001, by Greg Snow, Brigham Young University, 
it was modified by Henrik Aa. Nielsen, IMM, DTU, 
and subsequently spiffed up for <span class="rlang"><b>R</b></span> by Martin Maechler.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+loess">loess</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(dev.interactive()) {

 if(requireNamespace("lattice")) {
    data("ethanol", package = "lattice")
    attach(ethanol)
    loessDemo(E,NOx, span=.25)
    loessDemo(E,NOx, span=.25, family = "symmetric")

    loessDemo(E,NOx, degree=0)# Tricube Kernel estimate
  }

 ## Artificial Example with one outlier
 n2 &lt;- 50; x &lt;- 1:(1+2*n2)
 fx &lt;- (x/10 - 5)^2
 y &lt;- fx + 4*rnorm(x)
 y[n2+1] &lt;- 1e4
 loessDemo(x,y, span=1/3, ylim= c(0,1000))# not robust !!
 loessDemo(x,y, span=1/3, family = "symm")
 loessDemo(x,y, span=1/3, family = "symm", w.symb = FALSE, ylim = c(0,40))
 loessDemo(x,y, span=1/3, family = "symm", ylim = c(0,40))
 ## but see warnings() --- there's a "fixup"

}
</code></pre>

<hr>
<h2 id='lseq'>Generate Sequences, Equidistant on Log Scale</h2><span id='topic+lseq'></span>

<h3>Description</h3>

<p>Generate sequences which are equidistant on a log-scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lseq(from, to, length)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lseq_+3A_from">from</code></td>
<td>
<p>starting value of sequence.</p>
</td></tr>
<tr><td><code id="lseq_+3A_to">to</code></td>
<td>
<p>end value of the sequence.</p>
</td></tr>
<tr><td><code id="lseq_+3A_length">length</code></td>
<td>
<p>desired length of the sequence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+numeric">numeric</a></code> vector of length <code>length</code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+seq">seq</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- lseq(1, 990, length= 21))
plot(x, x^4,    type = "b", col = 2, log = "xy")
if(with(R.version, major &gt;= 2 &amp;&amp; minor &gt;= 1))
plot(x, exp(x), type = "b", col = 2, log = "xy")
</code></pre>

<hr>
<h2 id='mat2tex'>Produce LaTeX commands to print a matrix</h2><span id='topic+mat2tex'></span>

<h3>Description</h3>

<p>&ldquo;Translate&rdquo; an <span class="rlang"><b>R</b></span> matrix (like object) into a LaTeX table,
using <code>\begin{tabular} ...</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mat2tex(x, file= "mat.tex", envir = "tabular",
        nam.center = "l", col.center = "c",
        append = TRUE, digits = 3, title)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mat2tex_+3A_x">x</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="mat2tex_+3A_file">file</code></td>
<td>
<p>names the file to which LaTeX commands should be written</p>
</td></tr>
<tr><td><code id="mat2tex_+3A_envir">envir</code></td>
<td>
<p>a string, the LaTeX environment name; default is
<code>"tabular"</code>; useful maybe <code>"array"</code>, or other versions of
tabular environments.</p>
</td></tr>
<tr><td><code id="mat2tex_+3A_nam.center">nam.center</code></td>
<td>
<p>character specifying row names should be center;
default <code>"l"</code>.</p>
</td></tr>
<tr><td><code id="mat2tex_+3A_col.center">col.center</code></td>
<td>
<p>character (vector) specifying how the columns should
be centered; must have values from <code>c("l","c","r")</code>; defaults
to <code>"c"</code>.</p>
</td></tr>
<tr><td><code id="mat2tex_+3A_append">append</code></td>
<td>
<p>logical; if <code>FALSE</code>, will destroy the file
<code>file</code> before writing commands to it; otherwise (by default),
simply adds commands at the end of file <code>file</code>.</p>
</td></tr>
<tr><td><code id="mat2tex_+3A_digits">digits</code></td>
<td>
<p>integer; setting of <code><a href="base.html#topic+options">options</a>(digits=..)</code> for
purpose of number representation.</p>
</td></tr>
<tr><td><code id="mat2tex_+3A_title">title</code></td>
<td>
<p>a string, possibly using LaTeX commands, which will span
the columns of the LaTeX matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.  This function, when used correctly,
only writes LaTeX commands to a file.
</p>


<h3>Author(s)</h3>

<p>For S: Vincent Carey <a href="mailto:vjcarey@sphunix.sph.jhu.edu">vjcarey@sphunix.sph.jhu.edu</a>, from a
post on Feb.19, 1991 to S-news.  Port to <span class="rlang"><b>R</b></span> (and a bit more) by
Martin Maechler <a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>.
</p>


<h3>See Also</h3>

<p><code><a href="Hmisc.html#topic+latex">latex</a></code> in package <a href="https://CRAN.R-project.org/package=Hmisc"><span class="pkg">Hmisc</span></a> is more flexible
(but may surprise by its auto-printing ..).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mex &lt;- matrix(c(pi,pi/2,pi/4,exp(1),exp(2),exp(3)),nrow=2, byrow=TRUE,
               dimnames = list(c("$\\pi$","$e$"), c("a","b","c")))
mat2tex(mex, file = print(tf &lt;- tempfile("mat", , ".tex")),
        title="$\\pi, e$, etc." )

## The last command produces the file "mat&lt;xyz&gt;.tex" containing

##&gt;  \begin{tabular} {| l|| c| c| c|}
##&gt;  \multicolumn{ 4 }{c}{ $\pi, e$, etc. } \\ \hline
##&gt;     \  &amp; a &amp; b &amp; c \\ \hline \hline
##&gt;  $\pi$ &amp; 3.14 &amp; 1.57 &amp; 0.785 \\ \hline
##&gt;  $e$ &amp; 2.72 &amp; 7.39 &amp; 20.1 \\ \hline
##&gt;  \end{tabular}

## Now you have to properly embed the contents of this file
## in a LaTeX document -- for example, you will need a
## preamble, the \begin{document} statement, etc.

## Note that the backslash needs protection in dimnames
## or title actions.

mat2tex(mex, stdout(), col.center = c("r","r","c"))
</code></pre>

<hr>
<h2 id='missingCh'>Has a Formal Argument been Set or is it Missing?</h2><span id='topic+missingCh'></span>

<h3>Description</h3>

<p><code>missingCh</code> can be used to test whether a value was specified
as an argument to a function.  Very much related to the standard <span class="rlang"><b>R</b></span>
function <code><a href="base.html#topic+missing">missing</a></code>, here the argument is given by its
name, a character string.
</p>
<p>As <code>missingCh()</code> calls <code>missing()</code>, do consider the
caveats about the latter, see <code><a href="base.html#topic+missing">missing</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>missingCh(x, envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="missingCh_+3A_x">x</code></td>
<td>
<p>a <code><a href="base.html#topic+character">character</a></code> string.</p>
</td></tr>
<tr><td><code id="missingCh_+3A_envir">envir</code></td>
<td>
<p>a (function evaluation) <code><a href="base.html#topic+environment">environment</a></code>, in which
the variable named <code>x</code> is to be &ldquo;missing&rdquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+logical">logical</a></code> indicating if the argument named <code>x</code> is
<code><a href="base.html#topic+missing">missing</a></code> in the function &ldquo;above&rdquo;, typically the
caller of <code>missingCh</code>, but see the use of <code>envir</code> in the
<code>vapply</code> example.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+missing">missing</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tst1 &lt;- function(a, b, dd, ...) ## does not work an with argument named 'c' !
    c(b = missingCh("b"), dd = missingCh("dd"))
tst1(2)#-&gt; both 'b' and 'dd' are missing
tst1(,3,,3)
##     b    dd
## FALSE  TRUE  -- as 'b' is not missing but 'dd' is.

Tst &lt;- function(a,b,cc,dd,EEE, ...)
    vapply(c("a","b","cc","dd","EEE"), missingCh, NA, envir=environment())
Tst()
## TRUE ... TRUE -- as all are missing()
Tst(1,,3)
##     a     b    cc    dd   EEE
## FALSE  TRUE FALSE  TRUE  TRUE
## .....       .....
## as 'a' and 'cc' where not missing()

## Formal testing:
stopifnot(tst1(), !tst1(,3,3), Tst(),
                        Tst(1,,3, b=2, E="bar") == c(0,0,1,0,0))
## maybe surprising that this ^^ becomes 'dd' and only 'cc' is missing
</code></pre>

<hr>
<h2 id='mpl'>Simple Matrix Plots</h2><span id='topic+mpl'></span><span id='topic+p.m'></span>

<h3>Description</h3>

<p>Do simple matrix plots, providing an easy interface to
<code><a href="graphics.html#topic+matplot">matplot</a></code> by using a default x variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpl(mat, ...)
p.m(mat, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpl_+3A_mat">mat</code></td>
<td>
<p>numeric matrix.</p>
</td></tr>
<tr><td><code id="mpl_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+matplot">matplot</a></code>,
e.g., <code>type</code>, <code>xlab</code>, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>p.m(m)</code> use the first column of <code>m</code> as <code class="reqn">x</code> variable,
whereas <code>mpl(m)</code> uses the integers 1, 2, ..., <code>nrow(m)</code>
as coordinates and <code>rownames(m)</code> as axis labels if possible.
</p>


<h3>Note</h3>

<p>These were really created for playing around with curves etc, and
probably should be <em>deprecated</em> since in concrete examples, using
<code>matplot()</code> directly is more appropriate.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+matplot">matplot</a></code>,
<code><a href="stats.html#topic+plot.mts">plot.mts</a>(*, plot.type = "single")</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(animals, package = "cluster")
mpl(animals, type = "l")
</code></pre>

<hr>
<h2 id='mult.fig'>Plot Setup for MULTiple FIGures, incl. Main Title</h2><span id='topic+mult.fig'></span>

<h3>Description</h3>

<p>Easy Setup for plotting multiple figures (in a rectangular layout) on
one page.  It allows to specify a main title and uses <em>smart</em>
defaults for several <code><a href="graphics.html#topic+par">par</a></code> calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mult.fig(nr.plots, mfrow, mfcol, marP = rep(0, 4),
         mgp = c(if(par("las") != 0) 2. else 1.5, 0.6, 0),
         mar = marP + 0.1 + c(4,4,2,1), oma = c(0,0, tit.wid, 0),
         main = NULL,
         tit.wid = if (is.null(main)) 0 else 1 + 1.5*cex.main,
         cex.main = par("cex.main"), line.main = cex.main - 1/2,
         col.main = par("col.main"), font.main = par("font.main"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mult.fig_+3A_nr.plots">nr.plots</code></td>
<td>
<p>integer; the number of plot figures you'll want to draw.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_mfrow">mfrow</code>, <code id="mult.fig_+3A_mfcol">mfcol</code></td>
<td>
<p><em>instead</em> of <code>nr.plots</code>: integer(2) vectors
giving the rectangular figure layout for <code><a href="graphics.html#topic+par">par</a>(mfrow = *)</code>,
or <code><a href="graphics.html#topic+par">par</a>(mfcol=*)</code>, respectively.  The default is to use
<code>mfrow = <a href="grDevices.html#topic+n2mfrow">n2mfrow</a>(nr.plots)</code>.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_marp">marP</code></td>
<td>
<p>numeric(4) vector of figure margins to <em>add</em>
(&ldquo;<b>P</b>lus&rdquo;) to default <code>mar</code>, see below.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_mgp">mgp</code></td>
<td>
<p>argument for <code><a href="graphics.html#topic+par">par</a>(mpg= .)</code> with a smaller
default than usual.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_mar">mar</code></td>
<td>
<p>argument for <code><a href="graphics.html#topic+par">par</a>(mar= .)</code> with a smaller
default than usual, using the <code>marP</code> argument, see above.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_oma">oma</code></td>
<td>
<p>argument for <code><a href="graphics.html#topic+par">par</a>(oma= .)</code>, by default for
adding space for the <code>main</code> title if necessary.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_main">main</code></td>
<td>
<p>character.  The main title to be used for the whole graphic.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_tit.wid">tit.wid</code></td>
<td>
<p>numeric specifying the vertical width to be used for the
main title; note that this is only used for the default value of
<code>oma</code> (s. above).</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_cex.main">cex.main</code></td>
<td>
<p>numeric; the character size to be used for the main title.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_line.main">line.main</code></td>
<td>
<p>numeric; the margin line at which the title is written
(via <code><a href="graphics.html#topic+mtext">mtext</a>(main, side=3, outer=TRUE, line = line.main, ....)</code>).</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_col.main">col.main</code>, <code id="mult.fig_+3A_font.main">font.main</code></td>
<td>
<p>color and font for main title, passed to
<code><a href="graphics.html#topic+mtext">mtext</a>()</code>, see also <code><a href="graphics.html#topic+par">par</a>(*)</code>.</p>
</td></tr>
<tr><td><code id="mult.fig_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+mtext">mtext</a></code> for the main title.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> with two components that are lists themselves, a
subset of <code><a href="graphics.html#topic+par">par</a>()</code>,
</p>
<table>
<tr><td><code>new.par</code></td>
<td>
<p>the current <code>par</code> settings.</p>
</td></tr>
<tr><td><code>old.par</code></td>
<td>
<p>the <code>par</code> <em>before</em> the call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler, UW Seattle, 1990 (for <code>S</code>).</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+par">par</a></code>, <code><a href="graphics.html#topic+layout">layout</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>opl &lt;- mult.fig(5, main= expression("Sine Functions " * sin(n * pi * x)))
x &lt;- seq(0, 1, len = 201)
for (n in 1:5)
  plot(x, sin(n * pi * x), ylab ="", main = paste("n = ",n))
par(opl$old.par)

rr &lt;- mult.fig(mfrow=c(5,1), main= "Cosinus Funktionen", cex = 1.5,
               marP = - c(0, 1, 2, 0))
for (n in 1:5)
  plot(x, cos(n * pi * x), type = 'l', col="red", ylab ="")
str(rr)
par(rr$old.par)
## The *restored* par settings:
str(do.call("par", as.list(names(rr$new.par))))

## Manual setting of `tit.wid`  in case subsequent code also manages par():
mult.fig(4, tit.wid = 2)$old.par -&gt; opar
plot(lm(sr ~ pop15 + pop75 + dpi + ddpi, data = LifeCycleSavings))
par(opar) # reset
</code></pre>

<hr>
<h2 id='n.code'>Convert &quot;Round&quot; Integers to Short Strings and Back</h2><span id='topic+n.code'></span><span id='topic+code2n'></span>

<h3>Description</h3>

<p><code>n.code</code> convert &ldquo;round integers&rdquo; to short character strings.
This is useful to build up variable names in simulations, e.g.
</p>
<p><code>code2n</code> is the <em>inverse</em> function of <code>n.code()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.code(n,    ndig = 1, dec.codes = c("", "d", "c", "k"))
code2n(ncod, ndig = 1, dec.codes = c("", "d", "c", "k"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n.code_+3A_n">n</code></td>
<td>
<p>integer vector.</p>
</td></tr>
<tr><td><code id="n.code_+3A_ncod">ncod</code></td>
<td>
<p>character vector, typically resulting from
<code>n.code</code>.</p>
</td></tr>
<tr><td><code id="n.code_+3A_ndig">ndig</code></td>
<td>
<p>integer giving number of digits before the coding character.</p>
</td></tr>
<tr><td><code id="n.code_+3A_dec.codes">dec.codes</code></td>
<td>
<p>character code for 1, 10, 100, 1000 (etc).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>n.code(n)</code> returns a <code><a href="base.html#topic+character">character</a></code> vector of the same
length as <code>n</code>.
</p>
<p><code>code2n(ncod)</code> returns a <code><a href="base.html#topic+integer">integer</a></code> vector of the same
length as <code>ncod</code>.
</p>
<p>Usually, <code>code2n(n.code(n)) == n</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>Examples</h3>

<pre><code class='language-R'>n10 &lt;-  c(10,20,90, 100,500, 2000,10000)
(c10 &lt;- n.code(n10))#-&gt; "1d" "2d" "9d" "1c" ..
stopifnot(code2n(c10) == n10)
</code></pre>

<hr>
<h2 id='n.plot'>Name Plot: Names or Numbers instead of Points in Plot</h2><span id='topic+n.plot'></span>

<h3>Description</h3>

<p>A utility function which basically calls <code><a href="base.html#topic+plot">plot</a>(*, type="n")</code>
and <code><a href="graphics.html#topic+text">text</a></code>.   To have names or numbers instead of points
in a plot is useful for identifaction, e.g., in a residual plot, see
also <code><a href="#topic+TA.plot">TA.plot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.plot(x, y = NULL, nam = NULL, abbr = n &gt;= 20 || max(nchar(nam))&gt;=8,
       xlab = NULL, ylab = NULL, log = "",
       cex = par("cex"), col = par("col"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n.plot_+3A_x">x</code>, <code id="n.plot_+3A_y">y</code></td>
<td>
<p>coordinates at which to plot. If <code>y</code> is missing,
<code>x</code> is used for both, if it's a <code><a href="base.html#topic+data.frame">data.frame</a>,
      <a href="base.html#topic+list">list</a></code>, 2-column matrix etc &ndash; via <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>;
formula do <b>not</b> work.</p>
</td></tr>
<tr><td><code id="n.plot_+3A_nam">nam</code></td>
<td>
<p>the labels to plot at each (x,y).  Per default, these
taken from the data <code>x</code> and <code>y</code>;  case numbers <code>1:n</code>
are taken if no names are available.</p>
</td></tr>
<tr><td><code id="n.plot_+3A_abbr">abbr</code></td>
<td>
<p>logical indicating if the <code>nam</code> labels should be
abbreviated &ndash; with a sensible default.</p>
</td></tr>
<tr><td><code id="n.plot_+3A_xlab">xlab</code>, <code id="n.plot_+3A_ylab">ylab</code></td>
<td>
<p>labels for the x- and y- axis, the latter being empty
by default.</p>
</td></tr>
<tr><td><code id="n.plot_+3A_log">log</code></td>
<td>
<p>character specifying if log scaled axes should be used, see
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="n.plot_+3A_cex">cex</code></td>
<td>
<p>plotting character expansion, see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="n.plot_+3A_col">col</code></td>
<td>
<p>color to use for <code><a href="graphics.html#topic+text">text</a>()</code>.</p>
</td></tr>
<tr><td><code id="n.plot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the <code><a href="base.html#topic+plot">plot</a></code> call.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisibly, a character vector with the labels used.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, since 1992</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot.default">plot.default</a></code>, <code><a href="graphics.html#topic+text">text</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'> n.plot(1:20, cumsum(rnorm(20)))
 data(cars)
 with(cars, n.plot(speed, dist, cex = 0.8, col = "forest green"))
</code></pre>

<hr>
<h2 id='nearcor'>Find the Nearest Proper Correlation Matrix</h2><span id='topic+nearcor'></span>

<h3>Description</h3>

<p>This function &ldquo;smoothes&rdquo; an improper correlation matrix as it can result
from <code><a href="stats.html#topic+cor">cor</a></code> with <code>use="pairwise.complete.obs"</code> or
<code><a href="polycor.html#topic+hetcor">hetcor</a></code>.
</p>
<p>It is <em>deprecated</em> now, in favor of
<code><a href="Matrix.html#topic+nearPD">nearPD</a>()</code> from package <a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nearcor(R, eig.tol = 1e-6, conv.tol = 1e-07, posd.tol = 1e-8,
        maxits = 100, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nearcor_+3A_r">R</code></td>
<td>
<p>a square symmetric approximate correlation matrix</p>
</td></tr>
<tr><td><code id="nearcor_+3A_eig.tol">eig.tol</code></td>
<td>
<p>defines relative positiveness of eigenvalues compared
to largest, default=1e-6.</p>
</td></tr>
<tr><td><code id="nearcor_+3A_conv.tol">conv.tol</code></td>
<td>
<p>convergence tolerance for algorithm, default=1.0e-7  </p>
</td></tr>
<tr><td><code id="nearcor_+3A_posd.tol">posd.tol</code></td>
<td>
<p>tolerance for enforcing positive definiteness, default=1.0e-8</p>
</td></tr>
<tr><td><code id="nearcor_+3A_maxits">maxits</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="nearcor_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying if convergence monitoring should be
verbose.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This implements the algorithm of Higham (2002), then forces symmetry,
then forces positive definiteness using code from
<code><a href="#topic+posdefify">posdefify</a></code>.  This implementation does not make
use of direct LAPACK access for tuning purposes as in the MATLAB code
of Lucas (2001).  The algorithm of Knol DL and ten Berge (1989) (not
implemented here) is more general in (1) that it allows contraints to
fix some rows (and columns) of the matrix and (2) to force the
smallest eigenvalue to have a certain value.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code>, with components
</p>
<table>
<tr><td><code>cor</code></td>
<td>
<p>resulting correlation matrix</p>
</td></tr>
<tr><td><code>fnorm</code></td>
<td>
<p>Froebenius norm of difference of input and output</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>number of iterations used</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jens Oehlschlägel </p>


<h3>References</h3>

<p>See those in <code><a href="#topic+posdefify">posdefify</a></code>.
</p>


<h3>See Also</h3>

<p>the slightly more flexible <code><a href="Matrix.html#topic+nearPD">nearPD</a></code> which also
returns a <em>classed</em> matrix (class <code>dpoMatrix</code>).
For new code, <code>nearPD()</code> is really preferred to <code>nearcor()</code>,
which hence is considered deprecated.
</p>
<p><code><a href="polycor.html#topic+hetcor">hetcor</a></code>, <code><a href="base.html#topic+eigen">eigen</a></code>;
<code><a href="#topic+posdefify">posdefify</a></code> for a simpler algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> cat("pr is the example matrix used in Knol DL, ten Berge (1989)\n")
 pr &lt;- matrix(c(1,     0.477, 0.644, 0.478, 0.651, 0.826,
		0.477, 1,     0.516, 0.233, 0.682, 0.75,
		0.644, 0.516, 1,     0.599, 0.581, 0.742,
		0.478, 0.233, 0.599, 1,     0.741, 0.8,
		0.651, 0.682, 0.581, 0.741, 1,     0.798,
		0.826, 0.75,  0.742, 0.8,   0.798, 1),
	      nrow = 6, ncol = 6)

 ncr &lt;- nearcor(pr)
 nr &lt;- ncr$cor
 
 plot(pr[lower.tri(pr)],
      nr[lower.tri(nr)]); abline(0,1, lty=2)
 round(cbind(eigen(pr)$values, eigen(nr)$values), 8)

 cat("The following will fail:\n")
 try(factanal(cov=pr, factors=2))
 cat("and this should work\n")
 try(factanal(cov=nr, factors=2))

 if(require("polycor")) {

    n &lt;- 400
    x &lt;- rnorm(n)
    y &lt;- rnorm(n)

    x1 &lt;- (x + rnorm(n))/2
    x2 &lt;- (x + rnorm(n))/2
    x3 &lt;- (x + rnorm(n))/2
    x4 &lt;- (x + rnorm(n))/2

    y1 &lt;- (y + rnorm(n))/2
    y2 &lt;- (y + rnorm(n))/2
    y3 &lt;- (y + rnorm(n))/2
    y4 &lt;- (y + rnorm(n))/2

    dat &lt;- data.frame(x1, x2, x3, x4, y1, y2, y3, y4)

    x1 &lt;- ordered(as.integer(x1 &gt; 0))
    x2 &lt;- ordered(as.integer(x2 &gt; 0))
    x3 &lt;- ordered(as.integer(x3 &gt; 1))
    x4 &lt;- ordered(as.integer(x4 &gt; -1))

    y1 &lt;- ordered(as.integer(y1 &gt; 0))
    y2 &lt;- ordered(as.integer(y2 &gt; 0))
    y3 &lt;- ordered(as.integer(y3 &gt; 1))
    y4 &lt;- ordered(as.integer(y4 &gt; -1))

    odat &lt;- data.frame(x1, x2, x3, x4, y1, y2, y3, y4)

    xcor &lt;- cor(dat)
    pcor &lt;- cor(data.matrix(odat)) # cor() no longer works for factors
    hcor &lt;- hetcor(odat, ML=TRUE, std.err=FALSE)$correlations
    ncor &lt;- nearcor(hcor)$cor

    try(factanal(covmat=xcor, factors=2, n.obs=n))
    try(factanal(covmat=pcor, factors=2, n.obs=n))
    try(factanal(covmat=hcor, factors=2, n.obs=n))
    try(factanal(covmat=ncor, factors=2, n.obs=n))
  }
</code></pre>

<hr>
<h2 id='nr.sign.chg'>Number of Sign Changes in Sequence</h2><span id='topic+nr.sign.chg'></span>

<h3>Description</h3>

<p>Compute the number of sign changes in the sequence <code>y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nr.sign.chg(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nr.sign.chg_+3A_y">y</code></td>
<td>
<p>numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an integer giving the number of sign changes in sequence <code>y</code>.
Note that going from positive to 0 to positive is <em>not</em> a sign change.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 17 Feb 1993.</p>


<h3>Examples</h3>

<pre><code class='language-R'>(y &lt;- c(1:2,1:-1,0:-2))
nr.sign.chg(y)## = 1
</code></pre>

<hr>
<h2 id='p.arrows'>Prettified Arrows Plots</h2><span id='topic+p.arrows'></span>

<h3>Description</h3>

<p>Draws arrows, like the <code><a href="graphics.html#topic+arrows">arrows</a></code> function, but with
&ldquo;nice&rdquo; <em>filled</em> arrow heads.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.arrows(x1, y1, x2, y2, size = 1, width, fill = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.arrows_+3A_x1">x1</code>, <code id="p.arrows_+3A_y1">y1</code></td>
<td>
<p>coordinates of points <b>from</b> which to draw.</p>
</td></tr>
<tr><td><code id="p.arrows_+3A_x2">x2</code>, <code id="p.arrows_+3A_y2">y2</code></td>
<td>
<p>coordinates of points <b>to</b> which to draw.</p>
</td></tr>
<tr><td><code id="p.arrows_+3A_size">size</code></td>
<td>
<p>symbol size as a fraction of a character height; default 1.</p>
</td></tr>
<tr><td><code id="p.arrows_+3A_width">width</code></td>
<td>
<p>width of the arrow head; defaults to ....</p>
</td></tr>
<tr><td><code id="p.arrows_+3A_fill">fill</code></td>
<td>
<p>color for filling the arrow head.</p>
</td></tr>
<tr><td><code id="p.arrows_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+segments">segments</a>()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andreas Ruckstuhl, 19 May 1994; (cosmetic by MM).</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+arrows">arrows</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>example(arrows, echo = FALSE) #-&gt; x, y, s
plot(x,y, main="p.arrows(.)")
p.arrows(x[s], y[s], x[s+1], y[s+1], col= 1:3, fill = "dark blue")
</code></pre>

<hr>
<h2 id='p.datum'>Plot 'Datum' (deutsch!) unten rechts</h2><span id='topic+p.datum'></span>

<h3>Description</h3>

<p>Plot the date (and time, if required) in German, at the lower right hand
margin of your plot.date
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.datum(outer = FALSE, cex = 0.75, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.datum_+3A_outer">outer</code></td>
<td>
<p>logical; passed to <code><a href="graphics.html#topic+mtext">mtext</a></code>.</p>
</td></tr>
<tr><td><code id="p.datum_+3A_cex">cex</code></td>
<td>
<p>non-negative; passed to <code><a href="graphics.html#topic+mtext">mtext</a></code>.</p>
</td></tr>
<tr><td><code id="p.datum_+3A_...">...</code></td>
<td>
<p>any arguments to <code><a href="#topic+u.Datumvonheute">u.Datumvonheute</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+u.date">u.date</a></code>, <code><a href="base.html#topic+date">date</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1)
p.datum()
</code></pre>

<hr>
<h2 id='p.dnorm'>Plot Parametric Density Functions</h2><span id='topic+p.dnorm'></span><span id='topic+p.dchisq'></span><span id='topic+p.dgamma'></span>

<h3>Description</h3>

<p>These are utilities for pretty plotting of often used parametric
densities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.dnorm (mu = 0, s = 1, h0.col = "light gray",
         ms.lines = TRUE, ms.col = "gray", ...)
p.dchisq(nu,    h0.col = "light gray", ...)
p.dgamma(shape, h0.col = "light gray", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.dnorm_+3A_mu">mu</code>, <code id="p.dnorm_+3A_s">s</code></td>
<td>
<p>numbers, the mean and standard deviation of the normal
distribution.</p>
</td></tr>
<tr><td><code id="p.dnorm_+3A_nu">nu</code></td>
<td>
<p>positive number, the degrees of freedom <code>df</code> argument
for the <code class="reqn">\chi^2</code>-density function <code><a href="stats.html#topic+dchisq">dchisq</a></code>.</p>
</td></tr>
<tr><td><code id="p.dnorm_+3A_shape">shape</code></td>
<td>
<p>number, the <code>shape</code> parameter for the Gamma
distribution.</p>
</td></tr>
<tr><td><code id="p.dnorm_+3A_h0.col">h0.col</code></td>
<td>
<p>color specification for the line <code class="reqn">y = 0</code>.</p>
</td></tr>
<tr><td><code id="p.dnorm_+3A_ms.lines">ms.lines</code></td>
<td>
<p>logical, used for the normal only: should lines be
drawn at the mean and <code class="reqn">\pm</code> 1 standard deviation.</p>
</td></tr>
<tr><td><code id="p.dnorm_+3A_ms.col">ms.col</code></td>
<td>
<p>color for the <code>ms</code> lines if <code>ms.lines</code> is TRUE.</p>
</td></tr>
<tr><td><code id="p.dnorm_+3A_...">...</code></td>
<td>
<p>further parameter passed to <code><a href="graphics.html#topic+curve">curve</a>()</code>, e.g.,
<code>add = TRUE</code> for adding to current plot.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Werner Stahel et al.</p>


<h3>See Also</h3>

<p>the underlying density functions,
<code><a href="stats.html#topic+dnorm">dnorm</a></code>,  <code><a href="stats.html#topic+dchisq">dchisq</a></code>,  <code><a href="stats.html#topic+dgamma">dgamma</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>p.dnorm()
p.dnorm(mu=1.5, add = TRUE, ms.lines = FALSE) # add to the plot above

p.dchisq(2, main= "Chi^2 Densities -- nu = 2,3,4")
p.dchisq(3, add = TRUE, col = "red")
p.dchisq(4, add = TRUE, col = "blue")

op &lt;- par(mfrow = c(2,2), mgp = c(1.6, 0.6,0), mar = c(3,3,1,1))
for(sh in 1:4)
   p.dgamma(sh)
par(op)
</code></pre>

<hr>
<h2 id='p.hboxp'>Add a Horizontal Boxplot to the Current Plot</h2><span id='topic+p.hboxp'></span>

<h3>Description</h3>

<p>Add a horizontal boxplot to the current plot.  This is mainly an
auxiliary function for <code><a href="#topic+histBxp">histBxp</a></code>, since
<code><a href="graphics.html#topic+boxplot">boxplot</a>(*, horizontal = TRUE, add = TRUE)</code> is usually
much preferable to this.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.hboxp(x, y.lo, y.hi, boxcol = 3,
        medcol = 2, medlwd = 5, whisklty = 2, staplelty = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.hboxp_+3A_x">x</code></td>
<td>
<p>univariate data set.</p>
</td></tr>
<tr><td><code id="p.hboxp_+3A_y.lo">y.lo</code>, <code id="p.hboxp_+3A_y.hi">y.hi</code></td>
<td>
<p>minimal and maximal <em>user</em> coordinates
<b>or</b> <code>y.lo = c(ylo,hyi)</code>.</p>
</td></tr>
<tr><td><code id="p.hboxp_+3A_boxcol">boxcol</code>, <code id="p.hboxp_+3A_medcol">medcol</code></td>
<td>
<p>color of the box and the median line.</p>
</td></tr>
<tr><td><code id="p.hboxp_+3A_medlwd">medlwd</code></td>
<td>
<p>line width of median line.</p>
</td></tr>
<tr><td><code id="p.hboxp_+3A_whisklty">whisklty</code>, <code id="p.hboxp_+3A_staplelty">staplelty</code></td>
<td>
<p>line types of the whisker and the staple,
the latter being used for the outmost non-outliers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>....
</p>


<h3>Author(s)</h3>

<p>Martin Maechler building on code from Markus and Christian Keller.</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+boxplot">boxplot</a>(**, horizontal = TRUE, add= TRUE)</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## ==&gt;  See code in 'histBxp' (.)  and  example(histBxp) !
  ##
</code></pre>

<hr>
<h2 id='p.profileTraces'>Plot a profile.nls Object With Profile Traces</h2><span id='topic+p.profileTraces'></span>

<h3>Description</h3>

<p>Displays a series of plots of the profile t function and the likelihood
profile traces for the parameters in a nonlinear regression model that
has been fitted with <code><a href="stats.html#topic+nls">nls</a></code> and profiled with
<code><a href="stats.html#topic+profile.nls">profile.nls</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.profileTraces(x, cex = 1,
                subtitle = paste("t-Profiles and traces of ",
                       deparse(attr(x,"summary")$formula)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.profileTraces_+3A_x">x</code></td>
<td>
<p>an object of class <code>"profile.nls"</code>, typically resulting from
<code>profile(<a href="stats.html#topic+nls">nls</a>(.))</code>, see
<code><a href="stats.html#topic+profile.nls">profile.nls</a></code>.</p>
</td></tr>
<tr><td><code id="p.profileTraces_+3A_cex">cex</code></td>
<td>
<p>character expansion, see <code><a href="graphics.html#topic+par">par</a>(cex =)</code>.</p>
</td></tr>
<tr><td><code id="p.profileTraces_+3A_subtitle">subtitle</code></td>
<td>
<p>a subtitle to set for the plot.  The default now
includes the <code><a href="stats.html#topic+nls">nls</a>()</code> formula used.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>the <span class="pkg">stats</span>-internal <code>stats:::plot.profile.nls</code> plot
method just does &ldquo;the diagonals&rdquo;.
</p>


<h3>Author(s)</h3>

<p>Andreas Ruckstuhl, <span class="rlang"><b>R</b></span> port by Isabelle Flückiger and Marcel Wolbers</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+profile">profile</a></code>, and <code><a href="stats.html#topic+nls">nls</a></code> (which has
unexported <code>profile</code> and <code>stats:::plot.profile.nls</code> methods).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
data(Puromycin)
Treat &lt;- Puromycin[Puromycin$state == "treated", ]
fm &lt;- nls(rate ~ T1*conc/(T2+conc), data=Treat,
          start = list(T1=207,T2=0.06))
(pr &lt;- profile(fm)) # quite a few things..
op &lt;- par(mfcol=1:2)
plot(pr) # -&gt; 2 'standard' plots
par(op)
## ours:
p.profileTraces(pr)
</code></pre>

<hr>
<h2 id='p.res.2fact'>Plot Numeric (e.g. Residuals) vs 2 Factors Using Boxplots</h2><span id='topic+p.res.2fact'></span>

<h3>Description</h3>

<p>Plots a numeric &ldquo;residual like&rdquo; variable against two factor
covariates, using boxplots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.res.2fact(x, y, z, restricted, notch = FALSE,
            xlab = NULL, ylab = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.res.2fact_+3A_x">x</code>, <code id="p.res.2fact_+3A_y">y</code></td>
<td>
<p>two factors or numeric vectors giving the levels of factors.</p>
</td></tr>
<tr><td><code id="p.res.2fact_+3A_z">z</code></td>
<td>
<p>numeric vector of same length as <code>x</code> and <code>y</code>,
typically residuals.</p>
</td></tr>
<tr><td><code id="p.res.2fact_+3A_restricted">restricted</code></td>
<td>
<p>positive value which truncates the size.  The
corresponding symbols are marked by stars.</p>
</td></tr>
<tr><td><code id="p.res.2fact_+3A_notch">notch</code></td>
<td>
<p>logical indicating if the boxplots should be notched, see
<code><a href="graphics.html#topic+boxplot">boxplot</a>(*,notch)</code>.</p>
</td></tr>
<tr><td><code id="p.res.2fact_+3A_xlab">xlab</code>, <code id="p.res.2fact_+3A_ylab">ylab</code></td>
<td>
<p>axis labels, see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>, per
default the actual argument expressions.</p>
</td></tr>
<tr><td><code id="p.res.2fact_+3A_main">main</code></td>
<td>
<p>main title passed to <code>plot</code>, defaulting to the
deparsed <code>z</code> argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if values <em>are</em> restricted, this make use of the auxiliar
function <code><a href="#topic+u.boxplot.x">u.boxplot.x</a></code>.
</p>


<h3>Author(s)</h3>

<p>Lorenz Gygax <a href="mailto:logyg@wild.unizh.ch">logyg@wild.unizh.ch</a> and Martin Maechler, Jan.95;
starting from <code><a href="#topic+p.res.2x">p.res.2x</a>()</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+p.res.2x">p.res.2x</a></code>, <code><a href="graphics.html#topic+boxplot">boxplot</a></code>,
<code><a href="stats.html#topic+plot.lm">plot.lm</a></code>, <code><a href="#topic+TA.plot">TA.plot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>I &lt;- 8; J &lt;- 3; K &lt;- 20
xx &lt;- factor(rep(rep(1:I, rep(K,I)),J))
yy &lt;- factor(rep(1:J, rep(I*K,J)))
zz &lt;- rt(I*J*K, df=5) #-- Student t with 5 d.f.
p.res.2fact(xx,yy,zz, restr= 4, main= "i.i.d. t &lt;- 5 random  |.| &lt;= 4")
mtext("p.res.2fact(xx,yy,zz, restr= 4, ..)",
      line=1, adj=1, outer=TRUE, cex=1)

## Real data
data(warpbreaks)
(fm1 &lt;- lm(breaks ~ wool*tension, data = warpbreaks))
## call via formula method of p.res.2x():
p.res.2x(~ ., fm1) # is shorter than, but equivalent to
## p.res.2x(~ wool + tension, fm1)  ##  or the direct
## with(warpbreaks, p.res.2fact(wool, tension, residuals(fm1)))
##
## whereas this is "transposed":
p.res.2x(~ tension+wool, fm1)
</code></pre>

<hr>
<h2 id='p.res.2x'>Stahel's Residual Plot against 2 X's</h2><span id='topic+p.res.2x'></span><span id='topic+p.res.2x.default'></span><span id='topic+p.res.2x.formula'></span>

<h3>Description</h3>

<p>Plot Residuals, e.g., of a multiple linear regression, against two
(predictor) variables, using positively and negatively oriented line
segments for positive and negative residuals.
</p>
<p>This is a (S3) <em>generic</em> function with a <code>default</code> and a
<code><a href="stats.html#topic+formula">formula</a></code> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.res.2x(x, ...)

## Default S3 method:
p.res.2x(x, y, z, restricted, size = 1, slwd = 1, scol = 2:3,
         xlab = NULL, ylab = NULL, main = NULL,
         xlim = range(x), ylim = range(y), ...)

## S3 method for class 'formula'
p.res.2x(x = ~., data, main = deparse(substitute(data)),
         xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.res.2x_+3A_x">x</code>, <code id="p.res.2x_+3A_y">y</code></td>
<td>
<p>numeric vectors of the same length specifying 2
covariates.  For the <code>formula</code> method, <code>x</code> is a <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="p.res.2x_+3A_z">z</code></td>
<td>
<p>numeric vector of same length as <code>x</code> and <code>y</code>,
typically residuals.</p>
</td></tr>
<tr><td><code id="p.res.2x_+3A_restricted">restricted</code></td>
<td>
<p>positive value which truncates the size.  The
corresponding symbols are marked by stars.</p>
</td></tr>
<tr><td><code id="p.res.2x_+3A_size">size</code></td>
<td>
<p>the symbols are scaled so that <code>size</code> is the size of
the largest symbol in cm.</p>
</td></tr>
<tr><td><code id="p.res.2x_+3A_slwd">slwd</code>, <code id="p.res.2x_+3A_scol">scol</code></td>
<td>
<p>line width and color(s) for the residual
<code><a href="graphics.html#topic+segments">segments</a></code>.  If <code>scol</code> has length 2 as per default,
the two colors are used for positive and negative <code>z</code> values,
respectively.</p>
</td></tr>
<tr><td><code id="p.res.2x_+3A_xlab">xlab</code>, <code id="p.res.2x_+3A_ylab">ylab</code>, <code id="p.res.2x_+3A_main">main</code></td>
<td>
<p>axis labels, and title see <code><a href="graphics.html#topic+title">title</a></code>,
each with a sensible default.  To suppress, use, e.g., <code>main = ""</code>.</p>
</td></tr>
<tr><td><code id="p.res.2x_+3A_xlim">xlim</code>, <code id="p.res.2x_+3A_ylim">ylim</code></td>
<td>
<p>the basic x- and y- axis extents, see
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.  Note that these will be slightly
extended such that segments are not cut off.</p>
</td></tr>
<tr><td><code id="p.res.2x_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot</code>, or
<code>p.res.2x.default()</code>, respectively.</p>
</td></tr>
<tr><td><code id="p.res.2x_+3A_data">data</code></td>
<td>
<p>(for the <code><a href="stats.html#topic+formula">formula</a></code> method:) a data frame or a fitted
<code>"<a href="stats.html#topic+lm">lm</a>"</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each residual <code>zz[i]</code> is visualized as line segment centered at
<code class="reqn">(xx_i,yy_i)</code>, <code class="reqn">i=1,\dots,n</code>, where the
<em>length</em>s of the segments are proportional to the absolute
values <code class="reqn">\|zz_i\|</code>.
</p>
<p>Positive residuals' line segments have slope <code class="reqn">+1</code>, and negative ones
slope <code class="reqn">-1</code>, and <code>scol</code> is used to use different colors for
negative and positive segments.
</p>
<p>The formula interface calls <code><a href="#topic+p.res.2fact">p.res.2fact</a>()</code> when
<em>both</em> <code>x</code> and <code>y</code> are <code><a href="base.html#topic+factor">factor</a></code>s.
</p>


<h3>Author(s)</h3>

<p>Andreas Ruckstuhl in June 1991 and Martin Maechler, in 1992, '94, 2003-4.</p>


<h3>References</h3>

<p>Stahel, W.~A. (2008) <em>Statistische Datenanalyse: Eine
Einführung für Naturwissenschaftler</em>,
5. Auflage, Vieweg, Wiesbaden; Paragraph 13.8.r and 13.8.v.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+p.res.2fact">p.res.2fact</a></code>,
<code><a href="stats.html#topic+plot.lm">plot.lm</a></code>,
<code><a href="#topic+TA.plot">TA.plot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xx &lt;- rep(1:10,7)
yy &lt;- rep(1:7, rep(10,7))
zz &lt;- rnorm(70)
p.res.2x(xx,yy,zz, restricted = 2, main = "i.i.d.  N(0,1) random residuals")

example(lm.influence, echo = FALSE)

op &lt;- mult.fig(2, marP=c(-1,-1,-1,0), main="p.res.2x(*,*, residuals(lm.SR))")$old.par
with(LifeCycleSavings,
     { p.res.2x(pop15, ddpi, residuals(lm.SR), scol=c("red", "blue"))
       p.res.2x(pop75, dpi,  residuals(lm.SR), scol=2:1)
     })

## with formula interface:
p.res.2x(~ pop15 + ddpi, lm.SR, scol=c("red", "blue"))
p.res.2x(~ pop75 +  dpi, lm.SR, scol=2:1)

par(op) # revert par() settings above
</code></pre>

<hr>
<h2 id='p.scales'>Conversion between plotting scales: usr, cm, symbol</h2><span id='topic+p.scales'></span>

<h3>Description</h3>

<p>Give scale conversion factors of three coordinate systems in use for
traditional R graphics: use, cm, symbol.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.scales(unit = relsysize * 2.54 * min(pin), relsysize = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.scales_+3A_unit">unit</code></td>
<td>
<p>length of unit (or x and y units) of symbol coordinates in cm.</p>
</td></tr>
<tr><td><code id="p.scales_+3A_relsysize">relsysize</code></td>
<td>
<p>same, as a proportion of the plotting area.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric 2x2 matrix, with rows named <code>x</code> and <code>y</code>, and
columns, named <code>"sy2usr"</code> and <code>"usr2cm"</code> which give the
scale conversion factors from &lsquo;symbol&rsquo; (as given) to
&lsquo;usr&rsquo; coordinates and from these to &lsquo;cm&rsquo;, respectively.
</p>


<h3>Author(s)</h3>

<p>Werner Stahel, 1990;  simplification: M.Maechler, 1993, 2004</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+par">par</a>("usr")</code>, of also <code>("pin")</code> on which this
is based.</p>


<h3>Examples</h3>

<pre><code class='language-R'>p.scales()
</code></pre>

<hr>
<h2 id='p.tachoPlot'>Draw Symbol on a Plot</h2><span id='topic+p.tachoPlot'></span>

<h3>Description</h3>

<p>Puts a symbol (pointer) on a plot at each of the specified locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.tachoPlot(x, y, z, angle=c(pi/4,3*pi/4), size,
	    method = c("robust", "sensitive", "rank"),
	    legend = TRUE, show.method = legend,
	    xlab = deparse(substitute(x)), ylab = deparse(substitute(y)),
	    xlim, ylim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.tachoPlot_+3A_x">x</code>, <code id="p.tachoPlot_+3A_y">y</code>, <code id="p.tachoPlot_+3A_z">z</code></td>
<td>
<p>coordinates of points. Numeric vectors of the same length.
Missing values (<code>NA</code>s) are allowed.</p>
</td></tr>
<tr><td><code id="p.tachoPlot_+3A_angle">angle</code></td>
<td>
<p>numeric vector whose elements give the angles between the
horizontal baseline and the minimum and maximum direction of the
pointer measured clockwise in radians.</p>
</td></tr>
<tr><td><code id="p.tachoPlot_+3A_size">size</code></td>
<td>
<p>length of the pointers in cm.</p>
</td></tr>
<tr><td><code id="p.tachoPlot_+3A_method">method</code></td>
<td>
<p>string specifying the method to calculate the angle of
the pointer.  One of <code>"sensitive"</code>, <code>"robust"</code> or
<code>"rank"</code>.  Only the first two characters are necessary.
</p>
<p>The minimum and maximum direction of the pointer corresponds to
min(z) and max(z) if method is <code>"sensitive"</code> or <code>"rank"</code>
and to the upper and lower extreme of z if method is <code>"robust"</code>
(see <code>boxplot</code> or <code>rrange</code> for details).  The angle is
proportional to z or rank(z) in case of <code>method="rank"</code>.
</p>
</td></tr>
<tr><td><code id="p.tachoPlot_+3A_legend">legend</code></td>
<td>
<p>logical flag: if <code>TRUE</code> (default), a legend giving
the values of the minimum and maximum direction of the pointer is drawn.</p>
</td></tr>
<tr><td><code id="p.tachoPlot_+3A_show.method">show.method</code></td>
<td>
<p>logical flag, defaulting to <code>legend</code>; if true,
the method name is printed.</p>
</td></tr>
<tr><td><code id="p.tachoPlot_+3A_xlab">xlab</code>, <code id="p.tachoPlot_+3A_ylab">ylab</code></td>
<td>
<p>labels for x and y axis; defaults to the
&lsquo;expression&rsquo; used in the function call.</p>
</td></tr>
<tr><td><code id="p.tachoPlot_+3A_xlim">xlim</code>, <code id="p.tachoPlot_+3A_ylim">ylim</code></td>
<td>
<p>numeric of length 2, the limits for the x and y axis,
respectively; see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="p.tachoPlot_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="base.html#topic+plot">plot</a></code>.  Graphical
parameters (see <code><a href="graphics.html#topic+par">par</a></code>) may also be supplied as arguments
to this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A scatter plot of the variables x and y is plotted. The value of the third
variable z is given by the direction of a pointer (similar to a
tachometer). Observations whose z-coordinate is missing are marked by a dot.
</p>


<h3>Side Effects</h3>

<p>A plot is created on the current graphics device.
</p>


<h3>Author(s)</h3>

<p>Christian Keller, June 1995</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+symbols">symbols</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(state)
data(USArrests)
p.tachoPlot(state.center $x, state.center $y, USArrests[,"UrbanPop"])

data(mtcars)
par(mfrow=c(2,2))
## see the difference between the three methods (not much differ. here!)
p.tachoPlot(mtcars$hp, mtcars$disp, mtcars$mpg, method="sens")
p.tachoPlot(mtcars$hp, mtcars$disp, mtcars$mpg, method="rank")
p.tachoPlot(mtcars$hp, mtcars$disp, mtcars$mpg, method="rob")
</code></pre>

<hr>
<h2 id='p.ts'>plot.ts with multi-plots and Auto-Title &ndash; on 1 page</h2><span id='topic+p.ts'></span>

<h3>Description</h3>

<p>For longer time-series, it is sometimes important to spread the
time-series plots over several subplots.
p.ts(.) does this both automatically, and under manual control.
</p>
<p>Actually, this is a generalization of <code><a href="stats.html#topic+plot.ts">plot.ts</a></code>
(with different defaults).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.ts(x, nrplots = max(1, min(8, n %/% 400)), overlap = nk %/% 16,
     date.x = NULL, do.x.axis = !is.null(date.x), do.x.rug = FALSE,
     ax.format, main.tit = NULL, ylim = NULL, ylab = "", xlab = "Time",
     quiet = FALSE, mgp = c(1.25, .5, 0), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.ts_+3A_x">x</code></td>
<td>
<p>timeseries (possibly multivariate) or numeric vector.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_nrplots">nrplots</code></td>
<td>
<p>number of sub-plots.  Default: in {1..8},
approximately <code>n/400</code> if possible.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_overlap">overlap</code></td>
<td>
<p>by how much should subsequent plots overlap. Defaults
to about 1/16 of sub-length on each side.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_date.x">date.x</code></td>
<td>
<p>a time &ldquo;vector&rdquo; of the same length as <code>x</code>
and coercable to class <code>"POSIXct"</code> (see <a href="base.html#topic+DateTimeClasses">DateTimeClasses</a>).</p>
</td></tr>
<tr><td><code id="p.ts_+3A_do.x.axis">do.x.axis</code></td>
<td>
<p>logical specifying if an x axis should be drawn
(i.e., tick marks and labels).</p>
</td></tr>
<tr><td><code id="p.ts_+3A_do.x.rug">do.x.rug</code></td>
<td>
<p>logical specifying if <code><a href="graphics.html#topic+rug">rug</a></code> of
<code>date.x</code> values should drawn along the x axis.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_ax.format">ax.format</code></td>
<td>
<p>when <code>do.x.axis</code> is true, specify the
<code>format</code> to be used in the call to <code><a href="graphics.html#topic+axis.POSIXct">axis.POSIXct</a></code>.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_main.tit">main.tit</code></td>
<td>
<p><b>Main</b> title (over all plots).  Defaults to name
of <code>x</code>.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_ylim">ylim</code></td>
<td>
<p>numeric(2) or NULL; if the former, specifying the y-range
for the plots. Defaults to a common pretty range.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_ylab">ylab</code>, <code id="p.ts_+3A_xlab">xlab</code></td>
<td>
<p>labels for y- and x-axis respectively, see
description in <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_quiet">quiet</code></td>
<td>
<p>logical; if <code>TRUE</code>, there's no reporting on each subplot.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_mgp">mgp</code></td>
<td>
<p>numeric(3) to be passed to <code><a href="#topic+mult.fig">mult.fig</a>()</code>, see
<code><a href="graphics.html#topic+par">par</a>(mgp = .)</code>.</p>
</td></tr>
<tr><td><code id="p.ts_+3A_...">...</code></td>
<td>
<p>further graphic parameters for each <code><a href="stats.html#topic+plot.ts">plot.ts</a>(..)</code>.</p>
</td></tr>
</table>


<h3>Side Effects</h3>

<p>A page of <code>nrplots</code> subplots is drawn on the current
graphics device.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, <a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>; July 1994 (for S).</p>


<h3>See Also</h3>

<p><code>p.ts()</code> calls <code><a href="#topic+mult.fig">mult.fig</a>()</code> for setup.
Further, <code><a href="stats.html#topic+plot.ts">plot.ts</a></code> and <code><a href="base.html#topic+plot">plot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stopifnot(require(stats))
## stopifnot(require(datasets))

data(sunspots)
p.ts(sunspots, nr=1) # == usual  plot.ts(..)
p.ts(sunspots)
p.ts(sunspots, nr=3, col=2)

data(EuStockMarkets)
p.ts(EuStockMarkets[,"SMI"])
## multivariate :
p.ts(log10(EuStockMarkets), col = 2:5)

## with Date - x-axis (dense random dates):
set.seed(12)
x &lt;- as.Date("2000-02-29") + cumsum(1+ rpois(1000, lambda= 2.5))
z &lt;- cumsum(.1 + 2*rt(1000, df=3))
p.ts(z, 4, date.x = x)
p.ts(z, 6, date.x = x, ax.format = "%b %Y", do.x.rug = TRUE)
</code></pre>

<hr>
<h2 id='paste.vec'>Utility for 'Showing' S vectors</h2><span id='topic+paste.vec'></span>

<h3>Description</h3>

<p>A simple utility for displaying simple S vectors;
can be used as debugging utility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paste.vec(name, digits = options()$digits)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paste.vec_+3A_name">name</code></td>
<td>
<p>string with an variable name which must exist in the
current environment (<span class="rlang"><b>R</b></span> session).</p>
</td></tr>
<tr><td><code id="paste.vec_+3A_digits">digits</code></td>
<td>
<p>how many decimal digits to be used; passed to
<code><a href="base.html#topic+format">format</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string of the form &quot;NAME =  x1 x2 ...&quot;
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, about 1992.</p>


<h3>Examples</h3>

<pre><code class='language-R'> x &lt;- 1:4
 paste.vec(x)   ##-&gt;  "x = 1 2 3 4"
</code></pre>

<hr>
<h2 id='pkgDesc'>Version of packageDescription() as Simple Vector</h2><span id='topic+pkgDesc'></span><span id='topic+pkgBuilt'></span>

<h3>Description</h3>

<p>a simple &ldquo;version&rdquo;, or wrapper for
<code><a href="utils.html#topic+packageDescription">packageDescription</a>()</code>, returning a named character vector,
including <code>"file"</code>, and still has a useful <code><a href="base.html#topic+print">print</a>()</code>
method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkgDesc (pkg, lib.loc = NULL, fields = NULL, ...)
pkgBuilt(pkg, lib.loc = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pkgDesc_+3A_pkg">pkg</code></td>
<td>
<p>a <code><a href="base.html#topic+character">character</a></code> string, name of an installed <span class="rlang"><b>R</b></span> package.</p>
</td></tr>
<tr><td><code id="pkgDesc_+3A_lib.loc">lib.loc</code></td>
<td>
<p>library location to find the package in; the default
<code>NULL</code> uses the full <code><a href="base.html#topic+.libPaths">.libPaths</a>()</code>.</p>
</td></tr>
<tr><td><code id="pkgDesc_+3A_fields">fields</code></td>
<td>
<p>a character vector (or <code>NULL</code>) specifying fields to be returned.</p>
</td></tr>
<tr><td><code id="pkgDesc_+3A_...">...</code></td>
<td>
<p>further optional arguments passed to <code><a href="utils.html#topic+packageDescription">packageDescription</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named <code><a href="base.html#topic+character">character</a></code> vector, with <code><a href="base.html#topic+names">names</a></code>, the
<em>fields</em>, identical to the names of the <code><a href="base.html#topic+list">list</a></code> returned
by <code><a href="utils.html#topic+packageDescription">packageDescription</a></code>, plus its <code>"file"</code> attribute.
Additionally the resulting vector is of class <code>"Dlist"</code> which
activates a useful <code><a href="base.html#topic+print">print</a>()</code> method.
</p>


<h3>Note</h3>

<p>The <code>file</code> is always returned; not the least that the author
wants to see it quite often as his <code><a href="base.html#topic+.libPaths">.libPaths</a>()</code> is
non-trivial and typically longer than 4 entries.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Jan. 2021</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+packageDescription">packageDescription</a></code>,
<code><a href="base.html#topic+.libPaths">.libPaths</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(pd &lt;- pkgDesc("sfsmisc"))
pd[c("Date","Packaged", "Built","file")]

pkgBuilt("sfsmisc")

## Show "Built" (and "file") for all packages whose namespaces are loaded:
lNs &lt;- loadedNamespaces()
mlNs &lt;- sapply(lNs, pkgBuilt)
t(mlNs) # typically prints nicely

pkgs &lt;- c("grid", "lattice", "MASS", "Matrix", "nlme", "lme4", "sfsmisc")
pkgs &lt;- c("foobar", "barbar", pkgs, "kitty") # + names that typically don't exist
pkgsOk &lt;- basename(find.package(pkgs, quiet=TRUE))
mpkg &lt;- sapply(pkgsOk, pkgBuilt)
stopifnot(is.matrix(mpkg), nrow(mpkg) == 2)
mpkg["Built",]
</code></pre>

<hr>
<h2 id='pkgLibs'>R Package Compiled Code Library Dependencies (on Unix-alikes)</h2><span id='topic+pkgLibs'></span>

<h3>Description</h3>

<p>List some system level information about the compiled code library,
typically its dependencies, for <span class="rlang"><b>R</b></span> packages with compiled code; for
Unix-alikes or more generally when <code>cmd</code> is installed locally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkgLibs(pkg,
        cmd = if(Sys.info()[["sysname"]] == "Darwin") "otool -L" else "ldd")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pkgLibs_+3A_pkg">pkg</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> vector of package names of
<em>installed</em> <span class="rlang"><b>R</b></span> packages.</p>
</td></tr>
<tr><td><code id="pkgLibs_+3A_cmd">cmd</code></td>
<td>
<p>a <code>character</code> string with the name of an OS / system
level program (to be called via <code><a href="base.html#topic+system">system</a>(cmd, ..)</code>) which
gives information about the shared  library (of compiled code), also
known as &ldquo;DLL&rdquo; (dynamically loadable library) or
&ldquo;so&rdquo; ((dynamic) shared object) library.  The default,
<code>"ldd"</code> is a standard binary utility on Unix-alike platforms
such as Linux.  On macOS, <code>"oTool -L"</code> is used by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that there seems some language confusion as &ldquo;DLL&rdquo; on Windows
is <em>also</em> used for &ldquo;Dynamic-link Library&rdquo; and Wikipedia warns about
confusing the two concepts (&ldquo;dynamically loaded ..&rdquo; vs
&ldquo;dynamic-link ..&rdquo;).
</p>


<h3>Value</h3>

<p>a named <code><a href="base.html#topic+list">list</a></code> with one entry per package in <code>pkg</code>, the
<code><a href="base.html#topic+names">names</a></code> being the directory / folder names of the
corresponding pkgs from <code>pkg</code>.
</p>
<p>The exact structure of such entries is currently subject to change and
you should not rely on its exact format for now.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>References</h3>

<p>&lsquo;Dynamic Loading&rsquo; on Wikipedia,
<a href="https://en.wikipedia.org/wiki/Dynamic_loading">https://en.wikipedia.org/wiki/Dynamic_loading</a>
</p>
<p>On Windows, &ldquo;DLL&rdquo; is also used for Dynamic-link library,
<a href="https://en.wikipedia.org/wiki/Dynamic-link_library">https://en.wikipedia.org/wiki/Dynamic-link_library</a>.
</p>
<p><code>man ldd</code> from a terminal on a valid OS.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+dyn.load">dyn.load</a>()</code>,
<code><a href="base.html#topic+library.dynam">library.dynam</a>()</code>, and <code><a href="base.html#topic+getLoadedDLLs">getLoadedDLLs</a>()</code>.
</p>
<p>Also, <code><a href="base.html#topic+.C">.C</a></code>, <code><a href="base.html#topic+.Call">.Call</a></code> which use such DLLs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for the example only using standard R packages :
myPkgs &lt;- c("stats", "MASS", "rpart", "Matrix")
pl &lt;- pkgLibs(myPkgs)
pl
stopifnot(exprs = {
  is.list(pl)
  length(pl) == length(myPkgs)
  is.character(pkgD &lt;- names(pl))
})
## Have seen this failing when a strange development version of "Matrix" was picked up:
try( stopifnot( dir.exists(pkgD)) )
</code></pre>

<hr>
<h2 id='plotDS'>Plot Data and Smoother / Fitted Values</h2><span id='topic+plotDS'></span>

<h3>Description</h3>

<p>For one-dimensional nonparametric regression, plot the data and fitted
values, typically a smooth function, and optionally use segments to
visualize the residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDS(x, yd, ys, xlab = "", ylab = "", ylim = rrange(c(yd, ys)),
       xpd = TRUE, do.seg = TRUE, seg.p = 0.95,
       segP = list(lty = 2, lwd = 1,   col = 2),
       linP = list(lty = 1, lwd = 2.5, col = 3),
       ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDS_+3A_x">x</code>, <code id="plotDS_+3A_yd">yd</code>, <code id="plotDS_+3A_ys">ys</code></td>
<td>
<p>numeric vectors all of the same length, representing
<code class="reqn">(x_i, y_i)</code> and fitted (smooth) values <code class="reqn">\hat{y}_i</code>.
<code>x</code> will be sorted increasingly if necessary, and <code>yd</code> and
<code>ys</code> accordingly.
</p>
<p>Alternatively, <code>ys</code> can be an x-y list (as resulting from
<code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>) containing fitted values on a
finer grid than the observations <code>x</code>.  In that case, the
observational values <code>x[]</code> <b>must</b> be part of the larger
set; <code><a href="#topic+seqXtend">seqXtend</a>()</code> may be applied to construct such a set
of abscissa values.
</p>
</td></tr>
<tr><td><code id="plotDS_+3A_xlab">xlab</code>, <code id="plotDS_+3A_ylab">ylab</code></td>
<td>
<p>x- and y- axis labels, as in <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="plotDS_+3A_ylim">ylim</code></td>
<td>
<p>limits of y-axis to be used; defaults to a <em>robust</em>
range of the values.</p>
</td></tr>
<tr><td><code id="plotDS_+3A_xpd">xpd</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a>(xpd=.)</code>; by default do allow to draw
outside the plot region.</p>
</td></tr>
<tr><td><code id="plotDS_+3A_do.seg">do.seg</code></td>
<td>
<p>logical indicating if residual segments should be drawn,
at <code>x[i]</code>, from <code>yd[i]</code> to <code>ys[i]</code> (approximately,
see <code>seg.p</code>).</p>
</td></tr>
<tr><td><code id="plotDS_+3A_seg.p">seg.p</code></td>
<td>
<p>segment percentage of segments to be drawn, from
<code>yd</code> to <code>seg.p*ys + (1-seg.p)*yd</code>.</p>
</td></tr>
<tr><td><code id="plotDS_+3A_segp">segP</code></td>
<td>
<p>list with named components <code>lty, lwd, col</code> specifying
line type, width and color for the residual segments,
used only when <code>do.seg</code> is true.</p>
</td></tr>
<tr><td><code id="plotDS_+3A_linp">linP</code></td>
<td>
<p>list with named components <code>lty, lwd, col</code> specifying
line type, width and color for &ldquo;smooth curve lines&rdquo;.</p>
</td></tr>
<tr><td><code id="plotDS_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Non-existing components in the lists <code>segP</code> or <code>linP</code>
will result in the <code><a href="graphics.html#topic+par">par</a></code> defaults to be used.
</p>
<p><code>plotDS()</code> used to be called <code>pl.ds</code> up to November 2007.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, since 1990</p>


<h3>See Also</h3>

<p><code><a href="#topic+seqXtend">seqXtend</a>()</code> to construct more smooth <code>ys</code>
&ldquo;objects&rdquo;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(cars)
 x &lt;-  cars$speed
 yd &lt;- cars$dist
 ys &lt;- lowess(x, yd, f = .3)$y
 plotDS(x, yd, ys)

 ## More interesting : Version of example(Theoph)
 data(Theoph)
 Th4 &lt;- subset(Theoph, Subject == 4)
 ## just for "checking" purposes -- permute the observations:
 Th4 &lt;- Th4[sample(nrow(Th4)), ]
 fm1 &lt;- nls(conc ~ SSfol(Dose, Time, lKe, lKa, lCl), data = Th4)

 ## Simple
 plotDS(Th4$Time, Th4$conc, fitted(fm1),
        sub  = "Theophylline data - Subject 4 only",
        segP = list(lty=1,col=2), las = 1)

 ## Nicer: Draw the smoother not only at x = x[i] (observations):
 xsm &lt;- unique(sort(c(Th4$Time, seq(0, 25, length = 201))))
 ysm &lt;- c(predict(fm1, newdata = list(Time = xsm)))
 plotDS(Th4$Time, Th4$conc, ys = list(x=xsm, y=ysm),
        sub  = "Theophylline data - Subject 4 only",
        segP = list(lwd=2), las = 1)
</code></pre>

<hr>
<h2 id='plotStep'>Plot a Step Function</h2><span id='topic+plotStep'></span>

<h3>Description</h3>

<p>Plots a step function
f(x)= <code class="reqn">\sum_i  y_i  1_[ t_{i-1}, t_i ](x) </code>, i.e., a piecewise constant function of one variable.
With one argument, plots <b>the</b> empirical cumulative distribution
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotStep(ti, y,
          cad.lag = TRUE,
          verticals = !cad.lag,
          left.points= cad.lag, right.points= FALSE, end.points= FALSE,
	  add = FALSE,
	  pch = par('pch'),
          xlab=deparse(substitute(ti)), ylab=deparse(substitute(y)),
          main=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotStep_+3A_ti">ti</code></td>
<td>
<p>numeric vector = <code>X[1:N]</code> or  <code>t[0:n]</code>.</p>
</td></tr>
<tr><td><code id="plotStep_+3A_y">y</code></td>
<td>
<p>numeric vector <code>y[1:n]</code>; if omitted take y = k/N
for empirical CDF.</p>
</td></tr>
<tr><td><code id="plotStep_+3A_cad.lag">cad.lag</code></td>
<td>
<p>logical: Draw 'cad.lag', i.e., &ldquo;<em>continue à
droite, limite à gauche</em>&rdquo;.  Default = TRUE.</p>
</td></tr>
<tr><td><code id="plotStep_+3A_verticals">verticals</code></td>
<td>
<p>logical: Draw vertical lines?  Default= <code>! cad.lag</code></p>
</td></tr>
<tr><td><code id="plotStep_+3A_left.points">left.points</code></td>
<td>
<p>logical: Draw left points?     Default= <code>cad.lag</code></p>
</td></tr>
<tr><td><code id="plotStep_+3A_right.points">right.points</code></td>
<td>
<p>logical: Draw right points?    Default= <code>FALSE</code></p>
</td></tr>
<tr><td><code id="plotStep_+3A_end.points">end.points</code></td>
<td>
<p>logical: Draw 2 end points?    Default= <code>FALSE</code></p>
</td></tr>
<tr><td><code id="plotStep_+3A_add">add</code></td>
<td>
<p>logical: Add to existing plot?    Default= <code>FALSE</code></p>
</td></tr>
<tr><td><code id="plotStep_+3A_pch">pch</code></td>
<td>
<p>plotting character for points, see <code><a href="graphics.html#topic+par">par</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotStep_+3A_xlab">xlab</code>, <code id="plotStep_+3A_ylab">ylab</code></td>
<td>
<p>labels of x- and y-axis</p>
</td></tr>
<tr><td><code id="plotStep_+3A_main">main</code></td>
<td>
<p>main title; defaults to the call' if you do not want a title,
use <code>main = ""</code>.</p>
</td></tr>
<tr><td><code id="plotStep_+3A_...">...</code></td>
<td>
<p>Any valid argument to <code><a href="base.html#topic+plot">plot</a>(..)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><b>invisibly</b>:  List with components <code>t</code> and <code>y</code>.
</p>


<h3>Side Effects</h3>

<p>Calls plot(..), points(..),  segments(..) appropriately
and plots on current graphics device.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Seminar for Statistics, ETH Zurich,
<a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>, 1991 ff.
</p>


<h3>See Also</h3>

<p>The <code><a href="base.html#topic+plot">plot</a></code> methods <code><a href="stats.html#topic+plot.ecdf">plot.ecdf</a></code> and
<code><a href="stats.html#topic+plot.stepfun">plot.stepfun</a></code> in <span class="rlang"><b>R</b></span> which are conceptually nicer.
</p>
<p><code><a href="graphics.html#topic+segments">segments</a>(..., method = "constant")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##-- Draw an Empirical CDF  (and see the default title ..)
plotStep(rnorm(15))

plotStep(runif(25), cad.lag=FALSE)
plotStep(runif(25), cad.lag=FALSE, add=TRUE, lty = 2)

ui &lt;- sort(runif(20))
plotStep(ui, ni &lt;- cumsum(rpois(19, lambda=1.5) - 1.5), cad.lag = FALSE)
plotStep(ui, ni, verticals = TRUE, right.points = TRUE)

plotStep(rnorm(201), pch = '.') #- smaller points
</code></pre>

<hr>
<h2 id='polyn.eval'>Evaluate Polynomials</h2><span id='topic+polyn.eval'></span>

<h3>Description</h3>

<p>Evaluate one or several univariate polynomials at several locations,
i.e. compute <code>coef[1] + coef[2]*x + ... + coef[p+1]* x^p</code>
(in the simplest case where <code>x</code> is scalar and <code>coef</code> a vector).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polyn.eval(coef, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polyn.eval_+3A_coef">coef</code></td>
<td>
<p>&ldquo;numeric&rdquo; vector or matrix.  If a vector, <code>x</code> can be an
array and the result matches <code>x</code>.<br />
If <code>coef</code> is a matrix it specifies several polynomials of the
same degree as rows, <code>x</code> must be a vector, <code>coef[,k]</code> is
for <code class="reqn">x^{k-1}</code> and the result
is a matrix of dimension <code>length(x) * nrow(coef)</code>.
</p>
<p>Note that <code>coef</code> can also be <code><a href="base.html#topic+complex">complex</a></code> or bigrational
(<code>as.bigq(.)</code> from <a href="https://CRAN.R-project.org/package=gmp"><span class="pkg">gmp</span></a>, or arbitrary precision
(<code>"mpfr"</code>) from <a href="https://CRAN.R-project.org/package=Rmpfr"><span class="pkg">Rmpfr</span></a>, or similar number-like objects
for which basic arithmetic is defined.
</p>
</td></tr>
<tr><td><code id="polyn.eval_+3A_x">x</code></td>
<td>
<p>&ldquo;numeric&rdquo; vector or array.  Either <code>x</code> or <code>coef</code> must
be a vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The stable &ldquo;Horner rule&rdquo; is used for evaluation in any case.
</p>


<h3>Value</h3>

<p>numeric vector or array, depending on input dimensionalities, see above.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, ages ago.</p>


<h3>See Also</h3>

<p>For much more sophisticated handling of polynomials, use the
<a href="https://CRAN.R-project.org/package=polynom"><span class="pkg">polynom</span></a> package, see, e.g., <code><a href="polynom.html#topic+predict.polynomial">predict.polynomial</a></code>.
For multivariate polynomials (and also for nice interface to the
<a href="https://CRAN.R-project.org/package=orthopolynom"><span class="pkg">orthopolynom</span></a> package), consider the <a href="https://CRAN.R-project.org/package=mpoly"><span class="pkg">mpoly</span></a> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>polyn.eval(c(1,-2,1), x = 0:3)# (x - 1)^2
polyn.eval(c(0, 24, -50, 35, -10, 1), x = matrix(0:5, 2,3))# 5 zeros!
(cf &lt;- rbind(diag(3), c(1,-2,1)))
polyn.eval(cf, 0:5)

x  &lt;- seq(-3,7, by=1/4)
cf &lt;- 4:1
(px &lt;- polyn.eval(cf, x)) # is exact
if((gmpT &lt;-"package:gmp" %in% search()) || require("gmp")) withAutoprint({
 pxq &lt;- polyn.eval(coef = as.bigq(cf, 1), x=x)
 pxq
 stopifnot(pxq == px)
 if(!gmpT) detach("package:gmp")
})

if((RmpfrT &lt;-"package:Rmpfr" %in% search()) || require("Rmpfr")) withAutoprint({
 pxM &lt;- polyn.eval(coef = mpfr(cf, 80), x=x) # 80 bits accuracy
 pxM
 stopifnot(pxM == px)
 if(!RmpfrT) detach("package:Rmpfr")
})

</code></pre>

<hr>
<h2 id='posdefify'>Find a Close Positive Definite Matrix</h2><span id='topic+posdefify'></span>

<h3>Description</h3>

<p>From a matrix <code>m</code>, construct a <em>&quot;close&quot;</em> positive definite
one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posdefify(m, method = c("someEVadd", "allEVadd"),
          symmetric = TRUE, eigen.m = eigen(m, symmetric= symmetric),
          eps.ev = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posdefify_+3A_m">m</code></td>
<td>
<p>a numeric (square) matrix.</p>
</td></tr>
<tr><td><code id="posdefify_+3A_method">method</code></td>
<td>
<p>a string specifying the method to apply; can be abbreviated.</p>
</td></tr>
<tr><td><code id="posdefify_+3A_symmetric">symmetric</code></td>
<td>
<p>logical, simply passed to <code><a href="base.html#topic+eigen">eigen</a></code> (unless
<code>eigen.m</code> is specified); currently, we do not see any reason
for <em>not</em> using <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="posdefify_+3A_eigen.m">eigen.m</code></td>
<td>
<p>the <code><a href="base.html#topic+eigen">eigen</a></code> value decomposition of
<code>m</code>, can be specified in case it is already available.</p>
</td></tr>
<tr><td><code id="posdefify_+3A_eps.ev">eps.ev</code></td>
<td>
<p>number specifying the tolerance to use, see Details
below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We form the eigen decomposition
</p>
<p style="text-align: center;"><code class="reqn">m = V \Lambda V'</code>
</p>
<p> where <code class="reqn">\Lambda</code> is the
diagonal matrix of eigenvalues, <code class="reqn">\Lambda_{j,j} = \lambda_j</code>, with <em>decreasing</em> eigenvalues <code class="reqn">\lambda_1 \ge
    \lambda_2 \ge \ldots \ge \lambda_n</code>.
</p>
<p>When the smallest eigenvalue <code class="reqn">\lambda_n</code> are less than
<code>Eps &lt;- eps.ev * abs(lambda[1])</code>, i.e., negative or &ldquo;almost
zero&rdquo;, some or all eigenvalues are replaced by <em>positive</em>
(<code>&gt;= Eps</code>) values,
<code class="reqn">\tilde\Lambda_{j,j} = \tilde\lambda_j</code>.
Then, <code class="reqn">\tilde m = V \tilde\Lambda V'</code> is computed
and rescaled in order to keep the original diagonal (where that is
<code>&gt;= Eps</code>).
</p>


<h3>Value</h3>

<p>a matrix of the same dimensions and the &ldquo;same&rdquo; diagonal
(i.e. <code><a href="base.html#topic+diag">diag</a></code>) as <code>m</code> but with the property to
be positive definite.
</p>


<h3>Note</h3>

<p>As we found out, there are more sophisticated algorithms to solve
this and related problems.  See the references and the
<code><a href="Matrix.html#topic+nearPD">nearPD</a>()</code> function in the <a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a> package.
We consider <code>nearPD()</code> to also be the successor of this package's <code><a href="#topic+nearcor">nearcor</a>()</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, July 2004</p>


<h3>References</h3>

<p>Section 4.4.2 of
Gill, P.~E., Murray, W. and Wright, M.~H. (1981)
<em>Practical Optimization</em>, Academic Press.
</p>
<p>Cheng, Sheung Hun and Higham, Nick (1998)
A Modified Cholesky Algorithm Based on a Symmetric Indefinite Factorization;
<em>SIAM J. Matrix Anal.\ Appl.</em>, <b>19</b>, 1097&ndash;1110.
</p>
<p>Knol DL, ten Berge JMF (1989)
Least-squares approximation of an improper correlation matrix by a
proper one.
<em>Psychometrika</em> <b>54</b>, 53&ndash;61.
</p>
<p>Highham (2002)
Computing the nearest correlation matrix - a problem from finance;
<em>IMA Journal of Numerical Analysis</em> <b>22</b>, 329&ndash;343.
</p>
<p>Lucas (2001)
Computing nearest covariance and correlation matrices.  A thesis
submitted to the University of Manchester for the degree of Master of
Science in the Faculty of Science and Engeneering.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+eigen">eigen</a></code> on which the current methods rely.
<code><a href="Matrix.html#topic+nearPD">nearPD</a>()</code> in the <a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a> package.
(Further, the deprecated <code><a href="#topic+nearcor">nearcor</a>()</code> from this package.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(12)
 m &lt;- matrix(round(rnorm(25),2), 5, 5); m &lt;- 1+ m + t(m); diag(m) &lt;- diag(m) + 4
 m
 posdefify(m)
 1000 * zapsmall(m - posdefify(m))
</code></pre>

<hr>
<h2 id='potatoes'>Fisher's Potato Crop Data</h2><span id='topic+potatoes'></span>

<h3>Description</h3>

<p>Fisher's potato crop data set is of historical interest as an early
example of a multi-factor block design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(potatoes)</code></pre>


<h3>Format</h3>

<p>A data frame with 64 observations on the following 5 variables.
</p>

<dl>
<dt>pos</dt><dd><p>a factor with levels <code>1:4</code>.</p>
</dd>
<dt>treat</dt><dd><p>a factor with 16 levels <code>A</code> to <code>H</code> and
<code>J</code> to <code>Q</code>, i.e., <code>LETTERS[1:17][-9]</code>.</p>
</dd>
<dt>nitrogen</dt><dd><p>a factor specifying the amount of nitrogen
sulfate (<code class="reqn">NH_4</code>), with the four levels <code>0,1,2,4</code>.</p>
</dd>
<dt>potash</dt><dd><p>a factor specifying the amount of potassium (K,
&lsquo;kalium&rsquo;) sulfate, with the four levels <code>0,1,2,4</code>.</p>
</dd>
<dt>yield</dt><dd><p>a numeric vector giving the yield of potatoes in ...</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bennett, J. H. (1972)
<em>Collected Papers of R. A. Fischer</em> vol.~II, 1925-31;
The University of Adelaide.


</p>


<h3>References</h3>

<p>T.Eden and R. A. Fisher (1929)
Studies in Crop Variation. VI. Experiments on the Response of the
Potato to Potash and Nitrogen.
<em>J. Agricultural Science</em> <b>19</b>, 201&ndash;213.
Accessible from Bennett (1972), see above.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(potatoes)
## See the experimental design:
with(potatoes, {
     cat("4 blocks of experiments;",
         "each does every (nitrogen,potash) combination (aka 'treat'ment) once.",
         '', sep="\n")
     print(ftable(table(nitrogen, potash, treat)))
     print(ftable(tt &lt;- table(pos,potash,nitrogen)))
     tt[cbind(pos,potash,nitrogen)] &lt;- as.character(treat)
     cat("The 4 blocks  pos = 1, 2, 3, 4:\n")
     ftable(tt)
     })
## First plot:
with(potatoes, interaction.plot(potash,nitrogen, response=yield))

## ANOVAs:
summary(aov(yield ~ nitrogen * potash + Error(pos), data = potatoes))
    # "==&gt;" can use simply
summary(aov(yield ~ nitrogen + potash + pos, data = potatoes))
    # and
summary(aov(yield ~ nitrogen + potash, data = potatoes))
</code></pre>

<hr>
<h2 id='pretty10exp'>Nice  10 ** k  Label Expressions</h2><span id='topic+pretty10exp'></span>

<h3>Description</h3>

<p>Produce nice <code class="reqn">a \times 10^k</code> expressions to be used
instead of the scientific notation  <code>"a E&lt;k&gt;"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretty10exp(x, drop.1 = FALSE, sub10 = FALSE, digits = 7, digits.fuzz,
            lab.type = c("plotmath","latex"),
            lab.sep = c("cdot", "times"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pretty10exp_+3A_x">x</code></td>
<td>
<p>numeric vector (e.g. axis tick locations)</p>
</td></tr>
<tr><td><code id="pretty10exp_+3A_drop.1">drop.1</code></td>
<td>
<p>logical indicating if <code class="reqn">1 \times</code> should be
dropped from the resulting expressions.</p>
</td></tr>
<tr><td><code id="pretty10exp_+3A_sub10">sub10</code></td>
<td>
<p>logical, <code>"10"</code>, a non-negative integer number or
an integer vector of length two, say <code class="reqn">(k_1,k_2)</code>, indicating if some
<code class="reqn">10^j</code> expressions for <code class="reqn">j \in J</code> should be formatted
traditionally, notably e.g., <code class="reqn">10^0 \equiv 1</code>.
<br />
When a (non-negative) number, say <code class="reqn">k</code>, <code class="reqn">J = \{j; j \le k\}</code> are all simplified, when a length&ndash;2 vector,
<code class="reqn">J = \{j; k_1 \le j \le k_2\}</code> are.
</p>
<p>Special cases: <code>sub10 = TRUE</code> means to use
<code class="reqn">1</code> instead of <code class="reqn">10^0</code> and <code>sub10 = "10"</code> uses both
<code class="reqn">1</code> for <code class="reqn">10^0</code> and <code class="reqn">10</code> for <code class="reqn">10^1</code>; these are short
forms of <code>sub10 = c(0,0)</code> and <code>sub10 = c(0,1)</code> respectively.
</p>
</td></tr>
<tr><td><code id="pretty10exp_+3A_digits">digits</code></td>
<td>
<p>number of digits for mantissa (<code class="reqn">a</code>) construction;
the number of <em>significant</em> digits, see <code><a href="base.html#topic+signif">signif</a></code>.</p>
</td></tr>
<tr><td><code id="pretty10exp_+3A_digits.fuzz">digits.fuzz</code></td>
<td>
<p>the old deprecated name for <code>digits</code>.</p>
</td></tr>
<tr><td><code id="pretty10exp_+3A_lab.type">lab.type</code></td>
<td>
<p>a string indicating how the result should look like.
By default, (<code><a href="grDevices.html#topic+plotmath">plotmath</a></code>-compatible)
<code><a href="base.html#topic+expression">expression</a></code>s are returned. Alternatively,
<code>lab.type = "plotmath"</code> returns LaTeX formatted strings for
labels.  (The latter is useful, e.g., when using the <a href="https://CRAN.R-project.org/package=tikzDevice"><span class="pkg">tikzDevice</span></a>
package to generate LaTeX-processed figures.)</p>
</td></tr>
<tr><td><code id="pretty10exp_+3A_lab.sep">lab.sep</code></td>
<td>
<p>character separator between mantissa and exponent for
LaTeX labels; it will be prepended with a backslash,
i.e., &lsquo;&quot;cdot&quot;&rsquo; will use &lsquo;&quot;\cdot&quot;&rsquo;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For the default <code>lab.type = "plotmath"</code>,
an expression of the same length as <code>x</code>, typically with elements
of the form <code>a %*% 10 ^ k</code>.
Exceptions are <code>0</code> which is kept simple, if <code>drop.1</code> is
true and <code class="reqn">a = 1</code>, <code>10 ^ k</code> is used, and if <code>sub10</code>
is not false, <code>a %*% 10 ^ 0</code> as <code>a</code>, and <code>a %*% 10 ^ k</code> as
as the corresponding formatted number <code>a * 10^k</code> independently of
<code>drop.1</code>.
</p>
<p>Otherwise, a <code><a href="base.html#topic+character">character</a></code> vector of the same length as
<code>x</code>.  For <code>lab.type = "latex"</code>, currently the only
alternative to the default, these strings are LaTeX (math mode)
compatible strings.
</p>


<h3>Note</h3>

<p>If <code>sub10</code> is set, it will typically be a small number such as 0,
1, or 2.  Setting <code>sub10 = TRUE</code> will be interpreted as
<code>sub10 =1</code> where resulting exponents <code class="reqn">k</code> will either be
negative or <code class="reqn">k \ge 2</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler;  Ben Bolker contributed <code>lab.type = "latex"</code>
and <code>lab.sep</code>.</p>


<h3>See Also</h3>

<p><code><a href="#topic+axTexpr">axTexpr</a></code> and <code><a href="#topic+eaxis">eaxis</a>()</code> which build on
<code>pretty10exp()</code>, notably the <code>eaxis()</code> example plots.
</p>
<p>The new <code><a href="#topic+toLatex.numeric">toLatex.numeric</a></code> method which gives very similar
results with option <code>scientific = TRUE</code>.
<br /> Further, <code><a href="graphics.html#topic+axis">axis</a></code>, <code><a href="graphics.html#topic+axTicks">axTicks</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pretty10exp(-1:3 * 1000)
pretty10exp(-1:3 * 1000, drop.1 = TRUE)
pretty10exp(c(1,2,5,10,20,50,100,200) * 1e3)
pretty10exp(c(1,2,5,10,20,50,100,200) * 1e3, drop.1 = TRUE)

set.seed(17); lx &lt;- rlnorm(10, m=8, s=6)
pretty10exp(lx, digits = 3)
pretty10exp(lx, digits = 3, sub10 = 2)

pretty10exp(lx, digits = 3, lab.type="latex")
pretty10exp(lx, digits = 3, lab.type="latex", lab.sep="times", sub10=2)

## use regular formatted numbers from 0.03 to 300 :
pretty10exp(3*10^(-3:4), sub10 = c(-2,2))
pretty10exp(3*10^(-3:4), sub10 = c(-2,2), lab.type = "l")


ax &lt;- 10^(-6:0) - 2e-16
pretty10exp(ax, drop.1=TRUE) # nice for plotting
pretty10exp(ax, drop.1=TRUE, sub10=TRUE)
pretty10exp(ax, drop.1=TRUE, sub10=c(-2,2))

## in sfsmisc version &lt;= 1.0-16, no 'digits',
## i.e., implicitly had  digits := #{double precision digits} ==
(dig. &lt;- .Machine$double.digits * log10(2)) # 15.95
pretty10exp(ax, drop.1=TRUE, digits= dig.)  # ''ugly''
</code></pre>

<hr>
<h2 id='primes'>Find all Primes Less Than n</h2><span id='topic+primes'></span>

<h3>Description</h3>

<p>Find all prime numbers aka &lsquo;primes&rsquo; less than <code class="reqn">n</code>.
</p>
<p>Uses an obvious sieve method (and some care), working with
<code><a href="base.html#topic+logical">logical</a></code> and and <code><a href="base.html#topic+integer">integer</a></code>s to be quite fast.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>primes(n, pSeq = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="primes_+3A_n">n</code></td>
<td>
<p>a (typically positive integer) number.</p>
</td></tr>
<tr><td><code id="primes_+3A_pseq">pSeq</code></td>
<td>
<p>optionally a vector of primes (2,3,5,...) as if from a
<code>primes()</code> call; <b>must</b> be correct.
The goal is a speedup, but currently we have not found one single
case, where using a non-NULL <code>pSeq</code> is faster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As the function only uses <code><a href="base.html#topic+max">max</a>(n)</code>, <code>n</code> can also be a
<em>vector</em> of numbers.
</p>
<p>The famous prime number theorem states that <code class="reqn">\pi(n)</code>, the
<em>number</em> of primes below <code class="reqn">n</code> is asymptotically <code class="reqn">n /
  \log(n)</code> in the sense that <code class="reqn">\lim_{n \to \infty}{\pi(n) \cdot \log(n) /
  n \sim 1}</code>.
</p>
<p>Equivalently, the inverse of <code class="reqn">pi()</code>, the <code class="reqn">n</code>-th prime number
<code class="reqn">p_n</code> is around <code class="reqn">n \log n</code>; recent results (Pierre Dusart, 1999),
prove that
</p>
<p style="text-align: center;"><code class="reqn">\log n + \log\log n - 1 &lt; \frac{p_n}{n} &lt; \log n + \log \log n
    \quad\mathrm{for } n \ge 6.</code>
</p>



<h3>Value</h3>

<p>numeric vector of all prime numbers <code class="reqn">\le n</code>.
</p>


<h3>Author(s)</h3>

<p>Bill Venables (&lt;= 2001); Martin Maechler gained another 40% speed,
carefully working with logicals and integers.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+factorize">factorize</a></code>.  For large <code class="reqn">n</code>, use the <a href="https://CRAN.R-project.org/package=gmp"><span class="pkg">gmp</span></a> package
and its <code><a href="gmp.html#topic+isprime">isprime</a></code> and <code><a href="gmp.html#topic+nextprime">nextprime</a></code>
functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> (p1 &lt;- primes(100))
 system.time(p1k &lt;- primes(1000)) # still lightning fast
 stopifnot(length(p1k) == 168)

 system.time(p.e7 &lt;- primes(1e7)) # still only 0.3 sec (2015 (i7))
 stopifnot(length(p.e7) == 664579)
 ## The famous  pi(n) :=  number of primes &lt;= n:
 pi.n &lt;- approxfun(p.e7, seq_along(p.e7), method = "constant")
 pi.n(c(10, 100, 1000)) # 4 25 168
 plot(pi.n, 2, 1e7, n = 1024, log="xy", axes = FALSE,
      xlab = "n", ylab = quote(pi(n)),
      main = quote("The prime number function " ~ pi(n)))
 eaxis(1); eaxis(2)


## Exploring  p(n) := the n-th prime number  ~=~ n * pnn(n), where
## pnn(n) := log n + log log n
pnn &lt;- function(n) { L &lt;- log(n); L + log(L) }
n &lt;- 6:(N &lt;- length(PR &lt;- primes(1e5)))
m.pn &lt;- cbind(l.pn = ceiling(n*(pnn(n)-1)), pn = PR[n], u.pn = floor(n*pnn(n)))
matplot(n, m.pn, type="l", ylab = quote(p[n]), main = quote(p[n] ~~
        "with lower/upper bounds" ~ n*(log(n) + log(log(n)) -(1~"or"~0))))
## (difference to the lower approximation) / n   --&gt; ~ 0.0426  (?) :
plot(n, PR[n]/n - (pnn(n)-1), type = 'l', cex = 1/8, log="x", xaxt="n")
eaxis(1); abline(h=0, col=adjustcolor(1, 0.5))
</code></pre>

<hr>
<h2 id='printTable2'>Add and Print Marginals for 2-way Contingency Tables</h2><span id='topic+printTable2'></span><span id='topic+margin2table'></span><span id='topic+print.margin2table'></span>

<h3>Description</h3>

<p><code>printTable2()</code> prints a 2-way contingency table &ldquo;with all
bells and whistles&rdquo; (currently using German labeling).
</p>
<p><code>margin2table()</code> computes marginals, adds them to the table and
returns a <code>margin2table</code> object the print method for which adds
text decorations (using <code>"-"</code> and <code>"|"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printTable2(table2, digits = 3)
margin2table(x, totName = "sum", name.if.empty=FALSE)
## S3 method for class 'margin2table'
print(x, digits = 3, quote = FALSE, right = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printTable2_+3A_table2">table2</code></td>
<td>
<p>a matrix with non-negative integer entries, i.e. the
contingency table.</p>
</td></tr>
<tr><td><code id="printTable2_+3A_x">x</code></td>
<td>
<p>a matrix; for <code>print()</code>, the result of <code>margin2table</code>.</p>
</td></tr>
<tr><td><code id="printTable2_+3A_digits">digits</code></td>
<td>
<p>Anzahl Dezimalstellen, auf die die Häufigkeiten gerundet
werden sollen.</p>
</td></tr>
<tr><td><code id="printTable2_+3A_quote">quote</code>, <code id="printTable2_+3A_right">right</code></td>
<td>
<p>logicals passed to <code><a href="base.html#topic+print.default">print.default</a>()</code>,
but with different default values.</p>
</td></tr>
<tr><td><code id="printTable2_+3A_totname">totName</code></td>
<td>
<p>string to use as row- and column- name if <code>x</code> has
corresponding <code><a href="base.html#topic+dimnames">dimnames</a></code>.</p>
</td></tr>
<tr><td><code id="printTable2_+3A_name.if.empty">name.if.empty</code></td>
<td>
<p>logical indicating if the margin &ldquo;totals&rdquo;
should be named in any case.</p>
</td></tr>
<tr><td><code id="printTable2_+3A_...">...</code></td>
<td>
<p>further potential arguments, unused currently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>margin2table</code> returns a matrix with <em>added marginals</em>,
i.e., an extra row and column, and is of class <code>"margin2table"</code>
(and <code>"<a href="base.html#topic+table">table</a>"</code> still) which has a nice print method.
</p>
<p><code>printTable2</code> is just producing output.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Feb.1993; then Dec 2003</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+table">table</a></code>, <code><a href="stats.html#topic+ftable">ftable</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>margin2table(diag(4),,TRUE)
m &lt;- diag(3); colnames(m) &lt;- letters[1:3]
margin2table(m)
margin2table(m / sum(m))

data(HairEyeColor)
margin2table(HairEyeColor[,, "Male"])
printTable2(HairEyeColor[,, "Male"])
printTable2(HairEyeColor[,, "Female"])
</code></pre>

<hr>
<h2 id='prt.DEBUG'>Utility Printing in DEBUG mode</h2><span id='topic+prt.DEBUG'></span>

<h3>Description</h3>

<p>This is <b>defunct</b> now:
The global <code>DEBUG</code> has been a cheap precursor to <span class="rlang"><b>R</b></span>'s
<code><a href="base.html#topic+options">options</a>(verbose= .)</code> (or a <code>verbose</code> function argument).
</p>
<p>This function prints out its arguments as <code><a href="base.html#topic+cat">cat</a>()</code> does,
additionally printing the name of function in which it's been called &mdash;
only when a global variable <code>DEBUG</code> exists and is
<code><a href="base.html#topic+TRUE">TRUE</a></code>.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prt.DEBUG(..., LEVEL = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prt.DEBUG_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="base.html#topic+cat">cat</a>(...)</code> for
printing.</p>
</td></tr>
<tr><td><code id="prt.DEBUG_+3A_level">LEVEL</code></td>
<td>
<p>integer (or logical) indicating a debugging level for printing.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler, originally for S-PLUS.</p>

<hr>
<h2 id='ps.end'>Close PostScript or Acrobat Graphics Device opened by 'ps.do' / 'pdf.do'</h2><span id='topic+ps.end'></span><span id='topic+pdf.end'></span>

<h3>Description</h3>

<p>Closes the PostScript or PDF file
(<code><a href="grDevices.html#topic+postscript">postscript</a></code>,<code><a href="grDevices.html#topic+pdf">pdf</a></code>), openend by a previous
<code><a href="#topic+ps.do">ps.do</a></code> (or <code><a href="#topic+pdf.latex">pdf.latex</a></code>, or ...) call, using
<code><a href="grDevices.html#topic+dev.off">dev.off</a></code>, and additionally opens a previewer for that
file, <em>unless</em> the previewer is already up.  This almost provides
an &lsquo;interactive&rsquo; device (like <code><a href="grDevices.html#topic+x11">x11</a></code>) for
<code><a href="grDevices.html#topic+postscript">postscript</a></code> or <code><a href="grDevices.html#topic+pdf">pdf</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ps.end(call.gv= NULL, command = getOption("eps_view"),
       debug = getOption("verbose"))
pdf.end(call.viewer= NULL, command = getOption("pdfviewer"),
       debug = getOption("verbose"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ps.end_+3A_call.gv">call.gv</code>, <code id="ps.end_+3A_call.viewer">call.viewer</code></td>
<td>
<p>logical, indicating if the postscript or
acrobat reader (e.g., ghostview or <code>acroread</code> or the command
given by <code>command</code>) should be called.  By default, find out if
the viewer is already runing on this file and only call it if needed.</p>
</td></tr>
<tr><td><code id="ps.end_+3A_command">command</code></td>
<td>
<p>character, giving a system command for PostScript previewing.
By default, <code>getOption("eps_view")</code> is set to<br />
<code>gv -watch -geometry -0+0 -magstep -2 -media BBox -noantialias</code>
which assumes <code>gv</code> (aka <em>ghostview</em>) to be in your OS path.</p>
</td></tr>
<tr><td><code id="ps.end_+3A_debug">debug</code></td>
<td>
<p>logical; if <code>TRUE</code> print information during execution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depends on Unix tools, such as <code>ps</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+postscript">postscript</a></code>, <code><a href="grDevices.html#topic+postscript">postscript</a></code>
<code><a href="#topic+pdf.do">pdf.do</a></code>, <code><a href="#topic+ps.do">ps.do</a></code>, 
...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive() 
  ) {
    myPS &lt;- tempfile("ex", fileext = ".ps")
    ps.do(myPS)
    data(sunspots)
    plot(sunspots)
    ps.end()

    tempfile("ex-sun", fileext = ".pdf") -&gt; myPDF
    pdf.latex(myPDF)
    plot(sunspots)
    pdf.end(call. = FALSE) # basically the same as dev.off()
  }
  ps.latex(tempfile("ex2", fileext = ".eps"))
  plot(sunspots)
  ps.end(call.gv = FALSE) # basically the same as dev.off()
</code></pre>

<hr>
<h2 id='ps.latex'>PostScript/PDF Preview Device with Optional &lsquo;LaTeX&rsquo; Touch</h2><span id='topic+pdf.do'></span><span id='topic+pdf.latex'></span><span id='topic+ps.do'></span><span id='topic+ps.latex'></span>

<h3>Description</h3>

<p>All functions start a pseudo PostScript or Acrobat preview device, using
<code><a href="grDevices.html#topic+postscript">postscript</a></code> or <code><a href="grDevices.html#topic+pdf">pdf</a></code>, and further registering
the file name for subsequent calls to <code><a href="#topic+pdf.end">pdf.end</a>()</code> or
<code>ps.end()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdf.do(file, paper = "default", width = -1, height = -1, onefile = FALSE,
       title = NULL, version = "1.4", quiet = FALSE, ...)

pdf.latex(file, height = 5 + main.space * 1.25,  width = 9.5,
          main.space=FALSE, lab.space = main.space,
          paper = "special", title = NULL,
          lab=c(10, 10, 7), mgp.lab=c(1.6, 0.7, 0), mar=c(4, 4, 0.9, 1.1), ...)

ps.do(file, width=-1, height=-1, onefile=FALSE, horizontal=FALSE,
      title = NULL, ...)

ps.latex(file, height = 5 + main.space * 1.25,  width = 9.5,
         main.space=FALSE, lab.space = main.space,
         paper = "special", title = NULL,
         lab=c(10, 10, 7), mgp.lab=c(1.6, 0.7, 0), mar=c(4, 4, 0.9, 1.1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ps.latex_+3A_file">file</code></td>
<td>
<p>character giving the PostScript/PDF file name to be written.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_height">height</code></td>
<td>
<p>device height in <em>inches</em>, <code>height * 2.54</code> are
<em>cm</em>.  The default is 5 plus 1.25 iff <code>main.space</code>.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_width">width</code></td>
<td>
<p>device width in <em>inches</em>; for this and
<code>height</code>, see <code><a href="grDevices.html#topic+postscript">postscript</a></code>.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_onefile">onefile</code>, <code id="ps.latex_+3A_horizontal">horizontal</code></td>
<td>
<p>logicals passed to
<code><a href="grDevices.html#topic+postscript">postscript</a>(..)</code> or <code><a href="grDevices.html#topic+pdf">pdf</a>(..)</code>, most probably
to be left alone.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_title">title</code></td>
<td>
<p>PostScript/PDF (not plot!) title passed to
<code><a href="grDevices.html#topic+postscript">postscript</a>()</code> or <code><a href="grDevices.html#topic+pdf">pdf</a>()</code>; by default use a
title with <span class="rlang"><b>R</b></span> version and <code>file</code> in it.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_version">version</code></td>
<td>
<p>a string describing the PDF version that will be
required to view the output, see <code><a href="grDevices.html#topic+pdf">pdf</a></code>; our (high)
default ensures alpha-transparency.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_quiet">quiet</code></td>
<td>
<p>logical specifying that some (informative/warning)
messages should not be issued.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_main.space">main.space</code></td>
<td>
<p>logical; if true, leave space for a main title
(unusual for LaTeX figures!).</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_lab.space">lab.space</code></td>
<td>
<p>logical; if true, leave space for x- and y- labels
(by <em>not</em> subtracting from <code>mar</code>).</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_paper">paper</code></td>
<td>
<p>character (or missing), typically <code>"a4"</code> or
<code>"a4r"</code> in non-America, see <code><a href="grDevices.html#topic+postscript">postscript</a></code>.  Only
if this is <code>"special"</code> (or missing) are your choices of <code>width</code>
and <code>height</code> completely honored (and this may lead to files that
cannot print on A4) with resizing.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_lab">lab</code></td>
<td>
<p>integer of length 3, <code>lab[1:2]</code> are desired number of
tick marks on x- and y- axis, see <code><a href="graphics.html#topic+par">par</a>(lab=)</code>.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_mgp.lab">mgp.lab</code></td>
<td>
<p>three decreasing numbers determining space for axis
labeling, see <code><a href="graphics.html#topic+par">par</a>(mgp=)</code>, the default is here smaller
than usual.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_mar">mar</code></td>
<td>
<p>four numbers, indicating marginal space, see
<code><a href="graphics.html#topic+par">par</a>(mar=)</code>, the default is here smaller than usual.</p>
</td></tr>
<tr><td><code id="ps.latex_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="#topic+ps.do">ps.do</a>()</code> or
<code><a href="#topic+pdf.do">pdf.do</a>()</code> from
<code>ps.latex</code> / <code>pdf.latex</code> and to <code><a href="grDevices.html#topic+ps.options">ps.options</a></code>
from <code>ps.do</code>/<code>pdf.do</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ps.latex</code> and <code>pdf.latex</code> have an additional
LaTeX 
flavor,
and just differ by some extra <code><a href="graphics.html#topic+par">par</a></code> settings from the
<code>*.do</code> siblings: E.g., after <code><a href="#topic+ps.do">ps.do</a>(..)</code>
is called, the graphical parameters <code>c("mar", "mgp", "lab")</code> are
reset (to values that typically are better than the defaults for LaTeX
figures).
</p>
<p>Whereas the defaults for <code>paper</code>, <code>width</code>, and <code>height</code>
<em>differ</em> between <code><a href="grDevices.html#topic+pdf">pdf</a></code> and  <code><a href="grDevices.html#topic+postscript">postscript</a></code>,
they are set such as to provide very similar functionality, for
the functions <code>ps.do()</code> and <code>pdf.do()</code>; e.g., by default,
both use a full plot on portrait-oriented page of the default paper,
as per <code><a href="base.html#topic+getOption">getOption</a>("papersize")</code>.<br />
<code><a href="#topic+pdf.do">pdf.do</a>()</code> sets the default <code>paper</code> to <code>"special"</code>
when both <code>width</code> and <code>height</code> are specified.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>old.par</code></td>
<td>
<p>containing the old <code>par</code> values</p>
</td></tr>
<tr><td><code>new.par</code></td>
<td>
<p>containing the newly set <code>par</code> values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#topic+ps.end">ps.end</a></code>, <code><a href="grDevices.html#topic+pdf">pdf</a></code>, <code><a href="grDevices.html#topic+postscript">postscript</a></code>,
<code><a href="grDevices.html#topic+dev.print">dev.print</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) {

 ps.latex("ps.latex-ex.ps", main= TRUE)
  data(sunspots)
  plot(sunspots,main=paste("Sunspots Data, n=",length(sunspots)),col="red")
 ps.end()

 pdf.latex("pdf.latex-ex.pdf", main= TRUE)
  data(sunspots)
  plot(sunspots,main=paste("Sunspots Data, n=",length(sunspots)),col="red")
 pdf.end()

 ps.do("ps_do_ex.ps")
   example(plot.function)
 ps.end()

 pdf.do("pdf_do_ex.pdf", width=12, height=5)
   plot(sunspots, main="Monthly Sunspot numbers (in Zurich, then Tokyo)")
 pdf.end()
}
</code></pre>

<hr>
<h2 id='quadrant'>Give the Quadrant Number of Planar Points</h2><span id='topic+quadrant'></span>

<h3>Description</h3>

<p>Determine the quadrant of planar points, i.e. in which of the four
parts cut by the x- and y- axis the points lie.  Zero values
(i.e. points on the axes) are treated as if <em>positive</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quadrant(x, y=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quadrant_+3A_x">x</code>, <code id="quadrant_+3A_y">y</code></td>
<td>
<p>numeric vectors of the same length, or <code>x</code> is an <code class="reqn">x-y</code>
structure and <code>y=NULL</code>, see <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of same length as <code>x</code> (if that's a vector) with
values in <code>1:4</code> indicating the quadrant number of the
corresponding point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xy &lt;- as.matrix(expand.grid(x= -7:7, y= -7:7)); rownames(xy) &lt;- NULL
(qu &lt;- quadrant(xy))
plot(xy, col = qu+1, main = "quadrant() number", axes = FALSE)
abline(h=0, v=0, col="gray") # the x- and y- axis
text(xy, lab = qu, col = qu+1, adj = c(1.4,0))
</code></pre>

<hr>
<h2 id='QUnif'>Quasi Randum Numbers via Halton Sequences</h2><span id='topic+QUnif'></span><span id='topic+sHalton'></span>

<h3>Description</h3>

<p>These functions provide quasi random numbers or <em>space filling</em> or
<em>low discrepancy</em> sequences in the <code class="reqn">p</code>-dimensional unit cube.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sHalton(n.max, n.min = 1, base = 2, leap = 1)
 QUnif (n, min = 0, max = 1, n.min = 1, p, leap = 1, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QUnif_+3A_n.max">n.max</code></td>
<td>
<p>maximal (sequence) number.</p>
</td></tr>
<tr><td><code id="QUnif_+3A_n.min">n.min</code></td>
<td>
<p>minimal sequence number.</p>
</td></tr>
<tr><td><code id="QUnif_+3A_n">n</code></td>
<td>
<p>number of <code class="reqn">p</code>-dimensional points generated in
<code>QUnif</code>.  By default, <code>n.min = 1, leap = 1</code> and
the maximal sequence number is <code>n.max = n.min + (n-1)*leap</code>.</p>
</td></tr>
<tr><td><code id="QUnif_+3A_base">base</code></td>
<td>
<p>integer <code class="reqn">\ge 2</code>: The base with respect to which
the Halton sequence is built.</p>
</td></tr>
<tr><td><code id="QUnif_+3A_min">min</code>, <code id="QUnif_+3A_max">max</code></td>
<td>
<p>lower and upper limits of the univariate intervals.
Must be of length 1 or <code>p</code>.</p>
</td></tr>
<tr><td><code id="QUnif_+3A_p">p</code></td>
<td>
<p>dimensionality of space (the unit cube) in which points are
generated.</p>
</td></tr>
<tr><td><code id="QUnif_+3A_leap">leap</code></td>
<td>
<p>integer indicating (if <code class="reqn">&gt; 1</code>) if the series should be
leaped, i.e., only every <code>leap</code>th entry should be taken.</p>
</td></tr>
<tr><td><code id="QUnif_+3A_silent">silent</code></td>
<td>
<p>logical asking to suppress the message about enlarging
the prime table for large <code>p</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sHalton(n,m)</code> returns a numeric vector of length <code>n-m+1</code> of
values in <code class="reqn">[0,1]</code>.
</p>
<p><code>QUnif(n, min, max, n.min, p=p)</code> generates <code>n-n.min+1</code>
p-dimensional points in <code class="reqn">[min,max]^p</code> returning a numeric matrix
with p columns.
</p>


<h3>Note</h3>

<p>For <code>leap</code> Kocis and Whiten recommend values of
<code class="reqn">L=31,61,149,409</code>, and particularly the <code class="reqn">L=409</code> for dimensions
up to 400.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>References</h3>

<p>James Gentle (1998)
<em>Random Number Generation and Monte Carlo Simulation</em>; sec.\ 6.3.
Springer.
</p>
<p>Kocis, L. and Whiten, W.J. (1997)
Computational Investigations of Low-Discrepancy Sequences.
<em>ACM Transactions of Mathematical Software</em> <b>23</b>, 2, 266&ndash;294.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>32*sHalton(20, base=2)

stopifnot(sHalton(20, base=3, leap=2) ==
          sHalton(20, base=3)[1+2*(0:9)])
## ------- a 2D Visualization -------

Uplot &lt;- function(xy, axes=FALSE, xlab="", ylab="", ...) {
  plot(xy, xaxs="i", yaxs="i", xlim=0:1, ylim=0:1, xpd = FALSE,
       axes=axes, xlab=xlab, ylab=ylab, ...)
  box(lty=2, col="gray40")
}

do4 &lt;- function(n, ...) {
  op &lt;- mult.fig(4, main=paste("n =", n,": Quasi vs. (Pseudo) Random"),
                 marP=c(-2,-2,-1,0))$old.par
  on.exit(par(op))
  for(i in 1:2) {
     Uplot(QUnif(n, p=2), main="QUnif", ...)
     Uplot(cbind(runif(n), runif(n)), main="runif", ...)
  }
}
do4(100)
do4(500)
do4(1000, cex = 0.8, col="slateblue")
do4(10000, pch= ".", col="slateblue")
do4(40000, pch= ".", col="slateblue")
</code></pre>

<hr>
<h2 id='read.org.table'>Read.table for an Emacs Org Table</h2><span id='topic+read.org.table'></span>

<h3>Description</h3>

<p>Read an emacs &ldquo;Org&rdquo; table (in <code>file</code> or <code>text</code>) by
<code><a href="utils.html#topic+read.table">read.table</a>()</code>. 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.org.table(file, header = TRUE, skip = 0,
               encoding = "native", fileEncoding = "", text, quiet=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.org.table_+3A_file">file</code></td>
<td>
<p>a file name, a <code><a href="base.html#topic+file">file</a></code> or other connection.</p>
</td></tr>
<tr><td><code id="read.org.table_+3A_header">header</code></td>
<td>
<p>logical indicating if the org table has header line (in
the usual <code>"|"</code>-separated org table format).</p>
</td></tr>
<tr><td><code id="read.org.table_+3A_skip">skip</code></td>
<td>
<p>integer number of initial lines to skip.</p>
</td></tr>
<tr><td><code id="read.org.table_+3A_encoding">encoding</code></td>
<td>
<p>to be used in the main
<code><a href="base.html#topic+readLines">readLines</a>(file, encoding=encoding)</code> call.</p>
</td></tr>
<tr><td><code id="read.org.table_+3A_fileencoding">fileEncoding</code></td>
<td>
<p>if <code>file</code> is a file name, i.e., a
<code><a href="base.html#topic+character">character</a></code> string, and <code>fileEncoding</code> is not the
empty string, <code>file(file, "rt", encoding = fileEncoding)</code> will
be used.</p>
</td></tr>
<tr><td><code id="read.org.table_+3A_text">text</code></td>
<td>
<p>instead of <code>file</code>, a <code><a href="base.html#topic+character">character</a></code> or
string (of a few lines, typically).</p>
</td></tr>
<tr><td><code id="read.org.table_+3A_quiet">quiet</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> to suppress the <code><a href="base.html#topic+message">message</a></code>
which is signalled when no <code>nrows=*</code> has been specified and the
automatic number of rows is smaller than 95% of the rows / non-header
lines of the <code>file</code>.</p>
</td></tr>
<tr><td><code id="read.org.table_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="utils.html#topic+read.table">read.table</a></code>.
You should <em>not</em> use <code>encoding</code> (but possibly
<code>fileEncoding</code>!) here, as we do not call
<code><a href="utils.html#topic+read.table">read.table</a></code> on <code>file</code> (but on a
<code><a href="base.html#topic+textConnection">textConnection</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code>
</p>


<h3>Note</h3>

<p>TODO: It should be easy to extend <code>read.org.table()</code>  to also
work for some of the proposed Markdown formats for tables.
Please write to <code><a href="utils.html#topic+maintainer">maintainer</a>("sfsmisc")</code> or open a
github issue if you are interested.
</p>


<h3>References</h3>

<p>Org-Mode <em>Manual</em> on tables, <a href="https://orgmode.org/manual/Tables.html">https://orgmode.org/manual/Tables.html</a>
</p>
<p>Org <em>tutorial</em> for tables, <a href="https://orgmode.org/worg/org-tutorials/tables.html">https://orgmode.org/worg/org-tutorials/tables.html</a>
</p>


<h3>See Also</h3>

<p>CRAN package <a href="https://CRAN.R-project.org/package=ascii"><span class="pkg">ascii</span></a> 
can <em>write</em> org tables.
<code><a href="utils.html#topic+read.table">read.table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;-
"
| a | var2 |   C |
|---+------+-----|
| 2 | may  | 3.4 |
| 7 | feb  | 4.7 |
"
d &lt;- read.org.table(text = t1)
d
stopifnot(dim(d) == c(2, 3),
          identical(names(d), c("a", "var2", "C")),
          d[,"a"] == c(2,7))
</code></pre>

<hr>
<h2 id='relErr'>Relative Error When Appropriate, Absolute Otherwise</h2><span id='topic+relErrV'></span><span id='topic+relErr'></span>

<h3>Description</h3>


<dl>
<dt><code>relErrV()</code>:</dt><dd>
<p>Compute the signed relative error componentwise (&ldquo;vectorized&rdquo;)
between the <code>target</code> and <code>current</code> vectors,
using the <em>absolute</em> error, i.e., the difference
in case the relative error is not well defined, i.e., when <code>target</code>
is zero or infinite.</p>
</dd>
<dt><code>relErr()</code>:</dt><dd><p>simply the <em>mean</em> absolute value of the
relative errors between <code>target</code> and <code>current</code> vectors;
typically the &ldquo;same&rdquo; as
<code><a href="base.html#topic+all.equal.numeric">all.equal.numeric</a>(target, vector, tolerance=0, countEQ=TRUE)</code>.
</p>
<p>Currently useful only when both vectors are finite.
</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>relErrV(target, current, eps0 = .Machine$double.xmin)
relErr (target, current)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relErr_+3A_target">target</code></td>
<td>
<p>numeric, possibly scalar.</p>
</td></tr>
<tr><td><code id="relErr_+3A_current">current</code></td>
<td>
<p>numeric vector of <code><a href="base.html#topic+length">length</a>()</code> a multiple of
<code>length(target)</code>; if an <code><a href="base.html#topic+array">array</a></code> (incl
<code>matrix</code>), dimensions are preserved; for vectors,
<code>names(target)</code> are preserved.</p>
</td></tr>
<tr><td><code id="relErr_+3A_eps0">eps0</code></td>
<td>
<p>non-negative number; values <code>abs(target) &lt; eps0</code> should
be treated as zero (and hence <em>absolute</em> instead of relative error
be computed).  This may be crucial when <code>target</code> is an
<code>"mpfr"</code>-number vector.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code>relErrV()</code>:</dt><dd><p>a numeric vector of the same length (or array
of the same dimension) as <code>current</code>.</p>
</dd>
<dt><code>relErr()</code>:</dt><dd><p>a single number.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Martin Maechler,
originally as part of <a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a> package's &lsquo;<span class="file">test-tools.R</span>&rsquo;.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+all.equal.numeric">all.equal.numeric</a>()</code> is similar in spirit but returns <code>TRUE</code> or
string containing the <em>mean</em> relative or absolute error.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## relErrV() test example: showing how it works fine with {NA, Inf, 0} :
eps &lt;- 1e-4*c(-9, -8, -6, -4, 0.5, 1, 5)
target  &lt;- c(-1:1, 0,   0, NA, NaN, Inf, -Inf, Inf, 0 , Inf, 1 , -3:3)
current &lt;- c(-1:1,1e-7,NaN,NA,  0 , Inf,  Inf,  0, Inf,  1, Inf, -3:3+ eps)
cbind(target, current, absE = current-target,
                       relE = relErrV(target,current)) -&gt; M ; M
stopifnot(exprs = {
         is.logical(isFr &lt;- is.finite(rF &lt;- M[,"relE"]))
  target==current | isFr == is.finite(aF &lt;- M[,"absE"])
  identical(aF[!isFr] , rF[!isFr])
  identical(numeric(), relErrV(numeric(), integer())) # length 0 {used to fail}
})
tools::assertError(relErrV(1, numeric()), verbose=TRUE) # no longer allowed
## relErr() is pretty simple --- (possibly too simple, currently)
relErr
relErr(target, current) # NA (of course)
all.equal.numeric(target, current) ## "'is.NA' value mismatch ..."

## comparison after dropping NA's :
hasN &lt;- is.na(target) | is.na(current)
all.equal(target[!hasN], current[!hasN], tolerance=0) # "Mean abs. diff.: Inf"
   relErr(target[!hasN], current[!hasN]) # NaN  (to improve?)

## comparison after only keeping cases where both are finite:
finN &lt;- is.finite(target) &amp; is.finite(current)
all.equal(target[finN], current[finN], tol=0)          # "Mean abs.d.: 0.000279.."
all.equal(target[finN], current[finN], tol=0, countEQ=TRUE) #   "  " : 0.000239..
   relErr(target[finN], current[finN]) # 0.0002392929
</code></pre>

<hr>
<h2 id='repChar'>Make Simple String from Repeating a Character, e.g. Blank String</h2><span id='topic+repChar'></span><span id='topic+bl.string'></span>

<h3>Description</h3>

<p>Simple constructors of a constant character string from one character,
notably a &ldquo;blank&rdquo; string of given string length.
</p>
<p>M.M. is now &lsquo;<em>mentally deprecating</em>&rsquo; <code>bl.string</code> in
favor of using <code>repChar()</code> in all cases.
</p>
<p>With <span class="rlang"><b>R</b></span> 3.3.0 (May 2016), the <em>new</em> function
<code><a href="base.html#topic+strrep">strrep</a>()</code> was introduced; it is faster typically, and more
flexible, e.g. accepting a <em>vector</em> for the 2nd argument.
<br />
This (for now informally) deprecates all uses of <code>repChar()</code> and <code>bl.string()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>repChar(char, no)
bl.string(no)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="repChar_+3A_char">char</code></td>
<td>
<p>single character (or arbitrary string).</p>
</td></tr>
<tr><td><code id="repChar_+3A_no">no</code></td>
<td>
<p>non-negative integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One string, i.e., <code><a href="base.html#topic+character">character</a>(1)</code>), for <code>bl.string</code> a
blank string, fulfilling <code>n == nchar(bl.string(n))</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, early 1990's (for <code>bl.string</code>).</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+paste">paste</a></code>, <code><a href="base.html#topic+character">character</a></code>, <code><a href="base.html#topic+nchar">nchar</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>r &lt;- sapply(0:8, function(n) ccat(repChar(" ",n), n))
cbind(r)

repChar("-", 4)
repChar("_", 6)
## it may make sense to a string of more than one character:
repChar("-=- ", 6)

## show the very simple function definitions:
repChar
bl.string
</code></pre>

<hr>
<h2 id='rot2'>Rotate Planar Points by Angle</h2><span id='topic+rot2'></span>

<h3>Description</h3>

<p>Rotate planar (xy) points by angle <code>phi</code> (in radians).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rot2(xy, phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rot2_+3A_xy">xy</code></td>
<td>
<p>numeric 2-column matrix, or coercable to one.</p>
</td></tr>
<tr><td><code id="rot2_+3A_phi">phi</code></td>
<td>
<p>numeric scalar, the angle in radians (i.e., <code>phi=pi</code>
corresponds to 180 degrees) by which to rotate the points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A two column matrix as <code>xy</code>, containing the rotated points.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Oct.1994</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Rotate three points by 60 degrees :
(xy0 &lt;- rbind(c(1,0.5), c(1,1), c(0,1)))
(Txy &lt;- rot2(xy0, phi = 60 * pi/180))
plot(xy0, col = 2, type = "b", asp = 1,
     xlim=c(-1,1), ylim=c(0,1.5), main = "rot2(*, pi/3) : 2d rotation by 60°")
points(Txy, col = 3, type = "b")
O &lt;- rep(0,2); P2 &lt;- rbind(xy0[2,], Txy[2,])
arrows(O,O,P2[,1],P2[,2], col = "dark gray")

xy0 &lt;- .8*rbind(c(1,0), c(.5,.6), c(.7,1), c(1,1), c(.9,.8), c(1,0)) - 0.2
plot(xy0, col= 2, type="b", main= "rot2( &lt;polygon&gt;, pi/4 * 1:7)", asp=1,
     xlim=c(-1,1),ylim=c(-1,1), lwd= 2, axes = FALSE, xlab="", ylab="")
abline(h=0, v=0, col="thistle"); text(1.05, -.05, "x"); text(-.05,1.05, "y")
for(phi in pi/4 * 0:7)
   do.call("arrows",c(list(0,0),rot2(xy0[2,], phi), length=0.1, col="gray40"))
for(phi in pi/4 * 1:7)
   polygon(rot2(xy0, phi = phi), col = 1+phi/(pi/4), border=2, type = "b")
</code></pre>

<hr>
<h2 id='rotn'>Generalized Rot13 Character Translation (Rotation)</h2><span id='topic+rotn'></span>

<h3>Description</h3>

<p>Compute generalized &lsquo;rot13&rsquo; character translations or
&ldquo;rotations&rdquo;
</p>
<p>In the distant past, considered as poor man's encryption, such
rotations are way too poor nowadays and provided mainly for didactical
reasons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rotn(ch, n = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rotn_+3A_ch">ch</code></td>
<td>
<p>a <code><a href="base.html#topic+character">character</a></code> vector; often a string (of length 1).</p>
</td></tr>
<tr><td><code id="rotn_+3A_n">n</code></td>
<td>
<p>an integer in <code class="reqn">\{1\dots26\}</code>; the default is
particularly useful.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the default <code>n = 13</code> makes <code>rotn</code> into
a function that is its own inverse.
</p>
<p>Written after having searched for it and found
<code>seqinr::rot13()</code> which was generalized and rendered more
transparently to my eyes.
</p>


<h3>Value</h3>

<p>a character as <code>ch</code>, but with each character (which
belongs to <code><a href="base.html#topic+letters">letters</a></code> or <code><a href="base.html#topic+LETTERS">LETTERS</a></code>
&ldquo;rotated&rdquo; by <code>n</code> (positions in the alphabet).
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#topic+rot2">rot2</a></code>, a completely different rotation (namely in the
plane aka <code class="reqn">R^2</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rotn(c("ABC", "a","b","c"), 1)
rotn(c("ABC", "a","b","c"), 2)
rotn(c("ABC", "a","b","c"), 26) # rotation by 26 does not change much

(ch &lt;- paste("Hello", c("World!", "you too")))
rotn(ch)
rotn( rotn(ch ) ) # rotn(*, 13) is its own inverse
</code></pre>

<hr>
<h2 id='roundfixS'>Round to Integer Keeping the Sum Fixed</h2><span id='topic+roundfixS'></span>

<h3>Description</h3>

<p>Given a real numbers <code class="reqn">y_i</code> with the particular property that
<code class="reqn">\sum_i y_i</code> is integer, find <em>integer</em> numbers <code class="reqn">x_i</code>
which are close to <code class="reqn">y_i</code> (<code class="reqn">\left|x_i - y_i\right| &lt; 1 \forall i</code>), and have identical &ldquo;marginal&rdquo;
sum, <code>sum(x) == sum(y)</code>.
</p>
<p>As I found later, the problem is known as &ldquo;Apportionment Problem&rdquo;
and it is quite an old problem with several solution methods proposed
historically, but only in 1982, Balinski and Young proved that there
is no method that fulfills three natural desiderata.
</p>
<p>Note that the (first) three methods currently available here were all
(re?)-invented by M.Maechler, without any knowledge of the
litterature.  At the time of writing, I have not even checked to which
(if any) of the historical methods they match.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roundfixS(x, method = c("offset-round", "round+fix", "1greedy"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roundfixS_+3A_x">x</code></td>
<td>
<p>a numeric vector which <b>must</b> sum to an integer</p>
</td></tr>
<tr><td><code id="roundfixS_+3A_method">method</code></td>
<td>
<p>character string specifying the algorithm to be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Without hindsight, it may be surprising that all three methods give
identical results (in all situations and simulations considered),
notably that the idea of &lsquo;mass shifting&rsquo; employed in the
iterative <code>"1greedy"</code> algorithm seems equivalent to the much simpler
idea used in <code>"offset-round"</code>.
</p>
<p>I am pretty sure that these algorithms solve the <code class="reqn">L_p</code>
optimization problem, <code class="reqn">\min_x \left\|y - x\right\|_p</code>,
typically for all <code class="reqn">p \in [1,\infty]</code>
<em>simultaneously</em>, but have not bothered to find a formal proof.
</p>


<h3>Value</h3>

<p>a numeric vector, say <code>r</code>, of the same length as <code>x</code>, but
with integer values and fulfulling <code>sum(r) == sum(x)</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, November 2007</p>


<h3>References</h3>

<p>Michel Balinski and H. Peyton Young (1982)
<b>Fair Representation: Meeting the Ideal of One Man, One Vote</b>;
</p>
<p><a href="https://en.wikipedia.org/wiki/Apportionment_paradox">https://en.wikipedia.org/wiki/Apportionment_paradox</a>
</p>
<p><a href="https://www.ams.org/samplings/feature-column/fcarc-apportionii3">https://www.ams.org/samplings/feature-column/fcarc-apportionii3</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+round">round</a></code> etc
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## trivial example
kk &lt;- c(0,1,7)
stopifnot(identical(kk, roundfixS(kk))) # failed at some point

x &lt;- c(-1.4, -1, 0.244, 0.493, 1.222, 1.222, 2, 2, 2.2, 2.444, 3.625, 3.95)
sum(x) # an integer
r &lt;- roundfixS(x)
stopifnot(all.equal(sum(r), sum(x)))
m &lt;- cbind(x=x, `r2i(x)` = r, resid = x - r, `|res|` = abs(x-r))
rbind(m, c(colSums(m[,1:2]), 0, sum(abs(m[,"|res|"]))))

chk &lt;- function(y) {
  cat("sum(y) =", format(S &lt;- sum(y)),"\n")
  r2  &lt;- roundfixS(y, method="offset")
  r2. &lt;- roundfixS(y, method="round")
  r2_ &lt;- roundfixS(y, method="1g")
  stopifnot(all.equal(sum(r2 ), S),
            all.equal(sum(r2.), S),
            all.equal(sum(r2_), S))
  all(r2 == r2. &amp; r2. == r2_) # TRUE if all give the same result
}

makeIntSum &lt;- function(y) {
   n &lt;- length(y)
   y[n] &lt;- ceiling(y[n]) - (sum(y[-n]) %% 1)
   y
}
set.seed(11)
y &lt;- makeIntSum(rnorm(100))
chk(y)

## nastier example:
set.seed(7)
y &lt;- makeIntSum(rpois(100, 10) + c(runif(75, min= 0, max=.2),
                                   runif(25, min=.5, max=.9)))
chk(y)

## Not run: 
for(i in 1:1000)
    stopifnot(chk(makeIntSum(rpois(100, 10) +
                             c(runif(75, min= 0, max=.2),
                               runif(25, min=.5, max=.9)))))

## End(Not run)
</code></pre>

<hr>
<h2 id='rrange'>Robust Range using Boxplot 'Quartiles'</h2><span id='topic+rrange'></span>

<h3>Description</h3>

<p>Compute a robust range, i.e. the usual <code><a href="base.html#topic+range">range</a>()</code> as long
as there are no outliers,  using the &ldquo;whisker boundaries&rdquo; of
<code><a href="graphics.html#topic+boxplot">boxplot</a></code>, i.e., <code><a href="grDevices.html#topic+boxplot.stats">boxplot.stats</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rrange(x, range=1, coef = 1.5, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rrange_+3A_x">x</code></td>
<td>
<p>numeric vector the robust range of which shall be computed.</p>
</td></tr>
<tr><td><code id="rrange_+3A_range">range</code></td>
<td>
<p>number for S compatibility; <code>1.5 * range</code> is
equivalent to <code>coef</code>.</p>
</td></tr>
<tr><td><code id="rrange_+3A_coef">coef</code></td>
<td>
<p>numeric multiplication factor definying the outlier
boundary, see &lsquo;Details&rsquo; below.</p>
</td></tr>
<tr><td><code id="rrange_+3A_na.rm">na.rm</code></td>
<td>
<p>logical indicating how <code><a href="base.html#topic+NA">NA</a></code> values should be
handled;  they are simply dropped when <code>na.rm = TRUE</code> as by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The robust range is really just what <code><a href="grDevices.html#topic+boxplot.stats">boxplot.stats</a>(x,
    coef=coef)</code> returns as the whisker boundaries.
This is the most extreme values <code>x[j]</code> still inside median
plus/minus <code>coef * IQR</code>.
</p>


<h3>Value</h3>

<p>numeric vector <code>c(m,M)</code> with <code class="reqn">m \le M</code> which is (not
strictly) inside <code>range(x) = c(min(x),max(x))</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 1990.</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+range">range</a></code>, <code><a href="stats.html#topic+fivenum">fivenum</a></code>,
<code><a href="graphics.html#topic+boxplot">boxplot</a></code> and <code><a href="grDevices.html#topic+boxplot.stats">boxplot.stats</a></code>.
</p>
<p>A more sophisticated robust range for (strongly) asymmetric data can
be derived from the skewness adjusted boxplot statistics
<code><a href="robustbase.html#topic+adjboxStats">adjboxStats</a></code> which is a generalization of
<code><a href="grDevices.html#topic+boxplot.stats">boxplot.stats</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stopifnot(rrange(c(1:10,1000)) == c(1,10))
</code></pre>

<hr>
<h2 id='seqXtend'>Sequence Covering the Range of X, including X</h2><span id='topic+seqXtend'></span>

<h3>Description</h3>

<p>Produce a sequence of unique values (sorted increasingly),
<em>containing</em> the initial set of values <code>x</code>.
This can be useful for setting prediction e.g. ranges in nonparametric
regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seqXtend(x, length., method = c("simple", "aim", "interpolate"),
        from = NULL, to = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seqXtend_+3A_x">x</code></td>
<td>
<p>numeric vector.</p>
</td></tr>
<tr><td><code id="seqXtend_+3A_length.">length.</code></td>
<td>
<p>integer specifying <em>approximately</em> the desired
<code><a href="base.html#topic+length">length</a>()</code> of the result.</p>
</td></tr>
<tr><td><code id="seqXtend_+3A_method">method</code></td>
<td>
<p>string specifying the method to be used.  The default,
<code>"simple"</code> uses <code><a href="base.html#topic+seq">seq</a>(*, length.out = length.)</code> where
<code>"aim"</code> aims a bit better towards the desired final length,
and <code>"interpolate"</code> interpolates evenly <em>inside</em>
each interval <code class="reqn">[x_i, x_{i+1}]</code> in a way to
make all the new intervalls of approximately the same length.</p>
</td></tr>
<tr><td><code id="seqXtend_+3A_from">from</code>, <code id="seqXtend_+3A_to">to</code></td>
<td>
<p>numbers to be passed to (the default method for)
<code><a href="base.html#topic+seq">seq</a>()</code>, defaulting to the minimal and maximal <code>x</code>
value, respectively.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of increasing values, of approximate length
<code>length.</code>
(unless <code>length. &lt; length(unique(x))</code> in which case, the result
is simply <code>sort(<a href="base.html#topic+unique">unique</a>(x))</code>),
containing the original values of <code>x</code>.
</p>
<p>From, <code>r &lt;- seqXtend(x, *)</code>, the original values are at
indices <code>ix &lt;- match(x,r)</code>, i.e., <code>identical(x, r[ix])</code>.
</p>


<h3>Note</h3>

<p><code>method = "interpolate"</code> typically gives the best results. Calling
<code><a href="#topic+roundfixS">roundfixS</a></code>, it also need more computational resources
than the other methods.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+seq">seq</a></code>; <code><a href="#topic+plotDS">plotDS</a></code> can make particularly
good use of <code>seqXtend()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- c(1,2,10,12)
seqXtend(a, 12)# --&gt; simply 1:12
seqXtend(a, 12, "interp")# ditto
seqXtend(a, 12, "aim")# really worse
stopifnot(all.equal(seqXtend(a, 12, "interp"), 1:12))

## for a "general" x, however, "aim" aims better than default
x &lt;- c(1.2, 2.4, 4.6, 9.9)
length(print(seqXtend(x, 12)))        # 14
length(print(seqXtend(x, 12, "aim"))) # 12
length(print(seqXtend(x, 12, "int"))) # 12

## "interpolate" is really nice:
xt &lt;- seqXtend(x, 100, "interp")
plot(xt, main="seqXtend(*, 100, \"interpol\")")
points(match(x,xt), x, col = 2, pch = 20)
# .... you don't even see that it's not equidistant
# whereas the cheap method shows ...
xt2 &lt;- seqXtend(x, 100)
plot(xt2, col="blue")
points(match(x,xt2), x, col = 2, pch = 20)

## with "Date" objects
Drng &lt;- as.Date(c("2007-11-10", "2012-07-12"))
(px &lt;- pretty(Drng, n = 16)) # say, for the main labels
## say, a finer grid, for ticks -- should be almost equidistant
n3 &lt;- 3*length(px)
summary(as.numeric(diff(seqXtend(px, n3))))        # wildly varying
summary(as.numeric(diff(seqXtend(px, n3, "aim")))) #   (ditto)
summary(as.numeric(diff(seqXtend(px, n3, "int")))) # around 30
</code></pre>

<hr>
<h2 id='sessionInfoX'>Extended Information About the Current R Session</h2><span id='topic+isRshared'></span><span id='topic+sessionInfoX'></span><span id='topic+print.sessionInfoX'></span>

<h3>Description</h3>

<p>Collect (and print) information about the current <span class="rlang"><b>R</b></span> session and
environment, using <code><a href="utils.html#topic+sessionInfo">sessionInfo</a>()</code> and more mostly
low-level and platform dependent information.
</p>
<p><code>isRshared()</code> is a utility called from <code>sessionInfoX()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sessionInfoX(pkgs = NULL, list.libP = FALSE, extraR.env = TRUE)

## S3 method for class 'sessionInfoX'
print(x, locale = TRUE, RLIBS = TRUE, Renv = TRUE, ...)

isRshared(platform = .Platform)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sessionInfoX_+3A_pkgs">pkgs</code></td>
<td>
<p><code>NULL</code> (default), <code>TRUE</code> or a
<code><a href="base.html#topic+character">character</a></code> vector of <span class="rlang"><b>R</b></span> package names, whose
<code><a href="utils.html#topic+packageDescription">packageDescription</a>()</code>s are wanted.  No packages by
default, <code>TRUE</code> takes all currently loaded pkgs.</p>
</td></tr>
<tr><td><code id="sessionInfoX_+3A_list.libp">list.libP</code></td>
<td>
<p>a logical indicating if for all
<code><a href="base.html#topic+.libPaths">.libPaths</a></code> entries, the files should be listed via
<code><a href="base.html#topic+list.files">list.files</a></code>.</p>
</td></tr>
<tr><td><code id="sessionInfoX_+3A_extrar.env">extraR.env</code></td>
<td>
<p>logical indicating if <em>all</em> environment
variables should be recorded which start with <code>"R_"</code> or
<code>"_R_"</code>.</p>
</td></tr>
<tr><td><code id="sessionInfoX_+3A_x">x</code></td>
<td>
<p>typically the result of <code>sessionInfoX()</code>.</p>
</td></tr>
<tr><td><code id="sessionInfoX_+3A_locale">locale</code></td>
<td>
<p>logical, passed to <code><a href="utils.html#topic+print.sessionInfo">print.sessionInfo</a>()</code>
indicating if the locale information should be printed.</p>
</td></tr>
<tr><td><code id="sessionInfoX_+3A_rlibs">RLIBS</code></td>
<td>
<p>logical indicating if the information about R_LIBS should
be printed.</p>
</td></tr>
<tr><td><code id="sessionInfoX_+3A_renv">Renv</code></td>
<td>
<p>logical indicating if the information about R environment
variables should be printed.</p>
</td></tr>
<tr><td><code id="sessionInfoX_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="base.html#topic+print">print</a></code> methods.</p>
</td></tr>
<tr><td><code id="sessionInfoX_+3A_platform">platform</code></td>
<td>
<p>a <code><a href="base.html#topic+list">list</a></code> &ldquo;like&rdquo; <code><a href="base.html#topic+.Platform">.Platform</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>isRshared()</code>, a <code><a href="base.html#topic+logical">logical</a></code> indicating if <span class="rlang"><b>R</b></span> has
been installed as &ldquo;shared&rdquo;, i.e., linked to &lsquo;<span class="file">libR*</span>&rsquo; shared
library.
</p>
<p>For <code>sessionInfoX()</code>, an object of S3 class <code>"sessionInfoX"</code>, a <code><a href="base.html#topic+list">list</a></code>
with components (there may be more, experimental and not yet listed here):
</p>
<table>
<tr><td><code>sInfo</code></td>
<td>
<p>simply the value of <code><a href="utils.html#topic+sessionInfo">sessionInfo</a>()</code>.</p>
</td></tr>
<tr><td><code>sysInf</code></td>
<td>
<p>the value of <code><a href="base.html#topic+Sys.info">Sys.info</a>()</code>.</p>
</td></tr>
<tr><td><code>capabilities</code></td>
<td>
<p>the value of <code><a href="base.html#topic+capabilities">capabilities</a>()</code>.</p>
</td></tr>
<tr><td><code>extSoft</code></td>
<td>
<p>for <span class="rlang"><b>R</b></span> 3.2.0 and newer, the value of <code><a href="base.html#topic+extSoftVersion">extSoftVersion</a>()</code>.</p>
</td></tr>
<tr><td><code>grSoft</code></td>
<td>
<p>for <span class="rlang"><b>R</b></span> 3.2.0 and newer, the value of <code><a href="grDevices.html#topic+grSoftVersion">grSoftVersion</a>()</code>.</p>
</td></tr>
<tr><td><code>tclVersion</code></td>
<td>
<p>for <span class="rlang"><b>R</b></span> 3.2.0 and newer and when <span class="pkg">tcltk</span> is loaded,
the Tcl version (<code><a href="tcltk.html#topic+tclVersion">tclVersion</a>()</code>).</p>
</td></tr>
<tr><td><code>LAPACK</code></td>
<td>
<p>for <span class="rlang"><b>R</b></span> 3.0.3 and newer, the value of <code><a href="base.html#topic+La_version">La_version</a>()</code>.</p>
</td></tr>
<tr><td><code>pcre</code></td>
<td>
<p>for <span class="rlang"><b>R</b></span> 3.1.3 and newer, the value of <code><a href="base.html#topic+pcre_config">pcre_config</a>()</code>.</p>
</td></tr>
<tr><td><code>pkgDescr</code></td>
<td>
<p>If <code>pkgs</code> was non-empty, a named
<code><a href="base.html#topic+list">list</a></code> of <code><a href="utils.html#topic+packageDescription">packageDescription</a>()</code>s for each
entry in <code>pkgs</code>.</p>
</td></tr>
<tr><td><code>libPath</code></td>
<td>
<p>the value of <code><a href="base.html#topic+.libPaths">.libPaths</a>()</code>.</p>
</td></tr>
<tr><td><code>RLIBS</code></td>
<td>
<p>a <code><a href="base.html#topic+character">character</a></code> vector of entries from
<code><a href="base.html#topic+Sys.getenv">Sys.getenv</a>("R_LIBS")</code>, typically very similar to the
<code>libPaths</code> component.</p>
</td></tr>
<tr><td><code>n.RLIBS</code></td>
<td>
<p>simply a <code><a href="base.html#topic+normalizePath">normalizePath</a>()</code>ed version of <code>RLIBS</code>.</p>
</td></tr>
<tr><td><code>R.env</code></td>
<td>
<p>a named character vector with the &ldquo;important&rdquo; <span class="rlang"><b>R</b></span>
environment variables <code>R_ENVIRON</code>, <code>R_PROFILE</code>,
<code>R_CHECK_ENVIRON</code>.</p>
</td></tr>
<tr><td><code>xR.env</code></td>
<td>
<p>if <code>extraR.env</code> was true, a named character vector
of &ldquo;all R related&rdquo; environment variables, as specified in
<code>extraR.env</code>'s description above.</p>
</td></tr>
<tr><td><code>shared</code></td>
<td>
<p>(not available on Windows, where it is conceptually always true:)
<code><a href="base.html#topic+logical">logical</a></code> indicating if the version of <span class="rlang"><b>R</b></span> is
&ldquo;shared&rdquo;.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Martin Maechler, December 2015 ff.</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+sessionInfo">sessionInfo</a></code>,
<code><a href="base.html#topic+.libPaths">.libPaths</a></code>, <code><a href="base.html#topic+R.version">R.version</a></code>, <code><a href="base.html#topic+Sys.getenv">Sys.getenv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>six0 &lt;- sessionInfoX()
six0$shared # useful (for some, e.g., MM) on Unix alikes

sixN &lt;- sessionInfoX("nlme", list.libP = TRUE)
sixN # -&gt; print() method for "sessionInfoX"
names(sixN)
str(sixN, max = 1)# outline of lower-level structure
str(sixN$pkgDescr) # list with one component "nlme"
</code></pre>

<hr>
<h2 id='sfsmisc-defunct'>Defunct Functions in Package <span class="pkg">sfsmisc</span></h2><span id='topic+sfsmisc-defunct'></span><span id='topic+list2mat'></span><span id='topic+pl.ds'></span><span id='topic+p.pllines'></span>

<h3>Description</h3>

<p>The functions or variables listed here are no longer part of package
<span class="pkg">sfsmisc</span> as they are not needed (any more).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Defunct in 2016-12 --&gt; to be sfsmisc 1.1-1
list2mat(x, check = TRUE)

p.pllines(x,y,group,lty=c(1,3,2,4),...)

## deprecated from 2007 to 2013; defunct since 2014-01:
pl.ds() ##-- is replaced by  plotDS()
</code></pre>


<h3>Details</h3>

<p><code>list2mat(x)</code> was usually the same as <code>sapply(x, c)</code> (where
the latter does not construct column names where <code>x</code> has no names).
</p>
<p><code>p.pllines</code> is now defunct because basic <span class="rlang"><b>R</b></span> graphics (but not
S-PLUS) provide its functionality directly: Use <code>plot(x,y, lty
    = group, type = 'l', ...)</code>.
</p>
<p><code>pl.ds</code> has been renamed to <code><a href="#topic+plotDS">plotDS</a>()</code> in 2007.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+Defunct">Defunct</a></code>
</p>

<hr>
<h2 id='shortRversion'>Short R Version String</h2><span id='topic+shortRversion'></span>

<h3>Description</h3>

<p>From <span class="pkg">base</span> <span class="rlang"><b>R</b></span>'s <code><a href="base.html#topic+R.version.string">R.version.string</a></code>, produce a somewhat
shorter version, with or without date, notably also for <em>patched</em> or
<em>devel</em>opment versions of <span class="rlang"><b>R</b></span>.
</p>
<p>Main use is for plotting or construction of file of variable names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shortRversion(Rv = R.version, Rst = Rv$status,
              Rvstring = if (!is.null(s &lt;- Rv$version.string)) s else R.version.string,
              date = Rst != "", spaces = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shortRversion_+3A_rv">Rv</code></td>
<td>
<p>a <code><a href="base.html#topic+list">list</a></code> with some of the same components as <code><a href="base.html#topic+R.version">R.version</a></code>.</p>
</td></tr>
<tr><td><code id="shortRversion_+3A_rst">Rst</code></td>
<td>
<p>a string specifying the <em>status</em> of <span class="rlang"><b>R</b></span>'s version.  For
released versions of <span class="rlang"><b>R</b></span>, this is <code>""</code>; almost always use the default <code>Rv$status</code>.</p>
</td></tr>
<tr><td><code id="shortRversion_+3A_rvstring">Rvstring</code></td>
<td>
<p>a string with a default that should work even for <span class="rlang"><b>R</b></span>
versions previous to 1.0.0.</p>
</td></tr>
<tr><td><code id="shortRversion_+3A_date">date</code></td>
<td>
<p>logical specifying if the date of the <span class="rlang"><b>R</b></span> version should be
included in the result; by default, this will be true only for
non-released versions of <span class="rlang"><b>R</b></span>.</p>
</td></tr>
<tr><td><code id="shortRversion_+3A_spaces">spaces</code></td>
<td>
<p>logical indicating if the result may contain spaces (aka
&lsquo;blanks&rsquo;); setting it to false, replaces the blanks by <code>"-"</code> and <code>"_"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+character">character</a></code> string, typically a shortened version of <code>Rvstring</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+R.version">R.version</a></code>,   <code><a href="base.html#topic+R.version.string">R.version.string</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>shortRversion() ## (including the date, typically for an R Core developer)
## but this is shorter:
(Rver &lt;- shortRversion(date=FALSE))
shortRversion(spaces=FALSE)# e.g. for a file of even directory name
shortRversion(spaces=FALSE, date=FALSE)# even shorter, ditto

## If you want even shorter { abbreviate() will remove spaces, too }:
abbreviate(shortRversion(), 11)
abbreviate(shortRversion(date=FALSE), 13)
</code></pre>

<hr>
<h2 id='signi'>Rounding to Significant Digits</h2><span id='topic+signi'></span>

<h3>Description</h3>

<p>Rounds to significant digits similarly to <code><a href="base.html#topic+signif">signif</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signi(x, digits = 6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="signi_+3A_x">x</code></td>
<td>
<p>numeric vector to be rounded.</p>
</td></tr>
<tr><td><code id="signi_+3A_digits">digits</code></td>
<td>
<p>number of significant digits required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector &ldquo;close&rdquo; to <code>x</code>, i.e. by at least <code>digits</code>
significant digits.
</p>


<h3>Note</h3>

<p>This is really just <code>round(x, digits - trunc(log10(abs(x))))</code> and
hence mainly of didactical use.   Rather use <code>signif()</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, in prehistoric times (i.e. before 1990).</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+signif">signif</a></code>, <code><a href="base.html#topic+round">round</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x1 &lt;- seq(-2, 4, by = 0.5))
identical(x1, signi(x1))# since 0.5 is exact in binary arithmetic
(x2 &lt;- pi - 3 + c(-5,-1,0, .1, .2, 1, 10,100))
signi(x2, 3)
</code></pre>

<hr>
<h2 id='sourceAttach'>Source and Attach an R source file</h2><span id='topic+sourceAttach'></span>

<h3>Description</h3>

<p>Source (via <code><a href="base.html#topic+sys.source">sys.source</a>()</code>) and attach
(<code><a href="base.html#topic+attach">attach</a></code>) an <span class="rlang"><b>R</b></span> source file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sourceAttach(file, pos=2,
             name = paste(abbreviate(gsub(fsep,"", dirname(file)),
                                     12, method="both.sides"),
                          basename(file), sep=fsep),
             keep.source = getOption("keep.source.pkgs"),
             warn.conflicts = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sourceAttach_+3A_file">file</code></td>
<td>
<p>file name</p>
</td></tr>
<tr><td><code id="sourceAttach_+3A_pos">pos</code></td>
<td>
<p>passed to <code><a href="base.html#topic+attach">attach</a>()</code></p>
</td></tr>
<tr><td><code id="sourceAttach_+3A_name">name</code></td>
<td>
<p>character, with a smart default, passed to <code>attach()</code>.</p>
</td></tr>
<tr><td><code id="sourceAttach_+3A_keep.source">keep.source</code></td>
<td>
<p>logical, see <code><a href="base.html#topic+sys.source">sys.source</a>()</code>.</p>
</td></tr>
<tr><td><code id="sourceAttach_+3A_warn.conflicts">warn.conflicts</code></td>
<td>
<p>logical, see <code><a href="base.html#topic+attach">attach</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the return value of <code><a href="base.html#topic+attach">attach</a>()</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 29 Jul 2011</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+attach">attach</a></code>, <code><a href="base.html#topic+sys.source">sys.source</a></code>, <code><a href="base.html#topic+source">source</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> sourceAttach(system.file("test-tools-1.R", package="Matrix", mustWork=TRUE))
 search() # shows the new "data base" at position 2
 ## look what it contains:
 ls.str(pos = 2)
</code></pre>

<hr>
<h2 id='str_data'>Overview on All Datasets in an R Package</h2><span id='topic+str_data'></span>

<h3>Description</h3>

<p>Provide an overview over all datasets available by
<code><a href="utils.html#topic+data">data</a>()</code> in a (list of) given <span class="rlang"><b>R</b></span> packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>str_data(pkgs, filterFUN, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="str_data_+3A_pkgs">pkgs</code></td>
<td>
<p>character vector of names of <span class="rlang"><b>R</b></span> packages.</p>
</td></tr>
<tr><td><code id="str_data_+3A_filterfun">filterFUN</code></td>
<td>
<p>optionally a <code><a href="base.html#topic+logical">logical</a></code>
<code><a href="base.html#topic+function">function</a></code> for filtering the <span class="rlang"><b>R</b></span> objects.</p>
</td></tr>
<tr><td><code id="str_data_+3A_...">...</code></td>
<td>
<p>potentical further arguments to be passed to
<code><a href="utils.html#topic+str">str</a></code>; <code>str(utils:::str.default)</code> gives useful list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisibly (see <code><a href="base.html#topic+invisible">invisible</a></code>) a <code><a href="base.html#topic+list">list</a></code> with
named components matching the <code>pkgs</code> argument.  Each of these
components is a named list with one entry per <code>data(.)</code> argument
name.  Each entry is a <code><a href="base.html#topic+character">character</a></code> vector of the names
of all objects, typically only one.
</p>
<p>The side effect is, as with <code><a href="utils.html#topic+str">str</a>()</code>, to print
everything (via <code><a href="base.html#topic+cat">cat</a></code>) to the console.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+str">str</a></code>, <code><a href="utils.html#topic+data">data</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str_data("cluster")

str_data("datasets", max=0, give.attr = FALSE)

## Filtering (and return value)
dfl &lt;- str_data("datasets", filterFUN=is.data.frame)
str(df.d &lt;- dfl$datasets)
## dim() of all those data frames:
t(sapply(unlist(df.d), function(.) dim(get(.))))

### Data sets in all attached packages but "datasets" (and stubs):
s &lt;- search()
(Apkgs &lt;- sub("^package:", '', s[grep("^package:", s)]))
str_data(Apkgs[!Apkgs %in% c("datasets", "stats", "base")])
</code></pre>

<hr>
<h2 id='Sys.cpuinfo'>Provide Information about the Linux Hardware (CPU, Memory, etc)</h2><span id='topic+Sys.procinfo'></span><span id='topic+Sys.cpuinfo'></span><span id='topic+Sys.meminfo'></span><span id='topic+Sys.memGB'></span><span id='topic+Sys.MIPS'></span>

<h3>Description</h3>

<p>Return information about the Linux hardware, notably
the CPU (the central processor unit) and memory of the
computer <span class="rlang"><b>R</b></span> is running on.
This is currently <b>only available for Linux</b>.
</p>
<p>These functions exist on other unix-alike platforms, but produce an
error when called.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.procinfo(procfile)
Sys.cpuinfo()
Sys.meminfo()
Sys.memGB(kind = "MemTotal")
Sys.MIPS()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.cpuinfo_+3A_procfile">procfile</code></td>
<td>
<p>name of file the lines of which give the CPU info &ldquo;as
on Linux&rdquo;</p>
</td></tr>
<tr><td><code id="Sys.cpuinfo_+3A_kind">kind</code></td>
<td>
<p>a <code><a href="base.html#topic+character">character</a></code> string specifying which
<em>kind</em> of memory is desired.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>Sys.*info()</code> functions return a <code>"simple.list"</code>,
here basically a named character vector,
(where the names have been filtered through <code><a href="base.html#topic+make.names">make.names</a>(*,
  unique=TRUE)</code> which is of importance for multi-processor or multi-core
CPUs, such that vector can easily be indexed.
</p>
<p><code>Sys.memGB()</code> returns available memory in giga bytes [GB];<br />
<code>Sys.MIPS()</code> returns a number giving an approximation of
the <b>M</b>illion <b>I</b>instructions <b>P</b>er <b>S</b>econd that
the CPU processes (using &ldquo;bogomips&rdquo;).  This is a performance
measure of the basic <em>non-numeric</em> processing capabilities.
For single-core Linux systems, often about twice the basic clock rate
in &ldquo;MHz&rdquo; (as available by <code>Sys.cpuinfo()["cpu.MHz"]</code>); now,
with multicore systems, the result is often around (but smaller than)
<code>2 * #{cores} * clock.rate</code>.
</p>


<h3>Note</h3>

<p>These currently do rely on the Linux &lsquo;<span class="file">/proc/</span>&rsquo; file system, and may not
easily be portable to non-Linux environments.
</p>
<p>On multi-processor machines, <code>Sys.cpuinfo()</code> contains each field
for each processor (i.e., <code>names(Sys.cpuinfo())</code> has
<code><a href="base.html#topic+duplicated">duplicated</a></code> entries).
</p>
<p>Conceivably, the bogoMIPS source code is open and available and could
be built into <span class="rlang"><b>R</b></span>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.ps">Sys.ps</a></code>, etc.</p>


<h3>Examples</h3>

<pre><code class='language-R'>(n.cores &lt;- parallel::detectCores())
if(substr(R.version[["os"]], 1,5) == "linux") { ##-- only on Linux
  Sys.cpuinfo() # which is often ugly; this looks much better:
  length(Sys.cpu2 &lt;- local({I &lt;- Sys.cpuinfo(); I[ !grepl("^flags", names(I)) ] }))
  ## may still be too much, notably if n.cores &gt; 2:
  (Sys3 &lt;- Sys.cpu2[!grepl("[.][0-9]+$", names(Sys.cpu2))])

  Sys.MIPS() ## just the 'bogomips' from above:
  Sys.MIPS() / as.numeric(Sys.cpuinfo()["cpu.MHz"]) ## ~~ 2 * #{cores} ((no longer))

  ## Available Memory -- can be crucial:
  Sys.memGB() #- default "MemTotal"
  if(Sys.memGB("MemFree") &gt; 16)
     message("Be happy! You have more than 16 Gigabytes of free memory")
}
</code></pre>

<hr>
<h2 id='Sys.ps'>Return Process Status (Unix 'ps') Information</h2><span id='topic+Sys.ps'></span><span id='topic+Sys.sizes'></span>

<h3>Description</h3>

<p>These functions return process id and status information, typically
about the running <span class="rlang"><b>R</b></span> process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.ps(process= Sys.getpid(),
       fields = c("pid", "pcpu", "time", "vsz", "comm"),
       usefile = length(fields) &gt; 10,
       ps.cmd  = Sys.ps.cmd(),
       verbose = getOption("verbose"),
       warn.multi = verbose || any(fields != "ALL"))

Sys.sizes(process = Sys.getpid(), ps.cmd = Sys.ps.cmd())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.ps_+3A_process">process</code></td>
<td>
<p>the process id, an integer.</p>
</td></tr>
<tr><td><code id="Sys.ps_+3A_fields">fields</code></td>
<td>
<p>character strings of <code>"ALL"</code>, specifying which
process status fields are desired.</p>
</td></tr>
<tr><td><code id="Sys.ps_+3A_usefile">usefile</code></td>
<td>
<p>logical; if true, <code><a href="base.html#topic+system">system</a></code> writes to a
temporary file and that is <code><a href="base.html#topic+scan">scan</a></code>ed subsequently.</p>
</td></tr>
<tr><td><code id="Sys.ps_+3A_ps.cmd">ps.cmd</code></td>
<td>
<p>character string, giving the &ldquo;ps&rdquo; command name to be used.</p>
</td></tr>
<tr><td><code id="Sys.ps_+3A_verbose">verbose</code></td>
<td>
<p>logical ...</p>
</td></tr>
<tr><td><code id="Sys.ps_+3A_warn.multi">warn.multi</code></td>
<td>
<p>logical ...</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use <code>man ps</code> on your respective Unix system, to see what fields are
supported exactly.  Unix dialects <em>do</em> differ here, and,
SunOS-Solaris even has more than one ps command...
</p>


<h3>Value</h3>

<p>Note, that <code>Sys.sizes()</code> currently returns two integers which are
&ldquo;common&rdquo; to Solaris and Linux.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+Sys.info">Sys.info</a></code>, <code><a href="base.html#topic+Sys.getpid">Sys.getpid</a></code>,
<code><a href="base.html#topic+proc.time">proc.time</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(.pid &lt;- Sys.getpid()) ## process ID of current process
Sys.sizes(.pid)

## The default process statistics about the running R process
try( Sys.ps() )
</code></pre>

<hr>
<h2 id='TA.plot'>Tukey-Anscombe Plot (Residual vs. Fitted) of a Linear Model</h2><span id='topic+TA.plot'></span>

<h3>Description</h3>

<p>From a linear (or glm) model fitted, produce the so-called Tukey-Anscombe
plot.  Useful (optional) additions include:   0-line, lowess smooth,
2sigma lines,  and automatic labeling of observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TA.plot(lm.res,
        fit= fitted(lm.res), res= residuals(lm.res, type="pearson"),
        labels= NULL, main= mk.main(), xlab = "Fitted values",
        draw.smooth= n &gt;= 10, show.call = TRUE, show.2sigma= TRUE,
        lo.iter = NULL, lo.cex= NULL,
        par0line  = list(lty = 2, col = "gray"),
        parSmooth = list(lwd = 1.5, lty = 4, col = 2),
        parSigma  = list(lwd = 1.2, lty = 3, col = 4),
        verbose = FALSE,
        ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TA.plot_+3A_lm.res">lm.res</code></td>
<td>
<p>Result of <code><a href="stats.html#topic+lm">lm</a>(..)</code>, <code><a href="stats.html#topic+aov">aov</a>(..)</code>,
<code><a href="stats.html#topic+glm">glm</a>(..)</code> or a similar object.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_fit">fit</code></td>
<td>
<p>fitted values; you probably want the default here.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_res">res</code></td>
<td>
<p>residuals to use. Default: <b>Weighted</b> (&quot;Pearson&quot;) residuals if
weights have been used for the model fit.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_labels">labels</code></td>
<td>
<p>strings to use as plotting symbols for each point.
Default(<code>NULL</code>): extract observations' names or use its sequence number.
Use, e.g., &quot;*&quot; to get simple <code>*</code> symbols.
</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_main">main</code></td>
<td>
<p>main title to plot. Default: sophisticated, resulting in
something like &quot;Tukey-Anscombe Plot of :   y ~ x&quot;  constructed from
<code>lm.res $ call</code>.
</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label for plot.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_draw.smooth">draw.smooth</code></td>
<td>
<p>logical; if <code>TRUE</code>, draw a <code>lowess</code> smoother
(with automatic smoothing fraction).</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_show.call">show.call</code></td>
<td>
<p>logical; if <code>TRUE</code>, write the &quot;call&quot;ing syntax with
which the fit was done.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_show.2sigma">show.2sigma</code></td>
<td>
<p>logical; if <code>TRUE</code>, draw horizontal lines at
<code class="reqn">\pm 2\sigma</code> where <code class="reqn">\sigma</code> is <code>mad(resid)</code>.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_lo.iter">lo.iter</code></td>
<td>
<p>positive integer, giving the number of lowess
robustness iterations. The default depends on the model and
is <code>0</code> for non Gaussian <code><a href="stats.html#topic+glm">glm</a></code>'s.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_lo.cex">lo.cex</code></td>
<td>
<p>character expansion (&quot;cex&quot;) for lowess and other
marginal texts.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_par0line">par0line</code></td>
<td>
<p>a list of arguments (with reasonable defaults) to be passed to
<code><a href="graphics.html#topic+abline">abline</a>(.)</code> when drawing the x-axis, i.e.,
the <code class="reqn">y = 0</code> line.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_parsmooth">parSmooth</code>, <code id="TA.plot_+3A_parsigma">parSigma</code></td>
<td>
<p>each a list of arguments (with reasonable
default) for drawing the smooth curve (if <code>draw.smooth</code> is
true), or the horizontal sigma boundaries (if <code>show.2sigma</code> is
true) respectively.</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating if some construction details should
be reported (<code><a href="base.html#topic+print">print</a>()</code>ed).</p>
</td></tr>
<tr><td><code id="TA.plot_+3A_...">...</code></td>
<td>
<p>further graphical parameters are passed to
<code><a href="#topic+n.plot">n.plot</a>(.)</code>.</p>
</td></tr>
</table>


<h3>Side Effects</h3>

<p>The above mentioned plot is produced on the current graphic device.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Seminar fuer Statistik, ETH Zurich, Switzerland;
<a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+plot.lm">plot.lm</a></code> which also does a QQ normal plot and more.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stackloss)
TA.plot(lm(stack.loss ~ stack.x))

example(airquality)
summary(lmO &lt;- lm(Ozone ~ ., data= airquality))
TA.plot(lmO)
TA.plot(lmO, label = "O") # instead of case numbers

if(FALSE) { 
 TA.plot(lm(cost ~ age+type+car.age, claims, weights=number, na.action=na.omit))
}

##--- for  aov(.) : -------------
data(Gun, package = "nlme")
TA.plot( aov(rounds ~ Method + Physique/Team, data = Gun))

##--- Not so clear what it means for GLM, but: ------
if(require(rpart)) { # for the two datasets only
 data(solder, package = "rpart")
 TA.plot(glm(skips ~ ., data = solder, family = poisson), cex= .6)

 data(kyphosis, package = "rpart")
 TA.plot(glm(Kyphosis ~ poly(Age,2) + Start, data=kyphosis, family = binomial),
	 cex=.75) # smaller title and plotting characters
}
</code></pre>

<hr>
<h2 id='tapplySimpl'>More simplification in tapply() result</h2><span id='topic+tapplySimpl'></span>

<h3>Description</h3>

<p>For the case of more than two categories or indices (in <code>INDEX</code>),
traditional <code><a href="base.html#topic+tapply">tapply</a>(*, simplify = TRUE)</code> still returns a
list when an array may seem more useful and natural.  This is provided
by <code>tapplySimpl()</code> if the function <code>FUN()</code> is defined such
as to return a vector of the same length in all cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tapplySimpl(X, INDEX, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tapplySimpl_+3A_x">X</code></td>
<td>
<p>an atomic object, typically a vector.  All these arguments
are as in <code><a href="base.html#topic+tapply">tapply</a>()</code> and are passed to <code>tapply(..)</code>.</p>
</td></tr>
<tr><td><code id="tapplySimpl_+3A_index">INDEX</code></td>
<td>
<p>list of (typically more than one) factors, each of same
length as <code>X</code>.</p>
</td></tr>
<tr><td><code id="tapplySimpl_+3A_fun">FUN</code></td>
<td>
<p>the function to be applied.  For the result to be
simplifiable, <code>FUN()</code> must return a vector of always the same
length.</p>
</td></tr>
<tr><td><code id="tapplySimpl_+3A_...">...</code></td>
<td>
<p>optional arguments to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the above conditions are satisfied, the list returned from
<code>r &lt;- tapply(X, INDEX, FUN, ...)</code> is simplified into an
<code><a href="base.html#topic+array">array</a></code> of rank <code class="reqn">1 + \#\{indices\}</code>, i.e.,
<code>1+length(INDEX)</code>; otherwise, <code>tapplySimpl()</code> returns the list
<code>r</code>, i.e., the same as <code>tapply()</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 14 Jun 1993 (for S-plus).</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+tapply">tapply</a>(*, simplify=TRUE)</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Using tapply() would give a list (with dim() of a matrix);
  ## here we get 3-array:

  data(esoph)
  with(esoph, {
       mima &lt;&lt;- tapplySimpl(ncases/ncontrols, list(agegp, alcgp),  range)
       stopifnot(dim(mima) == c(2, nlevels(agegp), nlevels(alcgp)))
       })
  aperm(mima)
</code></pre>

<hr>
<h2 id='tkdensity'>GUI Density Estimation using Tcl/Tk</h2><span id='topic+tkdensity'></span>

<h3>Description</h3>

<p>This is graphical user interface (GUI) to <code><a href="stats.html#topic+density">density</a></code>,
allowing for dynamic bandwidth choice and a simple kind of zooming,
relying on <code>library(tcltk)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tkdensity(y, n = 1024, log.bw = TRUE, showvalue = TRUE,
          xlim = NULL, do.rug = size &lt; 1000, kernels = NULL,
          from.f = if (log.bw) -2 else 1/1000,
          to.f   = if (log.bw) +2.2 else 2,
          col = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tkdensity_+3A_y">y</code></td>
<td>
<p>numeric; the data the density of which we want.</p>
</td></tr>
<tr><td><code id="tkdensity_+3A_n">n</code></td>
<td>
<p>integer; the number of abscissa values for
<code><a href="stats.html#topic+density">density</a></code> evaluation (and plotting).</p>
</td></tr>
<tr><td><code id="tkdensity_+3A_log.bw">log.bw</code></td>
<td>
<p>logical; if true (default), the gui scrollbar is on a
<em>log</em> bandwidth scale, otherwise, simple interval.</p>
</td></tr>
<tr><td><code id="tkdensity_+3A_showvalue">showvalue</code></td>
<td>
<p>logical; if true, the value of the current (log)
bandwidth is shown on top of the scrollbar.</p>
</td></tr>
<tr><td><code id="tkdensity_+3A_xlim">xlim</code></td>
<td>
<p>initial <code>xlim</code> for plotting, see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="tkdensity_+3A_do.rug">do.rug</code></td>
<td>
<p>logical indicating if <code><a href="graphics.html#topic+rug">rug</a>(y)</code> should be
added to each plot.  This is too slow for really large sample sizes.</p>
</td></tr>
<tr><td><code id="tkdensity_+3A_kernels">kernels</code></td>
<td>
<p>character vector of kernel names as allowable for the
<code>kernels</code> argument of the standard <code><a href="stats.html#topic+density">density</a></code> function.</p>
</td></tr>
<tr><td><code id="tkdensity_+3A_from.f">from.f</code>, <code id="tkdensity_+3A_to.f">to.f</code></td>
<td>
<p>numeric giving the left and right limit of the
bandwidth scrollbar.</p>
</td></tr>
<tr><td><code id="tkdensity_+3A_col">col</code></td>
<td>
<p>color to be used for the density curve.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>library(tcltk)</code> must be working, i.e., Tcl/Tk must have been
installed on your platform, and must have been visible during <span class="rlang"><b>R</b></span>'s
configuration and/or installation.
</p>
<p>You can not only choose the bandwidth (the most important parameter),
but also the kernel, and you can zoom in and out (in x-range only).
</p>


<h3>Value</h3>

<p>none.<br />
(How could this be done?  <code>tcltk</code> widgets run as separate processes!)
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, building on <code>demo(tkdensity)</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (dev.interactive(TRUE)) ## does really not make sense otherwise
 if(try(require("tcltk"))) { ## sometimes (rarely) there, but broken

  data(faithful)
  tkdensity(faithful $ eruptions)

  set.seed(7)
  if(require("nor1mix"))
     tkdensity(rnorMix(1000, MW.nm9), kernels = c("gaussian", "epanechnikov"))
 }
</code></pre>

<hr>
<h2 id='toLatex.numeric'>LaTeX or Sweave friendly Formatting of Numbers</h2><span id='topic+toLatex.numeric'></span>

<h3>Description</h3>

<p>Formats real numbers, possibly in scientific notation, with a given
number of digits after the decimal point.  Output can be used in LaTeX
math mode, e.g., for printing numbers in a table, where each number
has to be printed with the same number of digits after the decimal
point, even if the last digits are zeros.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'numeric'
toLatex(object, digits = format.info(object)[2],
        scientific = format.info(object)[3] &gt; 0, times = "\\cdot", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="toLatex.numeric_+3A_object">object</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="toLatex.numeric_+3A_digits">digits</code></td>
<td>
<p>number of digits <em>after the decimal point</em> (for the
mantissa if <code>scientific</code>).  The default behaves the same as <span class="rlang"><b>R</b></span>'s
<code><a href="base.html#topic+format">format</a>()</code>.</p>
</td></tr>
<tr><td><code id="toLatex.numeric_+3A_scientific">scientific</code></td>
<td>
<p>logical indicating if scientific notation <code>a *
      10^k</code> should be used.  The default behaves the same as <span class="rlang"><b>R</b></span>'s
<code><a href="base.html#topic+format">format</a>()</code>.</p>
</td></tr>
<tr><td><code id="toLatex.numeric_+3A_times">times</code></td>
<td>
<p>character string indicating the LaTeX symbol to be used for
the &lsquo;times&rsquo; sign.</p>
</td></tr>
<tr><td><code id="toLatex.numeric_+3A_...">...</code></td>
<td>
<p>unused; for compatibility with <code><a href="utils.html#topic+toLatex">toLatex</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+character">character</a></code> vector of the same length as <code>object</code>,
containing the formatted numbers.
</p>


<h3>Note</h3>

<p>We use <code>digits</code> for <code><a href="base.html#topic+round">round</a></code>, i.e., round after
the decimal point on purpose, rather than <code><a href="base.html#topic+signif">signif</a>()</code>icant
digit rounding as used by <code><a href="base.html#topic+print">print</a>()</code> or
<code><a href="base.html#topic+format">format</a>()</code>.
</p>


<h3>Author(s)</h3>

<p>Alain Hauser
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pretty10exp">pretty10exp</a></code> which gives <code><a href="base.html#topic+expression">expression</a></code>s
similar to our <code>scientific=TRUE</code>.
<code><a href="utils.html#topic+toLatex">toLatex</a></code> with other methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xx &lt;- pi * 10^(-9:9)

format(xx)
formatC(xx)

toLatex(xx) #-&gt; scientific = TRUE is chosen
toLatex(xx, scientific=FALSE)

sapply(xx, toLatex)
sapply(xx, toLatex, digits = 2)
</code></pre>

<hr>
<h2 id='u.assign0'>'Portable' assign / get functions (R / S-plus) for 'Frame 0'</h2><span id='topic+u.assign0'></span><span id='topic+u.get0'></span>

<h3>Description</h3>

<p><span class="rlang"><b>R</b></span> does not have S' concept of <code>frame = 0</code>, aka &lsquo;session
frame&rsquo;.  These two function were an attempt to provide a portable
way for working with frame 0, particularly when porting code
<em>from</em> S.
</p>
<p>They have been <b>deprecated</b> since August 2013.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>u.assign0(x, value, immediate = FALSE)
u.get0(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="u.assign0_+3A_x">x</code></td>
<td>
<p>character string giving the <em>name</em> of the object.</p>
</td></tr>
<tr><td><code id="u.assign0_+3A_value">value</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object which is to be assigned.</p>
</td></tr>
<tr><td><code id="u.assign0_+3A_immediate">immediate</code></td>
<td>
<p>logical, for S compatibility.  No use in <span class="rlang"><b>R</b></span>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Really don't use these anymore...</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+get">get</a></code>, <code><a href="base.html#topic+assign">assign</a></code>.</p>

<hr>
<h2 id='u.boxplot.x'>Utility Returning x-Coordinates of Boxplot</h2><span id='topic+u.boxplot.x'></span>

<h3>Description</h3>

<p>Return the x-coordinates in an &lsquo;n-way&rsquo; side-by-side boxplot.
This is an auxiliary function and exists mainly for backcompatibility
with S-plus.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>u.boxplot.x(n, j = 1:n, fullrange = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="u.boxplot.x_+3A_n">n</code></td>
<td>
<p>number of boxplots.</p>
</td></tr>
<tr><td><code id="u.boxplot.x_+3A_j">j</code></td>
<td>
<p>indices of boxplots.</p>
</td></tr>
<tr><td><code id="u.boxplot.x_+3A_fullrange">fullrange</code></td>
<td>
<p>x-coords as 'uniform' in <code class="reqn">[0,fullrange]</code>;
(f.=100, corresponds to Splus 3.x (x = 1,2)).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector of length <code>n</code>, with values inside <code class="reqn">(0,M)</code> where
<code class="reqn">M = </code> <code>fullrange</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+boxplot">boxplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'> u.boxplot.x(7) # == 8.93 22.62 36.3 ... 91.07
</code></pre>

<hr>
<h2 id='u.date'>Return Date[-Time] String in 'European' Format</h2><span id='topic+u.date'></span>

<h3>Description</h3>

<p>Return one string of the form &quot;day/month/year&quot;, plus &quot;hour:minutes&quot;,
optionally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>u.date(short=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="u.date_+3A_short">short</code></td>
<td>
<p>logical; if <code>TRUE</code>, no time is given.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String with current date (and time).
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, ca. 1992</p>


<h3>See Also</h3>

<p><code><a href="#topic+u.Datumvonheute">u.Datumvonheute</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>u.date()
u.date(short = TRUE)
</code></pre>

<hr>
<h2 id='u.datumdecode'>Convert &ldquo;Numeric&rdquo; Dates</h2><span id='topic+u.datumdecode'></span>

<h3>Description</h3>

<p>Daten der Form 8710230920 aufspalten in Jahr, Monat, Tag, Std, Min
</p>


<h3>Usage</h3>

<pre><code class='language-R'>u.datumdecode(d, YMDHMnames = c("Jahr", "Monat", "Tag", "Std", "Min"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="u.datumdecode_+3A_d">d</code></td>
<td>
<p>numeric dates in the form YYMMDDHHMM.</p>
</td></tr>
<tr><td><code id="u.datumdecode_+3A_ymdhmnames">YMDHMnames</code></td>
<td>
<p>(column) names to be used for the result.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric matrix (or vector) with 5 columns containing the year,
month, etc.
</p>


<h3>Note</h3>


<p>MM: This is a wrong concept, and also suffers from the &ldquo;millenium bug&rdquo;
(by using only 2 digits for the year).
</p>


<h3>Author(s)</h3>

<p>?? (someone at SfS ETH)</p>


<h3>See Also</h3>

<p><span class="rlang"><b>R</b></span>'s <em>proper</em> date-time coding: <code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>;
<code><a href="#topic+u.date">u.date</a></code> etc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u.datumdecode(8710230920)
##  Jahr Monat   Tag   Std   Min
##    87    10    23     9    20

u.datumdecode(c(8710230900, 9710230920, 0210230920))
##      Jahr Monat Tag Std Min
## [1,]   87    10  23   9  00
## [2,]   97    10  23   9  20
## [3,]    2    10  23   9  20
</code></pre>

<hr>
<h2 id='u.Datumvonheute'>Datum und Uhrzeit (auf deutsch)</h2><span id='topic+u.Datumvonheute'></span><span id='topic+C.Monatsname'></span><span id='topic+C.Wochentag'></span><span id='topic+C.Wochentagkurz'></span><span id='topic+C.weekday'></span>

<h3>Description</h3>

<p>Return current date and time as a string, possibly including day of
the week in <em>German</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>u.Datumvonheute(W.tag=2, Zeit=FALSE)

C.Monatsname
C.Wochentag
C.Wochentagkurz
C.weekday
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="u.Datumvonheute_+3A_w.tag">W.tag</code></td>
<td>
<p>logical or integer specifying you want weekday (&lsquo;Wochentag&rsquo;).
<code>0</code> or <code>FALSE</code> gives no,  <code>1</code> or <code>TRUE</code> gives a
short and <code>2</code> the long version of the day of the week.</p>
</td></tr>
<tr><td><code id="u.Datumvonheute_+3A_zeit">Zeit</code></td>
<td>
<p>logical or integer specifying if time (&quot;Zeit&quot;) is desired.
<code>0</code> or <code>FALSE</code> gives no,  <code>1</code> or <code>TRUE</code> gives a
hours only and <code>2</code> hours and minutes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string with the current date/time, in the form specified by the arguments.
</p>
<p>The <code>C.*</code> are <code><a href="base.html#topic+character">character</a></code> vector &ldquo;constants&rdquo;,
the German ones actually used by <code>u.Datumvonheute</code>.
</p>


<h3>Author(s)</h3>

<p>Caterina Savi, Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#topic+u.date">u.date</a></code> for a similar English version, and
<code><a href="#topic+p.datum">p.datum</a></code> which plots.
For English month names, etc <code><a href="base.html#topic+month.name">month.name</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u.Datumvonheute()
u.Datumvonheute(W.tag=1, Zeit=TRUE)
u.Datumvonheute(W.tag= FALSE, Zeit=2)
</code></pre>

<hr>
<h2 id='u.log'>(Anti)Symmetric Log High-Transform</h2><span id='topic+u.log'></span>

<h3>Description</h3>

<p>Compute <code class="reqn">log()</code> only for high values and keep low ones &ndash;
antisymmetrically such that <code>u.log(x)</code> is (once) continuously
differentiable, it computes
<code class="reqn">f(x) = x</code> for <code class="reqn">|x| \le c</code>  and
<code class="reqn">sign(x)  c\cdot(1 + log(|x|/c))</code>
for <code class="reqn">|x| \ge c</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>u.log(x, c = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="u.log_+3A_x">x</code></td>
<td>
<p>numeric vector to be transformed.</p>
</td></tr>
<tr><td><code id="u.log_+3A_c">c</code></td>
<td>
<p>scalar, &gt; 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Alternatively, the &lsquo;IHS&rsquo; (inverse hyperbolic sine)
transform has been proposed, first in more generality as <code class="reqn">S_U()</code>
curves by Johnson(1949); in its simplest form,
<code class="reqn">f(x) = arsinh(x) = \log(x + \sqrt{x^2 + 1})</code>,
which is also antisymmetric, continous and once differentiable as our <code>u.log(.)</code>.
</p>


<h3>Value</h3>

<p>numeric vector of same length as <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 24 Jan 1995</p>


<h3>References</h3>

<p>N. L. Johnson (1949).
Systems of Frequency Curves Generated by Methods of Translation,
<em>Biometrika</em> <b>36</b>, pp 149&ndash;176.
<a href="https://doi.org/10.2307/2332539">doi:10.2307/2332539</a>
</p>


<h3>See Also</h3>

<p>Werner Stahel's sophisticated version of John Tukey's &ldquo;started log&rdquo; (which was <code class="reqn">\log(x
    + c)</code>), with concave extension to negative values and adaptive default choice of <code class="reqn">c</code>;
<code><a href="relevance.html#topic+logst">logst</a></code> in his CRAN package <a href="https://CRAN.R-project.org/package=relevance"><span class="pkg">relevance</span></a>, or
<code><a href="DescTools.html#topic+LogSt">LogSt</a></code> in package <a href="https://CRAN.R-project.org/package=DescTools"><span class="pkg">DescTools</span></a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>curve(u.log, -3, 10); abline(h=0, v=0, col = "gray20", lty = 3)
curve(1 + log(x), .01,  add = TRUE, col= "brown") # simple log
curve(u.log(x,    2),   add = TRUE, col=2)
curve(u.log(x, c= 0.4), add = TRUE, col=4)

## Compare with  IHS = inverse hyperbolic sine == asinh 
ihs &lt;- function(x) log(x+sqrt(x^2+1)) # == asinh(x) {aka "arsinh(x)" or "sinh^{-1} (x)"}
xI &lt;- c(-Inf, Inf, NA, NaN)
stopifnot(all.equal(xI, asinh(xI))) # but not for ihs():
cbind(xI, asinh=asinh(xI), ihs=ihs(xI)) # differs for -Inf
x &lt;- runif(500, 0, 4); x[100+0:3] &lt;- xI
all.equal(ihs(x), asinh(x)) #==&gt;  is.NA value mismatch:  asinh() is correct {i.e. better!}

curve(u.log, -2, 20, n=1000); abline(h=0, v=0, col = "gray20", lty = 3)
curve(ihs(x)+1-log(2), add=TRUE, col=adjustcolor(2, 1/2), lwd=2)
curve(ihs(x),          add=TRUE, col=adjustcolor(4, 1/2), lwd=2)
## for x &gt;= 0, u.log(x) is nicely between IHS(x) and shifted IHS

## a  log10-scale version of asinh()  {aka "IHS" }: ihs10(x) :=  asinh(x/2) / ln(10)
ihs10 &lt;- function(x) asinh(x/2)/log(10)
xyaxis &lt;- function() abline(h=0, v=0, col = "gray20", lty = 3)
leg3 &lt;- function(x = "right")
    legend(x, legend = c(quote(ihs10(x) == asinh(x/2)/log(10)),
                         quote(log[10](1+x)), quote(log[10](x))),
           col=c(1,2,5), bty="n", lwd=2)
curve(asinh(x/2)/log(10), -5, 20, n=1000, lwd=2); xyaxis()
curve(log10(1+x), col=2, lwd=2, add=TRUE)
curve(log10( x ), col=5, lwd=2, add=TRUE); leg3()

## zoom out  and  x-log-scale
curve(asinh(x/2)/log(10), .1, 100, log="x", n=1000); xyaxis()
curve(log10(1+x), col=2, add=TRUE)
curve(log10( x ), col=5, add=TRUE) ; leg3("center")

curve(log10(1+x) - ihs10(x), .1, 1000, col=2, n=1000, log="x", ylim = c(-1,1)*0.10,
      main = "absolute difference", xaxt="n"); xyaxis(); eaxis(1, sub10=1)
curve(log10( x ) - ihs10(x), col=4, n=1000, add = TRUE)

curve(abs(1 - ihs10(x) / log10(1+x)), .1, 5000, col=2, log = "xy", ylim = c(6e-9, 2),
      main="|relative error| of approx. ihs10(x) :=  asinh(x/2)/log(10)", n=1000, axes=FALSE)
eaxis(1, sub10=1); eaxis(2, sub10=TRUE)
curve(abs(1 - ihs10(x) / log10(x)), col=4, n=1000, add = TRUE)
legend("left", legend = c(quote(log[10](1+x)), quote(log[10](x))),
       col=c(2,4), bty="n", lwd=1)

## Compare with Stahel's version of "started log"
## (here, for *vectors* only, and 'base', as Desctools::LogSt();

## by MM: "modularized" by providing a threshold-computer function separately:
logst_thrWS &lt;- function(x, mult = 1) {
    lq &lt;- quantile(x[x &gt; 0], probs = c(0.25, 0.75), na.rm = TRUE, names = FALSE)
    if (lq[1] == lq[2])
        lq[1] &lt;- lq[2]/2
    lq[1]^(1 + mult)/lq[2]^mult
}
logst0L &lt;- function(x, calib = x, threshold = thrFUN(calib, mult=mult),
                   thrFUN = logst_thrWS, mult = 1, base = 10)
{
    ## logical index sub-assignment instead of ifelse(): { already in DescTools::LogSt }
    res &lt;- x # incl NA's
    notNA &lt;- !is.na(sml &lt;- (x &lt; (th &lt;- threshold)))
    i1 &lt;-  sml &amp; notNA; res[i1] &lt;- log(th, base) + ((x[i1] - th)/(th * log(base)))
    i2 &lt;- !sml &amp; notNA; res[i2] &lt;- log(x[i2], base)
    attr(res, "threshold") &lt;- th
    attr(res, "base") &lt;- base
    res
}
logst0 &lt;- function(x, calib = x, threshold = thrFUN(calib, mult=mult),
                   thrFUN = logst_thrWS, mult = 1, base = 10)
{
    ## Using pmax.int() instead of logical indexing -- NA's work automatically - even faster
    xm &lt;- pmax.int(threshold, x)
    res &lt;- log(xm, base) + (x - xm)/(threshold * log(base))
    attr(res, "threshold") &lt;- threshold
    attr(res, "base") &lt;- base
    res
}

## u.log() is really using natural log() -- whereas logst() defaults to base=10
curve(u.log, -4, 10, n=1000); abline(h=0, v=0, col = "gray20", lty = 3); points(-1:1, -1:1, pch=3)
curve(log10(x) + 1,  add=TRUE, col=adjustcolor("midnightblue", 1/2), lwd=4, lty=6)
curve(log10(x),      add=TRUE, col=adjustcolor("skyblue3",     1/2), lwd=4, lty=7)
curve(logst0(x, threshold= 2  ), add=TRUE, col=adjustcolor("orange",1/2), lwd=2)
curve(logst0(x, threshold= 1  ), add=TRUE, col=adjustcolor(2, 1/2), lwd=2)
curve(logst0(x, threshold= 1/4), add=TRUE, col=adjustcolor(3, 1/2), lwd=2, lty=2)
curve(logst0(x, threshold= 1/8), add=TRUE, col=adjustcolor(4, 1/2), lwd=2, lty=2)
</code></pre>

<hr>
<h2 id='u.sys'>'Portable' System function (R / S-plus)</h2><span id='topic+u.sys'></span><span id='topic+Sys.ps.cmd'></span>

<h3>Description</h3>

<p><code>u.sys()</code> is a convenient wrapper (of <code>system()</code>) to call to
the underlying operating system.  The main purpose has been to provide
a function with identical UI both in S-PLUS and <span class="rlang"><b>R</b></span>.
MM thinks you shouldn't use this anymore, usually.
</p>
<p><code>Sys.ps.cmd()</code> returns the &lsquo;<span class="samp">&#8288;ps&#8288;</span>&rsquo; (&lsquo;<b>p</b>rocess <b>s</b>tatus&rsquo;)
OS command name (as <code><a href="base.html#topic+character">character</a></code> string), and is typically
usable on unix alikes only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>u.sys(..., intern = TRUE)

Sys.ps.cmd()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="u.sys_+3A_...">...</code></td>
<td>
<p>any number of strings &ndash; which will be
<code><a href="base.html#topic+paste">paste</a>()</code>d together and passed to <code>system</code>.</p>
</td></tr>
<tr><td><code id="u.sys_+3A_intern">intern</code></td>
<td>
<p>logical &ndash; note that the default is <em>reversed</em> from
the one in <code><a href="base.html#topic+system">system</a>()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+system">system</a></code>, really!;
on non-Windows, <code>Sys.ps()</code> which makes use of <code>Sys.ps.cmd()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u.sys # shows how simply the function is defined :
## Not run: 
  function (..., intern = TRUE)
  system(paste(..., sep = ""), intern = intern)

## End(Not run)

# All *running* processes of user [sometimes only R]:
try ( u.sys(Sys.ps.cmd(), "ur") )
</code></pre>

<hr>
<h2 id='unif'>Nice Uniform Points in Interval</h2><span id='topic+unif'></span>

<h3>Description</h3>

<p>Give regularly spaced points on interval <code class="reqn">[-c,c]</code> with mean 0
(exactly) and variance about 1 (very close for <b>even</b> <code>n</code>
and larger <code>round.dig</code>).  Note that <code class="reqn">c</code> depends on <code>n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unif(n, round.dig = 1 + trunc(log10(n)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unif_+3A_n">n</code></td>
<td>
<p>positive integer specifying the number of points desired.</p>
</td></tr>
<tr><td><code id="unif_+3A_round.dig">round.dig</code></td>
<td>
<p>integer indicating to how many digits the result is
rounded.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of length <code>n</code>, symmetric around 0, hence
with exact mean <code>0</code>, and variance approximately 1.
</p>


<h3>Note</h3>

<p>It relies on the fact that <code class="reqn">Var(1,2,...,n) = n(n+1)/12</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, ca 1990</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+runif">runif</a></code> for producing uniform <em>random</em> numbers.</p>


<h3>Examples</h3>

<pre><code class='language-R'>(u &lt;- unif(8))
var(u)

(u. &lt;- unif(8, 12))# more digits in result, hence precision for Var :
var(u.)
</code></pre>

<hr>
<h2 id='uniqueL'>A Reversable Version of unique()</h2><span id='topic+uniqueL'></span>

<h3>Description</h3>

<p>A version of <code><a href="base.html#topic+unique">unique</a></code> keeping enough information to
reverse (or <em>invert</em>) to the original data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniqueL(x, isuniq = !duplicated(x), need.sort = is.unsorted(x))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uniqueL_+3A_x">x</code></td>
<td>
<p>numeric vector, of length <code>n</code>, say.</p>
</td></tr>
<tr><td><code id="uniqueL_+3A_isuniq">isuniq</code></td>
<td>
<p>logical vector of the same length as <code>x</code>.  For the
reversion to work this should select at least all unique values of
<code>x</code>.</p>
</td></tr>
<tr><td><code id="uniqueL_+3A_need.sort">need.sort</code></td>
<td>
<p>logical indicating if <code>x</code> is not yet sorted.
Note that this argument exists only for speedup possibility when it
is known, and that it <em>must be set correctly</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of two components,
</p>
<table>
<tr><td><code>ix</code></td>
<td>
<p>integer vector of indices</p>
</td></tr>
<tr><td><code>xU</code></td>
<td>
<p>vector of values from <code>x</code></p>
</td></tr>
</table>
<p>such that both <code>x[isuniq] === xU</code> and <code>xU[ix] === x</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#topic+Duplicated">Duplicated</a></code> from the <span class="pkg">sfsmisc</span> package in
addition to the standard <code><a href="base.html#topic+unique">unique</a></code> and
<code><a href="base.html#topic+duplicated">duplicated</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> x0 &lt;- c(1:3,2:7,8:4)
 str(r0 &lt;- uniqueL(x0))
 with(r0, xU[ix]) ## == x0 !

</code></pre>

<hr>
<h2 id='vcat'>Paste Utilities &ndash; Concatenate Strings</h2><span id='topic+vcat'></span><span id='topic+ccat'></span>

<h3>Description</h3>

<p>Con<b>cat</b>enate vector elements or anything using
<code><a href="base.html#topic+paste">paste</a>(*, collapse = .)</code>.
These are simple short abbreviations I have been using in my own codes
in many places.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vcat(vec, sep = " ")
ccat(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcat_+3A_vec">vec</code>, <code id="vcat_+3A_...">...</code></td>
<td>
<p>any vector and other arguments to be pasted to together.</p>
</td></tr>
<tr><td><code id="vcat_+3A_sep">sep</code></td>
<td>
<p>the separator to use, see the <em>Details</em> section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions are really just defined as<br />
vcat :=  <code>function(vec, sep = " ") paste(vec, collapse = sep)</code>
</p>
<p>ccat :=  <code>function(...)            paste(..., collapse = "", sep = "")</code>
</p>


<h3>Value</h3>

<p>a character string (of length 1) with the concatenated arguments.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, early 1990's.</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+paste">paste</a></code>, <code><a href="base.html#topic+as.character">as.character</a></code>,
<code><a href="base.html#topic+format">format</a></code>. <code><a href="base.html#topic+cat">cat</a>()</code> is really for printing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ch &lt;- "is"
ccat("This ", ch, " it: ", 100, "%")
vv &lt;- c(1,pi, 20.4)
vcat(vv)
vcat(vv, sep = ", ")
</code></pre>

<hr>
<h2 id='wrapFormula'>Enhance Formula by Wrapping each Term, e.g., by &quot;s(.)&quot;</h2><span id='topic+wrapFormula'></span>

<h3>Description</h3>

<p>The main motivation for this function has been the easy construction
of a &ldquo;full GAM formula&rdquo; from something as simple as
<code>Y ~ .</code>. <br />
The potential use is slightly more general.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrapFormula(f, data, wrapString = "s(*)")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrapFormula_+3A_f">f</code></td>
<td>
<p>the initial <code><a href="stats.html#topic+formula">formula</a></code>; typically something like
<code>Y ~ .</code>.</p>
</td></tr>
<tr><td><code id="wrapFormula_+3A_data">data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> to which the formula applies;
see, <code><a href="stats.html#topic+formula">formula</a></code> or also <code><a href="mgcv.html#topic+gam">gam</a></code> or
<code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code id="wrapFormula_+3A_wrapstring">wrapString</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> string, containing
<code>"*"</code>, specifying the wrapping expression to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="stats.html#topic+formula">formula</a></code> very similar to <code>f</code>; just replacing each
<em>additive</em> term by its wrapped version.
</p>


<h3>Note</h3>

<p>There are limits for this to work correctly; notably the right hand
side of the formula <code>f</code> should not be nested or otherwise
complicated, rather typically just <code> . </code> as in the examples.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, May 2007.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+formula">formula</a></code>;
<code><a href="mgcv.html#topic+gam">gam</a></code> from package <a href="https://CRAN.R-project.org/package=mgcv"><span class="pkg">mgcv</span></a> (or also from
package <a href="https://CRAN.R-project.org/package=gam"><span class="pkg">gam</span></a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myF &lt;- wrapFormula(Fertility ~ . , data = swiss)
myF # Fertility ~ s(Agriculture) + s(....) + ...

if(require("mgcv")) {
   m1 &lt;- gam(myF, data = swiss)
   print( summary(m1) )
   plot(m1, pages = 1) ; title(format(m1$call), line= 2.5)
}

## other wrappers:
wrapFormula(Fertility ~ . , data = swiss, wrap = "lo(*)")
wrapFormula(Fertility ~ . , data = swiss, wrap = "poly(*, 4)")
</code></pre>

<hr>
<h2 id='xy.grid'>Produce regular grid matrix.</h2><span id='topic+xy.grid'></span>

<h3>Description</h3>

<p>Produce the grid used by <code><a href="graphics.html#topic+persp">persp</a></code>, <a href="graphics.html#topic+contour">contour</a>, etc, as
an <code>N x 2</code> matrix.
This is really outdated by <code><a href="base.html#topic+expand.grid">expand.grid</a>()</code> nowadays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xy.grid(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xy.grid_+3A_x">x</code>, <code id="xy.grid_+3A_y">y</code></td>
<td>
<p>any vectors of same mode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a 2-column matrix of &ldquo;points&rdquo; for each combination of <code>x</code> and
<code>y</code>, i.e. with <code>length(x) * length(y)</code> rows.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 26 Oct 1994.</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+expand.grid">expand.grid</a></code> which didn't exist when
<code>xy.grid</code> was first devised.</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(xy.grid(1:7, 10*(0:4)))

x &lt;- 1:3 ;  y &lt;- 10*(0:4)
xyg &lt;- xy.grid(x,y)

## Compare with expand.grid() :
m2 &lt;- as.matrix(expand.grid(y,x)[, 2:1])
dimnames(m2) &lt;- NULL
stopifnot(identical(xyg, m2))
</code></pre>

<hr>
<h2 id='xy.unique.x'>Uniqify (X,Y) Values using Weights</h2><span id='topic+xy.unique.x'></span>

<h3>Description</h3>

<p>Given <em>smoother</em> data <code class="reqn">(x_i, y_i)</code> and maybe weights <code class="reqn">w_i</code>,
with multiple <code class="reqn">x_i</code>, use the unique x values, replacing the
<code class="reqn">y</code>'s by their (weighted) mean and updating the weights
accordingly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xy.unique.x(x, y, w, fun.mean = mean, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xy.unique.x_+3A_x">x</code>, <code id="xy.unique.x_+3A_y">y</code></td>
<td>
<p>numeric vectors of same length.  Alternatively, <code>x</code>
can be a &lsquo;xy&rsquo; like structure, see <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.</p>
</td></tr>
<tr><td><code id="xy.unique.x_+3A_w">w</code></td>
<td>
<p>numeric vector of non-negative weights &ndash; or missing which
corresponds to all weights equal.</p>
</td></tr>
<tr><td><code id="xy.unique.x_+3A_fun.mean">fun.mean</code></td>
<td>
<p>the mean <code><a href="base.html#topic+function">function</a></code> to use.</p>
</td></tr>
<tr><td><code id="xy.unique.x_+3A_...">...</code></td>
<td>
<p>optional arguments all passed to <code><a href="base.html#topic+unique">unique</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix with three columns, named
<code>x</code>, <code>y</code> and <code>w</code> with unique <code>x</code> values and
corresponding <code>y</code> and weights <code>w</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 8 Mar 1993.</p>


<h3>See Also</h3>

<p>e.g., <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> uses something like
this internally.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simple example:
x &lt;- c(1,1,2,4,3,1)
y &lt;- 1:6
rbind(x, y)
xy.unique.x(x, y)
#   x y w
# 1 1 3 3
# 2 2 3 1
# 3 4 4 1
# 4 3 5 1
xy.unique.x(x, y, fromLast = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
