<!DOCTYPE html><html><head><title>Help for package tehtuner</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tehtuner}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#get_mnpp'><p>Get the MNPP for the Step 2 model</p></a></li>
<li><a href='#get_mnpp.classtree'><p>Get the MNPP for a Classification Tree</p></a></li>
<li><a href='#get_mnpp.ctree'><p>Get the MNPP for a Conditional Inference Tree</p></a></li>
<li><a href='#get_mnpp.lasso'><p>Get the MNPP for a Model fit via Lasso</p></a></li>
<li><a href='#get_mnpp.rtree'><p>Get the MNPP for a Regression Tree</p></a></li>
<li><a href='#get_theta_null'><p>Permute a dataset under the null hypothesis and get the MNPP</p></a></li>
<li><a href='#get_vt1'><p>Get the appropriate Step 1 estimation function associated with a method</p></a></li>
<li><a href='#get_vt2'><p>Get the appropriate Step 2 estimation function associated with a method</p></a></li>
<li><a href='#permute'><p>Generate a dataset with permuted treatment indicators</p></a></li>
<li><a href='#print.tunevt'><p>Print an object of class tunevt</p></a></li>
<li><a href='#tehtuner_example'><p>Simulated example data</p></a></li>
<li><a href='#test_null_theta_ctree'><p>Test if a Value Gives a Null Conditional Inference Tree</p></a></li>
<li><a href='#tune_theta'><p>Estimate the penalty parameter for Step 2 of Virtual Twins</p></a></li>
<li><a href='#tunevt'><p>Fit a tuned Virtual Twins model</p></a></li>
<li><a href='#validate_alpha0'><p>Check if alpha0 is a valid input to tunevt</p></a></li>
<li><a href='#validate_p_reps'><p>Check if p_reps is a valid input to tunevt</p></a></li>
<li><a href='#validate_Trt'><p>Check if Trt is a valid input to tunevt</p></a></li>
<li><a href='#validate_Y'><p>Check if Y is a valid input to tunevt</p></a></li>
<li><a href='#vt1_lasso'><p>Estimate the CATE Using the Lasso for Step 1 of Virtual Twins</p></a></li>
<li><a href='#vt1_mars'><p>Estimate the CATE Using MARS for Step 1 of Virtual Twins</p></a></li>
<li><a href='#vt1_rf'><p>Estimate the CATE Using a Random Forest for Step 1 of Virtual Twins</p></a></li>
<li><a href='#vt1_super'><p>Estimate the CATE Using Super Learner for Step 1 of Virtual Twins</p></a></li>
<li><a href='#vt2_classtree'><p>Estimate the CATE using a classification tree for Step 2</p></a></li>
<li><a href='#vt2_ctree'><p>Estimate the CATE using a conditional inference tree for Step 2</p></a></li>
<li><a href='#vt2_lasso'><p>Estimate the CATE using the Lasso for Step 2</p></a></li>
<li><a href='#vt2_rtree'><p>Estimate the CATE using a regression tree for Step 2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Fit and Tune Models to Detect Treatment Effect Heterogeneity</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements methods to fit Virtual Twins models (Foster et al. 
  (2011) &lt;<a href="https://doi.org/10.1002%2Fsim.4322">doi:10.1002/sim.4322</a>&gt;) for identifying subgroups with differential
  effects in the context of clinical trials while controlling the probability
  of falsely detecting a differential effect when the conditional average
  treatment effect is uniform across the study population using parameter
  selection methods proposed in Wolf et al. (2022) 
  &lt;<a href="https://doi.org/10.1177%2F17407745221095855">doi:10.1177/17407745221095855</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>party, glmnet, Rdpack, rpart, stringr, SuperLearner,
randomForestSRC, earth, foreach</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jackmwolf/tehtuner">https://github.com/jackmwolf/tehtuner</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jackmwolf/tehtuner/issues">https://github.com/jackmwolf/tehtuner/issues</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-01 19:39:56 UTC; Jack</td>
</tr>
<tr>
<td>Author:</td>
<td>Jack Wolf <a href="https://orcid.org/0000-0002-8919-8740"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jack Wolf &lt;jackwolf910@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-01 19:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='get_mnpp'>Get the MNPP for the Step 2 model</h2><span id='topic+get_mnpp'></span>

<h3>Description</h3>

<p>Find the lowest penalty parameter so that the Step 2 model fit for the
estimated CATE from Step 1 is constant for all subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mnpp(z, data, step2, Trt, Y, threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mnpp_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="get_mnpp_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="get_mnpp_+3A_step2">step2</code></td>
<td>
<p>a character string specifying the Step 2 model. Supports
&quot;<code>lasso</code>&quot;, &quot;<code>rtree</code>&quot;,  &quot;<code>classtree</code>&quot;, or &quot;<code>ctree</code>&quot;.</p>
</td></tr>
<tr><td><code id="get_mnpp_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="get_mnpp_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="get_mnpp_+3A_threshold">threshold</code></td>
<td>
<p>for &quot;<code>step2 = 'classtree'</code>&quot; only. The value against
which to test if the estimated individual treatment effect from Step 1 is
higher (TRUE) or lower (FALSE).</p>
</td></tr>
</table>

<hr>
<h2 id='get_mnpp.classtree'>Get the MNPP for a Classification Tree</h2><span id='topic+get_mnpp.classtree'></span>

<h3>Description</h3>

<p>Finds the lowest complexity parameter for a null regression tree fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mnpp.classtree(z, data, Trt, Y, threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mnpp.classtree_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="get_mnpp.classtree_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="get_mnpp.classtree_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="get_mnpp.classtree_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="get_mnpp.classtree_+3A_threshold">threshold</code></td>
<td>
<p>for &quot;<code>step2 = 'classtree'</code>&quot; only. The value against
which to test if the estimated individual treatment effect from Step 1 is
higher (TRUE) or lower (FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the MNPP
</p>

<hr>
<h2 id='get_mnpp.ctree'>Get the MNPP for a Conditional Inference Tree</h2><span id='topic+get_mnpp.ctree'></span>

<h3>Description</h3>

<p>Finds the lowest test statistic for a null conditional inference tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mnpp.ctree(z, data, Trt, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mnpp.ctree_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="get_mnpp.ctree_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="get_mnpp.ctree_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="get_mnpp.ctree_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the MNPP
</p>

<hr>
<h2 id='get_mnpp.lasso'>Get the MNPP for a Model fit via Lasso</h2><span id='topic+get_mnpp.lasso'></span>

<h3>Description</h3>

<p>Finds the lowest penalty parameter for a null lasso model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mnpp.lasso(z, data, Trt, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mnpp.lasso_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="get_mnpp.lasso_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="get_mnpp.lasso_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="get_mnpp.lasso_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
</table>

<hr>
<h2 id='get_mnpp.rtree'>Get the MNPP for a Regression Tree</h2><span id='topic+get_mnpp.rtree'></span>

<h3>Description</h3>

<p>Finds the lowest complexity parameter for a null regression tree fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mnpp.rtree(z, data, Trt, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mnpp.rtree_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="get_mnpp.rtree_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="get_mnpp.rtree_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="get_mnpp.rtree_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the MNPP
</p>

<hr>
<h2 id='get_theta_null'>Permute a dataset under the null hypothesis and get the MNPP</h2><span id='topic+get_theta_null'></span>

<h3>Description</h3>

<p>Permute a dataset under the null hypothesis and get the MNPP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_theta_null(data, Trt, Y, zbar, step1, step2, threshold, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_theta_null_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="get_theta_null_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="get_theta_null_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="get_theta_null_+3A_zbar">zbar</code></td>
<td>
<p>the estimated marginal treatment effect</p>
</td></tr>
<tr><td><code id="get_theta_null_+3A_step1">step1</code></td>
<td>
<p>character strings specifying the Step 1 model. Supports
either &quot;<code>lasso</code>&quot;, &quot;<code>mars</code>&quot;, &quot;<code>randomforest</code>&quot;, or
&quot;<code>superlearner</code>&quot;.</p>
</td></tr>
<tr><td><code id="get_theta_null_+3A_step2">step2</code></td>
<td>
<p>a character string specifying the Step 2 model. Supports
&quot;<code>lasso</code>&quot;, &quot;<code>rtree</code>&quot;,  &quot;<code>classtree</code>&quot;, or &quot;<code>ctree</code>&quot;.</p>
</td></tr>
<tr><td><code id="get_theta_null_+3A_threshold">threshold</code></td>
<td>
<p>for &quot;<code>step2 = 'classtree'</code>&quot; only. The value against
which to test if the estimated individual treatment effect from Step 1 is
higher (TRUE) or lower (FALSE).</p>
</td></tr>
<tr><td><code id="get_theta_null_+3A_...">...</code></td>
<td>
<p>additional arguments to the Step 1 model call.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the MNPP for the permuted data set
</p>

<hr>
<h2 id='get_vt1'>Get the appropriate Step 1 estimation function associated with a method</h2><span id='topic+get_vt1'></span>

<h3>Description</h3>

<p>Get the appropriate Step 1 estimation function associated with a method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_vt1(step1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_vt1_+3A_step1">step1</code></td>
<td>
<p>character strings specifying the Step 1 model. Supports
either &quot;<code>lasso</code>&quot;, &quot;<code>mars</code>&quot;, &quot;<code>randomforest</code>&quot;, or
&quot;<code>superlearner</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function that estimates the CATE through Step 1 of Virtual Twins
</p>

<hr>
<h2 id='get_vt2'>Get the appropriate Step 2 estimation function associated with a method</h2><span id='topic+get_vt2'></span>

<h3>Description</h3>

<p>Get the appropriate Step 2 estimation function associated with a method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_vt2(step2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_vt2_+3A_step2">step2</code></td>
<td>
<p>a character string specifying the Step 2 model. Supports
&quot;<code>lasso</code>&quot;, &quot;<code>rtree</code>&quot;,  &quot;<code>classtree</code>&quot;, or &quot;<code>ctree</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function that fits a model for the CATE through Step 2 of Virtual
Twins
</p>

<hr>
<h2 id='permute'>Generate a dataset with permuted treatment indicators</h2><span id='topic+permute'></span>

<h3>Description</h3>

<p>Sets the marginal treatment effect to zero and then permute all treatment
indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute(data, Trt, Y, zbar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="permute_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="permute_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="permute_+3A_zbar">zbar</code></td>
<td>
<p>the estimated marginal treatment effect</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a permuted dataset of the same size as <code>data</code>
</p>

<hr>
<h2 id='print.tunevt'>Print an object of class tunevt</h2><span id='topic+print.tunevt'></span>

<h3>Description</h3>

<p>Prints a Virtual Twins model for the conditional average treatment effect
with a tuned Step 2 model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tunevt'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.tunevt_+3A_x">x</code></td>
<td>
<p>an object of class <code>tunevt</code></p>
</td></tr>
<tr><td><code id="print.tunevt_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="print.tunevt_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"tunevt"</code>.
</p>
<p>An object of class <code>"tunevt"</code> is a list containing at least the
following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>vtmod</code></td>
<td>
<p>the model estimated by the given <code>step2</code> procedure fit
with the permuted tuning parameter for the estimated CATEs from the
<code>step1</code> model. See <code><a href="#topic+vt2_lasso">vt2_lasso</a></code>,
<code><a href="#topic+vt2_rtree">vt2_rtree</a></code>, or <code><a href="#topic+vt2_ctree">vt2_ctree</a></code> for specifics.</p>
</td></tr>
<tr><td><code>mnpp</code></td>
<td>
<p>the MNPP for the estimated CATEs from Step 1.</p>
</td></tr>
<tr><td><code>theta_null</code></td>
<td>
<p>a vector of the MNPPs from each permutation under
the null hypothesis.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>the probability of observing a MNPP as or more extreme
as the observed MNPP under the null hypothesis of no effect
heterogeneity.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>if <code>keepz = TRUE</code>, the estimated CATEs from the
<code>step1</code> model.</p>
</td></tr>
</table>

<hr>
<h2 id='tehtuner_example'>Simulated example data</h2><span id='topic+tehtuner_example'></span>

<h3>Description</h3>

<p>Simulated data from a clinical trial with heterogeneous treatment effects
where the CATE was a function of V1 and V9.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tehtuner_example
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 12 columns:
</p>

<dl>
<dt>Trt</dt><dd><p>Binary treatment indicator</p>
</dd>
<dt>Y</dt><dd><p>Continuous response</p>
</dd>
<dt>V1,V2,V3,V4,V5,V6,V7,V8</dt><dd><p>Continuous covariates</p>
</dd>
<dt>V9,V10</dt><dd><p>Binary covariates</p>
</dd>
</dl>


<hr>
<h2 id='test_null_theta_ctree'>Test if a Value Gives a Null Conditional Inference Tree</h2><span id='topic+test_null_theta_ctree'></span>

<h3>Description</h3>

<p>Fits a conditional inference tree with minimal test statistic <code>theta</code>
and tests if the tree has more than one terminal node.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_null_theta_ctree(theta, z, data, Trt, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_null_theta_ctree_+3A_theta">theta</code></td>
<td>
<p>a positive double</p>
</td></tr>
<tr><td><code id="test_null_theta_ctree_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="test_null_theta_ctree_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="test_null_theta_ctree_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="test_null_theta_ctree_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a boolean. <code>True</code> if <code>theta</code> is large enough to give a null
conditional inference tree. <code>False</code> otherwise.
</p>

<hr>
<h2 id='tune_theta'>Estimate the penalty parameter for Step 2 of Virtual Twins</h2><span id='topic+tune_theta'></span>

<h3>Description</h3>

<p>Permutes data under the null hypothesis of a constant treatment effect and
calculates the MNPP on each permuted data set. The <code>1 - alpha</code> quantile
of the distribution is taken.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tune_theta(
  data,
  Trt,
  Y,
  zbar,
  step1,
  step2,
  threshold,
  alpha0,
  p_reps,
  parallel,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tune_theta_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_zbar">zbar</code></td>
<td>
<p>the estimated marginal treatment effect</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_step1">step1</code></td>
<td>
<p>character strings specifying the Step 1 model. Supports
either &quot;<code>lasso</code>&quot;, &quot;<code>mars</code>&quot;, &quot;<code>randomforest</code>&quot;, or
&quot;<code>superlearner</code>&quot;.</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_step2">step2</code></td>
<td>
<p>a character string specifying the Step 2 model. Supports
&quot;<code>lasso</code>&quot;, &quot;<code>rtree</code>&quot;,  &quot;<code>classtree</code>&quot;, or &quot;<code>ctree</code>&quot;.</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_threshold">threshold</code></td>
<td>
<p>for &quot;<code>step2 = 'classtree'</code>&quot; only. The value against
which to test if the estimated individual treatment effect from Step 1 is
higher (TRUE) or lower (FALSE).</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_alpha0">alpha0</code></td>
<td>
<p>the nominal Type I error rate.</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_p_reps">p_reps</code></td>
<td>
<p>the number of permutations to run.</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_parallel">parallel</code></td>
<td>
<p>Should the loop over replications be parallelized? If
<code>FALSE</code>, then no, if <code>TRUE</code>, then yes.
Note that running in parallel requires a <em>parallel backend</em> that must be
registered before performing the computation.
See the <code><a href="foreach.html#topic+foreach">foreach</a></code> documentation for more details.</p>
</td></tr>
<tr><td><code id="tune_theta_+3A_...">...</code></td>
<td>
<p>additional arguments to the Step 1 model call.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the estimated penalty parameter
</p>

<hr>
<h2 id='tunevt'>Fit a tuned Virtual Twins model</h2><span id='topic+tunevt'></span>

<h3>Description</h3>

<p><code>tunevt</code> fits a Virtual Twins model to estimate factors and subgroups
associated with differential treatment effects while controlling the Type I
error rate of falsely detecting at least one heterogeneous effect when the
treatment effect is uniform across the study population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tunevt(
  data,
  Y = "Y",
  Trt = "Trt",
  step1 = "randomforest",
  step2 = "rtree",
  alpha0,
  p_reps,
  threshold = NA,
  keepz = FALSE,
  parallel = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tunevt_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="tunevt_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="tunevt_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="tunevt_+3A_step1">step1</code></td>
<td>
<p>character strings specifying the Step 1 model. Supports
either &quot;<code>lasso</code>&quot;, &quot;<code>mars</code>&quot;, &quot;<code>randomforest</code>&quot;, or
&quot;<code>superlearner</code>&quot;.</p>
</td></tr>
<tr><td><code id="tunevt_+3A_step2">step2</code></td>
<td>
<p>a character string specifying the Step 2 model. Supports
&quot;<code>lasso</code>&quot;, &quot;<code>rtree</code>&quot;,  &quot;<code>classtree</code>&quot;, or &quot;<code>ctree</code>&quot;.</p>
</td></tr>
<tr><td><code id="tunevt_+3A_alpha0">alpha0</code></td>
<td>
<p>the nominal Type I error rate.</p>
</td></tr>
<tr><td><code id="tunevt_+3A_p_reps">p_reps</code></td>
<td>
<p>the number of permutations to run.</p>
</td></tr>
<tr><td><code id="tunevt_+3A_threshold">threshold</code></td>
<td>
<p>for &quot;<code>step2 = 'classtree'</code>&quot; only. The value against
which to test if the estimated individual treatment effect from Step 1 is
higher (TRUE) or lower (FALSE).</p>
</td></tr>
<tr><td><code id="tunevt_+3A_keepz">keepz</code></td>
<td>
<p>logical. Should the estimated CATE from Step 1 be returned?</p>
</td></tr>
<tr><td><code id="tunevt_+3A_parallel">parallel</code></td>
<td>
<p>Should the loop over replications be parallelized? If
<code>FALSE</code>, then no, if <code>TRUE</code>, then yes.
Note that running in parallel requires a <em>parallel backend</em> that must be
registered before performing the computation.
See the <code><a href="foreach.html#topic+foreach">foreach</a></code> documentation for more details.</p>
</td></tr>
<tr><td><code id="tunevt_+3A_...">...</code></td>
<td>
<p>additional arguments to the Step 1 model call.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Virtual Twins is a two-step approach to detecting differential treatment
effects. Subjects' conditional average treatment effects (CATEs) are first
estimated in Step 1 using a flexible model. Then, a simple and interpretable
model is fit in Step 2 to model either (1) the expected value of these
estimated CATEs if <code>step2</code> is equal to &quot;<code>lasso</code>&quot;, &quot;<code>rtree</code>&quot;,
or &quot;<code>ctree</code>&quot; or (2) the probability that the CATE is greater than a
specified <code>threshold</code> if <code>step2</code> is equal to &quot;<code>classtree</code>&quot;.
</p>
<p>The Step 2 model is dependent on some tuning parameter. This parameter is
selected to control the Type I error rate by permuting the data under the
null hypothesis of a constant treatment effect and identifying the minimal
null penalty parameter (MNPP), which is the smallest penalty parameter that
yields a Step 2 model with no covariate effects. The <code>1-alpha0</code> quantile
of the distribution of is then used to fit the Step 2 model on the original
data.
</p>


<h3>Value</h3>

<p>An object of class <code>"tunevt"</code>.
</p>
<p>An object of class <code>"tunevt"</code> is a list containing at least the
following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>vtmod</code></td>
<td>
<p>the model estimated by the given <code>step2</code> procedure fit
with the permuted tuning parameter for the estimated CATEs from the
<code>step1</code> model. See <code><a href="#topic+vt2_lasso">vt2_lasso</a></code>,
<code><a href="#topic+vt2_rtree">vt2_rtree</a></code>, or <code><a href="#topic+vt2_ctree">vt2_ctree</a></code> for specifics.</p>
</td></tr>
<tr><td><code>mnpp</code></td>
<td>
<p>the MNPP for the estimated CATEs from Step 1.</p>
</td></tr>
<tr><td><code>theta_null</code></td>
<td>
<p>a vector of the MNPPs from each permutation under
the null hypothesis.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>the probability of observing a MNPP as or more extreme
as the observed MNPP under the null hypothesis of no effect
heterogeneity.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>if <code>keepz = TRUE</code>, the estimated CATEs from the
<code>step1</code> model.</p>
</td></tr>
</table>


<h3>References</h3>


<p>Foster JC, Taylor JM, Ruberg SJ (2011).
&ldquo;Subgroup identification from randomized clinical trial data.&rdquo;
<em>Statistics in Medicine</em>, <b>30</b>(24), 2867&ndash;2880.
ISSN 02776715, <a href="https://doi.org/10.1002/sim.4322">doi:10.1002/sim.4322</a>.
</p>
<p>Wolf JM, Koopmeiners JS, Vock DM (2022).
&ldquo;A permutation procedure to detect heterogeneous treatment effects in randomized clinical trials while controlling the type I error rate.&rdquo;
<em>Clinical Trials</em>, <b>19</b>(5), 512-521.
ISSN 1740-7745, <a href="https://doi.org/10.1177/17407745221095855">doi:10.1177/17407745221095855</a>, Publisher: SAGE Publications.
</p>
<p>Deng C, Wolf JM, Vock DM, Carroll DM, Hatsukami DK, Leng N, Koopmeiners JS (2023).
&ldquo;Practical guidance on modeling choices for the virtual twins method.&rdquo;
<em>Journal of Biopharmaceutical Statistics</em>.
<a href="https://doi.org/10.1080/10543406.2023.2170404">doi:10.1080/10543406.2023.2170404</a>.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>data(tehtuner_example)
# Low p_reps for example use only
tunevt(
  tehtuner_example, step1 = "lasso", step2 = "rtree",
  alpha0 = 0.2, p_reps = 5
)

</code></pre>

<hr>
<h2 id='validate_alpha0'>Check if alpha0 is a valid input to tunevt</h2><span id='topic+validate_alpha0'></span>

<h3>Description</h3>

<p>Check if alpha0 is a valid input to tunevt
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_alpha0(data, alpha0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_alpha0_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="validate_alpha0_+3A_alpha0">alpha0</code></td>
<td>
<p>the nominal Type I error rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if <code>alpha0</code> is a valid input. Errors otherwise.
</p>

<hr>
<h2 id='validate_p_reps'>Check if p_reps is a valid input to tunevt</h2><span id='topic+validate_p_reps'></span>

<h3>Description</h3>

<p>Check if p_reps is a valid input to tunevt
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_p_reps(data, p_reps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_p_reps_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="validate_p_reps_+3A_p_reps">p_reps</code></td>
<td>
<p>the number of permutations to run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if <code>p_reps</code> is a valid input. Errors otherwise.
</p>

<hr>
<h2 id='validate_Trt'>Check if Trt is a valid input to tunevt</h2><span id='topic+validate_Trt'></span>

<h3>Description</h3>

<p>Check if Trt is a valid input to tunevt
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_Trt(data, Trt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_Trt_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="validate_Trt_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if <code>Trt</code> is a valid input. Errors otherwise.
</p>

<hr>
<h2 id='validate_Y'>Check if Y is a valid input to tunevt</h2><span id='topic+validate_Y'></span>

<h3>Description</h3>

<p>Check if Y is a valid input to tunevt
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_Y(data, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_Y_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="validate_Y_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if <code>Y</code> is a valid input. Errors otherwise.
</p>

<hr>
<h2 id='vt1_lasso'>Estimate the CATE Using the Lasso for Step 1 of Virtual Twins</h2><span id='topic+vt1_lasso'></span>

<h3>Description</h3>

<p>Estimate the CATE Using the Lasso for Step 1 of Virtual Twins
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt1_lasso(data, Trt, Y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt1_lasso_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="vt1_lasso_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="vt1_lasso_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="vt1_lasso_+3A_...">...</code></td>
<td>
<p>additional arguments to <code>cv.glmnet</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated CATEs for each subject in <code>data</code>.
</p>


<h3>See Also</h3>

<p>Other VT Step 1 functions: 
<code><a href="#topic+vt1_mars">vt1_mars</a>()</code>,
<code><a href="#topic+vt1_rf">vt1_rf</a>()</code>,
<code><a href="#topic+vt1_super">vt1_super</a>()</code>
</p>

<hr>
<h2 id='vt1_mars'>Estimate the CATE Using MARS for Step 1 of Virtual Twins</h2><span id='topic+vt1_mars'></span>

<h3>Description</h3>

<p>Estimate the CATE Using MARS for Step 1 of Virtual Twins
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt1_mars(data, Trt, Y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt1_mars_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="vt1_mars_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="vt1_mars_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="vt1_mars_+3A_...">...</code></td>
<td>
<p>additional arguments to <code>earth</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated CATEs for each subject in <code>data</code>.
</p>


<h3>See Also</h3>

<p>Other VT Step 1 functions: 
<code><a href="#topic+vt1_lasso">vt1_lasso</a>()</code>,
<code><a href="#topic+vt1_rf">vt1_rf</a>()</code>,
<code><a href="#topic+vt1_super">vt1_super</a>()</code>
</p>

<hr>
<h2 id='vt1_rf'>Estimate the CATE Using a Random Forest for Step 1 of Virtual Twins</h2><span id='topic+vt1_rf'></span>

<h3>Description</h3>

<p>Estimate the CATE Using a Random Forest for Step 1 of Virtual Twins
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt1_rf(data, Trt, Y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt1_rf_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="vt1_rf_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="vt1_rf_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="vt1_rf_+3A_...">...</code></td>
<td>
<p>additional arguments to <code>rfsrc</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated CATEs for each subject in <code>data</code>.
</p>


<h3>See Also</h3>

<p>Other VT Step 1 functions: 
<code><a href="#topic+vt1_lasso">vt1_lasso</a>()</code>,
<code><a href="#topic+vt1_mars">vt1_mars</a>()</code>,
<code><a href="#topic+vt1_super">vt1_super</a>()</code>
</p>

<hr>
<h2 id='vt1_super'>Estimate the CATE Using Super Learner for Step 1 of Virtual Twins</h2><span id='topic+vt1_super'></span>

<h3>Description</h3>

<p>Estimate the CATE Using Super Learner for Step 1 of Virtual Twins
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt1_super(data, Trt, Y, SL.library, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt1_super_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="vt1_super_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="vt1_super_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="vt1_super_+3A_sl.library">SL.library</code></td>
<td>
<p>Either a character vector of prediction algorithms or a
list containing character vector. See <code>SuperLearner</code> for more details.</p>
</td></tr>
<tr><td><code id="vt1_super_+3A_...">...</code></td>
<td>
<p>additional arguments to <code>SuperLearner</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated CATEs for each subject in <code>data</code>.
</p>


<h3>See Also</h3>

<p>Other VT Step 1 functions: 
<code><a href="#topic+vt1_lasso">vt1_lasso</a>()</code>,
<code><a href="#topic+vt1_mars">vt1_mars</a>()</code>,
<code><a href="#topic+vt1_rf">vt1_rf</a>()</code>
</p>

<hr>
<h2 id='vt2_classtree'>Estimate the CATE using a classification tree for Step 2</h2><span id='topic+vt2_classtree'></span>

<h3>Description</h3>

<p>Estimate the CATE using a classification tree for Step 2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt2_classtree(z, data, Trt, Y, theta, threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt2_classtree_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="vt2_classtree_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="vt2_classtree_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="vt2_classtree_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="vt2_classtree_+3A_theta">theta</code></td>
<td>
<p>tree complexity parameter (<code>cp</code>)</p>
</td></tr>
<tr><td><code id="vt2_classtree_+3A_threshold">threshold</code></td>
<td>
<p>for &quot;<code>step2 = 'classtree'</code>&quot; only. The value against
which to test if the estimated individual treatment effect from Step 1 is
higher (TRUE) or lower (FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>rpart</code>. See
<code><a href="rpart.html#topic+rpart.object">rpart.object</a></code>.
</p>


<h3>See Also</h3>

<p>Other VT Step 2 functions: 
<code><a href="#topic+vt2_ctree">vt2_ctree</a>()</code>,
<code><a href="#topic+vt2_lasso">vt2_lasso</a>()</code>,
<code><a href="#topic+vt2_rtree">vt2_rtree</a>()</code>
</p>

<hr>
<h2 id='vt2_ctree'>Estimate the CATE using a conditional inference tree for Step 2</h2><span id='topic+vt2_ctree'></span>

<h3>Description</h3>

<p>Estimate the CATE using a conditional inference tree for Step 2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt2_ctree(z, data, Trt, Y, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt2_ctree_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="vt2_ctree_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="vt2_ctree_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="vt2_ctree_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="vt2_ctree_+3A_theta">theta</code></td>
<td>
<p>the value of the test statistic that must be exceeded in order
to implement a split (<code>mincriterion</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>BinaryTree-class</code>. See
<code><a href="party.html#topic+BinaryTree-class">BinaryTree-class</a></code>.
</p>


<h3>See Also</h3>

<p>Other VT Step 2 functions: 
<code><a href="#topic+vt2_classtree">vt2_classtree</a>()</code>,
<code><a href="#topic+vt2_lasso">vt2_lasso</a>()</code>,
<code><a href="#topic+vt2_rtree">vt2_rtree</a>()</code>
</p>

<hr>
<h2 id='vt2_lasso'>Estimate the CATE using the Lasso for Step 2</h2><span id='topic+vt2_lasso'></span>

<h3>Description</h3>

<p>Estimate the CATE using the Lasso for Step 2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt2_lasso(z, data, Trt, Y, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt2_lasso_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="vt2_lasso_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="vt2_lasso_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="vt2_lasso_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="vt2_lasso_+3A_theta">theta</code></td>
<td>
<p>lasso penalty parameter (<code>lambda</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of length 3 containing the following elements:
</p>
<table>
<tr><td><code>mod</code></td>
<td>
<p>an object of class <code>glmnet</code>. See
<code><a href="glmnet.html#topic+glmnet">glmnet</a></code>.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>coefficients associated with the penalty parameter
<code>theta</code>.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>predicted values associated with the penalty parameter
<code>theta</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other VT Step 2 functions: 
<code><a href="#topic+vt2_classtree">vt2_classtree</a>()</code>,
<code><a href="#topic+vt2_ctree">vt2_ctree</a>()</code>,
<code><a href="#topic+vt2_rtree">vt2_rtree</a>()</code>
</p>

<hr>
<h2 id='vt2_rtree'>Estimate the CATE using a regression tree for Step 2</h2><span id='topic+vt2_rtree'></span>

<h3>Description</h3>

<p>Estimate the CATE using a regression tree for Step 2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt2_rtree(z, data, Trt, Y, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt2_rtree_+3A_z">z</code></td>
<td>
<p>a numeric vector of estimated CATEs from Step 1</p>
</td></tr>
<tr><td><code id="vt2_rtree_+3A_data">data</code></td>
<td>
<p>a data frame containing a response, binary treatment indicators,
and covariates.</p>
</td></tr>
<tr><td><code id="vt2_rtree_+3A_trt">Trt</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the treatment indicators.</p>
</td></tr>
<tr><td><code id="vt2_rtree_+3A_y">Y</code></td>
<td>
<p>a string specifying the name of the column of <code>data</code>
contains the response.</p>
</td></tr>
<tr><td><code id="vt2_rtree_+3A_theta">theta</code></td>
<td>
<p>tree complexity parameter (<code>cp</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>rpart</code>. See
<code><a href="rpart.html#topic+rpart.object">rpart.object</a></code>.
</p>


<h3>See Also</h3>

<p>Other VT Step 2 functions: 
<code><a href="#topic+vt2_classtree">vt2_classtree</a>()</code>,
<code><a href="#topic+vt2_ctree">vt2_ctree</a>()</code>,
<code><a href="#topic+vt2_lasso">vt2_lasso</a>()</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
