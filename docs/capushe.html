<!DOCTYPE html><html><head><title>Help for package capushe</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {capushe}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#capushe-package'>
<p>Capushe</p></a></li>
<li><a href='#BICAICcapushe'>
<p>AICcapushe and BICcapushe</p></a></li>
<li><a href='#capushe'>
<p>CAlibrating Penalities Using Slope HEuristics (CAPUSHE)</p></a></li>
<li><a href='#datacapushe'>
<p>datacapushe</p></a></li>
<li><a href='#DDSE'>
<p>Model selection by Data-Driven Slope Estimation</p></a></li>
<li><a href='#Djump'>
<p>Model selection by dimension jump</p></a></li>
<li><a href='#plot-methods'><p>Plot for capushe</p></a></li>
<li><a href='#validation'>
<p>validation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>CAlibrating Penalities Using Slope HEuristics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2011-07-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Sylvain Arlot, Vincent Brault, Jean-Patrick Baudry, Cathy Maugis and Bertrand Michel</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vincent Brault &lt;vincent.brault@agroparistech.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calibration of penalized criteria for model selection. The calibration methods available are based on the slope heuristics.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, graphics, MASS</td>
</tr>
<tr>
<td>Collate:</td>
<td>prog.R DDSE.R Djump.R capushe.R</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.math.u-psud.fr/~brault/capushe.html">http://www.math.u-psud.fr/~brault/capushe.html</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-27 12:38:21 UTC; hornik</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-27 13:25:41 UTC</td>
</tr>
</table>
<hr>
<h2 id='capushe-package'>
Capushe
</h2><span id='topic+capushe-package'></span><span id='topic+capushepack'></span><span id='topic+capushe.package'></span><span id='topic+slope'></span><span id='topic+heuristic'></span>

<h3>Description</h3>

<p>This package includes functions for model selection via penalization. The model 
selection criterion has the following form: <code class="reqn">\gamma_n (\hat{s}_m)+scoef\times\kappa\times pen_{shape}(m)</code>.
Two algorithms based on the slope heuristics are proposed to calibrate the
parameter <code class="reqn">\kappa</code> in the penalty: the <a href="#topic+DDSE">data-driven slope estimation algorithm (DDSE)</a>
and the <a href="#topic+Djump">dimension jump algorithm (Djump)</a>.
</p>


<h3>Details</h3>

<p>The data-driven slope estimation algorithm and the dimension jump algorithm are 
respectively implemented into the <code><a href="#topic+DDSE">DDSE</a></code> function and the <code><a href="#topic+Djump">Djump</a></code> function. Somes
classes are defined for the outputs of <code><a href="#topic+DDSE">DDSE</a></code> and <code><a href="#topic+Djump">Djump</a></code> and a <a href="#topic+plot.capushe">graphical</a> display is
available for each one of these two classes. <code><a href="#topic+DDSE">DDSE</a></code> and <code><a href="#topic+Djump">Djump</a></code> are both included in
the <code><a href="#topic+capushe">capushe</a></code> function which is the main function of the package.
</p>


<h3>Author(s)</h3>

<p>Sylvain Arlot, Vincent Brault, Jean-Patrick Baudry, Cathy Maugis and Bertrand Michel.
</p>
<p>Maintainer: Vincent Brault &lt;vincent.brault@math.u-psud.fr&gt;
</p>


<h3>References</h3>

<p><a href="http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html">http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html</a>
</p>
<p><a href="http://www.math.u-psud.fr/~brault/capushe.html">http://www.math.u-psud.fr/~brault/capushe.html</a>
</p>
<p>Article: Baudry, J.-P., Maugis, C. and Michel, B. (2011) Slope heuristics:
overview and implementation. <var>Statistics and Computing</var>, to appear. doi: 10.1007/
s11222-011-9236-1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Djump">Djump</a></code> and <code><a href="#topic+DDSE">DDSE</a></code> for model selection
algorithms based on the slope heuristics. <code><a href="#topic+plot.capushe">plot</a></code> for a 
graphical display of the two algorithms. <code><a href="#topic+validation">validation</a></code> 
to check that the slope heuristics can be applied confidently.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datacapushe)
## capushe returns the same model with DDSE and Djump:
capushe(datacapushe)
## capushe also returns the model selected by AIC and BIC
capushe(datacapushe,n=1000)
## Djump only
Djump(datacapushe)
## DDSE only
DDSE(datacapushe)
## Graphical representations
plot(Djump(datacapushe))
plot(DDSE(datacapushe))
plot(capushe(datacapushe))
## Validation procedure
data(datapartialcapushe)
capushepartial=capushe(datapartialcapushe)
plot(capushepartial)
## Additional data
data(datavalidcapushe)
validation(capushepartial,datavalidcapushe) ## The slope heuristics should not 
## be applied for datapartialcapushe.

</code></pre>

<hr>
<h2 id='BICAICcapushe'>
AICcapushe and BICcapushe
</h2><span id='topic+AICcapushe'></span><span id='topic+BICcapushe'></span><span id='topic+AICapushe'></span><span id='topic+BICapushe'></span><span id='topic+Aiccapushe'></span><span id='topic+Biccapushe'></span><span id='topic+Aicapushe'></span><span id='topic+Bicapushe'></span><span id='topic+aiccapushe'></span><span id='topic+biccapushe'></span><span id='topic+aicapushe'></span><span id='topic+bicapushe'></span>

<h3>Description</h3>

<p>These functions return the model selected by the Akaike Information Criterion (AIC)
and the Bayesian Information Criterion (BIC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AICcapushe(data, n)
BICcapushe(data, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BICAICcapushe_+3A_data">data</code></td>
<td>

<p><code>data</code> is a matrix or a data.frame with four columns of the same length
and each line corresponds to a model:
</p>

<ol>
<li><p> The first column contains the model names. 
</p>
</li>
<li><p> The second column contains the penalty shape values.   
</p>
</li>
<li><p> The third column contains the model complexity values. 
</p>
</li>
<li><p> The fourth column contains the minimum contrast value for each model. 
</p>
</li></ol>

</td></tr>
<tr><td><code id="BICAICcapushe_+3A_n">n</code></td>
<td>

<p><code>n</code> is the sample size.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The penalty shape value should be increasing with respect to the complexity value (column 3).
The complexity values have to be positive.
<code>n</code> is necessary to compute AIC and BIC criteria. <code>n</code> is the size of 
sample used to compute the contrast values given in the <code>data</code> matrix.
Do not confuse <code>n</code> with the size of the model collection which is the number
of rows of the <code>data</code> matrix. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>model</code></td>
<td>
<p>The model selected by AIC or BIC.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>The corresponding value of AIC (for AICcapushe only).</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>The corresponding value of BIC (for BICcapushe only).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vincent Brault
</p>


<h3>References</h3>

<p><a href="http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html">http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html</a>
</p>
<p><a href="http://www.math.u-psud.fr/~brault/capushe.html">http://www.math.u-psud.fr/~brault/capushe.html</a>
</p>
<p>Article: Baudry, J.-P., Maugis, C. and Michel, B. (2011) Slope heuristics:
overview and implementation. <var>Statistics and Computing</var>, to appear. doi: 10.1007/
s11222-011-9236-1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+capushe">capushe</a></code> for a model selection function including AIC, BIC,
the <code><a href="#topic+DDSE">DDSE</a></code> algorithm and the <code><a href="#topic+Djump">Djump</a></code> algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datacapushe)
AICcapushe(datacapushe,n=1000)
BICcapushe(datacapushe,n=1000)


</code></pre>

<hr>
<h2 id='capushe'>
CAlibrating Penalities Using Slope HEuristics (CAPUSHE)
</h2><span id='topic+capushe'></span><span id='topic+Capushe-class'></span><span id='topic+plot+2CCapushe-method'></span><span id='topic+print+2CCapushe-method'></span><span id='topic+show+2CCapushe-method'></span><span id='topic+summary+2CCapushe-method'></span><span id='topic+validation+2CCapushe-method'></span><span id='topic+print.capushe'></span><span id='topic+show.capushe'></span><span id='topic+summary.capushe'></span><span id='topic+Capushe'></span><span id='topic+CAPUSHE'></span><span id='topic+Calibrating'></span><span id='topic+CAlibrating'></span>

<h3>Description</h3>

<p>The <code>capushe</code> function proposes two algorithms based on the slope heuristics
to calibrate penalties in the context of model selection via penalization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capushe(data,n=0,pct=0.15,point=0,psi.rlm=psi.bisquare,scoef=2,
			Careajump=0,Ctresh=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="capushe_+3A_data">data</code></td>
<td>

<p><code>data</code> is a matrix or a data.frame with four columns of the same length
and each line corresponds to a model:
</p>

<ol>
<li><p> The first column contains the model names. 
</p>
</li>
<li><p> The second column contains the penalty shape values.   
</p>
</li>
<li><p> The third column contains the model complexity values. 
</p>
</li>
<li><p> The fourth column contains the minimum contrast value for each model. 
</p>
</li></ol>

</td></tr>
<tr><td><code id="capushe_+3A_n">n</code></td>
<td>

<p><code>n</code> is the sample size.  
</p>
</td></tr>
<tr><td><code id="capushe_+3A_pct">pct</code></td>
<td>

<p>Minimum percentage of points for the plateau selection. 
See <code><a href="#topic+DDSE">DDSE</a></code> for more details.
</p>
</td></tr>
<tr><td><code id="capushe_+3A_point">point</code></td>
<td>

<p>Minimum number of point for the plateau selection (See <code><a href="#topic+DDSE">DDSE</a></code> for more details).
If <code>point</code> is different from 0, <code>pct</code> is obsolete.
</p>
</td></tr>
<tr><td><code id="capushe_+3A_psi.rlm">psi.rlm</code></td>
<td>

<p>Weight function used by <code><a href="MASS.html#topic+rlm">rlm</a></code>.
See <code><a href="#topic+DDSE">DDSE</a></code> for more details. <code>psi.rlm</code>=&quot;lm&quot; for non robust
linear regression.
</p>
</td></tr>
<tr><td><code id="capushe_+3A_scoef">scoef</code></td>
<td>

<p>Ratio parameter. Default value is 2.   
</p>
</td></tr>
<tr><td><code id="capushe_+3A_careajump">Careajump</code></td>
<td>

<p>Constant of jump area (See <code><a href="#topic+Djump">Djump</a></code> for more details). Default value is 0 (no area).
</p>
</td></tr>
<tr><td><code id="capushe_+3A_ctresh">Ctresh</code></td>
<td>

<p>Maximal treshold for the complexity associated to the penalty coefficient (See <code><a href="#topic+Djump">Djump</a></code> for more details).
Default value is 0 (Maximal jump selected as the greater jump).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model <code class="reqn">\hat{m}</code> selected by the procedure fulfills
</p>
<p><code class="reqn">\hat{m}=</code> argmin <code class="reqn">\gamma_n (\hat{s}_m)+scoef\times \kappa\times pen_{shape}(m)</code>
</p>
<p>where </p>

<ul>
<li><p><code class="reqn">\kappa</code> is the penalty coefficient.
</p>
</li>
<li><p><code class="reqn">\gamma_n</code> is the empirical contrast.
</p>
</li>
<li><p><code class="reqn">\hat{s}_m</code> is the estimator for the model <code class="reqn">m</code>.
</p>
</li>
<li><p><code class="reqn">scoef</code> is the ratio parameter.
</p>
</li>
<li><p><code class="reqn">pen_{shape}</code> is the penalty shape.
</p>
</li></ul>

<p>The capushe function calls the functions <code><a href="#topic+DDSE">DDSE</a></code> and 
<code><a href="#topic+Djump">Djump</a></code> to calibrate <code class="reqn">\kappa</code>, see the description of these functions
for more details. 
In the case of equality between two penalty shape values, only the model with the 
smallest contrast is considered.
</p>


<h3>Value</h3>

<table>
<tr><td><code>@DDSE</code></td>
<td>
<p>A list returned by the <code><a href="#topic+DDSE">DDSE</a></code> function.</p>
</td></tr>
<tr><td><code>@DDSE@model</code></td>
<td>
<p>The <code>model</code> selected by the <code><a href="#topic+DDSE">DDSE</a></code> function.</p>
</td></tr>
<tr><td><code>@DDSE@kappa</code></td>
<td>
<p>The vector of the successive slope values.</p>
</td></tr>
<tr><td><code>@DDSE@ModelHat</code></td>
<td>
<p>A list providing details about the model selected by the <code><a href="#topic+DDSE">DDSE</a></code> function.</p>
</td></tr>
<tr><td><code>@DDSE@interval</code></td>
<td>
<p>A list about the &quot;slope interval&quot; corresponding to the
plateau selected in <code>DDSE</code>. See <code><a href="#topic+DDSE">DDSE</a></code> for more details.</p>
</td></tr>
<tr><td><code>@DDSE@graph</code></td>
<td>
<p>A list computed for the <code><a href="#topic+plot.capushe">plot</a></code> function.</p>
</td></tr>
<tr><td><code>@Djump</code></td>
<td>
<p>A list returned by the <code><a href="#topic+Djump">Djump</a></code> function.</p>
</td></tr>
<tr><td><code>@Djump@model</code></td>
<td>
<p>The <code>model</code> selected by the <code><a href="#topic+Djump">Djump</a></code> function.</p>
</td></tr> 
<tr><td><code>@Djump@ModelHat</code></td>
<td>
<p>A list providing details about the model selected by the <code><a href="#topic+Djump">Djump</a></code> function.</p>
</td></tr>
<tr><td><code>@Djump@graph</code></td>
<td>
<p>A list computed for the <code><a href="#topic+plot.capushe">plot</a></code> function.</p>
</td></tr>
<tr><td><code>@AIC_capushe</code></td>
<td>
<p>A list returned by the <code><a href="#topic+AICcapushe">AICcapushe</a></code> function.</p>
</td></tr> 
<tr><td><code>@BIC_capushe</code></td>
<td>
<p>A list returned by the <code><a href="#topic+BICcapushe">BICcapushe</a></code> function.</p>
</td></tr>
<tr><td><code>@n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vincent Brault
</p>


<h3>References</h3>

<p><a href="http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html">http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html</a>
</p>
<p><a href="http://www.math.u-psud.fr/~brault/capushe.html">http://www.math.u-psud.fr/~brault/capushe.html</a>
</p>
<p>Article: Baudry, J.-P., Maugis, C. and Michel, B. (2011) Slope heuristics:
overview and implementation. <var>Statistics and Computing</var>, to appear. doi: 10.1007/
s11222-011-9236-1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Djump">Djump</a></code>, <code><a href="#topic+DDSE">DDSE</a></code>, <code><a href="#topic+AICcapushe">AIC</a></code> 
or <code><a href="#topic+BICcapushe">BIC</a></code> to use only one of these model selection functions. 
<code><a href="#topic+plot.capushe">plot</a></code> for graphical displays of DDSE
and Djump.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datacapushe)
capushe(datacapushe) 
capushe(datacapushe,1000)
</code></pre>

<hr>
<h2 id='datacapushe'>
datacapushe
</h2><span id='topic+datacapushe'></span><span id='topic+datapartialcapushe'></span><span id='topic+datavalidcapushe'></span><span id='topic+bubbles'></span><span id='topic+bubble'></span>

<h3>Description</h3>

<p>A dataframe example for the <code><a href="#topic+capushe-package">capushe package</a></code> based on a simulated Gaussian
mixture dataset in <code class="reqn">\R^3</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datacapushe)</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows (models) and the following 4 variables:
</p>

<dl>
<dt><code>model</code></dt><dd><p>a character vector</p>
</dd></dl>
<p>: model names.
</p>
<dl>
<dt><code>pen</code></dt><dd><p>a numeric vector</p>
</dd></dl>
<p>: model penalty shape values.
</p>
<dl>
<dt><code>complexity</code></dt><dd><p>a numeric vector</p>
</dd></dl>
<p>: model complexity values.
</p>
<dl>
<dt><code>contrast</code></dt><dd><p>a numeric vector</p>
</dd></dl>
<p>: model contrast values.

</p>


<h3>Details</h3>

<p>The simulated dataset is composed of <code class="reqn">n=1000</code> observations in <code class="reqn">\R^3</code>. It 
consists of an equiprobable mixture of three large &quot;bubble&quot; groups centered at 
<code class="reqn">\nu_1=(0,0,0)</code>, <code class="reqn">\nu_2=(6,0,0)</code> and <code class="reqn">\nu_3=(0,6,0)</code> respectively. Each
bubble group <code class="reqn">j</code> is simulated from a mixture of seven components according 
to the following density distribution:
</p>
<p><code class="reqn">x\in\R^3\rightarrow 0.4\Phi(x|\mu_1+\nu_j,I_3)+\sum_{k=2}^70.1\Phi(x|\mu_k+\nu_j,0.1I_3)</code>
</p>
<p>with <code class="reqn">\mu_1=(0,0,0)</code>, <code class="reqn">\mu_2=(0,0,1.5)</code>, <code class="reqn">\mu_3=(0,1.5,0)</code>, <code class="reqn">\mu_4=(1.5,0,0,)</code>,
<code class="reqn">\mu_5=(0,0,-1.5)</code>, <code class="reqn">\mu_6=(0,-1.5,0)</code> and <code class="reqn">\mu_7=(-1.5,0,0,)</code>. Thus the
distribution of the dataset is actually a <code class="reqn">21</code>-component Gaussian mixture.
</p>
<p>A model collection of spherical Gaussian mixtures is considered and the dataframe
<code>datacapushe</code> contains the maximum likelihood estimations for each of these models.
The number of free parameters of each model is used for the complexity values and <code class="reqn">pen_{shape}</code>
is defined by this complexity divided by <code class="reqn">n</code>.
</p>
<p><code>datapartialcapushe</code> and <code>datavalidcapushe</code> can be used to run the
<code><a href="#topic+validation">validation</a></code> function. <code>datapartialcapushe</code> only 
contains the models with less than <code class="reqn">21</code> components. <code>datavalidcapushe</code>
contains three models with <code class="reqn">30</code>, <code class="reqn">40</code> and <code class="reqn">50</code> components respectively.
</p>


<h3>Source</h3>

<p><a href="http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html">http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html</a>
</p>


<h3>References</h3>

<p>Article: Baudry, J.-P., Maugis, C. and Michel, B. (2011) Slope heuristics:
overview and implementation. <var>Statistics and Computing</var>, to appear. doi: 10.1007/
s11222-011-9236-1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datacapushe)
capushe(datacapushe,n=1000)
## BIC, DDSE and Djump all three select the true model
plot(capushe(datacapushe))
## Validation:
data(datapartialcapushe)
capushepartial=capushe(datapartialcapushe)
data(datavalidcapushe)
validation(capushepartial,datavalidcapushe) ## The slope heuristics should not 
## be applied for datapartialcapushe.
</code></pre>

<hr>
<h2 id='DDSE'>
Model selection by Data-Driven Slope Estimation
</h2><span id='topic+DDSE'></span><span id='topic+DDSE-class'></span><span id='topic+plot+2CDDSE-method'></span><span id='topic+print+2CDDSE-method'></span><span id='topic+show+2CDDSE-method'></span><span id='topic+summary+2CDDSE-method'></span><span id='topic+validation+2CDDSE-method'></span><span id='topic+print.DDSE'></span><span id='topic+show.DDSE'></span><span id='topic+summary.DDSE'></span><span id='topic+ddse'></span><span id='topic+Ddse'></span><span id='topic+Data-Driven'></span><span id='topic+data-driven'></span><span id='topic+Data-driven'></span>

<h3>Description</h3>

<p><code>DDSE</code> is a model selection function based on the slope heuristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DDSE(data, pct = 0.15, point = 0, psi.rlm = psi.bisquare, scoef = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DDSE_+3A_data">data</code></td>
<td>

<p><code>data</code> is a matrix or a data.frame with four columns of the same length
and each line corresponds to a model:
</p>

<ol>
<li><p> The first column contains the model names. 
</p>
</li>
<li><p> The second column contains the penalty shape values.   
</p>
</li>
<li><p> The third column contains the model complexity values. 
</p>
</li>
<li><p> The fourth column contains the minimum contrast value for each model. 
</p>
</li></ol>

</td></tr>
<tr><td><code id="DDSE_+3A_pct">pct</code></td>
<td>

<p>Minimum percentage of points for the plateau selection.
It must be between 0 and 1. Default value is 0.15.
</p>
</td></tr>
<tr><td><code id="DDSE_+3A_point">point</code></td>
<td>

<p>Minimum number of point for the plateau selection. 
If <code>point</code> is different from 0, <code>pct</code> is obsolete.
</p>
</td></tr>
<tr><td><code id="DDSE_+3A_psi.rlm">psi.rlm</code></td>
<td>

<p>Weight function used by <code><a href="MASS.html#topic+rlm">rlm</a></code>. <code>psi.rlm</code>=&quot;lm&quot; for non robust
linear regression. 
</p>
</td></tr>
<tr><td><code id="DDSE_+3A_scoef">scoef</code></td>
<td>

<p>Ratio parameter. Default value is 2.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">M</code> be the model collection and <code class="reqn">P=\{pen_{shape}(m),m\in M\}</code>.
The DDSE algorithm proceeds in four steps:
</p>

<ol>
<li><p>If several models in the collection have the same penalty shape value (column 2),
only the model having the smallest contrast value <code class="reqn">\gamma_n(\hat{s}_m)</code> (column 4)
is considered.
</p>
</li>
<li><p>For any <code class="reqn">p\in P</code>, the slope <code class="reqn">\hat{\kappa}(p)</code> (argument <code>@kappa</code>) of the linear regression
(argument <code>psi.rlm</code>) on the couples of points <code class="reqn">\{(pen_{shape}(m),-\gamma_n (\hat{s}_m)); pen_{shape}(m)\geq p\}</code>
is computed.
</p>
</li>
<li><p>For any <code class="reqn">p\in P</code>, the model fulfilling the following condition is selected:
</p>
<p><code class="reqn">\hat{m}(p)=</code> argmin <code class="reqn">\gamma_n (\hat{s}_m)+scoef\times \hat{\kappa}(p)\times pen_{shape}(m)</code>.
</p>
<p>This gives an increasing sequence of change-points <code class="reqn">(p_i)_{1\leq i\leq I+1}</code> (output 
<code>@ModelHat$point_breaking</code>). Let <code class="reqn">(N_i)_{1\leq i\leq I}</code> (output <code>@ModelHat$number_plateau</code>)
be the lengths of each &quot;plateau&quot;.
</p>
</li>
<li><p>If <code>point</code> is different from 0, let <code class="reqn">\hat{i}=</code> max 
<code class="reqn">\{1\leq i\leq I; N_i\geq point\}</code> else let <code class="reqn">\hat{i}=</code> max 
<code class="reqn">\{1\leq i\leq I; N_i\geq pct\sum_{l=1}^IN_l\}</code> (output <code>@ModelHat$imax</code>).
The model <code class="reqn">\hat{m}(p_{\hat{i}})</code> (output <code>@model</code>) is finally returned.
</p>
</li></ol>

<p>The &quot;slope interval&quot; is the interval <code class="reqn">[a,b]</code> where <code class="reqn">a=inf\{\hat{\kappa}(p),p\in[p_{\hat{i}},p_{\hat{i}+1}[\cap P\}</code>
and <code class="reqn">b=sup\{\hat{\kappa}(p),p\in[p_{\hat{i}},p_{\hat{i}+1}[\cap P\}</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>@model</code></td>
<td>
<p>The <code>model</code> selected by the DDSE algorithm.</p>
</td></tr>
<tr><td><code>@kappa</code></td>
<td>
<p>The vector of the successive slope values.</p>
</td></tr>
<tr><td><code>@ModelHat</code></td>
<td>
<p>A list describing the algorithm.</p>
</td></tr>
<tr><td><code>@ModelHat$model_hat</code></td>
<td>
<p>The vector of preselected models <code class="reqn">\hat{m}(p)</code>.</p>
</td></tr>
<tr><td><code>@ModelHat$point_breaking</code></td>
<td>
<p>The vector of the breaking points <code class="reqn">(p_i)_{1\leq i\leq I+1}</code>.</p>
</td></tr>
<tr><td><code>@ModelHat$number_plateau</code></td>
<td>
<p>The vector of the lengths <code class="reqn">(N_i)_{1\leq i\leq I}</code>.</p>
</td></tr>
<tr><td><code>@ModelHat$imax</code></td>
<td>
<p>The rank <code class="reqn">\hat{i}</code> of the selected plateau.</p>
</td></tr>
<tr><td><code>@interval</code></td>
<td>
<p>A list about the &quot;slope interval&quot;.</p>
</td></tr>
<tr><td><code>@interval$interval</code></td>
<td>
<p>The slope interval.</p>
</td></tr>
<tr><td><code>@interval$percent_of_points</code></td>
<td>
<p>The proportion <code class="reqn">N_{\hat{i}}/\sum_{l=1}^IN_l</code>.</p>
</td></tr>
<tr><td><code>@graph</code></td>
<td>
<p>A list computed for the <code><a href="#topic+plot.DDSE">plot</a></code> method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vincent Brault
</p>


<h3>References</h3>

<p><a href="http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html">http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html</a>
</p>
<p><a href="http://www.math.u-psud.fr/~brault/capushe.html">http://www.math.u-psud.fr/~brault/capushe.html</a>
</p>
<p>Article: Baudry, J.-P., Maugis, C. and Michel, B. (2011) Slope heuristics:
overview and implementation. <var>Statistics and Computing</var>, to appear. doi: 10.1007/
s11222-011-9236-1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+capushe">capushe</a></code> for a model selection function including <code><a href="#topic+AICcapushe">AIC</a></code>,
<code><a href="#topic+BICcapushe">BIC</a></code>, the <code>DDSE</code> algorithm and the <code><a href="#topic+Djump">Djump</a></code> algorithm.
<code><a href="#topic+plot+2CDDSE-method">plot</a></code> for graphical dsiplays of the <code>DDSE</code> algorithm
and the <code>Djump</code> algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datacapushe)
DDSE(datacapushe)
plot(DDSE(datacapushe))
## DDSE with "lm" for the regression
DDSE(datacapushe,psi.rlm="lm")
</code></pre>

<hr>
<h2 id='Djump'>
Model selection by dimension jump
</h2><span id='topic+Djump'></span><span id='topic+Djump-class'></span><span id='topic+plot+2CDjump-method'></span><span id='topic+print+2CDjump-method'></span><span id='topic+show+2CDjump-method'></span><span id='topic+summary+2CDjump-method'></span><span id='topic+print.Djump'></span><span id='topic+show.Djump'></span><span id='topic+summary.Djump'></span><span id='topic+djump'></span><span id='topic+DJUMP'></span><span id='topic+Dimensionjump'></span><span id='topic+DimensionJump'></span><span id='topic+Dimension_Jump'></span><span id='topic+Dimension_jump'></span>

<h3>Description</h3>

<p><code>Djump</code> is a model selection function based on the slope heuristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Djump(data,scoef=2,Careajump=0,Ctresh=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Djump_+3A_data">data</code></td>
<td>

<p><code>data</code> is a matrix or a data.frame with four columns of the same length
and each line corresponds to a model:
</p>

<ol>
<li><p> The first column contains the model names. 
</p>
</li>
<li><p> The second column contains the penalty shape values.   
</p>
</li>
<li><p> The third column contains the model complexity values. 
</p>
</li>
<li><p> The fourth column contains the minimum contrast value for each model. 
</p>
</li></ol>

</td></tr>
<tr><td><code id="Djump_+3A_scoef">scoef</code></td>
<td>

<p>Ratio parameter. Default value is 2.  
</p>
</td></tr>
<tr><td><code id="Djump_+3A_careajump">Careajump</code></td>
<td>

<p>Constant of jump area. Default value is 0 (no area). In practice,
it is advisable to take <code class="reqn">Careajump=\sqrt{\frac{log(n)}{n}}</code> where <code class="reqn">n</code> is the number of observations.
</p>
</td></tr>
<tr><td><code id="Djump_+3A_ctresh">Ctresh</code></td>
<td>

<p>Maximal treshold for the complexity associated to the penalty coefficient.
Default value is 0 (Maximal jump selected as the greatest jump). In practice,
it is advisable to take <code class="reqn">Ctresh=\frac{n}{log(n)}</code> where <code class="reqn">n</code> is the number of observations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Djump algorithm proceeds in three steps:
</p>

<ol>
<li><p>For all <code class="reqn">\kappa&gt;0</code>, compute
</p>
<p><code class="reqn">m(\kappa)\in argmin_{m\in M} \{\gamma_n(\hat{s}_m)+\kappa\times pen_{shape}(m)\}</code>
</p>
<p>This gives a decreasing step function <code class="reqn">\kappa \mapsto C_{m(\kappa)}</code>.
</p>
</li>
<li><p>Find <code class="reqn">\hat{\kappa}</code> such that <code class="reqn">C_{m(\hat{\kappa})}</code> corresponds to the
greatest jump of complexity if <code class="reqn">C_{tresh}=0</code> else <code class="reqn">\hat{\kappa}</code> such that 
</p>
<p><code class="reqn">\hat{\kappa}=inf\{\kappa&gt;0: C_{m(\kappa)}\leq C_{tresh}\}.</code>
</p>

</li>
<li><p>Select <code class="reqn">\hat{m}=m(scoef\times\hat{\kappa})</code> (output <code>@model</code>).
</p>
</li></ol>

<p>Arlot has proposed a jump area containing the maximal jump defined by : 
</p>
<p><code class="reqn">[\kappa(1-Careajump);\kappa(1+Careajump)].</code>
</p>
<p>If <code class="reqn">Careajump&gt;0</code>, <code>Djump</code> return the area with the greatest jump. In practice,
it is advisable to take <code class="reqn">Careajump=\frac{log(n)}{n}</code> where <code class="reqn">n</code> is the number of observations.
</p>


<h3>Value</h3>

<table>
<tr><td><code>@model</code></td>
<td>
<p>The <code>model</code> selected by the dimension jump method.</p>
</td></tr>
<tr><td><code>@ModelHat</code></td>
<td>
<p>A list describing the algorithm.</p>
</td></tr>
<tr><td><code>@ModelHat$jump</code></td>
<td>
<p>The vector of jump heights.</p>
</td></tr>
<tr><td><code>@ModelHat$kappa</code></td>
<td>
<p>The vector of the values of <code class="reqn">\kappa</code> at each jump.</p>
</td></tr>
<tr><td><code>@ModelHat$model_hat</code></td>
<td>
<p>The vector of the selected models <code class="reqn">m(\kappa)</code> by the jump.</p>
</td></tr>
<tr><td><code>@ModelHat$JumpMax</code></td>
<td>
<p>The location of the greatest jump.</p>
</td></tr>
<tr><td><code>@ModelHat$Kopt</code></td>
<td>
 <p><code class="reqn">\kappa_{opt}=scoef\hat{\kappa}</code>.</p>
</td></tr>
<tr><td><code>@graph</code></td>
<td>
<p>A list computed for the <code><a href="#topic+plot.Djump">plot</a></code> method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vincent Brault
</p>


<h3>References</h3>

<p><a href="http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html">http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html</a>
</p>
<p><a href="http://www.math.u-psud.fr/~brault/capushe.html">http://www.math.u-psud.fr/~brault/capushe.html</a>
</p>
<p>Article: Baudry, J.-P., Maugis, C. and Michel, B. (2011) Slope heuristics:
overview and implementation. <var>Statistics and Computing</var>, to appear. doi: 10.1007/
s11222-011-9236-1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+capushe">capushe</a></code> for a model selection function including <code><a href="#topic+AICcapushe">AIC</a></code>,
<code><a href="#topic+BICcapushe">BIC</a></code>, the <code><a href="#topic+DDSE">DDSE</a></code> algorithm and the <code>Djump</code>
algorithm. <code><a href="#topic+plot.Djump">plot</a></code> for a graphical display of the <code>DDSE</code>
algorithm and the <code>Djump</code> algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datacapushe)
Djump(datacapushe)
plot(Djump(datacapushe))
Djump(datacapushe,Careajump=sqrt(log(1000)/1000))
plot(Djump(datacapushe,Careajump=sqrt(log(1000)/1000)))
Djump(datacapushe,Ctresh=1000/log(1000))
plot(Djump(datacapushe,Ctresh=1000/log(1000)))
</code></pre>

<hr>
<h2 id='plot-methods'>Plot for capushe</h2><span id='topic+plot.capushe'></span><span id='topic+plot.DDSE'></span><span id='topic+plot.Djump'></span><span id='topic+plotcapushe'></span><span id='topic+plotDDSE'></span><span id='topic+plotDjump'></span>

<h3>Description</h3>

<p>The plot methods allow the user to check that the slope heuristics can be applied
confidently.
</p>
<p><code>Usage</code>
</p>
<p>plot(x,newwindow=TRUE,ask=TRUE) for <code><a href="#topic+capushe">capushe</a></code>.
</p>
<p>plot(x,newwindow=TRUE) for <code><a href="#topic+DDSE">DDSE</a></code> and <code><a href="#topic+Djump">Djump</a></code>.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p>Output of <code><a href="#topic+DDSE">DDSE</a></code>, <code><a href="#topic+Djump">Djump</a></code> or <code><a href="#topic+capushe">capushe</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_newwindow">newwindow</code></td>
<td>
<p>If <code>newwindow</code>=<code>TRUE</code>, a new window is created for each 
plot.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_ask">ask</code></td>
<td>
<p>If <code>ask</code>=<code>TRUE</code>, <code>plot</code> waits for the user to press
a key to display the next plot (only for the class <code>capushe</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The graphical window of <code>DDSE</code> is composed of three graphics (see <code><a href="#topic+DDSE">DDSE</a></code> for more details):
</p>

<dl>
<dt>left</dt><dd><p>The left plot shows <code class="reqn">-\gamma_n(\hat{s}_m)</code> with respect to the 
penalty shape values.</p>
</dd>
<dt>topright</dt><dd><p>Successive slope values <code class="reqn">\hat{\kappa}(p)</code>.</p>
</dd>
<dt>bottomright</dt><dd><p>The bottomright plot shows the selected models <code class="reqn">\hat{m}(p)</code> with respect 
to the successive slope values. The plateau in blue is selected.</p>
</dd> 
</dl>

<p>The graphical window of <code>Djump</code> shows the complexity  <code class="reqn">C_{m(\kappa)}</code> of
the selected model with respect to <code class="reqn">\kappa</code>. <code class="reqn">\hat{\kappa}^{dj}</code> corresponds
to the greatest jump. <code class="reqn">\kappa_{opt}</code> is defined by <code class="reqn">\kappa_{opt}=scoef\times \hat{\kappa}^{dj}</code>.
The red line represents the slope interval computed by the <code>DDSE</code> algorithm
(only for <code>capushe</code>). See <code><a href="#topic+Djump">Djump</a></code> for more details.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "Capushe")</code></dt><dd><p> This graphical function displays the <code>DDSE</code> plot and the <code>Djump</code> plot.</p>
</dd>
<dt><code>signature(x = "DDSE")</code></dt><dd><p> This graphical function displays the <code><a href="#topic+DDSE">DDSE</a></code> plot.</p>
</dd>
<dt><code>signature(x = "Djump")</code></dt><dd><p> This graphical function displays the <code><a href="#topic+Djump">Djump</a></code> plot.</p>
</dd>
</dl>


<h3>Note</h3>

<p>Use <code>newwindow</code>=<code>FALSE</code> to produce a PDF files (for an object of class
<code>capushe</code>, use moreover <code>ask</code>=<code>FALSE</code>).
</p>

<hr>
<h2 id='validation'>
validation
</h2><span id='topic+validation'></span><span id='topic+validation-methods'></span><span id='topic+validation.capushe'></span><span id='topic+validation.DDSE'></span><span id='topic+validationcapushe'></span><span id='topic+validationDDSE'></span>

<h3>Description</h3>

<p><code>validation</code> checks that the slope heuristics can be applied confidently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validation(x,data2,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validation_+3A_x">x</code></td>
<td>

<p><code>x</code> must be an object of <code><a href="#topic+Capushe-class">class capushe</a></code> 
or <code><a href="#topic+DDSE-class">DDSE</a></code>, in practice an 
output of the <code><a href="#topic+capushe">capushe</a></code> function or the <code><a href="#topic+DDSE">DDSE</a></code> function. 
</p>
</td></tr>
<tr><td><code id="validation_+3A_data2">data2</code></td>
<td>

<p><code>data2</code> is a matrix or a data.frame with four columns of the same length
and each line corresponds to a model:
</p>

<ol>
<li><p> The first column contains the model names. 
</p>
</li>
<li><p> The second column contains the penalty shape values.   
</p>
</li>
<li><p> The third column contains the model complexity values. 
</p>
</li>
<li><p> The fourth column contains the minimum contrast value for each model. 
</p>
</li></ol>

</td></tr>
<tr><td><code id="validation_+3A_...">...</code></td>
<td>


<ul>
<li>
<p>If <code>newwindow==TRUE</code>, a new window is created for the plot.

</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>The <code>validation</code> function plots the additional and more complex models <code>data2</code>
to check that the linear relation between the penalty shape values and the contrast
values (which is recorded in <code>x</code>) is valid for the more complex models.
</p>


<h3>Author(s)</h3>

<p>Vincent Brault
</p>


<h3>References</h3>

<p><a href="http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html">http://www.math.univ-toulouse.fr/~maugis/CAPUSHE.html</a>
</p>
<p><a href="http://www.math.u-psud.fr/~brault/capushe.html">http://www.math.u-psud.fr/~brault/capushe.html</a>
</p>
<p>Article: Baudry, J.-P., Maugis, C. and Michel, B. (2011) Slope heuristics:
overview and implementation. <var>Statistics and Computing</var>, to appear. doi: 10.1007/
s11222-011-9236-1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+capushe">capushe</a></code> for a more general model selection function including
<code><a href="#topic+AICcapushe">AIC</a></code>, <code><a href="#topic+BICcapushe">BIC</a></code>, the <code><a href="#topic+DDSE">DDSE</a></code>
algorithm and the <code><a href="#topic+Djump">Djump</a></code> algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datapartialcapushe)
capushepartial=capushe(datapartialcapushe)
data(datavalidcapushe)
validation(capushepartial,datavalidcapushe) ## The slope heuristics should not 
## be applied for datapartialcapushe.
data(datacapushe)
plot(capushe(datacapushe))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
