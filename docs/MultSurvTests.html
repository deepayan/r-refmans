<!DOCTYPE html><html lang="en"><head><title>Help for package MultSurvTests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultSurvTests}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#choose_B'><p>Choose B for permutation tests</p></a></li>
<li><a href='#diabetes'><p>Diabetes Data</p></a></li>
<li><a href='#gehan'><p>Gehan test</p></a></li>
<li><a href='#mvlogrank'><p>Mvlogrank test</p></a></li>
<li><a href='#perm_gehan'><p>Multivariate permutation Gehan test</p></a></li>
<li><a href='#perm_mvlogrank'><p>Multivariate permutation logrank test</p></a></li>
<li><a href='#wltestdata'><p>Data randomly generated.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Permutation Tests for Multivariate Survival Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Multivariate version of the two-sample Gehan and logrank tests, as described in L.J Wei &amp; J.M Lachin (1984) and Persson et al. (2019).</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.9), Rdpack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/lukketotte/MultSurvTests">https://github.com/lukketotte/MultSurvTests</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lukketotte/MultSurvTests/issues">https://github.com/lukketotte/MultSurvTests/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-17 05:44:30 UTC; mans</td>
</tr>
<tr>
<td>Author:</td>
<td>Lukas Arnroth [aut, cre],
  MÃ¥ns Thulin [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lukas Arnroth &lt;lukas.arnroth@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-18 07:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='choose_B'>Choose B for permutation tests</h2><span id='topic+choose_B'></span>

<h3>Description</h3>

<p>Computes the value of B for a permutation test required to obtain a specified accuracy when
approximating the permutation p-values using B random permutations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choose_B(p0 = 0.05, width = 0.01, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="choose_B_+3A_p0">p0</code></td>
<td>
<p>A guess for the p-value. Can be based e.g. on a small number of simulations. The default is 0.05.</p>
</td></tr>
<tr><td><code id="choose_B_+3A_width">width</code></td>
<td>
<p>The desired width of the Clopper-Pearson interval. The default is 0.01.</p>
</td></tr>
<tr><td><code id="choose_B_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level of the Clopper-Pearson interval. The default is 0.95.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computations are based on the Clopper-Pearson interval, using a formula from
Thulin (2014). The procedure is described in Section 3.3 in Persson et al. (2019).
</p>


<h3>Value</h3>

<p>B
</p>


<h3>References</h3>

<p>Persson I, Arnroth L, Thulin M (2019).
&ldquo;Multivariate two sample permutation tests for trials with multiple time to event outcomes.&rdquo;
<em>Pharmaceutical Statistics</em>, <b>18</b>, 476&ndash;485.
doi: <a href="https://doi.org/10.1002/pst.1938">10.1002/pst.1938</a>, <a href="https://doi.org/10.1002/pst.1938">https://doi.org/10.1002/pst.1938</a>.
</p>
<p>Thulin M (2014).
&ldquo;The cost of using exact confidence intervals for a binomial proportion.&rdquo;
<em>Electronic Journal of Statistics</em>, <b>8(1)</b>, 817&ndash;840.
doi: <a href="https://doi.org/10.1214/14-EJS909">10.1214/14-EJS909</a>, <a href="https://doi.org/10.1214/14-EJS909">https://doi.org/10.1214/14-EJS909</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># B required to achieve an expected width of 0.02 when
# the p-value is approximately 0.1:
choose_B(p0 = 0.1, width = 0.02)

</code></pre>

<hr>
<h2 id='diabetes'>Diabetes Data</h2><span id='topic+diabetes'></span>

<h3>Description</h3>

<p>Diabetic retinopathy: how strongly are times to blindness of a treated and an untreated eye correlated in patients suffering from diabetic retinopathy? The analysis is based on a sample of n=197 paired failure times (censoring 73% and 49% for the treated and untreated eyes, respectively) described by Huster, Brookmeyer, and Self (1989). Both eyes of an individual are observed for the same time, and therefore dots on the diagonal generally indicate pairs of censored times. </p>


<h3>Usage</h3>

<pre><code class='language-R'>diabetes</code></pre>


<h3>Format</h3>

<p>A data.frame containing 197 rows.</p>


<h3>Source</h3>

<p><a href="https://www.mayo.edu/research/documents/diabeteshtml/DOC-10027460/">https://www.mayo.edu/research/documents/diabeteshtml/DOC-10027460/</a></p>


<h3>References</h3>

<p>Huster WJ, Brookmeyer R, Self SG (1989).
&ldquo;Modelling paired survival data with covariates.&rdquo;
<em>Biometrics</em>, <b>45</b>, 145&ndash;156.
doi: <a href="https://doi.org/10.2307/2532041">10.2307/2532041</a>, <a href="https://doi.org/10.2307/2532041">https://doi.org/10.2307/2532041</a>.
</p>

<hr>
<h2 id='gehan'>Gehan test</h2><span id='topic+gehan'></span>

<h3>Description</h3>

<p>Computes the multivariate Gehan test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gehan(x, y, delta_x, delta_y, n1, n2, p, k = 1L, l = 1L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gehan_+3A_x">x</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="gehan_+3A_y">y</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="gehan_+3A_delta_x">delta_x</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="gehan_+3A_delta_y">delta_y</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="gehan_+3A_n1">n1</code></td>
<td>
<p>Integer. Set as the number of rows in x</p>
</td></tr>
<tr><td><code id="gehan_+3A_n2">n2</code></td>
<td>
<p>Integer. Set as the number of rows in y</p>
</td></tr>
<tr><td><code id="gehan_+3A_p">p</code></td>
<td>
<p>Integer. Set as the number of columns in x and y</p>
</td></tr>
<tr><td><code id="gehan_+3A_k">k</code></td>
<td>
<p>Integer.</p>
</td></tr>
<tr><td><code id="gehan_+3A_l">l</code></td>
<td>
<p>Integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>1x1 matrix containing a numeric
</p>

<hr>
<h2 id='mvlogrank'>Mvlogrank test</h2><span id='topic+mvlogrank'></span>

<h3>Description</h3>

<p>Computes the multivariate logrank test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvlogrank(x, y, delta_x, delta_y, n1, n2, p, k = 1L, l = 1L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvlogrank_+3A_x">x</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="mvlogrank_+3A_y">y</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="mvlogrank_+3A_delta_x">delta_x</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="mvlogrank_+3A_delta_y">delta_y</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="mvlogrank_+3A_n1">n1</code></td>
<td>
<p>Integer. Set as the number of rows in x</p>
</td></tr>
<tr><td><code id="mvlogrank_+3A_n2">n2</code></td>
<td>
<p>Integer. Set as the number of rows in y</p>
</td></tr>
<tr><td><code id="mvlogrank_+3A_p">p</code></td>
<td>
<p>Integer. Set as the number of columns in x and y</p>
</td></tr>
<tr><td><code id="mvlogrank_+3A_k">k</code></td>
<td>
<p>Integer.</p>
</td></tr>
<tr><td><code id="mvlogrank_+3A_l">l</code></td>
<td>
<p>Integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>1x1 matrix containing a numeric
</p>

<hr>
<h2 id='perm_gehan'>Multivariate permutation Gehan test</h2><span id='topic+perm_gehan'></span>

<h3>Description</h3>

<p>Computes the p-value of the multivariate permutation Gehan test described in Persson et al. (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm_gehan(B = 999, z, delta.z, n1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perm_gehan_+3A_b">B</code></td>
<td>
<p>An integer specifying the number of permutations to perform. The default is 999. It is recommended to use <code><a href="#topic+choose_B">choose_B</a></code> for choosing <code>B</code>.</p>
</td></tr>
<tr><td><code id="perm_gehan_+3A_z">z</code></td>
<td>
<p>A matrix containing the observed (possibly censored) survival times for the two groups. The observations for the first group should be one the first <code>n1</code> rows.</p>
</td></tr>
<tr><td><code id="perm_gehan_+3A_delta.z">delta.z</code></td>
<td>
<p>A matrix containing the censoring status of each observation in <code>z</code>.</p>
</td></tr>
<tr><td><code id="perm_gehan_+3A_n1">n1</code></td>
<td>
<p>An integer specifying the sample size of the first group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multivariate version of the logrank and Gehan tests were described by
Wei &amp; Lachin (1984). Persson et al. (2019) described permutation versions of
these tests, with improved performance.
</p>


<h3>Value</h3>

<p>A p-value.
</p>


<h3>References</h3>

<p>Persson I, Arnroth L, Thulin M (2019).
&ldquo;Multivariate two sample permutation tests for trials with multiple time to event outcomes.&rdquo;
<em>Pharmaceutical Statistics</em>, <b>18</b>, 476&ndash;485.
doi: <a href="https://doi.org/10.1002/pst.1938">10.1002/pst.1938</a>, <a href="https://doi.org/10.1002/pst.1938">https://doi.org/10.1002/pst.1938</a>.
</p>
<p>Wei LJ, Lachin JM (1984).
&ldquo;Two sample asymptotically distribution free tests for incomplete multivariate observations.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>79(387)</b>, 653&ndash;661.
doi: <a href="https://doi.org/10.1080/01621459.1984.10478093">10.1080/01621459.1984.10478093</a>, <a href="https://doi.org/10.1080/01621459.1984.10478093">https://doi.org/10.1080/01621459.1984.10478093</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Diabetes data:
?diabetes
# Survival times for the two groups:
x &lt;- as.matrix(subset(diabetes, LASER==1)[c(6,8)])
y &lt;- as.matrix(subset(diabetes, LASER==2)[c(6,8)])
# Censoring status for the two groups:
delta.x &lt;- as.matrix(subset(diabetes, LASER==1)[c(7,9)])
delta.y &lt;- as.matrix(subset(diabetes, LASER==2)[c(7,9)])
# Create the input for the test:
z &lt;- rbind(x, y)
delta.z &lt;- rbind(delta.x, delta.y)
# Run the test with 50 permutations:
perm_gehan(B = 50, z, delta.z, n1 = nrow(x))
# In most cases, it is preferable to use more than 50
# permutations for computing p-values. choose_B() can
# be used to determine how many permutations are needed.

</code></pre>

<hr>
<h2 id='perm_mvlogrank'>Multivariate permutation logrank test</h2><span id='topic+perm_mvlogrank'></span>

<h3>Description</h3>

<p>Computes the p-value of the multivariate permutation logrank test described in Persson et al. (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm_mvlogrank(B, z, delta.z, n1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perm_mvlogrank_+3A_b">B</code></td>
<td>
<p>An integer specifying the number of permutations to perform. The default is 999. It is recommended to use <code><a href="#topic+choose_B">choose_B</a></code> for choosing <code>B</code>.</p>
</td></tr>
<tr><td><code id="perm_mvlogrank_+3A_z">z</code></td>
<td>
<p>A matrix containing the observed (possibly censored) survival times for the two groups. The observations for the first group should be one the first <code>n1</code> rows.</p>
</td></tr>
<tr><td><code id="perm_mvlogrank_+3A_delta.z">delta.z</code></td>
<td>
<p>A matrix containing the censoring status of each observation in <code>z</code>.</p>
</td></tr>
<tr><td><code id="perm_mvlogrank_+3A_n1">n1</code></td>
<td>
<p>An integer specifying the sample size of the first group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multivariate version of the logrank and Gehan tests were described by
Wei &amp; Lachin (1984). Persson et al. (2019) described permutation versions of
these tests, with improved performance.
</p>


<h3>Value</h3>

<p>A p-value.
</p>


<h3>References</h3>

<p>Persson I, Arnroth L, Thulin M (2019).
&ldquo;Multivariate two sample permutation tests for trials with multiple time to event outcomes.&rdquo;
<em>Pharmaceutical Statistics</em>, <b>18</b>, 476&ndash;485.
doi: <a href="https://doi.org/10.1002/pst.1938">10.1002/pst.1938</a>, <a href="https://doi.org/10.1002/pst.1938">https://doi.org/10.1002/pst.1938</a>.
</p>
<p>Wei LJ, Lachin JM (1984).
&ldquo;Two sample asymptotically distribution free tests for incomplete multivariate observations.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>79(387)</b>, 653&ndash;661.
doi: <a href="https://doi.org/10.1080/01621459.1984.10478093">10.1080/01621459.1984.10478093</a>, <a href="https://doi.org/10.1080/01621459.1984.10478093">https://doi.org/10.1080/01621459.1984.10478093</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Diabetes data:
?diabetes
# Survival times for the two groups:
x &lt;- as.matrix(subset(diabetes, LASER==1)[c(6,8)])
y &lt;- as.matrix(subset(diabetes, LASER==2)[c(6,8)])
# Censoring status for the two groups:
delta.x &lt;- as.matrix(subset(diabetes, LASER==1)[c(7,9)])
delta.y &lt;- as.matrix(subset(diabetes, LASER==2)[c(7,9)])
# Create the input for the test:
z &lt;- rbind(x, y)
delta.z &lt;- rbind(delta.x, delta.y)
# Run the test with 50 permutations:
perm_mvlogrank(B = 50, z, delta.z, n1 = nrow(x))
# In most cases, it is preferable to use more than 50
# permutations for computing p-values. choose_B() can
# be used to determine how many permutations are needed.

</code></pre>

<hr>
<h2 id='wltestdata'>Data randomly generated.</h2><span id='topic+wltestdata'></span>

<h3>Description</h3>

<p>Data randomly generated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wltestdata
</code></pre>


<h3>Format</h3>

<p>A dataframe containing 47 rows and 9 columns
</p>

<dl>
<dt>V1:V9</dt><dd><p>Randomly generated integers</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
