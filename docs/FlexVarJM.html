<!DOCTYPE html><html><head><title>Help for package FlexVarJM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FlexVarJM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Data_toy'><p>Data_toy</p></a></li>
<li><a href='#data.GaussKronrod'><p>Initialisation of Survival Data at Gauss Kronrod time points</p></a></li>
<li><a href='#data.GaussKronrod2'><p>Initialisation of Survival Data at Gauss Kronrod time points 2</p></a></li>
<li><a href='#data.manag.long'><p>Management of longitudinal data</p></a></li>
<li><a href='#data.manag.surv'><p>Management of survival data</p></a></li>
<li><a href='#data.time'><p>Management of data for longitudinal submodel</p></a></li>
<li><a href='#FlexVarJM-package'><p>FlexVarJM: Estimate Joint Models with Subject-Specific Variance</p></a></li>
<li><a href='#gaussKronrod'><p>Gauss-Kronrod nodes and weights</p></a></li>
<li><a href='#goodness_of_fit'><p>Predictions for the goodness of fit, of the random effects, the current value for each individuals and the cumulative hazard function for both events</p></a></li>
<li><a href='#initial.long'><p>Initialisation of Longitudinal Submodel</p></a></li>
<li><a href='#log_llh'><p>Log-likelihood computation</p></a></li>
<li><a href='#log_llh_rcpp'><p>Log-likelihood computation in RCPP</p></a></li>
<li><a href='#lsjm'><p>lsjm : Estimation of joint model for longitudinal data with a subject-specific time-dependent variability and time-to-event data.</p></a></li>
<li><a href='#lsmm'><p>lsmm : Estimation of location scale mixed model</p></a></li>
<li><a href='#pred_s.t.bootstrap.tps'><p>Predictions computation</p></a></li>
<li><a href='#pred_s.t.ponctuel.tps'><p>Predictions computation</p></a></li>
<li><a href='#predyn'><p>Dynamic prediction for new individuals</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimate Joint Models with Subject-Specific Variance</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of mixed models including a subject-specific variance which can be time and covariate dependent. In the joint model framework, the package handles left truncation and allows a flexible dependence structure between the competing events and the longitudinal marker. The estimation is performed under the frequentist framework, using the Marquardt-Levenberg algorithm. (Courcoul, Tzourio, Woodward, Barbieri, Jacqmin-Gadda (2023) &lt;<a href="https://arxiv.org/abs/2306.16785">arXiv:2306.16785</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, lcmm, marqLevAlg, mvtnorm, randtoolbox, Rcpp, stats,
survminer, utils</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), splines, survival</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/LeonieCourcoul/FlexVarJM">https://github.com/LeonieCourcoul/FlexVarJM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/LeonieCourcoul/FlexVarJM/issues">https://github.com/LeonieCourcoul/FlexVarJM/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-20 12:07:33 UTC; lc14</td>
</tr>
<tr>
<td>Author:</td>
<td>Léonie Courcoul [aut, cre],
  Antoine Barbieri [aut],
  Hélène Jacqmin-Gadda [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Léonie Courcoul &lt;leonie.courcoul@u-bordeaux.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-20 19:40:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='Data_toy'>Data_toy</h2><span id='topic+Data_toy'></span>

<h3>Description</h3>

<p>A simulated dataset for the example of the FlexVarJM package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Data_toy
</code></pre>


<h3>Format</h3>

<p>A data frame with 2076 rows and 5 variables:
</p>

<dl>
<dt>ID</dt><dd><p>the Id of each subject</p>
</dd>
<dt>visit</dt><dd><p>the time of measurement</p>
</dd>
<dt>y</dt><dd><p>the value of the marker</p>
</dd>
<dt>time</dt><dd><p>the time of the first event observed</p>
</dd>
<dt>event</dt><dd><p>the first event observed : 0 = censoring, 1 = first event, 2 = second event</p>
</dd>
</dl>


<hr>
<h2 id='data.GaussKronrod'>Initialisation of Survival Data at Gauss Kronrod time points</h2><span id='topic+data.GaussKronrod'></span>

<h3>Description</h3>

<p>Initialisation of Survival Data at Gauss Kronrod time points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.GaussKronrod(data.id, Time, k = 15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.GaussKronrod_+3A_data.id">data.id</code></td>
<td>
<p>A database with covariates of interest and 1 line per subject</p>
</td></tr>
<tr><td><code id="data.GaussKronrod_+3A_time">Time</code></td>
<td>
<p>A vector of time event</p>
</td></tr>
<tr><td><code id="data.GaussKronrod_+3A_k">k</code></td>
<td>
<p>The number of Gauss Kronrod points, by default k = 15</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :
</p>

<dl>
<dt><code>K</code></dt><dd><p>an integer, the number of points</p>
</dd>
<dt><code>P</code></dt><dd><p>a vector, of value Time/2</p>
</dd>
<dt><code>st</code></dt><dd><p>a matrix with nrow = number of subjects and ncol = k. The new time to compute the survival function</p>
</dd>
<dt><code>wk</code></dt><dd><p>a vector of weights</p>
</dd>
<dt><code>data.id2</code></dt><dd><p>a database with K lines per subjects</p>
</dd>
<dt><code>id.GK</code></dt><dd><p>the vector of IDs</p>
</dd>
</dl>


<hr>
<h2 id='data.GaussKronrod2'>Initialisation of Survival Data at Gauss Kronrod time points 2</h2><span id='topic+data.GaussKronrod2'></span>

<h3>Description</h3>

<p>Initialisation of Survival Data at Gauss Kronrod time points 2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.GaussKronrod2(data.id, a, b, k = 15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.GaussKronrod2_+3A_data.id">data.id</code></td>
<td>
<p>A database with covariates of interest and 1 line per subject</p>
</td></tr>
<tr><td><code id="data.GaussKronrod2_+3A_a">a</code></td>
<td>
<p>First born</p>
</td></tr>
<tr><td><code id="data.GaussKronrod2_+3A_b">b</code></td>
<td>
<p>Second born</p>
</td></tr>
<tr><td><code id="data.GaussKronrod2_+3A_k">k</code></td>
<td>
<p>The number of Gauss Kronrod points, by default k = 15</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :
</p>

<dl>
<dt><code>K</code></dt><dd><p>an integer, the number of points</p>
</dd>
<dt><code>P</code></dt><dd><p>a vector, of value Time/2</p>
</dd>
<dt><code>st</code></dt><dd><p>a matrix with nrow = number of subjects and ncol = k. The new time to compute the survival function</p>
</dd>
<dt><code>wk</code></dt><dd><p>a vector of weights</p>
</dd>
<dt><code>data.id2</code></dt><dd><p>a database with K lines per subjects</p>
</dd>
<dt><code>id.GK</code></dt><dd><p>the vector of IDs</p>
</dd>
</dl>


<hr>
<h2 id='data.manag.long'>Management of longitudinal data</h2><span id='topic+data.manag.long'></span>

<h3>Description</h3>

<p>Management of longitudinal data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.manag.long(formGroup, formFixed, formRandom, data.long1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.manag.long_+3A_formgroup">formGroup</code></td>
<td>
<p>A formula which indicates the group variable</p>
</td></tr>
<tr><td><code id="data.manag.long_+3A_formfixed">formFixed</code></td>
<td>
<p>A formula which indicates the fixed effects for the longitudinal submodel</p>
</td></tr>
<tr><td><code id="data.manag.long_+3A_formrandom">formRandom</code></td>
<td>
<p>A formula which indicates the random effects for the longitudinal submodel</p>
</td></tr>
<tr><td><code id="data.manag.long_+3A_data.long1">data.long1</code></td>
<td>
<p>A dataframe with the longitudinal data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :
</p>

<dl>
<dt><code>data_long</code></dt><dd><p>a clean dataframe for the longitudinal data</p>
</dd>
<dt><code>y.new.prog</code></dt><dd><p>the vector of responses variable</p>
</dd>
<dt><code>X</code></dt><dd><p>a matrix with the fixed effects</p>
</dd>
<dt><code>U</code></dt><dd><p>a matrix with the random effects</p>
</dd>
<dt><code>id</code></dt><dd><p>a vector with the identification of individuals</p>
</dd>
<dt><code>offset</code></dt><dd><p>a vector with the number of measurements for each individual</p>
</dd>
<dt><code>I</code></dt><dd><p>an integer, the number of individuals</p>
</dd>
</dl>


<hr>
<h2 id='data.manag.surv'>Management of survival data</h2><span id='topic+data.manag.surv'></span>

<h3>Description</h3>

<p>Management of survival data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.manag.surv(formGroup, formSurv, data.long1, formSurv_CompRisk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.manag.surv_+3A_formgroup">formGroup</code></td>
<td>
<p>A formula which indicates the group variable</p>
</td></tr>
<tr><td><code id="data.manag.surv_+3A_formsurv">formSurv</code></td>
<td>
<p>A formula which indicates the variables used in the survival submodel</p>
</td></tr>
<tr><td><code id="data.manag.surv_+3A_data.long1">data.long1</code></td>
<td>
<p>Database</p>
</td></tr>
<tr><td><code id="data.manag.surv_+3A_formsurv_comprisk">formSurv_CompRisk</code></td>
<td>
<p>A formula which indicates the variables used in the competing survival submodel</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :
</p>

<dl>
<dt><code>tmp</code></dt><dd><p>the final database for survival analysis</p>
</dd>
<dt><code>Time</code></dt><dd><p>a vector of observed times</p>
</dd>
<dt><code>event1</code></dt><dd><p>a vector of first event indicator</p>
</dd>
<dt><code>nTime</code></dt><dd><p>length of Time vector</p>
</dd>
<dt><code>Z</code></dt><dd><p>matrix of covariables of first survival submodel</p>
</dd>
<dt><code>event2</code></dt><dd><p>a vector of second event indicator</p>
</dd>
<dt><code>Z_CR</code></dt><dd><p>matrix of covariables of second survival submodel</p>
</dd>
</dl>


<hr>
<h2 id='data.time'>Management of data for longitudinal submodel</h2><span id='topic+data.time'></span>

<h3>Description</h3>

<p>Management of data for longitudinal submodel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.time(data.id, Time, formFixed, formRandom, timeVar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.time_+3A_data.id">data.id</code></td>
<td>
<p>A dataframe</p>
</td></tr>
<tr><td><code id="data.time_+3A_time">Time</code></td>
<td>
<p>A vector of Time of events</p>
</td></tr>
<tr><td><code id="data.time_+3A_formfixed">formFixed</code></td>
<td>
<p>A formula for the fixed effects of the longitudinal submodel</p>
</td></tr>
<tr><td><code id="data.time_+3A_formrandom">formRandom</code></td>
<td>
<p>A formula for the random effects of the longitudinal submodel</p>
</td></tr>
<tr><td><code id="data.time_+3A_timevar">timeVar</code></td>
<td>
<p>The name of the column of time in data.id. This variable must appears in data.id</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components
</p>

<dl>
<dt><code>Xtime</code></dt><dd><p>a matrix of fixed effects at each time of measure</p>
</dd>
<dt><code>Utime</code></dt><dd><p>a matrix of random effects at each time of measure</p>
</dd>
</dl>


<hr>
<h2 id='FlexVarJM-package'>FlexVarJM: Estimate Joint Models with Subject-Specific Variance</h2><span id='topic+FlexVarJM'></span><span id='topic+FlexVarJM-package'></span>

<h3>Description</h3>

<p>Estimation of mixed models including a subject-specific variance which can be time and covariate dependent. In the joint model framework, the package handles left truncation and allows a flexible dependence structure between the competing events and the longitudinal marker. The estimation is performed under the frequentist framework, using the Marquardt-Levenberg algorithm. (Courcoul, Tzourio, Woodward, Barbieri, Jacqmin-Gadda (2023) <a href="https://arxiv.org/abs/2306.16785">arXiv:2306.16785</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Léonie Courcoul <a href="mailto:leonie.courcoul@u-bordeaux.fr">leonie.courcoul@u-bordeaux.fr</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Antoine Barbieri <a href="mailto:antoine.barbieri@u-bordeaux.fr">antoine.barbieri@u-bordeaux.fr</a>
</p>
</li>
<li><p> Hélène Jacqmin-Gadda <a href="mailto:helene.jacqmin-gadda@u-bordeaux.fr">helene.jacqmin-gadda@u-bordeaux.fr</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/LeonieCourcoul/FlexVarJM">https://github.com/LeonieCourcoul/FlexVarJM</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/LeonieCourcoul/FlexVarJM/issues">https://github.com/LeonieCourcoul/FlexVarJM/issues</a>
</p>
</li></ul>


<hr>
<h2 id='gaussKronrod'>Gauss-Kronrod nodes and weights</h2><span id='topic+gaussKronrod'></span>

<h3>Description</h3>

<p>Gauss-Kronrod nodes and weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gaussKronrod(k = 15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gaussKronrod_+3A_k">k</code></td>
<td>
<p>the number of points for Gauss-Kronrod approximation : choice between 7 and 15. 15 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :
</p>

<dl>
<dt><code>sk</code></dt><dd><p>A k-vector of nodes</p>
</dd>
<dt><code>wk</code></dt><dd><p>A k-vector of weights</p>
</dd>
</dl>


<hr>
<h2 id='goodness_of_fit'>Predictions for the goodness of fit, of the random effects, the current value for each individuals and the cumulative hazard function for both events</h2><span id='topic+goodness_of_fit'></span>

<h3>Description</h3>

<p>Predictions for the goodness of fit, of the random effects, the current value for each individuals and the cumulative hazard function for both events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goodness_of_fit(object, graph = FALSE, break.times = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="goodness_of_fit_+3A_object">object</code></td>
<td>
<p>an object of class lsjm</p>
</td></tr>
<tr><td><code id="goodness_of_fit_+3A_graph">graph</code></td>
<td>
<p>a boolean to indicate to print graphics, False by default</p>
</td></tr>
<tr><td><code id="goodness_of_fit_+3A_break.times">break.times</code></td>
<td>
<p>a vector of times for the time points of longitudinal graphic</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which contains the following elements :
</p>

<dl>
<dt><code>tables</code></dt><dd><p>A list with the table of the predicted random effect, the table of the predicted current value, table(s) of predictive cumulative hazard function(s)</p>
</dd>
<dt><code>graphs</code></dt><dd><p>A list with 2 or 3 graphs : one for the longitudinal adjustment and one for each risk function</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>



#Fit a joint model with competing risks and subject-specific variability
example &lt;- lsjm(formFixed = y~visit,
formRandom = ~ visit,
formGroup = ~ID,
formSurv = Surv(time, event ==1 ) ~ 1,
timeVar = "visit",
data.long = Data_toy,
variability_hetero = TRUE,
formFixedVar =~visit,
formRandomVar =~visit,
correlated_re = TRUE,
sharedtype = c("current value", "variability"),
hazard_baseline = "Weibull",
formSlopeFixed =~1,
formSlopeRandom = ~1,
indices_beta_slope = c(2), 
competing_risk = TRUE,
formSurv_CR = Surv(time, event ==2 ) ~ 1,
hazard_baseline_CR = "Weibull",
sharedtype_CR = c("current value", "variability"),
S1 = 100,
S2 = 1000,
nproc = 1,
maxiter = 100,
Comp.Rcpp = TRUE
)

#Assesment of the goodness of fit:
gof &lt;- goodness_of_fit(example, graph = TRUE)
gof$tables
gof$graphs


</code></pre>

<hr>
<h2 id='initial.long'>Initialisation of Longitudinal Submodel</h2><span id='topic+initial.long'></span>

<h3>Description</h3>

<p>Initialisation of Longitudinal Submodel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initial.long(formFixed, formRandom, idVar, data.long1, ncX, nproc = nproc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initial.long_+3A_formfixed">formFixed</code></td>
<td>
<p>A formula which indicates the fixed effects for the longitudinal submodel</p>
</td></tr>
<tr><td><code id="initial.long_+3A_formrandom">formRandom</code></td>
<td>
<p>A formula which indicates the random effects for the longitudinal submodel</p>
</td></tr>
<tr><td><code id="initial.long_+3A_idvar">idVar</code></td>
<td>
<p>A character, indicates the name of the group variable</p>
</td></tr>
<tr><td><code id="initial.long_+3A_data.long1">data.long1</code></td>
<td>
<p>A dataframe with the longitudinal data</p>
</td></tr>
<tr><td><code id="initial.long_+3A_ncx">ncX</code></td>
<td>
<p>An integer, the number of columns of matrix X, ie, the number of fixed effects</p>
</td></tr>
<tr><td><code id="initial.long_+3A_nproc">nproc</code></td>
<td>
<p>An integer, the number of cores for parallel computation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components :
</p>

<dl>
<dt><code>long_model</code></dt><dd><p>the result of the hlme function</p>
</dd>
<dt><code>priorMean.beta</code></dt><dd><p>the estimated parameters for fixed effects in the linear mixed effects model</p>
</dd>
<dt><code>sigma</code></dt><dd><p>the estimated sigma of the model</p>
</dd>
</dl>


<hr>
<h2 id='log_llh'>Log-likelihood computation</h2><span id='topic+log_llh'></span>

<h3>Description</h3>

<p>Log-likelihood computation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_llh(
  param,
  nb.e.a,
  nb.priorMean.beta,
  nb.alpha,
  competing_risk,
  nb.alpha.CR,
  variability_hetero,
  S,
  Zq,
  sharedtype,
  sharedtype_CR,
  hazard_baseline,
  hazard_baseline_CR,
  ord.splines,
  Xtime,
  Utime,
  nb_pointsGK,
  Xs,
  Us,
  Xslope,
  Uslope,
  Xs.slope,
  Us.slope,
  indices_beta_slope,
  Time,
  st_calc,
  B,
  Bs,
  wk,
  Z,
  P,
  left_trunc,
  Z_CR,
  X_base,
  offset,
  U,
  y.new.prog,
  event1,
  event2,
  Ind,
  Xs.0,
  Us.0,
  Xs.slope.0,
  Us.slope.0,
  P.0,
  st.0,
  Bs.0,
  B.CR,
  Bs.CR,
  Bs.0.CR,
  nb.e.a.sigma = nb.e.a.sigma,
  nb.omega = nb.omega,
  Otime = Otime,
  Wtime = Wtime,
  Os = Os,
  Ws = Ws,
  O_base = O_base,
  W_base = W_base,
  correlated_re = correlated_re,
  Os.0 = Os.0,
  Ws.0 = Ws.0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_llh_+3A_param">param</code></td>
<td>
<p>a vector : paramaters to be estimated</p>
</td></tr>
<tr><td><code id="log_llh_+3A_nb.e.a">nb.e.a</code></td>
<td>
<p>integer : number of RE</p>
</td></tr>
<tr><td><code id="log_llh_+3A_nb.priormean.beta">nb.priorMean.beta</code></td>
<td>
<p>integer : number of fixed effects</p>
</td></tr>
<tr><td><code id="log_llh_+3A_nb.alpha">nb.alpha</code></td>
<td>
<p>integer : number of covariates in survival model</p>
</td></tr>
<tr><td><code id="log_llh_+3A_competing_risk">competing_risk</code></td>
<td>
<p>boolean : allow competing risk or not, FALSE by default</p>
</td></tr>
<tr><td><code id="log_llh_+3A_nb.alpha.cr">nb.alpha.CR</code></td>
<td>
<p>integer : number of covariates in survival model for competing risks</p>
</td></tr>
<tr><td><code id="log_llh_+3A_variability_hetero">variability_hetero</code></td>
<td>
<p>boolean : allow the heterogeneous variability or not</p>
</td></tr>
<tr><td><code id="log_llh_+3A_s">S</code></td>
<td>
<p>integer : the number of QMC points</p>
</td></tr>
<tr><td><code id="log_llh_+3A_zq">Zq</code></td>
<td>
<p>vector : sobol points</p>
</td></tr>
<tr><td><code id="log_llh_+3A_sharedtype">sharedtype</code></td>
<td>
<p>vector : dependence structure for survival model : &quot;RE&quot; (random effects) or &quot;CV&quot; (current value) or &quot;CVS&quot; (current value and slope) or &quot;S&quot; (slope)</p>
</td></tr>
<tr><td><code id="log_llh_+3A_sharedtype_cr">sharedtype_CR</code></td>
<td>
<p>vector : dependence structure for competing risk survival model : &quot;RE&quot; (random effects) or &quot;CV&quot; (current value) or &quot;CVS&quot; (current value and slope) or &quot;S&quot; (slope)</p>
</td></tr>
<tr><td><code id="log_llh_+3A_hazard_baseline">hazard_baseline</code></td>
<td>
<p>char : baseline hazard function : &quot;Exponential&quot; or &quot;Weibull&quot; or &quot;Splines&quot;</p>
</td></tr>
<tr><td><code id="log_llh_+3A_hazard_baseline_cr">hazard_baseline_CR</code></td>
<td>
<p>char : baseline hazard function, competing risk : &quot;Exponential&quot; or &quot;Weibull&quot; or &quot;Splines&quot;</p>
</td></tr>
<tr><td><code id="log_llh_+3A_ord.splines">ord.splines</code></td>
<td>
<p>integer : the order of splines function for baseline hazard function</p>
</td></tr>
<tr><td><code id="log_llh_+3A_xtime">Xtime</code></td>
<td>
<p>matrix : fixed effects at event time</p>
</td></tr>
<tr><td><code id="log_llh_+3A_utime">Utime</code></td>
<td>
<p>matrix : RE at event time</p>
</td></tr>
<tr><td><code id="log_llh_+3A_nb_pointsgk">nb_pointsGK</code></td>
<td>
<p>integer : number of points for Gauss-Kronrod approximation, 7 or 15 (default)</p>
</td></tr>
<tr><td><code id="log_llh_+3A_xs">Xs</code></td>
<td>
<p>matrix : fixed effects at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_us">Us</code></td>
<td>
<p>matrix : RE at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_xslope">Xslope</code></td>
<td>
<p>matrix : fixed effects of slope at event times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_uslope">Uslope</code></td>
<td>
<p>matrix : RE of slope at event times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_xs.slope">Xs.slope</code></td>
<td>
<p>matrix : fixed effects of slope at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_us.slope">Us.slope</code></td>
<td>
<p>matrix : RE of slope at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_indices_beta_slope">indices_beta_slope</code></td>
<td>
<p>vector : position of beta which will be used in the slope computation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_time">Time</code></td>
<td>
<p>vector : observed event times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_st_calc">st_calc</code></td>
<td>
<p>matrix : Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_b">B</code></td>
<td>
<p>matrix : splines for baseline hazard function of event 1</p>
</td></tr>
<tr><td><code id="log_llh_+3A_bs">Bs</code></td>
<td>
<p>matrix : splines for baseline survival function of event 1</p>
</td></tr>
<tr><td><code id="log_llh_+3A_wk">wk</code></td>
<td>
<p>vector : Gauss-Kronrod weights</p>
</td></tr>
<tr><td><code id="log_llh_+3A_z">Z</code></td>
<td>
<p>matrix : covariates for survival function of event 1</p>
</td></tr>
<tr><td><code id="log_llh_+3A_p">P</code></td>
<td>
<p>vector : Time/2</p>
</td></tr>
<tr><td><code id="log_llh_+3A_left_trunc">left_trunc</code></td>
<td>
<p>boolean : left truncation indicator</p>
</td></tr>
<tr><td><code id="log_llh_+3A_z_cr">Z_CR</code></td>
<td>
<p>matrix : covariates for survival function of event 2</p>
</td></tr>
<tr><td><code id="log_llh_+3A_x_base">X_base</code></td>
<td>
<p>matrix : fixed effects for longitudinal submodel</p>
</td></tr>
<tr><td><code id="log_llh_+3A_offset">offset</code></td>
<td>
<p>vector : number of lines per subjects</p>
</td></tr>
<tr><td><code id="log_llh_+3A_u">U</code></td>
<td>
<p>matrix : RE for longitudinal submodel</p>
</td></tr>
<tr><td><code id="log_llh_+3A_y.new.prog">y.new.prog</code></td>
<td>
<p>vector : y measures for longitudinal submodel</p>
</td></tr>
<tr><td><code id="log_llh_+3A_event1">event1</code></td>
<td>
<p>vector : event 1 indicator</p>
</td></tr>
<tr><td><code id="log_llh_+3A_event2">event2</code></td>
<td>
<p>vector : event 2 indicator</p>
</td></tr>
<tr><td><code id="log_llh_+3A_ind">Ind</code></td>
<td>
<p>integer : number of subjects</p>
</td></tr>
<tr><td><code id="log_llh_+3A_xs.0">Xs.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_us.0">Us.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_xs.slope.0">Xs.slope.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_us.slope.0">Us.slope.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_p.0">P.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_st.0">st.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_bs.0">Bs.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_b.cr">B.CR</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_bs.cr">Bs.CR</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_bs.0.cr">Bs.0.CR</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_nb.e.a.sigma">nb.e.a.sigma</code></td>
<td>
<p>integer : number of RE for variability</p>
</td></tr>
<tr><td><code id="log_llh_+3A_nb.omega">nb.omega</code></td>
<td>
<p>integer : number of fixed effects for variability</p>
</td></tr>
<tr><td><code id="log_llh_+3A_otime">Otime</code></td>
<td>
<p>matrix : fixed effects of variability at event time</p>
</td></tr>
<tr><td><code id="log_llh_+3A_wtime">Wtime</code></td>
<td>
<p>matrix : RE of variability at event time</p>
</td></tr>
<tr><td><code id="log_llh_+3A_os">Os</code></td>
<td>
<p>matrix : fixed effects of variability at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_ws">Ws</code></td>
<td>
<p>matrix : random effects of variability at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_+3A_o_base">O_base</code></td>
<td>
<p>matrix : fixed effects for variability</p>
</td></tr>
<tr><td><code id="log_llh_+3A_w_base">W_base</code></td>
<td>
<p>matrix : fixed effects for variability</p>
</td></tr>
<tr><td><code id="log_llh_+3A_correlated_re">correlated_re</code></td>
<td>
<p>boolean : indicator to allow all the random effects to be correlated</p>
</td></tr>
<tr><td><code id="log_llh_+3A_os.0">Os.0</code></td>
<td>
<p>matrix : same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_+3A_ws.0">Ws.0</code></td>
<td>
<p>matrix : same for left truncation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the log-likelihood
</p>

<hr>
<h2 id='log_llh_rcpp'>Log-likelihood computation in RCPP</h2><span id='topic+log_llh_rcpp'></span>

<h3>Description</h3>

<p>Log-likelihood computation in RCPP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_llh_rcpp(
  param,
  nb.e.a,
  nb.priorMean.beta,
  nb.alpha,
  competing_risk,
  nb.alpha.CR,
  variability_hetero,
  S,
  Zq,
  sharedtype,
  sharedtype_CR,
  hazard_baseline,
  hazard_baseline_CR,
  ord.splines,
  Xtime,
  Utime,
  nb_pointsGK,
  Xs,
  Us,
  Xslope,
  Uslope,
  Xs.slope,
  Us.slope,
  indices_beta_slope,
  Time,
  st_calc,
  B,
  Bs,
  wk,
  Z,
  P,
  left_trunc,
  Z_CR,
  X_base,
  offset,
  U,
  y.new.prog,
  event1,
  event2,
  Ind,
  Xs.0,
  Us.0,
  Xs.slope.0,
  Us.slope.0,
  P.0,
  st.0,
  Bs.0,
  B.CR,
  Bs.CR,
  Bs.0.CR,
  nb.e.a.sigma = nb.e.a.sigma,
  nb.omega = nb.omega,
  Otime = Otime,
  Wtime = Wtime,
  Os = Os,
  Ws = Ws,
  O_base = O_base,
  W_base = W_base,
  correlated_re = correlated_re,
  Os.0 = Os.0,
  Ws.0 = Ws.0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_llh_rcpp_+3A_param">param</code></td>
<td>
<p>a vector : paramaters to be estimated</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_nb.e.a">nb.e.a</code></td>
<td>
<p>integer : number of RE</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_nb.priormean.beta">nb.priorMean.beta</code></td>
<td>
<p>integer : number of fixed effects</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_nb.alpha">nb.alpha</code></td>
<td>
<p>integer : number of covariates in survival model</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_competing_risk">competing_risk</code></td>
<td>
<p>boolean : allow competing risk or not, FALSE by default</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_nb.alpha.cr">nb.alpha.CR</code></td>
<td>
<p>integer : number of covariates in survival model for competing risks</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_variability_hetero">variability_hetero</code></td>
<td>
<p>boolean : allow the heterogeneous variability or not</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_s">S</code></td>
<td>
<p>integer : the number of QMC points</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_zq">Zq</code></td>
<td>
<p>vector : sobol points</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_sharedtype">sharedtype</code></td>
<td>
<p>vector : dependence structure for survival model : &quot;RE&quot; (random effects) or &quot;CV&quot; (current value) or &quot;CVS&quot; (current value and slope) or &quot;S&quot; (slope)</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_sharedtype_cr">sharedtype_CR</code></td>
<td>
<p>vector : dependence structure for competing risk survival model : &quot;RE&quot; (random effects) or &quot;CV&quot; (current value) or &quot;CVS&quot; (current value and slope) or &quot;S&quot; (slope)</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_hazard_baseline">hazard_baseline</code></td>
<td>
<p>char : baseline hazard function : &quot;Exponential&quot; or &quot;Weibull&quot; or &quot;Splines&quot;</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_hazard_baseline_cr">hazard_baseline_CR</code></td>
<td>
<p>char : baseline hazard function, competing risk : &quot;Exponential&quot; or &quot;Weibull&quot; or &quot;Splines&quot;</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_ord.splines">ord.splines</code></td>
<td>
<p>integer : the order of splines function for baseline hazard function</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_xtime">Xtime</code></td>
<td>
<p>matrix : fixed effects at event time</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_utime">Utime</code></td>
<td>
<p>matrix : RE at event time</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_nb_pointsgk">nb_pointsGK</code></td>
<td>
<p>integer : number of points for Gauss-Kronrod approximation, 7 or 15 (default)</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_xs">Xs</code></td>
<td>
<p>matrix : fixed effects at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_us">Us</code></td>
<td>
<p>matrix : RE at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_xslope">Xslope</code></td>
<td>
<p>matrix : fixed effects of slope at event times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_uslope">Uslope</code></td>
<td>
<p>matrix : RE of slope at event times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_xs.slope">Xs.slope</code></td>
<td>
<p>matrix : fixed effects of slope at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_us.slope">Us.slope</code></td>
<td>
<p>matrix : RE of slope at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_indices_beta_slope">indices_beta_slope</code></td>
<td>
<p>vector : position of beta which will be used in the slope computation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_time">Time</code></td>
<td>
<p>vector : observed event times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_st_calc">st_calc</code></td>
<td>
<p>matrix : Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_b">B</code></td>
<td>
<p>matrix : splines for baseline hazard function of event 1</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_bs">Bs</code></td>
<td>
<p>matrix : splines for baseline survival function of event 1</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_wk">wk</code></td>
<td>
<p>vector : Gauss-Kronrod weights</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_z">Z</code></td>
<td>
<p>matrix : covariates for survival function of event 1</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_p">P</code></td>
<td>
<p>vector : Time/2</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_left_trunc">left_trunc</code></td>
<td>
<p>boolean : left truncation indicator</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_z_cr">Z_CR</code></td>
<td>
<p>matrix : covariates for survival function of event 2</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_x_base">X_base</code></td>
<td>
<p>matrix : fixed effects for longitudinal submodel</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_offset">offset</code></td>
<td>
<p>vector : number of lines per subjects</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_u">U</code></td>
<td>
<p>matrix : RE for longitudinal submodel</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_y.new.prog">y.new.prog</code></td>
<td>
<p>vector : y measures for longitudinal submodel</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_event1">event1</code></td>
<td>
<p>vector : event 1 indicator</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_event2">event2</code></td>
<td>
<p>vector : event 2 indicator</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_ind">Ind</code></td>
<td>
<p>integer : number of subjects</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_xs.0">Xs.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_us.0">Us.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_xs.slope.0">Xs.slope.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_us.slope.0">Us.slope.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_p.0">P.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_st.0">st.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_bs.0">Bs.0</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_b.cr">B.CR</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_bs.cr">Bs.CR</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_bs.0.cr">Bs.0.CR</code></td>
<td>
<p>same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_nb.e.a.sigma">nb.e.a.sigma</code></td>
<td>
<p>integer : number of RE for variability</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_nb.omega">nb.omega</code></td>
<td>
<p>integer : number of fixed effects for variability</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_otime">Otime</code></td>
<td>
<p>matrix : fixed effects of variability at event time</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_wtime">Wtime</code></td>
<td>
<p>matrix : RE of variability at event time</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_os">Os</code></td>
<td>
<p>matrix : fixed effects of variability at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_ws">Ws</code></td>
<td>
<p>matrix : random effects of variability at Gauss-Kronrod times</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_o_base">O_base</code></td>
<td>
<p>matrix : fixed effects for variability</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_w_base">W_base</code></td>
<td>
<p>matrix : fixed effects for variability</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_correlated_re">correlated_re</code></td>
<td>
<p>boolean : indicator to allow all the random effects to be correlated</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_os.0">Os.0</code></td>
<td>
<p>matrix : same for left truncation</p>
</td></tr>
<tr><td><code id="log_llh_rcpp_+3A_ws.0">Ws.0</code></td>
<td>
<p>matrix : same for left truncation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the log-likelihood
</p>

<hr>
<h2 id='lsjm'>lsjm : Estimation of joint model for longitudinal data with a subject-specific time-dependent variability and time-to-event data.</h2><span id='topic+lsjm'></span>

<h3>Description</h3>

<p>This function fits complex joint models with shared random effects.
The longitudinal submodel estimates longitudinal data with a mixed-effects model in which
we suppose that the variance of the residual error is time-dependent and subject-specific.
The survival submodel handles right-censored and left-truncated time-to-event data and competing risks.
The dependence structure between the longitudinal and the survival data can be the random effects from the mixed
model or the current value of the marker and/or the slope of the marker. We can also adjust on the current variance of the marker.
(See below)
Parameters are estimated simultaneously through a maximum likelihood method, using a Marquardt-Levenberg algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsjm(
  formFixed,
  formRandom,
  formGroup,
  formSurv,
  timeVar,
  data.long,
  variability_hetero = TRUE,
  formFixedVar,
  formRandomVar,
  correlated_re = FALSE,
  sharedtype = c("current value", "variability"),
  hazard_baseline = "Exponential",
  formSlopeFixed = NULL,
  formSlopeRandom = NULL,
  indices_beta_slope = NULL,
  nb_pointsGK = 15,
  ord.splines = 3,
  competing_risk = FALSE,
  formSurv_CR = NULL,
  hazard_baseline_CR = "Exponential",
  sharedtype_CR = c("current value", "variability"),
  left_trunc = FALSE,
  Time.0 = NULL,
  S1 = 1000,
  S2 = 5000,
  nproc = 1,
  clustertype = "SOCK",
  maxiter = 100,
  print.info = FALSE,
  file = NULL,
  epsa = 0.001,
  epsb = 0.001,
  epsd = 0.001,
  binit = NULL,
  Comp.Rcpp = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lsjm_+3A_formfixed">formFixed</code></td>
<td>
<p>A formula for the fixed effects of the longitudinal submodel</p>
</td></tr>
<tr><td><code id="lsjm_+3A_formrandom">formRandom</code></td>
<td>
<p>A formula for the random effects of the longitudinal submodel</p>
</td></tr>
<tr><td><code id="lsjm_+3A_formgroup">formGroup</code></td>
<td>
<p>A formula which indicates the group variable</p>
</td></tr>
<tr><td><code id="lsjm_+3A_formsurv">formSurv</code></td>
<td>
<p>A formula which indicates the variables used in the survival submodel</p>
</td></tr>
<tr><td><code id="lsjm_+3A_timevar">timeVar</code></td>
<td>
<p>The name of the column of time in data.long. This variable must appears in data.long</p>
</td></tr>
<tr><td><code id="lsjm_+3A_data.long">data.long</code></td>
<td>
<p>A dataframe with the longitudinal data</p>
</td></tr>
<tr><td><code id="lsjm_+3A_variability_hetero">variability_hetero</code></td>
<td>
<p>A logical to indicate if we suppose a subject_specific variability</p>
</td></tr>
<tr><td><code id="lsjm_+3A_formfixedvar">formFixedVar</code></td>
<td>
<p>A formula for the fixed effects of the variance predictor</p>
</td></tr>
<tr><td><code id="lsjm_+3A_formrandomvar">formRandomVar</code></td>
<td>
<p>A formula for the random effects of the variance predictor</p>
</td></tr>
<tr><td><code id="lsjm_+3A_correlated_re">correlated_re</code></td>
<td>
<p>A logical to indicate if the random effects of the marker and the variance predictors are correlated (By default there are supposed to be independent)</p>
</td></tr>
<tr><td><code id="lsjm_+3A_sharedtype">sharedtype</code></td>
<td>
<p>char : dependence structure for survival model : &quot;RE&quot; (random effects) or &quot;CV&quot; (current value) or &quot;CVS&quot; (current value and slope) or &quot;S&quot; (slope)</p>
</td></tr>
<tr><td><code id="lsjm_+3A_hazard_baseline">hazard_baseline</code></td>
<td>
<p>char : baseline hazard function : &quot;Exponential&quot; or &quot;Weibull&quot; or &quot;Splines&quot;</p>
</td></tr>
<tr><td><code id="lsjm_+3A_formslopefixed">formSlopeFixed</code></td>
<td>
<p>A formula for the fixed effects of the slope of the longitudinal submodel : the derivative of the formFixed</p>
</td></tr>
<tr><td><code id="lsjm_+3A_formsloperandom">formSlopeRandom</code></td>
<td>
<p>A formula for the random effects of the slope of the longitudinal submodel : the derivative of the formRandom</p>
</td></tr>
<tr><td><code id="lsjm_+3A_indices_beta_slope">indices_beta_slope</code></td>
<td>
<p>A vector of index indicating which beta of the formFixed formula is used in the formSlopeFixed formula</p>
</td></tr>
<tr><td><code id="lsjm_+3A_nb_pointsgk">nb_pointsGK</code></td>
<td>
<p>the number of points for Gauss-Kronrod approximation : choice between 7 and 15. 15 by default.</p>
</td></tr>
<tr><td><code id="lsjm_+3A_ord.splines">ord.splines</code></td>
<td>
<p>A numeric, the order of splines for the baseline risk function (3 by default)</p>
</td></tr>
<tr><td><code id="lsjm_+3A_competing_risk">competing_risk</code></td>
<td>
<p>A logical indicating if the model handles with competing risks</p>
</td></tr>
<tr><td><code id="lsjm_+3A_formsurv_cr">formSurv_CR</code></td>
<td>
<p>In case of competing risk A formula which indicates the variables used in the survival submodel for the second event</p>
</td></tr>
<tr><td><code id="lsjm_+3A_hazard_baseline_cr">hazard_baseline_CR</code></td>
<td>
<p>In case of competing risk : a character for the baseline hazard function of the second event</p>
</td></tr>
<tr><td><code id="lsjm_+3A_sharedtype_cr">sharedtype_CR</code></td>
<td>
<p>In case of competing risk ; a character for the dependence structure</p>
</td></tr>
<tr><td><code id="lsjm_+3A_left_trunc">left_trunc</code></td>
<td>
<p>A logical indicating if the model handles with left truncated data</p>
</td></tr>
<tr><td><code id="lsjm_+3A_time.0">Time.0</code></td>
<td>
<p>In case of left truncation : a vector of entry times</p>
</td></tr>
<tr><td><code id="lsjm_+3A_s1">S1</code></td>
<td>
<p>An integer : the number of QMC draws for the first step</p>
</td></tr>
<tr><td><code id="lsjm_+3A_s2">S2</code></td>
<td>
<p>An integer : the number of QMC draws for the second step</p>
</td></tr>
<tr><td><code id="lsjm_+3A_nproc">nproc</code></td>
<td>
<p>An integer : the number of processors for parallel computing</p>
</td></tr>
<tr><td><code id="lsjm_+3A_clustertype">clustertype</code></td>
<td>
<p>one of the supported types from <code>makeCluster</code> function</p>
</td></tr>
<tr><td><code id="lsjm_+3A_maxiter">maxiter</code></td>
<td>
<p>optional maximum number of iterations for the marqLevAlg iterative algorithm.</p>
</td></tr>
<tr><td><code id="lsjm_+3A_print.info">print.info</code></td>
<td>
<p>logical indicating if the outputs of each iteration should be written</p>
</td></tr>
<tr><td><code id="lsjm_+3A_file">file</code></td>
<td>
<p>optional character giving the name of the file where the outputs of each iteration should be written (if print.info=TRUE)</p>
</td></tr>
<tr><td><code id="lsjm_+3A_epsa">epsa</code></td>
<td>
<p>optional threshold for the convergence criterion based on the parameter stability.</p>
</td></tr>
<tr><td><code id="lsjm_+3A_epsb">epsb</code></td>
<td>
<p>optional threshold for the convergence criterion based on the objective function stability.</p>
</td></tr>
<tr><td><code id="lsjm_+3A_epsd">epsd</code></td>
<td>
<p>optional threshold for the relative distance to maximum. This criterion has the nice interpretation of estimating the ratio of the approximation error over the statistical error, thus it can be used for stopping the iterative process whatever the problem.</p>
</td></tr>
<tr><td><code id="lsjm_+3A_binit">binit</code></td>
<td>
<p>optional initials parameters.</p>
</td></tr>
<tr><td><code id="lsjm_+3A_comp.rcpp">Comp.Rcpp</code></td>
<td>
<p>boolean to indicate if the computation is performed with RCPP program or R program. True by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A. LONGITUDINAL SUBMODEL
</p>
<p>The longitudinal submodel is defined by a linear mixed effects model with the residual variance which could be supposed to be time-dependent and subject-specific :
<code class="reqn">\quad\left\{\begin{array}{ll}
Y_{ij} = Y_{i}(t_{ij}) = \widetilde{Y}_i(t_{ij}) + \epsilon_{ij} = X_{ij}^{\top} \beta+Z_{ij}^{\top} b_{i}+\epsilon_{ij}, \\
\epsilon_{ij}(t_{ij}) \sim \mathcal{N}(0,\sigma_i^2(t_{ij})) \hspace{3mm} \text{with} \hspace{3mm} \log(\sigma_i(t_{ij}))  = O_{ij}^{\top} \mu+M_{ij}^{\top} \tau_{i}
\end{array}
\right.</code>
</p>


<h4>with <code class="reqn">X_{ij}</code>, <code class="reqn">O_{ij}</code>, <code class="reqn">Z_{ij}</code> and <code class="reqn">M_{ij}</code> four vectors of explanatory variables for subject <code class="reqn">i</code> at visit <code class="reqn">j</code>,
respectively associated with the fixed-effect vectors <code class="reqn">\beta</code> and <code class="reqn">\mu</code>, and the subject-specific random-effect vector <code class="reqn">b_i</code> and <code class="reqn">\tau_i</code>, such as
<code class="reqn">\quad\left(\begin{array}{c}
             b_{i} \\
             \tau_i
             \end{array}\right) \sim N\left(\left(\begin{array}{c}
                                                  0 \\
                                                  0
                                                  \end{array}\right),\left(\begin{array}{cc}
                                                                           \Sigma_{b} &amp; \Sigma_{\tau b} \\
                                                                           \Sigma_{\tau b}' &amp; \Sigma_{\tau}
\end{array}\right)\right)</code></h4>

<p><code class="reqn">Y_{i}(t_{ij}) = \tilde{Y}_i(t_{ij}) + \epsilon_{ij} = X_{ij}^{\top} \beta+Z_{ij}^{\top} b_{i}+\epsilon_{ij}</code>
</p>
<p>with <code class="reqn">X_{ij}</code> and <code class="reqn">Z_{ij}</code> two covariate vectors for subject i at visit j,
respectively associated with the vector of fixed effects <code class="reqn">\beta</code> and the vector of
subject-specific individual random effects <code class="reqn">b_i</code>.
The vector <code class="reqn">b_i</code> is assumed to be normally distributed and a specific-subject random effect on the
variance of the measure error can be added: <code class="reqn">\epsilon_{ij} \sim \mathcal{N}(0,\sigma_i^2)</code> and
</p>
<p><code class="reqn">\quad\left(\begin{array}{c}
b_{i} \\
\log \sigma_{i}
\end{array}\right) \sim \mathcal{N}\left(\left(\begin{array}{c}
                                               0 \\
                                               \mu_{\sigma}
                                               \end{array}\right),\left(\begin{array}{cc}
                                                                        \Sigma_{b} &amp; 0 \\
                                                                        0 &amp; \tau_{\sigma}^{2}
                                                                        \end{array}\right)\right)</code>
</p>
<p>B. SURVIVAL SUBMODEL
</p>
<p>The risk function for the event $k = {1,2}$ is defined by:
<code class="reqn">\lambda_{ik}(t)=\lambda_{0k}(t) \exp \left(W_{i}^{\top} \gamma_{k}+\alpha_{1k}\tilde{y}_i(t)+\\
\alpha_{2k}\tilde{y}'_i(t)+ \alpha_{\sigma k} \sigma_i(t) \right)</code>
</p>
<p>with <code class="reqn">\lambda_{0k}(t)</code> the baseline risk function, <code class="reqn">W_{i}</code> a vector of baseline covariates associated with the regression coefficient <code class="reqn">\gamma_k</code>,
and <code class="reqn">\alpha_{1k}</code>, <code class="reqn">\alpha_{2k}</code> and <code class="reqn">\alpha_{\sigma k}</code> the regression coefficients associated with the current value <code class="reqn">\tilde{y}_i(t)</code>,
the current slope <code class="reqn">\tilde{y}'_i(t)</code> and the current variability <code class="reqn">\sigma_i(t)</code> of the marker, respectively.
Different parametric forms for the baseline risk function can be considered, such as exponential, Weibull, or, for more flexibility, a B-splines base.
</p>



<h3>Value</h3>

<p>A FlexVarJoint object which contains the following elements :
</p>

<dl>
<dt><code>result</code></dt><dd><p>A marqLevAlg object with the results of the estimation.</p>
</dd>
<dt><code>table.res</code></dt><dd><p>The table of results : Estimation and SE</p>
</dd>
<dt><code>time.compute</code></dt><dd><p>Computation time</p>
</dd>
<dt><code>control</code></dt><dd><p>A list of control elements</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>




#fit a joint model with competing risks and subject-specific variability
example &lt;- lsjm(formFixed = y~visit,
formRandom = ~ visit,
formGroup = ~ID,
formSurv = Surv(time, event ==1 ) ~ 1,
timeVar = "visit",
data.long = Data_toy,
variability_hetero = TRUE,
formFixedVar =~visit,
formRandomVar =~visit,
correlated_re = TRUE,
sharedtype = c("current value", "variability"),
hazard_baseline = "Weibull",
formSlopeFixed =~1,
formSlopeRandom = ~1,
indices_beta_slope = c(2), 
competing_risk = TRUE,
formSurv_CR = Surv(time, event ==2 ) ~ 1,
hazard_baseline_CR = "Weibull",
sharedtype_CR = c("current value", "variability"),
S1 = 100,
S2 = 1000,
nproc = 1,
maxiter = 100,
Comp.Rcpp = TRUE
)
 
summary(example)


</code></pre>

<hr>
<h2 id='lsmm'>lsmm : Estimation of location scale mixed model</h2><span id='topic+lsmm'></span>

<h3>Description</h3>

<p>This function fits complex mixed effects model with a time and covariate dependent variance.
We suppose that the variance of the residual error is time-dependent and subject-specific.
Parameters are estimated simultaneously through a maximum likelihood method, using a Marquardt-Levenberg algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsmm(
  formFixed,
  formRandom,
  formGroup,
  timeVar,
  data.long,
  variability_hetero = TRUE,
  formFixedVar,
  formRandomVar,
  correlated_re = FALSE,
  S1 = 1000,
  S2 = 5000,
  nproc = 1,
  clustertype = "SOCK",
  maxiter = 100,
  print.info = FALSE,
  file = NULL,
  epsa = 0.001,
  epsb = 0.001,
  epsd = 0.001,
  binit = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lsmm_+3A_formfixed">formFixed</code></td>
<td>
<p>A formula for the fixed effects of the longitudinal submodel</p>
</td></tr>
<tr><td><code id="lsmm_+3A_formrandom">formRandom</code></td>
<td>
<p>A formula for the random effects of the longitudinal submodel</p>
</td></tr>
<tr><td><code id="lsmm_+3A_formgroup">formGroup</code></td>
<td>
<p>A formula which indicates the group variable</p>
</td></tr>
<tr><td><code id="lsmm_+3A_timevar">timeVar</code></td>
<td>
<p>The name of the column of time in data.long. This variable must appears in data.long</p>
</td></tr>
<tr><td><code id="lsmm_+3A_data.long">data.long</code></td>
<td>
<p>A dataframe with the longitudinal data</p>
</td></tr>
<tr><td><code id="lsmm_+3A_variability_hetero">variability_hetero</code></td>
<td>
<p>A logical to indicate if we suppose a subject_specific variability</p>
</td></tr>
<tr><td><code id="lsmm_+3A_formfixedvar">formFixedVar</code></td>
<td>
<p>A formula for the fixed effects of the variance predictor</p>
</td></tr>
<tr><td><code id="lsmm_+3A_formrandomvar">formRandomVar</code></td>
<td>
<p>A formula for the random effects of the variance predictor</p>
</td></tr>
<tr><td><code id="lsmm_+3A_correlated_re">correlated_re</code></td>
<td>
<p>A logical to indicate if the random effects of the marker and the variance predictors are correlated (By default there are supposed to be independent)</p>
</td></tr>
<tr><td><code id="lsmm_+3A_s1">S1</code></td>
<td>
<p>An integer : the number of QMC draws for the first step</p>
</td></tr>
<tr><td><code id="lsmm_+3A_s2">S2</code></td>
<td>
<p>An integer : the number of QMC draws for the second step</p>
</td></tr>
<tr><td><code id="lsmm_+3A_nproc">nproc</code></td>
<td>
<p>An integer : the number of processors for parallel computing</p>
</td></tr>
<tr><td><code id="lsmm_+3A_clustertype">clustertype</code></td>
<td>
<p>one of the supported types from <code>makeCluster</code> function</p>
</td></tr>
<tr><td><code id="lsmm_+3A_maxiter">maxiter</code></td>
<td>
<p>optional maximum number of iterations for the marqLevAlg iterative algorithm.</p>
</td></tr>
<tr><td><code id="lsmm_+3A_print.info">print.info</code></td>
<td>
<p>logical indicating if the outputs of each iteration should be written</p>
</td></tr>
<tr><td><code id="lsmm_+3A_file">file</code></td>
<td>
<p>optional character giving the name of the file where the outputs of each iteration should be written (if print.info=TRUE)</p>
</td></tr>
<tr><td><code id="lsmm_+3A_epsa">epsa</code></td>
<td>
<p>optional threshold for the convergence criterion based on the parameter stability.</p>
</td></tr>
<tr><td><code id="lsmm_+3A_epsb">epsb</code></td>
<td>
<p>optional threshold for the convergence criterion based on the objective function stability.</p>
</td></tr>
<tr><td><code id="lsmm_+3A_epsd">epsd</code></td>
<td>
<p>optional threshold for the relative distance to maximum. This criterion has the nice interpretation of estimating the ratio of the approximation error over the statistical error, thus it can be used for stopping the iterative process whatever the problem.</p>
</td></tr>
<tr><td><code id="lsmm_+3A_binit">binit</code></td>
<td>
<p>optional initials parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is defined by :
#' <code class="reqn">\quad\left\{\begin{array}{ll}
Y_{ij} = Y_{i}(t_{ij}) = \widetilde{Y}_i(t_{ij}) + \epsilon_{ij} = X_{ij}^{\top} \beta+Z_{ij}^{\top} b_{i}+\epsilon_{ij}, \\
\epsilon_{ij}(t_{ij}) \sim \mathcal{N}(0,\sigma_i^2(t_{ij})) \hspace{3mm} \text{with} \hspace{3mm} \log(\sigma_i(t_{ij}))  = O_{ij}^{\top} \mu+M_{ij}^{\top} \tau_{i}
\end{array}
\right.</code>
</p>


<h4>with <code class="reqn">X_{ij}</code>, <code class="reqn">O_{ij}</code>, <code class="reqn">Z_{ij}</code> and <code class="reqn">M_{ij}</code> four vectors of explanatory variables for subject <code class="reqn">i</code> at visit <code class="reqn">j</code>,
respectively associated with the fixed-effect vectors <code class="reqn">\beta</code> and <code class="reqn">\mu</code>, and the subject-specific random-effect vector <code class="reqn">b_i</code> and <code class="reqn">\tau_i</code>, such as
<code class="reqn">\quad\left(\begin{array}{c}
             b_{i} \\
             \tau_i
             \end{array}\right) \sim N\left(\left(\begin{array}{c}
                                                  0 \\
                                                  0
                                                  \end{array}\right),\left(\begin{array}{cc}
                                                                           \Sigma_{b} &amp; \Sigma_{\tau b} \\
                                                                           \Sigma_{\tau b}' &amp; \Sigma_{\tau}
\end{array}\right)\right)</code></h4>

<p><code class="reqn">Y_{i}(t_{ij}) = \tilde{Y}_i(t_{ij}) + \epsilon_{ij} = X_{ij}^{\top} \beta+Z_{ij}^{\top} b_{i}+\epsilon_{ij}</code>
</p>
<p>with <code class="reqn">X_{ij}</code> and <code class="reqn">Z_{ij}</code> two covariate vectors for subject i at visit j,
respectively associated with the vector of fixed effects <code class="reqn">\beta</code> and the vector of
subject-specific individual random effects <code class="reqn">b_i</code>.
The vector <code class="reqn">b_i</code> is assumed to be normally distributed and a specific-subject random effect on the
variance of the measure error can be added: <code class="reqn">\epsilon_{ij} \sim \mathcal{N}(0,\sigma_i^2)</code> and
</p>
<p><code class="reqn">\quad\left(\begin{array}{c}
b_{i} \\
\log \sigma_{i}
\end{array}\right) \sim \mathcal{N}\left(\left(\begin{array}{c}
                                               0 \\
                                               \mu_{\sigma}
                                               \end{array}\right),\left(\begin{array}{cc}
                                                                        \Sigma_{b} &amp; 0 \\
                                                                        0 &amp; \tau_{\sigma}^{2}
                                                                        \end{array}\right)\right)</code>
</p>



<h3>Value</h3>

<p>A FlexVarJoint object which contains the following elements :
</p>

<dl>
<dt><code>result</code></dt><dd><p>A marqLevAlg object with the results of the estimation.</p>
</dd>
<dt><code>table.res</code></dt><dd><p>The table of results : Estimation and SE</p>
</dd>
<dt><code>time.compute</code></dt><dd><p>Computation time</p>
</dd>
<dt><code>control</code></dt><dd><p>A list of control elements</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>



#fit a joint model with competing risks and subject-specific variability
example &lt;- lsmm(formFixed = y~visit,
formRandom = ~ visit,
formGroup = ~ID,
timeVar = "visit",
data.long = Data_toy,
variability_hetero = TRUE,
formFixedVar =~visit,
formRandomVar =~visit,
correlated_re = TRUE,
S1 = 100,
S2 = 1000,
nproc = 1,
maxiter = 100
)

summary(example)


</code></pre>

<hr>
<h2 id='pred_s.t.bootstrap.tps'>Predictions computation</h2><span id='topic+pred_s.t.bootstrap.tps'></span>

<h3>Description</h3>

<p>Predictions computation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_s.t.bootstrap.tps(newdata, object, s, window, event = 1, nb.draws)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_s.t.bootstrap.tps_+3A_newdata">newdata</code></td>
<td>
<p>data frame : collected data for a new individual</p>
</td></tr>
<tr><td><code id="pred_s.t.bootstrap.tps_+3A_object">object</code></td>
<td>
<p>lsjm object : estimation of the model</p>
</td></tr>
<tr><td><code id="pred_s.t.bootstrap.tps_+3A_s">s</code></td>
<td>
<p>numeric : the time to begin prediction</p>
</td></tr>
<tr><td><code id="pred_s.t.bootstrap.tps_+3A_window">window</code></td>
<td>
<p>numeric : the side of the prediction window</p>
</td></tr>
<tr><td><code id="pred_s.t.bootstrap.tps_+3A_event">event</code></td>
<td>
<p>integer (0, 1 or 2) : the event of interest for the prediction</p>
</td></tr>
<tr><td><code id="pred_s.t.bootstrap.tps_+3A_nb.draws">nb.draws</code></td>
<td>
<p>integer : the number of draws to compute the IC</p>
</td></tr>
</table>

<hr>
<h2 id='pred_s.t.ponctuel.tps'>Predictions computation</h2><span id='topic+pred_s.t.ponctuel.tps'></span>

<h3>Description</h3>

<p>Predictions computation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_s.t.ponctuel.tps(newdata, object, s, window, event = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_s.t.ponctuel.tps_+3A_newdata">newdata</code></td>
<td>
<p>data frame : collected data for a new individual</p>
</td></tr>
<tr><td><code id="pred_s.t.ponctuel.tps_+3A_object">object</code></td>
<td>
<p>lsjm object : estimation of the model</p>
</td></tr>
<tr><td><code id="pred_s.t.ponctuel.tps_+3A_s">s</code></td>
<td>
<p>numeric : the time to begin prediction</p>
</td></tr>
<tr><td><code id="pred_s.t.ponctuel.tps_+3A_window">window</code></td>
<td>
<p>numeric : the side of the prediction window</p>
</td></tr>
<tr><td><code id="pred_s.t.ponctuel.tps_+3A_event">event</code></td>
<td>
<p>integer (0, 1 or 2) : the event of interest for the prediction</p>
</td></tr>
</table>

<hr>
<h2 id='predyn'>Dynamic prediction for new individuals</h2><span id='topic+predyn'></span>

<h3>Description</h3>

<p>Dynamic prediction for new individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predyn(
  newdata,
  object,
  s,
  times,
  event = 1,
  IC = 95,
  nb.draws = 500,
  graph = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predyn_+3A_newdata">newdata</code></td>
<td>
<p>data frame : collected data for a new individual</p>
</td></tr>
<tr><td><code id="predyn_+3A_object">object</code></td>
<td>
<p>lsjm object : estimation of the model</p>
</td></tr>
<tr><td><code id="predyn_+3A_s">s</code></td>
<td>
<p>numeric : the time to begin prediction</p>
</td></tr>
<tr><td><code id="predyn_+3A_times">times</code></td>
<td>
<p>numeric vector : future times to calculate predictions</p>
</td></tr>
<tr><td><code id="predyn_+3A_event">event</code></td>
<td>
<p>integer (0, 1 or 2) : the event of interest for the prediction</p>
</td></tr>
<tr><td><code id="predyn_+3A_ic">IC</code></td>
<td>
<p>integer : percentage of confidence for the interval confidence (between 0 and 100), 95 by default, NULL if no IC</p>
</td></tr>
<tr><td><code id="predyn_+3A_nb.draws">nb.draws</code></td>
<td>
<p>integer : the number of simulations to compute the interval confidence (by bootstrap), 500 by default</p>
</td></tr>
<tr><td><code id="predyn_+3A_graph">graph</code></td>
<td>
<p>boolean : indicator to plot the graphs or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table of dynamic predictions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


#fit a joint model with competing risks and subject-specific variability
example &lt;- lsjm(formFixed = y~visit,
formRandom = ~ visit,
formGroup = ~ID,
formSurv = Surv(time, event ==1 ) ~ 1,
timeVar = "visit",
data.long = Data_toy,
variability_hetero = TRUE,
formFixedVar =~visit,
formRandomVar =~visit,
correlated_re = TRUE,
sharedtype = c("current value", "variability"),
hazard_baseline = "Weibull",
formSlopeFixed =~1,
formSlopeRandom = ~1,
indices_beta_slope = c(2), 
competing_risk = TRUE,
formSurv_CR = Surv(time, event ==2 ) ~ 1,
hazard_baseline_CR = "Weibull",
sharedtype_CR = c("current value", "variability"),
S1 = 100,
S2 = 1000,
nproc = 1,
maxiter = 100,
Comp.Rcpp = TRUE
)

#Prediction for individuals 1 and 3 to experiment the event 1 
#at time 1.5, 2, and 3, given their measurements until time 1:
newdata &lt;- Data_toy[which(Data_toy$ID %in% c(1,3)),]
pred.new &lt;- predyn(newdata,example,1, c(1.5,2,2.8,3), event = 1, IC = 95, 
nb.draws = 100, graph = TRUE)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
