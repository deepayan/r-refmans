<!DOCTYPE html><html><head><title>Help for package PlayerRatings</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PlayerRatings}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aflodds'><p>Australian Football Game Results and Odds</p></a></li>
<li><a href='#elo'><p>The Elo Rating System</p></a></li>
<li><a href='#elom'><p>Multi-player Elo Based Rating System</p></a></li>
<li><a href='#fide'><p>The Elo Rating System Employed By The FIDE</p></a></li>
<li><a href='#glicko'><p>The Glicko Rating System</p></a></li>
<li><a href='#glicko2'><p>The Glicko-2 Rating System</p></a></li>
<li><a href='#hist.rating'><p>Histogram Plotting for a Rating Object</p></a></li>
<li><a href='#kfide'><p>The K Factor Function Used By FIDE</p></a></li>
<li><a href='#kgames'><p>A K Factor Function With Dependence On Number Of Games</p></a></li>
<li><a href='#krating'><p>A K Factor Function With Dependence On Rating</p></a></li>
<li><a href='#kriichi'><p>A multi-player K Factor Function for Riichi Mahjong</p></a></li>
<li><a href='#metrics'><p>Prediction Evaluation</p></a></li>
<li><a href='#plot.rating'><p>Plot Player Features Across Time for a Rating Object</p></a></li>
<li><a href='#predict.rating'><p>Predict Result Of Games Based On Player Ratings</p></a></li>
<li><a href='#riichi'><p>Riichi Mahjong Game Results</p></a></li>
<li><a href='#steph'><p>The Stephenson Rating System</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-02-28</td>
</tr>
<tr>
<td>Title:</td>
<td>Dynamic Updating Methods for Player Ratings Estimation</td>
</tr>
<tr>
<td>Author:</td>
<td>Alec Stephenson and Jeff Sonas.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alec Stephenson &lt;alec_stephenson@hotmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements schemes for estimating player or 
  team skill based on dynamic updating. Implemented methods include 
  Elo, Glicko, Glicko-2 and Stephenson. Contains pdf documentation 
  of a reproducible analysis using approximately two million chess 
  matches. Also contains an Elo based method for multi-player games
  where the result is a placing or a score. This includes zero-sum
  games such as poker and mahjong.</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-01 10:40:59 UTC; ste6an</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-01 15:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='aflodds'>Australian Football Game Results and Odds</h2><span id='topic+aflodds'></span>

<h3>Description</h3>

<p>The <code>aflodds</code> data frame has 675 rows and 9 variables. It
shows the results and betting odds for 675 Australian football 
games played by 18 teams from 26th March 2009 until 24th June
2012.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aflodds</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Date</dt><dd><p>A date object showing the date of the game.</p>
</dd>
<dt>Week</dt><dd><p>The number of weeks since 25th March 2009.</p>
</dd>
<dt>HomeTeam</dt><dd><p>The home team name.</p>
</dd>
<dt>AwayTeam</dt><dd><p>The away team name.</p>
</dd>
<dt>HomeScore</dt><dd><p>The home team score.</p>
</dd>
<dt>AwayScore</dt><dd><p>The home team score.</p>
</dd>
<dt>Score</dt><dd><p>A numeric vector giving the value one, zero or one
half for a home win, an away win or a draw respectively.</p>
</dd>
<dt>HomeOdds</dt><dd><p>The best decimal odds offered for the home team.
This is missing for some earlier games.</p>
</dd>
<dt>AwayOdds</dt><dd><p>The best decimal odds offered for the away team.
This is missing for some earlier games.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Wikipedia and www.oddsportal.com.
</p>

<hr>
<h2 id='elo'>The Elo Rating System</h2><span id='topic+elo'></span><span id='topic+print.rating'></span><span id='topic+summary.rating'></span>

<h3>Description</h3>

<p>Implements the Elo rating system for estimating the relative 
skill level of players in two-player games such as chess. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo(x, status = NULL, init = 2200, gamma = 0, kfac = 27, 
    history = FALSE, sort = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo_+3A_x">x</code></td>
<td>
<p>A data frame containing four variables: (1) a numeric
vector denoting the time period in which the game took place
(2) a numeric or character identifier for player one (3)
a numeric or character identifier for player two and (4)
the result of the game expressed as a number, typically
equal to one for a player one win, zero for a player two
win and one half for a draw.</p>
</td></tr>
<tr><td><code id="elo_+3A_status">status</code></td>
<td>
<p>A data frame with the current status of the
system. If not <code>NULL</code>, this needs to be a data frame 
in the form of the <code>ratings</code> component of the returned 
list, containing variables named <code>Player</code>, <code>Rating</code>,
and optionally <code>Games</code>, <code>Win</code>, <code>Draw</code>, 
<code>Loss</code> and <code>Lag</code>, which are set to zero if not given.</p>
</td></tr>
<tr><td><code id="elo_+3A_init">init</code></td>
<td>
<p>The rating at which to initialize a new player not
appearing in <code>status</code>. Must be a single number. If
different initializations for different players are required,
this can be done using <code>status</code>.</p>
</td></tr>
<tr><td><code id="elo_+3A_gamma">gamma</code></td>
<td>
<p>A player one advantage parameter; either a single
value or a numeric vector equal to the number of rows in 
<code>x</code>. Positive values favour player one, while negative 
values favour player two. This could represent the advantage 
of playing at home, or the advantage of playing white for chess. 
Note that this is not passed to <code><a href="#topic+predict.rating">predict.rating</a></code>, 
which has its own <code>gamma</code> parameter.</p>
</td></tr>
<tr><td><code id="elo_+3A_kfac">kfac</code></td>
<td>
<p>The K factor parameter. Can be a single number or
a vectorized function of two arguments, the first being the
ratings and the second being the number of games played. See
<code><a href="#topic+kfide">kfide</a></code>, <code><a href="#topic+kgames">kgames</a></code>  and
<code><a href="#topic+krating">krating</a></code> for examples.</p>
</td></tr>
<tr><td><code id="elo_+3A_history">history</code></td>
<td>
<p>If <code>TRUE</code> returns the entire history for each 
period in the component <code>history</code> of the returned list.</p>
</td></tr>
<tr><td><code id="elo_+3A_sort">sort</code></td>
<td>
<p>If <code>TRUE</code> sort the results by rating (highest
to lowest). If <code>FALSE</code> sort the results by player.</p>
</td></tr>
<tr><td><code id="elo_+3A_...">...</code></td>
<td>
<p>Passed to the function <code>kfac</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Elo rating system is a simple method for evaluating the skill 
of players. It has been used since around 1960 and is still
employed in various settings. Although the basic form uses only 
the ratings, additional complexity is commonly introduced
by adding a player one advantage parameter and by using different
K factors. A player one advantage parameter has been added to the 
original definition in the reference. A player one advantage 
parameter is also used for prediction purposes in 
<code><a href="#topic+predict.rating">predict.rating</a></code>.
</p>
<p>This implementation has a simple initialization, and allows the 
K factor to depend on both the ratings and the number of games 
played. Default values are roughly optimized the chess data 
analyzed in the file doc/ChessRatings.pdf, using the binomial 
deviance criterion and considering only constant K factors. 
See the function <code><a href="#topic+fide">fide</a></code> for a different 
implementation.
</p>


<h3>Value</h3>

<p>A list object of class <code>"rating"</code> with the following 
components
</p>
<table>
<tr><td><code>ratings</code></td>
<td>
<p>A data frame of the results at the end of the 
final time period. The variables are self explanatory except
for <code>Lag</code>, which represents the number of time periods
since the player last played a game. This is equal to zero
for players who played in the latest time period, and is
also zero for players who have not yet played any games.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>A three dimensional array, or <code>NULL</code> if 
<code>history</code> is <code>FALSE</code>. The row dimension is the 
players, the column dimension is the time periods. 
The third dimension gives different parameters.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The player one advantage parameter.</p>
</td></tr>
<tr><td><code>kfac</code></td>
<td>
<p>The K factor or K factor function.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The character string <code>"Elo"</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Elo, Arpad (1978) 
The Rating of Chessplayers, Past and Present. 
Arco. ISBN 0-668-04721-6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fide">fide</a></code>, <code><a href="#topic+glicko">glicko</a></code>, <code><a href="#topic+kfide">kfide</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>afl &lt;- aflodds[,c(2,3,4,7)]
robj &lt;- elo(afl)
robj

robj &lt;- elo(afl[afl$Week==1,])
for(i in 2:max(afl$Week)) robj &lt;- elo(afl[afl$Week==i,], robj$ratings)
robj
</code></pre>

<hr>
<h2 id='elom'>Multi-player Elo Based Rating System</h2><span id='topic+elom'></span>

<h3>Description</h3>

<p>Implements the Elo based rating system for for multi-player games
where the result is a placing or a score. This includes zero-sum
games such as poker and mahjong. The default arguments used here 
are those used by Tenhou for riichi mahjong. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elom(x, nn = 4, exact = TRUE, base = c(30,10,-10,-30), status = NULL, 
    init = 1500, kfac = kriichi, history = FALSE, sort = TRUE, ...,
	placing = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elom_+3A_x">x</code></td>
<td>
<p>A data frame containing <code>2nn+1</code> variables, where 
<code>nn</code> is the number of players in a single game: (col <code>1</code>) 
a numeric vector denoting the time period in which the game 
took place, (cols <code>2</code> to <code>nn+1</code>) numeric or character 
identifiers for each of the <code>nn</code> players, (cols <code>nn+2</code> 
to <code>2nn+1</code>) the result of the game expressed as a number, 
typically a score for each player (e.g. the number of remaining 
chips in poker). Negative numbers are allowed. 
Alternatively, the result can be a placing (e.g. 1 for 
first place, 2 for second place), in which case the <code>placing</code>
argument MUST be set to <code>TRUE</code>. Placings must be integers: in the
event of a tie, multiple players can be given the same placing.</p>
</td></tr>
<tr><td><code id="elom_+3A_nn">nn</code></td>
<td>
<p>Number of players in a single game. If the number of players
varies, then this argument should be set to the maximum number of 
players in any game, and the <code>exact</code> argument should be set to
<code>FALSE</code>. Unused player identifiers in <code>x</code> must then 
be set to the missing value <code>NA</code>. The game score for <code>NA</code>
player identifiers is ignored and therefore can also be set to 
<code>NA</code>.</p>
</td></tr>
<tr><td><code id="elom_+3A_exact">exact</code></td>
<td>
<p>If <code>TRUE</code> (the default), then every game always has 
exactly <code>nn</code> players. If <code>TRUE</code>, then <code>x</code> cannot have 
missing values.</p>
</td></tr>
<tr><td><code id="elom_+3A_base">base</code></td>
<td>
<p>The base values used for the rating. Can be a numeric 
vector of length equal to <code>nn</code>, a numeric matrix with <code>nrow(x)</code>
rows and <code>nn</code> columns,	or a vectorized function of 
the game score. If a numeric vector, then the person with the highest 
score gets <code>base[1]</code>, the person with the second highest score 
gets <code>base[2]</code>, and so on. In the event of a tie on the game score, 
tied players are given the largest available <code>base</code> value. For 
games with less than <code>nn</code> players, see Details. If <code>base</code> is
a matrix, then the ith row is used for the ith game in <code>x</code>. If 
<code>base</code> is a vectorized function, then each player gets 
the result of the function applied to the game score. In Riichi 
mahjong, where players start with 25000 points, a typical example 
might be <code>function(x) (x-25000)/250</code>.</p>
</td></tr>
<tr><td><code id="elom_+3A_status">status</code></td>
<td>
<p>A data frame with the current status of the
system. If not <code>NULL</code>, this needs to be a data frame 
in the form of the <code>ratings</code> component of the returned 
list, containing variables named <code>Player</code>, <code>Rating</code>,
and optionally <code>Games</code>, <code>1st</code>, <code>2nd</code>, 
<code>3rd</code> and so on, and finally <code>Lag</code>, which 
are all set to zero if not given.</p>
</td></tr>
<tr><td><code id="elom_+3A_init">init</code></td>
<td>
<p>The rating at which to initialize a new player not
appearing in <code>status</code>. Must be a single number. If
different initializations for different players are required,
this can be done using <code>status</code>.</p>
</td></tr>
<tr><td><code id="elom_+3A_kfac">kfac</code></td>
<td>
<p>The K factor parameter. Can be a single number or
a vectorized function of two arguments, the first being the
ratings and the second being the number of games played. See
<code><a href="#topic+kriichi">kriichi</a></code> for an example.</p>
</td></tr>
<tr><td><code id="elom_+3A_history">history</code></td>
<td>
<p>If <code>TRUE</code> returns the entire history for each 
period in the component <code>history</code> of the returned list.</p>
</td></tr>
<tr><td><code id="elom_+3A_sort">sort</code></td>
<td>
<p>If <code>TRUE</code> sort the results by rating (highest
to lowest). If <code>FALSE</code> sort the results by player.</p>
</td></tr>
<tr><td><code id="elom_+3A_...">...</code></td>
<td>
<p>Passed to the function <code>kfac</code>.</p>
</td></tr>
<tr><td><code id="elom_+3A_placing">placing</code></td>
<td>
<p>If the results are given as placings (e.g. 1 for 
first place, 2 for second place) then this argument MUST be set
to <code>TRUE</code>, otherwise the placings will be interpreted 
as game scores.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For multi-player games there is no player one advantage parameter 
(e.g. a home advantage in football or a white advantage in chess). 
</p>
<p>If the sum of the vector <code>base</code> is not zero, or
if <code>base</code> is a function which is not zero when evaluated
at the starting chip/points value, then you may observe 
unusual behaviour and/or substantial ratings inflation/deflation.
</p>
<p>The two-player Elo system is based on game outcomes in the interval 
[0,1] and therefore uses a different scaling. As a result, the K 
factors here should be smaller. The default (as used by Tenhou)
is a K factor of 0.2 for players that have played a large number of
games (see <code><a href="#topic+kriichi">kriichi</a></code>).
</p>
<p>If the number of players varies and <code>base</code> is a vector (of length 
<code>nn</code>), then if the game has less than <code>nn</code> players, the vector 
is reduced by successively removing the centre value (for odd lengths) 
or by averaging both centre values (for even lengths). For example, if 
the <code>x</code> data frame contains both four-player and three-player 
mahjong games, then under the default values the three-player base 
vector becomes <code>c(30,0,-30)</code>, which is consistent with the vector 
that Tenhou uses for three-player mahjong.
</p>
<p>A numeric matrix can be used to allocate different <code>base</code> vectors to
different games. For example, in Riichi mahjong, games can be Tonpuusen 
(East round only) or Hanchan (East and South rounds), and you may wish
to allocate different base vectors to each type.  
</p>


<h3>Value</h3>

<p>A list object of class <code>"rating"</code> with the following 
components
</p>
<table>
<tr><td><code>ratings</code></td>
<td>
<p>A data frame of the results at the end of the 
final time period. The variables are self explanatory except
for <code>Lag</code>, which represents the number of time periods
since the player last played a game. This is equal to zero
for players who played in the latest time period, and is
also zero for players who have not yet played any games.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>A three dimensional array, or <code>NULL</code> if 
<code>history</code> is <code>FALSE</code>. The row dimension is the 
players, the column dimension is the time periods. 
The third dimension gives different parameters.</p>
</td></tr>
<tr><td><code>nn</code></td>
<td>
<p>The number of players for a single game.</p>
</td></tr>
<tr><td><code>kfac</code></td>
<td>
<p>The K factor or K factor function.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The character string <code>"EloM"</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Elo, Arpad (1978) 
The Rating of Chessplayers, Past and Present. 
Arco. ISBN 0-668-04721-6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo">elo</a></code>, <code><a href="#topic+fide">fide</a></code>, <code><a href="#topic+glicko">glicko</a></code>, <code><a href="#topic+kriichi">kriichi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>robj &lt;- elom(riichi)
robj

ut &lt;- unique(riichi$Time)
robj &lt;- elom(riichi[riichi$Time == ut[1],])
for(i in 2:length(ut)) {
  robj &lt;- elom(riichi[riichi$Time == ut[i],], status = robj$ratings)
}
robj
</code></pre>

<hr>
<h2 id='fide'>The Elo Rating System Employed By The FIDE</h2><span id='topic+fide'></span>

<h3>Description</h3>

<p>Implements the Elo rating system for estimating the relative 
skill level of players in two-player games such as chess,
implementing a version similar to that employed by the FIDE. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fide(x, status = NULL, init = 2200, gamma = 0, kfac = kfide, 
    history = FALSE, sort = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fide_+3A_x">x</code></td>
<td>
<p>A data frame containing four variables: (1) a numeric
vector denoting the time period in which the game took place
(2) a numeric or character identifier for player one (3)
a numeric or character identifier for player two and (4)
the result of the game expressed as a number, typically
equal to one for a player one win, zero for a player two
win and one half for a draw.</p>
</td></tr>
<tr><td><code id="fide_+3A_status">status</code></td>
<td>
<p>A data frame with the current status of the
system. If not <code>NULL</code>, this needs to be a data frame 
in the form of the <code>ratings</code> component of the returned 
list, containing variables named <code>Player</code>, <code>Rating</code>,
and optionally <code>Games</code>, <code>Win</code>, <code>Draw</code>, 
<code>Loss</code> <code>Lag</code> and <code>Elite</code>, which are set 
to zero if not given, and <code>Opponent</code>, which is set
to the player rating if not given.</p>
</td></tr>
<tr><td><code id="fide_+3A_init">init</code></td>
<td>
<p>The rating at which to initialize a new player not
appearing in <code>status</code>. Must be a single number. If
different initializations for different players are required,
this can be done using <code>status</code>.</p>
</td></tr>
<tr><td><code id="fide_+3A_gamma">gamma</code></td>
<td>
<p>A player one advantage parameter; either a single
value or a numeric vector equal to the number of rows in 
<code>x</code>. Positive values favour player one, while negative 
values favour player two. This could represent the advantage 
of playing at home, or the advantage of playing white for chess. 
Note that this is not passed to <code><a href="#topic+predict.rating">predict.rating</a></code>, 
which has its own <code>gamma</code> parameter.</p>
</td></tr>
<tr><td><code id="fide_+3A_kfac">kfac</code></td>
<td>
<p>The K factor parameter. Can be a single number or
a vectorized function of three arguments, the first being the
ratings, the second being the number of games played, and the
third being a binary indicator for whether or not a player 
has ever achieved a rating above 2400.  See <code><a href="#topic+kfide">kfide</a></code>, 
<code><a href="#topic+kgames">kgames</a></code>  and <code><a href="#topic+krating">krating</a></code> for examples.
The function <code><a href="#topic+kfide">kfide</a></code> is used by default.</p>
</td></tr>
<tr><td><code id="fide_+3A_history">history</code></td>
<td>
<p>If <code>TRUE</code> returns the entire history for each 
period in the component <code>history</code> of the returned list.</p>
</td></tr>
<tr><td><code id="fide_+3A_sort">sort</code></td>
<td>
<p>If <code>TRUE</code> sort the results by rating (highest
to lowest). If <code>FALSE</code> sort the results by player.</p>
</td></tr>
<tr><td><code id="fide_+3A_...">...</code></td>
<td>
<p>Passed to the function <code>kfac</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Elo rating system is a simple method for evaluating the skill 
of players. It has been used since around 1960 and is still
employed in various settings. Although the basic form uses only 
the ratings, additional complexity is commonly introduced
by adding a player one advantage parameter and by using different
K factors. A player one advantage parameter has been added to the 
original definition in the reference. A player one advantage 
parameter is also used for prediction purposes in 
<code><a href="#topic+predict.rating">predict.rating</a></code>.
</p>
<p>This implementation uses default arguments that are consistent 
with the implementation of FIDE for rating chess players.
It does not employ the initialization used by FIDE. For the
chess data analyzed in the file doc/ChessRatings.pdf, prediction
performance is poor because the default values of the K factors
are too low. This can be altered using the <code>kv</code> argument 
which is passed to the function <code><a href="#topic+kfide">kfide</a></code>.
</p>


<h3>Value</h3>

<p>A list object of class <code>"rating"</code> with the following 
components
</p>
<table>
<tr><td><code>ratings</code></td>
<td>
<p>A data frame of the results at the end of the 
final time period. The variables are self explanatory except
for <code>Lag</code>, which represents the number of time periods
since the player last played a game, <code>Elite</code>, which
is a binary indicator for whether or not a player has ever
reached 2400, and <code>Opponent</code>, which gives the average 
rating of all opponents. The <code>Lag</code> variable is equal 
to zero for players who played in the latest time period, 
and is also zero for players who have not yet played any 
games. The <code>Elite</code> variable is required due to the 
K factor dependency in the FIDE implementation. The
<code>Opponent</code> variable is not currently used in the
updating algorithm.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>A three dimensional array, or <code>NULL</code> if 
<code>history</code> is <code>FALSE</code>. The row dimension is the 
players, the column dimension is the time periods. 
The third dimension gives different parameters.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The player one advantage parameter.</p>
</td></tr>
<tr><td><code>kfac</code></td>
<td>
<p>The K factor or K factor function.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The character string <code>"Elo"</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Elo, Arpad (1978) 
The Rating of Chessplayers, Past and Present. 
Arco. ISBN 0-668-04721-6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo">elo</a></code>, <code><a href="#topic+kfide">kfide</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>afl &lt;- aflodds[,c(2,3,4,7)]
robj &lt;- fide(afl)
robj

robj &lt;- fide(afl[afl$Week==1,])
for(i in 2:max(afl$Week)) robj &lt;- fide(afl[afl$Week==i,], robj$ratings)
robj
</code></pre>

<hr>
<h2 id='glicko'>The Glicko Rating System</h2><span id='topic+glicko'></span>

<h3>Description</h3>

<p>Implements the Glicko rating system for estimating the relative 
skill level of players in two-player games such as chess. It
extends the Elo method by including a deviation parameter for
each player, representing uncertainty on the rating.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glicko(x, status = NULL, init = c(2200,300), gamma = 0, cval = 15, 
    history = FALSE, sort = TRUE, rdmax = 350, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glicko_+3A_x">x</code></td>
<td>
<p>A data frame containing four variables: (1) a numeric
vector denoting the time period in which the game took place
(2) a numeric or character identifier for player one (3)
a numeric or character identifier for player two and (4)
the result of the game expressed as a number, typically
equal to one for a player one win, zero for a player two
win and one half for a draw.</p>
</td></tr>
<tr><td><code id="glicko_+3A_status">status</code></td>
<td>
<p>A data frame with the current status of the
system. If not <code>NULL</code>, this needs to be a data frame 
in the form of the <code>ratings</code> component of the returned 
list, containing variables named <code>Player</code>, <code>Rating</code>,
<code>Deviation</code>, and optionally <code>Games</code>, <code>Win</code>, 
<code>Draw</code>, <code>Loss</code> and <code>Lag</code>, which are set to zero 
if not given.</p>
</td></tr>
<tr><td><code id="glicko_+3A_init">init</code></td>
<td>
<p>The rating vector at which to initialize a new player 
not appearing in <code>status</code>. Must be a vector of length two
giving the initial rating and initial deviation respectively. 
If different initializations for different players are 
required, this can be done using <code>status</code>. The initial
deviation cannot be greater than <code>rdmax</code>.</p>
</td></tr>
<tr><td><code id="glicko_+3A_gamma">gamma</code></td>
<td>
<p>A player one advantage parameter; either a single
value or a numeric vector equal to the number of rows in 
<code>x</code>. Positive values favour player one, while negative 
values favour player two. This could represent the advantage 
of playing at home, or the advantage of playing white for chess. 
Note that this is not passed to <code><a href="#topic+predict.rating">predict.rating</a></code>, 
which has its own <code>gamma</code> parameter.</p>
</td></tr>
<tr><td><code id="glicko_+3A_cval">cval</code></td>
<td>
<p>The c parameter, which controls the increase in the
player deviations across time. Must be a single non-negative 
number.</p>
</td></tr>
<tr><td><code id="glicko_+3A_history">history</code></td>
<td>
<p>If <code>TRUE</code> returns the entire history for each 
period in the component <code>history</code> of the returned list.</p>
</td></tr>
<tr><td><code id="glicko_+3A_sort">sort</code></td>
<td>
<p>If <code>TRUE</code> sort the results by rating (highest
to lowest). If <code>FALSE</code> sort the results by player.</p>
</td></tr>
<tr><td><code id="glicko_+3A_rdmax">rdmax</code></td>
<td>
<p>The maximum value allowed for the rating deviation.</p>
</td></tr>
<tr><td><code id="glicko_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Glicko rating system is a method for evaluating the skill 
of players. It is more complex than Elo but typically yields 
better predictions. 
Default values are roughly optimized for the chess data analyzed 
in the file doc/ChessRatings.pdf, using the binomial deviance 
criterion. A player one advantage parameter has been added to 
the original definition in the reference. A player one advantage 
parameter is also used for prediction purposes in 
<code><a href="#topic+predict.rating">predict.rating</a></code>.
In this implementation, rating deviances increase at the 
beginning of the updating period, and decrease at the end.
This is slightly different from the Glicko-2 implementation, 
where deviance increases for active players may occur at the end 
of the previous period. In both implementations there will be
an initial increase for existing but previously inactive players. 
</p>


<h3>Value</h3>

<p>A list object of class <code>"rating"</code> with the following 
components
</p>
<table>
<tr><td><code>ratings</code></td>
<td>
<p>A data frame of the results at the end of the 
final time period. The variables are self explanatory except
for <code>Lag</code>, which represents the number of time periods
since the player last played a game. This is equal to zero
for players who played in the latest time period, and is
also zero for players who have not yet played any games.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>A three dimensional array, or <code>NULL</code> if 
<code>history</code> is <code>FALSE</code>. The row dimension is the 
players, the column dimension is the time periods. 
The third dimension gives different parameters.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The player one advantage parameter.</p>
</td></tr>
<tr><td><code>cval</code></td>
<td>
<p>The c parameter.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The character string <code>"Glicko"</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Glickman, M.E. (1999) 
Parameter estimation in large dynamic paired comparison experiments. 
J. R. Stat. Soc. Ser. C: Applied Statistics, 48(3), 377-394.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo">elo</a></code>, <code><a href="#topic+glicko2">glicko2</a></code>, <code><a href="#topic+steph">steph</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>afl &lt;- aflodds[,c(2,3,4,7)]
robj &lt;- glicko(afl)
robj

robj &lt;- glicko(afl[afl$Week==1,])
for(i in 2:max(afl$Week)) robj &lt;- glicko(afl[afl$Week==i,], robj$ratings)
robj
</code></pre>

<hr>
<h2 id='glicko2'>The Glicko-2 Rating System</h2><span id='topic+glicko2'></span>

<h3>Description</h3>

<p>Implements the Glicko-2 rating system for estimating the relative 
skill level of players in two-player games such as chess. It
extends the Glicko method by including a volatility parameter for
each player, representing the degree of expected fluctuation in 
the rating. Volatility is therefore a measure of consistency of
performance.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glicko2(x, status = NULL, init = c(2200,300,0.15), gamma = 0, 
    tau = 1.2, history = FALSE, sort = TRUE, rdmax = 350, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glicko2_+3A_x">x</code></td>
<td>
<p>A data frame containing four variables: (1) a numeric
vector denoting the time period in which the game took place
(2) a numeric or character identifier for player one (3)
a numeric or character identifier for player two and (4)
the result of the game expressed as a number, typically
equal to one for a player one win, zero for a player two
win and one half for a draw.</p>
</td></tr>
<tr><td><code id="glicko2_+3A_status">status</code></td>
<td>
<p>A data frame with the current status of the
system. If not <code>NULL</code>, this needs to be a data frame 
in the form of the <code>ratings</code> component of the returned 
list, containing variables named <code>Player</code>, <code>Rating</code>,
<code>Deviation</code>, <code>Volatility</code>, and optionally <code>Games</code>, 
<code>Win</code>, <code>Draw</code>, <code>Loss</code> and <code>Lag</code>, which are 
set to zero if not given.</p>
</td></tr>
<tr><td><code id="glicko2_+3A_init">init</code></td>
<td>
<p>The rating vector at which to initialize a new player 
not appearing in <code>status</code>. Must be a vector of length three
giving the initial rating, initial deviation and initial volatility 
respectively. If different initializations for different players are 
required, this can be done using <code>status</code>. The initial
deviation cannot be greater than <code>rdmax</code>. The initial
volatility cannot be greater than <code>rdmax</code> divided by 
<code>400/log(10)</code>.</p>
</td></tr>
<tr><td><code id="glicko2_+3A_gamma">gamma</code></td>
<td>
<p>A player one advantage parameter; either a single
value or a numeric vector equal to the number of rows in 
<code>x</code>. Positive values favour player one, while negative 
values favour player two. This could represent the advantage 
of playing at home, or the advantage of playing white for chess. 
Note that this is not passed to <code><a href="#topic+predict.rating">predict.rating</a></code>, 
which has its own <code>gamma</code> parameter.</p>
</td></tr>
<tr><td><code id="glicko2_+3A_tau">tau</code></td>
<td>
<p>The tau parameter, which controls the change in the
player volatility across time. Smaller values prevent the 
volatility measures from changing by large amounts. Must be a 
single number. Mark Glickman suggests a value between 0.3 and 1.2.
A non-positive value can be specified, in which case the 
volatilities are never updated.</p>
</td></tr>
<tr><td><code id="glicko2_+3A_history">history</code></td>
<td>
<p>If <code>TRUE</code> returns the entire history for each 
period in the component <code>history</code> of the returned list.</p>
</td></tr>
<tr><td><code id="glicko2_+3A_sort">sort</code></td>
<td>
<p>If <code>TRUE</code> sort the results by rating (highest
to lowest). If <code>FALSE</code> sort the results by player.</p>
</td></tr>
<tr><td><code id="glicko2_+3A_rdmax">rdmax</code></td>
<td>
<p>The maximum value allowed for the rating deviation.
The maximum value allowed for the volatility is <code>rdmax</code> 
divided by <code>400/log(10)</code>.</p>
</td></tr>
<tr><td><code id="glicko2_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Glicko-2 rating system is a method for evaluating the skill 
of players. It is more complex than Glicko because it includes a 
volatility for each player. It requires a single parameter 
optimization for each player within each time period. We use the
R function <code>optimize</code> in preference to the root-finding 
approaches suggested in Glickman (2001) and Glickman (2013).
Default values are roughly optimized for the chess data analyzed 
in the file doc/ChessRatings.pdf, using the binomial deviance 
criterion. A player one advantage parameter has been added to 
the original definition in the reference. A player one advantage 
parameter is also used for prediction purposes in 
<code><a href="#topic+predict.rating">predict.rating</a></code>.
</p>


<h3>Value</h3>

<p>A list object of class <code>"rating"</code> with the following 
components
</p>
<table>
<tr><td><code>ratings</code></td>
<td>
<p>A data frame of the results at the end of the 
final time period. The variables are self explanatory except
for <code>Lag</code>, which represents the number of time periods
since the player last played a game. This is equal to zero
for players who played in the latest time period, and is
also zero for players who have not yet played any games.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>A three dimensional array, or <code>NULL</code> if 
<code>history</code> is <code>FALSE</code>. The row dimension is the 
players, the column dimension is the time periods. 
The third dimension gives different parameters.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The player one advantage parameter.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>The tau parameter.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The character string <code>"Glicko-2"</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Glickman, M.E. (2001) 
Dynamic paired comparison models with stochastic variances. 
Journal of Applied Statistics, 28, 673-689.
</p>
<p>Glickman, M.E. (2013) 
Example of the Glicko-2 system.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo">elo</a></code>, <code><a href="#topic+glicko">glicko</a></code>, <code><a href="#topic+steph">steph</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>initstate &lt;- data.frame(Player=1:4, Rating = c(1500,1400,1550,1700), 
  Deviation = c(200,30,100,300), Volatility = 0.06)
games &lt;- data.frame(Week = 1, Payer1 = 1, Player2 = 2:4, Score = c(1,0,0))
robj &lt;- glicko2(games, status = initstate, tau = 0.5, sort = FALSE)
print(robj, cols = 1:4, digits = 6)

afl &lt;- aflodds[,c(2,3,4,7)]
robj &lt;- glicko2(afl)
robj

robj &lt;- glicko2(afl[afl$Week==1,])
for(i in 2:max(afl$Week)) robj &lt;- glicko2(afl[afl$Week==i,], robj$ratings)
robj
</code></pre>

<hr>
<h2 id='hist.rating'>Histogram Plotting for a Rating Object</h2><span id='topic+hist.rating'></span>

<h3>Description</h3>

<p>Plot histograms of estimated ratings or other features,
including full history progressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rating'
hist(x, which = "Rating", tng=15, history = FALSE, log = FALSE, 
  xlab = which, main = paste(x$type," Ratings System"), density = FALSE, 
  add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist.rating_+3A_x">x</code></td>
<td>
<p>An object of class <code>"rating"</code>.</p>
</td></tr>
<tr><td><code id="hist.rating_+3A_which">which</code></td>
<td>
<p>The variable to be plotted.</p>
</td></tr>
<tr><td><code id="hist.rating_+3A_tng">tng</code></td>
<td>
<p>A single value. If the number of games played by the
player is below this value, the player is not depicted on the
plot.</p>
</td></tr>
<tr><td><code id="hist.rating_+3A_history">history</code></td>
<td>
<p>If <code>TRUE</code>, a histogram is plotted for every
single time point. Only available if the history was retained
in <code>x</code>.</p>
</td></tr>
<tr><td><code id="hist.rating_+3A_log">log</code></td>
<td>
<p>The log(x+1) transform. May be useful if plotting e.g.
the number of games.</p>
</td></tr>
<tr><td><code id="hist.rating_+3A_xlab">xlab</code>, <code id="hist.rating_+3A_main">main</code></td>
<td>
<p>Graphical parameters.</p>
</td></tr>
<tr><td><code id="hist.rating_+3A_density">density</code></td>
<td>
<p>If <code>TRUE</code>, plot a density estimate rather 
than a histogram.</p>
</td></tr>
<tr><td><code id="hist.rating_+3A_add">add</code></td>
<td>
<p>Add to an existing plot? Only relevant for density
estimates.</p>
</td></tr>
<tr><td><code id="hist.rating_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed through to plotting
functions.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.rating">plot.rating</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>afl &lt;- aflodds[,c(2,3,4,7)]
robj &lt;- steph(afl)
hist(robj, xlim = c(1900,2500), density=TRUE)

afl &lt;- aflodds[,c(2,3,4,7)]
robj &lt;- steph(afl, history=TRUE)
hist(robj, history=TRUE, xlim = c(1900,2500), density=TRUE)

robj &lt;- elom(riichi)
hist(robj, xlim = c(1100,1900))

robj &lt;- elom(riichi, history=TRUE)
hist(robj, history=TRUE, xlim = c(1100,1900))
</code></pre>

<hr>
<h2 id='kfide'>The K Factor Function Used By FIDE</h2><span id='topic+kfide'></span>

<h3>Description</h3>

<p>Calculates the K factor for the Elo rating system based
on player rating, number of games played, and optionally
a binary elite player identifier. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kfide(rating, games, elite = NULL, kv = c(10,15,30)) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kfide_+3A_rating">rating</code></td>
<td>
<p>A numeric vector of player ratings.</p>
</td></tr>
<tr><td><code id="kfide_+3A_games">games</code></td>
<td>
<p>A numeric vector with the number of games played
by each player.</p>
</td></tr>
<tr><td><code id="kfide_+3A_elite">elite</code></td>
<td>
<p>If not <code>NULL</code>, then a binary identifier for
elite players.</p>
</td></tr>
<tr><td><code id="kfide_+3A_kv">kv</code></td>
<td>
<p>The three different K factors that the function can
produce.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to be used for the <code>kfac</code> argument
of either <code><a href="#topic+fide">fide</a></code> or <code><a href="#topic+elo">elo</a></code>. It returns
<code>kv[1]</code> for elite players, <code>kv[2]</code> for non-elite
players with 30 games or more, and <code>kv[3]</code> for non-elite
players with less than 30 games. The default is the current FIDE 
implementation which uses the K factors 10, 15 and 30. The K factor 
of 30 was changed from 25 in the year 2011. In this context, elite
players are defined by FIDE as being those who have reached 
the rating 2400 or more at any time in the past.  
</p>


<h3>Value</h3>

<p>A numeric vector of K factors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fide">fide</a></code></p>

<hr>
<h2 id='kgames'>A K Factor Function With Dependence On Number Of Games</h2><span id='topic+kgames'></span>

<h3>Description</h3>

<p>Calculates the K factor for the Elo rating system based
on number of games played. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kgames(rating, games, elite = NULL, gv = 30, kv = c(32,26)) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgames_+3A_rating">rating</code></td>
<td>
<p>A numeric vector of player ratings. The K factor
does not depend on this quantity.</p>
</td></tr>
<tr><td><code id="kgames_+3A_games">games</code></td>
<td>
<p>A numeric vector with the number of games played
by each player.</p>
</td></tr>
<tr><td><code id="kgames_+3A_elite">elite</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="kgames_+3A_gv">gv</code></td>
<td>
<p>A numeric vector of length one less than <code>kv</code>
giving the thresholds for the number of games played.</p>
</td></tr>
<tr><td><code id="kgames_+3A_kv">kv</code></td>
<td>
<p>A numeric vector of length one more than <code>gv</code>
giving the different K factors that the function can
produce.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to be used for the <code>kfac</code> argument
of either <code><a href="#topic+fide">fide</a></code> or <code><a href="#topic+elo">elo</a></code>. It returns
<code>kv[i]</code> for players who have played a total number of games
within the intervals defined by <code>gv</code> (closed on the right). 
</p>


<h3>Value</h3>

<p>A numeric vector of K factors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo">elo</a></code>, <code><a href="#topic+fide">fide</a></code></p>

<hr>
<h2 id='krating'>A K Factor Function With Dependence On Rating</h2><span id='topic+krating'></span>

<h3>Description</h3>

<p>Calculates the K factor for the Elo rating system based
on the player rating. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>krating(rating, games, elite = NULL, rv = 2300, kv = c(32,26)) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="krating_+3A_rating">rating</code></td>
<td>
<p>A numeric vector of player ratings.</p>
</td></tr>
<tr><td><code id="krating_+3A_games">games</code></td>
<td>
<p>A numeric vector with the number of games played
by each player. The K factor does not depend on this 
quantity.</p>
</td></tr>
<tr><td><code id="krating_+3A_elite">elite</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="krating_+3A_rv">rv</code></td>
<td>
<p>A numeric vector of length one less than <code>kv</code>
giving the thresholds for the ratings.</p>
</td></tr>
<tr><td><code id="krating_+3A_kv">kv</code></td>
<td>
<p>A numeric vector of length one more than <code>gv</code>
giving the different K factors that the function can
produce.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to be used for the <code>kfac</code> argument
of either <code><a href="#topic+fide">fide</a></code> or <code><a href="#topic+elo">elo</a></code>. It returns
<code>kv[i]</code> for players who have a rating within the intervals 
defined by <code>rv</code> (closed on the right). 
</p>


<h3>Value</h3>

<p>A numeric vector of K factors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo">elo</a></code>, <code><a href="#topic+fide">fide</a></code></p>

<hr>
<h2 id='kriichi'>A multi-player K Factor Function for Riichi Mahjong</h2><span id='topic+kriichi'></span>

<h3>Description</h3>

<p>Calculates the K factor for the rating system employed by
Tenhou for Riichi mahjong. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kriichi(rating, games, gv = 400, kv = 0.2) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kriichi_+3A_rating">rating</code></td>
<td>
<p>A numeric vector of player ratings. The K factor
does not depend on this quantity.</p>
</td></tr>
<tr><td><code id="kriichi_+3A_games">games</code></td>
<td>
<p>A numeric vector with the number of games played
by each player.</p>
</td></tr>
<tr><td><code id="kriichi_+3A_gv">gv</code></td>
<td>
<p>A value giving the threshold for the number of games 
played.</p>
</td></tr>
<tr><td><code id="kriichi_+3A_kv">kv</code></td>
<td>
<p>The K factor if the number of games played is greater
than or equal to <code>gv</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to be used for the <code>kfac</code> argument
of <code><a href="#topic+elom">elom</a></code>. It returns <code>kv</code> for players who have 
played at least <code>gv</code> games, and returns <code>1-(1-kv)N/gv</code> 
otherwise, where <code>N</code> is the number of games played. 
</p>


<h3>Value</h3>

<p>A numeric vector of K factors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elom">elom</a></code>, <code><a href="#topic+fide">fide</a></code></p>

<hr>
<h2 id='metrics'>Prediction Evaluation</h2><span id='topic+metrics'></span>

<h3>Description</h3>

<p>Returns measures that assess prediction performance. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metrics(act, pred, cap = c(0.01,0.99), which = 1:3, na.rm = TRUE, 
  sort = TRUE, digits = 3, scale = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metrics_+3A_act">act</code></td>
<td>
<p>A numeric vector of actual values. Typically equal to
one for a player one win, zero for a player two win, and one
half for a draw.</p>
</td></tr>
<tr><td><code id="metrics_+3A_pred">pred</code></td>
<td>
<p>A numeric vector of predictions, typically values 
between zero and one. A matrix can also be given, in which
case the jth column contains the predictions for model j.</p>
</td></tr>
<tr><td><code id="metrics_+3A_cap">cap</code></td>
<td>
<p>A numeric vector of length two giving values at which
to cap the binomial deviance.</p>
</td></tr>
<tr><td><code id="metrics_+3A_which">which</code></td>
<td>
<p>Select metrics using any subset of <code>1:3</code>. All
are produced by default.</p>
</td></tr>
<tr><td><code id="metrics_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove missing values in predictions. The default is
to remove missing values because the default predict method will
predict missing values for games with new players.</p>
</td></tr>
<tr><td><code id="metrics_+3A_sort">sort</code></td>
<td>
<p>By default output is ordered from best to worst using
the first metric specified.</p>
</td></tr>
<tr><td><code id="metrics_+3A_digits">digits</code></td>
<td>
<p>Round to this number of digits.</p>
</td></tr>
<tr><td><code id="metrics_+3A_scale">scale</code></td>
<td>
<p>If <code>TRUE</code> (the default), all metrics are scaled
so that a value of 100 corresponds to predicting 0.5 for every
game.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The preferred metric for assessing predictions in chess is
the capped binomial deviance. Mean squared error and mean 
absolute error metrics are also produced. By default all metrics 
are scaled so that the value 100 represents the zero information
case. If not scaled, then all metrics are multiplied by 100.
</p>


<h3>Value</h3>

<p>A numeric vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.rating">predict.rating</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>afl &lt;- aflodds[,c(2,3,4,7)]
train &lt;- afl[afl$Week &lt;= 80,]
test &lt;- afl[afl$Week &gt; 80,]
robj &lt;- elo(train)
metrics(test$Score, predict(robj, test))
metrics(test$Score, predict(robj, test), scale = FALSE)
</code></pre>

<hr>
<h2 id='plot.rating'>Plot Player Features Across Time for a Rating Object</h2><span id='topic+plot.rating'></span>

<h3>Description</h3>

<p>Plot line traces of estimated ratings or other features for
selected players. This function can only be used if the full
history is retained in the object <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rating'
plot(x, which = "Rating", players = NULL, t0 = 1, tv = NULL,
  npl = 10, random = FALSE, xlab = "Time Period", ylab = paste(x$type," Ratings"), 
  main = paste(x$type," Ratings System"), inflation = FALSE, add=FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.rating_+3A_x">x</code></td>
<td>
<p>An object of class <code>"rating"</code>.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_which">which</code></td>
<td>
<p>The variable to be plotted.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_players">players</code></td>
<td>
<p>If not <code>NULL</code>, should be a vector of player
identifiers to explicitly select players to be plotted.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_t0">t0</code></td>
<td>
<p>The time index at which to begin. Note that unless players
are specified explicitly, players who do not play at time index
<code>t0</code> will not be selected for the plot. Can also be a
vector of length two, in which case the second value is the
time index at which to end.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_tv">tv</code></td>
<td>
<p>If not <code>NULL</code>, then a vector of values to be used on the
x-axis instead of the time index.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_npl">npl</code></td>
<td>
<p>The number of players to select.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_random">random</code></td>
<td>
<p>If <code>TRUE</code>, <code>npl</code> players are selected at random from
those who played at time <code>t0</code>. If <code>FALSE</code> (the default), 
the <code>npl</code> players who played most games at <code>t0</code> are selected. 
Ignored if <code>players</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_xlab">xlab</code>, <code id="plot.rating_+3A_ylab">ylab</code>, <code id="plot.rating_+3A_main">main</code></td>
<td>
<p>Graphical parameters.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_inflation">inflation</code></td>
<td>
<p>If <code>TRUE</code>, plot the average rating of the best <code>npl</code>
players at each time point. This is designed to investigate ratings inflation.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_add">add</code></td>
<td>
<p>Add to an existing plot.</p>
</td></tr>
<tr><td><code id="plot.rating_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed through to plotting
functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the argument <code>random</code> is not used by default, since it can 
produce flat profiles from randomly selected players who play few games. 
The default selection is non-random and selects more active players,
however they may be more likely to improve over time than the
general population.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hist.rating">hist.rating</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>afl &lt;- aflodds[,c(2,3,4,7)]
robj &lt;- steph(afl, history=TRUE)
plot(robj)

robj &lt;- elom(riichi, history = TRUE)
pl &lt;- robj$ratings$Player[robj$ratings$Games &gt;= 80]
plot(robj, players = pl)
</code></pre>

<hr>
<h2 id='predict.rating'>Predict Result Of Games Based On Player Ratings</h2><span id='topic+predict.rating'></span>

<h3>Description</h3>

<p>Predict the result of two-player or multi-player games, 
given the estimated ratings for each player.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rating'
predict(object, newdata, tng=15, trat=NULL, gamma=30, 
  thresh, placing = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.rating_+3A_object">object</code></td>
<td>
<p>An object of class <code>"rating"</code>.</p>
</td></tr>
<tr><td><code id="predict.rating_+3A_newdata">newdata</code></td>
<td>
<p>For two player games, a dataframe containing 
three variables: (1) a numeric vector denoting the time period 
in which the game is taking place (2) a numeric or character 
identifier for player one (3) a numeric or character identifier 
for player two. The time period can contain missing values as 
it is not used for the prediction. For N-player games (i.e.
for objects created by the <code>elom</code> function), the player 
identifiers should be in columns 2 to N-1. This argument cannot 
be missing; if predictions on the original dataset are required,
then this dataset must be passed to the prediction function.</p>
</td></tr>
<tr><td><code id="predict.rating_+3A_tng">tng</code></td>
<td>
<p>A single value. If the number of games played by 
any player is below this value, then either the prediction
will be a missing value, or the prediction will be based on
<code>trat</code>.</p>
</td></tr>
<tr><td><code id="predict.rating_+3A_trat">trat</code></td>
<td>
<p>A single number (for Elo and EloM), or a vector of 
length two (for Glicko or Glicko-2 or Stephenson) giving the 
rating and deviation parameters to be used for players who have 
played less than <code>tng</code> games. If <code>NULL</code> then these 
predictions will be missing. The volatility parameter in 
Glicko-2 is not needed for predictions.</p>
</td></tr>
<tr><td><code id="predict.rating_+3A_gamma">gamma</code></td>
<td>
<p>A player one advantage parameter; either a single
value or a numeric vector equal to the number of rows in 
<code>newdata</code>. Positive values favour player one, while 
negative values favour player two. This could represent the 
advantage of playing at home, or the advantage of playing 
white for chess. The default value is roughly optimal for 
chess ratings. Ignored for multi-player.</p>
</td></tr>
<tr><td><code id="predict.rating_+3A_thresh">thresh</code></td>
<td>
<p>A single value. If given, a binary vector is 
returned indicating whether the prediction is greater than 
this value. Ignored for multi-player.</p>
</td></tr>
<tr><td><code id="predict.rating_+3A_placing">placing</code></td>
<td>
<p>For multi-player only. If <code>TRUE</code>, predicted
placings are given rather than expected base scores.</p>
</td></tr>
<tr><td><code id="predict.rating_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function predicts the expectation of the game result. In 
two-player games, if the value of one is a win for player one, and 
the value of zero is a win for player two, and there are no other 
possibilities, then the prediction is the probability of a win 
for player one. This is not the case when draws are a possibility.
</p>
<p>For multi-player predictions using objects produced by <code>elom</code>, 
expected base scores are given for each player. These are simply the 
difference between the rating of a player and the average of all 
players in the game, divided by 40.
</p>


<h3>Value</h3>

<p>A numeric vector of predictions of two-player games, or a matrix of 
expected base scores for multi-player games, either of which may contain 
missing values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo">elo</a></code>, <code><a href="#topic+elom">elom</a></code>, <code><a href="#topic+metrics">metrics</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>afl &lt;- aflodds[,c(2,3,4,7)]
train &lt;- afl[afl$Week &lt;= 80,]
test &lt;- afl[afl$Week &gt; 80,]
robj &lt;- elo(train)
pvals &lt;- predict(robj, test)

train &lt;- riichi[riichi$Time &lt;= 250,]
test &lt;- riichi[riichi$Time &gt; 250,]
robj &lt;- elom(train)
predict(robj, test, trat = 1400, placing = TRUE)
</code></pre>

<hr>
<h2 id='riichi'>Riichi Mahjong Game Results</h2><span id='topic+riichi'></span>

<h3>Description</h3>

<p>The <code>aflodds</code> data frame has 540 rows and 9 variables. It
shows the results for 540 Riichi Mahjong games played by 69 
players at the Melbourne Mahjong Club in 2019. Player identifiers 
are randomly assigned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aflodds</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Time</dt><dd><p>The day number within the year 2019.</p>
</dd>
<dt>Play1</dt><dd><p>Player 1 identifier.</p>
</dd>
<dt>Play2</dt><dd><p>Player 2 identifier.</p>
</dd>
<dt>Play3</dt><dd><p>Player 3 identifier.</p>
</dd>
<dt>Play4</dt><dd><p>Player 4 identifier.</p>
</dd>
<dt>Score1</dt><dd><p>Player 1 score.</p>
</dd>
<dt>Score2</dt><dd><p>Player 2 score.</p>
</dd>
<dt>Score3</dt><dd><p>Player 3 score.</p>
</dd>
<dt>Score4</dt><dd><p>Player 4 score.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Players start the game with 25000 points. Mahjong is a zero-sum 
game, therfore the sum of all four scores is always 100000. Negative 
scores are possible. The largest recorded score is 93900. The 
smallest recorded score is -24600.
</p>


<h3>Source</h3>

<p>Hand collected by The Melbourne Mahjong Club.
</p>

<hr>
<h2 id='steph'>The Stephenson Rating System</h2><span id='topic+steph'></span>

<h3>Description</h3>

<p>Implements the Stephenson rating system for estimating the relative 
skill level of players in two-player games such as chess. It
extends the Glicko method by including a second parameter 
controlling player deviation across time, a bonus parameter, 
and a neighbourhood parameter.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>steph(x, status = NULL, init = c(2200,300), gamma = 0, cval = 10, 
  hval = 10, bval = 0, lambda = 2, history = FALSE, sort = TRUE, 
  rdmax = 350, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="steph_+3A_x">x</code></td>
<td>
<p>A data frame containing four variables: (1) a numeric
vector denoting the time period in which the game took place
(2) a numeric or character identifier for player one (3)
a numeric or character identifier for player two and (4)
the result of the game expressed as a number, typically
equal to one for a player one win, zero for a player two
win and one half for a draw.</p>
</td></tr>
<tr><td><code id="steph_+3A_status">status</code></td>
<td>
<p>A data frame with the current status of the
system. If not <code>NULL</code>, this needs to be a data frame 
in the form of the <code>ratings</code> component of the returned 
list, containing variables named <code>Player</code>, <code>Rating</code>,
<code>Deviation</code>, and optionally <code>Games</code>, <code>Win</code>, 
<code>Draw</code>, <code>Loss</code> and <code>Lag</code>, which are set to zero 
if not given.</p>
</td></tr>
<tr><td><code id="steph_+3A_init">init</code></td>
<td>
<p>The rating vector at which to initialize a new player 
not appearing in <code>status</code>. Must be a vector of length two
giving the initial rating and initial deviation respectively. 
If different initializations for different players are 
required, this can be done using <code>status</code>. The initial
deviation cannot be greater than <code>rdmax</code>.</p>
</td></tr>
<tr><td><code id="steph_+3A_gamma">gamma</code></td>
<td>
<p>A player one advantage parameter; either a single
value or a numeric vector equal to the number of rows in 
<code>x</code>. Positive values favour player one, while negative 
values favour player two. This could represent the advantage 
of playing at home, or the advantage of playing white for chess. 
Note that this is not passed to <code><a href="#topic+predict.rating">predict.rating</a></code>, 
which has its own <code>gamma</code> parameter.</p>
</td></tr>
<tr><td><code id="steph_+3A_cval">cval</code></td>
<td>
<p>The c parameter, which controls the increase in the
player deviations across time. Must be a single non-negative number. 
Note that both <code>cval</code> and <code>hval</code> increase player 
deviations, so if <code>hval</code> is not zero then <code>cval</code> should 
typically be lower than the corresponding parameter in 
<code><a href="#topic+glicko">glicko</a></code>.</p>
</td></tr>
<tr><td><code id="steph_+3A_hval">hval</code></td>
<td>
<p>The h parameter, which also controls the increase in the
player deviations across time. Must be a single non-negative number.</p>
</td></tr>
<tr><td><code id="steph_+3A_bval">bval</code></td>
<td>
<p>The bonus parameter, which gives a per game bonus to each
player on the basis that players who play more often may improve
irrespective of whether they win or lose. A single non-negative
number. Note that this will create ratings inflation (i.e. ratings
will increase over time).</p>
</td></tr>
<tr><td><code id="steph_+3A_lambda">lambda</code></td>
<td>
<p>The neighbourhood parameter, which shrinks player
ratings towards their opponents. A single non-negative number.</p>
</td></tr>
<tr><td><code id="steph_+3A_history">history</code></td>
<td>
<p>If <code>TRUE</code> returns the entire history for each 
period in the component <code>history</code> of the returned list.</p>
</td></tr>
<tr><td><code id="steph_+3A_sort">sort</code></td>
<td>
<p>If <code>TRUE</code> sort the results by rating (highest
to lowest). If <code>FALSE</code> sort the results by player.</p>
</td></tr>
<tr><td><code id="steph_+3A_rdmax">rdmax</code></td>
<td>
<p>The maximum value allowed for the rating deviation.</p>
</td></tr>
<tr><td><code id="steph_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Stephenson rating system is a method for evaluating the skill 
of players. It was developed by Alec Stephenson in 2012 as a variant 
of his winning entry in a competition to find the most useful 
practical chess rating system, organized by Jeff Sonas on Kaggle,
a platform for data prediction competitions. The precise details 
are given in the file doc/ChessRatings.pdf.
</p>
<p>This implementation is written so that Glicko is obtained as a 
special case upon setting all of the parameters <code>hval</code>, 
<code>bval</code> and <code>lambda</code> to zero. Default values are roughly 
optimized for the chess data analyzed in the file 
doc/ChessRatings.pdf, using the binomial deviance criterion.
</p>


<h3>Value</h3>

<p>A list object of class <code>"rating"</code> with the following 
components
</p>
<table>
<tr><td><code>ratings</code></td>
<td>
<p>A data frame of the results at the end of the 
final time period. The variables are self explanatory except
for <code>Lag</code>, which represents the number of time periods
since the player last played a game. This is equal to zero
for players who played in the latest time period, and is
also zero for players who have not yet played any games.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>A three dimensional array, or <code>NULL</code> if 
<code>history</code> is <code>FALSE</code>. The row dimension is the 
players, the column dimension is the time periods. The 
third dimension gives different parameters.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The player one advantage parameter.</p>
</td></tr>
<tr><td><code>cval</code></td>
<td>
<p>The c parameter.</p>
</td></tr>
<tr><td><code>hval</code></td>
<td>
<p>The h parameter.</p>
</td></tr>
<tr><td><code>bval</code></td>
<td>
<p>The bonus parameter.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The neighbourhood parameter.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The character string <code>"Stephenson"</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Glickman, M.E. (1999) 
Parameter estimation in large dynamic paired comparison experiments. 
J. R. Stat. Soc. Ser. C: Applied Statistics, 48(3), 377-394.
</p>
<p>Glickman, M.E. (2001) 
Dynamic paired comparison models with stochastic variances. 
Journal of Applied Statistics, 28, 673-689.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glicko">glicko</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>afl &lt;- aflodds[,c(2,3,4,7)]
robj &lt;- steph(afl)
robj

robj &lt;- steph(afl[afl$Week==1,])
for(i in 2:max(afl$Week)) robj &lt;- steph(afl[afl$Week==i,], robj$ratings)
robj
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
