<!DOCTYPE html><html lang="en"><head><title>Help for package SVEMnet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SVEMnet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SVEMnet-package'><p>SVEMnet: Self-Validated Ensemble Models with Elastic Net Regression</p></a></li>
<li><a href='#coef.svem_model'><p>Plot Coefficient Nonzero Percentages from a SVEMnet Model</p></a></li>
<li><a href='#glmnet_with_cv'><p>Fit a glmnet Model with Cross-Validation</p></a></li>
<li><a href='#plot.svem_model'><p>Plot Method for SVEM Models</p></a></li>
<li><a href='#plot.svem_significance_test'><p>Plot SVEM Significance Test Results for Multiple Responses</p></a></li>
<li><a href='#predict_cv'><p>Predict Function for glmnet_with_cv Models</p></a></li>
<li><a href='#predict.svem_model'><p>Predict Method for SVEM Models</p></a></li>
<li><a href='#print.svem_significance_test'><p>Print Method for SVEM Significance Test</p></a></li>
<li><a href='#svem_significance_test'><p>SVEM Significance Test</p></a></li>
<li><a href='#svem_significance_test_parallel'><p>SVEM Significance Test (Parallel Version)</p></a></li>
<li><a href='#SVEMnet'><p>Fit an SVEMnet Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Self-Validated Ensemble Models with Elastic Net Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew T. Karl &lt;akarl@asu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements Self-Validated Ensemble Models (SVEM, Lemkus et al. (2021) &lt;<a href="https://doi.org/10.1016%2Fj.chemolab.2021.104439">doi:10.1016/j.chemolab.2021.104439</a>&gt;) using Elastic Net regression via 'glmnet' (Friedman et al. &lt;<a href="https://doi.org/10.18637%2Fjss.v033.i01">doi:10.18637/jss.v033.i01</a>&gt;). SVEM averages predictions from multiple models fitted to fractionally weighted bootstraps of the data, tuned with anti-correlated validation weights. Also implements the randomized permutation whole model test for SVEM (Karl (2024) &lt;<a href="https://doi.org/10.1016%2Fj.chemolab.2024.105122">doi:10.1016/j.chemolab.2024.105122</a>&gt;). \\Code for the whole model test was taken from the supplementary material of Karl (2024). Development of this package was assisted by 'GPT o1-preview' for code structure and documentation.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>glmnet, stats, gamlss, gamlss.dist, ggplot2, lhs, doParallel,
parallel, foreach</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-21 18:57:39 UTC; andre</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew T. Karl <a href="https://orcid.org/0000-0002-5933-8706"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-21 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SVEMnet-package'>SVEMnet: Self-Validated Ensemble Models with Elastic Net Regression</h2><span id='topic+SVEMnet-package'></span>

<h3>Description</h3>

<p>The <code>SVEMnet</code> package implements Self-Validated Ensemble Models (SVEM) using Elastic Net (including lasso and ridge) regression via <code>glmnet</code>. SVEM averages predictions from multiple models fitted to fractionally weighted bootstraps of the data, tuned with anti-correlated validation weights.
</p>


<h3>Functions</h3>


<dl>
<dt><code><a href="#topic+SVEMnet">SVEMnet</a></code></dt><dd><p>Fit an SVEMnet model using Elastic Net regression.</p>
</dd>
<dt><code><a href="#topic+svem_significance_test">svem_significance_test</a></code></dt><dd><p>Perform a whole-model significance test for SVEM models.</p>
</dd>
<dt><code><a href="#topic+svem_significance_test_parallel">svem_significance_test_parallel</a></code></dt><dd><p>Perform a whole-model significance test for SVEM models. Parallelized version.</p>
</dd>
<dt><code><a href="#topic+predict.svem_model">predict.svem_model</a></code></dt><dd><p>Predict method for SVEM models.</p>
</dd>
<dt><code><a href="#topic+plot.svem_model">plot.svem_model</a></code></dt><dd><p>Plot method for SVEM models.</p>
</dd>
<dt><code><a href="#topic+coef.svem_model">coef.svem_model</a></code></dt><dd><p>Plot method for SVEM models.</p>
</dd>
<dt><code><a href="#topic+glmnet_with_cv">glmnet_with_cv</a></code></dt><dd><p>Wrapper for cv.glmnet</p>
</dd>
</dl>



<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of some of the code and the roxygen documentation. The code for the significance test is taken from the supplementary material of Karl (2024) (it was handwritten by that author).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Andrew T. Karl <a href="mailto:akarl@asu.edu">akarl@asu.edu</a> (<a href="https://orcid.org/0000-0002-5933-8706">ORCID</a>)
</p>


<h3>References</h3>

<p>Gotwalt, C., &amp; Ramsey, P. (2018). Model Validation Strategies for Designed Experiments Using Bootstrapping Techniques With Applications to Biopharmaceuticals. <em>JMP Discovery Conference</em>. <a href="https://community.jmp.com/t5/Discovery-Summit-2018/Model-Validation-Strategies-for-Designed-Experiments-Using/ta-p/73730">https://community.jmp.com/t5/Discovery-Summit-2018/Model-Validation-Strategies-for-Designed-Experiments-Using/ta-p/73730</a>
</p>
<p>Karl, A. T. (2024). A randomized permutation whole-model test heuristic for Self-Validated Ensemble Models (SVEM). <em>Chemometrics and Intelligent Laboratory Systems</em>, <em>249</em>, 105122. <a href="https://doi.org/10.1016/j.chemolab.2024.105122">doi:10.1016/j.chemolab.2024.105122</a>
</p>
<p>Karl, A., Wisnowski, J., &amp; Rushing, H. (2022). JMP Pro 17 Remedies for Practical Struggles with Mixture Experiments. JMP Discovery Conference. <a href="https://doi.org/10.13140/RG.2.2.34598.40003/1">doi:10.13140/RG.2.2.34598.40003/1</a>
</p>
<p>Lemkus, T., Gotwalt, C., Ramsey, P., &amp; Weese, M. L. (2021). Self-Validated Ensemble Models for Design of Experiments. <em>Chemometrics and Intelligent Laboratory Systems</em>, 219, 104439. <a href="https://doi.org/10.1016/j.chemolab.2021.104439">doi:10.1016/j.chemolab.2021.104439</a>
</p>
<p>Xu, L., Gotwalt, C., Hong, Y., King, C. B., &amp; Meeker, W. Q. (2020). Applications of the Fractional-Random-Weight Bootstrap. <em>The American Statistician</em>, 74(4), 345–358. <a href="https://doi.org/10.1080/00031305.2020.1731599">doi:10.1080/00031305.2020.1731599</a>
</p>
<p>Ramsey, P., Gaudard, M., &amp; Levin, W. (2021). Accelerating Innovation with Space Filling Mixture Designs, Neural Networks and SVEM. <em>JMP Discovery Conference</em>. <a href="https://community.jmp.com/t5/Abstracts/Accelerating-Innovation-with-Space-Filling-Mixture-Designs/ev-p/756841">https://community.jmp.com/t5/Abstracts/Accelerating-Innovation-with-Space-Filling-Mixture-Designs/ev-p/756841</a>
</p>
<p>Ramsey, P., &amp; Gotwalt, C. (2018). Model Validation Strategies for Designed Experiments Using Bootstrapping Techniques With Applications to Biopharmaceuticals. <em>JMP Discovery Conference - Europe</em>. <a href="https://community.jmp.com/t5/Discovery-Summit-Europe-2018/Model-Validation-Strategies-for-Designed-Experiments-Using/ta-p/51286">https://community.jmp.com/t5/Discovery-Summit-Europe-2018/Model-Validation-Strategies-for-Designed-Experiments-Using/ta-p/51286</a>
</p>
<p>Ramsey, P., Levin, W., Lemkus, T., &amp; Gotwalt, C. (2021). SVEM: A Paradigm Shift in Design and Analysis of Experiments. <em>JMP Discovery Conference - Europe</em>. <a href="https://community.jmp.com/t5/Abstracts/SVEM-A-Paradigm-Shift-in-Design-and-Analysis-of-Experiments-2021/ev-p/756634">https://community.jmp.com/t5/Abstracts/SVEM-A-Paradigm-Shift-in-Design-and-Analysis-of-Experiments-2021/ev-p/756634</a>
</p>
<p>Ramsey, P., &amp; McNeill, P. (2023). CMC, SVEM, Neural Networks, DOE, and Complexity: It’s All About Prediction. <em>JMP Discovery Conference</em>.
</p>

<hr>
<h2 id='coef.svem_model'>Plot Coefficient Nonzero Percentages from a SVEMnet Model</h2><span id='topic+coef.svem_model'></span>

<h3>Description</h3>

<p>This function calculates the percentage of bootstrap iterations in which each coefficient
is nonzero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'svem_model'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.svem_model_+3A_object">object</code></td>
<td>
<p>An object of class <code>svem_model</code> returned by the <code>SVEMnet</code> function.</p>
</td></tr>
<tr><td><code id="coef.svem_model_+3A_...">...</code></td>
<td>
<p>other arguments to pass.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a data frame containing the percentage of bootstraps
where each coefficient is nonzero.
</p>


<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of some of the code and the roxygen documentation. The code for the significance test is taken from the supplementary material of Karl (2024) (it was handwritten by that author).
</p>

<hr>
<h2 id='glmnet_with_cv'>Fit a glmnet Model with Cross-Validation</h2><span id='topic+glmnet_with_cv'></span>

<h3>Description</h3>

<p>A wrapper function for <code><a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></code> that takes input arguments in a manner similar to <code><a href="#topic+SVEMnet">SVEMnet</a></code>.
This function searches over multiple <code>alpha</code> values by running <code>cv.glmnet()</code> for each provided <code>alpha</code>, and then
selects the combination of <code>alpha</code> and <code>lambda</code> with the best cross-validation performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmnet_with_cv(
  formula,
  data,
  glmnet_alpha = c(0, 0.5, 1),
  standardize = TRUE,
  nfolds = 10,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glmnet_with_cv_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the model to be fitted.</p>
</td></tr>
<tr><td><code id="glmnet_with_cv_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="glmnet_with_cv_+3A_glmnet_alpha">glmnet_alpha</code></td>
<td>
<p>Elastic Net mixing parameter(s) (default is <code>c(0, 0.5, 1)</code>).
If multiple values are provided, <code>cv.glmnet</code> is run for each <code>alpha</code>, and the model with the lowest cross-validation
error is selected.</p>
</td></tr>
<tr><td><code id="glmnet_with_cv_+3A_standardize">standardize</code></td>
<td>
<p>Logical flag passed to <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>. If <code>TRUE</code> (default), each variable is standardized
before model fitting.</p>
</td></tr>
<tr><td><code id="glmnet_with_cv_+3A_nfolds">nfolds</code></td>
<td>
<p>Number of cross-validation folds (default is <code>10</code>).</p>
</td></tr>
<tr><td><code id="glmnet_with_cv_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses <code><a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></code> to fit a generalized linear model with elastic net regularization,
performing k-fold cross-validation to select the regularization parameter <code>lambda</code>. If multiple <code>alpha</code> values are
provided, it selects the best-performing <code>alpha</code>-<code>lambda</code> pair based on the minimal cross-validation error.
</p>
<p>After fitting, the function calculates a debiasing linear model (if possible). This is done by regressing the actual responses
on the fitted values obtained from the selected model. The resulting linear model is stored in <code>debias_fit</code>.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>parms</code>: Coefficients from the selected <code>cv.glmnet</code> model at <code>lambda.min</code>.
</p>
</li>
<li> <p><code>debias_fit</code>: A linear model of the form <code>y ~ y_pred</code> used for debiasing (if applicable).
</p>
</li>
<li> <p><code>glmnet_alpha</code>: The vector of <code>alpha</code> values considered.
</p>
</li>
<li> <p><code>best_alpha</code>: The selected <code>alpha</code> value that gave the best cross-validation result.
</p>
</li>
<li> <p><code>best_lambda</code>: The <code>lambda</code> value chosen by cross-validation at the selected <code>alpha</code>.
</p>
</li>
<li> <p><code>actual_y</code>: The response vector used in the model.
</p>
</li>
<li> <p><code>training_X</code>: The predictor matrix used in the model.
</p>
</li>
<li> <p><code>y_pred</code>: The fitted values from the final model (no debiasing).
</p>
</li>
<li> <p><code>y_pred_debiased</code>: Debiased fitted values if <code>debias_fit</code> is available.
</p>
</li>
<li> <p><code>formula</code>: The formula used for model fitting.
</p>
</li>
<li> <p><code>terms</code>: The terms object extracted from the model frame.
</p>
</li></ul>



<h3>References</h3>

<p>Friedman, J., Hastie, T., &amp; Tibshirani, R. (2010). Regularization Paths for Generalized Linear Models via Coordinate Descent.
<em>Journal of Statistical Software</em>, 33(1), 1-22. <a href="https://doi.org/10.18637/jss.v033.i01">doi:10.18637/jss.v033.i01</a>
</p>


<h3>See Also</h3>

<p><code><a href="glmnet.html#topic+glmnet">glmnet</a></code>, <code><a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></code>, <code><a href="#topic+SVEMnet">SVEMnet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
n &lt;- 50
X1 &lt;- runif(n)
X2 &lt;- runif(n)
y &lt;- 1 + 2*X1 + 3*X2 + rnorm(n)
data &lt;- data.frame(y, X1, X2)

model_cv &lt;- glmnet_with_cv(y ~ X1 + X2, data = data, glmnet_alpha = c(0,0.5,1))
predictions &lt;- predict_cv(model_cv, data)

</code></pre>

<hr>
<h2 id='plot.svem_model'>Plot Method for SVEM Models</h2><span id='topic+plot.svem_model'></span>

<h3>Description</h3>

<p>Plots actual versus predicted values for an <code>svem_model</code> using <code>ggplot2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'svem_model'
plot(x, plot_debiased = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.svem_model_+3A_x">x</code></td>
<td>
<p>An object of class <code>svem_model</code>.</p>
</td></tr>
<tr><td><code id="plot.svem_model_+3A_plot_debiased">plot_debiased</code></td>
<td>
<p>Logical; if <code>TRUE</code>, includes debiased predictions if available (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="plot.svem_model_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>ggplot2</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates an actual vs. predicted plot for the SVEM model. If <code>plot_debiased</code> is <code>TRUE</code> and debiased predictions are available, it includes them in the plot.
</p>
<p>**Plot Features:**
</p>

<ul>
<li><p> **Actual vs. Predicted Points:** Plots the actual response values against the predicted values from the SVEM model.
</p>
</li>
<li><p> **Debiased Predictions:** If available and <code>plot_debiased</code> is <code>TRUE</code>, debiased predictions are included.
</p>
</li>
<li><p> **Ideal Fit Line:** A dashed line representing perfect prediction (slope = 1, intercept = 0) is included for reference.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>ggplot</code> object showing actual versus predicted values.
</p>


<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of some of the code and the roxygen documentation. The code for the significance test is taken from the supplementary material of Karl (2024) (it was handwritten by that author).
</p>

<hr>
<h2 id='plot.svem_significance_test'>Plot SVEM Significance Test Results for Multiple Responses</h2><span id='topic+plot.svem_significance_test'></span>

<h3>Description</h3>

<p>Plots the Mahalanobis distances for the original and permuted data from multiple SVEM significance test results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'svem_significance_test'
plot(..., labels = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.svem_significance_test_+3A_...">...</code></td>
<td>
<p>One or more objects of class <code>svem_significance_test</code>, which are the outputs from <code><a href="#topic+svem_significance_test">svem_significance_test</a></code>.</p>
</td></tr>
<tr><td><code id="plot.svem_significance_test_+3A_labels">labels</code></td>
<td>
<p>Optional character vector of labels for the responses. If not provided, the function uses the response variable names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a combined plot of the Mahalanobis distances (<code>d_Y</code> and <code>d_pi_Y</code>) for the original and permuted data from multiple SVEM significance test results. It groups the data by response and source type, displaying original and permutation distances side by side for each response.
</p>
<p>**Usage Notes:**
</p>

<ul>
<li><p> Use this function to compare the significance test results across multiple responses.
</p>
</li>
<li><p> The plot shows original and permutation distances next to each other for each response.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>ggplot</code> object showing the distributions of Mahalanobis distances for all responses.
</p>


<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of some of the code and the roxygen documentation. The code for the significance test is taken from the supplementary material of Karl (2024) (it was handwritten by that author).
</p>

<hr>
<h2 id='predict_cv'>Predict Function for glmnet_with_cv Models</h2><span id='topic+predict_cv'></span>

<h3>Description</h3>

<p>Generate predictions from the model fitted by <code><a href="#topic+glmnet_with_cv">glmnet_with_cv</a></code>. This function accepts
new data and returns predictions, optionally debiased if a debiasing linear model was fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_cv(object, newdata, debias = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_cv_+3A_object">object</code></td>
<td>
<p>An object returned by <code><a href="#topic+glmnet_with_cv">glmnet_with_cv</a></code>.</p>
</td></tr>
<tr><td><code id="predict_cv_+3A_newdata">newdata</code></td>
<td>
<p>A data frame of new predictor values.</p>
</td></tr>
<tr><td><code id="predict_cv_+3A_debias">debias</code></td>
<td>
<p>Logical; if <code>TRUE</code>, applies the debiasing linear model stored in
<code>object$debias_fit</code> (if available). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predict_cv_+3A_...">...</code></td>
<td>
<p>Additional arguments (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Predictions are computed by forming the model matrix from <code>newdata</code> using the stored <code>formula</code> and <code>terms</code>
in the fitted model object. The coefficients used are those stored in <code>parms</code>. If <code>debias=TRUE</code> and a
<code>debias_fit</code> linear model is available, predictions are adjusted by that model.
</p>


<h3>Value</h3>

<p>A numeric vector of predictions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glmnet_with_cv">glmnet_with_cv</a></code>, <code><a href="#topic+SVEMnet">SVEMnet</a></code>, <code><a href="#topic+predict.svem_model">predict.svem_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
n &lt;- 50
X1 &lt;- runif(n)
X2 &lt;- runif(n)
y &lt;- 1 + 2*X1 + 3*X2 + rnorm(n)
data &lt;- data.frame(y, X1, X2)
model_cv &lt;- glmnet_with_cv(y ~ X1 + X2, data = data, glmnet_alpha = c(0,0.5,1))
predictions &lt;- predict_cv(model_cv, data)
predictions_debiased &lt;- predict_cv(model_cv, data, debias = TRUE)

</code></pre>

<hr>
<h2 id='predict.svem_model'>Predict Method for SVEM Models</h2><span id='topic+predict.svem_model'></span>

<h3>Description</h3>

<p>Generates predictions from a fitted <code>svem_model</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'svem_model'
predict(object, newdata, debias = FALSE, se.fit = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.svem_model_+3A_object">object</code></td>
<td>
<p>An object of class <code>svem_model</code>.</p>
</td></tr>
<tr><td><code id="predict.svem_model_+3A_newdata">newdata</code></td>
<td>
<p>A data frame of new predictor values.</p>
</td></tr>
<tr><td><code id="predict.svem_model_+3A_debias">debias</code></td>
<td>
<p>Logical; default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predict.svem_model_+3A_se.fit">se.fit</code></td>
<td>
<p>Logical; if <code>TRUE</code>, returns standard errors (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="predict.svem_model_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A debiased fit is available (along with the standard fit). This is provided to allow the user to match the output of JMP.\ https://www.jmp.com/support/help/en/18.1/?utm_source=help&amp;utm_medium=redirect#page/jmp/overview-of-selfvalidated-ensemble-models.shtml. The debiasing coefficients are always calculated by SVEMnet(), and the predict() function determines whether the raw or debiased predictions are returned via the <code>debias</code> argument. Default is <code>FALSE</code> based on performance on unpublished simulation studies.
</p>


<h3>Value</h3>

<p>Predictions or a list containing predictions and standard errors.
</p>


<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of some of the code and the roxygen documentation. The code for the significance test is taken from the supplementary material of Karl (2024) (it was handwritten by that author).
</p>

<hr>
<h2 id='print.svem_significance_test'>Print Method for SVEM Significance Test</h2><span id='topic+print.svem_significance_test'></span>

<h3>Description</h3>

<p>Prints the p-value from an object of class <code>svem_significance_test</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'svem_significance_test'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.svem_significance_test_+3A_x">x</code></td>
<td>
<p>An object of class <code>svem_significance_test</code>.</p>
</td></tr>
<tr><td><code id="print.svem_significance_test_+3A_...">...</code></td>
<td>
<p>Additional arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='svem_significance_test'>SVEM Significance Test</h2><span id='topic+svem_significance_test'></span>

<h3>Description</h3>

<p>Performs a whole-model significance test using the SVEM framework, handling both continuous and categorical predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svem_significance_test(
  formula,
  data,
  nPoint = 2000,
  nSVEM = 5,
  nPerm = 125,
  percent = 85,
  nBoot = 200,
  glmnet_alpha = c(1),
  weight_scheme = c("SVEM"),
  objective = c("wAIC", "wSSE"),
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="svem_significance_test_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the model to be tested.</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_npoint">nPoint</code></td>
<td>
<p>The number of random points to generate in the factor space (default: 2000).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_nsvem">nSVEM</code></td>
<td>
<p>The number of SVEM models to fit to the original data (default: 5).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_nperm">nPerm</code></td>
<td>
<p>The number of SVEM models to fit to permuted data for reference distribution (default: 125).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_percent">percent</code></td>
<td>
<p>The percentage of variance to capture in the SVD (default: 85).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_nboot">nBoot</code></td>
<td>
<p>The number of bootstrap iterations within SVEM (default: 200).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_glmnet_alpha">glmnet_alpha</code></td>
<td>
<p>The alpha parameter(s) for glmnet (default: <code>c(1)</code>).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_weight_scheme">weight_scheme</code></td>
<td>
<p>The weight scheme to use in SVEM (default: &quot;SVEM&quot;).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_objective">objective</code></td>
<td>
<p>Character; the objective function to use in <code><a href="#topic+SVEMnet">SVEMnet</a></code>. Options are &quot;wAIC&quot; or &quot;wSSE&quot; (default: &quot;wAIC&quot;).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_verbose">verbose</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays progress messages (default: <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="svem_significance_test_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the underlying <code>SVEMnet()</code> and then <code>glmnet()</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'svem_significance_test' function implements a whole-model test designed to gauge the significance of a fitted SVEM model compared to the null hypothesis of a constant response surface. This method helps identify responses that have relatively stronger or weaker relationships with study factors.
</p>
<p>The test constructs standardized predictions by centering the SVEM predictions (obtained from <code>SVEMnet()</code>) by the response mean and scaling by the ensemble standard deviation. A reference distribution is created by fitting the SVEM model to multiple randomized permutations of the response vector. The Mahalanobis distances of the original and permuted models are calculated using a reduced-rank singular value decomposition.
</p>
<p>The R code to perform this test (using matrices of nSVEM and nPerm predictions) is taken from the supplementary material of Karl (2024).
</p>
<p>This function assumes that there are no restrictions among the factors (e.g. mixture factors). The method will work with restrictions, but the code would need to be changed to ensure the <code>nPoint</code> points respect the factor restriction(s). For example, <code>rdirichlet()</code> could be used for the mixture factors.
</p>
<p>The <code>SVEMnet</code> parameter <code>debias</code> is hard coded to <code>FALSE</code> for this test. Unpublished simulation work suggests that setting <code>debias=TRUE</code> reduces the power of the test (without affecting the Type I error rate).
</p>


<h3>Value</h3>

<p>A list containing the test results.
</p>


<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of some of the code and the roxygen documentation. The code for the significance test is taken from the supplementary material of Karl (2024) (it was handwritten by that author).
</p>


<h3>References</h3>

<p>Karl, A. T. (2024). A randomized permutation whole-model test heuristic for Self-Validated Ensemble Models (SVEM). <em>Chemometrics and Intelligent Laboratory Systems</em>, <em>249</em>, 105122. <a href="https://doi.org/10.1016/j.chemolab.2024.105122">doi:10.1016/j.chemolab.2024.105122</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
set.seed(1)
n &lt;- 30
X1 &lt;- runif(n)
X2 &lt;- runif(n)
X3 &lt;- runif(n)
y &lt;- 1 + X1 +  X2 + X1 * X2 + X1^2 + rnorm(n)
data &lt;- data.frame(y, X1, X2, X3)

# Perform the SVEM significance test
test_result &lt;- svem_significance_test(
  y ~ (X1 + X2 + X3)^2 + I(X1^2) + I(X2^2) + I(X3^2),
  data = data,
  nPoint = 2000,
  nSVEM = 7,
  nPerm = 150,
  nBoot = 200

)

# View the p-value
print(test_result)


test_result2 &lt;- svem_significance_test(
  y ~ (X1 + X2 )^2 + I(X1^2) + I(X2^2),
  data = data,
  nPoint = 2000,
  nSVEM = 7,
  nPerm = 150,
  nBoot = 200
)

# View the p-value
print(test_result2)


# Plot the Mahalanobis distances
plot(test_result,test_result2)


</code></pre>

<hr>
<h2 id='svem_significance_test_parallel'>SVEM Significance Test (Parallel Version)</h2><span id='topic+svem_significance_test_parallel'></span>

<h3>Description</h3>

<p>Performs a whole-model significance test using the SVEM framework, handling both continuous and categorical predictors, with parallel computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svem_significance_test_parallel(
  formula,
  data,
  nPoint = 2000,
  nSVEM = 7,
  nPerm = 200,
  percent = 85,
  nBoot = 200,
  glmnet_alpha = c(1),
  weight_scheme = c("SVEM"),
  objective = c("wAIC", "wSSE"),
  verbose = TRUE,
  nCore = parallel::detectCores(),
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="svem_significance_test_parallel_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the model to be tested.</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_npoint">nPoint</code></td>
<td>
<p>The number of random points to generate in the factor space (default: 2000).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_nsvem">nSVEM</code></td>
<td>
<p>The number of SVEM models to fit to the original data (default: 7).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_nperm">nPerm</code></td>
<td>
<p>The number of SVEM models to fit to permuted data for reference distribution (default: 200).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_percent">percent</code></td>
<td>
<p>The percentage of variance to capture in the SVD (default: 85).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_nboot">nBoot</code></td>
<td>
<p>The number of bootstrap iterations within SVEM (default: 200).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_glmnet_alpha">glmnet_alpha</code></td>
<td>
<p>The alpha parameter(s) for glmnet (default: <code>c(1)</code>).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_weight_scheme">weight_scheme</code></td>
<td>
<p>The weight scheme to use in SVEM (default: &quot;SVEM&quot;).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_objective">objective</code></td>
<td>
<p>Character; the objective function to use in <code><a href="#topic+SVEMnet">SVEMnet</a></code>. Options are &quot;wAIC&quot; or &quot;wSSE&quot; (default: &quot;wAIC&quot;).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_verbose">verbose</code></td>
<td>
<p>Logical; if <code>TRUE</code>, displays progress messages (default: <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_ncore">nCore</code></td>
<td>
<p>The number of CPU cores to use for parallel processing (default: all available cores).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_seed">seed</code></td>
<td>
<p>An integer seed for random number generation (default: NULL).</p>
</td></tr>
<tr><td><code id="svem_significance_test_parallel_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the underlying <code>SVEMnet()</code> and then <code>glmnet()</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'svem_significance_test_parallel' function implements a whole-model test designed to gauge the significance of a fitted SVEM model compared to the null hypothesis of a constant response surface, with parallel computation. This method helps identify responses that have relatively stronger or weaker relationships with study factors.
</p>
<p>The test constructs standardized predictions by centering the SVEM predictions (obtained from <code>SVEMnet()</code>) by the response mean and scaling by the ensemble standard deviation. A reference distribution is created by fitting the SVEM model to multiple randomized permutations of the response vector. The Mahalanobis distances of the original and permuted models are calculated using a reduced-rank singular value decomposition.
</p>
<p>The R code to perform this test (using matrices of nSVEM and nPerm predictions) is taken from the supplementary material of Karl (2024).
</p>
<p>This function assumes that there are no restrictions among the factors (e.g. mixture factors). The method will work with restrictions, but the code would need to be changed to ensure the <code>nPoint</code> points respect the factor restriction(s). For example, <code>rdirichlet()</code> could be used for the mixture factors.
</p>
<p>The <code>SVEMnet</code> parameter <code>debias</code> is hard coded to <code>FALSE</code> for this test. Unpublished simulation work suggests that setting <code>debias=TRUE</code> reduces the power of the test (without affecting the Type I error rate).
</p>


<h3>Value</h3>

<p>A list containing the test results.
</p>


<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of some of the code and the roxygen documentation. The code for the significance test is taken from the supplementary material of Karl (2024).
</p>


<h3>References</h3>

<p>Karl, A. T. (2024). A randomized permutation whole-model test heuristic for Self-Validated Ensemble Models (SVEM). <em>Chemometrics and Intelligent Laboratory Systems</em>, <em>249</em>, 105122. <a href="https://doi.org/10.1016/j.chemolab.2024.105122">doi:10.1016/j.chemolab.2024.105122</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
set.seed(0)
n &lt;- 30
X1 &lt;- runif(n)
X2 &lt;- runif(n)
X3 &lt;- runif(n)
y &lt;- 1 + X1 +  X2 + X1 * X2 + X1^2 + rnorm(n)
data &lt;- data.frame(y, X1, X2, X3)

#CRAN requires a max of nCore=2 for example. Recommend using default nCore to use entire CPU.

# Perform the SVEM significance test
test_result &lt;- svem_significance_test_parallel(
  y ~ (X1 + X2 + X3)^2 + I(X1^2) + I(X2^2) + I(X3^2),
  data = data,
  nPoint = 2000,
  nSVEM = 9,
  nPerm = 250,
  nBoot = 200,
  nCore = 2
)

# View the p-value
print(test_result)


test_result2 &lt;- svem_significance_test_parallel(
  y ~ (X1 + X2 )^2 + I(X1^2) + I(X2^2),
  data = data,
  nPoint = 2000,
  nSVEM = 9,
  nPerm = 250,
  nBoot = 200,
  nCore = 2
)

# View the p-value
print(test_result2)


# Plot the Mahalanobis distances
plot(test_result,test_result2)


</code></pre>

<hr>
<h2 id='SVEMnet'>Fit an SVEMnet Model</h2><span id='topic+SVEMnet'></span>

<h3>Description</h3>

<p>Wrapper for 'glmnet' (Friedman et al. 2010) to fit an ensemble of Elastic Net models using the Self-Validated Ensemble Model method (SVEM, Lemkus et al. 2021).
Allows searching over multiple alpha values in the Elastic Net penalty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SVEMnet(
  formula,
  data,
  nBoot = 200,
  glmnet_alpha = c(0, 0.5, 1),
  weight_scheme = c("SVEM", "FWR", "Identity"),
  objective = c("wAIC", "wSSE"),
  standardize = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SVEMnet_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the model to be fitted.</p>
</td></tr>
<tr><td><code id="SVEMnet_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="SVEMnet_+3A_nboot">nBoot</code></td>
<td>
<p>Number of bootstrap iterations (default is 200).</p>
</td></tr>
<tr><td><code id="SVEMnet_+3A_glmnet_alpha">glmnet_alpha</code></td>
<td>
<p>Elastic Net mixing parameter(s) (default is <code>c(0, 0.5, 1)</code>).
Can be a vector of alpha values, where <code>alpha = 1</code> corresponds to Lasso and <code>alpha = 0</code> corresponds to Ridge regression.</p>
</td></tr>
<tr><td><code id="SVEMnet_+3A_weight_scheme">weight_scheme</code></td>
<td>
<p>Weighting scheme for SVEM (default is &quot;SVEM&quot;). Valid options are &quot;SVEM&quot;, &quot;FWR&quot;, and &quot;Identity&quot;.
&quot;FWR&quot; calculates the Fractional Weight Regression (Xu et al., 2020) and is included for demonstration;
&quot;SVEM&quot; generally provides better performance.&quot;Identity&quot; simply sets the training and validation weights to 1. Use with <code>nBoot = 1</code> and <code>objective = "wAIC"</code> to get an elastic net fit on the training data using AIC.</p>
</td></tr>
<tr><td><code id="SVEMnet_+3A_objective">objective</code></td>
<td>
<p>Objective function for selecting lambda (default is &quot;wAIC&quot;). Valid options are &quot;wAIC&quot; and &quot;wSSE&quot;.
The &quot;w&quot; refers to &quot;weighted&quot; validation.</p>
</td></tr>
<tr><td><code id="SVEMnet_+3A_standardize">standardize</code></td>
<td>
<p>logical. Passed to <code>glmnet</code> to control standardization (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="SVEMnet_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the underlying <code>glmnet()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Self-Validated Ensemble Model (SVEM, Lemkus et al., 2021) framework provides a bootstrap approach to improve predictions from various base learning models, including Elastic Net regression as implemented in 'glmnet'. SVEM is particularly suited for situations where a complex response surface is modeled with relatively few experimental runs.
</p>
<p>In each of the 'nBoot' iterations, SVEMnet applies random exponentially distributed weights to the observations. Anti-correlated weights are used for validation.
</p>
<p>SVEMnet allows for the Elastic Net mixing parameter ('glmnet_alpha') to be a vector, enabling the function to search over multiple 'alpha' values within each bootstrap iteration. Within each iteration, the model is fit for each specified 'alpha', and the best 'alpha' is selected based on the specified 'objective'.
</p>
<p>objective options:
</p>

<dl>
<dt><code>"wSSE"</code></dt><dd><p>Weighted Sum of Squared Errors. Selects the lambda that minimizes the weighted validation error without penalizing model complexity. While this may lead to models that overfit when the number of parameters is large relative to the number of observations, SVEM mitigates overfitting (high prediction variance) by averaging over multiple bootstrap models. This is the objective function used by Lemkus et al. (2021) with <code>weight_scheme="SVEM"</code></p>
</dd>
<dt><code>"wAIC"</code></dt><dd><p>Weighted Akaike Information Criterion. Balances model fit with complexity by penalizing the number of parameters. It is calculated as <code>AIC = n \* log(wSSE / n) + 2 \* k</code>, where <code>wSSE</code> is the weighted sum of squared errors, <code>n</code> is the number of observations, and <code>k</code> is the number of parameters with nonzero coefficients. Typically used with <code>weight_scheme="FWR"</code> or <code>weight_scheme="Identity"</code></p>
</dd>
</dl>

<p>weight_scheme options:
</p>

<dl>
<dt><code>"SVEM"</code></dt><dd><p>Uses anti-correlated fractional weights for training and validation sets, improving model generalization by effectively simulating multiple training-validation splits (Lemkus et al. (2021)). Published results (Lemkus et al. (2021), Karl (2024)) utilize <code>objective="wSSE"</code>. However, unpublished simulation results suggest improved performance from using <code>objective="wAIC"</code> with <code>weight_scheme="SVEM"</code>. See the SVEMnet Vignette for details.</p>
</dd>
<dt><code>"FWR"</code></dt><dd><p>Fractional Weight Regression as described by Xu et al. (2020). Weights are the same for both training and validation sets. This method does not provide the self-validation benefits of SVEM but is included for comparison.  Used with <code>objective="wAIC"</code>.</p>
</dd>
<dt><code>"Identity"</code></dt><dd><p>Uses weights of 1 for both training and validation. This uses the full dataset for both training and validation, effectively disabling the self-validation mechanism. Use with <code>objective="wAIC"</code> and <code>nBoot=1</code> to fit the Elastic Net on the AIC of the training data.</p>
</dd>
</dl>

<p>A debiased fit is output (along with the standard fit). This is provided to allow the user to match the output of JMP, which returns a debiased fit whenever <code>nBoot&gt;=10</code>. \ https://www.jmp.com/support/help/en/18.1/?utm_source=help&amp;utm_medium=redirect#page/jmp/overview-of-selfvalidated-ensemble-models.shtml. The debiasing coefficients are always calculated by SVEMnet(), and the predict() function determines whether the raw or debiased predictions are returned via its <code>debias</code> argument. The default is <code>debias=FALSE</code>, based on performance on unpublished simulation results.
</p>
<p>The output includes:
**Model Output:**
The returned object is a list of class <code>svem_model</code>, containing the following components:
</p>

<ul>
<li> <p><code>parms</code>: Averaged coefficients across all bootstrap iterations.
</p>
</li>
<li> <p><code>debias_fit</code>: The debiasing linear model fit (if applicable). This is a linear model of the form <code>y ~ y_pred</code>, used to adjust the predictions and reduce bias.
</p>
</li>
<li> <p><code>coef_matrix</code>: Matrix of coefficients from each bootstrap iteration. Each row corresponds to a bootstrap iteration, and each column corresponds to a model coefficient.
</p>
</li>
<li> <p><code>nBoot</code>: Number of bootstrap iterations performed.
</p>
</li>
<li> <p><code>glmnet_alpha</code>: The Elastic Net mixing parameter(s) used. This is the <code>alpha</code> parameter from <code>glmnet</code>.
</p>
</li>
<li> <p><code>best_alphas</code>: The best <code>alpha</code> values selected during the fitting process for each bootstrap iteration.
</p>
</li>
<li> <p><code>best_lambdas</code>: The best <code>lambda</code> values selected during the fitting process for each bootstrap iteration.
</p>
</li>
<li> <p><code>weight_scheme</code>: The weighting scheme used in SVEM. Indicates whether <code>"SVEM"</code>, <code>"FWR"</code>, or <code>"Identity"</code> weights were used.
</p>
</li>
<li> <p><code>actual_y</code>: The response vector used in the model.
</p>
</li>
<li> <p><code>training_X</code>: The predictor matrix used in the model.
</p>
</li>
<li> <p><code>y_pred</code>: The predicted response values from the ensemble model before debiasing.
</p>
</li>
<li> <p><code>y_pred_debiased</code>: The debiased predicted response values (if debiasing is applied). Adjusted predictions using the <code>debias_fit</code> model.
</p>
</li>
<li> <p><code>nobs</code>: The number of observations in the dataset.
</p>
</li>
<li> <p><code>nparm</code>: The number of parameters (including the intercept), calculated as <code>ncol(X) + 1</code>.
</p>
</li>
<li> <p><code>formula</code>: The formula used in the model fitting.
</p>
</li>
<li> <p><code>terms</code>: The terms object extracted from the model frame.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>svem_model</code>.
</p>


<h3>Acknowledgments</h3>

<p>Development of this package was assisted by GPT o1-preview, which helped in constructing the structure of some of the code and the roxygen documentation. The code for the significance test is taken from the supplementary material of Karl (2024) (it was handwritten by that author).
</p>


<h3>References</h3>

<p>Gotwalt, C., &amp; Ramsey, P. (2018). Model Validation Strategies for Designed Experiments Using Bootstrapping Techniques With Applications to Biopharmaceuticals. <em>JMP Discovery Conference</em>. <a href="https://community.jmp.com/t5/Discovery-Summit-2018/Model-Validation-Strategies-for-Designed-Experiments-Using/ta-p/73730">https://community.jmp.com/t5/Discovery-Summit-2018/Model-Validation-Strategies-for-Designed-Experiments-Using/ta-p/73730</a>
</p>
<p>Karl, A. T. (2024). A randomized permutation whole-model test heuristic for Self-Validated Ensemble Models (SVEM). <em>Chemometrics and Intelligent Laboratory Systems</em>, <em>249</em>, 105122. <a href="https://doi.org/10.1016/j.chemolab.2024.105122">doi:10.1016/j.chemolab.2024.105122</a>
</p>
<p>Karl, A., Wisnowski, J., &amp; Rushing, H. (2022). JMP Pro 17 Remedies for Practical Struggles with Mixture Experiments. JMP Discovery Conference. <a href="https://doi.org/10.13140/RG.2.2.34598.40003/1">doi:10.13140/RG.2.2.34598.40003/1</a>
</p>
<p>Lemkus, T., Gotwalt, C., Ramsey, P., &amp; Weese, M. L. (2021). Self-Validated Ensemble Models for Design of Experiments. <em>Chemometrics and Intelligent Laboratory Systems</em>, 219, 104439. <a href="https://doi.org/10.1016/j.chemolab.2021.104439">doi:10.1016/j.chemolab.2021.104439</a>
</p>
<p>Xu, L., Gotwalt, C., Hong, Y., King, C. B., &amp; Meeker, W. Q. (2020). Applications of the Fractional-Random-Weight Bootstrap. <em>The American Statistician</em>, 74(4), 345–358. <a href="https://doi.org/10.1080/00031305.2020.1731599">doi:10.1080/00031305.2020.1731599</a>
</p>
<p>Ramsey, P., Gaudard, M., &amp; Levin, W. (2021). Accelerating Innovation with Space Filling Mixture Designs, Neural Networks and SVEM. <em>JMP Discovery Conference</em>. <a href="https://community.jmp.com/t5/Abstracts/Accelerating-Innovation-with-Space-Filling-Mixture-Designs/ev-p/756841">https://community.jmp.com/t5/Abstracts/Accelerating-Innovation-with-Space-Filling-Mixture-Designs/ev-p/756841</a>
</p>
<p>Ramsey, P., &amp; Gotwalt, C. (2018). Model Validation Strategies for Designed Experiments Using Bootstrapping Techniques With Applications to Biopharmaceuticals. <em>JMP Discovery Conference - Europe</em>. <a href="https://community.jmp.com/t5/Discovery-Summit-Europe-2018/Model-Validation-Strategies-for-Designed-Experiments-Using/ta-p/51286">https://community.jmp.com/t5/Discovery-Summit-Europe-2018/Model-Validation-Strategies-for-Designed-Experiments-Using/ta-p/51286</a>
</p>
<p>Ramsey, P., Levin, W., Lemkus, T., &amp; Gotwalt, C. (2021). SVEM: A Paradigm Shift in Design and Analysis of Experiments. <em>JMP Discovery Conference - Europe</em>. <a href="https://community.jmp.com/t5/Abstracts/SVEM-A-Paradigm-Shift-in-Design-and-Analysis-of-Experiments-2021/ev-p/756634">https://community.jmp.com/t5/Abstracts/SVEM-A-Paradigm-Shift-in-Design-and-Analysis-of-Experiments-2021/ev-p/756634</a>
</p>
<p>Ramsey, P., &amp; McNeill, P. (2023). CMC, SVEM, Neural Networks, DOE, and Complexity: It’s All About Prediction. <em>JMP Discovery Conference</em>.
</p>
<p>Friedman, J. H., Hastie, T., &amp; Tibshirani, R. (2010). Regularization Paths for Generalized Linear Models via Coordinate Descent. <em>Journal of Statistical Software</em>, 33(1), 1–22.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate data
set.seed(0)
n &lt;- 21
X1 &lt;- runif(n)
X2 &lt;- runif(n)
X3 &lt;- runif(n)
y &lt;- 1 + 2*X1 + 3*X2 + X1*X2 + X1^2  + rnorm(n)
data &lt;- data.frame(y, X1, X2, X3)

# Fit the SVEMnet model with a formula
model &lt;- SVEMnet(
  y ~ (X1 + X2 + X3)^2 + I(X1^2) + I(X2^2) + I(X3^2),
  glmnet_alpha = c(1),
  data = data
)
coef(model)
plot(model)
predict(model,data)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
