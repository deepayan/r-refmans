<!DOCTYPE html><html><head><title>Help for package brms.mmrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {brms.mmrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#brms.mmrm-package'><p>brms.mmrm: Bayesian MMRMs using <code>brms</code></p></a></li>
<li><a href='#brm_data'><p>Create and preprocess an MMRM dataset.</p></a></li>
<li><a href='#brm_data_change'><p>Convert to change from baseline.</p></a></li>
<li><a href='#brm_formula'><p>Model formula</p></a></li>
<li><a href='#brm_marginal_data'><p>Marginal summaries of the data.</p></a></li>
<li><a href='#brm_marginal_draws'><p>MCMC draws from the marginal posterior of an MMRM</p></a></li>
<li><a href='#brm_marginal_draws_average'><p>Average marginal MCMC draws across time points.</p></a></li>
<li><a href='#brm_marginal_probabilities'><p>Marginal probabilities on the treatment effect for an MMRM.</p></a></li>
<li><a href='#brm_marginal_summaries'><p>Summary statistics of the marginal posterior of an MMRM.</p></a></li>
<li><a href='#brm_model'><p>Basic MMRM</p></a></li>
<li><a href='#brm_plot_compare'><p>Visually compare the marginals of multiple models and/or datasets.</p></a></li>
<li><a href='#brm_plot_draws'><p>Visualize posterior draws of marginals.</p></a></li>
<li><a href='#brm_prior_simple'><p>Simple prior for a <code>brms</code> MMRM</p></a></li>
<li><a href='#brm_simulate'><p>Deprecated: simulate an MMRM.</p></a></li>
<li><a href='#brm_simulate_categorical'><p>Append simulated categorical covariates</p></a></li>
<li><a href='#brm_simulate_continuous'><p>Append simulated continuous covariates</p></a></li>
<li><a href='#brm_simulate_outline'><p>Start a simulated dataset</p></a></li>
<li><a href='#brm_simulate_prior'><p>Prior predictive draws.</p></a></li>
<li><a href='#brm_simulate_simple'><p>Simple MMRM simulation.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian MMRMs using 'brms'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>The mixed model for repeated measures (MMRM) is a popular
  model for longitudinal clinical trial data with continuous endpoints,
  and 'brms' is a powerful and versatile package for fitting Bayesian
  regression models.  The 'brms.mmrm' R package leverages 'brms' to run
  MMRMs, and it supports a simplified interfaced to reduce difficulty
  and align with the best practices of the life sciences.  References:
  Bürkner (2017) &lt;<a href="https://doi.org/10.18637%2Fjss.v080.i01">doi:10.18637/jss.v080.i01</a>&gt;, Mallinckrodt (2008)
  &lt;<a href="https://doi.org/10.1177%2F009286150804200402">doi:10.1177/009286150804200402</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://openpharma.github.io/brms.mmrm/">https://openpharma.github.io/brms.mmrm/</a>,
<a href="https://github.com/openpharma/brms.mmrm">https://github.com/openpharma/brms.mmrm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/openpharma/brms.mmrm/issues">https://github.com/openpharma/brms.mmrm/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>brms (&ge; 2.19.0), coda, dplyr, emmeans (&ge; 1.8.7), ggplot2,
ggridges, MASS, posterior, purrr, rlang, stats, tibble, tidyr,
tidyselect, trialr, utils, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>BH, fst, gt, gtsummary, knitr (&ge; 1.30), markdown (&ge; 1.1),
mmrm, parallel, Rcpp, RcppEigen, RcppParallel, rmarkdown (&ge;
2.4), rstan, StanHeaders, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-14 21:04:54 UTC; C240390</td>
</tr>
<tr>
<td>Author:</td>
<td>William Michael Landau
    <a href="https://orcid.org/0000-0003-1878-3253"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Kevin Kunzmann <a href="https://orcid.org/0000-0002-1140-7143"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Yoni Sidi [aut],
  Christian Stock <a href="https://orcid.org/0000-0002-3493-3234"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Eli Lilly and Company [cph, fnd],
  Boehringer Ingelheim Pharma GmbH &amp; Co. KG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>William Michael Landau &lt;will.landau.oss@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-15 07:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='brms.mmrm-package'>brms.mmrm: Bayesian MMRMs using <code>brms</code></h2><span id='topic+brms.mmrm-package'></span>

<h3>Description</h3>

<p>The mixed model for repeated measures (MMRM) is a
popular model for longitudinal clinical trial data with
continuous endpoints, and <code>brms</code> a is powerful and versatile
package for fitting Bayesian regression models.
The <code>brms.mmrm</code> R package leverages <code>brms</code> to run MMRMs, and
it supports a simplified interfaced to reduce difficulty
and align with the best practices of the life sciences.
</p>


<h3>References</h3>


<ul>
<li><p> Bürkner, P.-C. (2017), &quot;brms: An R package for Bayesian
multilevel models using Stan,&quot;
Journal of Statistical Software, 80, 1–28.
https://doi.org/10.18637/jss.v080.i01.
</p>
</li>
<li><p> Mallinckrodt, C. H., Lane, P. W., Schnell, D., and others (2008),
&quot;Recommendations for the primary analysis of continuous endpoints
in longitudinal clinical trials,&quot;
Therapeutic Innovation and Regulatory Science, 42, 303–319.
https://doi.org/10.1177/009286150804200402.
</p>
</li>
<li><p> Mallinckrodt, C. H., and Lipkovich, I. (2017),
Analyzing longitudinal clinical trial data: A practical guide,
CRC Press, Taylor &amp; Francis Group.
</p>
</li></ul>


<hr>
<h2 id='brm_data'>Create and preprocess an MMRM dataset.</h2><span id='topic+brm_data'></span>

<h3>Description</h3>

<p>Create a dataset to analyze with an MMRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_data(
  data,
  outcome = "CHG",
  role = "change",
  baseline = NULL,
  group = "TRT01P",
  subgroup = NULL,
  time = "AVISIT",
  patient = "USUBJID",
  covariates = character(0L),
  missing = NULL,
  reference_group = "Placebo",
  level_control = NULL,
  reference_subgroup = NULL,
  reference_time = NULL,
  level_baseline = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_data_+3A_data">data</code></td>
<td>
<p>Data frame or tibble with longitudinal data.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_outcome">outcome</code></td>
<td>
<p>Character of length 1, name of the outcome variable.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_role">role</code></td>
<td>
<p>Character of length 1. Either <code>"response"</code> if <code>outcome</code>
is the raw response variable (e.g. AVAL) or <code>"change"</code> if <code>outcome</code>
is change from baseline (e.g. CHG).</p>
</td></tr>
<tr><td><code id="brm_data_+3A_baseline">baseline</code></td>
<td>
<p>Character of length 1,
name of the baseline response variable.
Only relevant if the response variable is change from baseline.
Supply <code>NULL</code> to ignore or omit.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_group">group</code></td>
<td>
<p>Character of length 1, name of the treatment group variable.
Must point to a character vector in the data. Factors are converted
to characters.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_subgroup">subgroup</code></td>
<td>
<p>Character of length 1, optional name of the a
discrete subgroup variable. Set to <code>NULL</code> to omit the subgroup (default).</p>
</td></tr>
<tr><td><code id="brm_data_+3A_time">time</code></td>
<td>
<p>Character of length 1, name of the discrete time variable.
Must point to a character vector in the data. Factors are converted
to characters.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_patient">patient</code></td>
<td>
<p>Character of length 1, name of the patient ID variable.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_covariates">covariates</code></td>
<td>
<p>Character vector of names of other covariates.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_missing">missing</code></td>
<td>
<p>Character of length 1, name of an optional variable
in a simulated dataset to indicate which outcome values should be missing.
Set to <code>NULL</code> to omit.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_reference_group">reference_group</code></td>
<td>
<p>Character of length 1, Level of the <code>group</code> column
to indicate the control group.
<code>reference_group</code> only applies to the post-processing that happens
in functions like <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code> downstream of the model.
It does not control the fixed effect parameterization in the
model matrix that <code>brms</code> derives from the formula from <code>brm_formula()</code>.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_level_control">level_control</code></td>
<td>
<p>Deprecated on 2024-01-11 (version 0.2.0.9002).
Use <code>reference_group</code> instead.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_reference_subgroup">reference_subgroup</code></td>
<td>
<p>Character of length 1,
level of the <code>subgroup</code> column
to use as a reference for pairwise differences in when computing
marginal means downstream of the model.
It does not control the fixed effect parameterization in the
model matrix that <code>brms</code> derives from the formula from <code>brm_formula()</code>.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_reference_time">reference_time</code></td>
<td>
<p>Character of length 1 or <code>NULL</code>,
level of the <code>time</code> column to indicate the baseline time point.
This value should not be present in the data if the outcome
variable is change from baseline, but it must be in the data
if the outcome variable is the raw response so that <code>brms.mmrm</code>
can produce model-based marginal estimates of change from baseline.
In other words, set <code>reference_time</code> to <code>NULL</code> if <code>role</code> is <code>"change"</code>,
and set <code>reference_time</code> to a non-null value in <code>data[[time]]</code>
if <code>role</code> is <code>"response"</code>.
</p>
<p>Note: <code>reference_time</code> only applies to the post-processing that happens
in functions like <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code> downstream of the model.
It does not control the fixed effect parameterization in the
model matrix that <code>brms</code> derives from the formula from <code>brm_formula()</code>.</p>
</td></tr>
<tr><td><code id="brm_data_+3A_level_baseline">level_baseline</code></td>
<td>
<p>Deprecated on 2024-01-11 (version 0.2.0.9002).
Use <code>reference_time</code> instead.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A classed tibble with attributes which denote features of
the data such as the treatment group and discrete time variables.
</p>


<h3>Preprocessing</h3>

<p>The preprocessing steps in <code>brm_data()</code> are as follows:
</p>

<ul>
<li><p> Perform basic assertions to make sure the data and other arguments
are properly formatted.
</p>
</li>
<li><p> Convert the group and time columns to character vectors.
</p>
</li>
<li><p> Sanitize the levels of the group and time columns using
<code>make.names(unique = FALSE, allow_ = TRUE)</code> to ensure agreement
between the data and the output of <code>brms</code>.
</p>
</li>
<li><p> For each implicitly missing outcome observation, add explicit row
with the outcome variable equal to <code>NA_real_</code>.
</p>
</li>
<li><p> Arrange the rows of the data by group, then patient, then discrete time.
</p>
</li>
<li><p> Select only the columns of the data relevant to an MMRM analysis.
</p>
</li></ul>



<h3>Separation string</h3>

<p>Post-processing in <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code> names each of the
group-by-time marginal means with the delimiting character string
from <code>Sys.getenv("BRM_SEP", unset = "|")</code>. Neither the column names
nor element names of the group and time variables can contain
this string. To set a custom string yourself, use
<code>Sys.setenv(BRM_SEP = "YOUR_CUSTOM_STRING")</code>.
</p>


<h3>See Also</h3>

<p>Other data: 
<code><a href="#topic+brm_data_change">brm_data_change</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
data &lt;- brm_simulate_simple()$data
colnames(data) &lt;- paste0("col_", colnames(data))
data
brm_data(
  data = data,
  outcome = "col_response",
  role = "response",
  group = "col_group",
  time = "col_time",
  patient = "col_patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
</code></pre>

<hr>
<h2 id='brm_data_change'>Convert to change from baseline.</h2><span id='topic+brm_data_change'></span>

<h3>Description</h3>

<p>Convert a dataset from raw response to change from baseline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_data_change(data, name_change = "change", name_baseline = "baseline")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_data_change_+3A_data">data</code></td>
<td>
<p>A classed <code>tibble</code> (e.g. from <code><a href="#topic+brm_data">brm_data()</a></code>) with raw response
as the outcome variable (role = <code>"response"</code> in <code><a href="#topic+brm_data">brm_data()</a></code>).</p>
</td></tr>
<tr><td><code id="brm_data_change_+3A_name_change">name_change</code></td>
<td>
<p>Character of length 1, name of the new outcome column
for change from baseline.</p>
</td></tr>
<tr><td><code id="brm_data_change_+3A_name_baseline">name_baseline</code></td>
<td>
<p>Character of length 1, name of the new column for
the original baseline response.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A classed <code>tibble</code> with change from baseline as the outcome variable
and the internal attributes modified accordingly. A special baseline
column is also created, and the original raw response column is removed.
The new baseline column is comprised of the elements of the response
variable corresponding to the <code>reference_time</code> argument of <code><a href="#topic+brm_data">brm_data()</a></code>.
</p>
<p>If there is a column to denote missing values for simulation purposes,
e.g. the <code>"missing"</code> column generated by <code>brm_simulate_outline()</code>,
then missing baseline values are propagated accordingly such that
change from baseline will be missing if either the post-baseline response
is missing or the baseline response is missing.
</p>


<h3>See Also</h3>

<p>Other data: 
<code><a href="#topic+brm_data">brm_data</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
data &lt;- brm_data(
  data = dplyr::rename(brm_simulate_simple()$data, y_values = response),
  outcome = "y_values",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
data
attr(data, "brm_role")
attr(data, "brm_outcome")
attr(data, "brm_baseline")
attr(data, "brm_reference_time")
changed &lt;- brm_data_change(data = data, name_change = "delta")
changed
attr(changed, "brm_role")
attr(changed, "brm_outcome")
attr(changed, "brm_baseline")
attr(data, "brm_reference_time")
</code></pre>

<hr>
<h2 id='brm_formula'>Model formula</h2><span id='topic+brm_formula'></span>

<h3>Description</h3>

<p>Build a model formula for an MMRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_formula(
  data,
  intercept = TRUE,
  baseline = !is.null(attr(data, "brm_baseline")),
  baseline_subgroup = !is.null(attr(data, "brm_baseline")) &amp;&amp; !is.null(attr(data,
    "brm_subgroup")),
  baseline_subgroup_time = !is.null(attr(data, "brm_baseline")) &amp;&amp; !is.null(attr(data,
    "brm_subgroup")),
  baseline_time = !is.null(attr(data, "brm_baseline")),
  group = TRUE,
  group_subgroup = !is.null(attr(data, "brm_subgroup")),
  group_subgroup_time = !is.null(attr(data, "brm_subgroup")),
  group_time = TRUE,
  subgroup = !is.null(attr(data, "brm_subgroup")),
  subgroup_time = !is.null(attr(data, "brm_subgroup")),
  time = TRUE,
  correlation = "unstructured",
  effect_baseline = NULL,
  effect_group = NULL,
  effect_time = NULL,
  interaction_baseline = NULL,
  interaction_group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_formula_+3A_data">data</code></td>
<td>
<p>A classed data frame from <code><a href="#topic+brm_data">brm_data()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_intercept">intercept</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> (default) to include an intercept, <code>FALSE</code> to omit.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_baseline">baseline</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include an additive effect for baseline
response, <code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="#topic+brm_data">brm_data()</a></code> previously declared a baseline
variable in the dataset.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_baseline_subgroup">baseline_subgroup</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include baseline-by-subgroup interaction, <code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="#topic+brm_data">brm_data()</a></code> previously declared baseline
and subgroup variables in the dataset.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_baseline_subgroup_time">baseline_subgroup_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include baseline-by-subgroup-by-time interaction,
<code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="#topic+brm_data">brm_data()</a></code> previously declared baseline
and subgroup variables in the dataset.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_baseline_time">baseline_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include baseline-by-time interaction, <code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="#topic+brm_data">brm_data()</a></code> previously declared a baseline
variable in the dataset.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_group">group</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> (default) to include additive effects for
treatment groups, <code>FALSE</code> to omit.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_group_subgroup">group_subgroup</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include group-by-subgroup interaction, <code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="#topic+brm_data">brm_data()</a></code> previously declared a subgroup
variable in the dataset.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_group_subgroup_time">group_subgroup_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include group-by-subgroup-by-time interaction, <code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="#topic+brm_data">brm_data()</a></code> previously declared a subgroup
variable in the dataset.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_group_time">group_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> (default) to include group-by-time interaction, <code>FALSE</code> to omit.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_subgroup">subgroup</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include additive fixed effects for subgroup levels,
<code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="#topic+brm_data">brm_data()</a></code> previously declared a subgroup
variable in the dataset.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_subgroup_time">subgroup_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include subgroup-by-time interaction, <code>FALSE</code> to omit.
Default is <code>TRUE</code> if <code><a href="#topic+brm_data">brm_data()</a></code> previously declared a subgroup
variable in the dataset.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_time">time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> (default) to include a additive effect for discrete time,
<code>FALSE</code> to omit.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_correlation">correlation</code></td>
<td>
<p>Character of length 1, name of the correlation
structure. Only <code>"unstructured"</code> is currently supported.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_effect_baseline">effect_baseline</code></td>
<td>
<p>Deprecated on 2024-01-16 (version 0.0.2.9002).
Use <code>baseline</code> instead.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_effect_group">effect_group</code></td>
<td>
<p>Deprecated on 2024-01-16 (version 0.0.2.9002).
Use <code>group</code> instead.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_effect_time">effect_time</code></td>
<td>
<p>Deprecated on 2024-01-16 (version 0.0.2.9002).
Use <code>time</code> instead.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_interaction_baseline">interaction_baseline</code></td>
<td>
<p>Deprecated on 2024-01-16 (version 0.0.2.9002).
Use <code>baseline_time</code> instead.</p>
</td></tr>
<tr><td><code id="brm_formula_+3A_interaction_group">interaction_group</code></td>
<td>
<p>Deprecated on 2024-01-16 (version 0.0.2.9002).
Use <code>group_time</code> instead.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+brm_formula">brm_formula()</a></code> builds an R formula for an MMRM based on
the details in the data and your choice of parameterization.
Customize your parameterization by toggling on or off
the various <code>TRUE</code>/<code>FALSE</code> arguments of <code><a href="#topic+brm_formula">brm_formula()</a></code>,
such as <code>intercept</code>, <code>baseline</code>, and <code>group_time</code>.
All plausible additive effects, two-way interactions, and
three-way interactions can be specified. The following interactions
are not supported:
</p>

<ul>
<li><p> Any interactions with the concomitant covariates you specified in the
<code>covariates</code> argument of <code><a href="#topic+brm_data">brm_data()</a></code>.
</p>
</li>
<li><p> Any interactions which include baseline response and treatment
group together. Rationale: in a randomized controlled experiment,
baseline and treatment group assignment should be uncorrelated.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>"brmsformula"</code> returned from
<code>brms::brmsformula()</code>. It contains the fixed effect parameterization,
correlation structure, and residual variance structure.
</p>


<h3>Parameterization</h3>

<p>The formula is not the only factor
that determines the fixed effect parameterization.
The ordering of the categorical variables in the data,
as well as the <code>contrast</code> option in R, affect the
construction of the model matrix. To see the model
matrix that will ultimately be used in <code><a href="#topic+brm_model">brm_model()</a></code>,
run <code><a href="brms.html#topic+make_standata">brms::make_standata()</a></code> and examine the <code>X</code> element
of the returned list. See the examples below for a
demonstration.
</p>


<h3>See Also</h3>

<p>Other models: 
<code><a href="#topic+brm_model">brm_model</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
brm_formula(data)
brm_formula(data = data, intercept = FALSE, baseline = FALSE)
formula &lt;- brm_formula(
  data = data,
  intercept = FALSE,
  baseline = FALSE,
  group = FALSE
)
formula
# Optional: set the contrast option, which determines the model matrix.
options(contrasts = c(unordered = "contr.SAS", ordered = "contr.poly"))
# See the fixed effect parameterization you get from the data:
head(brms::make_standata(formula = formula, data = data)$X)
# Specify a different contrast method to use an alternative
# parameterization when fitting the model with brm_model():
options(
  contrasts = c(unordered = "contr.treatment", ordered = "contr.poly")
)
# different model matrix than before:
head(brms::make_standata(formula = formula, data = data)$X)
</code></pre>

<hr>
<h2 id='brm_marginal_data'>Marginal summaries of the data.</h2><span id='topic+brm_marginal_data'></span>

<h3>Description</h3>

<p>Marginal summaries of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_marginal_data(
  data,
  level = 0.95,
  use_subgroup = !is.null(attr(data, "brm_subgroup"))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_marginal_data_+3A_data">data</code></td>
<td>
<p>A classed data frame from <code><a href="#topic+brm_data">brm_data()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_data_+3A_level">level</code></td>
<td>
<p>Numeric of length 1 from 0 to 1, level of the confidence
intervals.</p>
</td></tr>
<tr><td><code id="brm_marginal_data_+3A_use_subgroup">use_subgroup</code></td>
<td>
<p>Logical of length 1, whether to summarize the data by
each subgroup level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with one row per summary statistic and the following
columns:
</p>

<ul>
<li> <p><code>group</code>: treatment group.
</p>
</li>
<li> <p><code>subgroup</code>: subgroup level. Only included if the <code>subgroup</code>
argument of <code><a href="#topic+brm_marginal_data">brm_marginal_data()</a></code> is <code>TRUE</code>.
</p>
</li>
<li> <p><code>time</code>: discrete time point.
</p>
</li>
<li> <p><code>statistic</code>: type of summary statistic.
</p>
</li>
<li> <p><code>value</code>: numeric value of the estimate.
</p>
</li></ul>

<p>The <code>statistic</code> column has the following possible values:
</p>

<ul>
<li> <p><code>mean</code>: observed mean response after removing missing values.
</p>
</li>
<li> <p><code>median</code>: observed median response after removing missing values.
</p>
</li>
<li> <p><code>sd</code>: observed standard deviation of the response after
removing missing values.
</p>
</li>
<li> <p><code>lower</code>: lower bound of a normal equal-tailed confidence interval
with confidence level determined by the <code>level</code> argument.
</p>
</li>
<li> <p><code>upper</code>: upper bound of a normal equal-tailed confidence interval
with confidence level determined by the <code>level</code> argument.
</p>
</li>
<li> <p><code>n_observe</code>: number of non-missing values in the response.
</p>
</li>
<li> <p><code>n_total</code>: number of total records in the data for the given
group/time combination, including both observed and missing values.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other marginals: 
<code><a href="#topic+brm_marginal_draws">brm_marginal_draws</a>()</code>,
<code><a href="#topic+brm_marginal_draws_average">brm_marginal_draws_average</a>()</code>,
<code><a href="#topic+brm_marginal_probabilities">brm_marginal_probabilities</a>()</code>,
<code><a href="#topic+brm_marginal_summaries">brm_marginal_summaries</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0L)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
brm_marginal_data(data = data)
</code></pre>

<hr>
<h2 id='brm_marginal_draws'>MCMC draws from the marginal posterior of an MMRM</h2><span id='topic+brm_marginal_draws'></span>

<h3>Description</h3>

<p>Get marginal posterior draws from a fitted MMRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_marginal_draws(
  model,
  data,
  use_subgroup = !is.null(attr(data, "brm_subgroup")),
  control = NULL,
  baseline = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_marginal_draws_+3A_model">model</code></td>
<td>
<p>Fitted <code>brms</code> model object from <code><a href="#topic+brm_model">brm_model()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_draws_+3A_data">data</code></td>
<td>
<p>Classed tibble with preprocessed data from <code><a href="#topic+brm_data">brm_data()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_draws_+3A_use_subgroup">use_subgroup</code></td>
<td>
<p>Logical of length 1, whether to summarize the draws by
each subgroup level. If <code>TRUE</code>, subgroup-specific marginals are given.
Otherwise, the subgroup is marginalized out.</p>
</td></tr>
<tr><td><code id="brm_marginal_draws_+3A_control">control</code></td>
<td>
<p>Deprecated. Set the control group level in <code><a href="#topic+brm_data">brm_data()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_draws_+3A_baseline">baseline</code></td>
<td>
<p>Deprecated. Set the control group level in <code><a href="#topic+brm_data">brm_data()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of tibbles of MCMC draws of the marginal posterior
distribution of each treatment group and time point
(or group-by-subgroup-by-time, if applicable).
In each tibble, there is 1 row per posterior sample and one column for
each type of marginal distribution (i.e. each combination of treatment
group and discrete time point. The specific <code>tibble</code>s in the returned
list are described below:
</p>

<ul>
<li> <p><code>response</code>: on the scale of the response variable.
</p>
</li>
<li> <p><code>difference_time</code>: change from baseline: the
<code>response</code> at a particular time minus the <code>response</code> at baseline
(<code>reference_time</code>).
Only returned if the <code>role</code> argument of <code><a href="#topic+brm_data">brm_data()</a></code> was
<code>"response"</code>. (If <code>role</code> is <code>"change"</code>, then <code>response</code> already
represents change from baseline.)
</p>
</li>
<li> <p><code>difference_group</code>: treatment effect: the
the <code>difference_time</code> at each active group minus the <code>difference_time</code>
at the control group (<code>reference_group</code>).
If <code>role</code> is <code>"change"</code>, then treatment group
is instead the difference between <code>response</code> at each active group minus
the <code>response</code> at the control group.
</p>
</li>
<li> <p><code>difference_subgroup</code>: subgroup differences: the <code>difference_group</code>
at each subgroup level minus the <code>difference_group</code> at the subgroup
reference level (<code>reference_subgroup</code>).
</p>
</li></ul>



<h3>Separation string</h3>

<p>Post-processing in <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code> names each of the
group-by-time marginal means with the delimiting character string
from <code>Sys.getenv("BRM_SEP", unset = "|")</code>. Neither the column names
nor element names of the group and time variables can contain
this string. To set a custom string yourself, use
<code>Sys.setenv(BRM_SEP = "YOUR_CUSTOM_STRING")</code>.
</p>


<h3>See Also</h3>

<p>Other marginals: 
<code><a href="#topic+brm_marginal_data">brm_marginal_data</a>()</code>,
<code><a href="#topic+brm_marginal_draws_average">brm_marginal_draws_average</a>()</code>,
<code><a href="#topic+brm_marginal_probabilities">brm_marginal_probabilities</a>()</code>,
<code><a href="#topic+brm_marginal_summaries">brm_marginal_summaries</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (identical(Sys.getenv("BRM_EXAMPLES", unset = ""), "true")) {
set.seed(0L)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
tmp &lt;- utils::capture.output(
  suppressMessages(
    suppressWarnings(
      model &lt;- brm_model(
        data = data,
        formula = formula,
        chains = 1,
        iter = 100,
        refresh = 0
      )
    )
  )
)
brm_marginal_draws(model = model, data = data)
}
</code></pre>

<hr>
<h2 id='brm_marginal_draws_average'>Average marginal MCMC draws across time points.</h2><span id='topic+brm_marginal_draws_average'></span>

<h3>Description</h3>

<p>Simple un-weighted arithmetic mean of
marginal MCMC draws across time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_marginal_draws_average(draws, data, times = NULL, label = "average")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_marginal_draws_average_+3A_draws">draws</code></td>
<td>
<p>List of posterior draws from <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_draws_average_+3A_data">data</code></td>
<td>
<p>Classed tibble with preprocessed data from <code><a href="#topic+brm_data">brm_data()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_draws_average_+3A_times">times</code></td>
<td>
<p>Character vector of discrete time point levels
over which to average the MCMC samples within treatment group levels.
Set to <code>NULL</code> to average across all time points. Levels are automatically
sanitized with <code>make.names(unique = FALSE, allow_ = TRUE)</code> to ensure
agreement with <code>brms</code> variable names in downstream computations.</p>
</td></tr>
<tr><td><code id="brm_marginal_draws_average_+3A_label">label</code></td>
<td>
<p>Character of length 1, time point label for the averages.
Automatically sanitized with <code>make.names(unique = FALSE, allow_ = TRUE)</code>.
Must not conflict with any existing time point labels in the data
after the label and time points are sanitized.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of tibbles of MCMC draws of the marginal posterior
distribution of each treatment group and time point
(or group-by-subgroup-by-time, if applicable).
In each tibble, there is 1 row per posterior sample sand one column for
each type of marginal distribution (i.e. each combination of treatment
group and discrete time point. The specific <code>tibble</code>s in the returned
list are described below:
</p>

<ul>
<li> <p><code>response</code>: on the scale of the response variable.
</p>
</li>
<li> <p><code>difference_time</code>: change from baseline: the
<code>response</code> at a particular time minus the <code>response</code> at baseline
(<code>reference_time</code>).
Only returned if the <code>role</code> argument of <code><a href="#topic+brm_data">brm_data()</a></code> was
<code>"response"</code>. (If <code>role</code> is <code>"change"</code>, then <code>response</code> already
represents change from baseline.)
</p>
</li>
<li> <p><code>difference_group</code>: treatment effect: the
the <code>difference_time</code> at each active group minus the <code>difference_time</code>
at the control group (<code>reference_group</code>).
If <code>role</code> is <code>"change"</code>, then treatment group
is instead the difference between <code>response</code> at each active group minus
the <code>response</code> at the control group.
</p>
</li>
<li> <p><code>difference_subgroup</code>: subgroup differences: the <code>difference_group</code>
at each subgroup level minus the <code>difference_group</code> at the subgroup
reference level (<code>reference_subgroup</code>).
</p>
</li></ul>



<h3>Separation string</h3>

<p>Post-processing in <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code> names each of the
group-by-time marginal means with the delimiting character string
from <code>Sys.getenv("BRM_SEP", unset = "|")</code>. Neither the column names
nor element names of the group and time variables can contain
this string. To set a custom string yourself, use
<code>Sys.setenv(BRM_SEP = "YOUR_CUSTOM_STRING")</code>.
</p>


<h3>See Also</h3>

<p>Other marginals: 
<code><a href="#topic+brm_marginal_data">brm_marginal_data</a>()</code>,
<code><a href="#topic+brm_marginal_draws">brm_marginal_draws</a>()</code>,
<code><a href="#topic+brm_marginal_probabilities">brm_marginal_probabilities</a>()</code>,
<code><a href="#topic+brm_marginal_summaries">brm_marginal_summaries</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (identical(Sys.getenv("BRM_EXAMPLES", unset = ""), "true")) {
set.seed(0L)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
tmp &lt;- utils::capture.output(
  suppressMessages(
    suppressWarnings(
      model &lt;- brm_model(
        data = data,
        formula = formula,
        chains = 1,
        iter = 100,
        refresh = 0
      )
    )
  )
)
draws &lt;- brm_marginal_draws(model = model, data = data)
brm_marginal_draws_average(draws = draws, data = data)
brm_marginal_draws_average(
  draws = draws,
  data = data,
  times = c("time_1", "time_2"),
  label = "mean"
)
}
</code></pre>

<hr>
<h2 id='brm_marginal_probabilities'>Marginal probabilities on the treatment effect for an MMRM.</h2><span id='topic+brm_marginal_probabilities'></span>

<h3>Description</h3>

<p>Marginal probabilities on the treatment effect for an MMRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_marginal_probabilities(draws, direction = "greater", threshold = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_marginal_probabilities_+3A_draws">draws</code></td>
<td>
<p>Posterior draws of the marginal posterior
obtained from <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_probabilities_+3A_direction">direction</code></td>
<td>
<p>Character vector of the same length as <code>threshold</code>.
<code>"greater"</code> to compute the marginal posterior probability that the
treatment effect is greater than the threshold,
<code>"less"</code> to compute the marginal posterior probability that the
treatment effect is less than the threshold.
Each element <code>direction[i]</code> corresponds to <code>threshold[i]</code>
for all <code>i</code> from 1 to <code>length(direction)</code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_probabilities_+3A_threshold">threshold</code></td>
<td>
<p>Numeric vector of the same length as <code>direction</code>,
treatment effect threshold for computing posterior probabilities.
Each element <code>direction[i]</code> corresponds to <code>threshold[i]</code> for
all <code>i</code> from 1 to <code>length(direction)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble of probabilities of the form
<code style="white-space: pre;">&#8288;Prob(treatment effect &gt; threshold | data)&#8288;</code> and/or
<code style="white-space: pre;">&#8288;Prob(treatment effect &lt; threshold | data)&#8288;</code>. It has one row per
probability and the following columns:
* <code>group</code>: treatment group.
* <code>subgroup</code>: subgroup level, if applicable.
* <code>time</code>: discrete time point,
* <code>direction</code>: direction of the comparison in the marginal probability:
<code>"greater"</code> for <code>&gt;</code>, <code>"less"</code> for <code>&lt;</code>
* <code>threshold</code>: treatment effect threshold in the probability statement.
* <code>value</code>: numeric value of the estimate of the probability.
</p>


<h3>See Also</h3>

<p>Other marginals: 
<code><a href="#topic+brm_marginal_data">brm_marginal_data</a>()</code>,
<code><a href="#topic+brm_marginal_draws">brm_marginal_draws</a>()</code>,
<code><a href="#topic+brm_marginal_draws_average">brm_marginal_draws_average</a>()</code>,
<code><a href="#topic+brm_marginal_summaries">brm_marginal_summaries</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (identical(Sys.getenv("BRM_EXAMPLES", unset = ""), "true")) {
set.seed(0L)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
tmp &lt;- utils::capture.output(
  suppressMessages(
    suppressWarnings(
      model &lt;- brm_model(
        data = data,
        formula = formula,
        chains = 1,
        iter = 100,
        refresh = 0
      )
    )
  )
)
draws &lt;- brm_marginal_draws(model = model, data = data)
brm_marginal_probabilities(draws, direction = "greater", threshold = 0)
}
</code></pre>

<hr>
<h2 id='brm_marginal_summaries'>Summary statistics of the marginal posterior of an MMRM.</h2><span id='topic+brm_marginal_summaries'></span>

<h3>Description</h3>

<p>Summary statistics of the marginal posterior of an MMRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_marginal_summaries(draws, level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_marginal_summaries_+3A_draws">draws</code></td>
<td>
<p>Posterior draws of the marginal posterior
obtained from <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_marginal_summaries_+3A_level">level</code></td>
<td>
<p>Numeric of length 1 between 0 and 1, credible level
for the credible intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with one row per summary statistic and the following
columns:
</p>

<ul>
<li> <p><code>marginal</code>: type of marginal distribution. If <code>outcome</code> was <code>"response"</code>
in <code><a href="#topic+brm_marginal_draws">brm_marginal_draws()</a></code>, then possible values include
<code>"response"</code> for the response on the raw scale, <code>"change"</code> for
change from baseline, and <code>"difference"</code> for treatment difference
in terms of change from baseline. If <code>outcome</code> was <code>"change"</code>,
then possible values include <code>"response"</code> for the response one the
change from baseline scale and <code>"difference"</code> for treatment difference.
</p>
</li>
<li> <p><code>statistic</code>: type of summary statistic. <code>"lower"</code> and <code>"upper"</code>
are bounds of an equal-tailed quantile-based credible interval.
</p>
</li>
<li> <p><code>group</code>: treatment group.
</p>
</li>
<li> <p><code>subgroup</code>: subgroup level, if applicable.
</p>
</li>
<li> <p><code>time</code>: discrete time point.
</p>
</li>
<li> <p><code>value</code>: numeric value of the estimate.
</p>
</li>
<li> <p><code>mcse</code>: Monte Carlo standard error of the estimate.
The <code>statistic</code> column has the following possible values:
</p>
</li>
<li> <p><code>mean</code>: posterior mean.
</p>
</li>
<li> <p><code>median</code>: posterior median.
</p>
</li>
<li> <p><code>sd</code>: posterior standard deviation of the mean.
</p>
</li>
<li> <p><code>lower</code>: lower bound of an equal-tailed credible interval of the mean,
with credible level determined by the <code>level</code> argument.
</p>
</li>
<li> <p><code>upper</code>: upper bound of an equal-tailed credible interval
with credible level determined by the <code>level</code> argument.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other marginals: 
<code><a href="#topic+brm_marginal_data">brm_marginal_data</a>()</code>,
<code><a href="#topic+brm_marginal_draws">brm_marginal_draws</a>()</code>,
<code><a href="#topic+brm_marginal_draws_average">brm_marginal_draws_average</a>()</code>,
<code><a href="#topic+brm_marginal_probabilities">brm_marginal_probabilities</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (identical(Sys.getenv("BRM_EXAMPLES", unset = ""), "true")) {
set.seed(0L)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
tmp &lt;- utils::capture.output(
  suppressMessages(
    suppressWarnings(
      model &lt;- brm_model(
        data = data,
        formula = formula,
        chains = 1,
        iter = 100,
        refresh = 0
      )
    )
  )
)
draws &lt;- brm_marginal_draws(model = model, data = data)
suppressWarnings(brm_marginal_summaries(draws))
}
</code></pre>

<hr>
<h2 id='brm_model'>Basic MMRM</h2><span id='topic+brm_model'></span>

<h3>Description</h3>

<p>Fit a basic MMRM model using <code>brms</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_model(data, formula, prior = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_model_+3A_data">data</code></td>
<td>
<p>A tidy data frame with one row per patient per discrete
time point.</p>
</td></tr>
<tr><td><code id="brm_model_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>"brmsformula"</code> from <code><a href="#topic+brm_formula">brm_formula()</a></code>
or <code>brms::brmsformula()</code>. Should include the full parameterization
of the model, including fixed effects, residual correlation,
and heterogeneity in the discrete-time-specific residual variance
components.</p>
</td></tr>
<tr><td><code id="brm_model_+3A_prior">prior</code></td>
<td>
<p>Either <code>NULL</code> for default priors
or a <code>"brmsprior"</code> object from <code>brms::prior()</code>.</p>
</td></tr>
<tr><td><code id="brm_model_+3A_...">...</code></td>
<td>
<p>Arguments to <code>brms::brm()</code> other than <code>data</code>, <code>formula</code>,
and <code>prior</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A fitted model object from <code>brms</code>.
</p>


<h3>Parameterization</h3>

<p>The formula is not the only factor
that determines the fixed effect parameterization.
The ordering of the categorical variables in the data,
as well as the <code>contrast</code> option in R, affect the
construction of the model matrix. To see the model
matrix that will ultimately be used in <code><a href="#topic+brm_model">brm_model()</a></code>,
run <code><a href="brms.html#topic+make_standata">brms::make_standata()</a></code> and examine the <code>X</code> element
of the returned list. See the examples below for a
demonstration.
</p>


<h3>See Also</h3>

<p>Other models: 
<code><a href="#topic+brm_formula">brm_formula</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (identical(Sys.getenv("BRM_EXAMPLES", unset = ""), "true")) {
set.seed(0L)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
# Optional: set the contrast option, which determines the model matrix.
options(contrasts = c(unordered = "contr.SAS", ordered = "contr.poly"))
# See the fixed effect parameterization you get from the data:
head(brms::make_standata(formula = formula, data = data)$X)
# Specify a different contrast method to use an alternative
# parameterization when fitting the model with brm_model():
options(
  contrasts = c(unordered = "contr.treatment", ordered = "contr.poly")
)
# different model matrix than before:
head(brms::make_standata(formula = formula, data = data)$X)
tmp &lt;- utils::capture.output(
  suppressMessages(
    suppressWarnings(
      model &lt;- brm_model(
        data = data,
        formula = formula,
        chains = 1,
        iter = 100,
        refresh = 0
      )
    )
  )
)
# The output model is a brms model fit object.
model
# The `prior_summary()` function shows the full prior specification
# which reflects the fully realized fixed effects parameterization.
brms::prior_summary(model)
}
</code></pre>

<hr>
<h2 id='brm_plot_compare'>Visually compare the marginals of multiple models and/or datasets.</h2><span id='topic+brm_plot_compare'></span>

<h3>Description</h3>

<p>Visually compare the marginals of multiple models
and/or datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_plot_compare(
  ...,
  marginal = "response",
  compare = "source",
  axis = "time",
  facet = c("group", "subgroup")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_plot_compare_+3A_...">...</code></td>
<td>
<p>Named <code>tibble</code>s of marginals posterior summaries
from <code><a href="#topic+brm_marginal_summaries">brm_marginal_summaries()</a></code> and/or <code><a href="#topic+brm_marginal_data">brm_marginal_data()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_plot_compare_+3A_marginal">marginal</code></td>
<td>
<p>Character of length 1, which kind of marginal
to visualize. Must be a value in the <code>marginal</code> column of the supplied
<code>tibble</code>s in the <code>...</code> argument.
Only applies to MCMC output, the data is always on the scale of the
response variable.</p>
</td></tr>
<tr><td><code id="brm_plot_compare_+3A_compare">compare</code></td>
<td>
<p>Character of length 1 identifying the variable to display
using back-to-back interval plots of different colors. This is
the primary comparison of interest. Must be one of
<code>"source"</code> (the source of the marginal summaries,
e.g. a model or dataset), <code>"time"</code> or <code>"group"</code>
(in the non-subgroup case). Can also be <code>"subgroup"</code>
if the marginal summaries are subgroup-specific.
The value must not be in <code>axis</code> or <code>facet</code>.</p>
</td></tr>
<tr><td><code id="brm_plot_compare_+3A_axis">axis</code></td>
<td>
<p>Character of length 1 identifying the quantity to put
on the horizontal axis. Must be be one of <code>"source"</code>
(the source of the marginal summaries,
e.g. a model or dataset), <code>"time"</code>,
or <code>"group"</code> (in the non-subgroup case). If the marginals
are subgroup-specific, then <code>axis</code> can also be <code>"subgroup"</code>.
The value must not be in <code>compare</code> or <code>facet</code>.</p>
</td></tr>
<tr><td><code id="brm_plot_compare_+3A_facet">facet</code></td>
<td>
<p>Character vector of length 1 or 2 with quantities to
generate facets. Each element must be <code>"source"</code>
(the source of the marginal summaries,
e.g. a model or dataset), <code>"time"</code>, <code>"group"</code>,
or <code>"subgroup"</code>, and <code>c(axis, facet)</code> must all have unique elements.
<code>"subgroup"</code> is automatically removed if the marginals have no
subgroup. If <code>facet</code> has length 1, then faceting is wrapped.
If <code>facet</code> has length 2, then faceting is in a grid,
and the first element is horizontal facet.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, <code><a href="#topic+brm_plot_compare">brm_plot_compare()</a></code> compares multiple models
and/or datasets side-by-side. The <code>compare</code> argument selects the primary
comparison of interest, and arguments <code>axis</code> and <code>facet</code> control
the arrangement of various other components of the plot.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>


<h3>See Also</h3>

<p>Other visualization: 
<code><a href="#topic+brm_plot_draws">brm_plot_draws</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (identical(Sys.getenv("BRM_EXAMPLES", unset = ""), "true")) {
set.seed(0L)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
tmp &lt;- utils::capture.output(
  suppressMessages(
    suppressWarnings(
      model &lt;- brm_model(
        data = data,
        formula = formula,
        chains = 1,
        iter = 100,
        refresh = 0
      )
    )
  )
)
draws &lt;- brm_marginal_draws(model = model, data = data)
suppressWarnings(summaries_draws &lt;- brm_marginal_summaries(draws))
summaries_data &lt;- brm_marginal_data(data)
brm_plot_compare(
  model1 = summaries_draws,
  model2 = summaries_draws,
  data = summaries_data
)
brm_plot_compare(
  model1 = summaries_draws,
  model2 = summaries_draws,
  marginal = "difference"
)
}
</code></pre>

<hr>
<h2 id='brm_plot_draws'>Visualize posterior draws of marginals.</h2><span id='topic+brm_plot_draws'></span>

<h3>Description</h3>

<p>Visualize posterior draws of marginals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_plot_draws(draws, axis = "time", facet = c("group", "subgroup"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_plot_draws_+3A_draws">draws</code></td>
<td>
<p>A data frame of draws from an element of
the output list of <code><a href="#topic+brm_marginal_summaries">brm_marginal_summaries()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_plot_draws_+3A_axis">axis</code></td>
<td>
<p>Character of length 1 identifying the quantity to put
on the horizontal axis. Must be be one of <code>"time"</code> or <code>"group"</code> if
the marginal summaries are not subgroup-specific. If the marginals
are subgroup-specific, then <code>axis</code> must be one of
<code>"time"</code>, <code>"group"</code>, or <code>"subgroup"</code>.</p>
</td></tr>
<tr><td><code id="brm_plot_draws_+3A_facet">facet</code></td>
<td>
<p>Character vector of length 1 or 2 with quantities to
generate facets. Each element must be <code>"time"</code>, <code>"group"</code>,
or <code>"subgroup"</code>, and <code>c(axis, facet)</code> must all have unique elements.
<code>"subgroup"</code> is automatically removed if the marginals have no
subgroup. If <code>facet</code> has length 1, then faceting is wrapped.
If <code>facet</code> has length 2, then faceting is in a grid,
and the first element is horizontal facet.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>


<h3>See Also</h3>

<p>Other visualization: 
<code><a href="#topic+brm_plot_compare">brm_plot_compare</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (identical(Sys.getenv("BRM_EXAMPLES", unset = ""), "true")) {
set.seed(0L)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  role = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
tmp &lt;- utils::capture.output(
  suppressMessages(
    suppressWarnings(
      model &lt;- brm_model(
        data = data,
        formula = formula,
        chains = 1,
        iter = 100,
        refresh = 0
      )
    )
  )
)
draws &lt;- brm_marginal_draws(model = model, data = data)
brm_plot_draws(draws = draws$difference_time)
}
</code></pre>

<hr>
<h2 id='brm_prior_simple'>Simple prior for a <code>brms</code> MMRM</h2><span id='topic+brm_prior_simple'></span>

<h3>Description</h3>

<p>Generate a simple prior for a <code>brms</code> MMRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_prior_simple(
  data,
  formula,
  intercept = "student_t(3, 0, 2.5)",
  coefficients = "student_t(3, 0, 2.5)",
  sigma = "student_t(3, 0, 2.5)",
  correlation = "lkj(1)"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_prior_simple_+3A_data">data</code></td>
<td>
<p>A tidy data frame with one row per patient per discrete
time point.</p>
</td></tr>
<tr><td><code id="brm_prior_simple_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>"brmsformula"</code> from <code><a href="#topic+brm_formula">brm_formula()</a></code>
or <code>brms::brmsformula()</code>. Should include the full parameterization
of the model, including fixed effects, residual correlation,
and heterogeneity in the discrete-time-specific residual variance
components.</p>
</td></tr>
<tr><td><code id="brm_prior_simple_+3A_intercept">intercept</code></td>
<td>
<p>Character of length 1, Stan code for the prior
to set on the intercept parameter.</p>
</td></tr>
<tr><td><code id="brm_prior_simple_+3A_coefficients">coefficients</code></td>
<td>
<p>Character of length 1, Stan code for the prior
to set independently on each of the non-intercept model coefficients.</p>
</td></tr>
<tr><td><code id="brm_prior_simple_+3A_sigma">sigma</code></td>
<td>
<p>Character of length 1, Stan code for the prior
to set independently on each of the log-scale standard deviation
parameters. Should be a symmetric prior in most situations.</p>
</td></tr>
<tr><td><code id="brm_prior_simple_+3A_correlation">correlation</code></td>
<td>
<p>Character of length 1, Stan code for the prior
on the correlation matrix for the residuals of a given patient.
(Different patients are modeled as independent, and each
patient has the same correlation structure as each other patient.)
Should be an LKJ prior in most situations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code><a href="#topic+brm_prior_simple">brm_prior_simple()</a></code>, you can separately choose priors for
the intercept, model coefficients, log-scale standard deviations,
and pairwise correlations between time points within patients.
However, each class of parameters is set as a whole. In other words,
<code><a href="#topic+brm_prior_simple">brm_prior_simple()</a></code> cannot assign different priors
to different fixed effect parameters.
</p>


<h3>Value</h3>

<p>A classed data frame with the <code>brms</code> prior.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0L)
data &lt;- brm_simulate_outline()
data &lt;- brm_simulate_continuous(data, names = c("age", "biomarker"))
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
brm_prior_simple(
  data = data,
  formula = formula,
  intercept = "student_t(3, 0, 2.5)",
  coefficients = "normal(0, 10)",
  sigma = "student_t(2, 0, 4)",
  correlation = "lkj(2.5)"
)
</code></pre>

<hr>
<h2 id='brm_simulate'>Deprecated: simulate an MMRM.</h2><span id='topic+brm_simulate'></span>

<h3>Description</h3>

<p>Deprecated on 2023-09-01 (version 0.0.2.9001). Use
<code><a href="#topic+brm_simulate_simple">brm_simulate_simple()</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_simulate(
  n_group = 2L,
  n_patient = 100L,
  n_time = 4L,
  hyper_beta = 1,
  hyper_sigma = 1,
  hyper_correlation = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_simulate_+3A_n_group">n_group</code></td>
<td>
<p>Positive integer of length 1, number of treatment groups.</p>
</td></tr>
<tr><td><code id="brm_simulate_+3A_n_patient">n_patient</code></td>
<td>
<p>Positive integer of length 1, number of patients
per treatment group.</p>
</td></tr>
<tr><td><code id="brm_simulate_+3A_n_time">n_time</code></td>
<td>
<p>Positive integer of length 1, number of discrete
time points (e.g. scheduled study visits) per patient.</p>
</td></tr>
<tr><td><code id="brm_simulate_+3A_hyper_beta">hyper_beta</code></td>
<td>
<p>Positive numeric of length 1, hyperparameter.
Prior standard deviation of the fixed effect parameters.</p>
</td></tr>
<tr><td><code id="brm_simulate_+3A_hyper_sigma">hyper_sigma</code></td>
<td>
<p>Positive numeric of length 1, hyperparameter.
Uniform prior upper bound of the time-specific residual
standard deviation parameters.</p>
</td></tr>
<tr><td><code id="brm_simulate_+3A_hyper_correlation">hyper_correlation</code></td>
<td>
<p>Positive numeric of length 1, hyperparameter.
LKJ shape parameter of the correlation matrix among repeated
measures within each patient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of three objects:
</p>

<ul>
<li> <p><code>data</code>: A tidy dataset with one row per patient per discrete
time point and columns for the response and covariates.
</p>
</li>
<li> <p><code>model_matrix</code>: A matrix with one row per row of <code>data</code> and columns
that represent levels of the covariates.
</p>
</li>
<li> <p><code>parameters</code>: A named list of parameter values sampled from the prior.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0L)
simulation &lt;- suppressWarnings(brm_simulate())
simulation$data
</code></pre>

<hr>
<h2 id='brm_simulate_categorical'>Append simulated categorical covariates</h2><span id='topic+brm_simulate_categorical'></span>

<h3>Description</h3>

<p>Simulate and append non-time-varying
categorical covariates to an existing <code><a href="#topic+brm_data">brm_data()</a></code> dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_simulate_categorical(data, names, levels, probabilities = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_simulate_categorical_+3A_data">data</code></td>
<td>
<p>Classed <code>tibble</code> as from <code><a href="#topic+brm_data">brm_data()</a></code>
or <code><a href="#topic+brm_simulate_outline">brm_simulate_outline()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_simulate_categorical_+3A_names">names</code></td>
<td>
<p>Character vector with the names of the new covariates
to simulate and append. Names must all be unique and
must not already be column names of <code>data</code>.</p>
</td></tr>
<tr><td><code id="brm_simulate_categorical_+3A_levels">levels</code></td>
<td>
<p>Character vector of unique levels of the
simulated categorical covariates.</p>
</td></tr>
<tr><td><code id="brm_simulate_categorical_+3A_probabilities">probabilities</code></td>
<td>
<p>Either <code>NULL</code> or a
numeric vector of length <code>length(levels)</code> with levels between 0 and 1
where all elements sum to 1.
If <code>NULL</code>, then all levels are equally likely to be drawn. If not <code>NULL</code>,
then <code>probabilities</code> is a vector of sampling probabilities corresponding
to each respective level of <code>levels</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each covariate is a new column of the dataset with one independent
random categorical draw for each patient, using a fixed set of levels
(via <code>base::sample()</code> with <code>replace = TRUE</code>).
All covariates simulated this way are
independent of everything else in the data, including other covariates
(to the extent that the random number generators in R work as intended).
</p>


<h3>Value</h3>

<p>A classed <code>tibble</code>, like from <code><a href="#topic+brm_data">brm_data()</a></code> or
<code><a href="#topic+brm_simulate_outline">brm_simulate_outline()</a></code>, but with new categorical covariate columns
and with the names of the new covariates appended to the
<code>brm_covariates</code> attribute. Each new categorical covariate column
is a character vector, not the factor type in base R.
</p>


<h3>See Also</h3>

<p>Other simulation: 
<code><a href="#topic+brm_simulate_continuous">brm_simulate_continuous</a>()</code>,
<code><a href="#topic+brm_simulate_outline">brm_simulate_outline</a>()</code>,
<code><a href="#topic+brm_simulate_prior">brm_simulate_prior</a>()</code>,
<code><a href="#topic+brm_simulate_simple">brm_simulate_simple</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- brm_simulate_outline()
brm_simulate_categorical(
  data = data,
  names = c("site", "region"),
  levels = c("area1", "area2")
)
brm_simulate_categorical(
  data = data,
  names = c("site", "region"),
  levels = c("area1", "area2"),
  probabilities = c(0.1, 0.9)
)
</code></pre>

<hr>
<h2 id='brm_simulate_continuous'>Append simulated continuous covariates</h2><span id='topic+brm_simulate_continuous'></span>

<h3>Description</h3>

<p>Simulate and append non-time-varying continuous
covariates to an existing <code><a href="#topic+brm_data">brm_data()</a></code> dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_simulate_continuous(data, names, mean = 0, sd = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_simulate_continuous_+3A_data">data</code></td>
<td>
<p>Classed <code>tibble</code> as from <code><a href="#topic+brm_data">brm_data()</a></code>
or <code><a href="#topic+brm_simulate_outline">brm_simulate_outline()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_simulate_continuous_+3A_names">names</code></td>
<td>
<p>Character vector with the names of the new covariates
to simulate and append. Names must all be unique and
must not already be column names of <code>data</code>.</p>
</td></tr>
<tr><td><code id="brm_simulate_continuous_+3A_mean">mean</code></td>
<td>
<p>Numeric of length 1,
mean of the normal distribution for simulating each covariate.</p>
</td></tr>
<tr><td><code id="brm_simulate_continuous_+3A_sd">sd</code></td>
<td>
<p>Positive numeric of length 1,
standard deviation of the normal distribution
for simulating each covariate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each covariate is a new column of the dataset with one independent
random univariate normal draw for each patient.
All covariates simulated this way are
independent of everything else in the data, including other covariates
(to the extent that the random number generators in R work as intended).
</p>


<h3>Value</h3>

<p>A classed <code>tibble</code>, like from <code><a href="#topic+brm_data">brm_data()</a></code> or
<code><a href="#topic+brm_simulate_outline">brm_simulate_outline()</a></code>, but with new numeric covariate columns
and with the names of the new covariates appended to the
<code>brm_covariates</code> attribute.
</p>


<h3>See Also</h3>

<p>Other simulation: 
<code><a href="#topic+brm_simulate_categorical">brm_simulate_categorical</a>()</code>,
<code><a href="#topic+brm_simulate_outline">brm_simulate_outline</a>()</code>,
<code><a href="#topic+brm_simulate_prior">brm_simulate_prior</a>()</code>,
<code><a href="#topic+brm_simulate_simple">brm_simulate_simple</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- brm_simulate_outline()
brm_simulate_continuous(
  data = data,
  names = c("age", "biomarker")
)
brm_simulate_continuous(
  data = data,
  names = c("biomarker1", "biomarker2"),
  mean = 1000,
  sd = 100
)
</code></pre>

<hr>
<h2 id='brm_simulate_outline'>Start a simulated dataset</h2><span id='topic+brm_simulate_outline'></span>

<h3>Description</h3>

<p>Begin creating a simulated dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_simulate_outline(
  n_group = 2L,
  n_subgroup = NULL,
  n_patient = 100L,
  n_time = 4L,
  rate_dropout = 0.1,
  rate_lapse = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_simulate_outline_+3A_n_group">n_group</code></td>
<td>
<p>Positive integer of length 1, number of treatment groups.</p>
</td></tr>
<tr><td><code id="brm_simulate_outline_+3A_n_subgroup">n_subgroup</code></td>
<td>
<p>Positive integer of length 1, number of subgroup levels.
Set to <code>NULL</code> to omit the subgroup entirely.</p>
</td></tr>
<tr><td><code id="brm_simulate_outline_+3A_n_patient">n_patient</code></td>
<td>
<p>Positive integer of length 1.
If <code>n_subgroup</code> is <code>NULL</code>, then <code>n_patient</code> is the number of patients
per treatment group. Otherwise, <code>n_patient</code> is the number of patients
per treatment group <em>per subgroup</em>. In both cases, the total number of
patients in the whole simulated dataset is usually much greater than the
<code>n_patients</code> argument of <code><a href="#topic+brm_simulate_outline">brm_simulate_outline()</a></code>.</p>
</td></tr>
<tr><td><code id="brm_simulate_outline_+3A_n_time">n_time</code></td>
<td>
<p>Positive integer of length 1, number of discrete
time points (e.g. scheduled study visits) per patient.</p>
</td></tr>
<tr><td><code id="brm_simulate_outline_+3A_rate_dropout">rate_dropout</code></td>
<td>
<p>Numeric of length 1 between 0 and 1,
post-baseline dropout rate.
A dropout is an intercurrent event when data
collection for a patient stops permanently,
causing the outcomes for that patient to be missing during and after
the dropout occurred. The first time point is assumed to be baseline,
so dropout is there. Dropouts are equally likely to occur at each of
the post-baseline time points.</p>
</td></tr>
<tr><td><code id="brm_simulate_outline_+3A_rate_lapse">rate_lapse</code></td>
<td>
<p>Numeric of length 1, expected proportion of post-baseline
outcomes that are missing. Missing outcomes of this type are independent
and uniformly distributed across the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame from <code><a href="#topic+brm_data">brm_data()</a></code> with attributes to define roles
for various columns in the dataset. The data frame has one row per
patient per time point and the following columns:
</p>

<ul>
<li> <p><code>group</code>: integer index of the treatment group.
</p>
</li>
<li> <p><code>patient</code>: integer index of the patient.
</p>
</li>
<li> <p><code>time</code>: integer index of the discrete time point.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other simulation: 
<code><a href="#topic+brm_simulate_categorical">brm_simulate_categorical</a>()</code>,
<code><a href="#topic+brm_simulate_continuous">brm_simulate_continuous</a>()</code>,
<code><a href="#topic+brm_simulate_prior">brm_simulate_prior</a>()</code>,
<code><a href="#topic+brm_simulate_simple">brm_simulate_simple</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>brm_simulate_outline()
</code></pre>

<hr>
<h2 id='brm_simulate_prior'>Prior predictive draws.</h2><span id='topic+brm_simulate_prior'></span>

<h3>Description</h3>

<p>Simulate the outcome variable from the prior
predictive distribution of an MMRM using <code>brms</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_simulate_prior(
  data,
  formula,
  prior = brms.mmrm::brm_prior_simple(data = data, formula = formula),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_simulate_prior_+3A_data">data</code></td>
<td>
<p>A tidy data frame with one row per patient per discrete
time point.</p>
</td></tr>
<tr><td><code id="brm_simulate_prior_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>"brmsformula"</code> from <code><a href="#topic+brm_formula">brm_formula()</a></code>
or <code>brms::brmsformula()</code>. Should include the full parameterization
of the model, including fixed effects, residual correlation,
and heterogeneity in the discrete-time-specific residual variance
components.</p>
</td></tr>
<tr><td><code id="brm_simulate_prior_+3A_prior">prior</code></td>
<td>
<p>A valid <code>brms</code> prior object with proper priors for parameters
<code>b</code> (model coefficients), <code>b_sigma</code> (log residual standard deviations
for each time point), and <code>cortime</code> (residual correlations among
time points within patients). See the
<code><a href="#topic+brm_prior_simple">brm_prior_simple()</a></code> function for an example.</p>
</td></tr>
<tr><td><code id="brm_simulate_prior_+3A_...">...</code></td>
<td>
<p>Arguments to <code>brms::brm()</code> other than <code>data</code>, <code>formula</code>,
and <code>prior</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>brm_simulate_prior()</code> calls <code>brms::brm()</code> with
<code>sample_prior = "only"</code>, which sets the default intercept prior
using the outcome variable and requires at least some elements of the
outcome variable to be non-missing in advance. So to provide feasible and
consistent output, <code>brm_simulate_prior()</code> temporarily sets the
outcome variable to all zeros before invoking <code>brms::brm()</code>.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>data</code>: a classed <code>tibble</code> with the outcome variable simulated as a draw
from the prior predictive distribution (the final row of <code>outcome</code> in
the output). If you simulated a missingness pattern
with <code><a href="#topic+brm_simulate_outline">brm_simulate_outline()</a></code>, then that missingness pattern is applied
so that the appropriate values of the outcome variable are set to <code>NA</code>.
</p>
</li>
<li> <p><code>model</code>: the <code>brms</code> model fit object.
</p>
</li>
<li> <p><code>model_matrix</code>: the model matrix of the fixed effects, obtained from
<code>brms::make_standata()</code>.
</p>
</li>
<li> <p><code>outcome</code>: a numeric matrix with one column per row of <code>data</code> and one
row per saved prior predictive draw.
</p>
</li>
<li> <p><code>parameters</code>: a <code>tibble</code> of saved parameter draws from the prior
predictive distribution.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other simulation: 
<code><a href="#topic+brm_simulate_categorical">brm_simulate_categorical</a>()</code>,
<code><a href="#topic+brm_simulate_continuous">brm_simulate_continuous</a>()</code>,
<code><a href="#topic+brm_simulate_outline">brm_simulate_outline</a>()</code>,
<code><a href="#topic+brm_simulate_simple">brm_simulate_simple</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (identical(Sys.getenv("BRM_EXAMPLES", unset = ""), "true")) {
set.seed(0L)
data &lt;- brm_simulate_outline()
data &lt;- brm_simulate_continuous(data, names = c("age", "biomarker"))
formula &lt;- brm_formula(
  data = data,
  baseline = FALSE,
  baseline_time = FALSE
)
tmp &lt;- utils::capture.output(
  suppressMessages(
    suppressWarnings(
      out &lt;- brm_simulate_prior(
        data = data,
        formula = formula
      )
    )
  )
)
out$data
}
</code></pre>

<hr>
<h2 id='brm_simulate_simple'>Simple MMRM simulation.</h2><span id='topic+brm_simulate_simple'></span>

<h3>Description</h3>

<p>Simple function to simulate a dataset from a simple
specialized MMRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brm_simulate_simple(
  n_group = 2L,
  n_patient = 100L,
  n_time = 4L,
  hyper_beta = 1,
  hyper_tau = 0.1,
  hyper_lambda = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brm_simulate_simple_+3A_n_group">n_group</code></td>
<td>
<p>Positive integer of length 1, number of treatment groups.</p>
</td></tr>
<tr><td><code id="brm_simulate_simple_+3A_n_patient">n_patient</code></td>
<td>
<p>Positive integer of length 1, number of patients
per treatment group.</p>
</td></tr>
<tr><td><code id="brm_simulate_simple_+3A_n_time">n_time</code></td>
<td>
<p>Positive integer of length 1, number of discrete
time points (e.g. scheduled study visits) per patient.</p>
</td></tr>
<tr><td><code id="brm_simulate_simple_+3A_hyper_beta">hyper_beta</code></td>
<td>
<p>Positive numeric of length 1, hyperparameter.
Prior standard deviation of the fixed effect parameters <code>beta</code>.</p>
</td></tr>
<tr><td><code id="brm_simulate_simple_+3A_hyper_tau">hyper_tau</code></td>
<td>
<p>Positive numeric of length 1, hyperparameter.
Prior standard deviation parameter of the residual log standard
deviation parameters <code>tau</code></p>
</td></tr>
<tr><td><code id="brm_simulate_simple_+3A_hyper_lambda">hyper_lambda</code></td>
<td>
<p>Positive numeric of length 1, hyperparameter.
Prior shape parameter of the LKJ correlation matrix of the residuals
among discrete time points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Refer to the methods vignette for a full model specification.
The <code><a href="#topic+brm_simulate_simple">brm_simulate_simple()</a></code> function simulates a dataset from a
simple pre-defined MMRM. It assumes a cell means structure for fixed
effects, which means there is one fixed effect scalar parameter
(element of vector <code>beta</code>) for each unique combination of levels of
treatment group and discrete time point.
The elements of <code>beta</code> have independent univariate normal
priors with mean 0 and standard deviation <code>hyper_beta</code>.
The residual log standard deviation parameters (elements of vector <code>tau</code>)
have normal priors with mean 0 and standard deviation <code>hyper_tau</code>.
The residual correlation matrix parameter <code>lambda</code> has an LKJ correlation
prior with shape parameter <code>hyper_lambda</code>.
</p>


<h3>Value</h3>

<p>A list of three objects:
</p>

<ul>
<li> <p><code>data</code>: A tidy dataset with one row per patient per discrete
time point and columns for the outcome and ID variables.
</p>
</li>
<li> <p><code>model_matrix</code>: A matrix with one row per row of <code>data</code> and columns
that represent levels of the covariates.
</p>
</li>
<li> <p><code>parameters</code>: A named list of parameter draws sampled from the prior:
</p>

<ul>
<li> <p><code>beta</code>: numeric vector of fixed effects.
</p>
</li>
<li> <p><code>tau</code>: numeric vector of residual log standard parameters for each
time point.
</p>
</li>
<li> <p><code>sigma</code>: numeric vector of residual standard parameters for each
time point. <code>sigma</code> is equal to <code>exp(tau)</code>.
</p>
</li>
<li> <p><code>lambda</code>: correlation matrix of the residuals among the time points
within each patient.
</p>
</li>
<li> <p><code>covariance</code>: covariance matrix of the residuals among the time points
within each patient. <code>covariance</code> is equal to
<code>diag(sigma) %*% lambda %*% diag(sigma)</code>.
</p>
</li></ul>

</li></ul>



<h3>See Also</h3>

<p>Other simulation: 
<code><a href="#topic+brm_simulate_categorical">brm_simulate_categorical</a>()</code>,
<code><a href="#topic+brm_simulate_continuous">brm_simulate_continuous</a>()</code>,
<code><a href="#topic+brm_simulate_outline">brm_simulate_outline</a>()</code>,
<code><a href="#topic+brm_simulate_prior">brm_simulate_prior</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0L)
simulation &lt;- brm_simulate_simple()
simulation$data
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
