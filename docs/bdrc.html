<!DOCTYPE html><html><head><title>Help for package bdrc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bdrc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#autoplot.plm0'><p>Autoplot method for discharge rating curves</p></a></li>
<li><a href='#autoplot.tournament'><p>Autoplot method for discharge rating curve tournament</p></a></li>
<li><a href='#evaluate_game'><p>Compare two models using a specified model selection criteria</p></a></li>
<li><a href='#gather_draws'><p>Gather MCMC chain draws to data.frame on a long format</p></a></li>
<li><a href='#get_report'><p>Report for a discharge rating curve or tournament</p></a></li>
<li><a href='#get_report_pages'><p>Report pages for a discharge rating curve or tournament</p></a></li>
<li><a href='#gplm'><p>Generalized power-law model with variance that varies with stage.</p></a></li>
<li><a href='#gplm0'><p>Generalized power-law model with a constant variance</p></a></li>
<li><a href='#jokdal'><p>Jokulsa a Dal gauging station in Iceland</p></a></li>
<li><a href='#jokfjoll'><p>Jokulsa a Fjollum gauging station in Iceland</p></a></li>
<li><a href='#kallstorp'><p>Kallstorp gauging station in Sweden</p></a></li>
<li><a href='#krokfors'><p>Krokfors gauging station in Sweden</p></a></li>
<li><a href='#melby'><p>Melby gauging station in Sweden</p></a></li>
<li><a href='#nordura'><p>Nordura gauging station in Iceland</p></a></li>
<li><a href='#norn'><p>Norn gauging station in Sweden</p></a></li>
<li><a href='#plm'><p>Power-law model with variance that varies with stage.</p></a></li>
<li><a href='#plm0'><p>Power-law model with a constant variance</p></a></li>
<li><a href='#plot_fun'><p>Plot bdrc model objects</p></a></li>
<li><a href='#plot.plm0'><p>Plot method for discharge rating curves</p></a></li>
<li><a href='#plot.tournament'><p>Plot method for discharge rating curve tournament</p></a></li>
<li><a href='#predict.plm0'><p>Predict method for discharge rating curves</p></a></li>
<li><a href='#print.plm0'><p>Print method for discharge rating curves</p></a></li>
<li><a href='#print.tournament'><p>Print method for discharge rating curve tournament</p></a></li>
<li><a href='#skjalf'><p>Skjalfandafljot gauging station in Iceland</p></a></li>
<li><a href='#skogsliden'><p>Skogsliden gauging station in Sweden</p></a></li>
<li><a href='#spanga'><p>Spanga gauging station in Sweden</p></a></li>
<li><a href='#spread_draws'><p>Spread MCMC chain draws to data.frame on a wide format</p></a></li>
<li><a href='#summary.plm0'><p>Summary method for discharge rating curves</p></a></li>
<li><a href='#summary.tournament'><p>Summary method for a discharge rating curve tournament</p></a></li>
<li><a href='#theme_bdrc'><p>Custom bdrc theme</p></a></li>
<li><a href='#tournament'><p>Tournament - Model comparison</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Discharge Rating Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Solvi Rognvaldsson &lt;solviro@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a discharge rating curve based on the power-law and the generalized power-law from data on paired stage and discharge measurements in a given river using a Bayesian hierarchical model as described in Hrafnkelsson et al. (2020) &lt;<a href="https://arxiv.org/abs/2010.04769">arXiv:2010.04769</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, grid, gridExtra, rlang, scales</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, covr, vdiffr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sor16/bdrc/issues">https://github.com/sor16/bdrc/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-19 08:53:15 UTC; solviro</td>
</tr>
<tr>
<td>Author:</td>
<td>Birgir Hrafnkelsson
    <a href="https://orcid.org/0000-0003-1864-9652"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph],
  Solvi Rognvaldsson
    <a href="https://orcid.org/0000-0002-4376-3361"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Axel Orn Jansson [aut],
  Rafael Vias [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-19 17:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='autoplot.plm0'>Autoplot method for discharge rating curves</h2><span id='topic+autoplot.plm0'></span><span id='topic+autoplot.plm'></span><span id='topic+autoplot.gplm0'></span><span id='topic+autoplot.gplm'></span>

<h3>Description</h3>

<p>Visualize discharge rating curve model objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plm0'
autoplot(
  object,
  ...,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL
)

## S3 method for class 'plm'
autoplot(
  object,
  ...,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL
)

## S3 method for class 'gplm0'
autoplot(
  object,
  ...,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL
)

## S3 method for class 'gplm'
autoplot(
  object,
  ...,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.plm0_+3A_object">object</code></td>
<td>
<p>an object of class &quot;plm0&quot;,&quot;plm&quot;,&quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.plm0_+3A_...">...</code></td>
<td>
<p>other plotting parameters (not used in this function)</p>
</td></tr>
<tr><td><code id="autoplot.plm0_+3A_type">type</code></td>
<td>
<p>a character denoting what type of plot should be drawn. Defaults to &quot;rating_curve&quot;. Possible types are
</p>

<ul>
<li><p>&quot;rating_curve&quot; to plot the rating curve.
</p>
</li>
<li><p>&quot;rating_curve_mean&quot; to plot the posterior mean of the rating curve.
</p>
</li>
<li><p>&quot;f&quot; to plot the power-law exponent.
</p>
</li>
<li><p>&quot;beta&quot; to plot the random effect in the power-law exponent.
</p>
</li>
<li><p>&quot;sigma_eps&quot; to plot the standard deviation on the data level.
</p>
</li>
<li><p>&quot;residuals&quot; to plot the log residuals.
</p>
</li>
<li><p>&quot;trace&quot; to plot trace plots of parameters given in param.
</p>
</li>
<li><p>&quot;histogram&quot; to plot histograms of parameters given in param.
</p>
</li></ul>
</td></tr>
<tr><td><code id="autoplot.plm0_+3A_param">param</code></td>
<td>
<p>a character vector with the parameters to plot. Defaults to NULL and is only used if type is &quot;trace&quot; or &quot;histogram&quot;. Allowed values are the parameters given in the model summary of x as well as &quot;hyperparameters&quot; or &quot;latent_parameters&quot; for specific groups of parameters.</p>
</td></tr>
<tr><td><code id="autoplot.plm0_+3A_transformed">transformed</code></td>
<td>
<p>a logical value indicating whether the quantity should be plotted on a transformed scale used during the Bayesian inference. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="autoplot.plm0_+3A_title">title</code></td>
<td>
<p>a character denoting the title of the plot</p>
</td></tr>
<tr><td><code id="autoplot.plm0_+3A_xlim">xlim</code></td>
<td>
<p>numeric vector of length 2, denoting the limits on the x axis of the plot. Applicable for types &quot;rating_curve&quot;,&quot;rating_curve_mean&quot;,&quot;f&quot;,&quot;beta&quot;,&quot;sigma_eps&quot;,&quot;residuals&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.plm0_+3A_ylim">ylim</code></td>
<td>
<p>numeric vector of length 2, denoting the limits on the y axis of the plot. Applicable for types &quot;rating_curve&quot;,&quot;rating_curve_mean&quot;,&quot;f&quot;,&quot;beta&quot;,&quot;sigma_eps&quot;,&quot;residuals&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an object of class &quot;ggplot2&quot;.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>autoplot(plm0)</code>: Autoplot method for plm0
</p>
</li>
<li> <p><code>autoplot(plm)</code>: Autoplot method for plm
</p>
</li>
<li> <p><code>autoplot(gplm0)</code>: Autoplot method for gplm0
</p>
</li>
<li> <p><code>autoplot(gplm)</code>: Autoplot method for gplm
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+plm0">plm0</a></code>, <code><a href="#topic+plm">plm</a></code>, <code><a href="#topic+gplm0">gplm0</a></code> and <code><a href="#topic+gplm">gplm</a></code> for fitting a discharge rating curve and <code><a href="#topic+summary.plm0">summary.plm0</a></code>, <code><a href="#topic+summary.plm">summary.plm</a></code>, <code><a href="#topic+summary.gplm0">summary.gplm0</a></code> and <code><a href="#topic+summary.gplm">summary.gplm</a></code> for summaries. It is also useful to look at <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+gather_draws">gather_draws</a></code> to work directly with the MCMC samples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)
data(krokfors)
set.seed(1)
plm0.fit &lt;- plm0(Q~W,krokfors,num_cores=2)
autoplot(plm0.fit)
autoplot(plm0.fit,transformed=TRUE)
autoplot(plm0.fit,type='histogram',param='c')
autoplot(plm0.fit,type='histogram',param='c',transformed=TRUE)
autoplot(plm0.fit,type='histogram',param='hyperparameters')
autoplot(plm0.fit,type='histogram',param='latent_parameters')
autoplot(plm0.fit,type='residuals')
autoplot(plm0.fit,type='f')
autoplot(plm0.fit,type='sigma_eps')

</code></pre>

<hr>
<h2 id='autoplot.tournament'>Autoplot method for discharge rating curve tournament</h2><span id='topic+autoplot.tournament'></span>

<h3>Description</h3>

<p>Compare the four discharge rating curves from the tournament object in different ways
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tournament'
autoplot(object, ..., type = "deviance")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.tournament_+3A_object">object</code></td>
<td>
<p>an object of class &quot;tournament&quot;</p>
</td></tr>
<tr><td><code id="autoplot.tournament_+3A_...">...</code></td>
<td>
<p>other plotting parameters (not used in this function)</p>
</td></tr>
<tr><td><code id="autoplot.tournament_+3A_type">type</code></td>
<td>
<p>a character denoting what type of plot should be drawn. Possible types are
</p>

<ul>
<li><p>&quot;deviance&quot; to plot the deviance of the four models.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an object of class &quot;ggplot2&quot;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tournament">tournament</a></code> to run a discharge rating curve tournament and <code><a href="#topic+summary.tournament">summary.tournament</a></code> for summaries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)
data(krokfors)
set.seed(1)
t_obj &lt;- tournament(formula=Q~W,data=krokfors,num_cores=2)
autoplot(t_obj)

</code></pre>

<hr>
<h2 id='evaluate_game'>Compare two models using a specified model selection criteria</h2><span id='topic+evaluate_game'></span>

<h3>Description</h3>

<p>evaluate_game uses WAIC, DIC or the posterior probabilities of the models, calculated with Bayes factor, to determine whether one model is more appropriate than the other model given the data at hand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_game(m, method, winning_criteria)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_game_+3A_m">m</code></td>
<td>
<p>a list of two model objects fit on the same dataset. The allowed model objects are &quot;gplm&quot;, &quot;gplm0&quot;, &quot;plm&quot; and &quot;plm0&quot;</p>
</td></tr>
<tr><td><code id="evaluate_game_+3A_method">method</code></td>
<td>
<p>a string specifying the method used to estimate the predictive performance of the models. The allowed methods are &quot;WAIC&quot;, &quot;DIC&quot; and &quot;Posterior_probability&quot;.</p>
</td></tr>
<tr><td><code id="evaluate_game_+3A_winning_criteria">winning_criteria</code></td>
<td>
<p>a numerical value which sets the threshold which the first model in the list must exceed for it to be declared the more appropriate model. This value defaults to 2.2 for methods &quot;WAIC&quot; and &quot;DIC&quot;, but defaults to 0.75 for method &quot;Posterior_probability&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with the summary of the results of the game
</p>


<h3>References</h3>

<p>Hrafnkelsson, B., Sigurdarson, H., and Gardarsson, S. M. (2022). Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling, Environmetrics, 33(2):e2711.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tournament">tournament</a></code>
</p>

<hr>
<h2 id='gather_draws'>Gather MCMC chain draws to data.frame on a long format</h2><span id='topic+gather_draws'></span>

<h3>Description</h3>

<p>Useful to convert MCMC chain draws of particular parameters or output from the model object to a long format for further data wrangling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gather_draws(mod, ..., transformed = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gather_draws_+3A_mod">mod</code></td>
<td>
<p>an object of class &quot;plm0&quot;,&quot;plm&quot;,&quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="gather_draws_+3A_...">...</code></td>
<td>
<p>any number of character vectors containing valid names of parameters in the model or &quot;rating_curve&quot; and &quot;rating_curve_mean&quot;. Also accepts &quot;latent_parameters&quot; and &quot;hyperparameters&quot;.</p>
</td></tr>
<tr><td><code id="gather_draws_+3A_transformed">transformed</code></td>
<td>
<p>boolean value determining whether the parameter is to be represented on the transformed scale used for sampling in the MCMC chain or the original scale. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with columns
<code>chain</code>
<code>iter</code>
<code>param</code>
<code>value</code>
</p>


<h3>References</h3>

<p>B. Hrafnkelsson, H. Sigurdarson, S.M. Gardarsson, 2020, Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling. arXiv preprint 2010.04769
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plm0">plm0</a></code>, <code><a href="#topic+plm">plm</a></code>, <code><a href="#topic+gplm0">gplm0</a></code>, <code><a href="#topic+gplm">gplm</a></code> for further information on parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
plm0.fit &lt;- plm0(formula=Q~W,data=krokfors,num_cores=2)
hyp_samples &lt;- gather_draws(plm0.fit,'hyperparameters')
head(hyp_samples)
rating_curve_samples &lt;- gather_draws(plm0.fit,'rating_curve','rating_curve_mean')
head(rating_curve_samples)

</code></pre>

<hr>
<h2 id='get_report'>Report for a discharge rating curve or tournament</h2><span id='topic+get_report'></span><span id='topic+get_report.plm0'></span><span id='topic+get_report.plm'></span><span id='topic+get_report.gplm0'></span><span id='topic+get_report.gplm'></span><span id='topic+get_report.tournament'></span>

<h3>Description</h3>

<p>Save a pdf file with a report of a discharge rating curve object or tournament.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_report(x, path = NULL, type = 1, ...)

## S3 method for class 'plm0'
get_report(x, path = NULL, type = 1, ...)

## S3 method for class 'plm'
get_report(x, path = NULL, type = 1, ...)

## S3 method for class 'gplm0'
get_report(x, path = NULL, type = 1, ...)

## S3 method for class 'gplm'
get_report(x, path = NULL, type = 1, ...)

## S3 method for class 'tournament'
get_report(x, path = NULL, type = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_report_+3A_x">x</code></td>
<td>
<p>an object of class &quot;tournament&quot;, &quot;plm0&quot;, &quot;plm&quot;, &quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="get_report_+3A_path">path</code></td>
<td>
<p>file path to which the pdf file of the report is saved. If NULL, the current working directory is used.</p>
</td></tr>
<tr><td><code id="get_report_+3A_type">type</code></td>
<td>
<p>an integer denoting what type of report is to be produced. Defaults to type 1. Only type 1 is permissible for an object of class &quot;plm0&quot;, &quot;plm&quot;, &quot;gplm0&quot; or &quot;gplm&quot;. Possible types are
</p>

<ul>
<li><p>1 - produces a report displaying the results of the model (winning model if a tournament provided). The first page contains a panel of four plots and a summary of the posterior distributions of the parameters. On the second page a tabular prediction of discharge on an equally spaced grid of stages is displayed. This prediction table can span multiple pages.
</p>
</li>
<li><p>2 - produces a ten page report and is only permissible for objects of class &quot;tournament&quot;. The first four pages contain a panel of four plots and a summary of the posterior distributions of the parameters for each of the four models in the tournament, the fifth page shows model comparison plots and tables, the sixth page convergence diagnostics plots, and the final four pages shows the histograms of the parameters in each of the four models.
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_report_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods (currently unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can only be used in an interactive R session as it asks permission from the user to write to their file system.
</p>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>get_report(plm0)</code>: Get report for plm0 model object
</p>
</li>
<li> <p><code>get_report(plm)</code>: Get report for plm model object
</p>
</li>
<li> <p><code>get_report(gplm0)</code>: Get report for gplm0 model object
</p>
</li>
<li> <p><code>get_report(gplm)</code>: Get report for gplm
</p>
</li>
<li> <p><code>get_report(tournament)</code>: Get report for discharge rating curve tournament
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+get_report">get_report</a></code> for generating and saving a report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
plm0.fit &lt;- plm0(formula=Q~W,data=krokfors,num_cores=2)

## Not run: 
get_report(plm0.fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_report_pages'>Report pages for a discharge rating curve or tournament</h2><span id='topic+get_report_pages'></span><span id='topic+get_report_pages.plm0'></span><span id='topic+get_report_pages.plm'></span><span id='topic+get_report_pages.gplm0'></span><span id='topic+get_report_pages.gplm'></span><span id='topic+get_report_pages.tournament'></span>

<h3>Description</h3>

<p>Get a list of the pages of a report on a discharge rating curve model or tournament
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_report_pages(x, type = 1, ...)

## S3 method for class 'plm0'
get_report_pages(x, type = 1, ...)

## S3 method for class 'plm'
get_report_pages(x, type = 1, ...)

## S3 method for class 'gplm0'
get_report_pages(x, type = 1, ...)

## S3 method for class 'gplm'
get_report_pages(x, type = 1, ...)

## S3 method for class 'tournament'
get_report_pages(x, type = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_report_pages_+3A_x">x</code></td>
<td>
<p>an object of class &quot;tournament&quot;, &quot;plm0&quot;, &quot;plm&quot;, &quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="get_report_pages_+3A_type">type</code></td>
<td>
<p>an integer denoting what type of report is to be produced. Defaults to type 1. Possible types are
</p>

<ul>
<li><p>1 - produces a report displaying the results of the model (winning model if a tournament provided). The first page contains a panel of four plots and a summary of the posterior distributions of the parameters. On the second page a tabular prediction of discharge on an equally spaced grid of stages is displayed. This prediction table can span multiple pages.
</p>
</li>
<li><p>2 - produces a ten page report and is only permissible for objects of class &quot;tournament&quot;. The first four pages contain a panel of four plots and a summary of the posterior distributions of the parameters for each of the four models in the tournament, the fifth page shows model comparison plots and tables, the sixth page convergence diagnostics plots, and the final four pages shows the histograms of the parameters in each of the four models.
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_report_pages_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods (currently unused).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects of type &quot;grob&quot; that correspond to the pages in a rating curve report.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>get_report_pages(plm0)</code>: Get report pages for plm0 model object
</p>
</li>
<li> <p><code>get_report_pages(plm)</code>: Get report pages for plm model object
</p>
</li>
<li> <p><code>get_report_pages(gplm0)</code>: Get report pages for gplm0 model object
</p>
</li>
<li> <p><code>get_report_pages(gplm)</code>: Get report pages for gplm model object
</p>
</li>
<li> <p><code>get_report_pages(tournament)</code>: Get report pages for discharge rating curve tournament model object
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+tournament">tournament</a></code> for running a tournament,<code><a href="#topic+summary.tournament">summary.tournament</a></code> for summaries and <code><a href="#topic+get_report">get_report</a></code> for generating and saving a report of a tournament object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
plm0.fit &lt;- plm0(formula=Q~W,data=krokfors,num_cores=2)
plm0_pages &lt;- get_report_pages(plm0.fit)

</code></pre>

<hr>
<h2 id='gplm'>Generalized power-law model with variance that varies with stage.</h2><span id='topic+gplm'></span>

<h3>Description</h3>

<p>gplm is used to fit a discharge rating curve for paired measurements of stage and discharge using a generalized power-law model with variance that varies with stage as described in Hrafnkelsson et al. (2022).  See &quot;Details&quot; for a more elaborate description of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gplm(
  formula,
  data,
  c_param = NULL,
  h_max = NULL,
  parallel = TRUE,
  num_cores = NULL,
  forcepoint = rep(FALSE, nrow(data))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gplm_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;, with discharge column name as response and stage column name as a covariate, i.e. of the form <code>y</code>~<code>x</code> where <code>y</code> is discharge in m<code class="reqn">^3/</code>s and <code>x</code> is stage in m (it is very important that the data is in the correct units).</p>
</td></tr>
<tr><td><code id="gplm_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables specified in formula.</p>
</td></tr>
<tr><td><code id="gplm_+3A_c_param">c_param</code></td>
<td>
<p>stage for which there is zero discharge. If NULL, it is treated as unknown in the model and inferred from the data.</p>
</td></tr>
<tr><td><code id="gplm_+3A_h_max">h_max</code></td>
<td>
<p>maximum stage to which the rating curve should extrapolate to. If NULL, the maximum stage value in the data is selected as an upper bound.</p>
</td></tr>
<tr><td><code id="gplm_+3A_parallel">parallel</code></td>
<td>
<p>logical value indicating whether to run the MCMC in parallel or not. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="gplm_+3A_num_cores">num_cores</code></td>
<td>
<p>integer between 1 and 4 (number of MCMC chains) indicating how many cores to use. Only used if parallel=TRUE. If NULL, the number of cores available on the device is detected automatically.</p>
</td></tr>
<tr><td><code id="gplm_+3A_forcepoint">forcepoint</code></td>
<td>
<p>logical vector of the same length as the number of rows in data. If an element at index <code class="reqn">i</code> is TRUE it indicates that the rating curve should be forced through the <code class="reqn">i</code>-th measurement. Use with care, as this will strongly influence the resulting rating curve.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized power-law model is of the form
</p>
<p style="text-align: center;"><code class="reqn">Q=a(h-c)^{f(h)}</code>
</p>

<p>where <code class="reqn">Q</code> is discharge, <code class="reqn">h</code> is stage, <code class="reqn">a</code> and <code class="reqn">c</code> are unknown constants and <code class="reqn">f</code> is a function of <code class="reqn">h</code>, referred to as the generalized power-law exponent.<br /><br />
The generalized power-law model is here inferred by using a Bayesian hierarchical model. The function <code class="reqn">f</code> is modeled at the latent level as a fixed constant <code class="reqn">b</code> plus a continuous stochastic process, <code class="reqn">\beta(h)</code>, which is assumed to be twice differentiable. The model is on a logarithmic scale
</p>
<p style="text-align: center;"><code class="reqn">\log(Q_i) = \log(a) + (b + \beta(h_i)) \log(h_i - c) + \varepsilon_i,     i = 1,...,n</code>
</p>

<p>where <code class="reqn">\varepsilon_i</code> follows a normal distribution with mean zero and variance <code class="reqn">\sigma_\varepsilon(h_i)^2</code> that varies with stage. The stochastic process <code class="reqn">\beta(h)</code> is assumed a priori to be a Gaussian process governed by a Matern covariance function with smoothness parameter <code class="reqn">\nu = 2.5</code>. The error variance, <code class="reqn">\sigma_\varepsilon^2(h)</code>, of the log-discharge data  is modeled as an exponential of a B-spline curve, that is, a linear combination of six B-spline basis functions that are defined over the range of the stage observations. An efficient posterior simulation is achieved by sampling from the joint posterior density of the hyperparameters of the model, and then sampling from the density of the latent parameters conditional on the hyperparameters.<br /><br />
Bayesian inference is based on the posterior density and summary statistics such as the posterior mean and 95% posterior intervals are based on the posterior density. Analytical formulas for these summary statistics are intractable in most cases and thus they are computed by generating samples from the posterior density using a Markov chain Monte Carlo simulation.
</p>


<h3>Value</h3>

<p>gplm returns an object of class &quot;gplm&quot;. An object of class &quot;gplm&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>rating_curve</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior predictive distribution of the rating curve.</p>
</td></tr>
<tr><td><code>rating_curve_mean</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the mean of the rating curve.</p>
</td></tr>
<tr><td><code>param_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of latent- and hyperparameters. Additionally contains columns with r_hat and the effective number of samples for each parameter as defined in Gelman et al. (2013).</p>
</td></tr>
<tr><td><code>f_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of <code class="reqn">f(h)</code>.</p>
</td></tr>
<tr><td><code>beta_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of <code class="reqn">\beta(h)</code>.</p>
</td></tr>
<tr><td><code>sigma_eps_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of <code class="reqn">\sigma_\varepsilon(h)</code>.</p>
</td></tr>
<tr><td><code>Deviance_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the deviance.</p>
</td></tr>
<tr><td><code>rating_curve_posterior</code></td>
<td>
<p>a matrix containing the full thinned posterior samples of the posterior predictive distribution of the rating curve excluding burn-in samples.</p>
</td></tr>
<tr><td><code>rating_curve_mean_posterior</code></td>
<td>
<p>a matrix containing the full thinned posterior samples of the posterior distribution of the mean of the rating curve excluding burn-in samples.</p>
</td></tr>
<tr><td><code>a_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">a</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>b_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">b</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>c_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">c</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>sigma_beta_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\sigma_\beta</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>phi_beta_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\phi_\beta</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>sigma_eta_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\sigma_\eta</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>eta_1_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_1</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>eta_2_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_2</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>eta_3_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_3</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>eta_4_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_4</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>eta_5_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_5</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>eta_6_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_6</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>f_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">f(h)</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>beta_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\beta(h)</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>sigma_eps_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\sigma_\varepsilon(h)</code> excluding burn-in samples.</p>
</td></tr>
<tr><td><code>Deviance_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of the deviance excluding burn-in samples.</p>
</td></tr>
<tr><td><code>D_hat</code></td>
<td>
<p>deviance at the median value of the parameters.</p>
</td></tr>
<tr><td><code>effective_num_param_DIC</code></td>
<td>
<p>effective number of parameters, which is calculated as median(Deviance_posterior) minus D_hat.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance Information Criterion for the model, calculated as D_hat plus 2*effective_num_parameters_DIC.</p>
</td></tr>
<tr><td><code>lppd</code></td>
<td>
<p>log pointwise predictive probability of the observed data under the model</p>
</td></tr>
<tr><td><code>effective_num_param_WAIC</code></td>
<td>
<p>effective number of parameters, which is calculated by summing up the posterior variance of the log predictive density for each data point.</p>
</td></tr>
<tr><td><code>WAIC</code></td>
<td>
<p>Watanabe-Akaike information criterion for the model, defined as -2*( lppd - effective_num_param_WAIC ).</p>
</td></tr>
<tr><td><code>autocorrelation</code></td>
<td>
<p>a data frame with the autocorrelation of each parameter for different lags.</p>
</td></tr>
<tr><td><code>acceptance_rate</code></td>
<td>
<p>proportion of accepted samples in the thinned MCMC chain (excluding burn-in).</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>object of type &quot;formula&quot; provided by the user.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data provided by the user, ordered by stage.</p>
</td></tr>
<tr><td><code>run_info</code></td>
<td>
<p>information about the input arguments and the specific parameters used in the MCMC chain.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., and Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis.
</p>
<p>Hrafnkelsson, B., Sigurdarson, H., and Gardarsson, S. M. (2022). Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling, Environmetrics, 33(2):e2711.
</p>
<p>Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, A. (2002). Bayesian measures of model complexity and fit. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.gplm">summary.gplm</a></code> for summaries, <code><a href="#topic+predict.gplm">predict.gplm</a></code> for prediction and <code><a href="#topic+plot.gplm">plot.gplm</a></code> for plots. <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+gather_draws">gather_draws</a></code> are also useful to aid further visualization of the full posterior distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(norn)
set.seed(1)
gplm.fit &lt;- gplm(formula=Q~W,data=norn,num_cores=2)
summary(gplm.fit)

</code></pre>

<hr>
<h2 id='gplm0'>Generalized power-law model with a constant variance</h2><span id='topic+gplm0'></span>

<h3>Description</h3>

<p>gplm0 is used to fit a discharge rating curve for paired measurements of stage and discharge using a generalized power-law model with a constant variance as described in Hrafnkelsson et al. (2022). See &quot;Details&quot; for a more elaborate description of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gplm0(
  formula,
  data,
  c_param = NULL,
  h_max = NULL,
  parallel = TRUE,
  num_cores = NULL,
  forcepoint = rep(FALSE, nrow(data))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gplm0_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;, with discharge column name as response and stage column name as a covariate, i.e. of the form <code>y</code>~<code>x</code> where <code>y</code> is discharge in m<code class="reqn">^3/</code>s and <code>x</code> is stage in m (it is very important that the data is in the correct units).</p>
</td></tr>
<tr><td><code id="gplm0_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables specified in formula.</p>
</td></tr>
<tr><td><code id="gplm0_+3A_c_param">c_param</code></td>
<td>
<p>stage for which there is zero discharge. If NULL, it is treated as unknown in the model and inferred from the data.</p>
</td></tr>
<tr><td><code id="gplm0_+3A_h_max">h_max</code></td>
<td>
<p>maximum stage to which the rating curve should extrapolate to. If NULL, the maximum stage value in the data is selected as an upper bound.</p>
</td></tr>
<tr><td><code id="gplm0_+3A_parallel">parallel</code></td>
<td>
<p>logical value indicating whether to run the MCMC in parallel or not. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="gplm0_+3A_num_cores">num_cores</code></td>
<td>
<p>integer between 1 and 4 (number of MCMC chains) indicating how many cores to use. Only used if parallel=TRUE. If NULL, the number of cores available on the device is detected automatically.</p>
</td></tr>
<tr><td><code id="gplm0_+3A_forcepoint">forcepoint</code></td>
<td>
<p>logical vector of the same length as the number of rows in data. If an element at index <code class="reqn">i</code> is TRUE it indicates that the rating curve should be forced through the <code class="reqn">i</code>-th measurement. Use with care, as this will strongly influence the resulting rating curve.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized power-law model is of the form
</p>
<p style="text-align: center;"><code class="reqn">Q=a(h-c)^{f(h)}</code>
</p>

<p>where <code class="reqn">Q</code> is discharge, <code class="reqn">h</code> is stage, <code class="reqn">a</code> and <code class="reqn">c</code> are unknown constants and <code class="reqn">f</code> is a function of <code class="reqn">h</code> referred to as the generalized power-law exponent.<br /><br />
The generalized power-law model is here inferred by using a Bayesian hierarchical model. The function <code class="reqn">f</code> is modeled at the latent level as a fixed constant $b$ plus a continuous stochastic process,<code class="reqn">\beta(h)</code>, which is assumed to be twice differentiable. The model is on a logarithmic scale
</p>
<p style="text-align: center;"><code class="reqn">\log(Q_i) = \log(a) + (b + \beta(h_i)) \log(h_i - c) + \varepsilon,     i = 1,...,n</code>
</p>

<p>where <code class="reqn">\varepsilon</code> follows a normal distribution with mean zero and variance <code class="reqn">\sigma_\varepsilon^2</code>, independent of stage. The stochastic process <code class="reqn">\beta(h)</code> is assumed a priori to be a Gaussian process governed by a Matern covariance function with smoothness parameter <code class="reqn">\nu = 2.5</code>. An efficient posterior simulation is achieved by sampling from the joint posterior density of the hyperparameters of the model, and then sampling from the density of the latent parameters conditional on the hyperparameters.<br /><br />
Bayesian inference is based on the posterior density and summary statistics such as the posterior mean and 95% posterior intervals are based on the posterior density. Analytical formulas for these summary statistics are intractable in most cases and thus they are computed by generating samples from the posterior density using a Markov chain Monte Carlo simulation.
</p>


<h3>Value</h3>

<p>gplm0 returns an object of class &quot;gplm0&quot;. An object of class &quot;gplm0&quot; is a list containing the following components: <br />
</p>
<table>
<tr><td><code>rating_curve</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior predictive distribution of the rating curve.</p>
</td></tr>
<tr><td><code>rating_curve_mean</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the mean of the rating curve.</p>
</td></tr>
<tr><td><code>param_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of latent- and hyperparameters. Additionally contains columns with r_hat and the effective number of samples for each parameter as defined in Gelman et al. (2013).</p>
</td></tr>
<tr><td><code>beta_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of <code class="reqn">\beta</code>.</p>
</td></tr>
<tr><td><code>Deviance_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the deviance.</p>
</td></tr>
<tr><td><code>rating_curve_posterior</code></td>
<td>
<p>a matrix containing the full thinned posterior samples of the posterior predictive distribution of the rating curve (excluding burn-in).</p>
</td></tr>
<tr><td><code>rating_curve_mean_posterior</code></td>
<td>
<p>a matrix containing the full thinned posterior samples of the posterior distribution of the mean of the rating curve (excluding burn-in).</p>
</td></tr>
<tr><td><code>a_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">a</code>.</p>
</td></tr>
<tr><td><code>b_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">b</code>.</p>
</td></tr>
<tr><td><code>c_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">c</code>.</p>
</td></tr>
<tr><td><code>sigma_eps_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\sigma_{\varepsilon}</code>.</p>
</td></tr>
<tr><td><code>sigma_beta_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\sigma_{\beta}</code>.</p>
</td></tr>
<tr><td><code>phi_beta_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\phi_{\beta}</code>.</p>
</td></tr>
<tr><td><code>sigma_eta_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\sigma_{\eta}</code>.</p>
</td></tr>
<tr><td><code>beta_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\beta</code>.</p>
</td></tr>
<tr><td><code>Deviance_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of the deviance excluding burn-in samples.</p>
</td></tr>
<tr><td><code>D_hat</code></td>
<td>
<p>deviance at the median value of the parameters.</p>
</td></tr>
<tr><td><code>effective_num_param_DIC</code></td>
<td>
<p>effective number of parameters, which is calculated as median(Deviance_posterior) minus D_hat.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance Information Criterion for the model, calculated as D_hat plus 2*effective_num_parameters_DIC.</p>
</td></tr>
<tr><td><code>lppd</code></td>
<td>
<p>log pointwise predictive probability of the observed data under the model</p>
</td></tr>
<tr><td><code>effective_num_param_WAIC</code></td>
<td>
<p>effective number of parameters, which is calculated by summing up the posterior variance of the log predictive density for each data point.</p>
</td></tr>
<tr><td><code>WAIC</code></td>
<td>
<p>Watanabe-Akaike information criterion for the model, defined as -2*( lppd - effective_num_param_WAIC ).</p>
</td></tr>
<tr><td><code>autocorrelation</code></td>
<td>
<p>a data frame with the autocorrelation of each parameter for different lags.</p>
</td></tr>
<tr><td><code>acceptance_rate</code></td>
<td>
<p>proportion of accepted samples in the thinned MCMC chain (excluding burn-in).</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>object of type &quot;formula&quot; provided by the user.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data provided by the user, ordered by stage.</p>
</td></tr>
<tr><td><code>run_info</code></td>
<td>
<p>information about the input arguments and the specific parameters used in the MCMC chain.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., and Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis.
</p>
<p>Hrafnkelsson, B., Sigurdarson, H., and Gardarsson, S. M. (2022). Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling, Environmetrics, 33(2):e2711.
</p>
<p>Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, A. (2002). Bayesian measures of model complexity and fit. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.gplm0">summary.gplm0</a></code> for summaries, <code><a href="#topic+predict.gplm0">predict.gplm0</a></code> for prediction. It is also useful to look at <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+plot.gplm0">plot.gplm0</a></code> to help visualize the full posterior distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
gplm0.fit &lt;- gplm0(formula=Q~W,data=krokfors,num_cores=2)
summary(gplm0.fit)

</code></pre>

<hr>
<h2 id='jokdal'>Jokulsa a Dal gauging station in Iceland</h2><span id='topic+jokdal'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Jokulsa a Dal gauging station in Iceland
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jokdal
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Icelandic Meteorological Office, Landsvirkjun - the National Power Company of Iceland, and the Icelandic Road and Coastal Administration.
</p>

<hr>
<h2 id='jokfjoll'>Jokulsa a Fjollum gauging station in Iceland</h2><span id='topic+jokfjoll'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Jokulsa a Fjollum gauging station in Iceland
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jokfjoll
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Icelandic Meteorological Office, Landsvirkjun - the National Power Company of Iceland, and the Icelandic Road and Coastal Administration.
</p>

<hr>
<h2 id='kallstorp'>Kallstorp gauging station in Sweden</h2><span id='topic+kallstorp'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Kallstorp gauging station in Sweden
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kallstorp
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swedish Meteorological and Hydrological Institute.
</p>

<hr>
<h2 id='krokfors'>Krokfors gauging station in Sweden</h2><span id='topic+krokfors'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Krokfors gauging station in Sweden.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>krokfors
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swedish Meteorological and Hydrological Institute.
</p>

<hr>
<h2 id='melby'>Melby gauging station in Sweden</h2><span id='topic+melby'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Melby gauging station in Sweden
</p>


<h3>Usage</h3>

<pre><code class='language-R'>melby
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swedish Meteorological and Hydrological Institute.
</p>

<hr>
<h2 id='nordura'>Nordura gauging station in Iceland</h2><span id='topic+nordura'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Nordura gauging station in Iceland
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nordura
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Icelandic Meteorological Office, Landsvirkjun - the National Power Company of Iceland, and the Icelandic Road and Coastal Administration.
</p>

<hr>
<h2 id='norn'>Norn gauging station in Sweden</h2><span id='topic+norn'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Norn gauging station in Sweden.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>norn
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swedish Meteorological and Hydrological Institute.
</p>

<hr>
<h2 id='plm'>Power-law model with variance that varies with stage.</h2><span id='topic+plm'></span>

<h3>Description</h3>

<p>plm is used to fit a discharge rating curve for paired measurements of stage and discharge using a power-law model with variance that varies with stage as described in Hrafnkelsson et al. (2022). See &quot;Details&quot; for a more elaborate description of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plm(
  formula,
  data,
  c_param = NULL,
  h_max = NULL,
  parallel = TRUE,
  num_cores = NULL,
  forcepoint = rep(FALSE, nrow(data))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plm_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;, with discharge column name as response and stage column name as a covariate, i.e. of the form <code>y</code>~<code>x</code> where <code>y</code> is discharge in m<code class="reqn">^3/</code>s and <code>x</code> is stage in m (it is very important that the data is in the correct units).</p>
</td></tr>
<tr><td><code id="plm_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables specified in formula.</p>
</td></tr>
<tr><td><code id="plm_+3A_c_param">c_param</code></td>
<td>
<p>stage for which there is zero discharge. If NULL, it is treated as unknown in the model and inferred from the data.</p>
</td></tr>
<tr><td><code id="plm_+3A_h_max">h_max</code></td>
<td>
<p>maximum stage to which the rating curve should extrapolate to. If NULL, the maximum stage value in the data is selected as an upper bound.</p>
</td></tr>
<tr><td><code id="plm_+3A_parallel">parallel</code></td>
<td>
<p>logical value indicating whether to run the MCMC in parallel or not. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plm_+3A_num_cores">num_cores</code></td>
<td>
<p>integer between 1 and 4 (number of MCMC chains) indicating how many cores to use. Only used if parallel=TRUE. If NULL, the number of cores available on the device is detected automatically.</p>
</td></tr>
<tr><td><code id="plm_+3A_forcepoint">forcepoint</code></td>
<td>
<p>logical vector of the same length as the number of rows in data. If an element at index <code class="reqn">i</code> is TRUE it indicates that the rating curve should be forced through the <code class="reqn">i</code>-th measurement. Use with care, as this will strongly influence the resulting rating curve.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power-law model, which is commonly used in hydraulic practice, is of the form
</p>
<p style="text-align: center;"><code class="reqn">Q=a(h-c)^{b}</code>
</p>

<p>where <code class="reqn">Q</code> is discharge, <code class="reqn">h</code> is stage and <code class="reqn">a</code>, <code class="reqn">b</code> and <code class="reqn">c</code> are unknown constants.<br /><br />
The power-law model is here inferred by using a Bayesian hierarchical model. The model is on a logarithmic scale
</p>
<p style="text-align: center;"><code class="reqn">\log(Q_i) = \log(a) + b \log(h_i - c) + \varepsilon_i,     i = 1,...,n</code>
</p>

<p>where <code class="reqn">\varepsilon_i</code> follows a normal distribution with mean zero and variance <code class="reqn">\sigma_\varepsilon(h_i)^2</code> that varies with stage. The error variance, <code class="reqn">\sigma_\varepsilon^2(h)</code>, of the log-discharge data is modeled as an exponential of a B-spline curve, that is, a linear combination of six B-spline basis functions that are defined over the range of the stage observations. An efficient posterior simulation is achieved by sampling from the joint posterior density of the hyperparameters of the model, and then sampling from the density of the latent parameters conditional on the hyperparameters.<br /><br />
Bayesian inference is based on the posterior density and summary statistics such as the posterior mean and 95% posterior intervals are based on the posterior density. Analytical formulas for these summary statistics are intractable in most cases and thus they are computed by generating samples from the posterior density using a Markov chain Monte Carlo simulation.
</p>


<h3>Value</h3>

<p>plm returns an object of class &quot;plm&quot;. An object of class &quot;plm&quot; is a list containing the following components: <br />
</p>
<table>
<tr><td><code>rating_curve</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior predictive distribution of the rating curve.</p>
</td></tr>
<tr><td><code>rating_curve_mean</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the mean of the rating curve. Additionally contains columns with r_hat and the effective number of samples for each parameter as defined in Gelman et al. (2013).</p>
</td></tr>
<tr><td><code>param_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of latent- and hyperparameters.</p>
</td></tr>
<tr><td><code>sigma_eps_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior of <code class="reqn">\sigma_{\varepsilon}</code>.</p>
</td></tr>
<tr><td><code>Deviance_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the deviance.</p>
</td></tr>
<tr><td><code>rating_curve_posterior</code></td>
<td>
<p>a matrix containing the full thinned posterior samples of the posterior predictive distribution of the rating curve (excluding burn-in).</p>
</td></tr>
<tr><td><code>rating_curve_mean_posterior</code></td>
<td>
<p>a matrix containing the full thinned posterior samples of the posterior distribution of the mean of the rating curve (excluding burn-in).</p>
</td></tr>
<tr><td><code>a_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">a</code>.</p>
</td></tr>
<tr><td><code>b_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">b</code>.</p>
</td></tr>
<tr><td><code>c_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">c</code>.</p>
</td></tr>
<tr><td><code>sigma_eps_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\sigma_{\varepsilon}</code>.</p>
</td></tr>
<tr><td><code>eta_1_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_1</code>.</p>
</td></tr>
<tr><td><code>eta_2_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_2</code>.</p>
</td></tr>
<tr><td><code>eta_3_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_3</code>.</p>
</td></tr>
<tr><td><code>eta_4_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_4</code>.</p>
</td></tr>
<tr><td><code>eta_5_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_5</code>.</p>
</td></tr>
<tr><td><code>eta_6_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\eta_6</code>.</p>
</td></tr>
<tr><td><code>Deviance_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of the deviance excluding burn-in samples.</p>
</td></tr>
<tr><td><code>D_hat</code></td>
<td>
<p>deviance at the median value of the parameters.</p>
</td></tr>
<tr><td><code>effective_num_param_DIC</code></td>
<td>
<p>effective number of parameters, which is calculated as median(Deviance_posterior) minus D_hat.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance Information Criterion for the model, calculated as D_hat plus 2*effective_num_parameters_DIC.</p>
</td></tr>
<tr><td><code>lppd</code></td>
<td>
<p>log pointwise predictive probability of the observed data under the model</p>
</td></tr>
<tr><td><code>effective_num_param_WAIC</code></td>
<td>
<p>effective number of parameters, which is calculated by summing up the posterior variance of the log predictive density for each data point.</p>
</td></tr>
<tr><td><code>WAIC</code></td>
<td>
<p>Watanabe-Akaike information criterion for the model, defined as -2*( lppd - effective_num_param_WAIC ).</p>
</td></tr>
<tr><td><code>autocorrelation</code></td>
<td>
<p>a data frame with the autocorrelation of each parameter for different lags.</p>
</td></tr>
<tr><td><code>acceptance_rate</code></td>
<td>
<p>proportion of accepted samples in the thinned MCMC chain (excluding burn-in).</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>object of type &quot;formula&quot; provided by the user.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data provided by the user, ordered by stage.</p>
</td></tr>
<tr><td><code>run_info</code></td>
<td>
<p>information about the input arguments and the specific parameters used in the MCMC chain.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., and Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis.
</p>
<p>Hrafnkelsson, B., Sigurdarson, H., and Gardarsson, S. M. (2022). Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling, Environmetrics, 33(2):e2711.
</p>
<p>Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, A. (2002). Bayesian measures of model complexity and fit. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.plm">summary.plm</a></code> for summaries, <code><a href="#topic+predict.plm">predict.plm</a></code> for prediction. It is also useful to look at <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+plot.plm">plot.plm</a></code> to help visualize the full posterior distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(spanga)
set.seed(1)
plm.fit &lt;- plm(formula=Q~W,data=spanga,num_cores=2)
summary(plm.fit)

</code></pre>

<hr>
<h2 id='plm0'>Power-law model with a constant variance</h2><span id='topic+plm0'></span>

<h3>Description</h3>

<p>plm0 is used to fit a discharge rating curve for paired measurements of stage and discharge using a power-law model with a constant variance as described in Hrafnkelsson et al. (2022). See &quot;Details&quot; for a more elaborate description of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plm0(
  formula,
  data,
  c_param = NULL,
  h_max = NULL,
  parallel = TRUE,
  num_cores = NULL,
  forcepoint = rep(FALSE, nrow(data))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plm0_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;, with discharge column name as response and stage column name as a covariate, i.e. of the form <code>y</code>~<code>x</code> where <code>y</code> is discharge in m<code class="reqn">^3/</code>s and <code>x</code> is stage in m (it is very important that the data is in the correct units).</p>
</td></tr>
<tr><td><code id="plm0_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables specified in formula.</p>
</td></tr>
<tr><td><code id="plm0_+3A_c_param">c_param</code></td>
<td>
<p>stage for which there is zero discharge. If NULL, it is treated as unknown in the model and inferred from the data.</p>
</td></tr>
<tr><td><code id="plm0_+3A_h_max">h_max</code></td>
<td>
<p>maximum stage to which the rating curve should extrapolate to. If NULL, the maximum stage value in the data is selected as an upper bound.</p>
</td></tr>
<tr><td><code id="plm0_+3A_parallel">parallel</code></td>
<td>
<p>logical value indicating whether to run the MCMC in parallel or not. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plm0_+3A_num_cores">num_cores</code></td>
<td>
<p>integer between 1 and 4 (number of MCMC chains) indicating how many cores to use. Only used if parallel=TRUE. If NULL, the number of cores available on the device is detected automatically.</p>
</td></tr>
<tr><td><code id="plm0_+3A_forcepoint">forcepoint</code></td>
<td>
<p>logical vector of the same length as the number of rows in data. If an element at index <code class="reqn">i</code> is TRUE it indicates that the rating curve should be forced through the <code class="reqn">i</code>-th measurement. Use with care, as this will strongly influence the resulting rating curve.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power-law model, which is commonly used in hydraulic practice, is of the form
</p>
<p style="text-align: center;"><code class="reqn">Q=a(h-c)^{b}</code>
</p>

<p>where <code class="reqn">Q</code> is discharge, <code class="reqn">h</code> is stage and <code class="reqn">a</code>, <code class="reqn">b</code> and <code class="reqn">c</code> are unknown constants.<br /><br />
The power-law model is here inferred by using a Bayesian hierarchical model. The model is on a logarithmic scale
</p>
<p style="text-align: center;"><code class="reqn">\log(Q_i) = \log(a) + b \log(h_i - c) + \varepsilon,     i = 1,...,n</code>
</p>

<p>where <code class="reqn">\varepsilon</code> follows a normal distribution with mean zero and variance <code class="reqn">\sigma_\varepsilon^2</code>, independent of stage. An efficient posterior simulation is achieved by sampling from the joint posterior density of the hyperparameters of the model, and then sampling from the density of the latent parameters conditional on the hyperparameters.<br /><br />
Bayesian inference is based on the posterior density and summary statistics such as the posterior mean and 95% posterior intervals are based on the posterior density. Analytical formulas for these summary statistics are intractable in most cases and thus they are computed by generating samples from the posterior density using a Markov chain Monte Carlo simulation.
</p>


<h3>Value</h3>

<p>plm0 returns an object of class &quot;plm0&quot;. An object of class &quot;plm0&quot; is a list containing the following components: <br />
</p>
<table>
<tr><td><code>rating_curve</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior predictive distribution of the rating curve.</p>
</td></tr>
<tr><td><code>rating_curve_mean</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the mean of the rating curve.</p>
</td></tr>
<tr><td><code>param_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of latent- and hyperparameters. Additionally contains columns with r_hat and the effective number of samples for each parameter as defined in Gelman et al. (2013).</p>
</td></tr>
<tr><td><code>Deviance_summary</code></td>
<td>
<p>a data frame with 2.5%, 50% and 97.5% percentiles of the posterior distribution of the deviance.</p>
</td></tr>
<tr><td><code>rating_curve_posterior</code></td>
<td>
<p>a matrix containing the full thinned posterior samples of the posterior predictive distribution of the rating curve (excluding burn-in).</p>
</td></tr>
<tr><td><code>rating_curve_mean_posterior</code></td>
<td>
<p>a matrix containing the full thinned posterior samples of the posterior distribution of the mean of the rating curve (excluding burn-in).</p>
</td></tr>
<tr><td><code>a_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">a</code>.</p>
</td></tr>
<tr><td><code>b_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">b</code>.</p>
</td></tr>
<tr><td><code>c_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">c</code>.</p>
</td></tr>
<tr><td><code>sigma_eps_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of <code class="reqn">\sigma_{\varepsilon}</code>.</p>
</td></tr>
<tr><td><code>Deviance_posterior</code></td>
<td>
<p>a numeric vector containing the full thinned posterior samples of the posterior distribution of the deviance excluding burn-in samples.</p>
</td></tr>
<tr><td><code>D_hat</code></td>
<td>
<p>deviance at the median value of the parameters</p>
</td></tr>
<tr><td><code>effective_num_param_DIC</code></td>
<td>
<p>effective number of parameters, which is calculated as median(Deviance_posterior) minus D_hat.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance Information Criterion for the model, calculated as D_hat plus 2*effective_num_parameters_DIC.</p>
</td></tr>
<tr><td><code>lppd</code></td>
<td>
<p>log pointwise predictive probability of the observed data under the model</p>
</td></tr>
<tr><td><code>effective_num_param_WAIC</code></td>
<td>
<p>effective number of parameters, which is calculated by summing up the posterior variance of the log predictive density for each data point.</p>
</td></tr>
<tr><td><code>WAIC</code></td>
<td>
<p>Watanabe-Akaike information criterion for the model, defined as -2*( lppd - effective_num_param_WAIC ).</p>
</td></tr>
<tr><td><code>autocorrelation</code></td>
<td>
<p>a data frame with the autocorrelation of each parameter for different lags.</p>
</td></tr>
<tr><td><code>acceptance_rate</code></td>
<td>
<p>proportion of accepted samples in the thinned MCMC chain (excluding burn-in).</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>object of type &quot;formula&quot; provided by the user.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data provided by the user, ordered by stage.</p>
</td></tr>
<tr><td><code>run_info</code></td>
<td>
<p>information about the input arguments and the specific parameters used in the MCMC chain.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., and Rubin, D. B. (2013). Bayesian Data Analysis, Third Edition. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis.
</p>
<p>Hrafnkelsson, B., Sigurdarson, H., and Gardarsson, S. M. (2022). Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling, Environmetrics, 33(2):e2711.
</p>
<p>Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, A. (2002). Bayesian measures of model complexity and fit. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.plm0">summary.plm0</a></code> for summaries, <code><a href="#topic+predict.plm0">predict.plm0</a></code> for prediction. It is also useful to look at <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+plot.plm0">plot.plm0</a></code> to help visualize the full posterior distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(skogsliden)
set.seed(1)
plm0.fit &lt;- plm0(formula=Q~W,data=skogsliden,num_cores=2)
summary(plm0.fit)

</code></pre>

<hr>
<h2 id='plot_fun'>Plot bdrc model objects</h2><span id='topic+plot_fun'></span>

<h3>Description</h3>

<p>Visualize results from model objects in bdrc, plm0, plm, gplm0,gplm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_fun(
  x,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_fun_+3A_x">x</code></td>
<td>
<p>an object of class &quot;plm0&quot;,&quot;plm&quot;,&quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="plot_fun_+3A_type">type</code></td>
<td>
<p>a character denoting what type of plot should be drawn. Defaults to &quot;rating_curve&quot;. Possible types are
</p>

<ul>
<li><p>&quot;rating_curve&quot; to plot the rating curve.
</p>
</li>
<li><p>&quot;rating_curve_mean&quot; to plot the posterior mean of the rating curve.
</p>
</li>
<li><p>&quot;f&quot; to plot the power-law exponent.
</p>
</li>
<li><p>&quot;beta&quot; to plot the random effect in the power-law exponent.
</p>
</li>
<li><p>&quot;sigma_eps&quot; to plot the standard deviation on the data level.
</p>
</li>
<li><p>&quot;residuals&quot; to plot the log residuals.
</p>
</li>
<li><p>&quot;trace&quot; to plot trace plots of parameters given in param.
</p>
</li>
<li><p>&quot;histogram&quot; to plot histograms of parameters given in param.
</p>
</li>
<li><p>&quot;panel&quot; to plot a 2x2 panel of plots: &quot;rating curve&quot;, &quot;residuals&quot;, &quot;f&quot; and &quot;sigma_eps&quot;
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_fun_+3A_param">param</code></td>
<td>
<p>a character vector with the parameters to plot. Defaults to NULL and is only used if type is &quot;trace&quot; or &quot;histogram&quot;. Allowed values are the parameters given in the model summary of x as well as &quot;hyperparameters&quot; or &quot;latent_parameters&quot; for specific groups of parameters.</p>
</td></tr>
<tr><td><code id="plot_fun_+3A_transformed">transformed</code></td>
<td>
<p>a logical value indicating whether the quantity should be plotted on a transformed scale used during the Bayesian inference. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot_fun_+3A_title">title</code></td>
<td>
<p>a character denoting the title of the plot. Defaults to NULL, i.e. no title.</p>
</td></tr>
<tr><td><code id="plot_fun_+3A_xlim">xlim</code></td>
<td>
<p>numeric vector of length 2, denoting the limits on the x axis of the plot. Applicable for types &quot;rating_curve&quot;,&quot;rating_curve_mean&quot;,&quot;f&quot;,&quot;beta&quot;,&quot;sigma_eps&quot;,&quot;residuals&quot;.</p>
</td></tr>
<tr><td><code id="plot_fun_+3A_ylim">ylim</code></td>
<td>
<p>numeric vector of length 2, denoting the limits on the y axis of the plot. Applicable for types &quot;rating_curve&quot;,&quot;rating_curve_mean&quot;,&quot;f&quot;,&quot;beta&quot;,&quot;sigma_eps&quot;,&quot;residuals&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an object of class ggplot2.
</p>

<hr>
<h2 id='plot.plm0'>Plot method for discharge rating curves</h2><span id='topic+plot.plm0'></span><span id='topic+plot.plm'></span><span id='topic+plot.gplm0'></span><span id='topic+plot.gplm'></span>

<h3>Description</h3>

<p>Visualize discharge rating curve model objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plm0'
plot(
  x,
  ...,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL
)

## S3 method for class 'plm'
plot(
  x,
  ...,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL
)

## S3 method for class 'gplm0'
plot(
  x,
  ...,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL
)

## S3 method for class 'gplm'
plot(
  x,
  ...,
  type = "rating_curve",
  param = NULL,
  transformed = FALSE,
  title = NULL,
  xlim = NULL,
  ylim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.plm0_+3A_x">x</code></td>
<td>
<p>object of class &quot;plm0&quot;, &quot;plm&quot;, &quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="plot.plm0_+3A_...">...</code></td>
<td>
<p>other plotting parameters (not used in this function)</p>
</td></tr>
<tr><td><code id="plot.plm0_+3A_type">type</code></td>
<td>
<p>a character denoting what type of plot should be drawn. Defaults to &quot;rating_curve&quot;. Possible types are
</p>

<ul>
<li><p>&quot;rating_curve&quot; to plot the rating curve.
</p>
</li>
<li><p>&quot;rating_curve_mean&quot; to plot the posterior mean of the rating curve.
</p>
</li>
<li><p>&quot;f&quot; to plot the power-law exponent.
</p>
</li>
<li><p>&quot;beta&quot; to plot the random effect in the power-law exponent.
</p>
</li>
<li><p>&quot;sigma_eps&quot; to plot the standard deviation on the data level.
</p>
</li>
<li><p>&quot;residuals&quot; to plot the log residuals.
</p>
</li>
<li><p>&quot;trace&quot; to plot trace plots of parameters given in param.
</p>
</li>
<li><p>&quot;histogram&quot; to plot histograms of parameters given in param.
</p>
</li>
<li><p>&quot;panel&quot; to plot a 2x2 panel of plots: &quot;rating curve&quot;, &quot;residuals&quot;, &quot;f&quot; and &quot;sigma_eps&quot;
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.plm0_+3A_param">param</code></td>
<td>
<p>a character vector with the parameters to plot. Defaults to NULL and is only used if type is &quot;trace&quot; or &quot;histogram&quot;. Allowed values are the parameters given in the model summary of x as well as &quot;hyperparameters&quot; or &quot;latent_parameters&quot; for specific groups of parameters.</p>
</td></tr>
<tr><td><code id="plot.plm0_+3A_transformed">transformed</code></td>
<td>
<p>a logical value indicating whether the quantity should be plotted on a transformed scale used during the Bayesian inference. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot.plm0_+3A_title">title</code></td>
<td>
<p>a character denoting the title of the plot</p>
</td></tr>
<tr><td><code id="plot.plm0_+3A_xlim">xlim</code></td>
<td>
<p>numeric vector of length 2, denoting the limits on the x axis of the plot. Applicable for types &quot;rating_curve&quot;,&quot;rating_curve_mean&quot;,&quot;f&quot;,&quot;beta&quot;,&quot;sigma_eps&quot;,&quot;residuals&quot;.</p>
</td></tr>
<tr><td><code id="plot.plm0_+3A_ylim">ylim</code></td>
<td>
<p>numeric vector of length 2, denoting the limits on the y axis of the plot. Applicable for types &quot;rating_curve&quot;,&quot;rating_curve_mean&quot;,&quot;f&quot;,&quot;beta&quot;,&quot;sigma_eps&quot;,&quot;residuals&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>plot(plm0)</code>: Plot method for plm0
</p>
</li>
<li> <p><code>plot(plm)</code>: Plot method for plm
</p>
</li>
<li> <p><code>plot(gplm0)</code>: Plot method for gplm0
</p>
</li>
<li> <p><code>plot(gplm)</code>: Plot method for gplm
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+plm0">plm0</a></code>, <code><a href="#topic+plm">plm</a></code>, <code><a href="#topic+gplm0">gplm0</a></code> and <code><a href="#topic+gplm">gplm</a></code> for fitting a discharge rating curve and <code><a href="#topic+summary.plm0">summary.plm0</a></code>, <code><a href="#topic+summary.plm">summary.plm</a></code>, <code><a href="#topic+summary.gplm0">summary.gplm0</a></code> and <code><a href="#topic+summary.gplm">summary.gplm</a></code> for summaries. It is also useful to look at <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+gather_draws">gather_draws</a></code> to work directly with the MCMC samples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
plm0.fit &lt;- plm0(formula=Q~W,data=krokfors,num_cores=2)

plot(plm0.fit)
plot(plm0.fit,transformed=TRUE)
plot(plm0.fit,type='histogram',param='c')
plot(plm0.fit,type='histogram',param='c',transformed=TRUE)
plot(plm0.fit,type='histogram',param='hyperparameters')
plot(plm0.fit,type='histogram',param='latent_parameters')
plot(plm0.fit,type='residuals')
plot(plm0.fit,type='f')
plot(plm0.fit,type='sigma_eps')

</code></pre>

<hr>
<h2 id='plot.tournament'>Plot method for discharge rating curve tournament</h2><span id='topic+plot.tournament'></span>

<h3>Description</h3>

<p>Compare the four models from the tournament object in multiple ways
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tournament'
plot(x, ..., type = "tournament_results", transformed = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.tournament_+3A_x">x</code></td>
<td>
<p>an object of class &quot;tournament&quot;</p>
</td></tr>
<tr><td><code id="plot.tournament_+3A_...">...</code></td>
<td>
<p>other plotting parameters (not used in this function)</p>
</td></tr>
<tr><td><code id="plot.tournament_+3A_type">type</code></td>
<td>
<p>a character denoting what type of plot should be drawn. Possible types are
</p>

<ul>
<li><p>&quot;deviance&quot; to plot the deviance of the four models.
</p>
</li>
<li><p>&quot;rating_curve&quot; to plot the rating curve.
</p>
</li>
<li><p>&quot;rating_curve_mean&quot; to plot the posterior mean of the rating curve.
</p>
</li>
<li><p>&quot;f&quot; to plot the power-law exponent.
</p>
</li>
<li><p>&quot;sigma_eps&quot; to plot the standard deviation on the data level.
</p>
</li>
<li><p>&quot;residuals&quot; to plot the log residuals.
</p>
</li>
<li><p>&quot;tournament_results&quot; to plot tournament results visually, game for game.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.tournament_+3A_transformed">transformed</code></td>
<td>
<p>a logical value indicating whether the quantity should be plotted on a transformed scale used during the Bayesian inference. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tournament">tournament</a></code> to run a discharge rating curve tournament and <code><a href="#topic+summary.tournament">summary.tournament</a></code> for summaries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
t_obj &lt;- tournament(formula=Q~W,data=krokfors,num_cores=2)
plot(t_obj)
plot(t_obj,transformed=TRUE)
plot(t_obj,type='deviance')
plot(t_obj,type='f')
plot(t_obj,type='sigma_eps')
plot(t_obj,type='residuals')
plot(t_obj,type='tournament_results')

</code></pre>

<hr>
<h2 id='predict.plm0'>Predict method for discharge rating curves</h2><span id='topic+predict.plm0'></span><span id='topic+predict.plm'></span><span id='topic+predict.gplm0'></span><span id='topic+predict.gplm'></span>

<h3>Description</h3>

<p>Predict the discharge for given stage values based on a discharge rating curve model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plm0'
predict(object, ..., newdata = NULL, wide = FALSE)

## S3 method for class 'plm'
predict(object, ..., newdata = NULL, wide = FALSE)

## S3 method for class 'gplm0'
predict(object, ..., newdata = NULL, wide = FALSE)

## S3 method for class 'gplm'
predict(object, ..., newdata = NULL, wide = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.plm0_+3A_object">object</code></td>
<td>
<p>an object of class &quot;plm0&quot;, &quot;plm&quot;, &quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="predict.plm0_+3A_...">...</code></td>
<td>
<p>not used in this function</p>
</td></tr>
<tr><td><code id="predict.plm0_+3A_newdata">newdata</code></td>
<td>
<p>a numeric vector of stage values for which to predict. If omitted, the stage values in the data are used.</p>
</td></tr>
<tr><td><code id="predict.plm0_+3A_wide">wide</code></td>
<td>
<p>a logical value denoting whether to produce a wide prediction output.If TRUE, then the output is a table with median prediction values for an equally spaced grid of stages with 1 cm increments, each row containing predictions in a decimeter range of stages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;data.frame&quot; with four columns, h (stage), lower (2.5% posterior predictive quantile), median (50% posterior predictive quantile), upper (97.5% posterior predictive quantile). If wide=TRUE, a matrix as described above (see wide parameter) is returned.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>predict(plm0)</code>: Predict method for plm0
</p>
</li>
<li> <p><code>predict(plm)</code>: Predict method for plm
</p>
</li>
<li> <p><code>predict(gplm0)</code>: Predict method for gplm0
</p>
</li>
<li> <p><code>predict(gplm)</code>: Predict method for gplm
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+plm0">plm0</a></code>, <code><a href="#topic+plm">plm</a></code>, <code><a href="#topic+gplm0">gplm0</a></code> and <code><a href="#topic+gplm">gplm</a></code> for fitting a discharge rating curve and <code><a href="#topic+summary.plm0">summary.plm0</a></code>, <code><a href="#topic+summary.plm">summary.plm</a></code>, <code><a href="#topic+summary.gplm0">summary.gplm0</a></code> and <code><a href="#topic+summary.gplm">summary.gplm</a></code> for summaries. It is also useful to look at <code><a href="#topic+plot.plm0">plot.plm0</a></code>, <code><a href="#topic+plot.plm">plot.plm</a></code>, <code><a href="#topic+plot.gplm0">plot.gplm0</a></code> and <code><a href="#topic+plot.gplm">plot.gplm</a></code> to help visualize all aspects of the fitted discharge rating curve. Additionally, <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+spread_draws">spread_draws</a></code> help working directly with the MCMC samples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
plm0.fit &lt;- plm0(formula=Q~W,data=krokfors,h_max=10,num_cores=2)
#predict rating curve on a equally 10 cm spaced grid from 9 to 10 meters
predict(plm0.fit,newdata=seq(9,10,by=0.1))

</code></pre>

<hr>
<h2 id='print.plm0'>Print method for discharge rating curves</h2><span id='topic+print.plm0'></span><span id='topic+print.plm'></span><span id='topic+print.gplm0'></span><span id='topic+print.gplm'></span>

<h3>Description</h3>

<p>Print a discharge rating curve model object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plm0'
print(x, ...)

## S3 method for class 'plm'
print(x, ...)

## S3 method for class 'gplm0'
print(x, ...)

## S3 method for class 'gplm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.plm0_+3A_x">x</code></td>
<td>
<p>an object of class &quot;plm0&quot;, &quot;plm&quot;, &quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="print.plm0_+3A_...">...</code></td>
<td>
<p>not used in this function</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>print(plm0)</code>: Print method for plm0
</p>
</li>
<li> <p><code>print(plm)</code>: Print method for plm
</p>
</li>
<li> <p><code>print(gplm0)</code>: Print method for gplm0
</p>
</li>
<li> <p><code>print(gplm)</code>: Print method for gplm
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+plm0">plm0</a></code>, <code><a href="#topic+plm">plm</a></code>, <code><a href="#topic+gplm0">gplm0</a></code>, <code><a href="#topic+gplm">gplm</a></code> for fitting a discharge rating curve and <code><a href="#topic+summary.plm0">summary.plm0</a></code>, <code><a href="#topic+summary.plm">summary.plm</a></code>, <code><a href="#topic+summary.gplm0">summary.gplm0</a></code> and <code><a href="#topic+summary.gplm">summary.gplm</a></code> for summaries. It is also useful to look at <code><a href="#topic+plot.plm0">plot.plm0</a></code>, <code><a href="#topic+plot.plm">plot.plm</a></code>, <code><a href="#topic+plot.gplm0">plot.gplm0</a></code> and <code><a href="#topic+plot.gplm">plot.gplm</a></code> to help visualize all aspects of the fitted discharge rating curve. Additionally, <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+spread_draws">spread_draws</a></code> help working directly with the MCMC samples.
</p>

<hr>
<h2 id='print.tournament'>Print method for discharge rating curve tournament</h2><span id='topic+print.tournament'></span>

<h3>Description</h3>

<p>Print the results of a tournament of discharge rating curve model comparisons
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tournament'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.tournament_+3A_x">x</code></td>
<td>
<p>an object of class &quot;tournament&quot;</p>
</td></tr>
<tr><td><code id="print.tournament_+3A_...">...</code></td>
<td>
<p>not used in this function</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+tournament">tournament</a></code> to run a discharge rating curve tournament, <code><a href="#topic+summary.tournament">summary.tournament</a></code> for summaries and <code><a href="#topic+plot.tournament">plot.tournament</a></code> for visualizing the mode comparison.
</p>

<hr>
<h2 id='skjalf'>Skjalfandafljot gauging station in Iceland</h2><span id='topic+skjalf'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Skjalfandafljot gauging station in Iceland
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skjalf
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Icelandic Meteorological Office, Landsvirkjun - the National Power Company of Iceland, and the Icelandic Road and Coastal Administration.
</p>

<hr>
<h2 id='skogsliden'>Skogsliden gauging station in Sweden</h2><span id='topic+skogsliden'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Skogsliden gauging station in Sweden
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skogsliden
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swedish Meteorological and Hydrological Institute.
</p>

<hr>
<h2 id='spanga'>Spanga gauging station in Sweden</h2><span id='topic+spanga'></span>

<h3>Description</h3>

<p>Data on discharge and stage from Spanga gauging station in Sweden.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spanga
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>W</dt><dd><p>Measurements of water stage in meters</p>
</dd>
<dt>Q</dt><dd><p>Measurements of water discharge in cubic meters per second</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swedish Meteorological and Hydrological Institute.
</p>

<hr>
<h2 id='spread_draws'>Spread MCMC chain draws to data.frame on a wide format</h2><span id='topic+spread_draws'></span>

<h3>Description</h3>

<p>Useful to convert MCMC chain draws of particular parameters or output from the model object to a wide format for further data wrangling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spread_draws(mod, ..., transformed = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spread_draws_+3A_mod">mod</code></td>
<td>
<p>an object of class &quot;plm0&quot;,&quot;plm&quot;,&quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="spread_draws_+3A_...">...</code></td>
<td>
<p>any number of character vectors containing valid names of parameters in the model or &quot;rating_curve&quot; and &quot;rating_curve_mean&quot;. Also accepts &quot;latent_parameters&quot; and &quot;hyperparameters&quot;.</p>
</td></tr>
<tr><td><code id="spread_draws_+3A_transformed">transformed</code></td>
<td>
<p>boolean value determining whether the output is to be represented on the transformed scale used for sampling in the MCMC chain or the original scale. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with columns
<code>chain</code>
<code>iter</code>
<code>param</code>
<code>value</code>
</p>


<h3>References</h3>

<p>B. Hrafnkelsson, H. Sigurdarson, S.M. Gardarsson, 2020, Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling. arXiv preprint 2010.04769
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plm0">plm0</a></code>, <code><a href="#topic+plm">plm</a></code>, <code><a href="#topic+gplm0">gplm0</a></code>, <code><a href="#topic+gplm">gplm</a></code> for further information on parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
plm0.fit &lt;- plm0(formula=Q~W,data=krokfors,num_cores=2)
hyp_samples &lt;- spread_draws(plm0.fit,'hyperparameters')
head(hyp_samples)
rating_curve_samples &lt;- spread_draws(plm0.fit,'rating_curve','rating_curve_mean')
head(rating_curve_samples)

</code></pre>

<hr>
<h2 id='summary.plm0'>Summary method for discharge rating curves</h2><span id='topic+summary.plm0'></span><span id='topic+summary.plm'></span><span id='topic+summary.gplm0'></span><span id='topic+summary.gplm'></span>

<h3>Description</h3>

<p>Summarize a discharge rating curve model object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plm0'
summary(object, ...)

## S3 method for class 'plm'
summary(object, ...)

## S3 method for class 'gplm0'
summary(object, ...)

## S3 method for class 'gplm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.plm0_+3A_object">object</code></td>
<td>
<p>an object of class &quot;plm0&quot;, &quot;plm&quot;, &quot;gplm0&quot; or &quot;gplm&quot;.</p>
</td></tr>
<tr><td><code id="summary.plm0_+3A_...">...</code></td>
<td>
<p>Not used for this function</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>summary(plm0)</code>: Summary method for plm0
</p>
</li>
<li> <p><code>summary(plm)</code>: Summary method for plm
</p>
</li>
<li> <p><code>summary(gplm0)</code>: Summary method for gplm0
</p>
</li>
<li> <p><code>summary(gplm)</code>: Summary method for gplm
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+plm0">plm0</a></code>, <code><a href="#topic+plm">plm</a></code>, <code><a href="#topic+gplm0">gplm0</a></code> and <code><a href="#topic+gplm">gplm</a></code> for fitting a discharge rating curve. It is also useful to look at <code><a href="#topic+plot.plm0">plot.plm0</a></code>, <code><a href="#topic+plot.plm">plot.plm</a></code>, <code><a href="#topic+plot.gplm0">plot.gplm0</a></code> and <code><a href="#topic+plot.gplm">plot.gplm</a></code> to help visualize all aspects of the fitted discharge rating curve. Additionally, <code><a href="#topic+spread_draws">spread_draws</a></code> and <code><a href="#topic+spread_draws">spread_draws</a></code> help working directly with the MCMC samples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
plm0.fit &lt;- plm0(formula=Q~W,data=krokfors,num_cores=2)
summary(plm0.fit)

</code></pre>

<hr>
<h2 id='summary.tournament'>Summary method for a discharge rating curve tournament</h2><span id='topic+summary.tournament'></span>

<h3>Description</h3>

<p>Print the summary of a tournament of model comparisons
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tournament'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.tournament_+3A_object">object</code></td>
<td>
<p>an object of class &quot;tournament&quot;</p>
</td></tr>
<tr><td><code id="summary.tournament_+3A_...">...</code></td>
<td>
<p>not used in this function</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+tournament">tournament</a></code> to run a discharge rating curve tournament and <code><a href="#topic+plot.tournament">plot.tournament</a></code> for visualizing the mode comparison
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
t_obj &lt;- tournament(Q~W,krokfors,num_cores=2)
summary(t_obj)

</code></pre>

<hr>
<h2 id='theme_bdrc'>Custom bdrc theme</h2><span id='topic+theme_bdrc'></span>

<h3>Description</h3>

<p>Custom bdrc theme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_bdrc(..., scaling = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theme_bdrc_+3A_...">...</code></td>
<td>
<p>not used in this function</p>
</td></tr>
<tr><td><code id="theme_bdrc_+3A_scaling">scaling</code></td>
<td>
<p>a numerical value which can be used to scale up or down the size of the text and titles of a plot that uses <code>theme_bdrc</code>. Defaults to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a theme object for the package
</p>

<hr>
<h2 id='tournament'>Tournament - Model comparison</h2><span id='topic+tournament'></span>

<h3>Description</h3>

<p>tournament compares four rating curve models of different complexities and determines the model that provides the best fit of the data at hand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tournament(
  formula = NULL,
  data = NULL,
  model_list = NULL,
  method = "WAIC",
  winning_criteria = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tournament_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;, with discharge column name as response and stage column name as a covariate.</p>
</td></tr>
<tr><td><code id="tournament_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables specified in formula.</p>
</td></tr>
<tr><td><code id="tournament_+3A_model_list">model_list</code></td>
<td>
<p>list of exactly four model objects of types &quot;plm0&quot;,&quot;plm&quot;,&quot;gplm0&quot; and &quot;gplm&quot; to be used in the tournament. Note that all of the model objects are required to be run with the same data and same c_param.</p>
</td></tr>
<tr><td><code id="tournament_+3A_method">method</code></td>
<td>
<p>a string specifying the method used to estimate the predictive performance of the models. The allowed methods are &quot;WAIC&quot;, &quot;DIC&quot; and &quot;Posterior_probability&quot;.</p>
</td></tr>
<tr><td><code id="tournament_+3A_winning_criteria">winning_criteria</code></td>
<td>
<p>a numerical value which sets a threshold the more complex model in each model comparison must exceed to be deemed the more appropriate model. See the Details section.</p>
</td></tr>
<tr><td><code id="tournament_+3A_...">...</code></td>
<td>
<p>optional arguments passed to the model functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tournament is a model comparison method that uses WAIC to estimate the predictive performance of the four models and select the most appropriate model given the data. The first round of model comparisons sets up two games between model types, &quot;gplm&quot; vs. &quot;gplm0&quot; and &quot;plm&quot; vs. &quot;plm0&quot;. The two comparisons are conducted such that if the WAIC of the more complex model (&quot;gplm&quot; and &quot;plm&quot;, respectively) is smaller than the WAIC of the simpler models (&quot;gplm0&quot; and &quot;plm0&quot;, respectively) by an input argument called the <code>winning_criteria</code> (default value = 2.2), then it is chosen as the more appropriate model. If not, the simpler model is chosen. The more appropriate models move on to the second round and are compared in the same way. The winner of the second round is chosen as the overall tournament winner and deemed the most appropriate model given the data.
</p>
<p>The default method &quot;WAIC&quot;, or the Widely Applicable Information Criterion (see Watanabe (2010)), is used to estimate the predictive performance of the models. This method is a fully Bayesian method that uses the full set of posterior draws to estimate of the expected log pointwise predictive density.
</p>
<p>Method &quot;DIC&quot;, or Deviance Information Criterion (see Spiegelhalter (2002)), is similar to the &quot;WAIC&quot; but instead of using the full set of posterior draws to compute the estimate of the expected log pointwise predictive density, it uses a point estimate of the posterior distribution.
</p>
<p>Method &quot;Posterior_probability&quot; uses the posterior probabilities of the models, calculated with Bayes factor (see Jeffreys (1961) and Kass and Raftery (1995)), to compare the models, where all the models are assumed a priori to be equally likely. This method is not chosen as the default method because the Bayes factor calculations can be quite unstable.
</p>
<p>When methods &quot;WAIC&quot; or &quot;DIC&quot; are used, the <code>winning_criteria</code> should be a real number. The winning criteria is a threshold value which the more complex model in each model comparison must exceed for it to be declared the more appropriate model. Setting the winning criteria slightly above 0 (default value = 2.2 for both &quot;WAIC&quot; and &quot;DIC&quot;) gives the less complex model in each comparison a slight advantage. When method &quot;Posterior_probability&quot; is used, the winning criteria should be a real value between 0 and 1 (default value = 0.75). This sets the threshold value for which the posterior probability of the more complex model, given the data, in each model comparison must exceed for it to be declared the more appropriate model. In all three cases, the default value is selected so as to give the less complex models a slight advantage, and should give more or less consistent results when applying the tournament to real world data.
</p>


<h3>Value</h3>

<p>An object of type &quot;tournament&quot; with the following elements
</p>

<dl>
<dt><code>contestants</code></dt><dd><p>model objects of types &quot;plm0&quot;,&quot;plm&quot;,&quot;gplm0&quot; and &quot;gplm&quot; being compared.</p>
</dd>
<dt><code>winner</code></dt><dd><p>model object of the tournament winner.</p>
</dd>
<dt><code>summary</code></dt><dd><p>a data frame with information on results of the different games in the tournament.</p>
</dd>
<dt><code>info</code></dt><dd><p>specifics about the tournament; the overall winner; the method used; and the winning criteria.</p>
</dd>
</dl>



<h3>References</h3>

<p>Hrafnkelsson, B., Sigurdarson, H., and Gardarsson, S. M. (2022). Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling, Environmetrics, 33(2):e2711.
</p>
<p>Jeffreys, H. (1961). Theory of Probability, Third Edition. Oxford University Press.
</p>
<p>Kass, R., and A. Raftery, A. (1995). Bayes Factors. Journal of the American Statistical Association, 90, 773-795.
</p>
<p>Spiegelhalter, D., Best, N., Carlin, B., Van Der Linde, A. (2002). Bayesian measures of model complexity and fit. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 64(4), 583–639.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory. J. Mach. Learn. Res. 11, 3571–3594.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plm0">plm0</a></code> <code><a href="#topic+plm">plm</a></code>, <code><a href="#topic+gplm0">gplm0</a></code>,<code><a href="#topic+gplm">gplm</a></code> <code><a href="#topic+summary.tournament">summary.tournament</a></code> and <code><a href="#topic+plot.tournament">plot.tournament</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(krokfors)
set.seed(1)
t_obj &lt;- tournament(formula=Q~W,data=krokfors,num_cores=2)
t_obj
summary(t_obj)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
