<!DOCTYPE html><html lang="en"><head><title>Help for package landpred</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {landpred}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#landpred-package'><p>Landmark Prediction of a Survival Outcome</p></a></li>
<li><a href='#AUC.landmark'>
<p>Estimates the area under the ROC curve (AUC).</p></a></li>
<li><a href='#BS.landmark'>
<p>Estimates the Brier score.</p></a></li>
<li><a href='#cumsum2'>
<p>Helper function</p></a></li>
<li><a href='#data_example_landpred'>
<p>Hypothetical data to be used in examples.</p></a></li>
<li><a href='#Ghat.FUN'>
<p>Calculates the Kaplan Meier survival probability for censoring</p></a></li>
<li><a href='#helper.si'>
<p>Helper function for AUC.landmark</p></a></li>
<li><a href='#Kern.FUN'>
<p>Calculates kernel matrix</p></a></li>
<li><a href='#mse.BW'>
<p>Helper function for optimize.mse.BW.</p></a></li>
<li><a href='#optimize.mse.BW'>
<p>Calculates initial optimal bandwidth.</p></a></li>
<li><a href='#Prob.Covariate'>
<p>Estimates P(TL &lt;t0+tau | TL &gt; t0, Z), i.e. given discrete covariate.</p></a></li>
<li><a href='#Prob.Covariate.ShortEvent'>
<p>Estimates P(TL &lt;t0+tau | TL &gt; t0, Z, min(TS, t0), I(TS&lt;=t0)), i.e. given discrete covariate and TS information.</p>
</p></a></li>
<li><a href='#Prob.Null'>
<p>Estimates P(TL &lt;t0+tau | TL &gt; t0).</p></a></li>
<li><a href='#Prob2'>
<p>Estimates P(TL &lt;t0+tau | TL &gt; t0, Z, TS&gt;t0).</p>
</p></a></li>
<li><a href='#Prob2.k.t'>
<p>Estimates P(TL &lt;t0+tau | TL &gt; t0, Z, TS==ts).</p></a></li>
<li><a href='#prob2.single'>
<p>Estimates P(TL &lt;t0+tau | TL &gt; t0, Z, TS==ts) for a single t.</p>
</p></a></li>
<li><a href='#VTM'>
<p>Helper function, repeats a row.</p></a></li>
<li><a href='#Wi.FUN'>
<p>Computes the inverse probability of censoring weights for a specific t0 and tau</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Landmark Prediction of a Survival Outcome</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Layla Parast</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Layla Parast &lt;parast@austin.utexas.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for landmark prediction of a survival outcome incorporating covariate and short-term event information. For more information about landmark prediction please see: Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307, &lt;<a href="https://doi.org/10.1002%2Fbimj.201000150">doi:10.1002/bimj.201000150</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-25 23:54:43 UTC; parastlm</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-26 14:10:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='landpred-package'>Landmark Prediction of a Survival Outcome
</h2><span id='topic+landpred-package'></span><span id='topic+landpred'></span>

<h3>Description</h3>

<p>This package includes functions for landmark prediction of a survival outcome incorporating covariate and short-term event information. For more information about landmark prediction please see: Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_landpred)
t0=2
tau = 8

####Landmark prediction with no covariate or short term information
Prob.Null(t0=t0,tau=tau,data=data_example_landpred)
out = Prob.Null(t0=t0,tau=tau,data=data_example_landpred)
out$Prob
out$data

newdata = matrix(c(1,1,3,0,4,1,10,1,11,0), ncol = 2, byrow=TRUE)
out = Prob.Null(t0=t0,tau=tau,data=data_example_landpred,newdata=newdata)
out$Prob
out$newdata

#Landmark prediction with covariate information only
Prob.Covariate(t0=t0,tau=tau,data=data_example_landpred)
out = Prob.Covariate(t0=t0,tau=tau,data=data_example_landpred)
out$Prob
out$data

newdata = matrix(c(1,1,1, 3,0,1, 4,1,1, 10,1,0, 11,0,1), ncol = 3, byrow=TRUE)
out = Prob.Covariate(t0=t0,tau=tau,data=data_example_landpred,newdata=newdata)
out$Prob
out$newdata

#Landmark prediction with covariate information and short term event information
#note: computationally intensive commands below
#Prob.Covariate.ShortEvent(t0=t0,tau=tau,data=data_example_landpred)
#out = Prob.Covariate.ShortEvent(t0=t0,tau=tau,data=data_example_landpred)
#out$data
#data.plot = out$data
#plot(data.plot$XS[data.plot$Z ==1], data.plot$Probability[data.plot$Z ==1], 
#pch = 20, xlim = c(0,t0))
#points(data.plot$XS[data.plot$Z ==0], data.plot$Probability[data.plot$Z ==0], 
#pch = 20, col = 2)

newdata = matrix(c(1,1,0.5,1,0,
3,0,1,1,1,
4,1,1.5,1,0,
10,1,5,1,0,
11,0,11,0,1), ncol = 5, byrow=TRUE)
#note: computationally intensive command below
#out=Prob.Covariate.ShortEvent(t0=t0,tau=tau,data=data_example_landpred,newdata=newdata)
#out$newdata

</code></pre>

<hr>
<h2 id='AUC.landmark'>
Estimates the area under the ROC curve (AUC).
</h2><span id='topic+AUC.landmark'></span>

<h3>Description</h3>

<p>This function calculates the AUC given the data (truth) and corresponding estimated probabilities; uses a continuity correction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUC.landmark(t0, tau, data, short = TRUE, weight=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AUC.landmark_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="AUC.landmark_+3A_tau">tau</code></td>
<td>

<p>the residual survival time of interest.</p>
</td></tr>
<tr><td><code id="AUC.landmark_+3A_data">data</code></td>
<td>

<p>n by k matrix, where k = 4 or 6. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), the second to last column is the covariate vector (can be NULL) and the last column is the estimated probability P(TL&lt;t0+tau | TL&gt;t0). </p>
</td></tr>
<tr><td><code id="AUC.landmark_+3A_short">short</code></td>
<td>

<p>logical value indicating whether data includes short term event information. Should be TRUE if short term XS and DS are includes as third and fourth columns of data matrix, FALSE if not. Default is TRUE. 
</p>
</td></tr>
<tr><td><code id="AUC.landmark_+3A_weight">weight</code></td>
<td>

<p>an optional weight to be incorporated in all estimation.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>AUC.est</code></td>
<td>
<p>Estimated AUC</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_landpred)
t0=2
tau = 8
Prob.Null(t0=t0,tau=tau,data=data_example_landpred)

out = Prob.Null(t0=t0,tau=tau,data=data_example_landpred)
out$Prob
out$data

AUC.landmark(t0=t0,tau=tau, data = out$data)

</code></pre>

<hr>
<h2 id='BS.landmark'>
Estimates the Brier score.
</h2><span id='topic+BS.landmark'></span>

<h3>Description</h3>

<p>This function calculates the Brier score given the data (truth) and corresponding estimated probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BS.landmark(t0, tau, data, short = TRUE, weight=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BS.landmark_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="BS.landmark_+3A_tau">tau</code></td>
<td>

<p>the residual survival time of interest.</p>
</td></tr>
<tr><td><code id="BS.landmark_+3A_data">data</code></td>
<td>

<p>n by k matrix, where k = 4 or 6. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), the second to last column is the covariate vector (can be NULL) and the last column is the estimated probability P(TL&lt;t0+tau | TL&gt;t0). </p>
</td></tr>
<tr><td><code id="BS.landmark_+3A_short">short</code></td>
<td>

<p>logical value indicating whether data includes short term event information. Should be TRUE if short term XS and DS are includes as third and fourth columns of data matrix, FALSE if not. Default is TRUE. 
</p>
</td></tr>
<tr><td><code id="BS.landmark_+3A_weight">weight</code></td>
<td>

<p>an optional weight to be incorporated in all estimation.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Brier.score</code></td>
<td>
<p>Estimated Brier score</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_landpred)
t0=2
tau = 8
Prob.Null(t0=t0,tau=tau,data=data_example_landpred)

out = Prob.Null(t0=t0,tau=tau,data=data_example_landpred)
out$Prob
out$data

BS.landmark(t0=t0,tau=tau, data = out$data)

</code></pre>

<hr>
<h2 id='cumsum2'>
Helper function
</h2><span id='topic+cumsum2'></span>

<h3>Description</h3>

<p>Helper function; should not be called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumsum2(mydat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cumsum2_+3A_mydat">mydat</code></td>
<td>

<p>mydat</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>out</code></td>
<td>
<p>matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='data_example_landpred'>
Hypothetical data to be used in examples.
</h2><span id='topic+data_example_landpred'></span>

<h3>Description</h3>

<p>Hypothetical data to be used in examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_example_landpred)</code></pre>


<h3>Format</h3>

<p>A data frame with 4868 observations on the following 5 variables.
</p>

<dl>
<dt><code>XL</code></dt><dd><p>a numeric vector. XL = min(TL, C) where TL is the time of the long term event, C is the censoring time. </p>
</dd>
<dt><code>DL</code></dt><dd><p>a 0/1 vector. DL =1*(TL&lt;C) where TL is the time of the long term event, C is the censoring time.</p>
</dd>
<dt><code>XS</code></dt><dd><p>a numeric vector. XS = min(TS, C) where TS is the time of the long term event, C is the censoring time. </p>
</dd>
<dt><code>DS</code></dt><dd><p>a 0/1 vector. DS =1*(TS&lt;C) where TS is the time of the long term event, C is the censoring time.</p>
</dd>
<dt><code>Z</code></dt><dd><p>a 0/1 vector of discrete covariate values. </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_landpred)
</code></pre>

<hr>
<h2 id='Ghat.FUN'>
Calculates the Kaplan Meier survival probability for censoring
</h2><span id='topic+Ghat.FUN'></span>

<h3>Description</h3>

<p>Calculates the survival probability for censoring i.e. P(C &gt; tt) where C is censoring; used in inverse probability of censoring weights (IPCW). This function is called by Wi.FUN;  this function should not be called on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ghat.FUN(tt, data, type = "fl", weight.given)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Ghat.FUN_+3A_tt">tt</code></td>
<td>

<p>the time (or vector of times) at which the survival probability should be estimated.
</p>
</td></tr>
<tr><td><code id="Ghat.FUN_+3A_data">data</code></td>
<td>

<p>n by k matrix, where k&gt;=2. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C)</p>
</td></tr>
<tr><td><code id="Ghat.FUN_+3A_type">type</code></td>
<td>

<p>type sent to survfit function, default is &quot;fl&quot;.
</p>
</td></tr>
<tr><td><code id="Ghat.FUN_+3A_weight.given">weight.given</code></td>
<td>

<p>a weight to be used in estimation.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>survival probability for censoring at time tt
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='helper.si'>
Helper function for AUC.landmark
</h2><span id='topic+helper.si'></span>

<h3>Description</h3>

<p>Helper function for AUC.landmark; should not be called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>helper.si(yy,FUN,Yi,Vi=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="helper.si_+3A_yy">yy</code></td>
<td>

<p>yy
</p>
</td></tr>
<tr><td><code id="helper.si_+3A_fun">FUN</code></td>
<td>

<p>FUN</p>
</td></tr>
<tr><td><code id="helper.si_+3A_yi">Yi</code></td>
<td>

<p>Yi</p>
</td></tr>
<tr><td><code id="helper.si_+3A_vi">Vi</code></td>
<td>

<p>Vi</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>out</code></td>
<td>
<p>matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='Kern.FUN'>
Calculates kernel matrix
</h2><span id='topic+Kern.FUN'></span>

<h3>Description</h3>

<p>This calculates the kernel matrix needed for estimating the probability incorporating short term event information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kern.FUN(zz, zi, bw)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Kern.FUN_+3A_zz">zz</code></td>
<td>

<p>zz
</p>
</td></tr>
<tr><td><code id="Kern.FUN_+3A_zi">zi</code></td>
<td>

<p>zi
</p>
</td></tr>
<tr><td><code id="Kern.FUN_+3A_bw">bw</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the kernel matrix
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='mse.BW'>
Helper function for optimize.mse.BW.
</h2><span id='topic+mse.BW'></span>

<h3>Description</h3>

<p>Helper function for optimize.mse.BW.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mse.BW(data, t0,tau,h, folds = 3,reps=2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mse.BW_+3A_data">data</code></td>
<td>

<p>n by 5 matrix. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), the third column is XS = min(TS, C) where TS is the time of the short term event, C is the censoring time, the fourth column is DS =1*(TS&lt;C), and the fifth column is the covariate. These are the data used to calculate the estimated probability.</p>
</td></tr>
<tr><td><code id="mse.BW_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="mse.BW_+3A_tau">tau</code></td>
<td>

<p>the residual survival time of interest.</p>
</td></tr>
<tr><td><code id="mse.BW_+3A_h">h</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
<tr><td><code id="mse.BW_+3A_folds">folds</code></td>
<td>

<p>Number of folds wanted for K-fold cross-validation. Default is 3.</p>
</td></tr>
<tr><td><code id="mse.BW_+3A_reps">reps</code></td>
<td>

<p>Number of repitions wanted of K-fold cross-validation. Default is 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean of MSE
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>

<hr>
<h2 id='optimize.mse.BW'>
Calculates initial optimal bandwidth.
</h2><span id='topic+optimize.mse.BW'></span>

<h3>Description</h3>

<p>Calculates initial optimal bandwidth with respect to mean squared error using K-fold cross-validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimize.mse.BW(data, t0,tau,h.grid=seq(.01,2,length=50), folds=3, reps=2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optimize.mse.BW_+3A_data">data</code></td>
<td>

<p>n by 5 matrix. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), the third column is XS = min(TS, C) where TS is the time of the short term event, C is the censoring time, the fourth column is DS =1*(TS&lt;C), and the fifth column is the covariate. These are the data used to calculate the estimated probability.
</p>
</td></tr>
<tr><td><code id="optimize.mse.BW_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="optimize.mse.BW_+3A_tau">tau</code></td>
<td>

<p>the residual survival time of interest.</p>
</td></tr>
<tr><td><code id="optimize.mse.BW_+3A_h.grid">h.grid</code></td>
<td>

<p>The grid of possible bandwidths that the user would like the function to search through. Default is h.grid = seq(.01,2,length=50).</p>
</td></tr>
<tr><td><code id="optimize.mse.BW_+3A_folds">folds</code></td>
<td>

<p>Number of folds wanted for K-fold cross-validation. Default is 3.</p>
</td></tr>
<tr><td><code id="optimize.mse.BW_+3A_reps">reps</code></td>
<td>

<p>Number of repitions wanted of K-fold cross-validation. Default is 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>h</code></td>
<td>
<p>Selected bandwidth.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>

<hr>
<h2 id='Prob.Covariate'>
Estimates P(TL &lt;t0+tau | TL &gt; t0, Z), i.e. given discrete covariate.
</h2><span id='topic+Prob.Covariate'></span>

<h3>Description</h3>

<p>This function calculates the probability that the an individual has the event of interest before t0 + tau given the discrete covariate and given the event has not yet occurred and the individual is still at risk at time t0; this estimated probability does not incorporate any information about the short term event information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prob.Covariate(t0, tau, data, weight = NULL, short  = TRUE, newdata = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prob.Covariate_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="Prob.Covariate_+3A_tau">tau</code></td>
<td>

<p>the residual survival time for which probabilities are calculated. Specifically, this function estimates the probability that the an individual has the event of interest before t0 + tau given the event has not yet occurred and the individual is still at risk at time t0.
</p>
</td></tr>
<tr><td><code id="Prob.Covariate_+3A_data">data</code></td>
<td>

<p>n by k matrix, where k =3 or k=5. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C). If short term event information is included in this dataset then the third column is XS = min(TS, C) where TS is the time of the short term event, C is the censoring time, and the fourth column is DS =1*(TS&lt;C), and the fifth column is the covariate. If short term event information is not included then the third column is the covariates (see &quot;short&quot; parameter). These are the data used to calculate the estimated probabilities.
</p>
</td></tr>
<tr><td><code id="Prob.Covariate_+3A_weight">weight</code></td>
<td>

<p>an optional weight to be incorporated in all estimation.
</p>
</td></tr>
<tr><td><code id="Prob.Covariate_+3A_short">short</code></td>
<td>

<p>logical value indicating whether data includes short term event information. Should be TRUE if short term XS and DS are includes as third and fourth columns of data matrix meaning that the covariates is in the fifth column, FALSE if not meaning that the covariate is in the third column. Default is TRUE. 
</p>
</td></tr>
<tr><td><code id="Prob.Covariate_+3A_newdata">newdata</code></td>
<td>

<p>n by k matrix, where k =3 or k=5. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), and the last column (either 3rd or 5th)  contains covariate values. Predicted probabilities are estimated for these data.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Prob</code></td>
<td>
<p>matrix of estimated probability for each value of the covariate; first column shows all covariate values and second column contains predicted probability at that covariate value</p>
</td></tr> 
<tr><td><code>data</code></td>
<td>
<p>the data matrix with an additional column with the estimated individual probabilities; note that the predicted probability is NA if TL &lt;t0 since it is only defined for individuals with TL&gt; t0</p>
</td></tr>
<tr><td><code>newdata</code></td>
<td>
<p>the newdata matrix with an additional column with the estimated individual probabilities; note that the predicted probability is NA if TL &lt;t0 since it is only defined for individuals with TL&gt; t0; if newdata is not supplied then this returns NULL</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_landpred)
t0=2
tau = 8
Prob.Covariate(t0=t0,tau=tau,data=data_example_landpred)

out = Prob.Covariate(t0=t0,tau=tau,data=data_example_landpred)
out$Prob
out$data

newdata = matrix(c(1,1,1, 3,0,1, 4,1,1, 10,1,0, 11,0,1), ncol = 3, byrow=TRUE)
out = Prob.Covariate(t0=t0,tau=tau,data=data_example_landpred,newdata=newdata)
out$Prob
out$newdata

</code></pre>

<hr>
<h2 id='Prob.Covariate.ShortEvent'>
Estimates P(TL &lt;t0+tau | TL &gt; t0, Z, min(TS, t0), I(TS&lt;=t0)), i.e. given discrete covariate and TS information.
</h2><span id='topic+Prob.Covariate.ShortEvent'></span>

<h3>Description</h3>

<p>This function calculates the probability that the an individual has the event of interest before t0 + tau given the discrete covariate, given short term event information, and given the event has not yet occurred and the individual is still at risk at time t0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prob.Covariate.ShortEvent(t0, tau, data, weight = NULL, bandwidth = NULL, newdata=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prob.Covariate.ShortEvent_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="Prob.Covariate.ShortEvent_+3A_tau">tau</code></td>
<td>

<p>the residual survival time for which probabilities are calculated. Specifically, this function estimates the probability that the an individual has the event of interest before t0 + tau given the event has not yet occurred and the individual is still at risk at time t0.
</p>
</td></tr>
<tr><td><code id="Prob.Covariate.ShortEvent_+3A_data">data</code></td>
<td>

<p>n by 5 matrix. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), the third column is XS = min(TS, C) where TS is the time of the short term event, C is the censoring time, the fourth column is DS =1*(TS&lt;C), and the fifth column is the covariate. These are the data used to calculate the estimated probability.
</p>
</td></tr>
<tr><td><code id="Prob.Covariate.ShortEvent_+3A_weight">weight</code></td>
<td>

<p>a weight to be incorporated in all estimation.
</p>
</td></tr>
<tr><td><code id="Prob.Covariate.ShortEvent_+3A_bandwidth">bandwidth</code></td>
<td>

<p>an optional bandwidth to be used in kernel smoothing; is not provided then function calculates an appropriate bandwidth using bw.nrd and then undersmoothing with c = .10 (See reference)
</p>
</td></tr>
<tr><td><code id="Prob.Covariate.ShortEvent_+3A_newdata">newdata</code></td>
<td>

<p>an optional n by 5 matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), the third column is XS = min(TS, C) where TS is the time of the short term event, C is the censoring time, the fourth column is DS =1*(TS&lt;C), and the fifth column is the covariate. Predicted probabilities are estimated for these data.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>the data matrix with an additional column with the estimated individual probabilities; note that the predicted probability is NA if TL &lt;t0 since it is only defined for individuals with TL&gt; t0</p>
</td></tr>
<tr><td><code>newdata</code></td>
<td>
<p>the newdata matrix with an additional column with the estimated individual probabilities; note that the predicted probability is NA if TL &lt;t0 since it is only defined for individuals with TL&gt; t0; if newdata is not supplied then this returns NULL</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_landpred)
t0=2
tau = 8
#note: computationally intensive command below
#Prob.Covariate.ShortEvent(t0=t0,tau=tau,data=data_example_landpred)

#out = Prob.Covariate.ShortEvent(t0=t0,tau=tau,data=data_example_landpred)
#out$data
#data.plot = out$data
#plot(data.plot$XS[data.plot$Z ==1], data.plot$Probability[data.plot$Z ==1], 
#pch = 20, xlim = c(0,t0))
#points(data.plot$XS[data.plot$Z ==0], data.plot$Probability[data.plot$Z ==0], 
#pch = 20, col = 2)

newdata = matrix(c(1,1,0.5,1,0,
3,0,1,1,1,
4,1,1.5,1,0,
10,1,5,1,0,
11,0,11,0,1), ncol = 5, byrow=TRUE)
#note: computationally intensive command below
#out = Prob.Covariate.ShortEvent(t0=t0,tau=tau,data=data_example_landpred,newdata=newdata)
#out$newdata

</code></pre>

<hr>
<h2 id='Prob.Null'>
Estimates P(TL &lt;t0+tau | TL &gt; t0).
</h2><span id='topic+Prob.Null'></span>

<h3>Description</h3>

<p>This function calculates the probability that an individual has the event of interest before t0 + tau given the event has not yet occurred and the individual is still at risk at time t0; this estimated probability does not incorporate any information about the covariate or short term event information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prob.Null(t0, tau, data, weight = NULL, newdata=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prob.Null_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="Prob.Null_+3A_tau">tau</code></td>
<td>

<p>the residual survival time for which probabilities are calculated. Specifically, this function estimates the probability that the an individual has the event of interest before t0 + tau given the event has not yet occurred and the individual is still at risk at time t0.
</p>
</td></tr>
<tr><td><code id="Prob.Null_+3A_data">data</code></td>
<td>

<p>n by k matrix, where k &gt;=2. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C). These are the data used to calculate the estimated probability.
</p>
</td></tr>
<tr><td><code id="Prob.Null_+3A_weight">weight</code></td>
<td>

<p>an optional weight to be incorporated in all estimation.
</p>
</td></tr>
<tr><td><code id="Prob.Null_+3A_newdata">newdata</code></td>
<td>

<p>an optional n by k matrix, where k &gt;=2. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C). Predicted probabilities are estimated for these data.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Prob</code></td>
<td>
<p>Estimated probability that the an individual has the event of interest before t0 + tau given the event has not yet occurred and the individual is still at risk at time t0; this estimated probability does not incorporate any information about the covariate or short term event information.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data matrix with an additional column with the estimated individual probabilities; note that the predicted probability is NA if TL &lt;t0 since it is only defined for individuals with TL&gt; t0</p>
</td></tr>
<tr><td><code>newdata</code></td>
<td>
<p>the newdata matrix with an additional column with the estimated individual probabilities; note that the predicted probability is NA if TL &lt;t0 since it is only defined for individuals with TL&gt; t0; if newdata is not supplied then this returns NULL</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_landpred)
t0=2
tau = 8
Prob.Null(t0=t0,tau=tau,data=data_example_landpred)

out = Prob.Null(t0=t0,tau=tau,data=data_example_landpred)
out$Prob
out$data

newdata = matrix(c(1,1,3,0,4,1,10,1,11,0), ncol = 2, byrow=TRUE)
out = Prob.Null(t0=t0,tau=tau,data=data_example_landpred,newdata=newdata)
out$Prob
out$newdata

</code></pre>

<hr>
<h2 id='Prob2'>
Estimates P(TL &lt;t0+tau | TL &gt; t0, Z, TS&gt;t0).
</h2><span id='topic+Prob2'></span>

<h3>Description</h3>

<p>This function calculates the probability that the an individual has the event of interest before t0 + tau given the discrete covariate, given the short term event has not yet occurred by t0, and given the long term event has not yet occurred and the individual is still at risk at time t0. This function is called by Prob.Covariate.ShortEvent; this function should not be called on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prob2(t0, tau, data, covariate.value, weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prob2_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="Prob2_+3A_tau">tau</code></td>
<td>

<p>the residual survival time for which probabilities are calculated. Specifically, this function estimates the probability that the an individual has the event of interest before t0 + tau given the event has not yet occurred and the individual is still at risk at time t0.
</p>
</td></tr>
<tr><td><code id="Prob2_+3A_data">data</code></td>
<td>

<p>n by 5 matrix. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), the third column is log(XS) = log(min(TS, C)) where TS is the time of the short term event, C is the censoring time, the fourth column is DS =1*(TS&lt;C), and the fifth column is the covariate. These are the data used to calculate the estimated probability.
</p>
</td></tr>
<tr><td><code id="Prob2_+3A_covariate.value">covariate.value</code></td>
<td>

<p>the discrete covariate value at which to calculate the estimated probability.
</p>
</td></tr>
<tr><td><code id="Prob2_+3A_weight">weight</code></td>
<td>

<p>an optional weight to be incorporated in all estimation.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated probability =  P(TL &lt;t0+tau | TL &gt; t0, Z, TS&gt;t0).
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>

<hr>
<h2 id='Prob2.k.t'>
Estimates P(TL &lt;t0+tau | TL &gt; t0, Z, TS==ts).
</h2><span id='topic+Prob2.k.t'></span>

<h3>Description</h3>

<p>This function calculates the probability that the an individual has the event of interest before t0 + tau given the discrete covariate, given the short term event occurred before t0 and occurred at time ts, and given the long term event has not yet occurred and the individual is still at risk at time t0.This function is called by Prob.Covariate.ShortEvent;  this function should not be called on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prob2.k.t(t, t0, tau, data.use, bandwidth, covariate.value, weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prob2.k.t_+3A_t">t</code></td>
<td>

<p>time of the short term event, ts, on the log scale.
</p>
</td></tr>
<tr><td><code id="Prob2.k.t_+3A_t0">t0</code></td>
<td>

<p>the landmark time.
</p>
</td></tr>
<tr><td><code id="Prob2.k.t_+3A_tau">tau</code></td>
<td>

<p>the residual survival time for which probabilities are calculated. Specifically, this function estimates the probability that the an individual has the event of interest before t0 + tau given the event has not yet occurred and the individual is still at risk at time t0.
</p>
</td></tr>
<tr><td><code id="Prob2.k.t_+3A_data.use">data.use</code></td>
<td>

<p>n by 5 matrix. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C), the third column is log(XS) = log(min(TS, C)) where TS is the time of the short term event, C is the censoring time, the fourth column is DS =1*(TS&lt;C), and the fifth column is the covariate. 
</p>
</td></tr>
<tr><td><code id="Prob2.k.t_+3A_bandwidth">bandwidth</code></td>
<td>

<p>bandwidth to be used.
</p>
</td></tr>
<tr><td><code id="Prob2.k.t_+3A_covariate.value">covariate.value</code></td>
<td>

<p>covariate value at which to calculate probability.
</p>
</td></tr>
<tr><td><code id="Prob2.k.t_+3A_weight">weight</code></td>
<td>

<p>an optional weight to be incorporated in all estimation.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns estimated probabilities for each ts value (parameter t) at the specified covariate value; returns NA if ts&gt;t0.
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307.
</p>

<hr>
<h2 id='prob2.single'>
Estimates P(TL &lt;t0+tau | TL &gt; t0, Z, TS==ts) for a single t.
</h2><span id='topic+prob2.single'></span>

<h3>Description</h3>

<p>Helper function for Prob2.k.t; should not be called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob2.single(K, W2i, Xi.long, tau, Di.short, Xi.short, Zi, t0, covariate.value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob2.single_+3A_k">K</code></td>
<td>

<p>Kernel matrix.
</p>
</td></tr>
<tr><td><code id="prob2.single_+3A_w2i">W2i</code></td>
<td>

<p>inverse probability of censoring weights.
</p>
</td></tr>
<tr><td><code id="prob2.single_+3A_xi.long">Xi.long</code></td>
<td>

<p>XL = min(TL, C) where TL is the time of the long term event, C is the censoring time.
</p>
</td></tr>
<tr><td><code id="prob2.single_+3A_tau">tau</code></td>
<td>

<p>the residual survival time for which probabilities are calculated. Specifically, this function estimates the probability that the an individual has the event of interest before t0 + tau given the event has not yet occurred and the individual is still at risk at time t0.
</p>
</td></tr>
<tr><td><code id="prob2.single_+3A_di.short">Di.short</code></td>
<td>

<p>DS =1*(TS&lt;C), where TS is the time of the short term event, C is the censoring time.
</p>
</td></tr>
<tr><td><code id="prob2.single_+3A_xi.short">Xi.short</code></td>
<td>

<p>log(XS) = log(min(TS, C)) where TS is the time of the short term event, C is the censoring time.
</p>
</td></tr>
<tr><td><code id="prob2.single_+3A_zi">Zi</code></td>
<td>

<p>covariate vector.
</p>
</td></tr>
<tr><td><code id="prob2.single_+3A_t0">t0</code></td>
<td>

<p>landmark time.
</p>
</td></tr>
<tr><td><code id="prob2.single_+3A_covariate.value">covariate.value</code></td>
<td>

<p>specific covariate at which to estimate the conditional probability.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns estimated probability for values corresponding to the kernel matrix at the specified covariate value;
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='VTM'>
Helper function, repeats a row.
</h2><span id='topic+VTM'></span>

<h3>Description</h3>

<p>This function creates a matrix that repeats vc, dm times where each row is equal to the vc vector. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VTM(vc, dm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VTM_+3A_vc">vc</code></td>
<td>

<p>the vector to repeat.
</p>
</td></tr>
<tr><td><code id="VTM_+3A_dm">dm</code></td>
<td>

<p>number of rows.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix that repeats vc, dm times where each row is equal to the vc vector
</p>

<hr>
<h2 id='Wi.FUN'>
Computes the inverse probability of censoring weights for a specific t0 and tau
</h2><span id='topic+Wi.FUN'></span>

<h3>Description</h3>

<p>Computes the inverse probability of censoring weights for a specific t0 and tau i.e. this computes I(t0 &lt; XL &lt; t0+tau)*DL/G(XL) + I(XL&gt;t0+tau)/G(t0+tau) where XL = min(TL, C), TL is the time of the long term event, C is the censoring time, DL =1*(TL&lt;C) and G() is the estimate survival probability for censoring estimated using the Kaplan Meier estimator (see Ghat.FUN)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wi.FUN(data, t0, tau, weight.given = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Wi.FUN_+3A_data">data</code></td>
<td>

<p>n by k matrix, where k&gt;= 2. A data matrix where the first column is XL = min(TL, C) where TL is the time of the long term event, C is the censoring time, and the second column is DL =1*(TL&lt;C)
</p>
</td></tr>
<tr><td><code id="Wi.FUN_+3A_t0">t0</code></td>
<td>

<p>the landmark time..
</p>
</td></tr>
<tr><td><code id="Wi.FUN_+3A_tau">tau</code></td>
<td>

<p>the residual survival time for which probabilities are calculated. 
</p>
</td></tr>
<tr><td><code id="Wi.FUN_+3A_weight.given">weight.given</code></td>
<td>

<p>an optional weight to be incorporated in estimation of this weight
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Inverse probability of censoring weight.
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_landpred)
t0=2
tau = 8

W2i &lt;- Wi.FUN(data_example_landpred[,1],data = data_example_landpred[,c(1:2)],t0=t0,tau=tau)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
