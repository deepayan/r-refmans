<!DOCTYPE html><html lang="en"><head><title>Help for package GPvam</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GPvam}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GPvam-package'>
<p>Maximum Likelihood Estimation of Multiple Membership Mixed Models Used in Value-Added Modeling</p></a></li>
<li><a href='#bias.test.custom'>
<p>Permutation Tests for Fixed Effects Bias Assessment</p></a></li>
<li><a href='#GP.csh'>
<p>Internal G-side effects function</p></a></li>
<li><a href='#GP.un'>
<p>Internal R-side effects function</p></a></li>
<li><a href='#GPvam'>
<p>Fitting the Generalized and Variable Persistence Models</p></a></li>
<li><a href='#GPvam.benchmark'>
<p>Benchmarks of the program using simulated data.</p></a></li>
<li><a href='#plot'>
<p>Plot method for GPvam</p></a></li>
<li><a href='#print'>
<p>Print</p></a></li>
<li><a href='#rGP.un'>
<p>Internal R-side effects function for reduced GP model</p></a></li>
<li><a href='#summary'>
<p>Summary</p></a></li>
<li><a href='#vam_data'>
<p>Simulated Data</p></a></li>
<li><a href='#VP.CP.ZP.un'>
<p>Internal R-side effects function for the variable persistence model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Maximum Likelihood Estimation of Multiple Membership Mixed
Models Used in Value-Added Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-05</td>
</tr>
<tr>
<td>Description:</td>
<td>An EM algorithm, Karl et al. (2013) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2012.10.004">doi:10.1016/j.csda.2012.10.004</a>&gt;, is used to estimate the generalized, variable, and complete persistence models, Mariano et al. (2010) &lt;<a href="https://doi.org/10.3102%2F1076998609346967">doi:10.3102/1076998609346967</a>&gt;. These are multiple-membership linear mixed models with teachers modeled as "G-side" effects and students modeled with either "G-side" or "R-side" effects.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), Matrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv, rlang, Rcpp (&ge; 0.11.2), graphics, grDevices,
methods, stats, utils, ggplot2, patchwork, MASS</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-12 09:54:48 UTC; andre</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Karl <a href="https://orcid.org/0000-0002-5933-8706"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut],
  Yan Yang [aut],
  Sharon Lohr [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Karl &lt;akarl@asu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-12 10:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='GPvam-package'>
Maximum Likelihood Estimation of Multiple Membership Mixed Models Used in Value-Added Modeling
</h2><span id='topic+GPvam-package'></span>

<h3>Description</h3>

<p>An EM algorithm, Karl et al. (2013) &lt;doi:10.1016/j.csda.2012.10.004&gt;, is used to estimate the generalized, variable, and complete persistence models, Mariano et al. (2010) &lt;doi:10.3102/1076998609346967&gt;. These are multiple-membership linear mixed models with teachers modeled as &quot;G-side&quot; effects and students modeled with either &quot;G-side&quot; or &quot;R-side&quot; effects.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> GPvam</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.1-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-10-14</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andrew Karl, Yan Yang, and Sharon Lohr
</p>
<p>Maintainer: Andrew Karl &lt;akarl@asu.edu&gt;
</p>


<h3>References</h3>

<p>Karl, A., Yang, Y. and Lohr, S. (2013) Efficient Maximum Likelihood Estimation of Multiple Membership Linear Mixed Models, with an Application to Educational Value-Added Assessments <em>Computational Statistics &amp; Data Analysis</em> <b>59</b>, 13&ndash;27.  
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) Computation of Maximum Likelihood Estimates for Multiresponse Generalized Linear Mixed Models with Non-nested, Correlated Random Effects <em>Computational Statistics &amp; Data Analysis</em> <b>73</b>, 146&ndash;162.
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) A Correlated Random Effects Model for Nonignorable Missing Data in Value-Added Assessment of Teacher Effects <em>Journal of Educational and Behavioral Statistics</em> <b>38</b>, 577&ndash;603.
</p>
<p>Karl, A., Zimmerman, D. (2021) A diagnostic for bias in linear mixed model estimators induced by dependence between the random effects and the corresponding model matrix <em>Journal of Statistical Planning and Inference</em> <b>211</b>, 107&ndash;118.
</p>
<p>Lockwood, J., McCaffrey, D., Mariano, L., Setodji, C. (2007) Bayesian Methods for Scalable Multivariate Value-Added Assesment. <em>Journal of Educational and Behavioral Statistics</em> <b>32</b>, 125&ndash;150. 
</p>
<p>Mariano, L., McCaffrey, D. and Lockwood, J. (2010) A Model for Teacher Effects From Longitudinal Data Without Assuming Vertical Scaling. <em>Journal of Educational and Behavioral Statistics</em> <b>35</b>, 
253&ndash;279.
</p>
<p>McCaffrey, D. and Lockwood, J. (2011) Missing Data in Value-Added Modeling of Teavher Effects, <em>Annals of Applied Statistics</em> <b>5</b>, 773&ndash;797
</p>

<hr>
<h2 id='bias.test.custom'>
Permutation Tests for Fixed Effects Bias Assessment
</h2><span id='topic+bias.test.custom'></span>

<h3>Description</h3>

<p>Performs permutation tests on fixed effects within a linear mixed model to assess the bias of fixed effect parameters or contrasts. The function allows for both standard basis vectors and custom vectors to define the effects being tested. See Karl and Zimmerman (2021) &lt;doi:10.1016/j.jspi.2020.06.004&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bias.test.custom(result, 
                 k_vectors = NULL, 
                 n_perms = 1e5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bias.test.custom_+3A_result">result</code></td>
<td>

<p>An object containing GPvam results, including the fixed effects matrix (<code>X</code>), random effects design matrix (<code>Z</code>), inverse variance matrix (<code>vinv</code>), estimated random effects (<code>eta.hat</code>), variance components matrix (<code>G</code>), number of teachers per group (<code>num.teach</code>), and persistence type (<code>persistence</code>). The object must contain the following components:
</p>

<dl>
<dt><code>X</code></dt><dd><p>Fixed effects matrix.</p>
</dd>
<dt><code>Z</code></dt><dd><p>Random effects design matrix.</p>
</dd>
<dt><code>vinv</code></dt><dd><p>Inverse variance matrix.</p>
</dd>
<dt><code>eta.hat</code></dt><dd><p>Estimated random effects.</p>
</dd>
<dt><code>G</code></dt><dd><p>Variance components matrix for random effects.</p>
</dd>
<dt><code>num.teach</code></dt><dd><p>Vector indicating the number of teachers (random effects) per group.</p>
</dd>
<dt><code>persistence</code></dt><dd><p>Persistence type, must be either <code>"CP"</code> or <code>"VP"</code> or <code>"ZP"</code>.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="bias.test.custom_+3A_k_vectors">k_vectors</code></td>
<td>

<p>(Optional) A list of numeric vectors specifying custom <code class="reqn">k</code> vectors for combined fixed effects. Each vector should be the same length as the number of fixed effects in the model. If <code>NULL</code>, the function generates standard basis vectors (one-hot vectors) to perform permutation tests for each fixed effect individually.
</p>
</td></tr>
<tr><td><code id="bias.test.custom_+3A_n_perms">n_perms</code></td>
<td>

<p>(Optional) The number of permutations to perform for each <code class="reqn">k</code> vector. A higher number of permutations increases the accuracy of the p-value estimates but also increases computation time. Default is <code>1e5</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>permutation_results</code></td>
<td>
<p>A data frame with the following columns:
</p>

<dl>
<dt><code>Fixed_Effect</code></dt><dd><p>Name of the fixed effect or custom contrast tested.</p>
</dd>
<dt><code>Nu_Prime_Eta</code></dt><dd><p>The observed value of <code class="reqn">\nu' \hat{\eta}</code>.</p>
</dd>
<dt><code>Permutation_P_Value</code></dt><dd><p>Permutation p-value for the test of the fixed effect bias.</p>
</dd>
</dl>

</td></tr>
<tr><td><code>plot_list</code></td>
<td>
<p>A list of ggplot2 objects for the permutation histograms.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assuming 'result' is your GPvam object

# Perform bias test for all fixed effects
test_results &lt;- bias.test.custom(result)

# Perform bias test including a custom contrast
k_custom &lt;- c(1, -1, 0, 0)  # Contrast between first and second fixed effects
test_results &lt;- bias.test.custom(result, k_vectors = list(k_custom))

## End(Not run)
</code></pre>

<hr>
<h2 id='GP.csh'>
Internal G-side effects function
</h2><span id='topic+GP.csh'></span>

<h3>Description</h3>

<p>An internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GP.csh(Z_mat, fixed_effects, control)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GP.csh_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="GP.csh_+3A_fixed_effects">fixed_effects</code></td>
<td>

<p>formula specifying fixed effects to be included in model
</p>
</td></tr>
<tr><td><code id="GP.csh_+3A_control">control</code></td>
<td>

<p>a list
</p>
</td></tr>
</table>

<hr>
<h2 id='GP.un'>
Internal R-side effects function
</h2><span id='topic+GP.un'></span>

<h3>Description</h3>

<p>An internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GP.un(Z_mat, fixed_effects, control)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GP.un_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="GP.un_+3A_fixed_effects">fixed_effects</code></td>
<td>

<p>formula specifying fixed effects to be included in model
</p>
</td></tr>
<tr><td><code id="GP.un_+3A_control">control</code></td>
<td>

<p>a list
</p>
</td></tr>
</table>

<hr>
<h2 id='GPvam'>
Fitting the Generalized and Variable Persistence Models
</h2><span id='topic+GPvam'></span>

<h3>Description</h3>

<p>An EM algorithm, Karl et al. (2013) &lt;doi:10.1016/j.csda.2012.10.004&gt;, is used to estimate the generalized, variable, and complete persistence models, Mariano et al. (2010) &lt;doi:10.3102/1076998609346967&gt;. These are multiple-membership linear mixed models with teachers modeled as &quot;G-side&quot; effects and students modeled with either &quot;G-side&quot; or &quot;R-side&quot; effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GPvam(vam_data, fixed_effects = formula(~as.factor(year) + 0), 
   student.side = "R", persistence="GP", max.iter.EM = 1000, tol1 = 1e-07, 
   hessian = FALSE, hes.method = "simple", REML = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GPvam_+3A_vam_data">vam_data</code></td>
<td>

<p>a data frame that contains at least a column &quot;y&quot; containing the student scores, a 
column &quot;student&quot; containing unique student ID's, a column &quot;teacher&quot; containing the 
teacher ID's, and a column &quot;year&quot; which contains the year (or semester, etc.) of the time period. The &quot;y&quot; and &quot;year&quot; variables needs to be numeric. If other variables are to be included 
as fixed effects, they should also be included in vam_data. See 'Note' for further discussion.
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_fixed_effects">fixed_effects</code></td>
<td>

<p>an object of class <code>formula</code> describing the structure of the fixed effects. Categorical variables
should be wrapped in an <code>as.factor</code> statement.
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_student.side">student.side</code></td>
<td>

<p>a character. Choices are &quot;G&quot; or &quot;R&quot;. See section 'Details'.
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_persistence">persistence</code></td>
<td>

<p>a character. Choices are &quot;GP&quot;, &quot;rGP&quot;, &quot;VP&quot;, &quot;CP&quot;, or &quot;ZP&quot;. Only &quot;GP&quot; is currently 
compatible with student.side=&quot;G&quot;. See section 'Details'.
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_max.iter.em">max.iter.EM</code></td>
<td>

<p>the maximum number of EM iterations
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_tol1">tol1</code></td>
<td>

<p>convergence tolerance for EM algorithm. The convergence criterion is specified under 'Details'.
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_hessian">hessian</code></td>
<td>

<p>logical indicating whether the Hessian of the variance parameters (and persistence parameters for persistence=&quot;VP&quot;) should be calculated after convergence of the EM algorithm. Standard errors for the fixed and EBLUPs are calculated by default.
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_hes.method">hes.method</code></td>
<td>

<p>a character string indicating the method of numerical differentiation used
to calculate the Hessian of the variance parameters. Options are &quot;simple&quot; or &quot;richardson&quot;.
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_reml">REML</code></td>
<td>

<p>logical indicating whether REML estimation should be used instead of ML estimation. Only currently compatible with persistence = CP, VP, or ZP.
</p>
</td></tr>
<tr><td><code id="GPvam_+3A_verbose">verbose</code></td>
<td>

<p>logical. If TRUE, model information will be printed at each iteration.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design for the random teacher effects according to the generalized persistence model
of Mariano et al. (2010) is built into the function. The model includes correlated current- and
future-year effects for each teacher. By setting <code>student.side="R"</code>, the intra-student correlation is 
modeled via an unstructured, block-diagonal error covariance matrix, as specified by Mariano et al. (2010). Setting 
<code>student.side="G"</code> keeps the same teacher structure, but models intra-student correlation via 
random student effects. This is similar to the model used by McCaffrey and Lockwood (2011), and is appropriate when the testing 
scale is the same across years. In this case, the error covariance matrix is diagonal, although a separate variance is calculated for each year.
From a computational perspective, the model estimating the R-side student effects has better scalability properties, although the G-side function is faster (Karl et al. 2012).
</p>
<p>The <code>persistence</code> option determines the type of persistence effects that are modeled. The generalized persistence model (&quot;GP&quot;) is described above. When <code>student.side="R"</code>, other models for teacher persistence are available. The reduced GP model  (&quot;rGP&quot;, Karl et al. 2012) combines each teacher's future year effects from the GP model into a single effect. The variable persistence model (&quot;VP&quot;) assumes that teacher effects in future years are multiples of their effect in the current year (Lockwood et al. 2007). The multipliers in the VP model are called persistence parameters, and are estimated. By contrast, the complete (&quot;CP&quot;) and zero (&quot;ZP&quot;) persistence models fix the persistence parameters at 1 and 0, respectively (Lockwood et al. 2007). 
</p>
<p>Convergence is declared when <code class="reqn">(l_k-l_{k-1})/l_k &lt; 1E-07</code>, where <code class="reqn">l_k</code> is the log-likelihood 
at iteration <code class="reqn">k</code>.
</p>
<p>The model is estimated via an EM algorithm. For details, see Karl et al. (2012). The model was estimated through Bayesian computation in Mariano et al. (2010).
</p>
<p>Note: When student.side=&quot;R&quot; is selected, the first few iterations of the EM algorithm will take longer than subsequent iterations. This is a result of the hybrid gradient-ascent/Newton-Raphson method used in the M-step for the R matrix in the first two iterations (Karl et al. 2012).
</p>
<p><b>Program run time and memory requirements:</b>
The data file GPvam.benchmark that is included with the package contains runtime and peak memory requirements for different persistence settings, using simulated data sets with different values for number of years, number of teachers per year, and number of students per teacher. These have been multiplied to show the total number of teachers in the data set, as well as the total number of students. With student.side=&quot;R&quot;, the persistence=&quot;GP&quot; model is most sensitive to increases in the size of the data set. With student.side=&quot;G&quot;, the memory requirements increase exponentially with the number of students and teachers, and that model should not be considered scalable to extremely large data sets.
</p>
<p>All of these benchmarks were performed with Hessian=TRUE. Calculation of the Hessian accounts for anywhere from 20% to 75% of those run times. Unless the standard errors of the variance components are needed, leaving Hessian=FALSE will lead to a faster run time with smaller memory requirements.
</p>


<h3>Value</h3>

<p>GPvam returns an object of class <code>GPvam</code>
</p>
<p>An object of class <code>GPvam</code> is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>loglik</code></td>
<td>
<p>the maximized log-likelihood at convergence of the EM algorithm</p>
</td></tr>
<tr><td><code>teach.effects</code></td>
<td>
<p>a data frame containing the predicted teacher effects and standard errors</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a matrix of estimated model parameters and standard errors</p>
</td></tr>
<tr><td><code>Hessian</code></td>
<td>
<p>if requested, the Hessian of the variance parameters</p>
</td></tr>
<tr><td><code>R_i</code></td>
<td>
<p>(only when <code>student_side</code> is set to 'R') a matrix containing the error covariance matrix of a student</p>
</td></tr>
<tr><td><code>teach.cov</code></td>
<td>
<p>a list containing the unique blocks of the covariance matrix of teacher effects</p>
</td></tr>
<tr><td><code>mresid</code></td>
<td>
<p>a vector of the raw marginal residuals</p>
</td></tr>
<tr><td><code>cresid</code></td>
<td>
<p>a vector of the raw conditional residuals</p>
</td></tr>
<tr><td><code>sresid</code></td>
<td>
<p>a vector of the scaled conditional residuals</p>
</td></tr>
<tr><td><code>yhat</code></td>
<td>
<p>a vector of the predicted values</p>
</td></tr>
</table>
<p>The function  <code><a href="base.html#topic+summary">summary</a></code> provides a summary of the results. This includes the estimated model parameters and standard errors, along with the correlation matrices corresponding to the estimated correlation matrices. Summary information about scaled and raw residuals is reported.
</p>


<h3>Note</h3>

<p>The model assumes that each teacher teaches only one year. If, for example, a teacher teaches in years 1 and 2, his/her first year performance is modeled independently of the second year performance.
To keep these effects separate, the progam appends &quot;(year i)&quot; to each teacher name, where i is the year in which the teacher taught.
</p>
<p>The <code>fixed_effects</code> argument of <code>GPvam</code> utilizes the functionality of R's <code>formula</code> class. In the statement <code>fixed_effects=formula(~as.factor(year)+cont_var+0))</code>, <code>as.factor(year)</code> identifies <code>year</code> as a categorical variable. <code>+0</code> indicates that no intercept is to be fitted, and <code>+cont_var</code> indicates that a seperate effect is to be fitted for the continuous variable &quot;cont_var.&quot; An interaction between &quot;year&quot; and &quot;cont_var&quot; could be specified by <code>~as.factor(year)*cont_var+0</code>, or equivalently, <code>~as.factor(year)+cont_var+as.factor(year):cont_var+0</code>. See <code><a href="stats.html#topic+formula">formula</a></code> for more details.
</p>
<p>When applied to an object of class GPvam, <code><a href="#topic+plot.GPvam">plot.GPvam</a></code> returns a caterpillar plot for each effect, as well as residual plots.
</p>


<h3>Author(s)</h3>

<p>Andrew Karl <a href="mailto:akarl@asu.edu">akarl@asu.edu</a>, Yan Yang, Sharon Lohr
</p>


<h3>References</h3>

<p>Karl, A., Yang, Y. and Lohr, S. (2013) Efficient Maximum Likelihood Estimation of Multiple Membership Linear Mixed Models, with an Application to Educational Value-Added Assessments <em>Computational Statistics &amp; Data Analysis</em> <b>59</b>, 13&ndash;27.  
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) Computation of Maximum Likelihood Estimates for Multiresponse Generalized Linear Mixed Models with Non-nested, Correlated Random Effects <em>Computational Statistics &amp; Data Analysis</em> <b>73</b>, 146&ndash;162.
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) A Correlated Random Effects Model for Nonignorable Missing Data in Value-Added Assessment of Teacher Effects <em>Journal of Educational and Behavioral Statistics</em> <b>38</b>, 577&ndash;603.
</p>
<p>Lockwood, J., McCaffrey, D., Mariano, L., Setodji, C. (2007) Bayesian Methods for Scalable Multivariate Value-Added Assesment. <em>Journal of Educational and Behavioral Statistics</em> <b>32</b>, 125&ndash;150.
</p>
<p>Mariano, L., McCaffrey, D. and Lockwood, J. (2010) A Model for Teacher Effects From Longitudinal Data Without Assuming Vertical Scaling. <em>Journal of Educational and Behavioral Statistics</em> <b>35</b>, 
253&ndash;279.
</p>
<p>McCaffrey, D. and Lockwood, J. (2011) Missing Data in Value-Added Modeling of Teacher Effects,&quot; <em>Annals of Applied Statistics</em> <b>5</b>, 773&ndash;797
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.GPvam">plot.GPvam</a></code>,
<code><a href="#topic+summary.GPvam">summary.GPvam</a></code>,
<code><a href="#topic+vam_data">vam_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vam_data)
GPvam(vam_data,student.side="R",persistence="CP",
fixed_effects=formula(~as.factor(year)+cont_var+0),verbose=TRUE,max.iter.EM=1)

result &lt;- GPvam(vam_data,student.side="R",persistence="VP",
fixed_effects=formula(~as.factor(year)+cont_var+0),verbose=TRUE)
 summary(result)

 plot(result)

</code></pre>

<hr>
<h2 id='GPvam.benchmark'>
Benchmarks of the program using simulated data.
</h2><span id='topic+GPvam.benchmark'></span>

<h3>Description</h3>

<p>The data file GPvam.benchmark that is included with the package contains runtime and peak memory requirements for different persistence settings, using simulated data sets with different values for number of years, number of teachers per year, and number of students per teacher. These have been multiplied to show the total number of teachers in the data set, as well as the total number of students. With student.side=&quot;R&quot;, the persistence=&quot;GP&quot; model is most sensitive to increases in the size of the data set. With student.side=&quot;G&quot;, the memory requirements increase exponentially with the number of students and teachers, and that model should not be considered scalable to extremely large data sets.
</p>
<p>All of these benchmarks were performed with Hessian=TRUE. Calculation of the Hessian accounts for anywhere from 20% to 75% of those run times. Unless the standard errors of the variance components are needed, leaving Hessian=FALSE will lead to a faster run time with smaller memory requirements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vam_data)</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(GPvam.benchmark)
print(GPvam.benchmark[1,])
</code></pre>

<hr>
<h2 id='plot'>
Plot method for GPvam
</h2><span id='topic+plot.GPvam'></span>

<h3>Description</h3>

<p>Plot teacher effects and residuals.  The caterpillar plots use a modified version of the plotCI function from R package gplots. According to that package, &quot;Original version [of plotCI] by Bill Venables wvenable@attunga.stats.adelaide.edu.au posted to r-help on Sep. 20, 1997. Enhanced version posted to r-help by Ben Bolker ben@zoo.ufl.edu on Apr. 16, 2001. This version was modified and extended by Gregory R. Warnes greg@warnes.net. Additional changes suggested by Martin Maechler maechler@stat.math.ethz.ch integrated on July 29, 2004.&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GPvam'
plot(x, ..., alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>

<p>an object of class GPvam
</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>

<p>other arguments
</p>
</td></tr>
<tr><td><code id="plot_+3A_alpha">alpha</code></td>
<td>

<p>the significance level for the caterpillar plots
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Requires user to click window or press &quot;enter&quot; to progress through plots. Returns caterpillar plots (via the package gplots) and residual plots. 
</p>


<h3>Author(s)</h3>

<p>Andrew Karl <a href="mailto:akarl@asu.edu">akarl@asu.edu</a>
Yan Yang
Sharon Lohr
</p>
<p>Other authors as listed above for the caterpillar plots.
</p>


<h3>References</h3>

<p>Karl, A., Yang, Y. and Lohr, S. (2013) Efficient Maximum Likelihood Estimation of Multiple Membership Linear Mixed Models, with an Application to Educational Value-Added Assessments <em>Computational Statistics &amp; Data Analysis</em> <b>59</b>, 13&ndash;27.  
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) Computation of Maximum Likelihood Estimates for Multiresponse Generalized Linear Mixed Models with Non-nested, Correlated Random Effects <em>Computational Statistics &amp; Data Analysis</em> <b>73</b>, 146&ndash;162.
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) A Correlated Random Effects Model for Nonignorable Missing Data in Value-Added Assessment of Teacher Effects <em>Journal of Educational and Behavioral Statistics</em> <b>38</b>, 577&ndash;603.
</p>
<p>Lockwood, J., McCaffrey, D., Mariano, L., Setodji, C. (2007) Bayesian Methods for Scalable Multivariate Value-Added Assesment. <em>Journal of Educational and Behavioral Statistics</em> <b>32</b>, 125&ndash;150. 
</p>
<p>Mariano, L., McCaffrey, D. and Lockwood, J. (2010) A Model for Teacher Effects From Longitudinal Data Without Assuming Vertical Scaling. <em>Journal of Educational and Behavioral Statistics</em> <b>35</b>, 
253&ndash;279.
</p>
<p>McCaffrey, D. and Lockwood, J. (2011) Missing Data in Value-Added Modeling of Teavher Effects, <em>Annals of Applied Statistics</em> <b>5</b>, 773&ndash;797
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.GPvam">summary.GPvam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vam_data)

GPvam(vam_data,student.side="R",persistence="VP",
fixed_effects=formula(~as.factor(year)+cont_var+0),verbose=TRUE,max.iter.EM=1)

result &lt;- GPvam(vam_data,student.side="R",persistence="VP",
fixed_effects=formula(~as.factor(year)+cont_var+0),verbose=TRUE)
 summary(result)

 plot(result)
                

</code></pre>

<hr>
<h2 id='print'>
Print
</h2><span id='topic+print.GPvam'></span><span id='topic+print.summary.GPvam'></span>

<h3>Description</h3>

<p>Prints names of elements in GPvam object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GPvam'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print_+3A_x">x</code></td>
<td>

<p>object of class GPvam
</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to summary
</p>
</td></tr>
</table>

<hr>
<h2 id='rGP.un'>
Internal R-side effects function for reduced GP model
</h2><span id='topic+rGP.un'></span>

<h3>Description</h3>

<p>An internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rGP.un(Z_mat, fixed_effects, control)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rGP.un_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="rGP.un_+3A_fixed_effects">fixed_effects</code></td>
<td>

<p>formla specifying fixed effects to be included in model
</p>
</td></tr>
<tr><td><code id="rGP.un_+3A_control">control</code></td>
<td>

<p>a list
</p>
</td></tr>
</table>

<hr>
<h2 id='summary'>
Summary
</h2><span id='topic+summary.GPvam'></span>

<h3>Description</h3>

<p>Prints summary information for object of class GPvam
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GPvam'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_+3A_object">object</code></td>
<td>

<p>object of class GPvam
</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to summary
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Karl <a href="mailto:akarl@asu.edu">akarl@asu.edu</a>
Yan Yang
Sharon Lohr
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.GPvam">plot.GPvam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(vam_data)
result&lt;-GPvam(vam_data)
summary(result)

## End(Not run)
</code></pre>

<hr>
<h2 id='vam_data'>
Simulated Data
</h2><span id='topic+vam_data'></span>

<h3>Description</h3>

<p>A simulated data set used to illustrate the functionality of the package. The data are simulated according to the VP model, and demonstrate the stability of the program in the presence of perfectly correlated future year effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vam_data)</code></pre>


<h3>Format</h3>

<p>A data frame with 3750 observations on 1250 students over 3 years, with 50 teachers in each year. The data set contains the following 5 variables.
</p>

<dl>
<dt><code>y</code></dt><dd><p>a numeric vector representing the student score</p>
</dd>
<dt><code>student</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>year</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>teacher</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cont_var</code></dt><dd><p>a numeric vector representing a continuous covariate</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data set may be reproduced with the following code.
</p>
<p>set.seed(0) <br />
years&lt;-3 <br />
#teacher in each year <br />
teachers&lt;-50 <br />
#students in each class <br />
students&lt;-25 <br />
alpha&lt;-.4 <br />
eta.stu&lt;-rnorm(students*teachers,0,5) <br />
z1&lt;-rep(1:teachers,each=students) <br />
z2&lt;-sample(rep(1:teachers,each=students)) <br />
z3&lt;-sample(rep(1:teachers,each=students)) <br />
cont_var1&lt;-rnorm(students*teachers,0,4) <br />
cont_var2&lt;-rnorm(students*teachers,0,4) <br />
cont_var3&lt;-rnorm(students*teachers,0,4) <br />
gam1&lt;- rnorm(teachers,0,5) <br />
gam2&lt;- rnorm(teachers,0,5) <br />
gam3&lt;- rnorm(teachers,0,5) <br />
eps1&lt;- rnorm(students*teachers,0,5) <br />
eps2&lt;- rnorm(students*teachers,0,5) <br />
eps3&lt;- rnorm(students*teachers,0,5) <br />
y1&lt;-eta.stu+gam1[z1]+cont_var1+eps1 <br />
y2&lt;-eta.stu+gam1[z1]*alpha+gam2[z2]+cont_var2+eps2 <br />
y3&lt;-eta.stu+gam1[z1]*alpha+gam2[z2]*alpha+gam3[z3]+cont_var3+eps3 <br />
student&lt;-1:(students*teachers) <br />
teacher&lt;-c(z1,z2,z3) <br />
cont_var&lt;-c(cont_var1,cont_var2,cont_var3) <br />
year&lt;-c(rep(1:3,each=students*teachers)) <br />
y&lt;-c(y1,y2,y3) <br />
vam_data&lt;-as.data.frame(cbind(student,teacher,year,y,cont_var)) <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vam_data)
print(vam_data[1,])
</code></pre>

<hr>
<h2 id='VP.CP.ZP.un'>
Internal R-side effects function for the variable persistence model.
</h2><span id='topic+VP.CP.ZP.un'></span>

<h3>Description</h3>

<p>An internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VP.CP.ZP.un(Z_mat, fixed_effects, control)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VP.CP.ZP.un_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="VP.CP.ZP.un_+3A_fixed_effects">fixed_effects</code></td>
<td>

<p>formula specifying fixed effects to be included in model
</p>
</td></tr>
<tr><td><code id="VP.CP.ZP.un_+3A_control">control</code></td>
<td>

<p>a list
</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
